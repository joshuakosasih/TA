Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 84s 50ms/step - loss: 0.4344 - acc: 0.8680
Epoch 2/28

1674/1674 [==============================] - 81s 49ms/step - loss: 0.2437 - acc: 0.9278
Epoch 3/28

1674/1674 [==============================] - 80s 48ms/step - loss: 0.1898 - acc: 0.9444
Epoch 4/28

1674/1674 [==============================] - 80s 48ms/step - loss: 0.1566 - acc: 0.9547
Epoch 5/28

1674/1674 [==============================] - 79s 47ms/step - loss: 0.1347 - acc: 0.9618
Epoch 6/28

1674/1674 [==============================] - 79s 47ms/step - loss: 0.1181 - acc: 0.9664
Epoch 7/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.1043 - acc: 0.9712
Epoch 8/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0940 - acc: 0.9739
Epoch 9/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0848 - acc: 0.9764
Epoch 10/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0776 - acc: 0.9779
Epoch 11/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0708 - acc: 0.9795
Epoch 12/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0655 - acc: 0.9822
Epoch 13/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0604 - acc: 0.9833
Epoch 14/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0570 - acc: 0.9836
Epoch 15/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0546 - acc: 0.9845
Epoch 16/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0497 - acc: 0.9869
Epoch 17/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0488 - acc: 0.9865
Epoch 18/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0446 - acc: 0.9877
Epoch 19/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0427 - acc: 0.9879
Epoch 20/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0420 - acc: 0.9880
Epoch 21/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0393 - acc: 0.9890
Epoch 22/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0378 - acc: 0.9891
Epoch 23/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0367 - acc: 0.9895
Epoch 24/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0358 - acc: 0.9897
Epoch 25/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0326 - acc: 0.9908
Epoch 26/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0305 - acc: 0.9919
Epoch 27/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0307 - acc: 0.9914
Epoch 28/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0287 - acc: 0.9913
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8247
False 824
True percentage 0.909161062727
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
      B-PER       0.91      0.84      0.88       438
      B-ORG       0.74      0.75      0.75       296
      I-ORG       0.60      0.64      0.62       151
      I-PER       0.90      0.66      0.76       214
      B-LOC       0.73      0.74      0.74       218
     B-MISC       0.43      0.30      0.35       141
      I-LOC       0.73      0.78      0.76       141
     I-MISC       0.54      0.42      0.47       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.717552717553
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 82s 49ms/step - loss: 0.4517 - acc: 0.8638
Epoch 2/28

1674/1674 [==============================] - 80s 48ms/step - loss: 0.2529 - acc: 0.9256
Epoch 3/28

1674/1674 [==============================] - 79s 47ms/step - loss: 0.1953 - acc: 0.9426
Epoch 4/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.1610 - acc: 0.9540
Epoch 5/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.1390 - acc: 0.9598
Epoch 6/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.1222 - acc: 0.9648
Epoch 7/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.1090 - acc: 0.9686
Epoch 8/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0971 - acc: 0.9728
Epoch 9/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0890 - acc: 0.9750
Epoch 10/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0796 - acc: 0.9771
Epoch 11/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0724 - acc: 0.9798
Epoch 12/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0678 - acc: 0.9811
Epoch 13/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0613 - acc: 0.9837
Epoch 14/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0595 - acc: 0.9830
Epoch 15/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0541 - acc: 0.9854
Epoch 16/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0515 - acc: 0.9858
Epoch 17/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0484 - acc: 0.9868
Epoch 18/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0446 - acc: 0.9872
Epoch 19/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0429 - acc: 0.9876
Epoch 20/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0403 - acc: 0.9888
Epoch 21/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0378 - acc: 0.9895
Epoch 22/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0360 - acc: 0.9901
Epoch 23/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0350 - acc: 0.9905
Epoch 24/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0353 - acc: 0.9898
Epoch 25/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0331 - acc: 0.9906
Epoch 26/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0307 - acc: 0.9909
Epoch 27/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0299 - acc: 0.9918
Epoch 28/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0279 - acc: 0.9925
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8247
False 824
True percentage 0.909161062727
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.91      0.84      0.87       438
      B-ORG       0.77      0.73      0.75       296
      I-ORG       0.62      0.60      0.61       151
     B-MISC       0.44      0.29      0.35       141
     I-MISC       0.52      0.42      0.46       154
      I-PER       0.88      0.66      0.76       214
      B-LOC       0.75      0.74      0.75       218
      I-LOC       0.76      0.78      0.77       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.717253839205
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 82s 49ms/step - loss: 0.4470 - acc: 0.8611
Epoch 2/28

1674/1674 [==============================] - 80s 48ms/step - loss: 0.2601 - acc: 0.9221
Epoch 3/28

1674/1674 [==============================] - 79s 47ms/step - loss: 0.2038 - acc: 0.9408
Epoch 4/28

1674/1674 [==============================] - 79s 47ms/step - loss: 0.1670 - acc: 0.9523
Epoch 5/28

1674/1674 [==============================] - 78s 46ms/step - loss: 0.1414 - acc: 0.9588
Epoch 6/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.1232 - acc: 0.9651
Epoch 7/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.1087 - acc: 0.9689
Epoch 8/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0983 - acc: 0.9714
Epoch 9/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0882 - acc: 0.9756
Epoch 10/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0815 - acc: 0.9773
Epoch 11/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0749 - acc: 0.9781
Epoch 12/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0673 - acc: 0.9819
Epoch 13/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0636 - acc: 0.9822
Epoch 14/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0601 - acc: 0.9830
Epoch 15/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0559 - acc: 0.9844
Epoch 16/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0513 - acc: 0.9855
Epoch 17/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0498 - acc: 0.9863
Epoch 18/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0469 - acc: 0.9863
Epoch 19/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0448 - acc: 0.9876
Epoch 20/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0416 - acc: 0.9877
Epoch 21/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0397 - acc: 0.9887
Epoch 22/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0390 - acc: 0.9890
Epoch 23/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0362 - acc: 0.9899
Epoch 24/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0356 - acc: 0.9898
Epoch 25/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0334 - acc: 0.9907
Epoch 26/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0334 - acc: 0.9900
Epoch 27/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0301 - acc: 0.9909
Epoch 28/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0296 - acc: 0.9914
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8246
False 825
True percentage 0.909050821299
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.79      0.72      0.76       296
      B-PER       0.89      0.83      0.86       438
      I-PER       0.91      0.67      0.77       214
      B-LOC       0.74      0.75      0.75       218
      I-LOC       0.74      0.79      0.76       141
      I-ORG       0.64      0.59      0.61       151
     B-MISC       0.39      0.30      0.34       141
     I-MISC       0.50      0.42      0.45       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.714242878561
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 82s 49ms/step - loss: 0.4028 - acc: 0.8761
Epoch 2/28

1674/1674 [==============================] - 80s 47ms/step - loss: 0.2342 - acc: 0.9317
Epoch 3/28

1674/1674 [==============================] - 79s 47ms/step - loss: 0.1803 - acc: 0.9459
Epoch 4/28

1674/1674 [==============================] - 79s 47ms/step - loss: 0.1521 - acc: 0.9536
Epoch 5/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.1307 - acc: 0.9615
Epoch 6/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.1161 - acc: 0.9658
Epoch 7/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.1019 - acc: 0.9698
Epoch 8/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0931 - acc: 0.9734
Epoch 9/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0850 - acc: 0.9752
Epoch 10/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0768 - acc: 0.9782
Epoch 11/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0713 - acc: 0.9797
Epoch 12/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0666 - acc: 0.9806
Epoch 13/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0615 - acc: 0.9830
Epoch 14/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0586 - acc: 0.9837
Epoch 15/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0526 - acc: 0.9858
Epoch 16/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0494 - acc: 0.9860
Epoch 17/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0494 - acc: 0.9861
Epoch 18/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0437 - acc: 0.9874
Epoch 19/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0435 - acc: 0.9876
Epoch 20/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0399 - acc: 0.9883
Epoch 21/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0375 - acc: 0.9900
Epoch 22/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0358 - acc: 0.9900
Epoch 23/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0360 - acc: 0.9898
Epoch 24/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0341 - acc: 0.9903
Epoch 25/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0324 - acc: 0.9913
Epoch 26/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0323 - acc: 0.9908
Epoch 27/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0294 - acc: 0.9921
Epoch 28/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0293 - acc: 0.9916
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8268
False 803
True percentage 0.911476132731
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
     B-MISC       0.45      0.29      0.35       141
     I-MISC       0.59      0.42      0.49       154
      B-ORG       0.76      0.73      0.75       296
      B-LOC       0.76      0.77      0.76       218
      B-PER       0.90      0.85      0.87       438
      I-PER       0.92      0.66      0.77       214
      I-ORG       0.62      0.64      0.63       151
      I-LOC       0.74      0.81      0.77       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.727599640396
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 82s 49ms/step - loss: 0.4112 - acc: 0.8711
Epoch 2/28

1674/1674 [==============================] - 80s 48ms/step - loss: 0.2425 - acc: 0.9265
Epoch 3/28

1674/1674 [==============================] - 79s 47ms/step - loss: 0.1893 - acc: 0.9434
Epoch 4/28

1674/1674 [==============================] - 79s 47ms/step - loss: 0.1584 - acc: 0.9532
Epoch 5/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.1339 - acc: 0.9617
Epoch 6/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.1176 - acc: 0.9659
Epoch 7/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.1048 - acc: 0.9699
Epoch 8/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0948 - acc: 0.9733
Epoch 9/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0839 - acc: 0.9760
Epoch 10/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0789 - acc: 0.9779
Epoch 11/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0702 - acc: 0.9808
Epoch 12/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0659 - acc: 0.9818
Epoch 13/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0622 - acc: 0.9826
Epoch 14/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0575 - acc: 0.9841
Epoch 15/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0533 - acc: 0.9853
Epoch 16/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0497 - acc: 0.9861
Epoch 17/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0466 - acc: 0.9873
Epoch 18/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0454 - acc: 0.9873
Epoch 19/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0424 - acc: 0.9881
Epoch 20/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0414 - acc: 0.9883
Epoch 21/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0384 - acc: 0.9893
Epoch 22/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0370 - acc: 0.9892
Epoch 23/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0345 - acc: 0.9903
Epoch 24/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0325 - acc: 0.9908
Epoch 25/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0328 - acc: 0.9907
Epoch 26/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0299 - acc: 0.9914
Epoch 27/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0311 - acc: 0.9912
Epoch 28/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0300 - acc: 0.9912
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8273
False 798
True percentage 0.912027339874
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.92      0.83      0.87       438
      I-PER       0.88      0.66      0.75       214
          O       0.98      0.96      0.97      7318
      B-ORG       0.75      0.76      0.76       296
      B-LOC       0.77      0.73      0.75       218
      I-ORG       0.64      0.63      0.64       151
      I-LOC       0.78      0.80      0.79       141
     B-MISC       0.45      0.31      0.37       141
     I-MISC       0.54      0.47      0.50       154

avg / total       0.94      0.91      0.93      9071

F-1 Score (without O):
0.930799105567
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104767 unique words.
4763 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 244
OOV word occurences: in test 345
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6705152     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,817,282
Trainable params: 6,817,282
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 43s 51ms/step - loss: 0.5601 - acc: 0.8312
Epoch 2/28

837/837 [==============================] - 40s 48ms/step - loss: 0.3203 - acc: 0.9008
Epoch 3/28

837/837 [==============================] - 40s 48ms/step - loss: 0.2541 - acc: 0.9244
Epoch 4/28

837/837 [==============================] - 40s 48ms/step - loss: 0.2179 - acc: 0.9367
Epoch 5/28

837/837 [==============================] - 40s 48ms/step - loss: 0.1891 - acc: 0.9465
Epoch 6/28

837/837 [==============================] - 40s 48ms/step - loss: 0.1661 - acc: 0.9537
Epoch 7/28

837/837 [==============================] - 40s 48ms/step - loss: 0.1469 - acc: 0.9587
Epoch 8/28

837/837 [==============================] - 39s 47ms/step - loss: 0.1311 - acc: 0.9639
Epoch 9/28

837/837 [==============================] - 39s 47ms/step - loss: 0.1219 - acc: 0.9665
Epoch 10/28

837/837 [==============================] - 39s 47ms/step - loss: 0.1075 - acc: 0.9713
Epoch 11/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0987 - acc: 0.9739
Epoch 12/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0920 - acc: 0.9765
Epoch 13/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0852 - acc: 0.9771
Epoch 14/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0786 - acc: 0.9806
Epoch 15/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0722 - acc: 0.9811
Epoch 16/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0652 - acc: 0.9844
Epoch 17/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0647 - acc: 0.9837
Epoch 18/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0597 - acc: 0.9857
Epoch 19/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0553 - acc: 0.9870
Epoch 20/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0516 - acc: 0.9886
Epoch 21/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0489 - acc: 0.9880
Epoch 22/28

837/837 [==============================] - 38s 46ms/step - loss: 0.0475 - acc: 0.9884
Epoch 23/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0444 - acc: 0.9889
Epoch 24/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0429 - acc: 0.9895
Epoch 25/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0400 - acc: 0.9908
Epoch 26/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0382 - acc: 0.9913
Epoch 27/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0366 - acc: 0.9915
Epoch 28/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0352 - acc: 0.9919
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8207
False 864
True percentage 0.904751405578
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.91      0.83      0.87       438
      B-ORG       0.75      0.74      0.74       296
      I-ORG       0.61      0.56      0.58       151
      I-PER       0.89      0.61      0.73       214
      B-LOC       0.74      0.75      0.75       218
     B-MISC       0.49      0.31      0.38       141
      I-LOC       0.68      0.80      0.73       141
     I-MISC       0.47      0.39      0.43       154

avg / total       0.94      0.90      0.92      9071

F-1 Score (without O):
0.707222055739
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104723 unique words.
4719 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 249
OOV word occurences: in test 356
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6702336     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,814,466
Trainable params: 6,814,466
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 44s 52ms/step - loss: 0.5901 - acc: 0.8241
Epoch 2/28

837/837 [==============================] - 41s 49ms/step - loss: 0.3441 - acc: 0.8908
Epoch 3/28

837/837 [==============================] - 41s 49ms/step - loss: 0.2801 - acc: 0.9143
Epoch 4/28

837/837 [==============================] - 41s 49ms/step - loss: 0.2313 - acc: 0.9312
Epoch 5/28

837/837 [==============================] - 41s 49ms/step - loss: 0.2061 - acc: 0.9397
Epoch 6/28

837/837 [==============================] - 41s 49ms/step - loss: 0.1774 - acc: 0.9496
Epoch 7/28

837/837 [==============================] - 41s 49ms/step - loss: 0.1602 - acc: 0.9548
Epoch 8/28

837/837 [==============================] - 41s 49ms/step - loss: 0.1440 - acc: 0.9605
Epoch 9/28

837/837 [==============================] - 41s 49ms/step - loss: 0.1320 - acc: 0.9651
Epoch 10/28

837/837 [==============================] - 41s 48ms/step - loss: 0.1178 - acc: 0.9686
Epoch 11/28

837/837 [==============================] - 40s 48ms/step - loss: 0.1089 - acc: 0.9704
Epoch 12/28

837/837 [==============================] - 40s 48ms/step - loss: 0.0996 - acc: 0.9724
Epoch 13/28

837/837 [==============================] - 40s 48ms/step - loss: 0.0907 - acc: 0.9763
Epoch 14/28

837/837 [==============================] - 40s 48ms/step - loss: 0.0840 - acc: 0.9779
Epoch 15/28

837/837 [==============================] - 40s 48ms/step - loss: 0.0809 - acc: 0.9778
Epoch 16/28

837/837 [==============================] - 40s 48ms/step - loss: 0.0758 - acc: 0.9799
Epoch 17/28

837/837 [==============================] - 40s 48ms/step - loss: 0.0710 - acc: 0.9810
Epoch 18/28

837/837 [==============================] - 40s 47ms/step - loss: 0.0661 - acc: 0.9822
Epoch 19/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0620 - acc: 0.9835
Epoch 20/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0587 - acc: 0.9846
Epoch 21/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0545 - acc: 0.9857
Epoch 22/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0525 - acc: 0.9854
Epoch 23/28

837/837 [==============================] - 38s 46ms/step - loss: 0.0505 - acc: 0.9862
Epoch 24/28

837/837 [==============================] - 38s 46ms/step - loss: 0.0469 - acc: 0.9868
Epoch 25/28

837/837 [==============================] - 38s 46ms/step - loss: 0.0451 - acc: 0.9887
Epoch 26/28

837/837 [==============================] - 38s 46ms/step - loss: 0.0411 - acc: 0.9893
Epoch 27/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0418 - acc: 0.9890
Epoch 28/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0380 - acc: 0.9896
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8162
False 909
True percentage 0.899790541285
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
      B-PER       0.90      0.80      0.85       438
      B-ORG       0.71      0.75      0.73       296
      I-ORG       0.48      0.59      0.53       151
     B-MISC       0.43      0.28      0.34       141
     I-MISC       0.50      0.40      0.45       154
      I-PER       0.88      0.64      0.74       214
      B-LOC       0.71      0.75      0.73       218
      I-LOC       0.75      0.75      0.75       141

avg / total       0.94      0.90      0.92      9071

F-1 Score (without O):
0.690307328605
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104715 unique words.
4711 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 248
OOV word occurences: in test 352
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6701824     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,813,954
Trainable params: 6,813,954
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 43s 52ms/step - loss: 0.5182 - acc: 0.8412
Epoch 2/28

837/837 [==============================] - 41s 49ms/step - loss: 0.3094 - acc: 0.9067
Epoch 3/28

837/837 [==============================] - 41s 49ms/step - loss: 0.2447 - acc: 0.9273
Epoch 4/28

837/837 [==============================] - 41s 49ms/step - loss: 0.2093 - acc: 0.9406
Epoch 5/28

837/837 [==============================] - 41s 49ms/step - loss: 0.1760 - acc: 0.9495
Epoch 6/28

837/837 [==============================] - 41s 49ms/step - loss: 0.1546 - acc: 0.9571
Epoch 7/28

837/837 [==============================] - 41s 49ms/step - loss: 0.1336 - acc: 0.9633
Epoch 8/28

837/837 [==============================] - 41s 49ms/step - loss: 0.1202 - acc: 0.9667
Epoch 9/28

837/837 [==============================] - 41s 49ms/step - loss: 0.1063 - acc: 0.9715
Epoch 10/28

837/837 [==============================] - 41s 49ms/step - loss: 0.0931 - acc: 0.9751
Epoch 11/28

837/837 [==============================] - 41s 49ms/step - loss: 0.0851 - acc: 0.9769
Epoch 12/28

837/837 [==============================] - 41s 49ms/step - loss: 0.0791 - acc: 0.9783
Epoch 13/28

837/837 [==============================] - 41s 49ms/step - loss: 0.0729 - acc: 0.9807
Epoch 14/28

837/837 [==============================] - 41s 49ms/step - loss: 0.0661 - acc: 0.9831
Epoch 15/28

837/837 [==============================] - 41s 49ms/step - loss: 0.0610 - acc: 0.9843
Epoch 16/28

837/837 [==============================] - 41s 49ms/step - loss: 0.0573 - acc: 0.9848
Epoch 17/28

837/837 [==============================] - 41s 49ms/step - loss: 0.0543 - acc: 0.9861
Epoch 18/28

837/837 [==============================] - 41s 49ms/step - loss: 0.0510 - acc: 0.9859
Epoch 19/28

837/837 [==============================] - 41s 49ms/step - loss: 0.0468 - acc: 0.9876
Epoch 20/28

837/837 [==============================] - 40s 48ms/step - loss: 0.0439 - acc: 0.9886
Epoch 21/28

837/837 [==============================] - 40s 48ms/step - loss: 0.0412 - acc: 0.9900
Epoch 22/28

837/837 [==============================] - 40s 48ms/step - loss: 0.0409 - acc: 0.9887
Epoch 23/28

837/837 [==============================] - 40s 48ms/step - loss: 0.0375 - acc: 0.9907
Epoch 24/28

837/837 [==============================] - 40s 48ms/step - loss: 0.0365 - acc: 0.9905
Epoch 25/28

837/837 [==============================] - 40s 48ms/step - loss: 0.0331 - acc: 0.9917
Epoch 26/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0319 - acc: 0.9914
Epoch 27/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0316 - acc: 0.9921
Epoch 28/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0295 - acc: 0.9923
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8180
False 891
True percentage 0.901774887003
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.72      0.74      0.73       296
      B-PER       0.89      0.79      0.84       438
      I-PER       0.87      0.64      0.74       214
      B-LOC       0.72      0.69      0.71       218
      I-LOC       0.85      0.79      0.82       141
      I-ORG       0.58      0.60      0.59       151
     B-MISC       0.45      0.28      0.34       141
     I-MISC       0.49      0.47      0.48       154

avg / total       0.94      0.90      0.92      9071

F-1 Score (without O):
0.699401197605
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104764 unique words.
4760 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 248
OOV word occurences: in test 387
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6704960     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,817,090
Trainable params: 6,817,090
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 43s 51ms/step - loss: 0.5035 - acc: 0.8456
Epoch 2/28

837/837 [==============================] - 41s 49ms/step - loss: 0.3028 - acc: 0.9084
Epoch 3/28

837/837 [==============================] - 40s 48ms/step - loss: 0.2415 - acc: 0.9271
Epoch 4/28

837/837 [==============================] - 40s 48ms/step - loss: 0.2044 - acc: 0.9402
Epoch 5/28

837/837 [==============================] - 40s 48ms/step - loss: 0.1780 - acc: 0.9466
Epoch 6/28

837/837 [==============================] - 40s 48ms/step - loss: 0.1543 - acc: 0.9572
Epoch 7/28

837/837 [==============================] - 40s 48ms/step - loss: 0.1369 - acc: 0.9613
Epoch 8/28

837/837 [==============================] - 40s 48ms/step - loss: 0.1238 - acc: 0.9653
Epoch 9/28

837/837 [==============================] - 40s 47ms/step - loss: 0.1071 - acc: 0.9719
Epoch 10/28

837/837 [==============================] - 39s 47ms/step - loss: 0.1007 - acc: 0.9715
Epoch 11/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0887 - acc: 0.9759
Epoch 12/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0823 - acc: 0.9785
Epoch 13/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0784 - acc: 0.9781
Epoch 14/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0684 - acc: 0.9827
Epoch 15/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0655 - acc: 0.9832
Epoch 16/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0605 - acc: 0.9844
Epoch 17/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0571 - acc: 0.9850
Epoch 18/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0542 - acc: 0.9855
Epoch 19/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0495 - acc: 0.9870
Epoch 20/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0458 - acc: 0.9888
Epoch 21/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0436 - acc: 0.9885
Epoch 22/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0426 - acc: 0.9883
Epoch 23/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0392 - acc: 0.9895
Epoch 24/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0396 - acc: 0.9895
Epoch 25/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0353 - acc: 0.9913
Epoch 26/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0346 - acc: 0.9912
Epoch 27/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0326 - acc: 0.9920
Epoch 28/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0306 - acc: 0.9925
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8084
False 987
True percentage 0.891191709845
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
     B-MISC       0.35      0.35      0.35       141
     I-MISC       0.40      0.51      0.45       154
      B-ORG       0.72      0.59      0.65       296
      B-LOC       0.73      0.71      0.72       218
      B-PER       0.90      0.72      0.80       438
      I-PER       0.89      0.63      0.74       214
      I-ORG       0.50      0.34      0.40       151
      I-LOC       0.75      0.73      0.74       141

avg / total       0.93      0.89      0.91      9071

F-1 Score (without O):
0.646378575776
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104723 unique words.
4719 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 245
OOV word occurences: in test 385
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6702336     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,814,466
Trainable params: 6,814,466
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 43s 52ms/step - loss: 0.4951 - acc: 0.8514
Epoch 2/28

837/837 [==============================] - 41s 49ms/step - loss: 0.2924 - acc: 0.9125
Epoch 3/28

837/837 [==============================] - 41s 49ms/step - loss: 0.2344 - acc: 0.9301
Epoch 4/28

837/837 [==============================] - 41s 49ms/step - loss: 0.1975 - acc: 0.9406
Epoch 5/28

837/837 [==============================] - 41s 49ms/step - loss: 0.1765 - acc: 0.9486
Epoch 6/28

837/837 [==============================] - 41s 49ms/step - loss: 0.1488 - acc: 0.9566
Epoch 7/28

837/837 [==============================] - 41s 49ms/step - loss: 0.1337 - acc: 0.9625
Epoch 8/28

837/837 [==============================] - 41s 49ms/step - loss: 0.1200 - acc: 0.9668
Epoch 9/28

837/837 [==============================] - 41s 50ms/step - loss: 0.1071 - acc: 0.9701
Epoch 10/28

837/837 [==============================] - 41s 49ms/step - loss: 0.0970 - acc: 0.9743
Epoch 11/28

837/837 [==============================] - 40s 48ms/step - loss: 0.0874 - acc: 0.9771
Epoch 12/28

837/837 [==============================] - 40s 48ms/step - loss: 0.0811 - acc: 0.9786
Epoch 13/28

837/837 [==============================] - 40s 48ms/step - loss: 0.0758 - acc: 0.9800
Epoch 14/28

837/837 [==============================] - 40s 48ms/step - loss: 0.0705 - acc: 0.9799
Epoch 15/28

837/837 [==============================] - 40s 48ms/step - loss: 0.0659 - acc: 0.9832
Epoch 16/28

837/837 [==============================] - 40s 48ms/step - loss: 0.0620 - acc: 0.9831
Epoch 17/28

837/837 [==============================] - 40s 48ms/step - loss: 0.0561 - acc: 0.9848
Epoch 18/28

837/837 [==============================] - 40s 47ms/step - loss: 0.0517 - acc: 0.9864
Epoch 19/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0477 - acc: 0.9879
Epoch 20/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0456 - acc: 0.9885
Epoch 21/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0442 - acc: 0.9881
Epoch 22/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0415 - acc: 0.9900
Epoch 23/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0382 - acc: 0.9896
Epoch 24/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0354 - acc: 0.9912
Epoch 25/28

837/837 [==============================] - 38s 46ms/step - loss: 0.0332 - acc: 0.9922
Epoch 26/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0327 - acc: 0.9917
Epoch 27/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0293 - acc: 0.9931
Epoch 28/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0315 - acc: 0.9922
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8130
False 941
True percentage 0.896262815566
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.88      0.72      0.80       438
      I-PER       0.86      0.62      0.72       214
          O       0.98      0.96      0.97      7318
      B-ORG       0.69      0.73      0.71       296
      B-LOC       0.71      0.73      0.72       218
      I-ORG       0.50      0.60      0.55       151
      I-LOC       0.79      0.75      0.77       141
     B-MISC       0.44      0.28      0.34       141
     I-MISC       0.56      0.44      0.49       154

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.921344339623
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104352 unique words.
4348 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 266
OOV word occurences: in test 428
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678592     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,722
Trainable params: 6,790,722
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 18s 55ms/step - loss: 0.6954 - acc: 0.7897
Epoch 2/28

334/334 [==============================] - 16s 48ms/step - loss: 0.3979 - acc: 0.8731
Epoch 3/28

334/334 [==============================] - 16s 49ms/step - loss: 0.3237 - acc: 0.9036
Epoch 4/28

334/334 [==============================] - 16s 48ms/step - loss: 0.2800 - acc: 0.9184
Epoch 5/28

334/334 [==============================] - 16s 49ms/step - loss: 0.2382 - acc: 0.9349
Epoch 6/28

334/334 [==============================] - 16s 49ms/step - loss: 0.2167 - acc: 0.9394
Epoch 7/28

334/334 [==============================] - 16s 49ms/step - loss: 0.1900 - acc: 0.9493
Epoch 8/28

334/334 [==============================] - 16s 49ms/step - loss: 0.1722 - acc: 0.9545
Epoch 9/28

334/334 [==============================] - 16s 49ms/step - loss: 0.1546 - acc: 0.9599
Epoch 10/28

334/334 [==============================] - 16s 49ms/step - loss: 0.1388 - acc: 0.9642
Epoch 11/28

334/334 [==============================] - 16s 49ms/step - loss: 0.1272 - acc: 0.9703
Epoch 12/28

334/334 [==============================] - 16s 49ms/step - loss: 0.1156 - acc: 0.9721
Epoch 13/28

334/334 [==============================] - 16s 49ms/step - loss: 0.1044 - acc: 0.9755
Epoch 14/28

334/334 [==============================] - 16s 49ms/step - loss: 0.0962 - acc: 0.9785
Epoch 15/28

334/334 [==============================] - 16s 49ms/step - loss: 0.0874 - acc: 0.9808
Epoch 16/28

334/334 [==============================] - 16s 49ms/step - loss: 0.0795 - acc: 0.9821
Epoch 17/28

334/334 [==============================] - 16s 48ms/step - loss: 0.0742 - acc: 0.9844
Epoch 18/28

334/334 [==============================] - 16s 49ms/step - loss: 0.0724 - acc: 0.9846
Epoch 19/28

334/334 [==============================] - 16s 49ms/step - loss: 0.0639 - acc: 0.9855
Epoch 20/28

334/334 [==============================] - 16s 49ms/step - loss: 0.0630 - acc: 0.9864
Epoch 21/28

334/334 [==============================] - 16s 48ms/step - loss: 0.0589 - acc: 0.9872
Epoch 22/28

334/334 [==============================] - 16s 49ms/step - loss: 0.0536 - acc: 0.9900
Epoch 23/28

334/334 [==============================] - 16s 49ms/step - loss: 0.0491 - acc: 0.9906
Epoch 24/28

334/334 [==============================] - 16s 49ms/step - loss: 0.0459 - acc: 0.9913
Epoch 25/28

334/334 [==============================] - 16s 49ms/step - loss: 0.0435 - acc: 0.9917
Epoch 26/28

334/334 [==============================] - 16s 49ms/step - loss: 0.0412 - acc: 0.9915
Epoch 27/28

334/334 [==============================] - 16s 49ms/step - loss: 0.0384 - acc: 0.9919
Epoch 28/28

334/334 [==============================] - 16s 49ms/step - loss: 0.0376 - acc: 0.9926
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8029
False 1042
True percentage 0.885128431264
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.96      0.97      7318
      B-PER       0.88      0.71      0.79       438
      B-ORG       0.68      0.63      0.65       296
      I-ORG       0.50      0.56      0.53       151
      I-PER       0.92      0.57      0.70       214
      B-LOC       0.69      0.71      0.70       218
     B-MISC       0.35      0.16      0.22       141
      I-LOC       0.64      0.71      0.67       141
     I-MISC       0.50      0.23      0.32       154

avg / total       0.92      0.89      0.90      9071

F-1 Score (without O):
0.634970284642
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104340 unique words.
4336 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 268
OOV word occurences: in test 411
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6677824     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,789,954
Trainable params: 6,789,954
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 18s 55ms/step - loss: 0.6489 - acc: 0.8042
Epoch 2/28

334/334 [==============================] - 16s 49ms/step - loss: 0.3722 - acc: 0.8848
Epoch 3/28

334/334 [==============================] - 16s 49ms/step - loss: 0.3051 - acc: 0.9097
Epoch 4/28

334/334 [==============================] - 16s 49ms/step - loss: 0.2650 - acc: 0.9247
Epoch 5/28

334/334 [==============================] - 16s 49ms/step - loss: 0.2294 - acc: 0.9331
Epoch 6/28

334/334 [==============================] - 16s 49ms/step - loss: 0.2004 - acc: 0.9458
Epoch 7/28

334/334 [==============================] - 16s 49ms/step - loss: 0.1875 - acc: 0.9464
Epoch 8/28

334/334 [==============================] - 16s 49ms/step - loss: 0.1609 - acc: 0.9566
Epoch 9/28

334/334 [==============================] - 16s 49ms/step - loss: 0.1470 - acc: 0.9621
Epoch 10/28

334/334 [==============================] - 16s 49ms/step - loss: 0.1305 - acc: 0.9678
Epoch 11/28

334/334 [==============================] - 16s 49ms/step - loss: 0.1163 - acc: 0.9719
Epoch 12/28

334/334 [==============================] - 16s 49ms/step - loss: 0.1115 - acc: 0.9750
Epoch 13/28

334/334 [==============================] - 16s 49ms/step - loss: 0.1051 - acc: 0.9747
Epoch 14/28

334/334 [==============================] - 16s 49ms/step - loss: 0.0912 - acc: 0.9801
Epoch 15/28

334/334 [==============================] - 16s 49ms/step - loss: 0.0853 - acc: 0.9795
Epoch 16/28

334/334 [==============================] - 16s 48ms/step - loss: 0.0787 - acc: 0.9820
Epoch 17/28

334/334 [==============================] - 16s 48ms/step - loss: 0.0723 - acc: 0.9846
Epoch 18/28

334/334 [==============================] - 16s 48ms/step - loss: 0.0713 - acc: 0.9856
Epoch 19/28

334/334 [==============================] - 16s 48ms/step - loss: 0.0639 - acc: 0.9855
Epoch 20/28

334/334 [==============================] - 16s 48ms/step - loss: 0.0580 - acc: 0.9885
Epoch 21/28

334/334 [==============================] - 16s 48ms/step - loss: 0.0574 - acc: 0.9881
Epoch 22/28

334/334 [==============================] - 16s 48ms/step - loss: 0.0531 - acc: 0.9894
Epoch 23/28

334/334 [==============================] - 16s 48ms/step - loss: 0.0511 - acc: 0.9885
Epoch 24/28

334/334 [==============================] - 16s 48ms/step - loss: 0.0486 - acc: 0.9884
Epoch 25/28

334/334 [==============================] - 16s 48ms/step - loss: 0.0424 - acc: 0.9916
Epoch 26/28

334/334 [==============================] - 16s 48ms/step - loss: 0.0431 - acc: 0.9909
Epoch 27/28

334/334 [==============================] - 16s 48ms/step - loss: 0.0400 - acc: 0.9927
Epoch 28/28

334/334 [==============================] - 16s 48ms/step - loss: 0.0378 - acc: 0.9913
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8028
False 1043
True percentage 0.885018189836
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.97      7318
      B-PER       0.82      0.73      0.78       438
      B-ORG       0.67      0.67      0.67       296
      I-ORG       0.41      0.40      0.41       151
     B-MISC       0.43      0.29      0.35       141
     I-MISC       0.42      0.35      0.38       154
      I-PER       0.87      0.57      0.69       214
      B-LOC       0.74      0.69      0.71       218
      I-LOC       0.71      0.70      0.70       141

avg / total       0.92      0.89      0.90      9071

F-1 Score (without O):
0.634843417452
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104355 unique words.
4351 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 262
OOV word occurences: in test 406
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678784     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,914
Trainable params: 6,790,914
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 18s 55ms/step - loss: 0.7303 - acc: 0.7779
Epoch 2/28

334/334 [==============================] - 16s 48ms/step - loss: 0.4170 - acc: 0.8646
Epoch 3/28

334/334 [==============================] - 16s 48ms/step - loss: 0.3485 - acc: 0.8934
Epoch 4/28

334/334 [==============================] - 16s 48ms/step - loss: 0.3025 - acc: 0.9137
Epoch 5/28

334/334 [==============================] - 16s 48ms/step - loss: 0.2620 - acc: 0.9221
Epoch 6/28

334/334 [==============================] - 16s 48ms/step - loss: 0.2284 - acc: 0.9365
Epoch 7/28

334/334 [==============================] - 16s 48ms/step - loss: 0.2044 - acc: 0.9414
Epoch 8/28

334/334 [==============================] - 16s 47ms/step - loss: 0.1846 - acc: 0.9483
Epoch 9/28

334/334 [==============================] - 16s 48ms/step - loss: 0.1652 - acc: 0.9551
Epoch 10/28

334/334 [==============================] - 16s 48ms/step - loss: 0.1441 - acc: 0.9621
Epoch 11/28

334/334 [==============================] - 16s 47ms/step - loss: 0.1407 - acc: 0.9628
Epoch 12/28

334/334 [==============================] - 16s 48ms/step - loss: 0.1241 - acc: 0.9679
Epoch 13/28

334/334 [==============================] - 16s 48ms/step - loss: 0.1138 - acc: 0.9716
Epoch 14/28

334/334 [==============================] - 16s 48ms/step - loss: 0.1065 - acc: 0.9722
Epoch 15/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0936 - acc: 0.9782
Epoch 16/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0850 - acc: 0.9807
Epoch 17/28

334/334 [==============================] - 16s 48ms/step - loss: 0.0806 - acc: 0.9805
Epoch 18/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0722 - acc: 0.9820
Epoch 19/28

334/334 [==============================] - 16s 46ms/step - loss: 0.0712 - acc: 0.9822
Epoch 20/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0637 - acc: 0.9867
Epoch 21/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0600 - acc: 0.9878
Epoch 22/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0584 - acc: 0.9864
Epoch 23/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0520 - acc: 0.9882
Epoch 24/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0521 - acc: 0.9879
Epoch 25/28

334/334 [==============================] - 15s 45ms/step - loss: 0.0470 - acc: 0.9906
Epoch 26/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0442 - acc: 0.9904
Epoch 27/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0411 - acc: 0.9913
Epoch 28/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0432 - acc: 0.9913
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8062
False 1009
True percentage 0.888766398413
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.65      0.75      0.70       296
      B-PER       0.87      0.69      0.77       438
      I-PER       0.81      0.59      0.68       214
      B-LOC       0.70      0.67      0.69       218
      I-LOC       0.80      0.65      0.72       141
      I-ORG       0.49      0.59      0.54       151
     B-MISC       0.44      0.17      0.24       141
     I-MISC       0.52      0.29      0.38       154

avg / total       0.92      0.89      0.90      9071

F-1 Score (without O):
0.646333949476
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104348 unique words.
4344 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 262
OOV word occurences: in test 426
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678336     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,466
Trainable params: 6,790,466
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 18s 54ms/step - loss: 0.6566 - acc: 0.7951
Epoch 2/28

334/334 [==============================] - 16s 48ms/step - loss: 0.3865 - acc: 0.8742
Epoch 3/28

334/334 [==============================] - 16s 48ms/step - loss: 0.3206 - acc: 0.8996
Epoch 4/28

334/334 [==============================] - 16s 47ms/step - loss: 0.2776 - acc: 0.9182
Epoch 5/28

334/334 [==============================] - 16s 47ms/step - loss: 0.2441 - acc: 0.9294
Epoch 6/28

334/334 [==============================] - 16s 48ms/step - loss: 0.2112 - acc: 0.9428
Epoch 7/28

334/334 [==============================] - 16s 47ms/step - loss: 0.1896 - acc: 0.9459
Epoch 8/28

334/334 [==============================] - 16s 47ms/step - loss: 0.1711 - acc: 0.9553
Epoch 9/28

334/334 [==============================] - 16s 47ms/step - loss: 0.1574 - acc: 0.9572
Epoch 10/28

334/334 [==============================] - 16s 47ms/step - loss: 0.1431 - acc: 0.9638
Epoch 11/28

334/334 [==============================] - 16s 47ms/step - loss: 0.1269 - acc: 0.9675
Epoch 12/28

334/334 [==============================] - 16s 47ms/step - loss: 0.1171 - acc: 0.9691
Epoch 13/28

334/334 [==============================] - 16s 47ms/step - loss: 0.1050 - acc: 0.9761
Epoch 14/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0985 - acc: 0.9768
Epoch 15/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0914 - acc: 0.9778
Epoch 16/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0866 - acc: 0.9789
Epoch 17/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0785 - acc: 0.9815
Epoch 18/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0737 - acc: 0.9823
Epoch 19/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0698 - acc: 0.9821
Epoch 20/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0638 - acc: 0.9856
Epoch 21/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0608 - acc: 0.9860
Epoch 22/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0560 - acc: 0.9873
Epoch 23/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0514 - acc: 0.9893
Epoch 24/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0510 - acc: 0.9894
Epoch 25/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0453 - acc: 0.9912
Epoch 26/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0465 - acc: 0.9884
Epoch 27/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0453 - acc: 0.9888
Epoch 28/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0405 - acc: 0.9906
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7965
False 1106
True percentage 0.878072979826
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.97      7318
     B-MISC       0.33      0.23      0.28       141
     I-MISC       0.43      0.34      0.38       154
      B-ORG       0.65      0.61      0.63       296
      B-LOC       0.69      0.72      0.70       218
      B-PER       0.85      0.68      0.75       438
      I-PER       0.91      0.54      0.67       214
      I-ORG       0.41      0.42      0.41       151
      I-LOC       0.57      0.77      0.65       141

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.609881782358
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104309 unique words.
4305 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 264
OOV word occurences: in test 431
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6675840     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,787,970
Trainable params: 6,787,970
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 18s 55ms/step - loss: 0.7129 - acc: 0.7934
Epoch 2/28

334/334 [==============================] - 16s 48ms/step - loss: 0.3959 - acc: 0.8713
Epoch 3/28

334/334 [==============================] - 16s 48ms/step - loss: 0.3299 - acc: 0.8974
Epoch 4/28

334/334 [==============================] - 16s 48ms/step - loss: 0.2879 - acc: 0.9185
Epoch 5/28

334/334 [==============================] - 16s 48ms/step - loss: 0.2509 - acc: 0.9312
Epoch 6/28

334/334 [==============================] - 16s 48ms/step - loss: 0.2276 - acc: 0.9360
Epoch 7/28

334/334 [==============================] - 16s 48ms/step - loss: 0.2026 - acc: 0.9448
Epoch 8/28

334/334 [==============================] - 16s 48ms/step - loss: 0.1817 - acc: 0.9523
Epoch 9/28

334/334 [==============================] - 16s 48ms/step - loss: 0.1669 - acc: 0.9581
Epoch 10/28

334/334 [==============================] - 16s 48ms/step - loss: 0.1459 - acc: 0.9637
Epoch 11/28

334/334 [==============================] - 16s 48ms/step - loss: 0.1385 - acc: 0.9656
Epoch 12/28

334/334 [==============================] - 16s 48ms/step - loss: 0.1258 - acc: 0.9675
Epoch 13/28

334/334 [==============================] - 16s 48ms/step - loss: 0.1170 - acc: 0.9721
Epoch 14/28

334/334 [==============================] - 16s 47ms/step - loss: 0.1072 - acc: 0.9735
Epoch 15/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0967 - acc: 0.9774
Epoch 16/28

334/334 [==============================] - 16s 48ms/step - loss: 0.0901 - acc: 0.9783
Epoch 17/28

334/334 [==============================] - 16s 48ms/step - loss: 0.0837 - acc: 0.9813
Epoch 18/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0759 - acc: 0.9813
Epoch 19/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0743 - acc: 0.9838
Epoch 20/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0705 - acc: 0.9833
Epoch 21/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0632 - acc: 0.9860
Epoch 22/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0610 - acc: 0.9860
Epoch 23/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0559 - acc: 0.9886
Epoch 24/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0547 - acc: 0.9864
Epoch 25/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0510 - acc: 0.9894
Epoch 26/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0487 - acc: 0.9892
Epoch 27/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0431 - acc: 0.9903
Epoch 28/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0428 - acc: 0.9909
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7958
False 1113
True percentage 0.877301289825
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.85      0.67      0.75       438
      I-PER       0.78      0.60      0.68       214
          O       0.97      0.96      0.97      7318
      B-ORG       0.63      0.66      0.64       296
      B-LOC       0.76      0.65      0.70       218
      I-ORG       0.32      0.40      0.36       151
      I-LOC       0.75      0.57      0.65       141
     B-MISC       0.41      0.20      0.27       141
     I-MISC       0.40      0.26      0.32       154

avg / total       0.92      0.88      0.89      9071

F-1 Score (without O):
0.90555785246
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104194 unique words.
4190 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 275
OOV word occurences: in test 464
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6668480     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,780,610
Trainable params: 6,780,610
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 11s 64ms/step - loss: 0.7953 - acc: 0.7632
Epoch 2/28

167/167 [==============================] - 8s 50ms/step - loss: 0.4019 - acc: 0.8769
Epoch 3/28

167/167 [==============================] - 8s 49ms/step - loss: 0.3515 - acc: 0.8911
Epoch 4/28

167/167 [==============================] - 8s 50ms/step - loss: 0.2995 - acc: 0.9093
Epoch 5/28

167/167 [==============================] - 8s 50ms/step - loss: 0.2664 - acc: 0.9250
Epoch 6/28

167/167 [==============================] - 8s 50ms/step - loss: 0.2371 - acc: 0.9308
Epoch 7/28

167/167 [==============================] - 8s 50ms/step - loss: 0.2081 - acc: 0.9432
Epoch 8/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1913 - acc: 0.9498
Epoch 9/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1729 - acc: 0.9522
Epoch 10/28

167/167 [==============================] - 8s 49ms/step - loss: 0.1640 - acc: 0.9592
Epoch 11/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1343 - acc: 0.9729
Epoch 12/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1259 - acc: 0.9722
Epoch 13/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1188 - acc: 0.9739
Epoch 14/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1065 - acc: 0.9758
Epoch 15/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0994 - acc: 0.9805
Epoch 16/28

167/167 [==============================] - 8s 49ms/step - loss: 0.0905 - acc: 0.9823
Epoch 17/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0833 - acc: 0.9841
Epoch 18/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0795 - acc: 0.9857
Epoch 19/28

167/167 [==============================] - 8s 49ms/step - loss: 0.0711 - acc: 0.9880
Epoch 20/28

167/167 [==============================] - 8s 49ms/step - loss: 0.0707 - acc: 0.9867
Epoch 21/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0628 - acc: 0.9863
Epoch 22/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0618 - acc: 0.9885
Epoch 23/28

167/167 [==============================] - 8s 49ms/step - loss: 0.0555 - acc: 0.9914
Epoch 24/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0523 - acc: 0.9899
Epoch 25/28

167/167 [==============================] - 8s 49ms/step - loss: 0.0497 - acc: 0.9908
Epoch 26/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0445 - acc: 0.9930
Epoch 27/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0430 - acc: 0.9933
Epoch 28/28

167/167 [==============================] - 8s 49ms/step - loss: 0.0416 - acc: 0.9931
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7914
False 1157
True percentage 0.872450666961
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.96      0.96      7318
      B-PER       0.86      0.62      0.72       438
      B-ORG       0.60      0.65      0.62       296
      I-ORG       0.34      0.39      0.37       151
      I-PER       0.81      0.58      0.68       214
      B-LOC       0.78      0.65      0.71       218
     B-MISC       0.46      0.12      0.19       141
      I-LOC       0.68      0.55      0.60       141
     I-MISC       0.63      0.12      0.21       154

avg / total       0.91      0.87      0.88      9071

F-1 Score (without O):
0.585635359116
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104185 unique words.
4181 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 272
OOV word occurences: in test 428
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6667904     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,780,034
Trainable params: 6,780,034
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 11s 64ms/step - loss: 0.8722 - acc: 0.7504
Epoch 2/28

167/167 [==============================] - 8s 50ms/step - loss: 0.4546 - acc: 0.8556
Epoch 3/28

167/167 [==============================] - 8s 50ms/step - loss: 0.3854 - acc: 0.8798
Epoch 4/28

167/167 [==============================] - 8s 50ms/step - loss: 0.3386 - acc: 0.8975
Epoch 5/28

167/167 [==============================] - 8s 50ms/step - loss: 0.2978 - acc: 0.9115
Epoch 6/28

167/167 [==============================] - 8s 50ms/step - loss: 0.2711 - acc: 0.9218
Epoch 7/28

167/167 [==============================] - 8s 50ms/step - loss: 0.2426 - acc: 0.9320
Epoch 8/28

167/167 [==============================] - 8s 50ms/step - loss: 0.2242 - acc: 0.9381
Epoch 9/28

167/167 [==============================] - 8s 50ms/step - loss: 0.2058 - acc: 0.9438
Epoch 10/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1890 - acc: 0.9481
Epoch 11/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1730 - acc: 0.9565
Epoch 12/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1564 - acc: 0.9577
Epoch 13/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1484 - acc: 0.9620
Epoch 14/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1374 - acc: 0.9667
Epoch 15/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1304 - acc: 0.9690
Epoch 16/28

167/167 [==============================] - 8s 49ms/step - loss: 0.1155 - acc: 0.9738
Epoch 17/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1075 - acc: 0.9758
Epoch 18/28

167/167 [==============================] - 8s 49ms/step - loss: 0.1038 - acc: 0.9763
Epoch 19/28

167/167 [==============================] - 8s 49ms/step - loss: 0.0998 - acc: 0.9803
Epoch 20/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0837 - acc: 0.9823
Epoch 21/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0822 - acc: 0.9847
Epoch 22/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0759 - acc: 0.9852
Epoch 23/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0708 - acc: 0.9876
Epoch 24/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0673 - acc: 0.9877
Epoch 25/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0662 - acc: 0.9874
Epoch 26/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0605 - acc: 0.9916
Epoch 27/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0532 - acc: 0.9923
Epoch 28/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0495 - acc: 0.9920
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7857
False 1214
True percentage 0.866166905523
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-PER       0.87      0.66      0.75       438
      B-ORG       0.55      0.62      0.59       296
      I-ORG       0.26      0.46      0.33       151
     B-MISC       0.31      0.12      0.17       141
     I-MISC       0.22      0.13      0.16       154
      I-PER       0.74      0.58      0.65       214
      B-LOC       0.70      0.69      0.70       218
      I-LOC       0.70      0.32      0.44       141

avg / total       0.91      0.87      0.88      9071

F-1 Score (without O):
0.54884004884
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104214 unique words.
4210 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 271
OOV word occurences: in test 452
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6669760     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,781,890
Trainable params: 6,781,890
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 11s 64ms/step - loss: 0.8907 - acc: 0.7292
Epoch 2/28

167/167 [==============================] - 8s 50ms/step - loss: 0.4712 - acc: 0.8485
Epoch 3/28

167/167 [==============================] - 8s 50ms/step - loss: 0.3931 - acc: 0.8780
Epoch 4/28

167/167 [==============================] - 8s 50ms/step - loss: 0.3525 - acc: 0.8928
Epoch 5/28

167/167 [==============================] - 8s 50ms/step - loss: 0.3116 - acc: 0.9074
Epoch 6/28

167/167 [==============================] - 8s 50ms/step - loss: 0.2886 - acc: 0.9168
Epoch 7/28

167/167 [==============================] - 8s 50ms/step - loss: 0.2571 - acc: 0.9273
Epoch 8/28

167/167 [==============================] - 8s 50ms/step - loss: 0.2383 - acc: 0.9299
Epoch 9/28

167/167 [==============================] - 8s 50ms/step - loss: 0.2071 - acc: 0.9415
Epoch 10/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1974 - acc: 0.9495
Epoch 11/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1796 - acc: 0.9545
Epoch 12/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1714 - acc: 0.9576
Epoch 13/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1525 - acc: 0.9585
Epoch 14/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1389 - acc: 0.9677
Epoch 15/28

167/167 [==============================] - 8s 49ms/step - loss: 0.1341 - acc: 0.9649
Epoch 16/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1292 - acc: 0.9665
Epoch 17/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1156 - acc: 0.9744
Epoch 18/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1036 - acc: 0.9787
Epoch 19/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1004 - acc: 0.9801
Epoch 20/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0974 - acc: 0.9798
Epoch 21/28

167/167 [==============================] - 8s 49ms/step - loss: 0.0865 - acc: 0.9814
Epoch 22/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0830 - acc: 0.9820
Epoch 23/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0762 - acc: 0.9852
Epoch 24/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0728 - acc: 0.9856
Epoch 25/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0679 - acc: 0.9862
Epoch 26/28

167/167 [==============================] - 8s 49ms/step - loss: 0.0630 - acc: 0.9886
Epoch 27/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0629 - acc: 0.9876
Epoch 28/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0573 - acc: 0.9897
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7876
False 1195
True percentage 0.868261492669
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.97      7318
      B-ORG       0.59      0.66      0.62       296
      B-PER       0.81      0.66      0.73       438
      I-PER       0.80      0.49      0.60       214
      B-LOC       0.69      0.57      0.63       218
      I-LOC       0.71      0.40      0.52       141
      I-ORG       0.31      0.52      0.39       151
     B-MISC       0.30      0.23      0.26       141
     I-MISC       0.43      0.32      0.37       154

avg / total       0.92      0.87      0.89      9071

F-1 Score (without O):
0.562178517398
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104201 unique words.
4197 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 270
OOV word occurences: in test 452
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6668928     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,781,058
Trainable params: 6,781,058
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 11s 65ms/step - loss: 0.9886 - acc: 0.7340
Epoch 2/28

167/167 [==============================] - 8s 50ms/step - loss: 0.4632 - acc: 0.8507
Epoch 3/28

167/167 [==============================] - 8s 50ms/step - loss: 0.3732 - acc: 0.8837
Epoch 4/28

167/167 [==============================] - 8s 50ms/step - loss: 0.3326 - acc: 0.9008
Epoch 5/28

167/167 [==============================] - 8s 51ms/step - loss: 0.2926 - acc: 0.9138
Epoch 6/28

167/167 [==============================] - 8s 50ms/step - loss: 0.2680 - acc: 0.9192
Epoch 7/28

167/167 [==============================] - 8s 50ms/step - loss: 0.2385 - acc: 0.9276
Epoch 8/28

167/167 [==============================] - 8s 49ms/step - loss: 0.2243 - acc: 0.9356
Epoch 9/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1936 - acc: 0.9455
Epoch 10/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1760 - acc: 0.9556
Epoch 11/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1677 - acc: 0.9527
Epoch 12/28

167/167 [==============================] - 8s 51ms/step - loss: 0.1526 - acc: 0.9599
Epoch 13/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1375 - acc: 0.9663
Epoch 14/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1329 - acc: 0.9646
Epoch 15/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1208 - acc: 0.9735
Epoch 16/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1126 - acc: 0.9746
Epoch 17/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1089 - acc: 0.9738
Epoch 18/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0947 - acc: 0.9810
Epoch 19/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0902 - acc: 0.9813
Epoch 20/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0849 - acc: 0.9847
Epoch 21/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0789 - acc: 0.9835
Epoch 22/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0724 - acc: 0.9861
Epoch 23/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0676 - acc: 0.9882
Epoch 24/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0628 - acc: 0.9887
Epoch 25/28

167/167 [==============================] - 8s 49ms/step - loss: 0.0597 - acc: 0.9894
Epoch 26/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0574 - acc: 0.9901
Epoch 27/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0540 - acc: 0.9922
Epoch 28/28

167/167 [==============================] - 8s 51ms/step - loss: 0.0508 - acc: 0.9920
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7882
False 1189
True percentage 0.868922941241
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
     B-MISC       0.31      0.23      0.27       141
     I-MISC       0.35      0.31      0.33       154
      B-ORG       0.61      0.55      0.58       296
      B-LOC       0.75      0.61      0.68       218
      B-PER       0.82      0.64      0.72       438
      I-PER       0.84      0.55      0.67       214
      I-ORG       0.34      0.40      0.37       151
      I-LOC       0.68      0.67      0.67       141

avg / total       0.91      0.87      0.89      9071

F-1 Score (without O):
0.574776441566
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104181 unique words.
4177 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 273
OOV word occurences: in test 525
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6667648     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,779,778
Trainable params: 6,779,778
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 11s 64ms/step - loss: 0.7952 - acc: 0.7536
Epoch 2/28

167/167 [==============================] - 8s 49ms/step - loss: 0.4391 - acc: 0.8616
Epoch 3/28

167/167 [==============================] - 8s 50ms/step - loss: 0.3750 - acc: 0.8849
Epoch 4/28

167/167 [==============================] - 8s 50ms/step - loss: 0.3268 - acc: 0.9024
Epoch 5/28

167/167 [==============================] - 8s 50ms/step - loss: 0.2841 - acc: 0.9206
Epoch 6/28

167/167 [==============================] - 8s 50ms/step - loss: 0.2583 - acc: 0.9293
Epoch 7/28

167/167 [==============================] - 8s 50ms/step - loss: 0.2342 - acc: 0.9380
Epoch 8/28

167/167 [==============================] - 8s 50ms/step - loss: 0.2130 - acc: 0.9421
Epoch 9/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1870 - acc: 0.9520
Epoch 10/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1772 - acc: 0.9535
Epoch 11/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1609 - acc: 0.9594
Epoch 12/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1439 - acc: 0.9636
Epoch 13/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1388 - acc: 0.9662
Epoch 14/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1214 - acc: 0.9722
Epoch 15/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1116 - acc: 0.9746
Epoch 16/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1014 - acc: 0.9760
Epoch 17/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0943 - acc: 0.9811
Epoch 18/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0849 - acc: 0.9821
Epoch 19/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0814 - acc: 0.9819
Epoch 20/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0766 - acc: 0.9850
Epoch 21/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0682 - acc: 0.9878
Epoch 22/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0627 - acc: 0.9884
Epoch 23/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0605 - acc: 0.9905
Epoch 24/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0579 - acc: 0.9890
Epoch 25/28

167/167 [==============================] - 8s 49ms/step - loss: 0.0526 - acc: 0.9926
Epoch 26/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0549 - acc: 0.9886
Epoch 27/28

167/167 [==============================] - 8s 49ms/step - loss: 0.0479 - acc: 0.9903
Epoch 28/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0447 - acc: 0.9928
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7761
False 1310
True percentage 0.855583728365
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.81      0.47      0.60       438
      I-PER       0.79      0.38      0.51       214
          O       0.98      0.95      0.96      7318
      B-ORG       0.55      0.57      0.56       296
      B-LOC       0.65      0.64      0.65       218
      I-ORG       0.29      0.42      0.34       151
      I-LOC       0.70      0.59      0.64       141
     B-MISC       0.35      0.20      0.25       141
     I-MISC       0.38      0.36      0.37       154

avg / total       0.91      0.86      0.88      9071

F-1 Score (without O):
0.892684079896
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104112 unique words.
4108 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 562
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663232     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,362
Trainable params: 6,775,362
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 7s 83ms/step - loss: 1.2685 - acc: 0.6836
Epoch 2/28

83/83 [==============================] - 4s 54ms/step - loss: 0.4995 - acc: 0.8441
Epoch 3/28

83/83 [==============================] - 5s 55ms/step - loss: 0.4305 - acc: 0.8664
Epoch 4/28

83/83 [==============================] - 5s 55ms/step - loss: 0.3849 - acc: 0.8860
Epoch 5/28

83/83 [==============================] - 4s 54ms/step - loss: 0.3438 - acc: 0.9032
Epoch 6/28

83/83 [==============================] - 5s 55ms/step - loss: 0.3212 - acc: 0.9018
Epoch 7/28

83/83 [==============================] - 5s 55ms/step - loss: 0.2942 - acc: 0.9186
Epoch 8/28

83/83 [==============================] - 5s 55ms/step - loss: 0.2785 - acc: 0.9233
Epoch 9/28

83/83 [==============================] - 5s 56ms/step - loss: 0.2673 - acc: 0.9255
Epoch 10/28

83/83 [==============================] - 5s 54ms/step - loss: 0.2453 - acc: 0.9349
Epoch 11/28

83/83 [==============================] - 5s 55ms/step - loss: 0.2236 - acc: 0.9407
Epoch 12/28

83/83 [==============================] - 5s 56ms/step - loss: 0.2162 - acc: 0.9407
Epoch 13/28

83/83 [==============================] - 5s 54ms/step - loss: 0.1966 - acc: 0.9504
Epoch 14/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1949 - acc: 0.9481
Epoch 15/28

83/83 [==============================] - 5s 56ms/step - loss: 0.1810 - acc: 0.9549
Epoch 16/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1675 - acc: 0.9661
Epoch 17/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1605 - acc: 0.9629
Epoch 18/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1495 - acc: 0.9661
Epoch 19/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1465 - acc: 0.9645
Epoch 20/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1445 - acc: 0.9641
Epoch 21/28

83/83 [==============================] - 5s 56ms/step - loss: 0.1357 - acc: 0.9686
Epoch 22/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1213 - acc: 0.9747
Epoch 23/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1160 - acc: 0.9797
Epoch 24/28

83/83 [==============================] - 5s 54ms/step - loss: 0.1138 - acc: 0.9791
Epoch 25/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1065 - acc: 0.9806
Epoch 26/28

83/83 [==============================] - 5s 54ms/step - loss: 0.0974 - acc: 0.9825
Epoch 27/28

83/83 [==============================] - 5s 56ms/step - loss: 0.0963 - acc: 0.9796
Epoch 28/28

83/83 [==============================] - 5s 55ms/step - loss: 0.0912 - acc: 0.9881
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7633
False 1438
True percentage 0.841472825488
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.95      0.95      7318
      B-PER       0.81      0.46      0.59       438
      B-ORG       0.42      0.54      0.47       296
      I-ORG       0.22      0.31      0.26       151
      I-PER       0.71      0.41      0.52       214
      B-LOC       0.66      0.67      0.67       218
     B-MISC       0.60      0.02      0.04       141
      I-LOC       0.60      0.38      0.46       141
     I-MISC       0.70      0.10      0.18       154

avg / total       0.89      0.84      0.86      9071

F-1 Score (without O):
0.467820973538
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104114 unique words.
4110 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 276
OOV word occurences: in test 456
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663360     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,490
Trainable params: 6,775,490
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 7s 83ms/step - loss: 1.2358 - acc: 0.6349
Epoch 2/28

83/83 [==============================] - 4s 54ms/step - loss: 0.5694 - acc: 0.8201
Epoch 3/28

83/83 [==============================] - 5s 55ms/step - loss: 0.4927 - acc: 0.8419
Epoch 4/28

83/83 [==============================] - 5s 55ms/step - loss: 0.4217 - acc: 0.8711
Epoch 5/28

83/83 [==============================] - 4s 53ms/step - loss: 0.3736 - acc: 0.8883
Epoch 6/28

83/83 [==============================] - 5s 56ms/step - loss: 0.3696 - acc: 0.8847
Epoch 7/28

83/83 [==============================] - 5s 55ms/step - loss: 0.3267 - acc: 0.9006
Epoch 8/28

83/83 [==============================] - 5s 54ms/step - loss: 0.2908 - acc: 0.9115
Epoch 9/28

83/83 [==============================] - 5s 55ms/step - loss: 0.2603 - acc: 0.9257
Epoch 10/28

83/83 [==============================] - 5s 55ms/step - loss: 0.2466 - acc: 0.9339
Epoch 11/28

83/83 [==============================] - 5s 54ms/step - loss: 0.2286 - acc: 0.9450
Epoch 12/28

83/83 [==============================] - 5s 54ms/step - loss: 0.2133 - acc: 0.9475
Epoch 13/28

83/83 [==============================] - 5s 54ms/step - loss: 0.2004 - acc: 0.9517
Epoch 14/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1839 - acc: 0.9640
Epoch 15/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1676 - acc: 0.9672
Epoch 16/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1619 - acc: 0.9687
Epoch 17/28

83/83 [==============================] - 5s 54ms/step - loss: 0.1496 - acc: 0.9734
Epoch 18/28

83/83 [==============================] - 4s 54ms/step - loss: 0.1373 - acc: 0.9726
Epoch 19/28

83/83 [==============================] - 5s 54ms/step - loss: 0.1368 - acc: 0.9743
Epoch 20/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1261 - acc: 0.9792
Epoch 21/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1200 - acc: 0.9815
Epoch 22/28

83/83 [==============================] - 5s 54ms/step - loss: 0.1084 - acc: 0.9828
Epoch 23/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1077 - acc: 0.9806
Epoch 24/28

83/83 [==============================] - 5s 54ms/step - loss: 0.1001 - acc: 0.9831
Epoch 25/28

83/83 [==============================] - 4s 54ms/step - loss: 0.0944 - acc: 0.9869
Epoch 26/28

83/83 [==============================] - 5s 54ms/step - loss: 0.0889 - acc: 0.9871
Epoch 27/28

83/83 [==============================] - 4s 54ms/step - loss: 0.0855 - acc: 0.9863
Epoch 28/28

83/83 [==============================] - 5s 54ms/step - loss: 0.0789 - acc: 0.9880
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7775
False 1296
True percentage 0.857127108367
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.95      0.96      7318
      B-PER       0.74      0.64      0.69       438
      B-ORG       0.57      0.51      0.54       296
      I-ORG       0.29      0.26      0.28       151
     B-MISC       0.33      0.08      0.13       141
     I-MISC       0.33      0.25      0.29       154
      I-PER       0.72      0.50      0.59       214
      B-LOC       0.61      0.64      0.63       218
      I-LOC       0.66      0.43      0.52       141

avg / total       0.89      0.86      0.87      9071

F-1 Score (without O):
0.526315789474
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104134 unique words.
4130 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 280
OOV word occurences: in test 543
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6664640     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,776,770
Trainable params: 6,776,770
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 7s 84ms/step - loss: 1.4494 - acc: 0.6181
Epoch 2/28

83/83 [==============================] - 4s 54ms/step - loss: 0.6518 - acc: 0.8096
Epoch 3/28

83/83 [==============================] - 5s 54ms/step - loss: 0.5229 - acc: 0.8429
Epoch 4/28

83/83 [==============================] - 5s 55ms/step - loss: 0.4616 - acc: 0.8617
Epoch 5/28

83/83 [==============================] - 5s 55ms/step - loss: 0.4383 - acc: 0.8698
Epoch 6/28

83/83 [==============================] - 5s 54ms/step - loss: 0.3997 - acc: 0.8888
Epoch 7/28

83/83 [==============================] - 5s 55ms/step - loss: 0.3549 - acc: 0.8934
Epoch 8/28

83/83 [==============================] - 5s 55ms/step - loss: 0.3360 - acc: 0.9018
Epoch 9/28

83/83 [==============================] - 5s 55ms/step - loss: 0.3089 - acc: 0.9083
Epoch 10/28

83/83 [==============================] - 5s 55ms/step - loss: 0.2852 - acc: 0.9171
Epoch 11/28

83/83 [==============================] - 5s 54ms/step - loss: 0.2693 - acc: 0.9319
Epoch 12/28

83/83 [==============================] - 4s 54ms/step - loss: 0.2497 - acc: 0.9373
Epoch 13/28

83/83 [==============================] - 5s 55ms/step - loss: 0.2313 - acc: 0.9383
Epoch 14/28

83/83 [==============================] - 5s 54ms/step - loss: 0.2217 - acc: 0.9417
Epoch 15/28

83/83 [==============================] - 5s 55ms/step - loss: 0.2080 - acc: 0.9504
Epoch 16/28

83/83 [==============================] - 5s 55ms/step - loss: 0.2004 - acc: 0.9562
Epoch 17/28

83/83 [==============================] - 5s 54ms/step - loss: 0.1840 - acc: 0.9572
Epoch 18/28

83/83 [==============================] - 4s 54ms/step - loss: 0.1741 - acc: 0.9621
Epoch 19/28

83/83 [==============================] - 5s 54ms/step - loss: 0.1592 - acc: 0.9653
Epoch 20/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1561 - acc: 0.9668
Epoch 21/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1586 - acc: 0.9619
Epoch 22/28

83/83 [==============================] - 5s 54ms/step - loss: 0.1411 - acc: 0.9765
Epoch 23/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1293 - acc: 0.9741
Epoch 24/28

83/83 [==============================] - 5s 54ms/step - loss: 0.1253 - acc: 0.9719
Epoch 25/28

83/83 [==============================] - 4s 54ms/step - loss: 0.1173 - acc: 0.9779
Epoch 26/28

83/83 [==============================] - 4s 54ms/step - loss: 0.1094 - acc: 0.9844
Epoch 27/28

83/83 [==============================] - 4s 54ms/step - loss: 0.1022 - acc: 0.9810
Epoch 28/28

83/83 [==============================] - 5s 55ms/step - loss: 0.0990 - acc: 0.9816
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7609
False 1462
True percentage 0.838827031198
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-ORG       0.43      0.57      0.49       296
      B-PER       0.81      0.44      0.57       438
      I-PER       0.58      0.34      0.43       214
      B-LOC       0.73      0.48      0.58       218
      I-LOC       0.47      0.40      0.43       141
      I-ORG       0.18      0.34      0.23       151
     B-MISC       0.28      0.09      0.14       141
     I-MISC       0.32      0.13      0.19       154

avg / total       0.89      0.84      0.86      9071

F-1 Score (without O):
0.427221172023
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104118 unique words.
4114 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 276
OOV word occurences: in test 477
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663616     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,746
Trainable params: 6,775,746
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 7s 83ms/step - loss: 0.9916 - acc: 0.7082
Epoch 2/28

83/83 [==============================] - 5s 55ms/step - loss: 0.5025 - acc: 0.8376
Epoch 3/28

83/83 [==============================] - 5s 55ms/step - loss: 0.4236 - acc: 0.8553
Epoch 4/28

83/83 [==============================] - 5s 55ms/step - loss: 0.3531 - acc: 0.8879
Epoch 5/28

83/83 [==============================] - 4s 54ms/step - loss: 0.3198 - acc: 0.8952
Epoch 6/28

83/83 [==============================] - 5s 55ms/step - loss: 0.2933 - acc: 0.9105
Epoch 7/28

83/83 [==============================] - 5s 55ms/step - loss: 0.2712 - acc: 0.9179
Epoch 8/28

83/83 [==============================] - 5s 55ms/step - loss: 0.2492 - acc: 0.9295
Epoch 9/28

83/83 [==============================] - 5s 55ms/step - loss: 0.2369 - acc: 0.9256
Epoch 10/28

83/83 [==============================] - 5s 55ms/step - loss: 0.2104 - acc: 0.9439
Epoch 11/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1968 - acc: 0.9402
Epoch 12/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1877 - acc: 0.9500
Epoch 13/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1667 - acc: 0.9592
Epoch 14/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1578 - acc: 0.9620
Epoch 15/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1522 - acc: 0.9711
Epoch 16/28

83/83 [==============================] - 4s 54ms/step - loss: 0.1399 - acc: 0.9667
Epoch 17/28

83/83 [==============================] - 4s 54ms/step - loss: 0.1286 - acc: 0.9743
Epoch 18/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1194 - acc: 0.9746
Epoch 19/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1144 - acc: 0.9789
Epoch 20/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1074 - acc: 0.9739
Epoch 21/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1034 - acc: 0.9824
Epoch 22/28

83/83 [==============================] - 5s 56ms/step - loss: 0.0906 - acc: 0.9891
Epoch 23/28

83/83 [==============================] - 5s 55ms/step - loss: 0.0840 - acc: 0.9854
Epoch 24/28

83/83 [==============================] - 4s 54ms/step - loss: 0.0836 - acc: 0.9841
Epoch 25/28

83/83 [==============================] - 4s 54ms/step - loss: 0.0821 - acc: 0.9876
Epoch 26/28

83/83 [==============================] - 5s 55ms/step - loss: 0.0770 - acc: 0.9867
Epoch 27/28

83/83 [==============================] - 5s 55ms/step - loss: 0.0721 - acc: 0.9869
Epoch 28/28

83/83 [==============================] - 4s 54ms/step - loss: 0.0659 - acc: 0.9894
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7661
False 1410
True percentage 0.844559585492
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.95      0.95      7318
     B-MISC       0.23      0.13      0.17       141
     I-MISC       0.28      0.12      0.17       154
      B-ORG       0.50      0.39      0.44       296
      B-LOC       0.68      0.61      0.64       218
      B-PER       0.72      0.55      0.62       438
      I-PER       0.62      0.45      0.52       214
      I-ORG       0.23      0.29      0.26       151
      I-LOC       0.61      0.49      0.54       141

avg / total       0.88      0.84      0.86      9071

F-1 Score (without O):
0.471529110685
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104107 unique words.
4103 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 276
OOV word occurences: in test 528
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6662912     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,042
Trainable params: 6,775,042
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 7s 83ms/step - loss: 1.3338 - acc: 0.6530
Epoch 2/28

83/83 [==============================] - 4s 54ms/step - loss: 0.5856 - acc: 0.8288
Epoch 3/28

83/83 [==============================] - 4s 54ms/step - loss: 0.4905 - acc: 0.8424
Epoch 4/28

83/83 [==============================] - 4s 54ms/step - loss: 0.4282 - acc: 0.8537
Epoch 5/28

83/83 [==============================] - 5s 55ms/step - loss: 0.3836 - acc: 0.8724
Epoch 6/28

83/83 [==============================] - 4s 54ms/step - loss: 0.3527 - acc: 0.8944
Epoch 7/28

83/83 [==============================] - 5s 54ms/step - loss: 0.3266 - acc: 0.8937
Epoch 8/28

83/83 [==============================] - 5s 54ms/step - loss: 0.2953 - acc: 0.9128
Epoch 9/28

83/83 [==============================] - 4s 54ms/step - loss: 0.2891 - acc: 0.9096
Epoch 10/28

83/83 [==============================] - 4s 54ms/step - loss: 0.2596 - acc: 0.9301
Epoch 11/28

83/83 [==============================] - 5s 55ms/step - loss: 0.2395 - acc: 0.9315
Epoch 12/28

83/83 [==============================] - 4s 54ms/step - loss: 0.2267 - acc: 0.9387
Epoch 13/28

83/83 [==============================] - 5s 55ms/step - loss: 0.2174 - acc: 0.9328
Epoch 14/28

83/83 [==============================] - 5s 54ms/step - loss: 0.2042 - acc: 0.9477
Epoch 15/28

83/83 [==============================] - 5s 54ms/step - loss: 0.1903 - acc: 0.9551
Epoch 16/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1790 - acc: 0.9543
Epoch 17/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1774 - acc: 0.9568
Epoch 18/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1571 - acc: 0.9628
Epoch 19/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1494 - acc: 0.9630
Epoch 20/28

83/83 [==============================] - 4s 54ms/step - loss: 0.1419 - acc: 0.9684
Epoch 21/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1340 - acc: 0.9685
Epoch 22/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1248 - acc: 0.9740
Epoch 23/28

83/83 [==============================] - 5s 54ms/step - loss: 0.1220 - acc: 0.9775
Epoch 24/28

83/83 [==============================] - 5s 54ms/step - loss: 0.1114 - acc: 0.9806
Epoch 25/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1124 - acc: 0.9782
Epoch 26/28

83/83 [==============================] - 5s 55ms/step - loss: 0.0974 - acc: 0.9831
Epoch 27/28

83/83 [==============================] - 5s 54ms/step - loss: 0.0970 - acc: 0.9839
Epoch 28/28

83/83 [==============================] - 5s 55ms/step - loss: 0.0900 - acc: 0.9881
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7546
False 1525
True percentage 0.831881821188
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.75      0.38      0.51       438
      I-PER       0.81      0.14      0.24       214
          O       0.97      0.95      0.96      7318
      B-ORG       0.47      0.65      0.55       296
      B-LOC       0.72      0.57      0.64       218
      I-ORG       0.16      0.44      0.24       151
      I-LOC       0.59      0.12      0.20       141
     B-MISC       0.71      0.04      0.07       141
     I-MISC       0.20      0.14      0.17       154

avg / total       0.90      0.83      0.85      9071

F-1 Score (without O):
0.870406417743
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104069 unique words.
4065 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660480     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,610
Trainable params: 6,772,610
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 5s 142ms/step - loss: 1.6462 - acc: 0.4902
Epoch 2/28

33/33 [==============================] - 2s 69ms/step - loss: 0.5037 - acc: 0.8726
Epoch 3/28

33/33 [==============================] - 2s 71ms/step - loss: 0.3499 - acc: 0.8812
Epoch 4/28

33/33 [==============================] - 2s 68ms/step - loss: 0.2902 - acc: 0.8988
Epoch 5/28

33/33 [==============================] - 2s 69ms/step - loss: 0.2649 - acc: 0.9079
Epoch 6/28

33/33 [==============================] - 2s 69ms/step - loss: 0.2390 - acc: 0.9251
Epoch 7/28

33/33 [==============================] - 2s 69ms/step - loss: 0.2356 - acc: 0.9272
Epoch 8/28

33/33 [==============================] - 2s 68ms/step - loss: 0.2414 - acc: 0.9271
Epoch 9/28

33/33 [==============================] - 2s 68ms/step - loss: 0.1953 - acc: 0.9476
Epoch 10/28

33/33 [==============================] - 2s 68ms/step - loss: 0.1847 - acc: 0.9505
Epoch 11/28

33/33 [==============================] - 2s 69ms/step - loss: 0.1838 - acc: 0.9521
Epoch 12/28

33/33 [==============================] - 2s 68ms/step - loss: 0.1724 - acc: 0.9556
Epoch 13/28

33/33 [==============================] - 2s 70ms/step - loss: 0.1938 - acc: 0.9396
Epoch 14/28

33/33 [==============================] - 2s 70ms/step - loss: 0.1636 - acc: 0.9450
Epoch 15/28

33/33 [==============================] - 2s 70ms/step - loss: 0.1514 - acc: 0.9606
Epoch 16/28

33/33 [==============================] - 2s 68ms/step - loss: 0.1346 - acc: 0.9760
Epoch 17/28

33/33 [==============================] - 2s 70ms/step - loss: 0.1300 - acc: 0.9714
Epoch 18/28

33/33 [==============================] - 2s 70ms/step - loss: 0.1238 - acc: 0.9776
Epoch 19/28

33/33 [==============================] - 2s 71ms/step - loss: 0.1210 - acc: 0.9702
Epoch 20/28

33/33 [==============================] - 2s 68ms/step - loss: 0.1078 - acc: 0.9739
Epoch 21/28

33/33 [==============================] - 2s 69ms/step - loss: 0.1101 - acc: 0.9804
Epoch 22/28

33/33 [==============================] - 2s 70ms/step - loss: 0.0952 - acc: 0.9902
Epoch 23/28

33/33 [==============================] - 2s 70ms/step - loss: 0.1026 - acc: 0.9706
Epoch 24/28

33/33 [==============================] - 2s 70ms/step - loss: 0.0851 - acc: 0.9801
Epoch 25/28

33/33 [==============================] - 2s 70ms/step - loss: 0.0995 - acc: 0.9803
Epoch 26/28

33/33 [==============================] - 2s 67ms/step - loss: 0.0888 - acc: 0.9818
Epoch 27/28

33/33 [==============================] - 2s 70ms/step - loss: 0.0761 - acc: 0.9834
Epoch 28/28

33/33 [==============================] - 2s 68ms/step - loss: 0.0822 - acc: 0.9777
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7263
False 1808
True percentage 0.800683496858
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.94      0.93      7318
      B-PER       0.42      0.36      0.39       438
      B-ORG       0.33      0.39      0.36       296
      I-ORG       0.22      0.19      0.21       151
      I-PER       0.43      0.39      0.41       214
      B-LOC       0.47      0.10      0.16       218
     B-MISC       0.00      0.00      0.00       141
      I-LOC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.80      0.80      0.80      9071

F-1 Score (without O):
0.284910306015
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104062 unique words.
4058 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 281
OOV word occurences: in test 473
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660032     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,162
Trainable params: 6,772,162
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 5s 142ms/step - loss: 1.5019 - acc: 0.4698
Epoch 2/28

33/33 [==============================] - 2s 68ms/step - loss: 0.9363 - acc: 0.7966
Epoch 3/28

33/33 [==============================] - 2s 69ms/step - loss: 0.5963 - acc: 0.8193
Epoch 4/28

33/33 [==============================] - 2s 68ms/step - loss: 0.5274 - acc: 0.8330
Epoch 5/28

33/33 [==============================] - 2s 69ms/step - loss: 0.4764 - acc: 0.8402
Epoch 6/28

33/33 [==============================] - 2s 69ms/step - loss: 0.4252 - acc: 0.8516
Epoch 7/28

33/33 [==============================] - 2s 69ms/step - loss: 0.4008 - acc: 0.8750
Epoch 8/28

33/33 [==============================] - 2s 69ms/step - loss: 0.3922 - acc: 0.8753
Epoch 9/28

33/33 [==============================] - 2s 69ms/step - loss: 0.3452 - acc: 0.8926
Epoch 10/28

33/33 [==============================] - 2s 70ms/step - loss: 0.3947 - acc: 0.8699
Epoch 11/28

33/33 [==============================] - 2s 69ms/step - loss: 0.3091 - acc: 0.9076
Epoch 12/28

33/33 [==============================] - 2s 70ms/step - loss: 0.2975 - acc: 0.8991
Epoch 13/28

33/33 [==============================] - 2s 69ms/step - loss: 0.2818 - acc: 0.9104
Epoch 14/28

33/33 [==============================] - 2s 68ms/step - loss: 0.2566 - acc: 0.9265
Epoch 15/28

33/33 [==============================] - 2s 69ms/step - loss: 0.2530 - acc: 0.9228
Epoch 16/28

33/33 [==============================] - 2s 68ms/step - loss: 0.2532 - acc: 0.9185
Epoch 17/28

33/33 [==============================] - 2s 68ms/step - loss: 0.2278 - acc: 0.9275
Epoch 18/28

33/33 [==============================] - 2s 68ms/step - loss: 0.2119 - acc: 0.9391
Epoch 19/28

33/33 [==============================] - 2s 68ms/step - loss: 0.2095 - acc: 0.9548
Epoch 20/28

33/33 [==============================] - 2s 69ms/step - loss: 0.3001 - acc: 0.9053
Epoch 21/28

33/33 [==============================] - 2s 70ms/step - loss: 0.2030 - acc: 0.9390
Epoch 22/28

33/33 [==============================] - 2s 69ms/step - loss: 0.1966 - acc: 0.9498
Epoch 23/28

33/33 [==============================] - 2s 69ms/step - loss: 0.1891 - acc: 0.9480
Epoch 24/28

33/33 [==============================] - 2s 69ms/step - loss: 0.1787 - acc: 0.9605
Epoch 25/28

33/33 [==============================] - 2s 70ms/step - loss: 0.1616 - acc: 0.9751
Epoch 26/28

33/33 [==============================] - 2s 69ms/step - loss: 0.1456 - acc: 0.9903
Epoch 27/28

33/33 [==============================] - 2s 69ms/step - loss: 0.1515 - acc: 0.9792
Epoch 28/28

33/33 [==============================] - 2s 69ms/step - loss: 0.1425 - acc: 0.9784
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7352
False 1719
True percentage 0.810494984015
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.93      0.95      7318
      B-PER       0.77      0.31      0.44       438
      B-ORG       0.30      0.59      0.40       296
      I-ORG       0.16      0.56      0.25       151
     B-MISC       0.42      0.12      0.19       141
     I-MISC       0.28      0.08      0.13       154
      I-PER       0.79      0.30      0.44       214
      B-LOC       0.32      0.23      0.27       218
      I-LOC       1.00      0.03      0.06       141

avg / total       0.89      0.81      0.83      9071

F-1 Score (without O):
0.324644549763
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104087 unique words.
4083 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 553
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6661632     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,773,762
Trainable params: 6,773,762
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 5s 142ms/step - loss: 1.6023 - acc: 0.4822
Epoch 2/28

33/33 [==============================] - 2s 68ms/step - loss: 0.9593 - acc: 0.7776
Epoch 3/28

33/33 [==============================] - 2s 68ms/step - loss: 0.6249 - acc: 0.8320
Epoch 4/28

33/33 [==============================] - 2s 68ms/step - loss: 0.5490 - acc: 0.8182
Epoch 5/28

33/33 [==============================] - 2s 68ms/step - loss: 0.5068 - acc: 0.8478
Epoch 6/28

33/33 [==============================] - 2s 68ms/step - loss: 0.4884 - acc: 0.8335
Epoch 7/28

33/33 [==============================] - 2s 68ms/step - loss: 0.4299 - acc: 0.8721
Epoch 8/28

33/33 [==============================] - 2s 69ms/step - loss: 0.4088 - acc: 0.8729
Epoch 9/28

33/33 [==============================] - 2s 68ms/step - loss: 0.4039 - acc: 0.8770
Epoch 10/28

33/33 [==============================] - 2s 69ms/step - loss: 0.3782 - acc: 0.9022
Epoch 11/28

33/33 [==============================] - 2s 69ms/step - loss: 0.3422 - acc: 0.9180
Epoch 12/28

33/33 [==============================] - 2s 68ms/step - loss: 0.3301 - acc: 0.9256
Epoch 13/28

33/33 [==============================] - 2s 69ms/step - loss: 0.3202 - acc: 0.9224
Epoch 14/28

33/33 [==============================] - 2s 69ms/step - loss: 0.2835 - acc: 0.9145
Epoch 15/28

33/33 [==============================] - 2s 68ms/step - loss: 0.2907 - acc: 0.9263
Epoch 16/28

33/33 [==============================] - 2s 69ms/step - loss: 0.2590 - acc: 0.9384
Epoch 17/28

33/33 [==============================] - 2s 69ms/step - loss: 0.2485 - acc: 0.9431
Epoch 18/28

33/33 [==============================] - 2s 69ms/step - loss: 0.2630 - acc: 0.9459
Epoch 19/28

33/33 [==============================] - 2s 69ms/step - loss: 0.2268 - acc: 0.9586
Epoch 20/28

33/33 [==============================] - 2s 68ms/step - loss: 0.2238 - acc: 0.9601
Epoch 21/28

33/33 [==============================] - 2s 68ms/step - loss: 0.2352 - acc: 0.9412
Epoch 22/28

33/33 [==============================] - 2s 70ms/step - loss: 0.2133 - acc: 0.9634
Epoch 23/28

33/33 [==============================] - 2s 68ms/step - loss: 0.1871 - acc: 0.9699
Epoch 24/28

33/33 [==============================] - 2s 68ms/step - loss: 0.1915 - acc: 0.9646
Epoch 25/28

33/33 [==============================] - 2s 70ms/step - loss: 0.1801 - acc: 0.9801
Epoch 26/28

33/33 [==============================] - 2s 68ms/step - loss: 0.1856 - acc: 0.9750
Epoch 27/28

33/33 [==============================] - 2s 67ms/step - loss: 0.1618 - acc: 0.9804
Epoch 28/28

33/33 [==============================] - 2s 68ms/step - loss: 0.1595 - acc: 0.9790
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7405
False 1666
True percentage 0.816337779738
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.94      0.95      7318
      B-ORG       0.46      0.44      0.45       296
      B-PER       0.56      0.18      0.27       438
      I-PER       0.55      0.23      0.32       214
      B-LOC       0.49      0.53      0.51       218
      I-LOC       0.33      0.55      0.41       141
      I-ORG       0.15      0.16      0.15       151
     B-MISC       0.18      0.05      0.08       141
     I-MISC       0.33      0.12      0.17       154

avg / total       0.85      0.82      0.82      9071

F-1 Score (without O):
0.332887700535
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104068 unique words.
4064 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 279
OOV word occurences: in test 482
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660416     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,546
Trainable params: 6,772,546
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 5s 140ms/step - loss: 2.0155 - acc: 0.3971
Epoch 2/28

33/33 [==============================] - 2s 66ms/step - loss: 0.7942 - acc: 0.7853
Epoch 3/28

33/33 [==============================] - 2s 67ms/step - loss: 0.6633 - acc: 0.7977
Epoch 4/28

33/33 [==============================] - 2s 69ms/step - loss: 0.5834 - acc: 0.8097
Epoch 5/28

33/33 [==============================] - 2s 68ms/step - loss: 0.5535 - acc: 0.8248
Epoch 6/28

33/33 [==============================] - 2s 68ms/step - loss: 0.4533 - acc: 0.8492
Epoch 7/28

33/33 [==============================] - 2s 68ms/step - loss: 0.4851 - acc: 0.8362
Epoch 8/28

33/33 [==============================] - 2s 69ms/step - loss: 0.3981 - acc: 0.8676
Epoch 9/28

33/33 [==============================] - 2s 68ms/step - loss: 0.4413 - acc: 0.8410
Epoch 10/28

33/33 [==============================] - 2s 69ms/step - loss: 0.3747 - acc: 0.8665
Epoch 11/28

33/33 [==============================] - 2s 68ms/step - loss: 0.3643 - acc: 0.8806
Epoch 12/28

33/33 [==============================] - 2s 68ms/step - loss: 0.3369 - acc: 0.8972
Epoch 13/28

33/33 [==============================] - 2s 68ms/step - loss: 0.3238 - acc: 0.9042
Epoch 14/28

33/33 [==============================] - 2s 68ms/step - loss: 0.3118 - acc: 0.9301
Epoch 15/28

33/33 [==============================] - 2s 68ms/step - loss: 0.3171 - acc: 0.8917
Epoch 16/28

33/33 [==============================] - 2s 69ms/step - loss: 0.2922 - acc: 0.9155
Epoch 17/28

33/33 [==============================] - 2s 69ms/step - loss: 0.2642 - acc: 0.9238
Epoch 18/28

33/33 [==============================] - 2s 69ms/step - loss: 0.2735 - acc: 0.9169
Epoch 19/28

33/33 [==============================] - 2s 70ms/step - loss: 0.2640 - acc: 0.9239
Epoch 20/28

33/33 [==============================] - 2s 68ms/step - loss: 0.2352 - acc: 0.9491
Epoch 21/28

33/33 [==============================] - 2s 70ms/step - loss: 0.2233 - acc: 0.9545
Epoch 22/28

33/33 [==============================] - 2s 68ms/step - loss: 0.2251 - acc: 0.9435
Epoch 23/28

33/33 [==============================] - 2s 69ms/step - loss: 0.2267 - acc: 0.9535
Epoch 24/28

33/33 [==============================] - 2s 68ms/step - loss: 0.2129 - acc: 0.9441
Epoch 25/28

33/33 [==============================] - 2s 69ms/step - loss: 0.1998 - acc: 0.9535
Epoch 26/28

33/33 [==============================] - 2s 68ms/step - loss: 0.2131 - acc: 0.9405
Epoch 27/28

33/33 [==============================] - 2s 69ms/step - loss: 0.2016 - acc: 0.9496
Epoch 28/28

33/33 [==============================] - 2s 68ms/step - loss: 0.1839 - acc: 0.9622
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7312
False 1759
True percentage 0.806085326866
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.91      0.95      0.93      7318
     B-MISC       0.13      0.10      0.11       141
     I-MISC       0.00      0.00      0.00       154
      B-ORG       0.31      0.33      0.32       296
      B-LOC       0.62      0.25      0.36       218
      B-PER       0.64      0.27      0.38       438
      I-PER       0.63      0.17      0.27       214
      I-ORG       0.16      0.23      0.19       151
      I-LOC       0.50      0.04      0.07       141

avg / total       0.82      0.81      0.80      9071

F-1 Score (without O):
0.264372024899
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104068 unique words.
4064 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 281
OOV word occurences: in test 534
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660416     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,546
Trainable params: 6,772,546
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 5s 143ms/step - loss: 1.4690 - acc: 0.5410
Epoch 2/28

33/33 [==============================] - 2s 69ms/step - loss: 0.8880 - acc: 0.8158
Epoch 3/28

33/33 [==============================] - 2s 68ms/step - loss: 0.6343 - acc: 0.8388
Epoch 4/28

33/33 [==============================] - 2s 68ms/step - loss: 0.5218 - acc: 0.8425
Epoch 5/28

33/33 [==============================] - 2s 70ms/step - loss: 0.4734 - acc: 0.8589
Epoch 6/28

33/33 [==============================] - 2s 70ms/step - loss: 0.4384 - acc: 0.8645
Epoch 7/28

33/33 [==============================] - 2s 69ms/step - loss: 0.3774 - acc: 0.8923
Epoch 8/28

33/33 [==============================] - 2s 68ms/step - loss: 0.3446 - acc: 0.9022
Epoch 9/28

33/33 [==============================] - 2s 69ms/step - loss: 0.3390 - acc: 0.8954
Epoch 10/28

33/33 [==============================] - 2s 68ms/step - loss: 0.3475 - acc: 0.8729
Epoch 11/28

33/33 [==============================] - 2s 69ms/step - loss: 0.2929 - acc: 0.9067
Epoch 12/28

33/33 [==============================] - 2s 69ms/step - loss: 0.2658 - acc: 0.9261
Epoch 13/28

33/33 [==============================] - 2s 70ms/step - loss: 0.2864 - acc: 0.9263
Epoch 14/28

33/33 [==============================] - 2s 69ms/step - loss: 0.2398 - acc: 0.9333
Epoch 15/28

33/33 [==============================] - 2s 70ms/step - loss: 0.2451 - acc: 0.9305
Epoch 16/28

33/33 [==============================] - 2s 69ms/step - loss: 0.2258 - acc: 0.9505
Epoch 17/28

33/33 [==============================] - 2s 69ms/step - loss: 0.2228 - acc: 0.9329
Epoch 18/28

33/33 [==============================] - 2s 69ms/step - loss: 0.2113 - acc: 0.9396
Epoch 19/28

33/33 [==============================] - 2s 68ms/step - loss: 0.2002 - acc: 0.9533
Epoch 20/28

33/33 [==============================] - 2s 70ms/step - loss: 0.1925 - acc: 0.9492
Epoch 21/28

33/33 [==============================] - 2s 69ms/step - loss: 0.1857 - acc: 0.9514
Epoch 22/28

33/33 [==============================] - 2s 70ms/step - loss: 0.1732 - acc: 0.9629
Epoch 23/28

33/33 [==============================] - 2s 69ms/step - loss: 0.1601 - acc: 0.9517
Epoch 24/28

33/33 [==============================] - 2s 69ms/step - loss: 0.1640 - acc: 0.9557
Epoch 25/28

33/33 [==============================] - 2s 70ms/step - loss: 0.1578 - acc: 0.9760
Epoch 26/28

33/33 [==============================] - 2s 69ms/step - loss: 0.1537 - acc: 0.9696
Epoch 27/28

33/33 [==============================] - 2s 70ms/step - loss: 0.1437 - acc: 0.9743
Epoch 28/28

33/33 [==============================] - 2s 70ms/step - loss: 0.1479 - acc: 0.9712
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7322
False 1749
True percentage 0.807187741153
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.59      0.37      0.46       438
      I-PER       0.00      0.00      0.00       214
          O       0.97      0.93      0.95      7318
      B-ORG       0.33      0.59      0.42       296
      B-LOC       0.61      0.17      0.27       218
      I-ORG       0.17      0.45      0.24       151
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.17      0.03      0.05       141
     I-MISC       0.22      0.22      0.22       154

avg / total       0.84      0.81      0.82      9071

F-1 Score (without O):
0.847451607175
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 7 unique labels.
Found 104057 unique words.
4053 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659712     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 8)        1112        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,544
Trainable params: 6,771,544
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 3s 200ms/step - loss: 2.0349 - acc: 0.1629
Epoch 2/28

16/16 [==============================] - 1s 48ms/step - loss: 0.7383 - acc: 0.8287
Epoch 3/28

16/16 [==============================] - 1s 47ms/step - loss: 0.5924 - acc: 0.8483
Epoch 4/28

16/16 [==============================] - 1s 47ms/step - loss: 0.6305 - acc: 0.8287
Epoch 5/28

16/16 [==============================] - 1s 48ms/step - loss: 0.5331 - acc: 0.8792
Epoch 6/28

16/16 [==============================] - 1s 49ms/step - loss: 0.4730 - acc: 0.8315
Epoch 7/28

16/16 [==============================] - 1s 48ms/step - loss: 0.3706 - acc: 0.8904
Epoch 8/28

16/16 [==============================] - 1s 48ms/step - loss: 0.3273 - acc: 0.8792
Epoch 9/28

16/16 [==============================] - 1s 50ms/step - loss: 0.2992 - acc: 0.9185
Epoch 10/28

16/16 [==============================] - 1s 49ms/step - loss: 0.2682 - acc: 0.9242
Epoch 11/28

16/16 [==============================] - 1s 48ms/step - loss: 0.2376 - acc: 0.9382
Epoch 12/28

16/16 [==============================] - 1s 49ms/step - loss: 0.2321 - acc: 0.9354
Epoch 13/28

16/16 [==============================] - 1s 48ms/step - loss: 0.2007 - acc: 0.9635
Epoch 14/28

16/16 [==============================] - 1s 47ms/step - loss: 0.1955 - acc: 0.9354
Epoch 15/28

16/16 [==============================] - 1s 47ms/step - loss: 0.1846 - acc: 0.9747
Epoch 16/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1683 - acc: 0.9579
Epoch 17/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1515 - acc: 0.9747
Epoch 18/28

16/16 [==============================] - 1s 49ms/step - loss: 0.1490 - acc: 0.9775
Epoch 19/28

16/16 [==============================] - 1s 47ms/step - loss: 0.1379 - acc: 0.9747
Epoch 20/28

16/16 [==============================] - 1s 47ms/step - loss: 0.1260 - acc: 0.9831
Epoch 21/28

16/16 [==============================] - 1s 49ms/step - loss: 0.1085 - acc: 0.9860
Epoch 22/28

16/16 [==============================] - 1s 47ms/step - loss: 0.1156 - acc: 0.9775
Epoch 23/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1100 - acc: 0.9803
Epoch 24/28

16/16 [==============================] - 1s 49ms/step - loss: 0.1053 - acc: 0.9860
Epoch 25/28

16/16 [==============================] - 1s 48ms/step - loss: 0.0912 - acc: 0.9831
Epoch 26/28

16/16 [==============================] - 1s 49ms/step - loss: 0.0912 - acc: 0.9860
Epoch 27/28

16/16 [==============================] - 1s 48ms/step - loss: 0.0934 - acc: 0.9803
Epoch 28/28

16/16 [==============================] - 1s 48ms/step - loss: 0.0908 - acc: 0.9916
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7191
False 1585
True percentage 0.819393801276
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.94      0.94      7318
      B-PER       0.53      0.28      0.36       438
      B-ORG       0.23      0.43      0.30       296
      I-ORG       0.13      0.27      0.17       151
      I-PER       0.53      0.19      0.28       214
      B-LOC       0.00      0.00      0.00       218
     B-MISC       0.00      0.00      0.00       141

avg / total       0.83      0.82      0.82      8776

F-1 Score (without O):
0.249429657795
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104046 unique words.
4042 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659008     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,138
Trainable params: 6,771,138
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 3s 200ms/step - loss: 2.2851 - acc: 0.2765
Epoch 2/28

16/16 [==============================] - 1s 48ms/step - loss: 0.9101 - acc: 0.8235
Epoch 3/28

16/16 [==============================] - 1s 48ms/step - loss: 0.6789 - acc: 0.8265
Epoch 4/28

16/16 [==============================] - 1s 48ms/step - loss: 0.7316 - acc: 0.8265
Epoch 5/28

16/16 [==============================] - 1s 48ms/step - loss: 0.6727 - acc: 0.8765
Epoch 6/28

16/16 [==============================] - 1s 48ms/step - loss: 0.6356 - acc: 0.8265
Epoch 7/28

16/16 [==============================] - 1s 47ms/step - loss: 0.4520 - acc: 0.8676
Epoch 8/28

16/16 [==============================] - 1s 48ms/step - loss: 0.4171 - acc: 0.8529
Epoch 9/28

16/16 [==============================] - 1s 48ms/step - loss: 0.3701 - acc: 0.9000
Epoch 10/28

16/16 [==============================] - 1s 48ms/step - loss: 0.3471 - acc: 0.8824
Epoch 11/28

16/16 [==============================] - 1s 49ms/step - loss: 0.3314 - acc: 0.9088
Epoch 12/28

16/16 [==============================] - 1s 48ms/step - loss: 0.2940 - acc: 0.9176
Epoch 13/28

16/16 [==============================] - 1s 47ms/step - loss: 0.2914 - acc: 0.9088
Epoch 14/28

16/16 [==============================] - 1s 48ms/step - loss: 0.2648 - acc: 0.9324
Epoch 15/28

16/16 [==============================] - 1s 48ms/step - loss: 0.2576 - acc: 0.9324
Epoch 16/28

16/16 [==============================] - 1s 48ms/step - loss: 0.2360 - acc: 0.9529
Epoch 17/28

16/16 [==============================] - 1s 47ms/step - loss: 0.2247 - acc: 0.9382
Epoch 18/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1986 - acc: 0.9735
Epoch 19/28

16/16 [==============================] - 1s 47ms/step - loss: 0.1919 - acc: 0.9647
Epoch 20/28

16/16 [==============================] - 1s 47ms/step - loss: 0.1864 - acc: 0.9706
Epoch 21/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1818 - acc: 0.9765
Epoch 22/28

16/16 [==============================] - 1s 46ms/step - loss: 0.1700 - acc: 0.9765
Epoch 23/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1741 - acc: 0.9618
Epoch 24/28

16/16 [==============================] - 1s 47ms/step - loss: 0.1574 - acc: 0.9676
Epoch 25/28

16/16 [==============================] - 1s 47ms/step - loss: 0.1551 - acc: 0.9706
Epoch 26/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1367 - acc: 0.9765
Epoch 27/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1266 - acc: 0.9824
Epoch 28/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1317 - acc: 0.9794
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7175
False 1896
True percentage 0.79098225113
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.94      0.94      7318
      B-PER       0.36      0.22      0.28       438
      B-ORG       0.25      0.36      0.29       296
      I-ORG       0.18      0.13      0.15       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      I-PER       0.22      0.33      0.26       214
      B-LOC       0.37      0.11      0.18       218
      I-LOC       0.25      0.01      0.03       141

avg / total       0.80      0.79      0.79      9071

F-1 Score (without O):
0.217801753203
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104060 unique words.
4056 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 567
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659904     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,034
Trainable params: 6,772,034
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 3s 199ms/step - loss: 2.5858 - acc: 0.0166
Epoch 2/28

16/16 [==============================] - 1s 48ms/step - loss: 1.2133 - acc: 0.7530
Epoch 3/28

16/16 [==============================] - 1s 49ms/step - loss: 0.7476 - acc: 0.7743
Epoch 4/28

16/16 [==============================] - 1s 49ms/step - loss: 0.6282 - acc: 0.8599
Epoch 5/28

16/16 [==============================] - 1s 49ms/step - loss: 0.6416 - acc: 0.7862
Epoch 6/28

16/16 [==============================] - 1s 46ms/step - loss: 0.5958 - acc: 0.8575
Epoch 7/28

16/16 [==============================] - 1s 48ms/step - loss: 0.4335 - acc: 0.8884
Epoch 8/28

16/16 [==============================] - 1s 47ms/step - loss: 0.3979 - acc: 0.9050
Epoch 9/28

16/16 [==============================] - 1s 48ms/step - loss: 0.3531 - acc: 0.8979
Epoch 10/28

16/16 [==============================] - 1s 48ms/step - loss: 0.3469 - acc: 0.9169
Epoch 11/28

16/16 [==============================] - 1s 47ms/step - loss: 0.3058 - acc: 0.9240
Epoch 12/28

16/16 [==============================] - 1s 47ms/step - loss: 0.2727 - acc: 0.9406
Epoch 13/28

16/16 [==============================] - 1s 47ms/step - loss: 0.2704 - acc: 0.9311
Epoch 14/28

16/16 [==============================] - 1s 48ms/step - loss: 0.2549 - acc: 0.9430
Epoch 15/28

16/16 [==============================] - 1s 48ms/step - loss: 0.2320 - acc: 0.9525
Epoch 16/28

16/16 [==============================] - 1s 47ms/step - loss: 0.2256 - acc: 0.9501
Epoch 17/28

16/16 [==============================] - 1s 47ms/step - loss: 0.2066 - acc: 0.9572
Epoch 18/28

16/16 [==============================] - 1s 49ms/step - loss: 0.1970 - acc: 0.9620
Epoch 19/28

16/16 [==============================] - 1s 49ms/step - loss: 0.1955 - acc: 0.9525
Epoch 20/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1704 - acc: 0.9644
Epoch 21/28

16/16 [==============================] - 1s 47ms/step - loss: 0.1672 - acc: 0.9715
Epoch 22/28

16/16 [==============================] - 1s 47ms/step - loss: 0.1522 - acc: 0.9739
Epoch 23/28

16/16 [==============================] - 1s 49ms/step - loss: 0.1502 - acc: 0.9786
Epoch 24/28

16/16 [==============================] - 1s 47ms/step - loss: 0.1563 - acc: 0.9667
Epoch 25/28

16/16 [==============================] - 1s 49ms/step - loss: 0.1255 - acc: 0.9786
Epoch 26/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1273 - acc: 0.9857
Epoch 27/28

16/16 [==============================] - 1s 46ms/step - loss: 0.1162 - acc: 0.9810
Epoch 28/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1143 - acc: 0.9762
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7315
False 1756
True percentage 0.806416051152
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.94      0.95      7318
      B-ORG       0.31      0.35      0.33       296
      B-PER       0.41      0.25      0.31       438
      I-PER       0.42      0.33      0.37       214
      B-LOC       0.62      0.41      0.50       218
      I-LOC       0.50      0.02      0.04       141
      I-ORG       0.12      0.25      0.16       151
     B-MISC       0.17      0.01      0.03       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.83      0.81      0.81      9071

F-1 Score (without O):
0.277128547579
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104057 unique words.
4053 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 281
OOV word occurences: in test 492
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659712     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,842
Trainable params: 6,771,842
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 3s 199ms/step - loss: 2.0906 - acc: 0.1288
Epoch 2/28

16/16 [==============================] - 1s 48ms/step - loss: 0.7970 - acc: 0.7945
Epoch 3/28

16/16 [==============================] - 1s 50ms/step - loss: 0.6445 - acc: 0.8356
Epoch 4/28

16/16 [==============================] - 1s 47ms/step - loss: 0.6115 - acc: 0.8055
Epoch 5/28

16/16 [==============================] - 1s 47ms/step - loss: 0.5143 - acc: 0.8795
Epoch 6/28

16/16 [==============================] - 1s 47ms/step - loss: 0.4370 - acc: 0.8521
Epoch 7/28

16/16 [==============================] - 1s 49ms/step - loss: 0.3941 - acc: 0.8822
Epoch 8/28

16/16 [==============================] - 1s 48ms/step - loss: 0.3729 - acc: 0.8904
Epoch 9/28

16/16 [==============================] - 1s 48ms/step - loss: 0.3409 - acc: 0.9151
Epoch 10/28

16/16 [==============================] - 1s 48ms/step - loss: 0.3139 - acc: 0.9260
Epoch 11/28

16/16 [==============================] - 1s 48ms/step - loss: 0.2913 - acc: 0.9315
Epoch 12/28

16/16 [==============================] - 1s 48ms/step - loss: 0.2621 - acc: 0.9452
Epoch 13/28

16/16 [==============================] - 1s 48ms/step - loss: 0.2558 - acc: 0.9507
Epoch 14/28

16/16 [==============================] - 1s 48ms/step - loss: 0.2417 - acc: 0.9507
Epoch 15/28

16/16 [==============================] - 1s 48ms/step - loss: 0.2395 - acc: 0.9507
Epoch 16/28

16/16 [==============================] - 1s 48ms/step - loss: 0.2096 - acc: 0.9671
Epoch 17/28

16/16 [==============================] - 1s 48ms/step - loss: 0.2050 - acc: 0.9671
Epoch 18/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1907 - acc: 0.9671
Epoch 19/28

16/16 [==============================] - 1s 49ms/step - loss: 0.1779 - acc: 0.9753
Epoch 20/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1694 - acc: 0.9726
Epoch 21/28

16/16 [==============================] - 1s 47ms/step - loss: 0.1627 - acc: 0.9781
Epoch 22/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1568 - acc: 0.9781
Epoch 23/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1426 - acc: 0.9808
Epoch 24/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1425 - acc: 0.9836
Epoch 25/28

16/16 [==============================] - 1s 47ms/step - loss: 0.1307 - acc: 0.9836
Epoch 26/28

16/16 [==============================] - 1s 47ms/step - loss: 0.1217 - acc: 0.9945
Epoch 27/28

16/16 [==============================] - 1s 47ms/step - loss: 0.1164 - acc: 0.9918
Epoch 28/28

16/16 [==============================] - 1s 49ms/step - loss: 0.1013 - acc: 0.9945
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7121
False 1950
True percentage 0.785029213979
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.92      0.94      7318
     B-MISC       0.05      0.08      0.06       141
     I-MISC       0.14      0.08      0.10       154
      B-ORG       0.22      0.37      0.28       296
      B-LOC       0.52      0.15      0.23       218
      B-PER       0.76      0.35      0.48       438
      I-PER       0.48      0.11      0.18       214
      I-ORG       0.07      0.22      0.11       151
      I-LOC       0.00      0.00      0.00       141

avg / total       0.85      0.79      0.81      9071

F-1 Score (without O):
0.225777241171
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104046 unique words.
4042 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659008     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,138
Trainable params: 6,771,138
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 3s 199ms/step - loss: 2.1613 - acc: 0.1955
Epoch 2/28

16/16 [==============================] - 1s 46ms/step - loss: 0.9193 - acc: 0.8173
Epoch 3/28

16/16 [==============================] - 1s 49ms/step - loss: 0.6112 - acc: 0.8173
Epoch 4/28

16/16 [==============================] - 1s 47ms/step - loss: 0.5144 - acc: 0.8814
Epoch 5/28

16/16 [==============================] - 1s 48ms/step - loss: 0.5705 - acc: 0.8205
Epoch 6/28

16/16 [==============================] - 1s 47ms/step - loss: 0.5680 - acc: 0.8942
Epoch 7/28

16/16 [==============================] - 1s 49ms/step - loss: 0.3848 - acc: 0.8718
Epoch 8/28

16/16 [==============================] - 1s 49ms/step - loss: 0.3439 - acc: 0.9135
Epoch 9/28

16/16 [==============================] - 1s 48ms/step - loss: 0.3192 - acc: 0.9135
Epoch 10/28

16/16 [==============================] - 1s 49ms/step - loss: 0.3056 - acc: 0.9263
Epoch 11/28

16/16 [==============================] - 1s 48ms/step - loss: 0.2798 - acc: 0.9391
Epoch 12/28

16/16 [==============================] - 1s 48ms/step - loss: 0.2619 - acc: 0.9391
Epoch 13/28

16/16 [==============================] - 1s 48ms/step - loss: 0.2595 - acc: 0.9519
Epoch 14/28

16/16 [==============================] - 1s 48ms/step - loss: 0.2433 - acc: 0.9327
Epoch 15/28

16/16 [==============================] - 1s 48ms/step - loss: 0.2253 - acc: 0.9583
Epoch 16/28

16/16 [==============================] - 1s 49ms/step - loss: 0.2302 - acc: 0.9391
Epoch 17/28

16/16 [==============================] - 1s 49ms/step - loss: 0.1920 - acc: 0.9551
Epoch 18/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1979 - acc: 0.9583
Epoch 19/28

16/16 [==============================] - 1s 49ms/step - loss: 0.1809 - acc: 0.9615
Epoch 20/28

16/16 [==============================] - 1s 49ms/step - loss: 0.1737 - acc: 0.9615
Epoch 21/28

16/16 [==============================] - 1s 49ms/step - loss: 0.1649 - acc: 0.9615
Epoch 22/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1434 - acc: 0.9679
Epoch 23/28

16/16 [==============================] - 1s 49ms/step - loss: 0.1438 - acc: 0.9776
Epoch 24/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1368 - acc: 0.9712
Epoch 25/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1372 - acc: 0.9679
Epoch 26/28

16/16 [==============================] - 1s 49ms/step - loss: 0.1386 - acc: 0.9744
Epoch 27/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1151 - acc: 0.9840
Epoch 28/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1207 - acc: 0.9744
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7238
False 1833
True percentage 0.79792746114
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.58      0.19      0.28       438
      I-PER       0.00      0.00      0.00       214
          O       0.95      0.93      0.94      7318
      B-ORG       0.28      0.45      0.35       296
      B-LOC       0.68      0.43      0.53       218
      I-ORG       0.13      0.38      0.19       151
      I-LOC       0.34      0.21      0.26       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.50      0.01      0.01       154

avg / total       0.84      0.80      0.81      9071

F-1 Score (without O):
0.842179592797
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 6 unique labels.
Found 104044 unique words.
4040 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658880     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 7)        966         bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,566
Trainable params: 6,770,566
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 3s 400ms/step - loss: 1.4977 - acc: 0.4033
Epoch 2/28

8/8 [==============================] - 1s 97ms/step - loss: 0.5727 - acc: 0.8729
Epoch 3/28

8/8 [==============================] - 1s 92ms/step - loss: 0.3614 - acc: 0.8895
Epoch 4/28

8/8 [==============================] - 1s 95ms/step - loss: 0.2640 - acc: 0.9171
Epoch 5/28

8/8 [==============================] - 1s 96ms/step - loss: 0.2144 - acc: 0.9227
Epoch 6/28

8/8 [==============================] - 1s 95ms/step - loss: 0.1944 - acc: 0.9613
Epoch 7/28

8/8 [==============================] - 1s 95ms/step - loss: 0.1834 - acc: 0.9392
Epoch 8/28

8/8 [==============================] - 1s 96ms/step - loss: 0.1465 - acc: 0.9613
Epoch 9/28

8/8 [==============================] - 1s 95ms/step - loss: 0.1100 - acc: 0.9890
Epoch 10/28

8/8 [==============================] - 1s 94ms/step - loss: 0.0888 - acc: 0.9945
Epoch 11/28

8/8 [==============================] - 1s 94ms/step - loss: 0.0852 - acc: 0.9945
Epoch 12/28

8/8 [==============================] - 1s 95ms/step - loss: 0.0685 - acc: 0.9890
Epoch 13/28

8/8 [==============================] - 1s 95ms/step - loss: 0.0589 - acc: 0.9945
Epoch 14/28

8/8 [==============================] - 1s 94ms/step - loss: 0.0597 - acc: 1.0000
Epoch 15/28

8/8 [==============================] - 1s 93ms/step - loss: 0.0548 - acc: 0.9890
Epoch 16/28

8/8 [==============================] - 1s 95ms/step - loss: 0.0472 - acc: 0.9945
Epoch 17/28

8/8 [==============================] - 1s 91ms/step - loss: 0.0389 - acc: 1.0000
Epoch 18/28

8/8 [==============================] - 1s 95ms/step - loss: 0.0388 - acc: 1.0000
Epoch 19/28

8/8 [==============================] - 1s 97ms/step - loss: 0.0331 - acc: 1.0000
Epoch 20/28

8/8 [==============================] - 1s 95ms/step - loss: 0.0314 - acc: 1.0000
Epoch 21/28

8/8 [==============================] - 1s 96ms/step - loss: 0.0283 - acc: 1.0000
Epoch 22/28

8/8 [==============================] - 1s 96ms/step - loss: 0.0261 - acc: 1.0000
Epoch 23/28

8/8 [==============================] - 1s 96ms/step - loss: 0.0246 - acc: 1.0000
Epoch 24/28

8/8 [==============================] - 1s 95ms/step - loss: 0.0275 - acc: 1.0000
Epoch 25/28

8/8 [==============================] - 1s 96ms/step - loss: 0.0280 - acc: 1.0000
Epoch 26/28

8/8 [==============================] - 1s 94ms/step - loss: 0.0228 - acc: 0.9945
Epoch 27/28

8/8 [==============================] - 1s 94ms/step - loss: 0.0202 - acc: 1.0000
Epoch 28/28

8/8 [==============================] - 1s 95ms/step - loss: 0.0195 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7150
False 1485
True percentage 0.828025477707
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.92      0.93      7318
      B-PER       0.28      0.51      0.36       438
      B-ORG       0.35      0.28      0.31       296
      I-ORG       0.21      0.06      0.09       151
      I-PER       0.40      0.36      0.38       214
      B-LOC       0.00      0.00      0.00       218

avg / total       0.83      0.83      0.83      8635

F-1 Score (without O):
0.302307692308
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104041 unique words.
4037 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658688     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,818
Trainable params: 6,770,818
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 3s 397ms/step - loss: 2.5584 - acc: 0.0405
Epoch 2/28

8/8 [==============================] - 1s 94ms/step - loss: 0.8909 - acc: 0.7977
Epoch 3/28

8/8 [==============================] - 1s 93ms/step - loss: 0.5935 - acc: 0.8208
Epoch 4/28

8/8 [==============================] - 1s 94ms/step - loss: 0.5034 - acc: 0.8324
Epoch 5/28

8/8 [==============================] - 1s 94ms/step - loss: 0.4420 - acc: 0.8960
Epoch 6/28

8/8 [==============================] - 1s 93ms/step - loss: 0.7303 - acc: 0.8208
Epoch 7/28

8/8 [==============================] - 1s 94ms/step - loss: 0.5321 - acc: 0.8902
Epoch 8/28

8/8 [==============================] - 1s 96ms/step - loss: 0.3563 - acc: 0.8671
Epoch 9/28

8/8 [==============================] - 1s 96ms/step - loss: 0.2918 - acc: 0.9422
Epoch 10/28

8/8 [==============================] - 1s 95ms/step - loss: 0.2734 - acc: 0.9133
Epoch 11/28

8/8 [==============================] - 1s 94ms/step - loss: 0.2589 - acc: 0.9249
Epoch 12/28

8/8 [==============================] - 1s 92ms/step - loss: 0.2509 - acc: 0.9306
Epoch 13/28

8/8 [==============================] - 1s 94ms/step - loss: 0.2426 - acc: 0.9249
Epoch 14/28

8/8 [==============================] - 1s 93ms/step - loss: 0.2119 - acc: 0.9653
Epoch 15/28

8/8 [==============================] - 1s 95ms/step - loss: 0.1958 - acc: 0.9653
Epoch 16/28

8/8 [==============================] - 1s 94ms/step - loss: 0.1780 - acc: 0.9827
Epoch 17/28

8/8 [==============================] - 1s 95ms/step - loss: 0.1786 - acc: 0.9538
Epoch 18/28

8/8 [==============================] - 1s 94ms/step - loss: 0.1799 - acc: 0.9711
Epoch 19/28

8/8 [==============================] - 1s 93ms/step - loss: 0.1528 - acc: 0.9827
Epoch 20/28

8/8 [==============================] - 1s 97ms/step - loss: 0.1411 - acc: 0.9827
Epoch 21/28

8/8 [==============================] - 1s 98ms/step - loss: 0.1276 - acc: 0.9769
Epoch 22/28

8/8 [==============================] - 1s 97ms/step - loss: 0.1226 - acc: 0.9827
Epoch 23/28

8/8 [==============================] - 1s 97ms/step - loss: 0.1199 - acc: 0.9942
Epoch 24/28

8/8 [==============================] - 1s 96ms/step - loss: 0.1048 - acc: 0.9942
Epoch 25/28

8/8 [==============================] - 1s 96ms/step - loss: 0.1014 - acc: 1.0000
Epoch 26/28

8/8 [==============================] - 1s 96ms/step - loss: 0.0940 - acc: 1.0000
Epoch 27/28

8/8 [==============================] - 1s 95ms/step - loss: 0.0922 - acc: 1.0000
Epoch 28/28

8/8 [==============================] - 1s 96ms/step - loss: 0.1000 - acc: 0.9827
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7098
False 1973
True percentage 0.782493661118
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.92      0.93      0.93      7318
      B-PER       0.32      0.25      0.28       438
      B-ORG       0.23      0.38      0.29       296
      I-ORG       0.00      0.00      0.00       151
     B-MISC       0.17      0.10      0.12       141
     I-MISC       0.18      0.05      0.08       154
      I-PER       0.20      0.13      0.16       214
      B-LOC       0.68      0.08      0.14       218
      I-LOC       0.57      0.03      0.05       141

avg / total       0.80      0.78      0.78      9071

F-1 Score (without O):
0.202566770725
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104044 unique words.
4040 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 567
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658880     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,010
Trainable params: 6,771,010
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 3s 399ms/step - loss: 1.8961 - acc: 0.3812
Epoch 2/28

8/8 [==============================] - 1s 93ms/step - loss: 1.0272 - acc: 0.7238
Epoch 3/28

8/8 [==============================] - 1s 96ms/step - loss: 1.2146 - acc: 0.6851
Epoch 4/28

8/8 [==============================] - 1s 94ms/step - loss: 0.8529 - acc: 0.7238
Epoch 5/28

8/8 [==============================] - 1s 97ms/step - loss: 0.6353 - acc: 0.7901
Epoch 6/28

8/8 [==============================] - 1s 94ms/step - loss: 0.5684 - acc: 0.8066
Epoch 7/28

8/8 [==============================] - 1s 94ms/step - loss: 0.4951 - acc: 0.8729
Epoch 8/28

8/8 [==============================] - 1s 96ms/step - loss: 0.4378 - acc: 0.9006
Epoch 9/28

8/8 [==============================] - 1s 97ms/step - loss: 0.3880 - acc: 0.9171
Epoch 10/28

8/8 [==============================] - 1s 95ms/step - loss: 0.3610 - acc: 0.9227
Epoch 11/28

8/8 [==============================] - 1s 94ms/step - loss: 0.3418 - acc: 0.9337
Epoch 12/28

8/8 [==============================] - 1s 95ms/step - loss: 0.2855 - acc: 0.9558
Epoch 13/28

8/8 [==============================] - 1s 95ms/step - loss: 0.2454 - acc: 0.9613
Epoch 14/28

8/8 [==============================] - 1s 93ms/step - loss: 0.2326 - acc: 0.9558
Epoch 15/28

8/8 [==============================] - 1s 96ms/step - loss: 0.1952 - acc: 0.9669
Epoch 16/28

8/8 [==============================] - 1s 96ms/step - loss: 0.1939 - acc: 0.9724
Epoch 17/28

8/8 [==============================] - 1s 93ms/step - loss: 0.1862 - acc: 0.9834
Epoch 18/28

8/8 [==============================] - 1s 97ms/step - loss: 0.1509 - acc: 0.9890
Epoch 19/28

8/8 [==============================] - 1s 96ms/step - loss: 0.1514 - acc: 0.9834
Epoch 20/28

8/8 [==============================] - 1s 92ms/step - loss: 0.1324 - acc: 0.9834
Epoch 21/28

8/8 [==============================] - 1s 95ms/step - loss: 0.1356 - acc: 0.9945
Epoch 22/28

8/8 [==============================] - 1s 95ms/step - loss: 0.1336 - acc: 0.9945
Epoch 23/28

8/8 [==============================] - 1s 96ms/step - loss: 0.0982 - acc: 1.0000
Epoch 24/28

8/8 [==============================] - 1s 97ms/step - loss: 0.1192 - acc: 0.9945
Epoch 25/28

8/8 [==============================] - 1s 93ms/step - loss: 0.0930 - acc: 1.0000
Epoch 26/28

8/8 [==============================] - 1s 96ms/step - loss: 0.0881 - acc: 1.0000
Epoch 27/28

8/8 [==============================] - 1s 95ms/step - loss: 0.0798 - acc: 1.0000
Epoch 28/28

8/8 [==============================] - 1s 96ms/step - loss: 0.0771 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7361
False 1710
True percentage 0.811487156874
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.95      0.94      7318
      B-ORG       0.39      0.27      0.32       296
      B-PER       0.50      0.42      0.46       438
      I-PER       0.39      0.32      0.35       214
      B-LOC       0.39      0.38      0.39       218
      I-LOC       0.33      0.01      0.03       141
      I-ORG       0.12      0.10      0.11       151
     B-MISC       0.32      0.04      0.07       141
     I-MISC       0.17      0.05      0.07       154

avg / total       0.83      0.81      0.81      9071

F-1 Score (without O):
0.306150656531
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 8 unique labels.
Found 104049 unique words.
4045 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 500
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659200     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,180
Trainable params: 6,771,180
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 3s 398ms/step - loss: 2.4401 - acc: 0.1250
Epoch 2/28

8/8 [==============================] - 1s 91ms/step - loss: 1.0016 - acc: 0.8261
Epoch 3/28

8/8 [==============================] - 1s 95ms/step - loss: 0.6137 - acc: 0.8261
Epoch 4/28

8/8 [==============================] - 1s 94ms/step - loss: 0.6036 - acc: 0.8804
Epoch 5/28

8/8 [==============================] - 1s 92ms/step - loss: 0.6542 - acc: 0.8261
Epoch 6/28

8/8 [==============================] - 1s 94ms/step - loss: 0.3919 - acc: 0.8750
Epoch 7/28

8/8 [==============================] - 1s 93ms/step - loss: 0.3573 - acc: 0.9022
Epoch 8/28

8/8 [==============================] - 1s 91ms/step - loss: 0.3209 - acc: 0.8804
Epoch 9/28

8/8 [==============================] - 1s 94ms/step - loss: 0.2840 - acc: 0.9293
Epoch 10/28

8/8 [==============================] - 1s 95ms/step - loss: 0.2524 - acc: 0.9293
Epoch 11/28

8/8 [==============================] - 1s 93ms/step - loss: 0.2263 - acc: 0.9511
Epoch 12/28

8/8 [==============================] - 1s 94ms/step - loss: 0.2031 - acc: 0.9620
Epoch 13/28

8/8 [==============================] - 1s 96ms/step - loss: 0.2033 - acc: 0.9457
Epoch 14/28

8/8 [==============================] - 1s 96ms/step - loss: 0.1676 - acc: 0.9674
Epoch 15/28

8/8 [==============================] - 1s 97ms/step - loss: 0.1643 - acc: 0.9783
Epoch 16/28

8/8 [==============================] - 1s 97ms/step - loss: 0.1612 - acc: 0.9728
Epoch 17/28

8/8 [==============================] - 1s 95ms/step - loss: 0.1607 - acc: 0.9728
Epoch 18/28

8/8 [==============================] - 1s 98ms/step - loss: 0.1460 - acc: 0.9728
Epoch 19/28

8/8 [==============================] - 1s 93ms/step - loss: 0.1179 - acc: 0.9891
Epoch 20/28

8/8 [==============================] - 1s 94ms/step - loss: 0.1142 - acc: 0.9783
Epoch 21/28

8/8 [==============================] - 1s 95ms/step - loss: 0.1121 - acc: 0.9946
Epoch 22/28

8/8 [==============================] - 1s 96ms/step - loss: 0.1059 - acc: 0.9891
Epoch 23/28

8/8 [==============================] - 1s 94ms/step - loss: 0.1132 - acc: 0.9837
Epoch 24/28

8/8 [==============================] - 1s 94ms/step - loss: 0.0906 - acc: 0.9946
Epoch 25/28

8/8 [==============================] - 1s 94ms/step - loss: 0.0881 - acc: 0.9891
Epoch 26/28

8/8 [==============================] - 1s 93ms/step - loss: 0.0935 - acc: 0.9891
Epoch 27/28

8/8 [==============================] - 1s 96ms/step - loss: 0.0775 - acc: 0.9946
Epoch 28/28

8/8 [==============================] - 1s 96ms/step - loss: 0.0758 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7016
False 1914
True percentage 0.785666293393
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.93      0.93      7318
     B-MISC       0.14      0.23      0.18       141
     I-MISC       0.04      0.01      0.02       154
      B-ORG       0.19      0.26      0.22       296
      B-LOC       0.00      0.00      0.00       218
      B-PER       0.59      0.19      0.29       438
      I-PER       0.00      0.00      0.00       214
      I-ORG       0.07      0.24      0.11       151

avg / total       0.81      0.79      0.79      8930

F-1 Score (without O):
0.158881691101
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104039 unique words.
4035 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658560     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,690
Trainable params: 6,770,690
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 3s 397ms/step - loss: 2.2653 - acc: 0.2152
Epoch 2/28

8/8 [==============================] - 1s 95ms/step - loss: 0.8617 - acc: 0.8291
Epoch 3/28

8/8 [==============================] - 1s 92ms/step - loss: 0.5326 - acc: 0.8354
Epoch 4/28

8/8 [==============================] - 1s 95ms/step - loss: 0.4280 - acc: 0.9114
Epoch 5/28

8/8 [==============================] - 1s 93ms/step - loss: 0.3789 - acc: 0.8797
Epoch 6/28

8/8 [==============================] - 1s 98ms/step - loss: 0.3442 - acc: 0.9241
Epoch 7/28

8/8 [==============================] - 1s 94ms/step - loss: 0.2779 - acc: 0.9304
Epoch 8/28

8/8 [==============================] - 1s 94ms/step - loss: 0.2627 - acc: 0.9304
Epoch 9/28

8/8 [==============================] - 1s 96ms/step - loss: 0.2306 - acc: 0.9494
Epoch 10/28

8/8 [==============================] - 1s 92ms/step - loss: 0.2022 - acc: 0.9494
Epoch 11/28

8/8 [==============================] - 1s 100ms/step - loss: 0.1730 - acc: 0.9557
Epoch 12/28

8/8 [==============================] - 1s 95ms/step - loss: 0.1655 - acc: 0.9557
Epoch 13/28

8/8 [==============================] - 1s 96ms/step - loss: 0.1607 - acc: 0.9747
Epoch 14/28

8/8 [==============================] - 1s 95ms/step - loss: 0.1470 - acc: 0.9684
Epoch 15/28

8/8 [==============================] - 1s 96ms/step - loss: 0.1281 - acc: 0.9747
Epoch 16/28

8/8 [==============================] - 1s 97ms/step - loss: 0.1264 - acc: 0.9873
Epoch 17/28

8/8 [==============================] - 1s 98ms/step - loss: 0.1205 - acc: 0.9747
Epoch 18/28

8/8 [==============================] - 1s 95ms/step - loss: 0.0978 - acc: 0.9937
Epoch 19/28

8/8 [==============================] - 1s 96ms/step - loss: 0.0929 - acc: 0.9873
Epoch 20/28

8/8 [==============================] - 1s 96ms/step - loss: 0.0885 - acc: 1.0000
Epoch 21/28

8/8 [==============================] - 1s 97ms/step - loss: 0.0835 - acc: 1.0000
Epoch 22/28

8/8 [==============================] - 1s 98ms/step - loss: 0.0787 - acc: 0.9937
Epoch 23/28

8/8 [==============================] - 1s 97ms/step - loss: 0.0686 - acc: 1.0000
Epoch 24/28

8/8 [==============================] - 1s 96ms/step - loss: 0.0638 - acc: 1.0000
Epoch 25/28

8/8 [==============================] - 1s 99ms/step - loss: 0.0617 - acc: 1.0000
Epoch 26/28

8/8 [==============================] - 1s 94ms/step - loss: 0.0541 - acc: 1.0000
Epoch 27/28

8/8 [==============================] - 1s 97ms/step - loss: 0.0537 - acc: 1.0000
Epoch 28/28

8/8 [==============================] - 1s 97ms/step - loss: 0.0494 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7065
False 2006
True percentage 0.77885569397
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.57      0.12      0.19       438
      I-PER       0.00      0.00      0.00       214
          O       0.93      0.93      0.93      7318
      B-ORG       0.24      0.45      0.31       296
      B-LOC       0.28      0.10      0.14       218
      I-ORG       0.12      0.40      0.19       151
      I-LOC       0.12      0.01      0.01       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.80      0.78      0.78      9071

F-1 Score (without O):
0.822901390274
