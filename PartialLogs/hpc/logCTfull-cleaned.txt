Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105281 unique words.
5277 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738048     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,178
Trainable params: 6,850,178
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0993 - acc: 0.9667
Epoch 2/27

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0491 - acc: 0.9824
Epoch 3/27

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0359 - acc: 0.9876
Epoch 4/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0271 - acc: 0.9909
Epoch 5/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0207 - acc: 0.9932
Epoch 6/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0164 - acc: 0.9947
Epoch 7/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0129 - acc: 0.9959
Epoch 8/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0104 - acc: 0.9967
Epoch 9/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0082 - acc: 0.9974
Epoch 10/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0071 - acc: 0.9977
Epoch 11/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0061 - acc: 0.9981
Epoch 12/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0051 - acc: 0.9985
Epoch 13/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0046 - acc: 0.9986
Epoch 14/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0040 - acc: 0.9987
Epoch 15/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0034 - acc: 0.9989
Epoch 16/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0027 - acc: 0.9992
Epoch 17/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0030 - acc: 0.9991
Epoch 18/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0024 - acc: 0.9993
Epoch 19/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0023 - acc: 0.9993
Epoch 20/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0022 - acc: 0.9993
Epoch 21/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0017 - acc: 0.9995
Epoch 22/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0018 - acc: 0.9995
Epoch 23/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0018 - acc: 0.9995
Epoch 24/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0016 - acc: 0.9996
Epoch 25/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0015 - acc: 0.9996
Epoch 26/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0014 - acc: 0.9996
Epoch 27/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0014 - acc: 0.9996
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8247
False 824
True percentage 0.909161062727
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.89      0.83      0.86       438
      B-ORG       0.78      0.72      0.75       296
      I-ORG       0.66      0.61      0.63       151
      I-PER       0.95      0.65      0.77       214
      B-LOC       0.74      0.73      0.74       218
     B-MISC       0.41      0.37      0.39       141
      I-LOC       0.74      0.74      0.74       141
     I-MISC       0.50      0.49      0.49       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.716159809183
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105281 unique words.
5277 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738048     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,178
Trainable params: 6,850,178
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0922 - acc: 0.9687
Epoch 2/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0476 - acc: 0.9829
Epoch 3/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0343 - acc: 0.9880
Epoch 4/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0256 - acc: 0.9914
Epoch 5/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0197 - acc: 0.9933
Epoch 6/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0151 - acc: 0.9951
Epoch 7/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0121 - acc: 0.9960
Epoch 8/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0094 - acc: 0.9972
Epoch 9/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0080 - acc: 0.9976
Epoch 10/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0065 - acc: 0.9980
Epoch 11/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0057 - acc: 0.9982
Epoch 12/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0051 - acc: 0.9984
Epoch 13/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0045 - acc: 0.9985
Epoch 14/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0037 - acc: 0.9988
Epoch 15/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0035 - acc: 0.9989
Epoch 16/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0029 - acc: 0.9991
Epoch 17/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0026 - acc: 0.9992
Epoch 18/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0025 - acc: 0.9992
Epoch 19/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0023 - acc: 0.9994
Epoch 20/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0021 - acc: 0.9994
Epoch 21/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0017 - acc: 0.9995
Epoch 22/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0017 - acc: 0.9995
Epoch 23/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0018 - acc: 0.9994
Epoch 24/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0016 - acc: 0.9995
Epoch 25/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0014 - acc: 0.9996
Epoch 26/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0014 - acc: 0.9995
Epoch 27/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0013 - acc: 0.9997
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8237
False 834
True percentage 0.90805864844
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
      B-ORG       0.76      0.75      0.76       296
      I-ORG       0.64      0.66      0.65       151
      B-PER       0.88      0.83      0.85       438
      B-LOC       0.76      0.72      0.74       218
      I-LOC       0.76      0.76      0.76       141
      I-PER       0.91      0.66      0.77       214
     B-MISC       0.39      0.38      0.38       141
     I-MISC       0.53      0.51      0.52       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.718731650029
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105281 unique words.
5277 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738048     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,178
Trainable params: 6,850,178
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.1000 - acc: 0.9668
Epoch 2/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0514 - acc: 0.9813
Epoch 3/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0369 - acc: 0.9871
Epoch 4/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0277 - acc: 0.9906
Epoch 5/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0215 - acc: 0.9928
Epoch 6/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0171 - acc: 0.9944
Epoch 7/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0137 - acc: 0.9955
Epoch 8/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0110 - acc: 0.9964
Epoch 9/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0091 - acc: 0.9971
Epoch 10/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0080 - acc: 0.9973
Epoch 11/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0068 - acc: 0.9978
Epoch 12/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0060 - acc: 0.9980
Epoch 13/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0051 - acc: 0.9984
Epoch 14/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0043 - acc: 0.9987
Epoch 15/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0037 - acc: 0.9989
Epoch 16/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0033 - acc: 0.9990
Epoch 17/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0029 - acc: 0.9991
Epoch 18/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0028 - acc: 0.9992
Epoch 19/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0024 - acc: 0.9992
Epoch 20/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0021 - acc: 0.9994
Epoch 21/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0022 - acc: 0.9993
Epoch 22/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0018 - acc: 0.9995
Epoch 23/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0020 - acc: 0.9994
Epoch 24/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0017 - acc: 0.9995
Epoch 25/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0016 - acc: 0.9995
Epoch 26/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0015 - acc: 0.9996
Epoch 27/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0013 - acc: 0.9996
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8234
False 837
True percentage 0.907727924154
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
      B-PER       0.93      0.83      0.88       438
      B-ORG       0.70      0.72      0.71       296
      I-ORG       0.60      0.64      0.62       151
     B-MISC       0.41      0.35      0.38       141
     I-MISC       0.49      0.46      0.47       154
      I-PER       0.94      0.64      0.76       214
      B-LOC       0.76      0.77      0.76       218
      I-LOC       0.75      0.79      0.77       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.714033018868
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105281 unique words.
5277 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738048     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,178
Trainable params: 6,850,178
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.1028 - acc: 0.9657
Epoch 2/27

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0474 - acc: 0.9831
Epoch 3/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0342 - acc: 0.9883
Epoch 4/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0255 - acc: 0.9913
Epoch 5/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0197 - acc: 0.9934
Epoch 6/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0154 - acc: 0.9949
Epoch 7/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0123 - acc: 0.9961
Epoch 8/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0102 - acc: 0.9967
Epoch 9/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0083 - acc: 0.9974
Epoch 10/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0071 - acc: 0.9978
Epoch 11/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0061 - acc: 0.9981
Epoch 12/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0051 - acc: 0.9984
Epoch 13/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0046 - acc: 0.9985
Epoch 14/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0041 - acc: 0.9987
Epoch 15/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0035 - acc: 0.9989
Epoch 16/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0032 - acc: 0.9990
Epoch 17/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0029 - acc: 0.9990
Epoch 18/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0026 - acc: 0.9992
Epoch 19/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0023 - acc: 0.9993
Epoch 20/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0021 - acc: 0.9994
Epoch 21/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0019 - acc: 0.9995
Epoch 22/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0016 - acc: 0.9996
Epoch 23/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0015 - acc: 0.9995
Epoch 24/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0015 - acc: 0.9996
Epoch 25/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0014 - acc: 0.9996
Epoch 26/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0013 - acc: 0.9996
Epoch 27/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0011 - acc: 0.9997
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8198
False 873
True percentage 0.90375923272
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
      B-ORG       0.68      0.76      0.72       296
      B-PER       0.90      0.81      0.85       438
      I-PER       0.84      0.64      0.72       214
      B-LOC       0.77      0.72      0.74       218
      I-LOC       0.76      0.79      0.77       141
      I-ORG       0.59      0.70      0.64       151
     B-MISC       0.37      0.29      0.32       141
     I-MISC       0.49      0.40      0.44       154

avg / total       0.94      0.90      0.92      9071

F-1 Score (without O):
0.697919718723
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105281 unique words.
5277 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738048     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,178
Trainable params: 6,850,178
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0866 - acc: 0.9700
Epoch 2/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0463 - acc: 0.9834
Epoch 3/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0331 - acc: 0.9886
Epoch 4/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0247 - acc: 0.9915
Epoch 5/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0192 - acc: 0.9935
Epoch 6/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0147 - acc: 0.9952
Epoch 7/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0116 - acc: 0.9962
Epoch 8/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0098 - acc: 0.9968
Epoch 9/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0077 - acc: 0.9975
Epoch 10/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0067 - acc: 0.9979
Epoch 11/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0059 - acc: 0.9982
Epoch 12/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0049 - acc: 0.9984
Epoch 13/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0042 - acc: 0.9985
Epoch 14/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0038 - acc: 0.9988
Epoch 15/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0036 - acc: 0.9989
Epoch 16/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0028 - acc: 0.9991
Epoch 17/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0027 - acc: 0.9992
Epoch 18/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0022 - acc: 0.9993
Epoch 19/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0023 - acc: 0.9993
Epoch 20/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0019 - acc: 0.9994
Epoch 21/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0017 - acc: 0.9995
Epoch 22/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0017 - acc: 0.9995
Epoch 23/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0019 - acc: 0.9994
Epoch 24/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0013 - acc: 0.9996
Epoch 25/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0014 - acc: 0.9996
Epoch 26/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0011 - acc: 0.9997
Epoch 27/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0013 - acc: 0.9996
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8230
False 841
True percentage 0.907286958439
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.90      0.84      0.87       438
          O       0.98      0.96      0.97      7318
      B-ORG       0.70      0.74      0.72       296
     B-MISC       0.42      0.25      0.31       141
      I-ORG       0.59      0.66      0.62       151
      I-PER       0.91      0.66      0.76       214
     I-MISC       0.60      0.36      0.45       154
      B-LOC       0.72      0.73      0.72       218
      I-LOC       0.73      0.78      0.75       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.926093869619
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105281 unique words.
5277 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738048     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,178
Trainable params: 6,850,178
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0980 - acc: 0.9671
Epoch 2/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0471 - acc: 0.9835
Epoch 3/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0345 - acc: 0.9882
Epoch 4/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0260 - acc: 0.9911
Epoch 5/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0199 - acc: 0.9935
Epoch 6/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0156 - acc: 0.9948
Epoch 7/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0125 - acc: 0.9960
Epoch 8/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0101 - acc: 0.9968
Epoch 9/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0084 - acc: 0.9973
Epoch 10/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0072 - acc: 0.9977
Epoch 11/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0058 - acc: 0.9981
Epoch 12/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0051 - acc: 0.9984
Epoch 13/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0046 - acc: 0.9985
Epoch 14/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0039 - acc: 0.9987
Epoch 15/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0033 - acc: 0.9990
Epoch 16/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0030 - acc: 0.9991
Epoch 17/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0027 - acc: 0.9992
Epoch 18/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0024 - acc: 0.9993
Epoch 19/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0022 - acc: 0.9994
Epoch 20/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0023 - acc: 0.9993
Epoch 21/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0021 - acc: 0.9993
Epoch 22/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0017 - acc: 0.9995
Epoch 23/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0013 - acc: 0.9997
Epoch 24/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0015 - acc: 0.9996
Epoch 25/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0012 - acc: 0.9997
Epoch 26/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0014 - acc: 0.9996
Epoch 27/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0014 - acc: 0.9996
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8215
False 856
True percentage 0.905633337008
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.90      0.84      0.87       438
      B-ORG       0.65      0.73      0.68       296
      I-ORG       0.52      0.66      0.58       151
      B-LOC       0.79      0.71      0.75       218
      I-PER       0.89      0.66      0.76       214
     B-MISC       0.45      0.30      0.36       141
      I-LOC       0.74      0.74      0.74       141
     I-MISC       0.61      0.36      0.46       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.701994641262
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105281 unique words.
5277 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738048     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,178
Trainable params: 6,850,178
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0893 - acc: 0.9695
Epoch 2/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0496 - acc: 0.9820
Epoch 3/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0344 - acc: 0.9881
Epoch 4/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0255 - acc: 0.9913
Epoch 5/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0198 - acc: 0.9934
Epoch 6/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0155 - acc: 0.9950
Epoch 7/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0123 - acc: 0.9960
Epoch 8/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0100 - acc: 0.9968
Epoch 9/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0082 - acc: 0.9975
Epoch 10/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0069 - acc: 0.9978
Epoch 11/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0060 - acc: 0.9980
Epoch 12/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0049 - acc: 0.9984
Epoch 13/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0041 - acc: 0.9987
Epoch 14/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0042 - acc: 0.9987
Epoch 15/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0035 - acc: 0.9989
Epoch 16/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0032 - acc: 0.9990
Epoch 17/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0027 - acc: 0.9992
Epoch 18/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0024 - acc: 0.9993
Epoch 19/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0024 - acc: 0.9992
Epoch 20/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0021 - acc: 0.9993
Epoch 21/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0017 - acc: 0.9995
Epoch 22/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0016 - acc: 0.9996
Epoch 23/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0016 - acc: 0.9995
Epoch 24/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0014 - acc: 0.9997
Epoch 25/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0015 - acc: 0.9996
Epoch 26/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0011 - acc: 0.9997
Epoch 27/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0011 - acc: 0.9997
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8246
False 825
True percentage 0.909050821299
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.92      0.84      0.88       438
      I-PER       0.94      0.62      0.74       214
      B-ORG       0.69      0.73      0.71       296
      I-ORG       0.61      0.66      0.63       151
      B-LOC       0.76      0.74      0.75       218
     B-MISC       0.47      0.30      0.36       141
     I-MISC       0.56      0.38      0.45       154
      I-LOC       0.77      0.81      0.79       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.717593984962
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105281 unique words.
5277 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738048     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,178
Trainable params: 6,850,178
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0933 - acc: 0.9681
Epoch 2/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0487 - acc: 0.9824
Epoch 3/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0346 - acc: 0.9880
Epoch 4/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0261 - acc: 0.9911
Epoch 5/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0200 - acc: 0.9933
Epoch 6/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0158 - acc: 0.9949
Epoch 7/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0128 - acc: 0.9959
Epoch 8/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0104 - acc: 0.9967
Epoch 9/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0086 - acc: 0.9974
Epoch 10/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0070 - acc: 0.9976
Epoch 11/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0063 - acc: 0.9980
Epoch 12/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0055 - acc: 0.9983
Epoch 13/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0046 - acc: 0.9986
Epoch 14/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0040 - acc: 0.9988
Epoch 15/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0035 - acc: 0.9989
Epoch 16/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0031 - acc: 0.9991
Epoch 17/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0028 - acc: 0.9991
Epoch 18/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0024 - acc: 0.9993
Epoch 19/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0026 - acc: 0.9992
Epoch 20/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0018 - acc: 0.9995
Epoch 21/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0020 - acc: 0.9994
Epoch 22/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0018 - acc: 0.9994
Epoch 23/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0015 - acc: 0.9995
Epoch 24/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0015 - acc: 0.9996
Epoch 25/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0013 - acc: 0.9996
Epoch 26/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0013 - acc: 0.9996
Epoch 27/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0012 - acc: 0.9996
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8249
False 822
True percentage 0.909381545585
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
     B-MISC       0.44      0.29      0.35       141
     I-MISC       0.58      0.43      0.49       154
      B-ORG       0.73      0.74      0.73       296
      B-LOC       0.75      0.75      0.75       218
      B-PER       0.91      0.84      0.87       438
      I-PER       0.94      0.67      0.78       214
      I-ORG       0.58      0.65      0.61       151
      I-LOC       0.76      0.79      0.77       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.722122838402
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 8
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105281 unique words.
5277 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738048     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,178
Trainable params: 6,850,178
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.1027 - acc: 0.9661
Epoch 2/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0506 - acc: 0.9820
Epoch 3/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0364 - acc: 0.9873
Epoch 4/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0275 - acc: 0.9905
Epoch 5/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0218 - acc: 0.9926
Epoch 6/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0175 - acc: 0.9943
Epoch 7/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0140 - acc: 0.9953
Epoch 8/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0115 - acc: 0.9964
Epoch 9/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0095 - acc: 0.9970
Epoch 10/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0081 - acc: 0.9974
Epoch 11/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0069 - acc: 0.9978
Epoch 12/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0055 - acc: 0.9983
Epoch 13/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0049 - acc: 0.9984
Epoch 14/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0043 - acc: 0.9987
Epoch 15/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0039 - acc: 0.9987
Epoch 16/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0035 - acc: 0.9990
Epoch 17/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0031 - acc: 0.9991
Epoch 18/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0027 - acc: 0.9992
Epoch 19/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0025 - acc: 0.9992
Epoch 20/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0022 - acc: 0.9994
Epoch 21/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0019 - acc: 0.9994
Epoch 22/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0019 - acc: 0.9995
Epoch 23/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0017 - acc: 0.9995
Epoch 24/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0018 - acc: 0.9995
Epoch 25/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0014 - acc: 0.9996
Epoch 26/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0013 - acc: 0.9996
Epoch 27/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0012 - acc: 0.9996
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8248
False 823
True percentage 0.909271304156
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
     B-MISC       0.40      0.30      0.35       141
      B-ORG       0.72      0.76      0.74       296
      B-PER       0.92      0.82      0.87       438
     I-MISC       0.53      0.44      0.48       154
      I-PER       0.86      0.65      0.74       214
      I-ORG       0.62      0.65      0.63       151
      B-LOC       0.78      0.75      0.76       218
      I-LOC       0.76      0.79      0.77       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.716196136701
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 9
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105281 unique words.
5277 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738048     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,178
Trainable params: 6,850,178
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.1001 - acc: 0.9665
Epoch 2/27

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0482 - acc: 0.9828
Epoch 3/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0343 - acc: 0.9881
Epoch 4/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0258 - acc: 0.9911
Epoch 5/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0204 - acc: 0.9933
Epoch 6/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0160 - acc: 0.9947
Epoch 7/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0127 - acc: 0.9959
Epoch 8/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0106 - acc: 0.9966
Epoch 9/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0083 - acc: 0.9975
Epoch 10/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0076 - acc: 0.9976
Epoch 11/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0065 - acc: 0.9979
Epoch 12/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0051 - acc: 0.9984
Epoch 13/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0047 - acc: 0.9985
Epoch 14/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0041 - acc: 0.9987
Epoch 15/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0035 - acc: 0.9989
Epoch 16/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0033 - acc: 0.9990
Epoch 17/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0029 - acc: 0.9991
Epoch 18/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0027 - acc: 0.9991
Epoch 19/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0024 - acc: 0.9993
Epoch 20/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0022 - acc: 0.9993
Epoch 21/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0021 - acc: 0.9993
Epoch 22/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0020 - acc: 0.9994
Epoch 23/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0018 - acc: 0.9995
Epoch 24/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0017 - acc: 0.9995
Epoch 25/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0016 - acc: 0.9995
Epoch 26/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0015 - acc: 0.9996
Epoch 27/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0013 - acc: 0.9996
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8202
False 869
True percentage 0.904200198435
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
      B-PER       0.90      0.82      0.86       438
      B-ORG       0.71      0.74      0.72       296
      I-ORG       0.58      0.63      0.61       151
      I-PER       0.83      0.64      0.72       214
      B-LOC       0.79      0.72      0.75       218
      I-LOC       0.77      0.77      0.77       141
     B-MISC       0.38      0.40      0.39       141
     I-MISC       0.47      0.50      0.48       154

avg / total       0.94      0.90      0.92      9071

F-1 Score (without O):
0.70235670643
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 10
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105281 unique words.
5277 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738048     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,178
Trainable params: 6,850,178
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0921 - acc: 0.9683
Epoch 2/27

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0503 - acc: 0.9818
Epoch 3/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0365 - acc: 0.9872
Epoch 4/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0273 - acc: 0.9908
Epoch 5/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0209 - acc: 0.9930
Epoch 6/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0163 - acc: 0.9946
Epoch 7/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0131 - acc: 0.9958
Epoch 8/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0107 - acc: 0.9966
Epoch 9/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0089 - acc: 0.9972
Epoch 10/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0076 - acc: 0.9976
Epoch 11/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0062 - acc: 0.9980
Epoch 12/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0051 - acc: 0.9984
Epoch 13/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0047 - acc: 0.9986
Epoch 14/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0039 - acc: 0.9988
Epoch 15/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0035 - acc: 0.9989
Epoch 16/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0033 - acc: 0.9990
Epoch 17/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0031 - acc: 0.9991
Epoch 18/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0024 - acc: 0.9993
Epoch 19/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0024 - acc: 0.9993
Epoch 20/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0022 - acc: 0.9994
Epoch 21/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0018 - acc: 0.9995
Epoch 22/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0018 - acc: 0.9995
Epoch 23/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0017 - acc: 0.9995
Epoch 24/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0018 - acc: 0.9995
Epoch 25/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0015 - acc: 0.9995
Epoch 26/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0013 - acc: 0.9996
Epoch 27/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0011 - acc: 0.9997
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8235
False 836
True percentage 0.907838165583
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
      B-PER       0.89      0.84      0.86       438
      B-ORG       0.76      0.72      0.74       296
      I-ORG       0.64      0.58      0.61       151
     B-MISC       0.40      0.40      0.40       141
     I-MISC       0.49      0.52      0.50       154
      I-PER       0.87      0.62      0.72       214
      B-LOC       0.74      0.75      0.74       218
      I-LOC       0.76      0.80      0.78       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.711476372175
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 11
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105281 unique words.
5277 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738048     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,178
Trainable params: 6,850,178
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0972 - acc: 0.9676
Epoch 2/27

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0505 - acc: 0.9820
Epoch 3/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0367 - acc: 0.9872
Epoch 4/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0277 - acc: 0.9905
Epoch 5/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0218 - acc: 0.9927
Epoch 6/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0166 - acc: 0.9946
Epoch 7/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0134 - acc: 0.9957
Epoch 8/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0105 - acc: 0.9966
Epoch 9/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0090 - acc: 0.9972
Epoch 10/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0075 - acc: 0.9977
Epoch 11/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0061 - acc: 0.9981
Epoch 12/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0054 - acc: 0.9983
Epoch 13/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0048 - acc: 0.9986
Epoch 14/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0043 - acc: 0.9986
Epoch 15/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0037 - acc: 0.9989
Epoch 16/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0032 - acc: 0.9990
Epoch 17/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0030 - acc: 0.9991
Epoch 18/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0027 - acc: 0.9992
Epoch 19/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0025 - acc: 0.9992
Epoch 20/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0020 - acc: 0.9994
Epoch 21/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0022 - acc: 0.9993
Epoch 22/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0019 - acc: 0.9994
Epoch 23/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0019 - acc: 0.9995
Epoch 24/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0015 - acc: 0.9995
Epoch 25/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0015 - acc: 0.9995
Epoch 26/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0014 - acc: 0.9996
Epoch 27/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0013 - acc: 0.9996
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8234
False 837
True percentage 0.907727924154
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.70      0.76      0.73       296
          O       0.99      0.96      0.97      7318
     B-MISC       0.37      0.29      0.33       141
     I-MISC       0.56      0.42      0.48       154
      B-PER       0.90      0.83      0.86       438
      I-PER       0.92      0.65      0.76       214
      B-LOC       0.80      0.75      0.78       218
      I-LOC       0.71      0.77      0.74       141
      I-ORG       0.59      0.63      0.61       151

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.930691918899
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105281 unique words.
5277 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738048     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,178
Trainable params: 6,850,178
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0917 - acc: 0.9688
Epoch 2/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0470 - acc: 0.9832
Epoch 3/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0336 - acc: 0.9885
Epoch 4/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0261 - acc: 0.9912
Epoch 5/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0198 - acc: 0.9934
Epoch 6/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0157 - acc: 0.9950
Epoch 7/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0125 - acc: 0.9960
Epoch 8/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0107 - acc: 0.9966
Epoch 9/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0085 - acc: 0.9974
Epoch 10/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0072 - acc: 0.9976
Epoch 11/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0062 - acc: 0.9980
Epoch 12/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0054 - acc: 0.9982
Epoch 13/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0046 - acc: 0.9986
Epoch 14/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0040 - acc: 0.9988
Epoch 15/27

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0037 - acc: 0.9988
Epoch 16/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0030 - acc: 0.9991
Epoch 17/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0029 - acc: 0.9991
Epoch 18/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0027 - acc: 0.9992
Epoch 19/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0025 - acc: 0.9992
Epoch 20/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0022 - acc: 0.9994
Epoch 21/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0019 - acc: 0.9994
Epoch 22/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0016 - acc: 0.9996
Epoch 23/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0018 - acc: 0.9995
Epoch 24/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0015 - acc: 0.9996
Epoch 25/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0014 - acc: 0.9996
Epoch 26/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0016 - acc: 0.9995
Epoch 27/27

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0013 - acc: 0.9996
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8222
False 849
True percentage 0.906405027009
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.91      0.83      0.86       438
      I-PER       0.90      0.67      0.77       214
          O       0.98      0.96      0.97      7318
      B-ORG       0.72      0.73      0.72       296
      B-LOC       0.76      0.74      0.75       218
      I-ORG       0.57      0.67      0.62       151
      I-LOC       0.74      0.77      0.75       141
     B-MISC       0.40      0.29      0.34       141
     I-MISC       0.51      0.42      0.46       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.925195691837
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104760 unique words.
4756 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 244
OOV word occurences: in test 345
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6704704     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,816,834
Trainable params: 6,816,834
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 26s 31ms/step - loss: 0.1234 - acc: 0.9566
Epoch 2/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0654 - acc: 0.9772
Epoch 3/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0537 - acc: 0.9803
Epoch 4/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0437 - acc: 0.9845
Epoch 5/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0361 - acc: 0.9878
Epoch 6/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0293 - acc: 0.9902
Epoch 7/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0237 - acc: 0.9921
Epoch 8/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0202 - acc: 0.9935
Epoch 9/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0165 - acc: 0.9948
Epoch 10/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0134 - acc: 0.9957
Epoch 11/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0109 - acc: 0.9969
Epoch 12/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0094 - acc: 0.9973
Epoch 13/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0079 - acc: 0.9977
Epoch 14/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0066 - acc: 0.9979
Epoch 15/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0058 - acc: 0.9983
Epoch 16/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0048 - acc: 0.9987
Epoch 17/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0044 - acc: 0.9989
Epoch 18/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0037 - acc: 0.9990
Epoch 19/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0033 - acc: 0.9991
Epoch 20/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0027 - acc: 0.9993
Epoch 21/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0027 - acc: 0.9993
Epoch 22/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0023 - acc: 0.9994
Epoch 23/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0020 - acc: 0.9995
Epoch 24/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0018 - acc: 0.9996
Epoch 25/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0015 - acc: 0.9997
Epoch 26/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0014 - acc: 0.9997
Epoch 27/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0015 - acc: 0.9997
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8175
False 896
True percentage 0.901223679859
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.89      0.81      0.85       438
      B-ORG       0.73      0.71      0.72       296
      I-ORG       0.62      0.54      0.58       151
      I-PER       0.82      0.63      0.71       214
      B-LOC       0.71      0.69      0.70       218
     B-MISC       0.39      0.35      0.37       141
      I-LOC       0.72      0.74      0.73       141
     I-MISC       0.56      0.42      0.48       154

avg / total       0.93      0.90      0.92      9071

F-1 Score (without O):
0.689055472264
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104736 unique words.
4732 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 244
OOV word occurences: in test 375
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6703168     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,815,298
Trainable params: 6,815,298
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 26s 32ms/step - loss: 0.1297 - acc: 0.9591
Epoch 2/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0640 - acc: 0.9772
Epoch 3/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0513 - acc: 0.9814
Epoch 4/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0412 - acc: 0.9855
Epoch 5/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0340 - acc: 0.9882
Epoch 6/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0281 - acc: 0.9905
Epoch 7/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0231 - acc: 0.9923
Epoch 8/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0188 - acc: 0.9940
Epoch 9/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0156 - acc: 0.9949
Epoch 10/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0131 - acc: 0.9960
Epoch 11/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0106 - acc: 0.9967
Epoch 12/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0091 - acc: 0.9973
Epoch 13/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0078 - acc: 0.9977
Epoch 14/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0066 - acc: 0.9980
Epoch 15/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0058 - acc: 0.9984
Epoch 16/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0050 - acc: 0.9986
Epoch 17/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0041 - acc: 0.9989
Epoch 18/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0036 - acc: 0.9990
Epoch 19/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0033 - acc: 0.9991
Epoch 20/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0028 - acc: 0.9993
Epoch 21/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0024 - acc: 0.9994
Epoch 22/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0022 - acc: 0.9995
Epoch 23/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0020 - acc: 0.9995
Epoch 24/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0018 - acc: 0.9996
Epoch 25/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0016 - acc: 0.9996
Epoch 26/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0016 - acc: 0.9996
Epoch 27/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0015 - acc: 0.9996
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8124
False 947
True percentage 0.895601366994
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.76      0.69      0.72       296
      I-ORG       0.58      0.50      0.54       151
      B-PER       0.86      0.75      0.80       438
      B-LOC       0.72      0.70      0.71       218
      I-LOC       0.70      0.75      0.73       141
      I-PER       0.84      0.62      0.71       214
     B-MISC       0.37      0.33      0.35       141
     I-MISC       0.54      0.48      0.51       154

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.674299487798
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104716 unique words.
4712 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 249
OOV word occurences: in test 356
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6701888     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,814,018
Trainable params: 6,814,018
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 26s 31ms/step - loss: 0.1311 - acc: 0.9568
Epoch 2/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0627 - acc: 0.9774
Epoch 3/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0503 - acc: 0.9819
Epoch 4/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0407 - acc: 0.9856
Epoch 5/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0339 - acc: 0.9881
Epoch 6/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0288 - acc: 0.9900
Epoch 7/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0236 - acc: 0.9921
Epoch 8/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0195 - acc: 0.9936
Epoch 9/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0167 - acc: 0.9949
Epoch 10/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0141 - acc: 0.9957
Epoch 11/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0121 - acc: 0.9963
Epoch 12/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0102 - acc: 0.9969
Epoch 13/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0085 - acc: 0.9974
Epoch 14/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0077 - acc: 0.9976
Epoch 15/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0065 - acc: 0.9981
Epoch 16/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0058 - acc: 0.9983
Epoch 17/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0053 - acc: 0.9982
Epoch 18/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0045 - acc: 0.9987
Epoch 19/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0043 - acc: 0.9987
Epoch 20/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0038 - acc: 0.9988
Epoch 21/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0031 - acc: 0.9991
Epoch 22/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0027 - acc: 0.9993
Epoch 23/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0025 - acc: 0.9994
Epoch 24/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0023 - acc: 0.9993
Epoch 25/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0019 - acc: 0.9995
Epoch 26/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0019 - acc: 0.9994
Epoch 27/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0019 - acc: 0.9996
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8118
False 953
True percentage 0.894939918421
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.89      0.78      0.83       438
      B-ORG       0.64      0.72      0.68       296
      I-ORG       0.52      0.50      0.51       151
     B-MISC       0.43      0.28      0.34       141
     I-MISC       0.49      0.42      0.45       154
      I-PER       0.93      0.61      0.73       214
      B-LOC       0.73      0.69      0.71       218
      I-LOC       0.73      0.74      0.74       141

avg / total       0.93      0.89      0.91      9071

F-1 Score (without O):
0.673475518174
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104708 unique words.
4704 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 248
OOV word occurences: in test 352
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6701376     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,813,506
Trainable params: 6,813,506
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0945 - acc: 0.9686
Epoch 2/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0581 - acc: 0.9782
Epoch 3/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0459 - acc: 0.9836
Epoch 4/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0373 - acc: 0.9870
Epoch 5/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0311 - acc: 0.9892
Epoch 6/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0252 - acc: 0.9913
Epoch 7/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0214 - acc: 0.9929
Epoch 8/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0174 - acc: 0.9943
Epoch 9/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0143 - acc: 0.9955
Epoch 10/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0116 - acc: 0.9964
Epoch 11/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0101 - acc: 0.9969
Epoch 12/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0083 - acc: 0.9977
Epoch 13/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0070 - acc: 0.9977
Epoch 14/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0060 - acc: 0.9982
Epoch 15/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0051 - acc: 0.9986
Epoch 16/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0041 - acc: 0.9988
Epoch 17/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0039 - acc: 0.9989
Epoch 18/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0033 - acc: 0.9991
Epoch 19/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0029 - acc: 0.9993
Epoch 20/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0025 - acc: 0.9993
Epoch 21/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0021 - acc: 0.9995
Epoch 22/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0019 - acc: 0.9996
Epoch 23/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0018 - acc: 0.9996
Epoch 24/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0015 - acc: 0.9996
Epoch 25/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0015 - acc: 0.9996
Epoch 26/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0012 - acc: 0.9997
Epoch 27/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0014 - acc: 0.9997
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8161
False 910
True percentage 0.899680299857
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
      B-ORG       0.73      0.72      0.72       296
      B-PER       0.90      0.81      0.85       438
      I-PER       0.89      0.63      0.74       214
      B-LOC       0.69      0.73      0.71       218
      I-LOC       0.74      0.80      0.77       141
      I-ORG       0.53      0.54      0.54       151
     B-MISC       0.39      0.33      0.35       141
     I-MISC       0.51      0.46      0.48       154

avg / total       0.94      0.90      0.92      9071

F-1 Score (without O):
0.692080378251
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104749 unique words.
4745 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 245
OOV word occurences: in test 380
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6704000     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,816,130
Trainable params: 6,816,130
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 26s 31ms/step - loss: 0.1334 - acc: 0.9548
Epoch 2/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0645 - acc: 0.9767
Epoch 3/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0533 - acc: 0.9803
Epoch 4/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0435 - acc: 0.9846
Epoch 5/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0360 - acc: 0.9872
Epoch 6/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0298 - acc: 0.9899
Epoch 7/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0246 - acc: 0.9917
Epoch 8/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0200 - acc: 0.9936
Epoch 9/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0174 - acc: 0.9945
Epoch 10/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0137 - acc: 0.9959
Epoch 11/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0115 - acc: 0.9966
Epoch 12/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0097 - acc: 0.9971
Epoch 13/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0077 - acc: 0.9978
Epoch 14/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0071 - acc: 0.9979
Epoch 15/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0062 - acc: 0.9982
Epoch 16/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0053 - acc: 0.9984
Epoch 17/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0044 - acc: 0.9988
Epoch 18/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0039 - acc: 0.9988
Epoch 19/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0034 - acc: 0.9991
Epoch 20/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0033 - acc: 0.9990
Epoch 21/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0027 - acc: 0.9992
Epoch 22/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0028 - acc: 0.9992
Epoch 23/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0026 - acc: 0.9993
Epoch 24/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0023 - acc: 0.9994
Epoch 25/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0020 - acc: 0.9994
Epoch 26/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0020 - acc: 0.9994
Epoch 27/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0017 - acc: 0.9996
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8149
False 922
True percentage 0.898357402712
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.87      0.72      0.79       438
          O       0.98      0.96      0.97      7318
      B-ORG       0.72      0.70      0.71       296
     B-MISC       0.39      0.33      0.36       141
      I-ORG       0.63      0.54      0.58       151
      I-PER       0.90      0.59      0.72       214
     I-MISC       0.60      0.44      0.51       154
      B-LOC       0.75      0.78      0.76       218
      I-LOC       0.75      0.83      0.79       141

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.923530452214
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104716 unique words.
4712 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 250
OOV word occurences: in test 355
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6701888     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,814,018
Trainable params: 6,814,018
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 26s 31ms/step - loss: 0.1513 - acc: 0.9516
Epoch 2/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0687 - acc: 0.9762
Epoch 3/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0554 - acc: 0.9799
Epoch 4/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0447 - acc: 0.9841
Epoch 5/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0359 - acc: 0.9875
Epoch 6/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0300 - acc: 0.9898
Epoch 7/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0243 - acc: 0.9920
Epoch 8/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0200 - acc: 0.9936
Epoch 9/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0165 - acc: 0.9950
Epoch 10/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0133 - acc: 0.9959
Epoch 11/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0111 - acc: 0.9967
Epoch 12/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0095 - acc: 0.9973
Epoch 13/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0081 - acc: 0.9976
Epoch 14/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0069 - acc: 0.9979
Epoch 15/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0061 - acc: 0.9982
Epoch 16/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0054 - acc: 0.9984
Epoch 17/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0047 - acc: 0.9988
Epoch 18/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0042 - acc: 0.9988
Epoch 19/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0035 - acc: 0.9991
Epoch 20/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0033 - acc: 0.9990
Epoch 21/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0031 - acc: 0.9992
Epoch 22/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0025 - acc: 0.9994
Epoch 23/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0023 - acc: 0.9994
Epoch 24/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0020 - acc: 0.9995
Epoch 25/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0022 - acc: 0.9994
Epoch 26/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0018 - acc: 0.9996
Epoch 27/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0022 - acc: 0.9995
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8135
False 936
True percentage 0.89681402271
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.87      0.78      0.82       438
      B-ORG       0.72      0.71      0.71       296
      I-ORG       0.52      0.53      0.52       151
      B-LOC       0.74      0.68      0.71       218
      I-PER       0.83      0.64      0.72       214
     B-MISC       0.41      0.23      0.29       141
      I-LOC       0.72      0.77      0.74       141
     I-MISC       0.54      0.32      0.40       154

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.674397314617
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104742 unique words.
4738 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 245
OOV word occurences: in test 358
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6703552     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,815,682
Trainable params: 6,815,682
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 26s 31ms/step - loss: 0.1339 - acc: 0.9551
Epoch 2/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0633 - acc: 0.9769
Epoch 3/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0506 - acc: 0.9815
Epoch 4/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0408 - acc: 0.9855
Epoch 5/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0331 - acc: 0.9886
Epoch 6/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0272 - acc: 0.9906
Epoch 7/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0217 - acc: 0.9929
Epoch 8/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0183 - acc: 0.9943
Epoch 9/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0147 - acc: 0.9956
Epoch 10/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0124 - acc: 0.9964
Epoch 11/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0106 - acc: 0.9969
Epoch 12/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0092 - acc: 0.9974
Epoch 13/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0077 - acc: 0.9977
Epoch 14/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0068 - acc: 0.9981
Epoch 15/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0056 - acc: 0.9984
Epoch 16/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0048 - acc: 0.9987
Epoch 17/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0043 - acc: 0.9988
Epoch 18/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0040 - acc: 0.9990
Epoch 19/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0036 - acc: 0.9989
Epoch 20/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0030 - acc: 0.9992
Epoch 21/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0023 - acc: 0.9994
Epoch 22/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0024 - acc: 0.9994
Epoch 23/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0023 - acc: 0.9993
Epoch 24/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0019 - acc: 0.9994
Epoch 25/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0016 - acc: 0.9996
Epoch 26/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0016 - acc: 0.9996
Epoch 27/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0014 - acc: 0.9996
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8170
False 901
True percentage 0.900672472715
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.86      0.75      0.80       438
      I-PER       0.91      0.59      0.72       214
      B-ORG       0.75      0.71      0.73       296
      I-ORG       0.65      0.58      0.61       151
      B-LOC       0.74      0.72      0.73       218
     B-MISC       0.43      0.28      0.34       141
     I-MISC       0.50      0.44      0.47       154
      I-LOC       0.74      0.77      0.75       141

avg / total       0.93      0.90      0.92      9071

F-1 Score (without O):
0.687843616371
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104757 unique words.
4753 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 248
OOV word occurences: in test 387
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6704512     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,816,642
Trainable params: 6,816,642
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 26s 31ms/step - loss: 0.1222 - acc: 0.9597
Epoch 2/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0635 - acc: 0.9771
Epoch 3/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0516 - acc: 0.9808
Epoch 4/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0423 - acc: 0.9847
Epoch 5/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0347 - acc: 0.9879
Epoch 6/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0285 - acc: 0.9905
Epoch 7/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0234 - acc: 0.9923
Epoch 8/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0191 - acc: 0.9941
Epoch 9/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0158 - acc: 0.9951
Epoch 10/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0132 - acc: 0.9959
Epoch 11/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0107 - acc: 0.9969
Epoch 12/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0095 - acc: 0.9970
Epoch 13/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0081 - acc: 0.9975
Epoch 14/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0070 - acc: 0.9977
Epoch 15/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0063 - acc: 0.9981
Epoch 16/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0053 - acc: 0.9985
Epoch 17/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0047 - acc: 0.9987
Epoch 18/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0044 - acc: 0.9988
Epoch 19/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0038 - acc: 0.9990
Epoch 20/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0033 - acc: 0.9991
Epoch 21/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0029 - acc: 0.9992
Epoch 22/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0024 - acc: 0.9995
Epoch 23/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0023 - acc: 0.9994
Epoch 24/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0020 - acc: 0.9995
Epoch 25/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0019 - acc: 0.9995
Epoch 26/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0017 - acc: 0.9997
Epoch 27/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0016 - acc: 0.9996
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8087
False 984
True percentage 0.891522434131
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
     B-MISC       0.33      0.30      0.31       141
     I-MISC       0.41      0.44      0.43       154
      B-ORG       0.70      0.62      0.66       296
      B-LOC       0.72      0.71      0.71       218
      B-PER       0.88      0.73      0.80       438
      I-PER       0.92      0.62      0.74       214
      I-ORG       0.50      0.40      0.44       151
      I-LOC       0.72      0.79      0.75       141

avg / total       0.93      0.89      0.91      9071

F-1 Score (without O):
0.649303452453
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 8
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104741 unique words.
4737 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 241
OOV word occurences: in test 370
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6703488     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,815,618
Trainable params: 6,815,618
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 26s 32ms/step - loss: 0.1299 - acc: 0.9568
Epoch 2/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0646 - acc: 0.9770
Epoch 3/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0530 - acc: 0.9799
Epoch 4/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0434 - acc: 0.9840
Epoch 5/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0351 - acc: 0.9876
Epoch 6/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0284 - acc: 0.9903
Epoch 7/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0230 - acc: 0.9925
Epoch 8/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0186 - acc: 0.9940
Epoch 9/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0151 - acc: 0.9953
Epoch 10/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0120 - acc: 0.9963
Epoch 11/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0107 - acc: 0.9967
Epoch 12/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0085 - acc: 0.9973
Epoch 13/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0072 - acc: 0.9978
Epoch 14/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0063 - acc: 0.9981
Epoch 15/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0056 - acc: 0.9982
Epoch 16/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0050 - acc: 0.9984
Epoch 17/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0042 - acc: 0.9987
Epoch 18/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0038 - acc: 0.9989
Epoch 19/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0035 - acc: 0.9989
Epoch 20/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0031 - acc: 0.9991
Epoch 21/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0025 - acc: 0.9993
Epoch 22/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0025 - acc: 0.9993
Epoch 23/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0019 - acc: 0.9996
Epoch 24/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0018 - acc: 0.9995
Epoch 25/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0019 - acc: 0.9995
Epoch 26/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0018 - acc: 0.9996
Epoch 27/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0015 - acc: 0.9997
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8125
False 946
True percentage 0.895711608422
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
     B-MISC       0.39      0.26      0.31       141
      B-ORG       0.68      0.72      0.70       296
      B-PER       0.84      0.75      0.79       438
     I-MISC       0.54      0.39      0.45       154
      I-PER       0.88      0.62      0.73       214
      I-ORG       0.52      0.54      0.53       151
      B-LOC       0.69      0.75      0.72       218
      I-LOC       0.71      0.73      0.72       141

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.66825633383
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 9
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104717 unique words.
4713 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 246
OOV word occurences: in test 378
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6701952     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,814,082
Trainable params: 6,814,082
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 26s 31ms/step - loss: 0.1354 - acc: 0.9551
Epoch 2/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0657 - acc: 0.9766
Epoch 3/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0517 - acc: 0.9811
Epoch 4/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0418 - acc: 0.9853
Epoch 5/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0344 - acc: 0.9879
Epoch 6/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0275 - acc: 0.9903
Epoch 7/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0226 - acc: 0.9925
Epoch 8/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0183 - acc: 0.9940
Epoch 9/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0147 - acc: 0.9954
Epoch 10/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0119 - acc: 0.9964
Epoch 11/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0103 - acc: 0.9971
Epoch 12/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0083 - acc: 0.9976
Epoch 13/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0072 - acc: 0.9980
Epoch 14/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0057 - acc: 0.9984
Epoch 15/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0051 - acc: 0.9985
Epoch 16/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0045 - acc: 0.9987
Epoch 17/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0039 - acc: 0.9989
Epoch 18/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0034 - acc: 0.9991
Epoch 19/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0029 - acc: 0.9992
Epoch 20/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0025 - acc: 0.9994
Epoch 21/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0024 - acc: 0.9994
Epoch 22/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0023 - acc: 0.9994
Epoch 23/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0021 - acc: 0.9995
Epoch 24/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0018 - acc: 0.9996
Epoch 25/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0016 - acc: 0.9996
Epoch 26/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0015 - acc: 0.9996
Epoch 27/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0015 - acc: 0.9996
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8076
False 995
True percentage 0.890309778415
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.95      0.97      7318
      B-PER       0.86      0.71      0.78       438
      B-ORG       0.67      0.71      0.69       296
      I-ORG       0.52      0.60      0.56       151
      I-PER       0.80      0.65      0.72       214
      B-LOC       0.73      0.68      0.70       218
      I-LOC       0.67      0.77      0.72       141
     B-MISC       0.37      0.34      0.35       141
     I-MISC       0.47      0.43      0.45       154

avg / total       0.93      0.89      0.91      9071

F-1 Score (without O):
0.657871591909
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 10
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104747 unique words.
4743 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 248
OOV word occurences: in test 383
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6703872     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,816,002
Trainable params: 6,816,002
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 26s 31ms/step - loss: 0.1263 - acc: 0.9577
Epoch 2/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0670 - acc: 0.9764
Epoch 3/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0527 - acc: 0.9810
Epoch 4/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0424 - acc: 0.9851
Epoch 5/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0349 - acc: 0.9880
Epoch 6/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0287 - acc: 0.9903
Epoch 7/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0243 - acc: 0.9918
Epoch 8/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0196 - acc: 0.9934
Epoch 9/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0161 - acc: 0.9947
Epoch 10/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0131 - acc: 0.9957
Epoch 11/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0113 - acc: 0.9964
Epoch 12/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0094 - acc: 0.9973
Epoch 13/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0079 - acc: 0.9976
Epoch 14/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0073 - acc: 0.9979
Epoch 15/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0062 - acc: 0.9980
Epoch 16/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0055 - acc: 0.9983
Epoch 17/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0048 - acc: 0.9986
Epoch 18/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0042 - acc: 0.9988
Epoch 19/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0037 - acc: 0.9989
Epoch 20/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0030 - acc: 0.9992
Epoch 21/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0030 - acc: 0.9992
Epoch 22/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0029 - acc: 0.9992
Epoch 23/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0024 - acc: 0.9993
Epoch 24/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0021 - acc: 0.9995
Epoch 25/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0021 - acc: 0.9994
Epoch 26/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0019 - acc: 0.9995
Epoch 27/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0019 - acc: 0.9995
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8140
False 931
True percentage 0.897365229853
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.85      0.75      0.80       438
      B-ORG       0.73      0.65      0.69       296
      I-ORG       0.56      0.46      0.51       151
     B-MISC       0.41      0.28      0.33       141
     I-MISC       0.51      0.43      0.47       154
      I-PER       0.88      0.63      0.74       214
      B-LOC       0.71      0.76      0.73       218
      I-LOC       0.76      0.84      0.79       141

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.676372459812
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 11
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104705 unique words.
4701 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 243
OOV word occurences: in test 340
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6701184     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,813,314
Trainable params: 6,813,314
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 26s 31ms/step - loss: 0.1165 - acc: 0.9609
Epoch 2/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0607 - acc: 0.9779
Epoch 3/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0474 - acc: 0.9827
Epoch 4/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0384 - acc: 0.9866
Epoch 5/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0318 - acc: 0.9890
Epoch 6/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0255 - acc: 0.9916
Epoch 7/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0211 - acc: 0.9932
Epoch 8/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0171 - acc: 0.9946
Epoch 9/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0139 - acc: 0.9958
Epoch 10/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0115 - acc: 0.9964
Epoch 11/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0095 - acc: 0.9972
Epoch 12/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0083 - acc: 0.9977
Epoch 13/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0068 - acc: 0.9980
Epoch 14/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0060 - acc: 0.9984
Epoch 15/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0050 - acc: 0.9987
Epoch 16/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0043 - acc: 0.9989
Epoch 17/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0039 - acc: 0.9989
Epoch 18/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0032 - acc: 0.9991
Epoch 19/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0028 - acc: 0.9993
Epoch 20/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0026 - acc: 0.9993
Epoch 21/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0024 - acc: 0.9994
Epoch 22/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0021 - acc: 0.9994
Epoch 23/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0019 - acc: 0.9996
Epoch 24/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0017 - acc: 0.9995
Epoch 25/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0016 - acc: 0.9996
Epoch 26/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0015 - acc: 0.9996
Epoch 27/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0014 - acc: 0.9997
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8126
False 945
True percentage 0.895821849851
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.74      0.67      0.70       296
          O       0.98      0.96      0.97      7318
     B-MISC       0.36      0.28      0.31       141
     I-MISC       0.40      0.32      0.36       154
      B-PER       0.90      0.79      0.84       438
      I-PER       0.83      0.60      0.70       214
      B-LOC       0.67      0.74      0.71       218
      I-LOC       0.58      0.74      0.65       141
      I-ORG       0.57      0.42      0.48       151

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.919837587007
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104716 unique words.
4712 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 245
OOV word occurences: in test 385
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6701888     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,814,018
Trainable params: 6,814,018
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 26s 31ms/step - loss: 0.1489 - acc: 0.9519
Epoch 2/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0665 - acc: 0.9768
Epoch 3/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0534 - acc: 0.9806
Epoch 4/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0444 - acc: 0.9843
Epoch 5/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0371 - acc: 0.9873
Epoch 6/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0306 - acc: 0.9896
Epoch 7/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0250 - acc: 0.9920
Epoch 8/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0200 - acc: 0.9938
Epoch 9/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0174 - acc: 0.9945
Epoch 10/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0142 - acc: 0.9957
Epoch 11/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0122 - acc: 0.9964
Epoch 12/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0099 - acc: 0.9970
Epoch 13/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0085 - acc: 0.9975
Epoch 14/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0074 - acc: 0.9979
Epoch 15/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0064 - acc: 0.9982
Epoch 16/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0056 - acc: 0.9985
Epoch 17/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0049 - acc: 0.9986
Epoch 18/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0042 - acc: 0.9990
Epoch 19/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0037 - acc: 0.9990
Epoch 20/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0035 - acc: 0.9989
Epoch 21/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0030 - acc: 0.9991
Epoch 22/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0027 - acc: 0.9994
Epoch 23/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0023 - acc: 0.9994
Epoch 24/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0021 - acc: 0.9995
Epoch 25/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0019 - acc: 0.9996
Epoch 26/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0016 - acc: 0.9996
Epoch 27/27

837/837 [==============================] - 22s 26ms/step - loss: 0.0015 - acc: 0.9996
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8107
False 964
True percentage 0.893727262705
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.86      0.70      0.77       438
      I-PER       0.82      0.63      0.71       214
          O       0.98      0.95      0.97      7318
      B-ORG       0.69      0.72      0.71       296
      B-LOC       0.76      0.74      0.75       218
      I-ORG       0.52      0.55      0.54       151
      I-LOC       0.74      0.77      0.76       141
     B-MISC       0.45      0.33      0.38       141
     I-MISC       0.48      0.42      0.45       154

avg / total       0.93      0.89      0.91      9071

F-1 Score (without O):
0.919884454401
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104345 unique words.
4341 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 266
OOV word occurences: in test 428
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678144     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,274
Trainable params: 6,790,274
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 12s 37ms/step - loss: 0.1563 - acc: 0.9458
Epoch 2/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0782 - acc: 0.9743
Epoch 3/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0660 - acc: 0.9765
Epoch 4/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0586 - acc: 0.9788
Epoch 5/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0523 - acc: 0.9810
Epoch 6/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0472 - acc: 0.9831
Epoch 7/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0424 - acc: 0.9849
Epoch 8/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0368 - acc: 0.9874
Epoch 9/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0324 - acc: 0.9891
Epoch 10/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0285 - acc: 0.9905
Epoch 11/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0248 - acc: 0.9919
Epoch 12/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0215 - acc: 0.9930
Epoch 13/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0194 - acc: 0.9941
Epoch 14/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0164 - acc: 0.9952
Epoch 15/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0144 - acc: 0.9958
Epoch 16/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0128 - acc: 0.9963
Epoch 17/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0106 - acc: 0.9973
Epoch 18/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0097 - acc: 0.9977
Epoch 19/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0080 - acc: 0.9981
Epoch 20/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0073 - acc: 0.9981
Epoch 21/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0064 - acc: 0.9987
Epoch 22/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0056 - acc: 0.9987
Epoch 23/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0053 - acc: 0.9987
Epoch 24/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0046 - acc: 0.9990
Epoch 25/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0040 - acc: 0.9992
Epoch 26/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0034 - acc: 0.9993
Epoch 27/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0032 - acc: 0.9993
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8018
False 1053
True percentage 0.883915775548
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.96      0.97      7318
      B-PER       0.84      0.69      0.76       438
      B-ORG       0.71      0.59      0.64       296
      I-ORG       0.53      0.46      0.49       151
      I-PER       0.85      0.54      0.66       214
      B-LOC       0.70      0.70      0.70       218
     B-MISC       0.40      0.26      0.32       141
      I-LOC       0.72      0.71      0.71       141
     I-MISC       0.51      0.27      0.35       154

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.629042485732
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104368 unique words.
4364 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 257
OOV word occurences: in test 410
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6679616     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,791,746
Trainable params: 6,791,746
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 13s 39ms/step - loss: 0.1964 - acc: 0.9341
Epoch 2/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0860 - acc: 0.9734
Epoch 3/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0687 - acc: 0.9762
Epoch 4/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0600 - acc: 0.9782
Epoch 5/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0538 - acc: 0.9802
Epoch 6/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0480 - acc: 0.9826
Epoch 7/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0436 - acc: 0.9842
Epoch 8/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0388 - acc: 0.9864
Epoch 9/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0342 - acc: 0.9880
Epoch 10/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0305 - acc: 0.9892
Epoch 11/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0265 - acc: 0.9908
Epoch 12/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0236 - acc: 0.9924
Epoch 13/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0212 - acc: 0.9931
Epoch 14/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0187 - acc: 0.9942
Epoch 15/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0161 - acc: 0.9953
Epoch 16/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0140 - acc: 0.9959
Epoch 17/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0126 - acc: 0.9963
Epoch 18/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0109 - acc: 0.9972
Epoch 19/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0094 - acc: 0.9976
Epoch 20/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0081 - acc: 0.9978
Epoch 21/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0073 - acc: 0.9981
Epoch 22/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0065 - acc: 0.9984
Epoch 23/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0056 - acc: 0.9987
Epoch 24/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0047 - acc: 0.9990
Epoch 25/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0041 - acc: 0.9992
Epoch 26/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0041 - acc: 0.9992
Epoch 27/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0033 - acc: 0.9995
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7989
False 1082
True percentage 0.880718774115
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.97      7318
      B-ORG       0.66      0.67      0.67       296
      I-ORG       0.43      0.33      0.38       151
      B-PER       0.82      0.66      0.73       438
      B-LOC       0.68      0.67      0.67       218
      I-LOC       0.67      0.70      0.69       141
      I-PER       0.80      0.61      0.69       214
     B-MISC       0.36      0.25      0.29       141
     I-MISC       0.44      0.37      0.40       154

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.614067278287
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104333 unique words.
4329 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 268
OOV word occurences: in test 411
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6677376     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,789,506
Trainable params: 6,789,506
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 12s 37ms/step - loss: 0.2161 - acc: 0.9276
Epoch 2/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0870 - acc: 0.9723
Epoch 3/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0698 - acc: 0.9757
Epoch 4/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0612 - acc: 0.9781
Epoch 5/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0538 - acc: 0.9804
Epoch 6/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0491 - acc: 0.9825
Epoch 7/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0431 - acc: 0.9845
Epoch 8/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0388 - acc: 0.9867
Epoch 9/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0348 - acc: 0.9878
Epoch 10/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0317 - acc: 0.9890
Epoch 11/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0285 - acc: 0.9902
Epoch 12/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0253 - acc: 0.9909
Epoch 13/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0220 - acc: 0.9926
Epoch 14/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0201 - acc: 0.9933
Epoch 15/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0177 - acc: 0.9945
Epoch 16/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0160 - acc: 0.9950
Epoch 17/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0137 - acc: 0.9961
Epoch 18/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0122 - acc: 0.9962
Epoch 19/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0105 - acc: 0.9971
Epoch 20/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0091 - acc: 0.9977
Epoch 21/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0083 - acc: 0.9977
Epoch 22/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0072 - acc: 0.9980
Epoch 23/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0067 - acc: 0.9984
Epoch 24/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0057 - acc: 0.9984
Epoch 25/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0053 - acc: 0.9989
Epoch 26/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0045 - acc: 0.9990
Epoch 27/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0040 - acc: 0.9990
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8005
False 1066
True percentage 0.882482636975
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.97      7318
      B-PER       0.83      0.71      0.76       438
      B-ORG       0.65      0.66      0.66       296
      I-ORG       0.45      0.46      0.46       151
     B-MISC       0.36      0.31      0.33       141
     I-MISC       0.41      0.40      0.40       154
      I-PER       0.89      0.58      0.71       214
      B-LOC       0.73      0.72      0.73       218
      I-LOC       0.73      0.72      0.72       141

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.635441527446
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104348 unique words.
4344 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 262
OOV word occurences: in test 406
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678336     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,466
Trainable params: 6,790,466
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 12s 36ms/step - loss: 0.1918 - acc: 0.9356
Epoch 2/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0910 - acc: 0.9698
Epoch 3/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0733 - acc: 0.9741
Epoch 4/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0661 - acc: 0.9755
Epoch 5/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0604 - acc: 0.9773
Epoch 6/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0535 - acc: 0.9800
Epoch 7/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0480 - acc: 0.9827
Epoch 8/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0430 - acc: 0.9849
Epoch 9/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0388 - acc: 0.9862
Epoch 10/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0334 - acc: 0.9885
Epoch 11/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0300 - acc: 0.9897
Epoch 12/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0258 - acc: 0.9913
Epoch 13/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0231 - acc: 0.9923
Epoch 14/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0194 - acc: 0.9939
Epoch 15/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0166 - acc: 0.9952
Epoch 16/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0142 - acc: 0.9956
Epoch 17/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0124 - acc: 0.9967
Epoch 18/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0113 - acc: 0.9969
Epoch 19/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0101 - acc: 0.9973
Epoch 20/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0086 - acc: 0.9980
Epoch 21/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0070 - acc: 0.9983
Epoch 22/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0065 - acc: 0.9984
Epoch 23/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0060 - acc: 0.9987
Epoch 24/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0056 - acc: 0.9986
Epoch 25/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0047 - acc: 0.9988
Epoch 26/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0044 - acc: 0.9990
Epoch 27/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0036 - acc: 0.9992
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8064
False 1007
True percentage 0.88898688127
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.64      0.74      0.69       296
      B-PER       0.85      0.66      0.74       438
      I-PER       0.84      0.58      0.69       214
      B-LOC       0.70      0.68      0.69       218
      I-LOC       0.74      0.74      0.74       141
      I-ORG       0.52      0.64      0.58       151
     B-MISC       0.48      0.20      0.28       141
     I-MISC       0.57      0.31      0.40       154

avg / total       0.93      0.89      0.90      9071

F-1 Score (without O):
0.648681790313
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104351 unique words.
4347 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 261
OOV word occurences: in test 412
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678528     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,658
Trainable params: 6,790,658
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 12s 36ms/step - loss: 0.1698 - acc: 0.9428
Epoch 2/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0813 - acc: 0.9740
Epoch 3/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0684 - acc: 0.9763
Epoch 4/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0611 - acc: 0.9781
Epoch 5/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0540 - acc: 0.9802
Epoch 6/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0495 - acc: 0.9818
Epoch 7/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0445 - acc: 0.9838
Epoch 8/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0399 - acc: 0.9857
Epoch 9/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0355 - acc: 0.9877
Epoch 10/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0312 - acc: 0.9891
Epoch 11/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0280 - acc: 0.9902
Epoch 12/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0247 - acc: 0.9916
Epoch 13/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0223 - acc: 0.9927
Epoch 14/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0191 - acc: 0.9939
Epoch 15/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0167 - acc: 0.9951
Epoch 16/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0143 - acc: 0.9955
Epoch 17/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0127 - acc: 0.9966
Epoch 18/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0114 - acc: 0.9966
Epoch 19/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0100 - acc: 0.9975
Epoch 20/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0083 - acc: 0.9978
Epoch 21/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0077 - acc: 0.9980
Epoch 22/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0067 - acc: 0.9982
Epoch 23/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0061 - acc: 0.9986
Epoch 24/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0053 - acc: 0.9989
Epoch 25/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0051 - acc: 0.9988
Epoch 26/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0047 - acc: 0.9989
Epoch 27/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0044 - acc: 0.9991
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7967
False 1104
True percentage 0.878293462683
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.82      0.64      0.72       438
          O       0.98      0.95      0.96      7318
      B-ORG       0.71      0.62      0.66       296
     B-MISC       0.34      0.40      0.36       141
      I-ORG       0.49      0.37      0.42       151
      I-PER       0.81      0.57      0.67       214
     I-MISC       0.38      0.52      0.44       154
      B-LOC       0.75      0.62      0.68       218
      I-LOC       0.75      0.64      0.69       141

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.906891668633
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104356 unique words.
4352 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 266
OOV word occurences: in test 431
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678848     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,978
Trainable params: 6,790,978
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 12s 37ms/step - loss: 0.2301 - acc: 0.9238
Epoch 2/27

334/334 [==============================] - 9s 27ms/step - loss: 0.1036 - acc: 0.9675
Epoch 3/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0825 - acc: 0.9730
Epoch 4/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0724 - acc: 0.9742
Epoch 5/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0654 - acc: 0.9758
Epoch 6/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0588 - acc: 0.9778
Epoch 7/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0535 - acc: 0.9801
Epoch 8/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0487 - acc: 0.9822
Epoch 9/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0429 - acc: 0.9847
Epoch 10/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0387 - acc: 0.9866
Epoch 11/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0345 - acc: 0.9883
Epoch 12/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0311 - acc: 0.9893
Epoch 13/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0269 - acc: 0.9912
Epoch 14/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0240 - acc: 0.9923
Epoch 15/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0212 - acc: 0.9935
Epoch 16/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0185 - acc: 0.9945
Epoch 17/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0162 - acc: 0.9954
Epoch 18/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0136 - acc: 0.9964
Epoch 19/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0121 - acc: 0.9966
Epoch 20/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0107 - acc: 0.9973
Epoch 21/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0095 - acc: 0.9976
Epoch 22/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0082 - acc: 0.9978
Epoch 23/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0074 - acc: 0.9981
Epoch 24/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0064 - acc: 0.9985
Epoch 25/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0061 - acc: 0.9986
Epoch 26/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0053 - acc: 0.9988
Epoch 27/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0047 - acc: 0.9989
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7981
False 1090
True percentage 0.879836842685
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.97      7318
      B-PER       0.83      0.67      0.74       438
      B-ORG       0.63      0.65      0.64       296
      I-ORG       0.47      0.48      0.48       151
      B-LOC       0.69      0.68      0.69       218
      I-PER       0.82      0.59      0.69       214
     B-MISC       0.41      0.23      0.30       141
      I-LOC       0.63      0.72      0.67       141
     I-MISC       0.43      0.27      0.33       154

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.616232771822
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104346 unique words.
4342 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 264
OOV word occurences: in test 440
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678208     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,338
Trainable params: 6,790,338
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 12s 37ms/step - loss: 0.1762 - acc: 0.9387
Epoch 2/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0832 - acc: 0.9740
Epoch 3/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0696 - acc: 0.9757
Epoch 4/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0611 - acc: 0.9776
Epoch 5/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0553 - acc: 0.9792
Epoch 6/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0506 - acc: 0.9806
Epoch 7/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0452 - acc: 0.9830
Epoch 8/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0408 - acc: 0.9854
Epoch 9/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0364 - acc: 0.9873
Epoch 10/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0327 - acc: 0.9891
Epoch 11/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0287 - acc: 0.9907
Epoch 12/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0247 - acc: 0.9922
Epoch 13/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0221 - acc: 0.9932
Epoch 14/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0189 - acc: 0.9945
Epoch 15/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0166 - acc: 0.9951
Epoch 16/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0145 - acc: 0.9963
Epoch 17/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0123 - acc: 0.9967
Epoch 18/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0106 - acc: 0.9977
Epoch 19/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0094 - acc: 0.9978
Epoch 20/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0083 - acc: 0.9982
Epoch 21/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0070 - acc: 0.9984
Epoch 22/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0068 - acc: 0.9985
Epoch 23/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0057 - acc: 0.9988
Epoch 24/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0052 - acc: 0.9987
Epoch 25/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0046 - acc: 0.9990
Epoch 26/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0038 - acc: 0.9992
Epoch 27/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0032 - acc: 0.9994
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7926
False 1145
True percentage 0.873773564105
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-PER       0.81      0.65      0.72       438
      I-PER       0.83      0.54      0.65       214
      B-ORG       0.54      0.62      0.58       296
      I-ORG       0.44      0.58      0.50       151
      B-LOC       0.66      0.69      0.68       218
     B-MISC       0.42      0.23      0.30       141
     I-MISC       0.49      0.31      0.38       154
      I-LOC       0.66      0.70      0.68       141

avg / total       0.92      0.87      0.89      9071

F-1 Score (without O):
0.601079784043
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104341 unique words.
4337 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 262
OOV word occurences: in test 426
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6677888     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,018
Trainable params: 6,790,018
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 12s 36ms/step - loss: 0.1711 - acc: 0.9427
Epoch 2/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0922 - acc: 0.9722
Epoch 3/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0755 - acc: 0.9749
Epoch 4/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0679 - acc: 0.9766
Epoch 5/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0604 - acc: 0.9778
Epoch 6/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0529 - acc: 0.9799
Epoch 7/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0475 - acc: 0.9823
Epoch 8/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0426 - acc: 0.9838
Epoch 9/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0375 - acc: 0.9862
Epoch 10/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0334 - acc: 0.9881
Epoch 11/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0292 - acc: 0.9899
Epoch 12/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0257 - acc: 0.9912
Epoch 13/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0228 - acc: 0.9929
Epoch 14/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0196 - acc: 0.9939
Epoch 15/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0176 - acc: 0.9948
Epoch 16/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0148 - acc: 0.9959
Epoch 17/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0123 - acc: 0.9964
Epoch 18/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0116 - acc: 0.9966
Epoch 19/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0095 - acc: 0.9973
Epoch 20/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0088 - acc: 0.9976
Epoch 21/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0080 - acc: 0.9980
Epoch 22/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0067 - acc: 0.9983
Epoch 23/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0063 - acc: 0.9983
Epoch 24/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0057 - acc: 0.9987
Epoch 25/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0048 - acc: 0.9988
Epoch 26/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0048 - acc: 0.9988
Epoch 27/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0036 - acc: 0.9993
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7931
False 1140
True percentage 0.874324771249
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.97      7318
     B-MISC       0.29      0.22      0.25       141
     I-MISC       0.35      0.22      0.27       154
      B-ORG       0.60      0.65      0.62       296
      B-LOC       0.68      0.70      0.69       218
      B-PER       0.83      0.67      0.74       438
      I-PER       0.88      0.56      0.69       214
      I-ORG       0.35      0.37      0.36       151
      I-LOC       0.56      0.76      0.64       141

avg / total       0.92      0.87      0.89      9071

F-1 Score (without O):
0.590242442383
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 8
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104339 unique words.
4335 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 259
OOV word occurences: in test 410
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6677760     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,789,890
Trainable params: 6,789,890
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 12s 36ms/step - loss: 0.1854 - acc: 0.9371
Epoch 2/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0866 - acc: 0.9733
Epoch 3/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0716 - acc: 0.9756
Epoch 4/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0636 - acc: 0.9777
Epoch 5/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0581 - acc: 0.9788
Epoch 6/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0519 - acc: 0.9803
Epoch 7/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0462 - acc: 0.9827
Epoch 8/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0415 - acc: 0.9853
Epoch 9/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0355 - acc: 0.9874
Epoch 10/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0320 - acc: 0.9888
Epoch 11/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0283 - acc: 0.9905
Epoch 12/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0242 - acc: 0.9918
Epoch 13/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0214 - acc: 0.9930
Epoch 14/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0185 - acc: 0.9942
Epoch 15/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0161 - acc: 0.9953
Epoch 16/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0144 - acc: 0.9958
Epoch 17/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0122 - acc: 0.9966
Epoch 18/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0107 - acc: 0.9972
Epoch 19/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0093 - acc: 0.9978
Epoch 20/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0077 - acc: 0.9981
Epoch 21/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0072 - acc: 0.9983
Epoch 22/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0067 - acc: 0.9985
Epoch 23/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0058 - acc: 0.9987
Epoch 24/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0052 - acc: 0.9988
Epoch 25/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0047 - acc: 0.9989
Epoch 26/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0042 - acc: 0.9991
Epoch 27/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0039 - acc: 0.9991
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7971
False 1100
True percentage 0.878734428398
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.97      7318
     B-MISC       0.31      0.31      0.31       141
      B-ORG       0.69      0.57      0.63       296
      B-PER       0.84      0.69      0.76       438
     I-MISC       0.36      0.27      0.31       154
      I-PER       0.78      0.58      0.67       214
      I-ORG       0.43      0.32      0.37       151
      B-LOC       0.71      0.75      0.73       218
      I-LOC       0.57      0.79      0.66       141

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.607594936709
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 9
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104351 unique words.
4347 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 259
OOV word occurences: in test 405
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678528     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,658
Trainable params: 6,790,658
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 12s 37ms/step - loss: 0.1971 - acc: 0.9339
Epoch 2/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0855 - acc: 0.9725
Epoch 3/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0695 - acc: 0.9762
Epoch 4/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0624 - acc: 0.9773
Epoch 5/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0561 - acc: 0.9789
Epoch 6/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0504 - acc: 0.9811
Epoch 7/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0455 - acc: 0.9829
Epoch 8/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0401 - acc: 0.9851
Epoch 9/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0349 - acc: 0.9875
Epoch 10/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0316 - acc: 0.9888
Epoch 11/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0278 - acc: 0.9904
Epoch 12/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0247 - acc: 0.9914
Epoch 13/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0216 - acc: 0.9926
Epoch 14/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0193 - acc: 0.9935
Epoch 15/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0170 - acc: 0.9948
Epoch 16/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0146 - acc: 0.9959
Epoch 17/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0126 - acc: 0.9966
Epoch 18/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0117 - acc: 0.9966
Epoch 19/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0095 - acc: 0.9975
Epoch 20/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0080 - acc: 0.9981
Epoch 21/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0074 - acc: 0.9982
Epoch 22/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0063 - acc: 0.9986
Epoch 23/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0053 - acc: 0.9989
Epoch 24/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0047 - acc: 0.9991
Epoch 25/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0044 - acc: 0.9992
Epoch 26/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0039 - acc: 0.9992
Epoch 27/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0034 - acc: 0.9995
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7975
False 1096
True percentage 0.879175394113
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.97      7318
      B-PER       0.85      0.72      0.78       438
      B-ORG       0.60      0.67      0.63       296
      I-ORG       0.39      0.38      0.39       151
      I-PER       0.83      0.62      0.71       214
      B-LOC       0.64      0.65      0.65       218
      I-LOC       0.66      0.69      0.67       141
     B-MISC       0.34      0.24      0.28       141
     I-MISC       0.36      0.25      0.30       154

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.607602514217
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 10
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104378 unique words.
4374 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 260
OOV word occurences: in test 412
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6680256     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,792,386
Trainable params: 6,792,386
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 13s 38ms/step - loss: 0.1684 - acc: 0.9416
Epoch 2/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0883 - acc: 0.9718
Epoch 3/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0737 - acc: 0.9744
Epoch 4/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0654 - acc: 0.9759
Epoch 5/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0582 - acc: 0.9784
Epoch 6/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0513 - acc: 0.9810
Epoch 7/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0458 - acc: 0.9835
Epoch 8/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0408 - acc: 0.9855
Epoch 9/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0360 - acc: 0.9872
Epoch 10/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0315 - acc: 0.9896
Epoch 11/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0278 - acc: 0.9912
Epoch 12/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0244 - acc: 0.9923
Epoch 13/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0207 - acc: 0.9935
Epoch 14/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0175 - acc: 0.9947
Epoch 15/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0156 - acc: 0.9954
Epoch 16/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0135 - acc: 0.9961
Epoch 17/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0120 - acc: 0.9964
Epoch 18/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0099 - acc: 0.9973
Epoch 19/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0090 - acc: 0.9977
Epoch 20/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0077 - acc: 0.9980
Epoch 21/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0066 - acc: 0.9983
Epoch 22/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0057 - acc: 0.9987
Epoch 23/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0053 - acc: 0.9989
Epoch 24/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0048 - acc: 0.9989
Epoch 25/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0042 - acc: 0.9991
Epoch 26/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0036 - acc: 0.9994
Epoch 27/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0034 - acc: 0.9992
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7994
False 1077
True percentage 0.881269981259
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.81      0.71      0.76       438
      B-ORG       0.66      0.59      0.62       296
      I-ORG       0.50      0.38      0.44       151
     B-MISC       0.29      0.21      0.24       141
     I-MISC       0.41      0.28      0.33       154
      I-PER       0.85      0.57      0.68       214
      B-LOC       0.67      0.71      0.69       218
      I-LOC       0.74      0.73      0.73       141

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.613959234095
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 11
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104327 unique words.
4323 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 262
OOV word occurences: in test 438
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6676992     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,789,122
Trainable params: 6,789,122
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 12s 37ms/step - loss: 0.1791 - acc: 0.9399
Epoch 2/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0840 - acc: 0.9735
Epoch 3/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0685 - acc: 0.9762
Epoch 4/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0611 - acc: 0.9781
Epoch 5/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0550 - acc: 0.9799
Epoch 6/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0502 - acc: 0.9813
Epoch 7/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0455 - acc: 0.9834
Epoch 8/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0403 - acc: 0.9854
Epoch 9/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0357 - acc: 0.9869
Epoch 10/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0320 - acc: 0.9887
Epoch 11/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0282 - acc: 0.9904
Epoch 12/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0250 - acc: 0.9914
Epoch 13/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0214 - acc: 0.9932
Epoch 14/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0195 - acc: 0.9941
Epoch 15/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0171 - acc: 0.9946
Epoch 16/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0140 - acc: 0.9963
Epoch 17/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0121 - acc: 0.9966
Epoch 18/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0104 - acc: 0.9974
Epoch 19/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0088 - acc: 0.9979
Epoch 20/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0076 - acc: 0.9983
Epoch 21/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0070 - acc: 0.9983
Epoch 22/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0064 - acc: 0.9986
Epoch 23/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0050 - acc: 0.9990
Epoch 24/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0045 - acc: 0.9991
Epoch 25/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0040 - acc: 0.9993
Epoch 26/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0034 - acc: 0.9994
Epoch 27/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0032 - acc: 0.9994
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7951
False 1120
True percentage 0.876529599824
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.59      0.62      0.61       296
          O       0.98      0.95      0.97      7318
     B-MISC       0.33      0.14      0.20       141
     I-MISC       0.33      0.13      0.19       154
      B-PER       0.84      0.70      0.76       438
      I-PER       0.87      0.57      0.69       214
      B-LOC       0.62      0.70      0.66       218
      I-LOC       0.59      0.74      0.66       141
      I-ORG       0.46      0.52      0.49       151

avg / total       0.91      0.88      0.89      9071

F-1 Score (without O):
0.908622908623
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104302 unique words.
4298 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 264
OOV word occurences: in test 431
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6675392     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,787,522
Trainable params: 6,787,522
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 13s 38ms/step - loss: 0.2145 - acc: 0.9299
Epoch 2/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0942 - acc: 0.9706
Epoch 3/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0738 - acc: 0.9753
Epoch 4/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0662 - acc: 0.9765
Epoch 5/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0597 - acc: 0.9781
Epoch 6/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0546 - acc: 0.9795
Epoch 7/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0499 - acc: 0.9819
Epoch 8/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0447 - acc: 0.9832
Epoch 9/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0402 - acc: 0.9856
Epoch 10/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0362 - acc: 0.9871
Epoch 11/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0321 - acc: 0.9890
Epoch 12/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0292 - acc: 0.9900
Epoch 13/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0257 - acc: 0.9913
Epoch 14/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0220 - acc: 0.9929
Epoch 15/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0206 - acc: 0.9936
Epoch 16/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0183 - acc: 0.9943
Epoch 17/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0151 - acc: 0.9957
Epoch 18/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0141 - acc: 0.9961
Epoch 19/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0122 - acc: 0.9965
Epoch 20/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0108 - acc: 0.9969
Epoch 21/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0098 - acc: 0.9977
Epoch 22/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0088 - acc: 0.9979
Epoch 23/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0077 - acc: 0.9980
Epoch 24/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0072 - acc: 0.9982
Epoch 25/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0059 - acc: 0.9985
Epoch 26/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0054 - acc: 0.9988
Epoch 27/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0047 - acc: 0.9990
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7991
False 1080
True percentage 0.880939256973
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.85      0.69      0.76       438
      I-PER       0.82      0.59      0.69       214
          O       0.97      0.95      0.96      7318
      B-ORG       0.67      0.65      0.66       296
      B-LOC       0.72      0.68      0.70       218
      I-ORG       0.47      0.43      0.45       151
      I-LOC       0.73      0.72      0.72       141
     B-MISC       0.30      0.19      0.23       141
     I-MISC       0.45      0.32      0.38       154

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.908854474524
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104187 unique words.
4183 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 275
OOV word occurences: in test 464
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6668032     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,780,162
Trainable params: 6,780,162
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 8s 46ms/step - loss: 0.2323 - acc: 0.9164
Epoch 2/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1133 - acc: 0.9628
Epoch 3/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0850 - acc: 0.9738
Epoch 4/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0735 - acc: 0.9756
Epoch 5/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0679 - acc: 0.9762
Epoch 6/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0620 - acc: 0.9771
Epoch 7/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0592 - acc: 0.9785
Epoch 8/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0541 - acc: 0.9802
Epoch 9/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0510 - acc: 0.9820
Epoch 10/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0473 - acc: 0.9834
Epoch 11/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0439 - acc: 0.9849
Epoch 12/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0409 - acc: 0.9858
Epoch 13/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0372 - acc: 0.9877
Epoch 14/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0348 - acc: 0.9886
Epoch 15/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0321 - acc: 0.9892
Epoch 16/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0293 - acc: 0.9908
Epoch 17/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0272 - acc: 0.9912
Epoch 18/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0244 - acc: 0.9921
Epoch 19/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0224 - acc: 0.9930
Epoch 20/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0206 - acc: 0.9936
Epoch 21/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0190 - acc: 0.9945
Epoch 22/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0172 - acc: 0.9951
Epoch 23/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0164 - acc: 0.9954
Epoch 24/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0143 - acc: 0.9961
Epoch 25/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0130 - acc: 0.9966
Epoch 26/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0121 - acc: 0.9969
Epoch 27/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0107 - acc: 0.9973
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7885
False 1186
True percentage 0.869253665528
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.96      0.96      7318
      B-PER       0.87      0.68      0.76       438
      B-ORG       0.51      0.65      0.57       296
      I-ORG       0.31      0.38      0.34       151
      I-PER       0.86      0.57      0.68       214
      B-LOC       0.74      0.56      0.64       218
     B-MISC       0.68      0.09      0.16       141
      I-LOC       0.57      0.41      0.48       141
     I-MISC       0.62      0.10      0.18       154

avg / total       0.91      0.87      0.88      9071

F-1 Score (without O):
0.56435006435
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104198 unique words.
4194 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 269
OOV word occurences: in test 447
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6668736     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,780,866
Trainable params: 6,780,866
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 8s 49ms/step - loss: 0.2373 - acc: 0.9168
Epoch 2/27

167/167 [==============================] - 5s 29ms/step - loss: 0.1082 - acc: 0.9656
Epoch 3/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0820 - acc: 0.9737
Epoch 4/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0730 - acc: 0.9755
Epoch 5/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0675 - acc: 0.9764
Epoch 6/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0628 - acc: 0.9772
Epoch 7/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0602 - acc: 0.9778
Epoch 8/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0559 - acc: 0.9793
Epoch 9/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0527 - acc: 0.9799
Epoch 10/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0495 - acc: 0.9814
Epoch 11/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0463 - acc: 0.9826
Epoch 12/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0442 - acc: 0.9837
Epoch 13/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0400 - acc: 0.9858
Epoch 14/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0378 - acc: 0.9867
Epoch 15/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0338 - acc: 0.9887
Epoch 16/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0317 - acc: 0.9894
Epoch 17/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0284 - acc: 0.9911
Epoch 18/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0274 - acc: 0.9911
Epoch 19/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0244 - acc: 0.9924
Epoch 20/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0221 - acc: 0.9931
Epoch 21/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0200 - acc: 0.9942
Epoch 22/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0178 - acc: 0.9951
Epoch 23/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0167 - acc: 0.9954
Epoch 24/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0153 - acc: 0.9959
Epoch 25/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0146 - acc: 0.9957
Epoch 26/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0131 - acc: 0.9963
Epoch 27/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0114 - acc: 0.9969
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7796
False 1275
True percentage 0.859442178371
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-ORG       0.57      0.52      0.55       296
      I-ORG       0.29      0.16      0.21       151
      B-PER       0.75      0.62      0.68       438
      B-LOC       0.63      0.57      0.60       218
      I-LOC       0.56      0.34      0.42       141
      I-PER       0.65      0.60      0.62       214
     B-MISC       0.36      0.25      0.29       141
     I-MISC       0.33      0.39      0.36       154

avg / total       0.89      0.86      0.88      9071

F-1 Score (without O):
0.52556554075
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104178 unique words.
4174 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 272
OOV word occurences: in test 428
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6667456     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,779,586
Trainable params: 6,779,586
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 8s 46ms/step - loss: 0.2842 - acc: 0.9060
Epoch 2/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1364 - acc: 0.9570
Epoch 3/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0949 - acc: 0.9688
Epoch 4/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0806 - acc: 0.9727
Epoch 5/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0745 - acc: 0.9742
Epoch 6/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0692 - acc: 0.9753
Epoch 7/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0644 - acc: 0.9764
Epoch 8/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0604 - acc: 0.9774
Epoch 9/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0575 - acc: 0.9783
Epoch 10/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0534 - acc: 0.9798
Epoch 11/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0494 - acc: 0.9813
Epoch 12/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0459 - acc: 0.9835
Epoch 13/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0424 - acc: 0.9854
Epoch 14/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0391 - acc: 0.9867
Epoch 15/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0373 - acc: 0.9872
Epoch 16/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0340 - acc: 0.9890
Epoch 17/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0315 - acc: 0.9897
Epoch 18/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0296 - acc: 0.9904
Epoch 19/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0274 - acc: 0.9914
Epoch 20/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0244 - acc: 0.9921
Epoch 21/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0227 - acc: 0.9927
Epoch 22/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0204 - acc: 0.9939
Epoch 23/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0196 - acc: 0.9940
Epoch 24/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0180 - acc: 0.9940
Epoch 25/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0159 - acc: 0.9956
Epoch 26/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0141 - acc: 0.9965
Epoch 27/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0123 - acc: 0.9970
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7854
False 1217
True percentage 0.865836181237
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-PER       0.82      0.66      0.73       438
      B-ORG       0.51      0.60      0.55       296
      I-ORG       0.31      0.44      0.36       151
     B-MISC       0.39      0.11      0.17       141
     I-MISC       0.29      0.16      0.21       154
      I-PER       0.71      0.59      0.65       214
      B-LOC       0.69      0.65      0.67       218
      I-LOC       0.64      0.35      0.45       141

avg / total       0.90      0.87      0.88      9071

F-1 Score (without O):
0.546458141674
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104207 unique words.
4203 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 271
OOV word occurences: in test 452
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6669312     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,781,442
Trainable params: 6,781,442
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 8s 46ms/step - loss: 0.2523 - acc: 0.9116
Epoch 2/27

167/167 [==============================] - 5s 29ms/step - loss: 0.1358 - acc: 0.9608
Epoch 3/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0974 - acc: 0.9688
Epoch 4/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0855 - acc: 0.9715
Epoch 5/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0775 - acc: 0.9729
Epoch 6/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0725 - acc: 0.9740
Epoch 7/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0668 - acc: 0.9756
Epoch 8/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0637 - acc: 0.9769
Epoch 9/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0594 - acc: 0.9776
Epoch 10/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0559 - acc: 0.9791
Epoch 11/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0532 - acc: 0.9806
Epoch 12/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0483 - acc: 0.9822
Epoch 13/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0457 - acc: 0.9841
Epoch 14/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0427 - acc: 0.9845
Epoch 15/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0392 - acc: 0.9862
Epoch 16/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0362 - acc: 0.9869
Epoch 17/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0331 - acc: 0.9887
Epoch 18/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0303 - acc: 0.9894
Epoch 19/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0270 - acc: 0.9914
Epoch 20/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0248 - acc: 0.9925
Epoch 21/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0220 - acc: 0.9934
Epoch 22/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0203 - acc: 0.9940
Epoch 23/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0184 - acc: 0.9951
Epoch 24/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0157 - acc: 0.9960
Epoch 25/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0152 - acc: 0.9960
Epoch 26/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0138 - acc: 0.9965
Epoch 27/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0122 - acc: 0.9968
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7880
False 1191
True percentage 0.868702458384
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-ORG       0.58      0.65      0.61       296
      B-PER       0.82      0.64      0.72       438
      I-PER       0.76      0.50      0.60       214
      B-LOC       0.76      0.61      0.68       218
      I-LOC       0.66      0.48      0.55       141
      I-ORG       0.35      0.57      0.43       151
     B-MISC       0.27      0.16      0.20       141
     I-MISC       0.45      0.29      0.36       154

avg / total       0.91      0.87      0.89      9071

F-1 Score (without O):
0.570379436965
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104196 unique words.
4192 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 272
OOV word occurences: in test 526
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6668608     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,780,738
Trainable params: 6,780,738
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 8s 46ms/step - loss: 0.3177 - acc: 0.9019
Epoch 2/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1623 - acc: 0.9464
Epoch 3/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0956 - acc: 0.9673
Epoch 4/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0773 - acc: 0.9754
Epoch 5/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0709 - acc: 0.9761
Epoch 6/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0654 - acc: 0.9772
Epoch 7/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0629 - acc: 0.9780
Epoch 8/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0580 - acc: 0.9790
Epoch 9/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0546 - acc: 0.9797
Epoch 10/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0509 - acc: 0.9810
Epoch 11/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0487 - acc: 0.9813
Epoch 12/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0456 - acc: 0.9829
Epoch 13/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0424 - acc: 0.9837
Epoch 14/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0406 - acc: 0.9846
Epoch 15/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0366 - acc: 0.9861
Epoch 16/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0355 - acc: 0.9863
Epoch 17/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0325 - acc: 0.9884
Epoch 18/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0300 - acc: 0.9897
Epoch 19/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0274 - acc: 0.9904
Epoch 20/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0253 - acc: 0.9918
Epoch 21/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0229 - acc: 0.9926
Epoch 22/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0214 - acc: 0.9930
Epoch 23/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0195 - acc: 0.9940
Epoch 24/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0173 - acc: 0.9950
Epoch 25/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0155 - acc: 0.9958
Epoch 26/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0139 - acc: 0.9966
Epoch 27/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0131 - acc: 0.9966
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7738
False 1333
True percentage 0.853048175504
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.76      0.54      0.63       438
          O       0.98      0.95      0.96      7318
      B-ORG       0.54      0.53      0.53       296
     B-MISC       0.41      0.33      0.36       141
      I-ORG       0.23      0.32      0.27       151
      I-PER       0.64      0.47      0.54       214
     I-MISC       0.33      0.34      0.33       154
      B-LOC       0.74      0.59      0.66       218
      I-LOC       0.58      0.39      0.47       141

avg / total       0.90      0.85      0.88      9071

F-1 Score (without O):
0.889508002371
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104199 unique words.
4195 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 276
OOV word occurences: in test 465
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6668800     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,780,930
Trainable params: 6,780,930
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 8s 47ms/step - loss: 0.3012 - acc: 0.9022
Epoch 2/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1399 - acc: 0.9590
Epoch 3/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0993 - acc: 0.9696
Epoch 4/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0866 - acc: 0.9730
Epoch 5/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0785 - acc: 0.9734
Epoch 6/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0725 - acc: 0.9747
Epoch 7/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0686 - acc: 0.9750
Epoch 8/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0647 - acc: 0.9760
Epoch 9/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0600 - acc: 0.9769
Epoch 10/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0557 - acc: 0.9786
Epoch 11/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0514 - acc: 0.9805
Epoch 12/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0480 - acc: 0.9821
Epoch 13/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0448 - acc: 0.9838
Epoch 14/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0412 - acc: 0.9849
Epoch 15/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0384 - acc: 0.9867
Epoch 16/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0357 - acc: 0.9881
Epoch 17/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0325 - acc: 0.9892
Epoch 18/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0295 - acc: 0.9899
Epoch 19/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0273 - acc: 0.9910
Epoch 20/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0251 - acc: 0.9919
Epoch 21/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0230 - acc: 0.9929
Epoch 22/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0204 - acc: 0.9933
Epoch 23/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0186 - acc: 0.9945
Epoch 24/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0172 - acc: 0.9950
Epoch 25/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0158 - acc: 0.9953
Epoch 26/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0146 - acc: 0.9963
Epoch 27/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0132 - acc: 0.9964
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7863
False 1208
True percentage 0.866828354095
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-PER       0.83      0.62      0.71       438
      B-ORG       0.55      0.51      0.53       296
      I-ORG       0.40      0.45      0.42       151
      B-LOC       0.61      0.67      0.64       218
      I-PER       0.79      0.47      0.59       214
     B-MISC       0.40      0.16      0.23       141
      I-LOC       0.61      0.67      0.64       141
     I-MISC       0.30      0.17      0.22       154

avg / total       0.90      0.87      0.88      9071

F-1 Score (without O):
0.552738654147
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104189 unique words.
4185 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 278
OOV word occurences: in test 541
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6668160     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,780,290
Trainable params: 6,780,290
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 8s 47ms/step - loss: 0.2501 - acc: 0.9131
Epoch 2/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1192 - acc: 0.9594
Epoch 3/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0854 - acc: 0.9725
Epoch 4/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0710 - acc: 0.9762
Epoch 5/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0657 - acc: 0.9774
Epoch 6/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0583 - acc: 0.9793
Epoch 7/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0552 - acc: 0.9800
Epoch 8/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0518 - acc: 0.9807
Epoch 9/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0479 - acc: 0.9823
Epoch 10/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0452 - acc: 0.9832
Epoch 11/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0424 - acc: 0.9846
Epoch 12/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0392 - acc: 0.9867
Epoch 13/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0361 - acc: 0.9879
Epoch 14/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0339 - acc: 0.9886
Epoch 15/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0322 - acc: 0.9892
Epoch 16/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0294 - acc: 0.9907
Epoch 17/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0265 - acc: 0.9919
Epoch 18/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0244 - acc: 0.9921
Epoch 19/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0224 - acc: 0.9929
Epoch 20/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0202 - acc: 0.9936
Epoch 21/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0180 - acc: 0.9949
Epoch 22/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0167 - acc: 0.9955
Epoch 23/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0152 - acc: 0.9957
Epoch 24/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0144 - acc: 0.9962
Epoch 25/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0124 - acc: 0.9970
Epoch 26/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0112 - acc: 0.9975
Epoch 27/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0105 - acc: 0.9976
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7620
False 1451
True percentage 0.840039686914
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.94      0.95      7318
      B-PER       0.79      0.44      0.56       438
      I-PER       0.78      0.42      0.55       214
      B-ORG       0.44      0.57      0.50       296
      I-ORG       0.21      0.44      0.29       151
      B-LOC       0.70      0.61      0.65       218
     B-MISC       0.49      0.13      0.20       141
     I-MISC       0.43      0.13      0.20       154
      I-LOC       0.62      0.40      0.48       141

avg / total       0.90      0.84      0.86      9071

F-1 Score (without O):
0.46862188584
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104194 unique words.
4190 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 270
OOV word occurences: in test 452
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6668480     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,780,610
Trainable params: 6,780,610
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 8s 48ms/step - loss: 0.2625 - acc: 0.9113
Epoch 2/27

167/167 [==============================] - 5s 29ms/step - loss: 0.1258 - acc: 0.9614
Epoch 3/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0934 - acc: 0.9717
Epoch 4/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0790 - acc: 0.9733
Epoch 5/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0721 - acc: 0.9751
Epoch 6/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0662 - acc: 0.9768
Epoch 7/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0612 - acc: 0.9774
Epoch 8/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0582 - acc: 0.9785
Epoch 9/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0552 - acc: 0.9792
Epoch 10/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0518 - acc: 0.9800
Epoch 11/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0472 - acc: 0.9817
Epoch 12/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0451 - acc: 0.9828
Epoch 13/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0418 - acc: 0.9840
Epoch 14/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0399 - acc: 0.9848
Epoch 15/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0359 - acc: 0.9871
Epoch 16/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0331 - acc: 0.9874
Epoch 17/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0311 - acc: 0.9888
Epoch 18/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0292 - acc: 0.9895
Epoch 19/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0268 - acc: 0.9907
Epoch 20/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0246 - acc: 0.9918
Epoch 21/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0219 - acc: 0.9928
Epoch 22/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0200 - acc: 0.9935
Epoch 23/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0181 - acc: 0.9949
Epoch 24/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0164 - acc: 0.9955
Epoch 25/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0147 - acc: 0.9963
Epoch 26/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0131 - acc: 0.9968
Epoch 27/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0122 - acc: 0.9971
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7807
False 1264
True percentage 0.860654834087
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
     B-MISC       0.29      0.21      0.25       141
     I-MISC       0.38      0.20      0.26       154
      B-ORG       0.46      0.54      0.50       296
      B-LOC       0.76      0.55      0.64       218
      B-PER       0.85      0.61      0.71       438
      I-PER       0.84      0.53      0.65       214
      I-ORG       0.32      0.42      0.37       151
      I-LOC       0.56      0.65      0.60       141

avg / total       0.90      0.86      0.88      9071

F-1 Score (without O):
0.538295908951
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 8
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104195 unique words.
4191 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 270
OOV word occurences: in test 441
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6668544     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,780,674
Trainable params: 6,780,674
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 8s 49ms/step - loss: 0.2416 - acc: 0.9163
Epoch 2/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1216 - acc: 0.9604
Epoch 3/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0933 - acc: 0.9724
Epoch 4/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0786 - acc: 0.9737
Epoch 5/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0716 - acc: 0.9759
Epoch 6/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0651 - acc: 0.9777
Epoch 7/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0617 - acc: 0.9776
Epoch 8/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0591 - acc: 0.9789
Epoch 9/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0555 - acc: 0.9797
Epoch 10/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0517 - acc: 0.9805
Epoch 11/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0483 - acc: 0.9823
Epoch 12/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0450 - acc: 0.9833
Epoch 13/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0414 - acc: 0.9846
Epoch 14/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0386 - acc: 0.9861
Epoch 15/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0360 - acc: 0.9873
Epoch 16/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0325 - acc: 0.9882
Epoch 17/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0296 - acc: 0.9895
Epoch 18/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0270 - acc: 0.9910
Epoch 19/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0251 - acc: 0.9912
Epoch 20/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0222 - acc: 0.9929
Epoch 21/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0212 - acc: 0.9929
Epoch 22/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0185 - acc: 0.9944
Epoch 23/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0167 - acc: 0.9952
Epoch 24/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0148 - acc: 0.9962
Epoch 25/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0136 - acc: 0.9964
Epoch 26/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0127 - acc: 0.9967
Epoch 27/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0112 - acc: 0.9972
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7890
False 1181
True percentage 0.869804872671
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
     B-MISC       0.29      0.27      0.28       141
      B-ORG       0.60      0.55      0.57       296
      B-PER       0.84      0.66      0.73       438
     I-MISC       0.32      0.24      0.27       154
      I-PER       0.85      0.52      0.65       214
      I-ORG       0.40      0.26      0.31       151
      B-LOC       0.65      0.66      0.66       218
      I-LOC       0.55      0.70      0.61       141

avg / total       0.91      0.87      0.89      9071

F-1 Score (without O):
0.565700185071
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 9
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104202 unique words.
4198 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 269
OOV word occurences: in test 454
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6668992     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,781,122
Trainable params: 6,781,122
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 8s 45ms/step - loss: 0.2199 - acc: 0.9230
Epoch 2/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1176 - acc: 0.9618
Epoch 3/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0858 - acc: 0.9749
Epoch 4/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0717 - acc: 0.9761
Epoch 5/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0673 - acc: 0.9767
Epoch 6/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0625 - acc: 0.9777
Epoch 7/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0583 - acc: 0.9786
Epoch 8/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0551 - acc: 0.9794
Epoch 9/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0510 - acc: 0.9806
Epoch 10/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0475 - acc: 0.9819
Epoch 11/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0443 - acc: 0.9835
Epoch 12/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0420 - acc: 0.9847
Epoch 13/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0395 - acc: 0.9857
Epoch 14/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0364 - acc: 0.9867
Epoch 15/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0333 - acc: 0.9876
Epoch 16/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0313 - acc: 0.9883
Epoch 17/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0281 - acc: 0.9894
Epoch 18/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0266 - acc: 0.9901
Epoch 19/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0244 - acc: 0.9913
Epoch 20/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0217 - acc: 0.9928
Epoch 21/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0202 - acc: 0.9929
Epoch 22/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0186 - acc: 0.9940
Epoch 23/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0174 - acc: 0.9948
Epoch 24/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0158 - acc: 0.9957
Epoch 25/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0142 - acc: 0.9961
Epoch 26/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0128 - acc: 0.9965
Epoch 27/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0111 - acc: 0.9972
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7801
False 1270
True percentage 0.859993385514
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-PER       0.81      0.64      0.71       438
      B-ORG       0.53      0.55      0.54       296
      I-ORG       0.24      0.56      0.34       151
      I-PER       0.82      0.54      0.65       214
      B-LOC       0.75      0.64      0.69       218
      I-LOC       0.87      0.41      0.56       141
     B-MISC       0.36      0.11      0.17       141
     I-MISC       0.23      0.08      0.12       154

avg / total       0.91      0.86      0.88      9071

F-1 Score (without O):
0.536209553159
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 10
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104207 unique words.
4203 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 272
OOV word occurences: in test 430
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6669312     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,781,442
Trainable params: 6,781,442
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 8s 46ms/step - loss: 0.2215 - acc: 0.9244
Epoch 2/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1139 - acc: 0.9607
Epoch 3/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0894 - acc: 0.9713
Epoch 4/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0803 - acc: 0.9728
Epoch 5/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0749 - acc: 0.9741
Epoch 6/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0693 - acc: 0.9755
Epoch 7/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0646 - acc: 0.9760
Epoch 8/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0616 - acc: 0.9770
Epoch 9/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0565 - acc: 0.9787
Epoch 10/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0535 - acc: 0.9792
Epoch 11/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0493 - acc: 0.9815
Epoch 12/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0462 - acc: 0.9827
Epoch 13/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0428 - acc: 0.9849
Epoch 14/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0387 - acc: 0.9869
Epoch 15/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0356 - acc: 0.9880
Epoch 16/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0322 - acc: 0.9892
Epoch 17/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0299 - acc: 0.9904
Epoch 18/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0282 - acc: 0.9911
Epoch 19/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0255 - acc: 0.9922
Epoch 20/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0225 - acc: 0.9927
Epoch 21/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0206 - acc: 0.9934
Epoch 22/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0195 - acc: 0.9940
Epoch 23/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0168 - acc: 0.9950
Epoch 24/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0146 - acc: 0.9957
Epoch 25/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0134 - acc: 0.9965
Epoch 26/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0127 - acc: 0.9965
Epoch 27/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0115 - acc: 0.9969
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7911
False 1160
True percentage 0.872119942674
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-PER       0.76      0.73      0.74       438
      B-ORG       0.59      0.69      0.63       296
      I-ORG       0.45      0.33      0.38       151
     B-MISC       0.42      0.21      0.28       141
     I-MISC       0.41      0.16      0.23       154
      I-PER       0.76      0.49      0.60       214
      B-LOC       0.63      0.71      0.67       218
      I-LOC       0.54      0.72      0.62       141

avg / total       0.91      0.87      0.89      9071

F-1 Score (without O):
0.592259225923
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 11
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104173 unique words.
4169 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 267
OOV word occurences: in test 451
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6667136     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,779,266
Trainable params: 6,779,266
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 8s 45ms/step - loss: 0.2753 - acc: 0.9011
Epoch 2/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1445 - acc: 0.9513
Epoch 3/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0949 - acc: 0.9677
Epoch 4/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0755 - acc: 0.9749
Epoch 5/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0656 - acc: 0.9761
Epoch 6/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0598 - acc: 0.9779
Epoch 7/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0562 - acc: 0.9798
Epoch 8/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0505 - acc: 0.9812
Epoch 9/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0462 - acc: 0.9826
Epoch 10/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0433 - acc: 0.9839
Epoch 11/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0404 - acc: 0.9849
Epoch 12/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0365 - acc: 0.9864
Epoch 13/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0337 - acc: 0.9872
Epoch 14/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0306 - acc: 0.9895
Epoch 15/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0287 - acc: 0.9896
Epoch 16/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0277 - acc: 0.9904
Epoch 17/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0246 - acc: 0.9915
Epoch 18/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0230 - acc: 0.9922
Epoch 19/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0212 - acc: 0.9927
Epoch 20/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0193 - acc: 0.9933
Epoch 21/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0176 - acc: 0.9942
Epoch 22/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0159 - acc: 0.9947
Epoch 23/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0144 - acc: 0.9956
Epoch 24/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0136 - acc: 0.9962
Epoch 25/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0121 - acc: 0.9969
Epoch 26/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0111 - acc: 0.9969
Epoch 27/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0097 - acc: 0.9982
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7836
False 1235
True percentage 0.86385183552
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.52      0.57      0.55       296
          O       0.97      0.95      0.96      7318
     B-MISC       0.15      0.02      0.04       141
     I-MISC       0.28      0.07      0.11       154
      B-PER       0.83      0.65      0.73       438
      I-PER       0.79      0.54      0.64       214
      B-LOC       0.68      0.66      0.67       218
      I-LOC       0.60      0.66      0.63       141
      I-ORG       0.24      0.33      0.28       151

avg / total       0.90      0.86      0.88      9071

F-1 Score (without O):
0.898195876289
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104174 unique words.
4170 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 273
OOV word occurences: in test 525
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6667200     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,779,330
Trainable params: 6,779,330
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 8s 46ms/step - loss: 0.2083 - acc: 0.9270
Epoch 2/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1123 - acc: 0.9651
Epoch 3/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0838 - acc: 0.9753
Epoch 4/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0732 - acc: 0.9759
Epoch 5/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0667 - acc: 0.9775
Epoch 6/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0636 - acc: 0.9777
Epoch 7/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0601 - acc: 0.9787
Epoch 8/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0564 - acc: 0.9792
Epoch 9/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0512 - acc: 0.9804
Epoch 10/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0483 - acc: 0.9813
Epoch 11/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0443 - acc: 0.9832
Epoch 12/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0415 - acc: 0.9845
Epoch 13/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0385 - acc: 0.9860
Epoch 14/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0351 - acc: 0.9872
Epoch 15/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0325 - acc: 0.9882
Epoch 16/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0297 - acc: 0.9897
Epoch 17/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0279 - acc: 0.9900
Epoch 18/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0249 - acc: 0.9918
Epoch 19/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0227 - acc: 0.9930
Epoch 20/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0207 - acc: 0.9935
Epoch 21/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0183 - acc: 0.9947
Epoch 22/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0167 - acc: 0.9952
Epoch 23/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0154 - acc: 0.9957
Epoch 24/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0133 - acc: 0.9964
Epoch 25/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0119 - acc: 0.9970
Epoch 26/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0106 - acc: 0.9974
Epoch 27/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0096 - acc: 0.9978
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7778
False 1293
True percentage 0.857457832654
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.82      0.47      0.59       438
      I-PER       0.78      0.43      0.55       214
          O       0.97      0.95      0.96      7318
      B-ORG       0.57      0.61      0.59       296
      B-LOC       0.72      0.68      0.70       218
      I-ORG       0.27      0.45      0.34       151
      I-LOC       0.74      0.64      0.69       141
     B-MISC       0.43      0.11      0.18       141
     I-MISC       0.35      0.21      0.26       154

avg / total       0.91      0.86      0.88      9071

F-1 Score (without O):
0.894743059657
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104105 unique words.
4101 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 562
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6662784     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,774,914
Trainable params: 6,774,914
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 5s 63ms/step - loss: 0.2653 - acc: 0.9014
Epoch 2/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1838 - acc: 0.9320
Epoch 3/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1202 - acc: 0.9640
Epoch 4/27

83/83 [==============================] - 2s 30ms/step - loss: 0.0969 - acc: 0.9663
Epoch 5/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0824 - acc: 0.9742
Epoch 6/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0759 - acc: 0.9748
Epoch 7/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0680 - acc: 0.9761
Epoch 8/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0644 - acc: 0.9774
Epoch 9/27

83/83 [==============================] - 2s 30ms/step - loss: 0.0614 - acc: 0.9777
Epoch 10/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0588 - acc: 0.9781
Epoch 11/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0553 - acc: 0.9788
Epoch 12/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0533 - acc: 0.9805
Epoch 13/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0512 - acc: 0.9813
Epoch 14/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0500 - acc: 0.9814
Epoch 15/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0473 - acc: 0.9828
Epoch 16/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0444 - acc: 0.9844
Epoch 17/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0431 - acc: 0.9844
Epoch 18/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0402 - acc: 0.9860
Epoch 19/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0383 - acc: 0.9869
Epoch 20/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0352 - acc: 0.9880
Epoch 21/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0347 - acc: 0.9882
Epoch 22/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0334 - acc: 0.9889
Epoch 23/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0313 - acc: 0.9900
Epoch 24/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0293 - acc: 0.9904
Epoch 25/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0281 - acc: 0.9907
Epoch 26/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0268 - acc: 0.9922
Epoch 27/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0248 - acc: 0.9925
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7607
False 1464
True percentage 0.838606548341
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.95      0.95      7318
      B-PER       0.71      0.50      0.59       438
      B-ORG       0.48      0.52      0.50       296
      I-ORG       0.17      0.24      0.20       151
      I-PER       0.58      0.44      0.50       214
      B-LOC       0.64      0.59      0.61       218
     B-MISC       0.00      0.00      0.00       141
      I-LOC       0.58      0.31      0.41       141
     I-MISC       1.00      0.04      0.08       154

avg / total       0.88      0.84      0.85      9071

F-1 Score (without O):
0.447004608295
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104128 unique words.
4124 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 274
OOV word occurences: in test 468
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6664256     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,776,386
Trainable params: 6,776,386
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 5s 63ms/step - loss: 0.3429 - acc: 0.9000
Epoch 2/27

83/83 [==============================] - 3s 30ms/step - loss: 0.2168 - acc: 0.9130
Epoch 3/27

83/83 [==============================] - 3s 30ms/step - loss: 0.1273 - acc: 0.9636
Epoch 4/27

83/83 [==============================] - 2s 30ms/step - loss: 0.1070 - acc: 0.9652
Epoch 5/27

83/83 [==============================] - 2s 30ms/step - loss: 0.0889 - acc: 0.9731
Epoch 6/27

83/83 [==============================] - 2s 30ms/step - loss: 0.0828 - acc: 0.9757
Epoch 7/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0765 - acc: 0.9763
Epoch 8/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0726 - acc: 0.9768
Epoch 9/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0689 - acc: 0.9771
Epoch 10/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0668 - acc: 0.9773
Epoch 11/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0633 - acc: 0.9784
Epoch 12/27

83/83 [==============================] - 2s 30ms/step - loss: 0.0599 - acc: 0.9782
Epoch 13/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0596 - acc: 0.9787
Epoch 14/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0555 - acc: 0.9802
Epoch 15/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0532 - acc: 0.9816
Epoch 16/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0527 - acc: 0.9819
Epoch 17/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0500 - acc: 0.9821
Epoch 18/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0482 - acc: 0.9829
Epoch 19/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0467 - acc: 0.9829
Epoch 20/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0448 - acc: 0.9838
Epoch 21/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0435 - acc: 0.9840
Epoch 22/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0412 - acc: 0.9849
Epoch 23/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0402 - acc: 0.9852
Epoch 24/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0378 - acc: 0.9859
Epoch 25/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0363 - acc: 0.9875
Epoch 26/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0333 - acc: 0.9881
Epoch 27/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0311 - acc: 0.9890
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7615
False 1456
True percentage 0.839488479771
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.95      0.96      7318
      B-ORG       0.37      0.43      0.40       296
      I-ORG       0.17      0.35      0.23       151
      B-PER       0.74      0.54      0.62       438
      B-LOC       0.75      0.37      0.50       218
      I-LOC       0.38      0.02      0.04       141
      I-PER       0.67      0.58      0.62       214
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.11      0.01      0.01       154

avg / total       0.86      0.84      0.85      9071

F-1 Score (without O):
0.41155234657
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104107 unique words.
4103 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 276
OOV word occurences: in test 456
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6662912     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,042
Trainable params: 6,775,042
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 5s 63ms/step - loss: 0.2612 - acc: 0.9048
Epoch 2/27

83/83 [==============================] - 2s 30ms/step - loss: 0.1563 - acc: 0.9482
Epoch 3/27

83/83 [==============================] - 3s 30ms/step - loss: 0.1222 - acc: 0.9598
Epoch 4/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1023 - acc: 0.9687
Epoch 5/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0932 - acc: 0.9719
Epoch 6/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0827 - acc: 0.9724
Epoch 7/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0767 - acc: 0.9742
Epoch 8/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0727 - acc: 0.9742
Epoch 9/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0683 - acc: 0.9750
Epoch 10/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0649 - acc: 0.9761
Epoch 11/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0631 - acc: 0.9758
Epoch 12/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0609 - acc: 0.9770
Epoch 13/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0580 - acc: 0.9781
Epoch 14/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0564 - acc: 0.9784
Epoch 15/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0516 - acc: 0.9799
Epoch 16/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0498 - acc: 0.9809
Epoch 17/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0466 - acc: 0.9820
Epoch 18/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0453 - acc: 0.9828
Epoch 19/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0428 - acc: 0.9851
Epoch 20/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0413 - acc: 0.9853
Epoch 21/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0401 - acc: 0.9853
Epoch 22/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0376 - acc: 0.9869
Epoch 23/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0353 - acc: 0.9873
Epoch 24/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0336 - acc: 0.9888
Epoch 25/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0320 - acc: 0.9891
Epoch 26/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0304 - acc: 0.9898
Epoch 27/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0291 - acc: 0.9904
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7710
False 1361
True percentage 0.8499614155
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.95      0.96      7318
      B-PER       0.78      0.61      0.68       438
      B-ORG       0.49      0.57      0.53       296
      I-ORG       0.22      0.40      0.29       151
     B-MISC       0.33      0.02      0.04       141
     I-MISC       0.48      0.08      0.13       154
      I-PER       0.64      0.51      0.57       214
      B-LOC       0.60      0.50      0.55       218
      I-LOC       0.77      0.12      0.21       141

avg / total       0.89      0.85      0.86      9071

F-1 Score (without O):
0.477955271565
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104127 unique words.
4123 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 280
OOV word occurences: in test 543
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6664192     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,776,322
Trainable params: 6,776,322
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 5s 63ms/step - loss: 0.3369 - acc: 0.9001
Epoch 2/27

83/83 [==============================] - 2s 30ms/step - loss: 0.2400 - acc: 0.9122
Epoch 3/27

83/83 [==============================] - 3s 30ms/step - loss: 0.1610 - acc: 0.9459
Epoch 4/27

83/83 [==============================] - 2s 30ms/step - loss: 0.1242 - acc: 0.9577
Epoch 5/27

83/83 [==============================] - 2s 30ms/step - loss: 0.1035 - acc: 0.9676
Epoch 6/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0931 - acc: 0.9704
Epoch 7/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0859 - acc: 0.9709
Epoch 8/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0809 - acc: 0.9719
Epoch 9/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0765 - acc: 0.9726
Epoch 10/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0731 - acc: 0.9737
Epoch 11/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0699 - acc: 0.9749
Epoch 12/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0661 - acc: 0.9759
Epoch 13/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0645 - acc: 0.9769
Epoch 14/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0615 - acc: 0.9770
Epoch 15/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0599 - acc: 0.9762
Epoch 16/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0578 - acc: 0.9770
Epoch 17/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0541 - acc: 0.9794
Epoch 18/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0524 - acc: 0.9806
Epoch 19/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0500 - acc: 0.9830
Epoch 20/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0487 - acc: 0.9828
Epoch 21/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0459 - acc: 0.9842
Epoch 22/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0443 - acc: 0.9852
Epoch 23/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0416 - acc: 0.9858
Epoch 24/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0402 - acc: 0.9865
Epoch 25/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0381 - acc: 0.9875
Epoch 26/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0357 - acc: 0.9877
Epoch 27/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0344 - acc: 0.9892
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7573
False 1498
True percentage 0.834858339764
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.94      0.96      7318
      B-ORG       0.47      0.58      0.52       296
      B-PER       0.65      0.49      0.56       438
      I-PER       0.44      0.38      0.41       214
      B-LOC       0.58      0.51      0.54       218
      I-LOC       0.38      0.30      0.34       141
      I-ORG       0.18      0.36      0.24       151
     B-MISC       0.46      0.09      0.15       141
     I-MISC       0.36      0.05      0.09       154

avg / total       0.89      0.83      0.85      9071

F-1 Score (without O):
0.42496194825
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104114 unique words.
4110 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 278
OOV word occurences: in test 559
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663360     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,490
Trainable params: 6,775,490
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 5s 63ms/step - loss: 0.2437 - acc: 0.9126
Epoch 2/27

83/83 [==============================] - 2s 30ms/step - loss: 0.1531 - acc: 0.9520
Epoch 3/27

83/83 [==============================] - 2s 30ms/step - loss: 0.1110 - acc: 0.9633
Epoch 4/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0895 - acc: 0.9734
Epoch 5/27

83/83 [==============================] - 2s 30ms/step - loss: 0.0797 - acc: 0.9765
Epoch 6/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0737 - acc: 0.9768
Epoch 7/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0691 - acc: 0.9776
Epoch 8/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0660 - acc: 0.9782
Epoch 9/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0643 - acc: 0.9775
Epoch 10/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0612 - acc: 0.9784
Epoch 11/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0593 - acc: 0.9786
Epoch 12/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0556 - acc: 0.9790
Epoch 13/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0543 - acc: 0.9794
Epoch 14/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0510 - acc: 0.9803
Epoch 15/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0510 - acc: 0.9799
Epoch 16/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0474 - acc: 0.9814
Epoch 17/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0467 - acc: 0.9812
Epoch 18/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0439 - acc: 0.9824
Epoch 19/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0420 - acc: 0.9834
Epoch 20/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0397 - acc: 0.9849
Epoch 21/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0382 - acc: 0.9851
Epoch 22/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0360 - acc: 0.9856
Epoch 23/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0348 - acc: 0.9870
Epoch 24/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0327 - acc: 0.9882
Epoch 25/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0311 - acc: 0.9888
Epoch 26/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0288 - acc: 0.9898
Epoch 27/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0274 - acc: 0.9905
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7646
False 1425
True percentage 0.842905964061
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.69      0.51      0.59       438
          O       0.96      0.95      0.96      7318
      B-ORG       0.45      0.43      0.44       296
     B-MISC       0.33      0.04      0.06       141
      I-ORG       0.38      0.21      0.27       151
      I-PER       0.62      0.42      0.50       214
     I-MISC       0.26      0.05      0.08       154
      B-LOC       0.62      0.49      0.55       218
      I-LOC       0.39      0.67      0.50       141

avg / total       0.88      0.84      0.85      9071

F-1 Score (without O):
0.882625758116
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104106 unique words.
4102 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 281
OOV word occurences: in test 490
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6662848     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,774,978
Trainable params: 6,774,978
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 5s 63ms/step - loss: 0.3489 - acc: 0.8997
Epoch 2/27

83/83 [==============================] - 2s 29ms/step - loss: 0.2361 - acc: 0.9138
Epoch 3/27

83/83 [==============================] - 3s 30ms/step - loss: 0.1546 - acc: 0.9531
Epoch 4/27

83/83 [==============================] - 3s 30ms/step - loss: 0.1244 - acc: 0.9589
Epoch 5/27

83/83 [==============================] - 2s 30ms/step - loss: 0.1058 - acc: 0.9666
Epoch 6/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0964 - acc: 0.9718
Epoch 7/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0874 - acc: 0.9737
Epoch 8/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0818 - acc: 0.9739
Epoch 9/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0775 - acc: 0.9738
Epoch 10/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0747 - acc: 0.9745
Epoch 11/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0704 - acc: 0.9752
Epoch 12/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0668 - acc: 0.9763
Epoch 13/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0646 - acc: 0.9768
Epoch 14/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0630 - acc: 0.9769
Epoch 15/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0611 - acc: 0.9779
Epoch 16/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0583 - acc: 0.9782
Epoch 17/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0546 - acc: 0.9795
Epoch 18/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0514 - acc: 0.9808
Epoch 19/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0499 - acc: 0.9809
Epoch 20/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0477 - acc: 0.9814
Epoch 21/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0460 - acc: 0.9834
Epoch 22/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0427 - acc: 0.9842
Epoch 23/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0409 - acc: 0.9852
Epoch 24/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0386 - acc: 0.9855
Epoch 25/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0367 - acc: 0.9870
Epoch 26/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0336 - acc: 0.9880
Epoch 27/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0331 - acc: 0.9880
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7642
False 1429
True percentage 0.842464998346
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.95      0.95      7318
      B-PER       0.73      0.54      0.62       438
      B-ORG       0.42      0.32      0.36       296
      I-ORG       0.14      0.08      0.10       151
      B-LOC       0.50      0.60      0.54       218
      I-PER       0.64      0.51      0.57       214
     B-MISC       0.25      0.01      0.03       141
      I-LOC       0.49      0.54      0.52       141
     I-MISC       0.60      0.02      0.04       154

avg / total       0.87      0.84      0.85      9071

F-1 Score (without O):
0.44474212994
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104102 unique words.
4098 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 563
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6662592     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,774,722
Trainable params: 6,774,722
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 5s 65ms/step - loss: 0.3423 - acc: 0.8999
Epoch 2/27

83/83 [==============================] - 3s 30ms/step - loss: 0.2117 - acc: 0.9222
Epoch 3/27

83/83 [==============================] - 2s 30ms/step - loss: 0.1370 - acc: 0.9534
Epoch 4/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1133 - acc: 0.9624
Epoch 5/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0964 - acc: 0.9721
Epoch 6/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0856 - acc: 0.9743
Epoch 7/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0780 - acc: 0.9738
Epoch 8/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0700 - acc: 0.9766
Epoch 9/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0660 - acc: 0.9773
Epoch 10/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0626 - acc: 0.9782
Epoch 11/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0591 - acc: 0.9786
Epoch 12/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0583 - acc: 0.9787
Epoch 13/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0535 - acc: 0.9797
Epoch 14/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0527 - acc: 0.9795
Epoch 15/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0519 - acc: 0.9800
Epoch 16/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0487 - acc: 0.9812
Epoch 17/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0466 - acc: 0.9814
Epoch 18/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0442 - acc: 0.9823
Epoch 19/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0420 - acc: 0.9830
Epoch 20/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0409 - acc: 0.9835
Epoch 21/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0392 - acc: 0.9843
Epoch 22/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0383 - acc: 0.9859
Epoch 23/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0362 - acc: 0.9863
Epoch 24/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0335 - acc: 0.9875
Epoch 25/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0326 - acc: 0.9883
Epoch 26/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0304 - acc: 0.9889
Epoch 27/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0290 - acc: 0.9899
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7447
False 1624
True percentage 0.820967919744
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.93      0.95      7318
      B-PER       0.62      0.35      0.44       438
      I-PER       0.65      0.30      0.41       214
      B-ORG       0.37      0.51      0.43       296
      I-ORG       0.19      0.62      0.29       151
      B-LOC       0.69      0.51      0.59       218
     B-MISC       0.81      0.09      0.17       141
     I-MISC       0.26      0.04      0.07       154
      I-LOC       0.75      0.11      0.19       141

avg / total       0.89      0.82      0.84      9071

F-1 Score (without O):
0.377405338299
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104111 unique words.
4107 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 276
OOV word occurences: in test 477
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663168     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,298
Trainable params: 6,775,298
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 5s 64ms/step - loss: 0.3405 - acc: 0.8993
Epoch 2/27

83/83 [==============================] - 2s 30ms/step - loss: 0.2183 - acc: 0.9134
Epoch 3/27

83/83 [==============================] - 2s 30ms/step - loss: 0.1351 - acc: 0.9616
Epoch 4/27

83/83 [==============================] - 2s 30ms/step - loss: 0.1071 - acc: 0.9654
Epoch 5/27

83/83 [==============================] - 2s 30ms/step - loss: 0.0907 - acc: 0.9714
Epoch 6/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0803 - acc: 0.9765
Epoch 7/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0749 - acc: 0.9765
Epoch 8/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0704 - acc: 0.9765
Epoch 9/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0648 - acc: 0.9770
Epoch 10/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0639 - acc: 0.9773
Epoch 11/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0606 - acc: 0.9779
Epoch 12/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0588 - acc: 0.9777
Epoch 13/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0560 - acc: 0.9787
Epoch 14/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0527 - acc: 0.9789
Epoch 15/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0513 - acc: 0.9794
Epoch 16/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0489 - acc: 0.9796
Epoch 17/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0462 - acc: 0.9817
Epoch 18/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0455 - acc: 0.9818
Epoch 19/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0428 - acc: 0.9832
Epoch 20/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0423 - acc: 0.9832
Epoch 21/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0394 - acc: 0.9843
Epoch 22/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0383 - acc: 0.9850
Epoch 23/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0351 - acc: 0.9865
Epoch 24/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0353 - acc: 0.9868
Epoch 25/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0334 - acc: 0.9874
Epoch 26/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0310 - acc: 0.9884
Epoch 27/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0291 - acc: 0.9892
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7584
False 1487
True percentage 0.83607099548
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.95      0.95      7318
     B-MISC       0.18      0.06      0.09       141
     I-MISC       0.18      0.03      0.05       154
      B-ORG       0.38      0.35      0.36       296
      B-LOC       0.84      0.45      0.59       218
      B-PER       0.70      0.55      0.61       438
      I-PER       0.58      0.49      0.53       214
      I-ORG       0.18      0.25      0.21       151
      I-LOC       0.78      0.20      0.32       141

avg / total       0.86      0.84      0.84      9071

F-1 Score (without O):
0.419073203492
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 8
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104120 unique words.
4116 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 274
OOV word occurences: in test 456
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663744     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,874
Trainable params: 6,775,874
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 5s 64ms/step - loss: 0.2860 - acc: 0.8997
Epoch 2/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1818 - acc: 0.9361
Epoch 3/27

83/83 [==============================] - 3s 31ms/step - loss: 0.1166 - acc: 0.9641
Epoch 4/27

83/83 [==============================] - 3s 30ms/step - loss: 0.1037 - acc: 0.9636
Epoch 5/27

83/83 [==============================] - 2s 30ms/step - loss: 0.0862 - acc: 0.9736
Epoch 6/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0832 - acc: 0.9743
Epoch 7/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0749 - acc: 0.9753
Epoch 8/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0708 - acc: 0.9757
Epoch 9/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0675 - acc: 0.9765
Epoch 10/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0627 - acc: 0.9772
Epoch 11/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0628 - acc: 0.9769
Epoch 12/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0610 - acc: 0.9773
Epoch 13/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0568 - acc: 0.9782
Epoch 14/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0552 - acc: 0.9786
Epoch 15/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0526 - acc: 0.9797
Epoch 16/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0508 - acc: 0.9805
Epoch 17/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0493 - acc: 0.9816
Epoch 18/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0477 - acc: 0.9830
Epoch 19/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0447 - acc: 0.9834
Epoch 20/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0433 - acc: 0.9842
Epoch 21/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0410 - acc: 0.9848
Epoch 22/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0390 - acc: 0.9853
Epoch 23/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0370 - acc: 0.9862
Epoch 24/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0345 - acc: 0.9875
Epoch 25/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0328 - acc: 0.9883
Epoch 26/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0304 - acc: 0.9894
Epoch 27/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0289 - acc: 0.9899
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7706
False 1365
True percentage 0.849520449785
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.96      0.96      7318
     B-MISC       0.55      0.04      0.08       141
      B-ORG       0.45      0.59      0.51       296
      B-PER       0.75      0.54      0.63       438
     I-MISC       0.21      0.08      0.12       154
      I-PER       0.63      0.50      0.56       214
      I-ORG       0.25      0.30      0.27       151
      B-LOC       0.66      0.52      0.58       218
      I-LOC       0.95      0.13      0.22       141

avg / total       0.89      0.85      0.86      9071

F-1 Score (without O):
0.464646464646
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 9
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104109 unique words.
4105 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 276
OOV word occurences: in test 464
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663040     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,170
Trainable params: 6,775,170
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 5s 64ms/step - loss: 0.3126 - acc: 0.9000
Epoch 2/27

83/83 [==============================] - 3s 30ms/step - loss: 0.2151 - acc: 0.9151
Epoch 3/27

83/83 [==============================] - 2s 30ms/step - loss: 0.1371 - acc: 0.9583
Epoch 4/27

83/83 [==============================] - 2s 30ms/step - loss: 0.1056 - acc: 0.9645
Epoch 5/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0856 - acc: 0.9732
Epoch 6/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0794 - acc: 0.9762
Epoch 7/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0703 - acc: 0.9778
Epoch 8/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0682 - acc: 0.9773
Epoch 9/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0652 - acc: 0.9775
Epoch 10/27

83/83 [==============================] - 2s 30ms/step - loss: 0.0624 - acc: 0.9782
Epoch 11/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0608 - acc: 0.9784
Epoch 12/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0566 - acc: 0.9795
Epoch 13/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0553 - acc: 0.9792
Epoch 14/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0543 - acc: 0.9793
Epoch 15/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0508 - acc: 0.9810
Epoch 16/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0491 - acc: 0.9814
Epoch 17/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0475 - acc: 0.9823
Epoch 18/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0441 - acc: 0.9834
Epoch 19/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0431 - acc: 0.9829
Epoch 20/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0422 - acc: 0.9836
Epoch 21/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0385 - acc: 0.9844
Epoch 22/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0364 - acc: 0.9859
Epoch 23/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0342 - acc: 0.9871
Epoch 24/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0322 - acc: 0.9881
Epoch 25/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0310 - acc: 0.9890
Epoch 26/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0288 - acc: 0.9898
Epoch 27/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0274 - acc: 0.9905
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7582
False 1489
True percentage 0.835850512623
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.95      0.95      7318
      B-PER       0.76      0.56      0.64       438
      B-ORG       0.40      0.46      0.43       296
      I-ORG       0.20      0.43      0.27       151
      I-PER       0.56      0.43      0.49       214
      B-LOC       0.78      0.46      0.58       218
      I-LOC       0.83      0.04      0.07       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.10      0.06      0.07       154

avg / total       0.87      0.84      0.85      9071

F-1 Score (without O):
0.415178571429
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 10
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104121 unique words.
4117 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 276
OOV word occurences: in test 465
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663808     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,938
Trainable params: 6,775,938
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 5s 63ms/step - loss: 0.2940 - acc: 0.8999
Epoch 2/27

83/83 [==============================] - 2s 30ms/step - loss: 0.1849 - acc: 0.9319
Epoch 3/27

83/83 [==============================] - 3s 31ms/step - loss: 0.1237 - acc: 0.9626
Epoch 4/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1059 - acc: 0.9643
Epoch 5/27

83/83 [==============================] - 2s 30ms/step - loss: 0.0918 - acc: 0.9721
Epoch 6/27

83/83 [==============================] - 2s 30ms/step - loss: 0.0858 - acc: 0.9732
Epoch 7/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0803 - acc: 0.9737
Epoch 8/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0780 - acc: 0.9735
Epoch 9/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0732 - acc: 0.9748
Epoch 10/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0721 - acc: 0.9747
Epoch 11/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0677 - acc: 0.9758
Epoch 12/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0653 - acc: 0.9766
Epoch 13/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0632 - acc: 0.9768
Epoch 14/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0611 - acc: 0.9773
Epoch 15/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0583 - acc: 0.9781
Epoch 16/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0566 - acc: 0.9786
Epoch 17/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0526 - acc: 0.9796
Epoch 18/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0508 - acc: 0.9808
Epoch 19/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0492 - acc: 0.9808
Epoch 20/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0461 - acc: 0.9819
Epoch 21/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0441 - acc: 0.9826
Epoch 22/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0434 - acc: 0.9835
Epoch 23/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0396 - acc: 0.9850
Epoch 24/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0377 - acc: 0.9858
Epoch 25/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0364 - acc: 0.9859
Epoch 26/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0335 - acc: 0.9880
Epoch 27/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0320 - acc: 0.9881
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7654
False 1417
True percentage 0.843787895491
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.96      0.95      7318
      B-PER       0.73      0.50      0.60       438
      B-ORG       0.44      0.45      0.45       296
      I-ORG       0.15      0.25      0.19       151
     B-MISC       0.67      0.03      0.05       141
     I-MISC       0.27      0.04      0.07       154
      I-PER       0.76      0.42      0.54       214
      B-LOC       0.81      0.50      0.62       218
      I-LOC       0.54      0.35      0.42       141

avg / total       0.88      0.84      0.85      9071

F-1 Score (without O):
0.436302521008
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 11
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104106 unique words.
4102 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 275
OOV word occurences: in test 547
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6662848     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,774,978
Trainable params: 6,774,978
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 5s 63ms/step - loss: 0.3152 - acc: 0.8997
Epoch 2/27

83/83 [==============================] - 2s 30ms/step - loss: 0.2179 - acc: 0.9117
Epoch 3/27

83/83 [==============================] - 3s 30ms/step - loss: 0.1351 - acc: 0.9604
Epoch 4/27

83/83 [==============================] - 2s 30ms/step - loss: 0.1033 - acc: 0.9655
Epoch 5/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0892 - acc: 0.9725
Epoch 6/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0809 - acc: 0.9755
Epoch 7/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0749 - acc: 0.9752
Epoch 8/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0698 - acc: 0.9760
Epoch 9/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0666 - acc: 0.9776
Epoch 10/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0610 - acc: 0.9795
Epoch 11/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0598 - acc: 0.9790
Epoch 12/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0571 - acc: 0.9812
Epoch 13/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0540 - acc: 0.9820
Epoch 14/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0534 - acc: 0.9812
Epoch 15/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0495 - acc: 0.9830
Epoch 16/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0484 - acc: 0.9833
Epoch 17/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0459 - acc: 0.9839
Epoch 18/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0445 - acc: 0.9840
Epoch 19/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0417 - acc: 0.9848
Epoch 20/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0396 - acc: 0.9855
Epoch 21/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0381 - acc: 0.9859
Epoch 22/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0373 - acc: 0.9863
Epoch 23/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0350 - acc: 0.9869
Epoch 24/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0335 - acc: 0.9878
Epoch 25/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0323 - acc: 0.9881
Epoch 26/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0295 - acc: 0.9891
Epoch 27/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0285 - acc: 0.9896
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7419
False 1652
True percentage 0.81788115974
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.34      0.40      0.37       296
          O       0.95      0.95      0.95      7318
     B-MISC       0.28      0.11      0.15       141
     I-MISC       0.00      0.00      0.00       154
      B-PER       0.54      0.36      0.43       438
      I-PER       0.42      0.37      0.40       214
      B-LOC       0.77      0.22      0.35       218
      I-LOC       0.47      0.33      0.39       141
      I-ORG       0.16      0.23      0.19       151

avg / total       0.85      0.82      0.83      9071

F-1 Score (without O):
0.861186460668
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104100 unique words.
4096 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 276
OOV word occurences: in test 528
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6662464     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,774,594
Trainable params: 6,774,594
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 5s 63ms/step - loss: 0.2211 - acc: 0.9178
Epoch 2/27

83/83 [==============================] - 2s 30ms/step - loss: 0.1125 - acc: 0.9705
Epoch 3/27

83/83 [==============================] - 2s 30ms/step - loss: 0.1029 - acc: 0.9680
Epoch 4/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0861 - acc: 0.9722
Epoch 5/27

83/83 [==============================] - 2s 30ms/step - loss: 0.0749 - acc: 0.9766
Epoch 6/27

83/83 [==============================] - 2s 30ms/step - loss: 0.0709 - acc: 0.9767
Epoch 7/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0657 - acc: 0.9778
Epoch 8/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0641 - acc: 0.9777
Epoch 9/27

83/83 [==============================] - 2s 30ms/step - loss: 0.0600 - acc: 0.9791
Epoch 10/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0571 - acc: 0.9803
Epoch 11/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0535 - acc: 0.9808
Epoch 12/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0517 - acc: 0.9810
Epoch 13/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0487 - acc: 0.9811
Epoch 14/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0471 - acc: 0.9815
Epoch 15/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0458 - acc: 0.9821
Epoch 16/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0439 - acc: 0.9823
Epoch 17/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0412 - acc: 0.9844
Epoch 18/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0393 - acc: 0.9855
Epoch 19/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0367 - acc: 0.9862
Epoch 20/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0352 - acc: 0.9871
Epoch 21/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0338 - acc: 0.9872
Epoch 22/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0322 - acc: 0.9881
Epoch 23/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0297 - acc: 0.9896
Epoch 24/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0275 - acc: 0.9901
Epoch 25/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0255 - acc: 0.9919
Epoch 26/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0249 - acc: 0.9914
Epoch 27/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0223 - acc: 0.9923
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7519
False 1552
True percentage 0.828905302613
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.74      0.34      0.46       438
      I-PER       1.00      0.04      0.07       214
          O       0.96      0.95      0.96      7318
      B-ORG       0.43      0.61      0.50       296
      B-LOC       0.79      0.47      0.59       218
      I-ORG       0.17      0.44      0.25       151
      I-LOC       0.44      0.13      0.20       141
     B-MISC       0.38      0.04      0.08       141
     I-MISC       0.29      0.19      0.23       154

avg / total       0.89      0.83      0.84      9071

F-1 Score (without O):
0.868453608247
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104062 unique words.
4058 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660032     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,162
Trainable params: 6,772,162
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 4s 118ms/step - loss: 0.3357 - acc: 0.9000
Epoch 2/27

33/33 [==============================] - 1s 35ms/step - loss: 0.2619 - acc: 0.9020
Epoch 3/27

33/33 [==============================] - 1s 33ms/step - loss: 0.1994 - acc: 0.9214
Epoch 4/27

33/33 [==============================] - 1s 33ms/step - loss: 0.1433 - acc: 0.9544
Epoch 5/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1105 - acc: 0.9643
Epoch 6/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0947 - acc: 0.9677
Epoch 7/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0859 - acc: 0.9697
Epoch 8/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0770 - acc: 0.9717
Epoch 9/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0668 - acc: 0.9755
Epoch 10/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0613 - acc: 0.9806
Epoch 11/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0598 - acc: 0.9815
Epoch 12/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0565 - acc: 0.9823
Epoch 13/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0533 - acc: 0.9816
Epoch 14/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0500 - acc: 0.9821
Epoch 15/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0471 - acc: 0.9818
Epoch 16/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0471 - acc: 0.9816
Epoch 17/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0442 - acc: 0.9833
Epoch 18/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0446 - acc: 0.9839
Epoch 19/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0427 - acc: 0.9839
Epoch 20/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0422 - acc: 0.9845
Epoch 21/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0404 - acc: 0.9846
Epoch 22/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0401 - acc: 0.9849
Epoch 23/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0391 - acc: 0.9847
Epoch 24/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0383 - acc: 0.9854
Epoch 25/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0373 - acc: 0.9855
Epoch 26/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0359 - acc: 0.9864
Epoch 27/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0363 - acc: 0.9861
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7128
False 1943
True percentage 0.78580090398
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.94      0.94      7318
      B-PER       0.45      0.22      0.30       438
      B-ORG       0.20      0.44      0.27       296
      I-ORG       0.15      0.32      0.21       151
      I-PER       0.16      0.03      0.05       214
      B-LOC       0.00      0.00      0.00       218
     B-MISC       0.00      0.00      0.00       141
      I-LOC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.79      0.79      0.78      9071

F-1 Score (without O):
0.188971082717
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104072 unique words.
4068 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 276
OOV word occurences: in test 470
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660672     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,802
Trainable params: 6,772,802
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 4s 118ms/step - loss: 0.3793 - acc: 0.8990
Epoch 2/27

33/33 [==============================] - 1s 35ms/step - loss: 0.3138 - acc: 0.8998
Epoch 3/27

33/33 [==============================] - 1s 34ms/step - loss: 0.2575 - acc: 0.9037
Epoch 4/27

33/33 [==============================] - 1s 35ms/step - loss: 0.2054 - acc: 0.9193
Epoch 5/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1614 - acc: 0.9449
Epoch 6/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1332 - acc: 0.9591
Epoch 7/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1210 - acc: 0.9603
Epoch 8/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1142 - acc: 0.9616
Epoch 9/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1049 - acc: 0.9616
Epoch 10/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0998 - acc: 0.9643
Epoch 11/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0933 - acc: 0.9682
Epoch 12/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0918 - acc: 0.9731
Epoch 13/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0856 - acc: 0.9738
Epoch 14/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0831 - acc: 0.9727
Epoch 15/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0786 - acc: 0.9750
Epoch 16/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0767 - acc: 0.9750
Epoch 17/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0721 - acc: 0.9759
Epoch 18/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0712 - acc: 0.9763
Epoch 19/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0707 - acc: 0.9764
Epoch 20/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0674 - acc: 0.9764
Epoch 21/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0665 - acc: 0.9771
Epoch 22/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0632 - acc: 0.9783
Epoch 23/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0610 - acc: 0.9781
Epoch 24/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0602 - acc: 0.9785
Epoch 25/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0609 - acc: 0.9768
Epoch 26/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0594 - acc: 0.9779
Epoch 27/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0569 - acc: 0.9783
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7323
False 1748
True percentage 0.807297982582
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.90      0.96      0.93      7318
      B-ORG       0.37      0.34      0.35       296
      I-ORG       0.11      0.05      0.07       151
      B-PER       0.42      0.29      0.34       438
      B-LOC       0.87      0.12      0.22       218
      I-LOC       0.40      0.04      0.08       141
      I-PER       0.39      0.14      0.20       214
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.79      0.81      0.79      9071

F-1 Score (without O):
0.235950577919
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104055 unique words.
4051 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 281
OOV word occurences: in test 473
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659584     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,714
Trainable params: 6,771,714
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 5s 143ms/step - loss: 0.2912 - acc: 0.9000
Epoch 2/27

33/33 [==============================] - 1s 34ms/step - loss: 0.2415 - acc: 0.9010
Epoch 3/27

33/33 [==============================] - 1s 33ms/step - loss: 0.1954 - acc: 0.9290
Epoch 4/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1633 - acc: 0.9527
Epoch 5/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1373 - acc: 0.9621
Epoch 6/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1233 - acc: 0.9628
Epoch 7/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1197 - acc: 0.9602
Epoch 8/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1088 - acc: 0.9627
Epoch 9/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0998 - acc: 0.9677
Epoch 10/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0900 - acc: 0.9738
Epoch 11/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0863 - acc: 0.9740
Epoch 12/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0789 - acc: 0.9756
Epoch 13/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0771 - acc: 0.9744
Epoch 14/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0718 - acc: 0.9760
Epoch 15/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0696 - acc: 0.9756
Epoch 16/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0674 - acc: 0.9759
Epoch 17/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0676 - acc: 0.9754
Epoch 18/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0642 - acc: 0.9771
Epoch 19/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0638 - acc: 0.9767
Epoch 20/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0622 - acc: 0.9770
Epoch 21/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0602 - acc: 0.9773
Epoch 22/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0594 - acc: 0.9774
Epoch 23/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0591 - acc: 0.9776
Epoch 24/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0568 - acc: 0.9784
Epoch 25/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0556 - acc: 0.9788
Epoch 26/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0552 - acc: 0.9780
Epoch 27/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0518 - acc: 0.9788
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7356
False 1715
True percentage 0.81093594973
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.94      0.95      7318
      B-PER       0.80      0.25      0.38       438
      B-ORG       0.26      0.48      0.34       296
      I-ORG       0.13      0.10      0.11       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.24      0.14      0.17       154
      I-PER       0.39      0.48      0.43       214
      B-LOC       0.41      0.45      0.43       218
      I-LOC       0.00      0.00      0.00       141

avg / total       0.84      0.81      0.82      9071

F-1 Score (without O):
0.309948979592
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104080 unique words.
4076 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 553
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6661184     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,773,314
Trainable params: 6,773,314
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 4s 117ms/step - loss: 0.3995 - acc: 0.8994
Epoch 2/27

33/33 [==============================] - 1s 34ms/step - loss: 0.3335 - acc: 0.9000
Epoch 3/27

33/33 [==============================] - 1s 34ms/step - loss: 0.2760 - acc: 0.9000
Epoch 4/27

33/33 [==============================] - 1s 34ms/step - loss: 0.2234 - acc: 0.9063
Epoch 5/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1824 - acc: 0.9382
Epoch 6/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1526 - acc: 0.9524
Epoch 7/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1433 - acc: 0.9513
Epoch 8/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1294 - acc: 0.9547
Epoch 9/27

33/33 [==============================] - 1s 33ms/step - loss: 0.1188 - acc: 0.9601
Epoch 10/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1104 - acc: 0.9650
Epoch 11/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1034 - acc: 0.9697
Epoch 12/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0978 - acc: 0.9705
Epoch 13/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0913 - acc: 0.9717
Epoch 14/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0899 - acc: 0.9701
Epoch 15/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0866 - acc: 0.9715
Epoch 16/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0820 - acc: 0.9721
Epoch 17/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0821 - acc: 0.9718
Epoch 18/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0809 - acc: 0.9719
Epoch 19/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0769 - acc: 0.9724
Epoch 20/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0750 - acc: 0.9731
Epoch 21/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0725 - acc: 0.9728
Epoch 22/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0709 - acc: 0.9745
Epoch 23/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0697 - acc: 0.9743
Epoch 24/27

33/33 [==============================] - 1s 32ms/step - loss: 0.0705 - acc: 0.9732
Epoch 25/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0706 - acc: 0.9744
Epoch 26/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0634 - acc: 0.9773
Epoch 27/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0678 - acc: 0.9757
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7140
False 1931
True percentage 0.787123801124
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.93      0.95      7318
      B-ORG       0.23      0.61      0.33       296
      B-PER       0.61      0.11      0.18       438
      I-PER       0.40      0.02      0.04       214
      B-LOC       0.50      0.01      0.03       218
      I-LOC       0.00      0.00      0.00       141
      I-ORG       0.16      0.68      0.25       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.85      0.79      0.79      9071

F-1 Score (without O):
0.204676586699
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104070 unique words.
4066 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 281
OOV word occurences: in test 565
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660544     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,674
Trainable params: 6,772,674
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 4s 119ms/step - loss: 0.3449 - acc: 0.8999
Epoch 2/27

33/33 [==============================] - 1s 34ms/step - loss: 0.2895 - acc: 0.9000
Epoch 3/27

33/33 [==============================] - 1s 34ms/step - loss: 0.2408 - acc: 0.9010
Epoch 4/27

33/33 [==============================] - 1s 33ms/step - loss: 0.1967 - acc: 0.9231
Epoch 5/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1610 - acc: 0.9542
Epoch 6/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1352 - acc: 0.9659
Epoch 7/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1184 - acc: 0.9638
Epoch 8/27

33/33 [==============================] - 1s 33ms/step - loss: 0.1095 - acc: 0.9645
Epoch 9/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1019 - acc: 0.9659
Epoch 10/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0929 - acc: 0.9693
Epoch 11/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0882 - acc: 0.9747
Epoch 12/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0822 - acc: 0.9766
Epoch 13/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0787 - acc: 0.9764
Epoch 14/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0748 - acc: 0.9763
Epoch 15/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0697 - acc: 0.9776
Epoch 16/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0681 - acc: 0.9770
Epoch 17/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0650 - acc: 0.9786
Epoch 18/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0630 - acc: 0.9797
Epoch 19/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0607 - acc: 0.9803
Epoch 20/27

33/33 [==============================] - 1s 32ms/step - loss: 0.0616 - acc: 0.9803
Epoch 21/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0612 - acc: 0.9800
Epoch 22/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0570 - acc: 0.9795
Epoch 23/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0545 - acc: 0.9811
Epoch 24/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0562 - acc: 0.9813
Epoch 25/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0515 - acc: 0.9816
Epoch 26/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0509 - acc: 0.9825
Epoch 27/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0510 - acc: 0.9824
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7271
False 1800
True percentage 0.801565428288
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.58      0.22      0.32       438
          O       0.89      0.96      0.92      7318
      B-ORG       0.33      0.38      0.35       296
     B-MISC       0.00      0.00      0.00       141
      I-ORG       0.24      0.04      0.07       151
      I-PER       0.52      0.22      0.31       214
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.06      0.01      0.01       141

avg / total       0.77      0.80      0.78      9071

F-1 Score (without O):
0.84539241103
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104056 unique words.
4052 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659648     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,778
Trainable params: 6,771,778
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 4s 118ms/step - loss: 0.3295 - acc: 0.9001
Epoch 2/27

33/33 [==============================] - 1s 35ms/step - loss: 0.2578 - acc: 0.9049
Epoch 3/27

33/33 [==============================] - 1s 33ms/step - loss: 0.1987 - acc: 0.9230
Epoch 4/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1473 - acc: 0.9608
Epoch 5/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1150 - acc: 0.9731
Epoch 6/27

33/33 [==============================] - 1s 36ms/step - loss: 0.1093 - acc: 0.9667
Epoch 7/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1039 - acc: 0.9677
Epoch 8/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0975 - acc: 0.9687
Epoch 9/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0878 - acc: 0.9723
Epoch 10/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0815 - acc: 0.9763
Epoch 11/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0775 - acc: 0.9782
Epoch 12/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0802 - acc: 0.9761
Epoch 13/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0754 - acc: 0.9761
Epoch 14/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0731 - acc: 0.9765
Epoch 15/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0686 - acc: 0.9774
Epoch 16/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0644 - acc: 0.9783
Epoch 17/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0614 - acc: 0.9792
Epoch 18/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0633 - acc: 0.9791
Epoch 19/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0614 - acc: 0.9787
Epoch 20/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0594 - acc: 0.9795
Epoch 21/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0584 - acc: 0.9793
Epoch 22/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0571 - acc: 0.9793
Epoch 23/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0573 - acc: 0.9798
Epoch 24/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0553 - acc: 0.9806
Epoch 25/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0522 - acc: 0.9819
Epoch 26/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0515 - acc: 0.9812
Epoch 27/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0488 - acc: 0.9821
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7221
False 1850
True percentage 0.796053356852
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.92      0.95      0.93      7318
      B-PER       0.49      0.33      0.39       438
      B-ORG       0.21      0.43      0.29       296
      I-ORG       0.24      0.15      0.18       151
      B-LOC       0.00      0.00      0.00       218
      I-PER       0.53      0.04      0.08       214
     B-MISC       0.00      0.00      0.00       141
      I-LOC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.79      0.80      0.79      9071

F-1 Score (without O):
0.219397021431
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104055 unique words.
4051 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659584     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,714
Trainable params: 6,771,714
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 4s 118ms/step - loss: 0.2861 - acc: 0.9000
Epoch 2/27

33/33 [==============================] - 1s 34ms/step - loss: 0.2228 - acc: 0.9078
Epoch 3/27

33/33 [==============================] - 1s 33ms/step - loss: 0.1702 - acc: 0.9415
Epoch 4/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1376 - acc: 0.9580
Epoch 5/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1218 - acc: 0.9609
Epoch 6/27

33/33 [==============================] - 1s 33ms/step - loss: 0.1146 - acc: 0.9616
Epoch 7/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1040 - acc: 0.9625
Epoch 8/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0936 - acc: 0.9696
Epoch 9/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0889 - acc: 0.9742
Epoch 10/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0849 - acc: 0.9757
Epoch 11/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0802 - acc: 0.9753
Epoch 12/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0766 - acc: 0.9751
Epoch 13/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0740 - acc: 0.9748
Epoch 14/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0691 - acc: 0.9758
Epoch 15/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0659 - acc: 0.9769
Epoch 16/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0642 - acc: 0.9779
Epoch 17/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0631 - acc: 0.9774
Epoch 18/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0606 - acc: 0.9782
Epoch 19/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0582 - acc: 0.9785
Epoch 20/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0573 - acc: 0.9790
Epoch 21/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0554 - acc: 0.9796
Epoch 22/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0545 - acc: 0.9794
Epoch 23/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0520 - acc: 0.9804
Epoch 24/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0518 - acc: 0.9814
Epoch 25/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0507 - acc: 0.9804
Epoch 26/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0506 - acc: 0.9809
Epoch 27/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0476 - acc: 0.9815
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7226
False 1845
True percentage 0.796604563995
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.94      0.94      7318
      B-PER       0.42      0.25      0.31       438
      I-PER       0.39      0.33      0.36       214
      B-ORG       0.26      0.47      0.33       296
      I-ORG       0.12      0.13      0.13       151
      B-LOC       0.86      0.03      0.05       218
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      I-LOC       0.00      0.00      0.00       141

avg / total       0.82      0.80      0.79      9071

F-1 Score (without O):
0.236996210816
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104061 unique words.
4057 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 279
OOV word occurences: in test 482
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659968     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,098
Trainable params: 6,772,098
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 4s 136ms/step - loss: 0.3299 - acc: 0.8991
Epoch 2/27

33/33 [==============================] - 1s 35ms/step - loss: 0.2671 - acc: 0.9093
Epoch 3/27

33/33 [==============================] - 1s 35ms/step - loss: 0.2160 - acc: 0.9154
Epoch 4/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1708 - acc: 0.9421
Epoch 5/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1391 - acc: 0.9640
Epoch 6/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1207 - acc: 0.9624
Epoch 7/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1217 - acc: 0.9601
Epoch 8/27

33/33 [==============================] - 1s 33ms/step - loss: 0.1084 - acc: 0.9625
Epoch 9/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0951 - acc: 0.9673
Epoch 10/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0869 - acc: 0.9723
Epoch 11/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0880 - acc: 0.9725
Epoch 12/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0869 - acc: 0.9730
Epoch 13/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0844 - acc: 0.9735
Epoch 14/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0800 - acc: 0.9743
Epoch 15/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0783 - acc: 0.9737
Epoch 16/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0714 - acc: 0.9760
Epoch 17/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0700 - acc: 0.9758
Epoch 18/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0680 - acc: 0.9757
Epoch 19/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0677 - acc: 0.9758
Epoch 20/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0668 - acc: 0.9756
Epoch 21/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0650 - acc: 0.9764
Epoch 22/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0638 - acc: 0.9766
Epoch 23/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0621 - acc: 0.9773
Epoch 24/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0604 - acc: 0.9782
Epoch 25/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0607 - acc: 0.9763
Epoch 26/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0591 - acc: 0.9775
Epoch 27/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0556 - acc: 0.9784
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7388
False 1683
True percentage 0.814463675449
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.95      0.94      7318
     B-MISC       0.23      0.04      0.07       141
     I-MISC       0.60      0.02      0.04       154
      B-ORG       0.31      0.40      0.35       296
      B-LOC       0.86      0.25      0.39       218
      B-PER       0.59      0.45      0.51       438
      I-PER       0.61      0.07      0.12       214
      I-ORG       0.17      0.38      0.23       151
      I-LOC       0.00      0.00      0.00       141

avg / total       0.85      0.81      0.81      9071

F-1 Score (without O):
0.308423913043
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 8
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104062 unique words.
4058 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 281
OOV word occurences: in test 479
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660032     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,162
Trainable params: 6,772,162
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 4s 117ms/step - loss: 0.3741 - acc: 0.8999
Epoch 2/27

33/33 [==============================] - 1s 35ms/step - loss: 0.3169 - acc: 0.9000
Epoch 3/27

33/33 [==============================] - 1s 34ms/step - loss: 0.2543 - acc: 0.9008
Epoch 4/27

33/33 [==============================] - 1s 35ms/step - loss: 0.2025 - acc: 0.9184
Epoch 5/27

33/33 [==============================] - 1s 36ms/step - loss: 0.1555 - acc: 0.9549
Epoch 6/27

33/33 [==============================] - 1s 33ms/step - loss: 0.1288 - acc: 0.9587
Epoch 7/27

33/33 [==============================] - 1s 33ms/step - loss: 0.1287 - acc: 0.9571
Epoch 8/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1173 - acc: 0.9577
Epoch 9/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1009 - acc: 0.9641
Epoch 10/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0929 - acc: 0.9689
Epoch 11/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0893 - acc: 0.9720
Epoch 12/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0867 - acc: 0.9724
Epoch 13/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0813 - acc: 0.9745
Epoch 14/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0787 - acc: 0.9742
Epoch 15/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0779 - acc: 0.9739
Epoch 16/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0739 - acc: 0.9739
Epoch 17/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0695 - acc: 0.9757
Epoch 18/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0684 - acc: 0.9760
Epoch 19/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0655 - acc: 0.9769
Epoch 20/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0619 - acc: 0.9775
Epoch 21/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0627 - acc: 0.9767
Epoch 22/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0615 - acc: 0.9767
Epoch 23/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0578 - acc: 0.9778
Epoch 24/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0577 - acc: 0.9779
Epoch 25/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0558 - acc: 0.9791
Epoch 26/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0547 - acc: 0.9793
Epoch 27/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0521 - acc: 0.9795
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7347
False 1724
True percentage 0.809943776871
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.95      0.95      7318
     B-MISC       0.75      0.02      0.04       141
      B-ORG       0.28      0.50      0.36       296
      B-PER       0.64      0.31      0.42       438
     I-MISC       0.00      0.00      0.00       154
      I-PER       0.45      0.09      0.15       214
      I-ORG       0.17      0.46      0.25       151
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141

avg / total       0.83      0.81      0.80      9071

F-1 Score (without O):
0.253731343284
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 9
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104061 unique words.
4057 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 486
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659968     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,098
Trainable params: 6,772,098
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 4s 119ms/step - loss: 0.3180 - acc: 0.9000
Epoch 2/27

33/33 [==============================] - 1s 35ms/step - loss: 0.2513 - acc: 0.9007
Epoch 3/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1916 - acc: 0.9268
Epoch 4/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1476 - acc: 0.9563
Epoch 5/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1267 - acc: 0.9619
Epoch 6/27

33/33 [==============================] - 1s 33ms/step - loss: 0.1205 - acc: 0.9636
Epoch 7/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1107 - acc: 0.9652
Epoch 8/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1010 - acc: 0.9675
Epoch 9/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0920 - acc: 0.9728
Epoch 10/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0870 - acc: 0.9762
Epoch 11/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0860 - acc: 0.9753
Epoch 12/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0856 - acc: 0.9749
Epoch 13/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0792 - acc: 0.9755
Epoch 14/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0746 - acc: 0.9764
Epoch 15/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0713 - acc: 0.9771
Epoch 16/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0690 - acc: 0.9774
Epoch 17/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0664 - acc: 0.9777
Epoch 18/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0662 - acc: 0.9776
Epoch 19/27

33/33 [==============================] - 1s 32ms/step - loss: 0.0665 - acc: 0.9779
Epoch 20/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0643 - acc: 0.9789
Epoch 21/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0630 - acc: 0.9786
Epoch 22/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0592 - acc: 0.9795
Epoch 23/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0583 - acc: 0.9794
Epoch 24/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0588 - acc: 0.9787
Epoch 25/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0568 - acc: 0.9793
Epoch 26/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0566 - acc: 0.9796
Epoch 27/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0555 - acc: 0.9792
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7261
False 1810
True percentage 0.800463014001
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.94      0.94      7318
      B-PER       0.42      0.34      0.37       438
      B-ORG       0.21      0.44      0.28       296
      I-ORG       0.20      0.15      0.17       151
      I-PER       0.57      0.36      0.44       214
      B-LOC       0.50      0.00      0.01       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.81      0.80      0.80      9071

F-1 Score (without O):
0.253096752595
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 10
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104070 unique words.
4066 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 278
OOV word occurences: in test 467
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660544     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,674
Trainable params: 6,772,674
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 4s 117ms/step - loss: 0.3323 - acc: 0.9000
Epoch 2/27

33/33 [==============================] - 1s 34ms/step - loss: 0.2745 - acc: 0.9001
Epoch 3/27

33/33 [==============================] - 1s 34ms/step - loss: 0.2248 - acc: 0.9067
Epoch 4/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1812 - acc: 0.9423
Epoch 5/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1503 - acc: 0.9585
Epoch 6/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1334 - acc: 0.9607
Epoch 7/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1275 - acc: 0.9578
Epoch 8/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1173 - acc: 0.9612
Epoch 9/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1063 - acc: 0.9644
Epoch 10/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1001 - acc: 0.9688
Epoch 11/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0952 - acc: 0.9690
Epoch 12/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0929 - acc: 0.9695
Epoch 13/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0890 - acc: 0.9695
Epoch 14/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0813 - acc: 0.9728
Epoch 15/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0823 - acc: 0.9703
Epoch 16/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0772 - acc: 0.9721
Epoch 17/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0797 - acc: 0.9716
Epoch 18/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0767 - acc: 0.9716
Epoch 19/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0723 - acc: 0.9729
Epoch 20/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0703 - acc: 0.9723
Epoch 21/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0693 - acc: 0.9741
Epoch 22/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0690 - acc: 0.9740
Epoch 23/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0644 - acc: 0.9750
Epoch 24/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0640 - acc: 0.9756
Epoch 25/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0618 - acc: 0.9769
Epoch 26/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0600 - acc: 0.9765
Epoch 27/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0586 - acc: 0.9773
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7338
False 1733
True percentage 0.808951604013
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.95      0.94      7318
      B-PER       0.56      0.25      0.35       438
      B-ORG       0.30      0.42      0.35       296
      I-ORG       0.17      0.44      0.24       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      I-PER       0.69      0.14      0.24       214
      B-LOC       1.00      0.11      0.21       218
      I-LOC       0.22      0.04      0.06       141

avg / total       0.83      0.81      0.80      9071

F-1 Score (without O):
0.254571026723
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 11
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104052 unique words.
4048 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 567
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659392     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,522
Trainable params: 6,771,522
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 4s 120ms/step - loss: 0.3081 - acc: 0.8994
Epoch 2/27

33/33 [==============================] - 1s 35ms/step - loss: 0.2387 - acc: 0.9074
Epoch 3/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1815 - acc: 0.9391
Epoch 4/27

33/33 [==============================] - 1s 36ms/step - loss: 0.1394 - acc: 0.9566
Epoch 5/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1216 - acc: 0.9569
Epoch 6/27

33/33 [==============================] - 1s 36ms/step - loss: 0.1057 - acc: 0.9654
Epoch 7/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0958 - acc: 0.9685
Epoch 8/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0882 - acc: 0.9717
Epoch 9/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0806 - acc: 0.9750
Epoch 10/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0754 - acc: 0.9775
Epoch 11/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0702 - acc: 0.9784
Epoch 12/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0682 - acc: 0.9775
Epoch 13/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0665 - acc: 0.9781
Epoch 14/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0644 - acc: 0.9786
Epoch 15/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0608 - acc: 0.9798
Epoch 16/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0582 - acc: 0.9805
Epoch 17/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0571 - acc: 0.9805
Epoch 18/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0560 - acc: 0.9807
Epoch 19/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0535 - acc: 0.9818
Epoch 20/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0529 - acc: 0.9823
Epoch 21/27

33/33 [==============================] - 1s 32ms/step - loss: 0.0537 - acc: 0.9815
Epoch 22/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0513 - acc: 0.9827
Epoch 23/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0494 - acc: 0.9830
Epoch 24/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0497 - acc: 0.9832
Epoch 25/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0481 - acc: 0.9835
Epoch 26/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0513 - acc: 0.9828
Epoch 27/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0457 - acc: 0.9833
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7142
False 1929
True percentage 0.787344283982
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.20      0.50      0.29       296
          O       0.93      0.94      0.94      7318
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-PER       0.35      0.13      0.19       438
      I-PER       1.00      0.01      0.02       214
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
      I-ORG       0.13      0.16      0.14       151

avg / total       0.80      0.79      0.78      9071

F-1 Score (without O):
0.845791001451
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104061 unique words.
4057 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 281
OOV word occurences: in test 534
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659968     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,098
Trainable params: 6,772,098
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 4s 118ms/step - loss: 0.3556 - acc: 0.8991
Epoch 2/27

33/33 [==============================] - 1s 35ms/step - loss: 0.2905 - acc: 0.9000
Epoch 3/27

33/33 [==============================] - 1s 34ms/step - loss: 0.2356 - acc: 0.9041
Epoch 4/27

33/33 [==============================] - 1s 33ms/step - loss: 0.1884 - acc: 0.9253
Epoch 5/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1500 - acc: 0.9512
Epoch 6/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1268 - acc: 0.9606
Epoch 7/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1150 - acc: 0.9630
Epoch 8/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1113 - acc: 0.9623
Epoch 9/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0975 - acc: 0.9669
Epoch 10/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0936 - acc: 0.9709
Epoch 11/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0905 - acc: 0.9746
Epoch 12/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0853 - acc: 0.9734
Epoch 13/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0823 - acc: 0.9742
Epoch 14/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0772 - acc: 0.9750
Epoch 15/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0750 - acc: 0.9749
Epoch 16/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0730 - acc: 0.9753
Epoch 17/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0705 - acc: 0.9763
Epoch 18/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0692 - acc: 0.9764
Epoch 19/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0670 - acc: 0.9762
Epoch 20/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0650 - acc: 0.9770
Epoch 21/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0644 - acc: 0.9777
Epoch 22/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0619 - acc: 0.9779
Epoch 23/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0595 - acc: 0.9782
Epoch 24/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0590 - acc: 0.9792
Epoch 25/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0564 - acc: 0.9799
Epoch 26/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0572 - acc: 0.9787
Epoch 27/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0552 - acc: 0.9801
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7208
False 1863
True percentage 0.794620218278
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.87      0.10      0.18       438
      I-PER       0.00      0.00      0.00       214
          O       0.94      0.95      0.95      7318
      B-ORG       0.25      0.53      0.34       296
      B-LOC       0.31      0.04      0.07       218
      I-ORG       0.13      0.42      0.20       151
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.82      0.79      0.79      9071

F-1 Score (without O):
0.836896833742
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 7 unique labels.
Found 104050 unique words.
4046 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659264     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 8)        1112        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,096
Trainable params: 6,771,096
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 3s 199ms/step - loss: 0.5031 - acc: 0.8750
Epoch 2/27

16/16 [==============================] - 0s 30ms/step - loss: 0.4807 - acc: 0.8750
Epoch 3/27

16/16 [==============================] - 0s 29ms/step - loss: 0.4538 - acc: 0.8750
Epoch 4/27

16/16 [==============================] - 0s 26ms/step - loss: 0.4246 - acc: 0.8750
Epoch 5/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3932 - acc: 0.8750
Epoch 6/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3610 - acc: 0.8750
Epoch 7/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3355 - acc: 0.8750
Epoch 8/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3008 - acc: 0.8754
Epoch 9/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2660 - acc: 0.8785
Epoch 10/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2449 - acc: 0.8876
Epoch 11/27

16/16 [==============================] - 0s 29ms/step - loss: 0.2179 - acc: 0.9084
Epoch 12/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1913 - acc: 0.9350
Epoch 13/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1639 - acc: 0.9526
Epoch 14/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1524 - acc: 0.9565
Epoch 15/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1363 - acc: 0.9561
Epoch 16/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1299 - acc: 0.9558
Epoch 17/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1188 - acc: 0.9568
Epoch 18/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1133 - acc: 0.9575
Epoch 19/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1111 - acc: 0.9572
Epoch 20/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1097 - acc: 0.9575
Epoch 21/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1033 - acc: 0.9579
Epoch 22/27

16/16 [==============================] - 0s 27ms/step - loss: 0.0983 - acc: 0.9586
Epoch 23/27

16/16 [==============================] - 0s 27ms/step - loss: 0.0951 - acc: 0.9610
Epoch 24/27

16/16 [==============================] - 0s 27ms/step - loss: 0.0865 - acc: 0.9659
Epoch 25/27

16/16 [==============================] - 0s 26ms/step - loss: 0.0829 - acc: 0.9677
Epoch 26/27

16/16 [==============================] - 0s 26ms/step - loss: 0.0819 - acc: 0.9733
Epoch 27/27

16/16 [==============================] - 0s 28ms/step - loss: 0.0758 - acc: 0.9744
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7019
False 1757
True percentage 0.799794895169
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.91      0.94      0.92      7318
      B-PER       0.00      0.00      0.00       438
      B-ORG       0.16      0.49      0.24       296
      I-ORG       0.00      0.00      0.00       151
      I-PER       0.00      0.00      0.00       214
      B-LOC       0.00      0.00      0.00       218
     B-MISC       0.00      0.00      0.00       141

avg / total       0.76      0.80      0.78      8776

F-1 Score (without O):
0.122569737954
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 8 unique labels.
Found 104056 unique words.
4052 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 281
OOV word occurences: in test 556
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659648     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,628
Trainable params: 6,771,628
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 4s 237ms/step - loss: 0.3919 - acc: 0.8889
Epoch 2/27

16/16 [==============================] - 0s 30ms/step - loss: 0.3764 - acc: 0.8889
Epoch 3/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3586 - acc: 0.8889
Epoch 4/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3398 - acc: 0.8889
Epoch 5/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3147 - acc: 0.8889
Epoch 6/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3012 - acc: 0.8899
Epoch 7/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2807 - acc: 0.8961
Epoch 8/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2672 - acc: 0.8978
Epoch 9/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2491 - acc: 0.9040
Epoch 10/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2352 - acc: 0.9136
Epoch 11/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2231 - acc: 0.9163
Epoch 12/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2104 - acc: 0.9266
Epoch 13/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2007 - acc: 0.9311
Epoch 14/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1891 - acc: 0.9396
Epoch 15/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1820 - acc: 0.9482
Epoch 16/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1739 - acc: 0.9520
Epoch 17/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1686 - acc: 0.9540
Epoch 18/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1581 - acc: 0.9592
Epoch 19/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1556 - acc: 0.9561
Epoch 20/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1456 - acc: 0.9595
Epoch 21/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1409 - acc: 0.9578
Epoch 22/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1339 - acc: 0.9558
Epoch 23/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1307 - acc: 0.9561
Epoch 24/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1263 - acc: 0.9578
Epoch 25/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1212 - acc: 0.9564
Epoch 26/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1169 - acc: 0.9595
Epoch 27/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1144 - acc: 0.9578
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7099
False 1818
True percentage 0.796119771224
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.83      0.97      0.90      7318
      B-ORG       0.00      0.00      0.00       296
      I-ORG       0.00      0.00      0.00       151
      B-PER       0.00      0.00      0.00       438
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
      I-PER       0.00      0.00      0.00       214
     B-MISC       0.00      0.00      0.00       141

avg / total       0.68      0.80      0.74      8917

F-1 Score (without O):
0.0
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104039 unique words.
4035 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658560     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,690
Trainable params: 6,770,690
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 3s 202ms/step - loss: 0.4409 - acc: 0.9000
Epoch 2/27

16/16 [==============================] - 0s 29ms/step - loss: 0.4196 - acc: 0.9000
Epoch 3/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3937 - acc: 0.9000
Epoch 4/27

16/16 [==============================] - 0s 26ms/step - loss: 0.3728 - acc: 0.9000
Epoch 5/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3517 - acc: 0.9000
Epoch 6/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3314 - acc: 0.9000
Epoch 7/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3114 - acc: 0.9000
Epoch 8/27

16/16 [==============================] - 0s 29ms/step - loss: 0.2912 - acc: 0.9000
Epoch 9/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2727 - acc: 0.9000
Epoch 10/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2576 - acc: 0.9006
Epoch 11/27

16/16 [==============================] - 0s 29ms/step - loss: 0.2409 - acc: 0.9009
Epoch 12/27

16/16 [==============================] - 0s 29ms/step - loss: 0.2212 - acc: 0.9035
Epoch 13/27

16/16 [==============================] - 0s 30ms/step - loss: 0.2065 - acc: 0.9076
Epoch 14/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1899 - acc: 0.9165
Epoch 15/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1727 - acc: 0.9329
Epoch 16/27

16/16 [==============================] - 0s 26ms/step - loss: 0.1578 - acc: 0.9491
Epoch 17/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1423 - acc: 0.9612
Epoch 18/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1268 - acc: 0.9735
Epoch 19/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1144 - acc: 0.9750
Epoch 20/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1080 - acc: 0.9747
Epoch 21/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1000 - acc: 0.9724
Epoch 22/27

16/16 [==============================] - 0s 27ms/step - loss: 0.0954 - acc: 0.9700
Epoch 23/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1004 - acc: 0.9697
Epoch 24/27

16/16 [==============================] - 0s 28ms/step - loss: 0.0974 - acc: 0.9685
Epoch 25/27

16/16 [==============================] - 0s 29ms/step - loss: 0.0931 - acc: 0.9700
Epoch 26/27

16/16 [==============================] - 0s 28ms/step - loss: 0.0952 - acc: 0.9682
Epoch 27/27

16/16 [==============================] - 0s 26ms/step - loss: 0.0890 - acc: 0.9703
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7119
False 1952
True percentage 0.784808731121
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.84      0.97      0.90      7318
      B-PER       0.00      0.00      0.00       438
      B-ORG       0.72      0.09      0.16       296
      I-ORG       1.00      0.01      0.01       151
     B-MISC       0.15      0.06      0.08       141
     I-MISC       0.00      0.00      0.00       154
      I-PER       0.14      0.00      0.01       214
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141

avg / total       0.73      0.78      0.73      9071

F-1 Score (without O):
0.0388768898488
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104053 unique words.
4049 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 567
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659456     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,586
Trainable params: 6,771,586
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 3s 199ms/step - loss: 0.3656 - acc: 0.8998
Epoch 2/27

16/16 [==============================] - 0s 29ms/step - loss: 0.3400 - acc: 0.9000
Epoch 3/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3191 - acc: 0.9000
Epoch 4/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3009 - acc: 0.9000
Epoch 5/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2760 - acc: 0.9005
Epoch 6/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2549 - acc: 0.9012
Epoch 7/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2378 - acc: 0.9024
Epoch 8/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2165 - acc: 0.9100
Epoch 9/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1967 - acc: 0.9219
Epoch 10/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1790 - acc: 0.9371
Epoch 11/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1656 - acc: 0.9494
Epoch 12/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1477 - acc: 0.9599
Epoch 13/27

16/16 [==============================] - 0s 26ms/step - loss: 0.1423 - acc: 0.9589
Epoch 14/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1310 - acc: 0.9648
Epoch 15/27

16/16 [==============================] - 0s 31ms/step - loss: 0.1247 - acc: 0.9615
Epoch 16/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1223 - acc: 0.9608
Epoch 17/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1176 - acc: 0.9596
Epoch 18/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1130 - acc: 0.9618
Epoch 19/27

16/16 [==============================] - 0s 26ms/step - loss: 0.1097 - acc: 0.9620
Epoch 20/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1044 - acc: 0.9634
Epoch 21/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1007 - acc: 0.9667
Epoch 22/27

16/16 [==============================] - 0s 28ms/step - loss: 0.0973 - acc: 0.9670
Epoch 23/27

16/16 [==============================] - 0s 27ms/step - loss: 0.0917 - acc: 0.9701
Epoch 24/27

16/16 [==============================] - 0s 26ms/step - loss: 0.0913 - acc: 0.9696
Epoch 25/27

16/16 [==============================] - 0s 27ms/step - loss: 0.0887 - acc: 0.9729
Epoch 26/27

16/16 [==============================] - 0s 28ms/step - loss: 0.0870 - acc: 0.9724
Epoch 27/27

16/16 [==============================] - 0s 28ms/step - loss: 0.0845 - acc: 0.9753
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 6983
False 2088
True percentage 0.769815896814
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.92      0.94      7318
      B-ORG       0.16      0.64      0.25       296
      B-PER       0.00      0.00      0.00       438
      I-PER       0.00      0.00      0.00       214
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
      I-ORG       0.15      0.25      0.18       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.78      0.77      0.77      9071

F-1 Score (without O):
0.141287284144
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104049 unique words.
4045 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 567
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659200     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,330
Trainable params: 6,771,330
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 3s 199ms/step - loss: 0.3916 - acc: 0.9000
Epoch 2/27

16/16 [==============================] - 0s 30ms/step - loss: 0.3708 - acc: 0.9000
Epoch 3/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3499 - acc: 0.9000
Epoch 4/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3269 - acc: 0.9000
Epoch 5/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3091 - acc: 0.9000
Epoch 6/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2898 - acc: 0.9006
Epoch 7/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2727 - acc: 0.9020
Epoch 8/27

16/16 [==============================] - 0s 26ms/step - loss: 0.2555 - acc: 0.9052
Epoch 9/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2377 - acc: 0.9072
Epoch 10/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2234 - acc: 0.9086
Epoch 11/27

16/16 [==============================] - 0s 29ms/step - loss: 0.2084 - acc: 0.9126
Epoch 12/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1914 - acc: 0.9170
Epoch 13/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1740 - acc: 0.9250
Epoch 14/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1596 - acc: 0.9385
Epoch 15/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1533 - acc: 0.9414
Epoch 16/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1358 - acc: 0.9563
Epoch 17/27

16/16 [==============================] - 0s 26ms/step - loss: 0.1238 - acc: 0.9658
Epoch 18/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1138 - acc: 0.9701
Epoch 19/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1023 - acc: 0.9727
Epoch 20/27

16/16 [==============================] - 0s 27ms/step - loss: 0.0967 - acc: 0.9733
Epoch 21/27

16/16 [==============================] - 0s 29ms/step - loss: 0.0915 - acc: 0.9718
Epoch 22/27

16/16 [==============================] - 0s 28ms/step - loss: 0.0943 - acc: 0.9716
Epoch 23/27

16/16 [==============================] - 0s 26ms/step - loss: 0.0935 - acc: 0.9721
Epoch 24/27

16/16 [==============================] - 0s 27ms/step - loss: 0.0861 - acc: 0.9716
Epoch 25/27

16/16 [==============================] - 0s 27ms/step - loss: 0.0843 - acc: 0.9710
Epoch 26/27

16/16 [==============================] - 0s 27ms/step - loss: 0.0802 - acc: 0.9721
Epoch 27/27

16/16 [==============================] - 0s 29ms/step - loss: 0.0765 - acc: 0.9730
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7090
False 1981
True percentage 0.781611729688
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.00      0.00      0.00       438
          O       0.83      0.97      0.90      7318
      B-ORG       0.00      0.00      0.00       296
     B-MISC       0.00      0.00      0.00       141
      I-ORG       0.00      0.00      0.00       151
      I-PER       0.00      0.00      0.00       214
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141

avg / total       0.67      0.78      0.72      9071

F-1 Score (without O):
0.827449378538
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104040 unique words.
4036 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658624     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,754
Trainable params: 6,770,754
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 4s 236ms/step - loss: 0.3872 - acc: 0.8921
Epoch 2/27

16/16 [==============================] - 0s 29ms/step - loss: 0.3662 - acc: 0.8953
Epoch 3/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3321 - acc: 0.8987
Epoch 4/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3106 - acc: 0.9000
Epoch 5/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2862 - acc: 0.8997
Epoch 6/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2624 - acc: 0.9031
Epoch 7/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2323 - acc: 0.9126
Epoch 8/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2146 - acc: 0.9289
Epoch 9/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1909 - acc: 0.9409
Epoch 10/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1710 - acc: 0.9487
Epoch 11/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1549 - acc: 0.9519
Epoch 12/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1403 - acc: 0.9553
Epoch 13/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1248 - acc: 0.9607
Epoch 14/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1184 - acc: 0.9610
Epoch 15/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1158 - acc: 0.9629
Epoch 16/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1188 - acc: 0.9648
Epoch 17/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1106 - acc: 0.9651
Epoch 18/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1133 - acc: 0.9642
Epoch 19/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1037 - acc: 0.9664
Epoch 20/27

16/16 [==============================] - 0s 29ms/step - loss: 0.0957 - acc: 0.9686
Epoch 21/27

16/16 [==============================] - 0s 27ms/step - loss: 0.0940 - acc: 0.9686
Epoch 22/27

16/16 [==============================] - 0s 27ms/step - loss: 0.0872 - acc: 0.9708
Epoch 23/27

16/16 [==============================] - 0s 28ms/step - loss: 0.0819 - acc: 0.9748
Epoch 24/27

16/16 [==============================] - 0s 28ms/step - loss: 0.0812 - acc: 0.9752
Epoch 25/27

16/16 [==============================] - 0s 28ms/step - loss: 0.0789 - acc: 0.9755
Epoch 26/27

16/16 [==============================] - 0s 27ms/step - loss: 0.0752 - acc: 0.9767
Epoch 27/27

16/16 [==============================] - 0s 27ms/step - loss: 0.0742 - acc: 0.9783
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7041
False 2030
True percentage 0.77620989968
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.91      0.94      0.93      7318
      B-PER       1.00      0.00      0.00       438
      B-ORG       0.16      0.47      0.24       296
      I-ORG       0.06      0.03      0.04       151
      B-LOC       0.00      0.00      0.00       218
      I-PER       0.00      0.00      0.00       214
     B-MISC       0.00      0.00      0.00       141
      I-LOC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.79      0.78      0.76      9071

F-1 Score (without O):
0.106785317019
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104041 unique words.
4037 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658688     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,818
Trainable params: 6,770,818
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 3s 198ms/step - loss: 0.3559 - acc: 0.9000
Epoch 2/27

16/16 [==============================] - 0s 30ms/step - loss: 0.3379 - acc: 0.9000
Epoch 3/27

16/16 [==============================] - 0s 29ms/step - loss: 0.3169 - acc: 0.9000
Epoch 4/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2934 - acc: 0.9000
Epoch 5/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2769 - acc: 0.9000
Epoch 6/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2545 - acc: 0.9006
Epoch 7/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2371 - acc: 0.9022
Epoch 8/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2153 - acc: 0.9098
Epoch 9/27

16/16 [==============================] - 0s 31ms/step - loss: 0.2024 - acc: 0.9148
Epoch 10/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1848 - acc: 0.9322
Epoch 11/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1725 - acc: 0.9476
Epoch 12/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1552 - acc: 0.9628
Epoch 13/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1458 - acc: 0.9628
Epoch 14/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1381 - acc: 0.9625
Epoch 15/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1318 - acc: 0.9593
Epoch 16/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1251 - acc: 0.9587
Epoch 17/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1229 - acc: 0.9568
Epoch 18/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1177 - acc: 0.9584
Epoch 19/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1153 - acc: 0.9590
Epoch 20/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1127 - acc: 0.9587
Epoch 21/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1123 - acc: 0.9596
Epoch 22/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1072 - acc: 0.9599
Epoch 23/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1006 - acc: 0.9621
Epoch 24/27

16/16 [==============================] - 0s 27ms/step - loss: 0.0976 - acc: 0.9656
Epoch 25/27

16/16 [==============================] - 0s 26ms/step - loss: 0.0917 - acc: 0.9691
Epoch 26/27

16/16 [==============================] - 0s 28ms/step - loss: 0.0917 - acc: 0.9691
Epoch 27/27

16/16 [==============================] - 0s 28ms/step - loss: 0.0874 - acc: 0.9738
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7067
False 2004
True percentage 0.779076176827
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.88      0.95      0.91      7318
      B-PER       0.20      0.11      0.14       438
      I-PER       0.00      0.00      0.00       214
      B-ORG       0.00      0.00      0.00       296
      I-ORG       0.13      0.17      0.15       151
      B-LOC       0.09      0.04      0.06       218
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      I-LOC       0.00      0.00      0.00       141

avg / total       0.72      0.78      0.75      9071

F-1 Score (without O):
0.0740095777101
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104050 unique words.
4046 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 281
OOV word occurences: in test 492
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659264     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,394
Trainable params: 6,771,394
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 3s 199ms/step - loss: 0.4016 - acc: 0.8959
Epoch 2/27

16/16 [==============================] - 0s 29ms/step - loss: 0.3800 - acc: 0.8970
Epoch 3/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3517 - acc: 0.8981
Epoch 4/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3268 - acc: 0.8995
Epoch 5/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3054 - acc: 0.9003
Epoch 6/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2850 - acc: 0.9022
Epoch 7/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2665 - acc: 0.9041
Epoch 8/27

16/16 [==============================] - 0s 26ms/step - loss: 0.2451 - acc: 0.9090
Epoch 9/27

16/16 [==============================] - 0s 26ms/step - loss: 0.2247 - acc: 0.9148
Epoch 10/27

16/16 [==============================] - 0s 26ms/step - loss: 0.2065 - acc: 0.9184
Epoch 11/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1864 - acc: 0.9285
Epoch 12/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1688 - acc: 0.9375
Epoch 13/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1553 - acc: 0.9521
Epoch 14/27

16/16 [==============================] - 0s 26ms/step - loss: 0.1379 - acc: 0.9649
Epoch 15/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1297 - acc: 0.9679
Epoch 16/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1198 - acc: 0.9677
Epoch 17/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1158 - acc: 0.9644
Epoch 18/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1129 - acc: 0.9655
Epoch 19/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1113 - acc: 0.9630
Epoch 20/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1107 - acc: 0.9641
Epoch 21/27

16/16 [==============================] - 0s 26ms/step - loss: 0.1106 - acc: 0.9625
Epoch 22/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1046 - acc: 0.9644
Epoch 23/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1011 - acc: 0.9668
Epoch 24/27

16/16 [==============================] - 0s 28ms/step - loss: 0.0926 - acc: 0.9677
Epoch 25/27

16/16 [==============================] - 0s 27ms/step - loss: 0.0856 - acc: 0.9729
Epoch 26/27

16/16 [==============================] - 0s 26ms/step - loss: 0.0859 - acc: 0.9726
Epoch 27/27

16/16 [==============================] - 0s 27ms/step - loss: 0.0807 - acc: 0.9770
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7039
False 2032
True percentage 0.775989416823
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.91      0.94      0.93      7318
     B-MISC       0.03      0.04      0.03       141
     I-MISC       0.00      0.00      0.00       154
      B-ORG       0.17      0.47      0.25       296
      B-LOC       0.00      0.00      0.00       218
      B-PER       0.00      0.00      0.00       438
      I-PER       0.00      0.00      0.00       214
      I-ORG       0.00      0.00      0.00       151
      I-LOC       0.00      0.00      0.00       141

avg / total       0.74      0.78      0.76      9071

F-1 Score (without O):
0.104037831939
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 8
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104047 unique words.
4043 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 281
OOV word occurences: in test 479
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659072     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,202
Trainable params: 6,771,202
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 3s 202ms/step - loss: 0.3504 - acc: 0.9000
Epoch 2/27

16/16 [==============================] - 0s 29ms/step - loss: 0.3297 - acc: 0.9000
Epoch 3/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3099 - acc: 0.9000
Epoch 4/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2897 - acc: 0.9003
Epoch 5/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2757 - acc: 0.9000
Epoch 6/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2532 - acc: 0.9015
Epoch 7/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2364 - acc: 0.9028
Epoch 8/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2237 - acc: 0.9098
Epoch 9/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2074 - acc: 0.9215
Epoch 10/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1948 - acc: 0.9322
Epoch 11/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1841 - acc: 0.9405
Epoch 12/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1773 - acc: 0.9423
Epoch 13/27

16/16 [==============================] - 0s 26ms/step - loss: 0.1735 - acc: 0.9463
Epoch 14/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1610 - acc: 0.9500
Epoch 15/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1608 - acc: 0.9494
Epoch 16/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1510 - acc: 0.9485
Epoch 17/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1497 - acc: 0.9494
Epoch 18/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1433 - acc: 0.9503
Epoch 19/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1362 - acc: 0.9546
Epoch 20/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1321 - acc: 0.9558
Epoch 21/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1285 - acc: 0.9607
Epoch 22/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1245 - acc: 0.9635
Epoch 23/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1197 - acc: 0.9641
Epoch 24/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1203 - acc: 0.9663
Epoch 25/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1174 - acc: 0.9681
Epoch 26/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1159 - acc: 0.9678
Epoch 27/27

16/16 [==============================] - 0s 26ms/step - loss: 0.1098 - acc: 0.9681
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7034
False 2037
True percentage 0.775438209679
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.86      0.95      0.90      7318
     B-MISC       0.00      0.00      0.00       141
      B-ORG       0.14      0.25      0.18       296
      B-PER       0.00      0.00      0.00       438
     I-MISC       0.00      0.00      0.00       154
      I-PER       0.00      0.00      0.00       214
      I-ORG       0.67      0.01      0.03       151
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141

avg / total       0.71      0.78      0.74      9071

F-1 Score (without O):
0.0663423264042
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 9
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104041 unique words.
4037 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 486
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658688     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,818
Trainable params: 6,770,818
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 3s 202ms/step - loss: 0.3724 - acc: 0.8946
Epoch 2/27

16/16 [==============================] - 0s 29ms/step - loss: 0.3473 - acc: 0.8968
Epoch 3/27

16/16 [==============================] - 0s 29ms/step - loss: 0.3214 - acc: 0.8987
Epoch 4/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2941 - acc: 0.8990
Epoch 5/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2711 - acc: 0.8994
Epoch 6/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2515 - acc: 0.9006
Epoch 7/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2243 - acc: 0.9070
Epoch 8/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2026 - acc: 0.9144
Epoch 9/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1793 - acc: 0.9291
Epoch 10/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1564 - acc: 0.9489
Epoch 11/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1367 - acc: 0.9613
Epoch 12/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1185 - acc: 0.9706
Epoch 13/27

16/16 [==============================] - 0s 26ms/step - loss: 0.1089 - acc: 0.9751
Epoch 14/27

16/16 [==============================] - 0s 29ms/step - loss: 0.0967 - acc: 0.9748
Epoch 15/27

16/16 [==============================] - 0s 29ms/step - loss: 0.0930 - acc: 0.9744
Epoch 16/27

16/16 [==============================] - 0s 29ms/step - loss: 0.0877 - acc: 0.9719
Epoch 17/27

16/16 [==============================] - 0s 28ms/step - loss: 0.0883 - acc: 0.9716
Epoch 18/27

16/16 [==============================] - 0s 27ms/step - loss: 0.0879 - acc: 0.9712
Epoch 19/27

16/16 [==============================] - 0s 27ms/step - loss: 0.0856 - acc: 0.9712
Epoch 20/27

16/16 [==============================] - 0s 28ms/step - loss: 0.0845 - acc: 0.9719
Epoch 21/27

16/16 [==============================] - 0s 30ms/step - loss: 0.0825 - acc: 0.9722
Epoch 22/27

16/16 [==============================] - 0s 29ms/step - loss: 0.0779 - acc: 0.9722
Epoch 23/27

16/16 [==============================] - 0s 28ms/step - loss: 0.0740 - acc: 0.9744
Epoch 24/27

16/16 [==============================] - 0s 26ms/step - loss: 0.0676 - acc: 0.9764
Epoch 25/27

16/16 [==============================] - 0s 28ms/step - loss: 0.0625 - acc: 0.9773
Epoch 26/27

16/16 [==============================] - 0s 27ms/step - loss: 0.0620 - acc: 0.9789
Epoch 27/27

16/16 [==============================] - 0s 29ms/step - loss: 0.0601 - acc: 0.9808
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7098
False 1973
True percentage 0.782493661118
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.88      0.96      0.92      7318
      B-PER       1.00      0.00      0.00       438
      B-ORG       1.00      0.00      0.01       296
      I-ORG       0.11      0.45      0.17       151
      I-PER       0.00      0.00      0.00       214
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.80      0.78      0.75      9071

F-1 Score (without O):
0.0584551148225
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 10
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104045 unique words.
4041 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 279
OOV word occurences: in test 469
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658944     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,074
Trainable params: 6,771,074
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 3s 200ms/step - loss: 0.3464 - acc: 0.8927
Epoch 2/27

16/16 [==============================] - 0s 30ms/step - loss: 0.3275 - acc: 0.8933
Epoch 3/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3052 - acc: 0.8966
Epoch 4/27

16/16 [==============================] - 0s 30ms/step - loss: 0.2853 - acc: 0.8978
Epoch 5/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2685 - acc: 0.8992
Epoch 6/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2420 - acc: 0.9017
Epoch 7/27

16/16 [==============================] - 0s 29ms/step - loss: 0.2308 - acc: 0.9020
Epoch 8/27

16/16 [==============================] - 0s 30ms/step - loss: 0.2158 - acc: 0.9081
Epoch 9/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1981 - acc: 0.9222
Epoch 10/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1849 - acc: 0.9320
Epoch 11/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1706 - acc: 0.9416
Epoch 12/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1626 - acc: 0.9449
Epoch 13/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1517 - acc: 0.9486
Epoch 14/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1454 - acc: 0.9528
Epoch 15/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1431 - acc: 0.9542
Epoch 16/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1359 - acc: 0.9556
Epoch 17/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1349 - acc: 0.9559
Epoch 18/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1253 - acc: 0.9573
Epoch 19/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1185 - acc: 0.9579
Epoch 20/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1213 - acc: 0.9587
Epoch 21/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1147 - acc: 0.9584
Epoch 22/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1083 - acc: 0.9649
Epoch 23/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1073 - acc: 0.9643
Epoch 24/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1050 - acc: 0.9674
Epoch 25/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1017 - acc: 0.9713
Epoch 26/27

16/16 [==============================] - 0s 28ms/step - loss: 0.0989 - acc: 0.9716
Epoch 27/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1010 - acc: 0.9705
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7097
False 1974
True percentage 0.782383419689
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.83      0.97      0.90      7318
      B-PER       0.00      0.00      0.00       438
      B-ORG       0.24      0.03      0.05       296
      I-ORG       0.00      0.00      0.00       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      I-PER       0.00      0.00      0.00       214
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141

avg / total       0.68      0.78      0.72      9071

F-1 Score (without O):
0.00863464651916
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 11
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104036 unique words.
4032 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 567
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658368     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,498
Trainable params: 6,770,498
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 3s 197ms/step - loss: 0.3360 - acc: 0.8997
Epoch 2/27

16/16 [==============================] - 0s 29ms/step - loss: 0.3089 - acc: 0.9000
Epoch 3/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2885 - acc: 0.9000
Epoch 4/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2581 - acc: 0.9000
Epoch 5/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2348 - acc: 0.9020
Epoch 6/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2173 - acc: 0.9082
Epoch 7/27

16/16 [==============================] - 0s 26ms/step - loss: 0.1938 - acc: 0.9207
Epoch 8/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1659 - acc: 0.9418
Epoch 9/27

16/16 [==============================] - 0s 26ms/step - loss: 0.1540 - acc: 0.9497
Epoch 10/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1359 - acc: 0.9609
Epoch 11/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1234 - acc: 0.9653
Epoch 12/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1156 - acc: 0.9667
Epoch 13/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1072 - acc: 0.9677
Epoch 14/27

16/16 [==============================] - 0s 26ms/step - loss: 0.1043 - acc: 0.9670
Epoch 15/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1034 - acc: 0.9677
Epoch 16/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1000 - acc: 0.9673
Epoch 17/27

16/16 [==============================] - 0s 29ms/step - loss: 0.0936 - acc: 0.9690
Epoch 18/27

16/16 [==============================] - 0s 27ms/step - loss: 0.0914 - acc: 0.9694
Epoch 19/27

16/16 [==============================] - 0s 27ms/step - loss: 0.0885 - acc: 0.9707
Epoch 20/27

16/16 [==============================] - 0s 26ms/step - loss: 0.0839 - acc: 0.9718
Epoch 21/27

16/16 [==============================] - 0s 27ms/step - loss: 0.0791 - acc: 0.9731
Epoch 22/27

16/16 [==============================] - 0s 28ms/step - loss: 0.0780 - acc: 0.9748
Epoch 23/27

16/16 [==============================] - 0s 28ms/step - loss: 0.0747 - acc: 0.9765
Epoch 24/27

16/16 [==============================] - 0s 28ms/step - loss: 0.0701 - acc: 0.9779
Epoch 25/27

16/16 [==============================] - 0s 27ms/step - loss: 0.0695 - acc: 0.9789
Epoch 26/27

16/16 [==============================] - 0s 27ms/step - loss: 0.0681 - acc: 0.9789
Epoch 27/27

16/16 [==============================] - 0s 28ms/step - loss: 0.0681 - acc: 0.9810
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7081
False 1990
True percentage 0.780619556829
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.13      0.07      0.09       296
          O       0.87      0.96      0.91      7318
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-PER       0.07      0.04      0.05       438
      I-PER       0.58      0.12      0.19       214
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
      I-ORG       0.00      0.00      0.00       151

avg / total       0.73      0.78      0.75      9071

F-1 Score (without O):
0.824834997956
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104039 unique words.
4035 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658560     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,690
Trainable params: 6,770,690
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 3s 199ms/step - loss: 0.3034 - acc: 0.9006
Epoch 2/27

16/16 [==============================] - 0s 30ms/step - loss: 0.2835 - acc: 0.9019
Epoch 3/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2632 - acc: 0.9032
Epoch 4/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2396 - acc: 0.9138
Epoch 5/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2223 - acc: 0.9199
Epoch 6/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2059 - acc: 0.9260
Epoch 7/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1924 - acc: 0.9314
Epoch 8/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1801 - acc: 0.9401
Epoch 9/27

16/16 [==============================] - 0s 26ms/step - loss: 0.1629 - acc: 0.9516
Epoch 10/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1550 - acc: 0.9558
Epoch 11/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1436 - acc: 0.9548
Epoch 12/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1343 - acc: 0.9571
Epoch 13/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1274 - acc: 0.9561
Epoch 14/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1208 - acc: 0.9558
Epoch 15/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1158 - acc: 0.9577
Epoch 16/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1135 - acc: 0.9593
Epoch 17/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1093 - acc: 0.9628
Epoch 18/27

16/16 [==============================] - 0s 26ms/step - loss: 0.1040 - acc: 0.9644
Epoch 19/27

16/16 [==============================] - 0s 26ms/step - loss: 0.0999 - acc: 0.9654
Epoch 20/27

16/16 [==============================] - 0s 26ms/step - loss: 0.0944 - acc: 0.9686
Epoch 21/27

16/16 [==============================] - 0s 29ms/step - loss: 0.0903 - acc: 0.9715
Epoch 22/27

16/16 [==============================] - 0s 29ms/step - loss: 0.0859 - acc: 0.9724
Epoch 23/27

16/16 [==============================] - 0s 28ms/step - loss: 0.0825 - acc: 0.9760
Epoch 24/27

16/16 [==============================] - 0s 26ms/step - loss: 0.0811 - acc: 0.9776
Epoch 25/27

16/16 [==============================] - 0s 27ms/step - loss: 0.0777 - acc: 0.9776
Epoch 26/27

16/16 [==============================] - 0s 27ms/step - loss: 0.0773 - acc: 0.9776
Epoch 27/27

16/16 [==============================] - 0s 27ms/step - loss: 0.0758 - acc: 0.9788
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7052
False 2019
True percentage 0.777422555396
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.00      0.00      0.00       438
      I-PER       0.00      0.00      0.00       214
          O       0.93      0.94      0.93      7318
      B-ORG       0.17      0.44      0.25       296
      B-LOC       0.00      0.00      0.00       218
      I-ORG       0.12      0.26      0.16       151
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.76      0.78      0.76      9071

F-1 Score (without O):
0.823062558357
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 6 unique labels.
Found 104037 unique words.
4033 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658432     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 7)        966         bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,118
Trainable params: 6,770,118
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 3s 380ms/step - loss: 0.3945 - acc: 0.8571
Epoch 2/27

8/8 [==============================] - 0s 42ms/step - loss: 0.3778 - acc: 0.8595
Epoch 3/27

8/8 [==============================] - 0s 45ms/step - loss: 0.3349 - acc: 0.8690
Epoch 4/27

8/8 [==============================] - 0s 43ms/step - loss: 0.2975 - acc: 0.8777
Epoch 5/27

8/8 [==============================] - 0s 42ms/step - loss: 0.2669 - acc: 0.8974
Epoch 6/27

8/8 [==============================] - 0s 43ms/step - loss: 0.2343 - acc: 0.9132
Epoch 7/27

8/8 [==============================] - 0s 43ms/step - loss: 0.2066 - acc: 0.9313
Epoch 8/27

8/8 [==============================] - 0s 42ms/step - loss: 0.1820 - acc: 0.9471
Epoch 9/27

8/8 [==============================] - 0s 45ms/step - loss: 0.1682 - acc: 0.9534
Epoch 10/27

8/8 [==============================] - 0s 43ms/step - loss: 0.1509 - acc: 0.9582
Epoch 11/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1372 - acc: 0.9629
Epoch 12/27

8/8 [==============================] - 0s 43ms/step - loss: 0.1280 - acc: 0.9637
Epoch 13/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1240 - acc: 0.9637
Epoch 14/27

8/8 [==============================] - 0s 42ms/step - loss: 0.1138 - acc: 0.9629
Epoch 15/27

8/8 [==============================] - 0s 40ms/step - loss: 0.1121 - acc: 0.9653
Epoch 16/27

8/8 [==============================] - 0s 43ms/step - loss: 0.1044 - acc: 0.9669
Epoch 17/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1043 - acc: 0.9637
Epoch 18/27

8/8 [==============================] - 0s 42ms/step - loss: 0.0959 - acc: 0.9669
Epoch 19/27

8/8 [==============================] - 0s 42ms/step - loss: 0.0950 - acc: 0.9684
Epoch 20/27

8/8 [==============================] - 0s 41ms/step - loss: 0.0914 - acc: 0.9676
Epoch 21/27

8/8 [==============================] - 0s 39ms/step - loss: 0.0774 - acc: 0.9740
Epoch 22/27

8/8 [==============================] - 0s 40ms/step - loss: 0.0740 - acc: 0.9740
Epoch 23/27

8/8 [==============================] - 0s 42ms/step - loss: 0.0758 - acc: 0.9724
Epoch 24/27

8/8 [==============================] - 0s 42ms/step - loss: 0.0675 - acc: 0.9803
Epoch 25/27

8/8 [==============================] - 0s 42ms/step - loss: 0.0668 - acc: 0.9787
Epoch 26/27

8/8 [==============================] - 0s 41ms/step - loss: 0.0685 - acc: 0.9803
Epoch 27/27

8/8 [==============================] - 0s 42ms/step - loss: 0.0653 - acc: 0.9803
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7163
False 1472
True percentage 0.829530978576
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.91      0.95      0.93      7318
      B-PER       0.29      0.05      0.09       438
      B-ORG       0.18      0.36      0.24       296
      I-ORG       0.00      0.00      0.00       151
      I-PER       0.33      0.31      0.32       214
      B-LOC       0.00      0.00      0.00       218

avg / total       0.80      0.83      0.81      8635

F-1 Score (without O):
0.177919708029
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 8 unique labels.
Found 104035 unique words.
4031 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658304     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,284
Trainable params: 6,770,284
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 3s 383ms/step - loss: 0.3260 - acc: 0.8881
Epoch 2/27

8/8 [==============================] - 0s 43ms/step - loss: 0.3000 - acc: 0.8889
Epoch 3/27

8/8 [==============================] - 0s 44ms/step - loss: 0.2755 - acc: 0.8912
Epoch 4/27

8/8 [==============================] - 0s 43ms/step - loss: 0.2529 - acc: 0.8936
Epoch 5/27

8/8 [==============================] - 0s 42ms/step - loss: 0.2300 - acc: 0.8944
Epoch 6/27

8/8 [==============================] - 0s 42ms/step - loss: 0.2072 - acc: 0.9092
Epoch 7/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1878 - acc: 0.9171
Epoch 8/27

8/8 [==============================] - 0s 40ms/step - loss: 0.1674 - acc: 0.9358
Epoch 9/27

8/8 [==============================] - 0s 42ms/step - loss: 0.1509 - acc: 0.9452
Epoch 10/27

8/8 [==============================] - 0s 44ms/step - loss: 0.1311 - acc: 0.9640
Epoch 11/27

8/8 [==============================] - 0s 43ms/step - loss: 0.1178 - acc: 0.9718
Epoch 12/27

8/8 [==============================] - 0s 43ms/step - loss: 0.1029 - acc: 0.9797
Epoch 13/27

8/8 [==============================] - 0s 40ms/step - loss: 0.0931 - acc: 0.9804
Epoch 14/27

8/8 [==============================] - 0s 41ms/step - loss: 0.0805 - acc: 0.9781
Epoch 15/27

8/8 [==============================] - 0s 41ms/step - loss: 0.0745 - acc: 0.9765
Epoch 16/27

8/8 [==============================] - 0s 41ms/step - loss: 0.0766 - acc: 0.9750
Epoch 17/27

8/8 [==============================] - 0s 42ms/step - loss: 0.0659 - acc: 0.9750
Epoch 18/27

8/8 [==============================] - 0s 41ms/step - loss: 0.0752 - acc: 0.9734
Epoch 19/27

8/8 [==============================] - 0s 43ms/step - loss: 0.0684 - acc: 0.9750
Epoch 20/27

8/8 [==============================] - 0s 41ms/step - loss: 0.0635 - acc: 0.9742
Epoch 21/27

8/8 [==============================] - 0s 41ms/step - loss: 0.0611 - acc: 0.9757
Epoch 22/27

8/8 [==============================] - 0s 41ms/step - loss: 0.0533 - acc: 0.9773
Epoch 23/27

8/8 [==============================] - 0s 40ms/step - loss: 0.0535 - acc: 0.9773
Epoch 24/27

8/8 [==============================] - 0s 39ms/step - loss: 0.0504 - acc: 0.9765
Epoch 25/27

8/8 [==============================] - 0s 40ms/step - loss: 0.0472 - acc: 0.9836
Epoch 26/27

8/8 [==============================] - 0s 40ms/step - loss: 0.0433 - acc: 0.9867
Epoch 27/27

8/8 [==============================] - 0s 40ms/step - loss: 0.0448 - acc: 0.9851
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7000
False 1917
True percentage 0.785017382528
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.93      0.93      7318
      B-ORG       0.14      0.55      0.22       296
      I-ORG       0.00      0.00      0.00       151
      B-PER       0.83      0.01      0.02       438
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
      I-PER       0.00      0.00      0.00       214
     B-MISC       0.00      0.00      0.00       141

avg / total       0.81      0.79      0.77      8917

F-1 Score (without O):
0.120993878286
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104034 unique words.
4030 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658240     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,370
Trainable params: 6,770,370
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 3s 384ms/step - loss: 0.3127 - acc: 0.8994
Epoch 2/27

8/8 [==============================] - 0s 44ms/step - loss: 0.2956 - acc: 0.8994
Epoch 3/27

8/8 [==============================] - 0s 45ms/step - loss: 0.2796 - acc: 0.8977
Epoch 4/27

8/8 [==============================] - 0s 44ms/step - loss: 0.2546 - acc: 0.8994
Epoch 5/27

8/8 [==============================] - 0s 42ms/step - loss: 0.2524 - acc: 0.9006
Epoch 6/27

8/8 [==============================] - 0s 42ms/step - loss: 0.2296 - acc: 0.9012
Epoch 7/27

8/8 [==============================] - 0s 40ms/step - loss: 0.2160 - acc: 0.9064
Epoch 8/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1926 - acc: 0.9197
Epoch 9/27

8/8 [==============================] - 0s 42ms/step - loss: 0.1792 - acc: 0.9347
Epoch 10/27

8/8 [==============================] - 0s 44ms/step - loss: 0.1693 - acc: 0.9439
Epoch 11/27

8/8 [==============================] - 0s 45ms/step - loss: 0.1444 - acc: 0.9595
Epoch 12/27

8/8 [==============================] - 0s 43ms/step - loss: 0.1361 - acc: 0.9613
Epoch 13/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1164 - acc: 0.9618
Epoch 14/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1114 - acc: 0.9584
Epoch 15/27

8/8 [==============================] - 0s 40ms/step - loss: 0.1036 - acc: 0.9618
Epoch 16/27

8/8 [==============================] - 0s 40ms/step - loss: 0.1013 - acc: 0.9653
Epoch 17/27

8/8 [==============================] - 0s 41ms/step - loss: 0.0950 - acc: 0.9665
Epoch 18/27

8/8 [==============================] - 0s 42ms/step - loss: 0.0907 - acc: 0.9659
Epoch 19/27

8/8 [==============================] - 0s 41ms/step - loss: 0.0865 - acc: 0.9671
Epoch 20/27

8/8 [==============================] - 0s 41ms/step - loss: 0.0932 - acc: 0.9671
Epoch 21/27

8/8 [==============================] - 0s 42ms/step - loss: 0.0786 - acc: 0.9688
Epoch 22/27

8/8 [==============================] - 0s 41ms/step - loss: 0.0773 - acc: 0.9699
Epoch 23/27

8/8 [==============================] - 0s 41ms/step - loss: 0.0744 - acc: 0.9723
Epoch 24/27

8/8 [==============================] - 0s 43ms/step - loss: 0.0702 - acc: 0.9792
Epoch 25/27

8/8 [==============================] - 0s 40ms/step - loss: 0.0713 - acc: 0.9780
Epoch 26/27

8/8 [==============================] - 0s 40ms/step - loss: 0.0709 - acc: 0.9775
Epoch 27/27

8/8 [==============================] - 0s 41ms/step - loss: 0.0686 - acc: 0.9780
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7031
False 2040
True percentage 0.775107485393
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.92      0.94      0.93      7318
      B-PER       0.67      0.00      0.01       438
      B-ORG       0.16      0.54      0.25       296
      I-ORG       0.00      0.00      0.00       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      I-PER       0.00      0.00      0.00       214
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141

avg / total       0.78      0.78      0.76      9071

F-1 Score (without O):
0.117263843648
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104037 unique words.
4033 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 567
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658432     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,562
Trainable params: 6,770,562
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 3s 386ms/step - loss: 0.3364 - acc: 0.8983
Epoch 2/27

8/8 [==============================] - 0s 42ms/step - loss: 0.3164 - acc: 0.8994
Epoch 3/27

8/8 [==============================] - 0s 44ms/step - loss: 0.2937 - acc: 0.9000
Epoch 4/27

8/8 [==============================] - 0s 41ms/step - loss: 0.2687 - acc: 0.9028
Epoch 5/27

8/8 [==============================] - 0s 40ms/step - loss: 0.2499 - acc: 0.9039
Epoch 6/27

8/8 [==============================] - 0s 39ms/step - loss: 0.2291 - acc: 0.9133
Epoch 7/27

8/8 [==============================] - 0s 41ms/step - loss: 0.2134 - acc: 0.9182
Epoch 8/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1903 - acc: 0.9337
Epoch 9/27

8/8 [==============================] - 0s 42ms/step - loss: 0.1790 - acc: 0.9436
Epoch 10/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1697 - acc: 0.9470
Epoch 11/27

8/8 [==============================] - 0s 40ms/step - loss: 0.1548 - acc: 0.9525
Epoch 12/27

8/8 [==============================] - 0s 40ms/step - loss: 0.1455 - acc: 0.9580
Epoch 13/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1405 - acc: 0.9547
Epoch 14/27

8/8 [==============================] - 0s 40ms/step - loss: 0.1374 - acc: 0.9508
Epoch 15/27

8/8 [==============================] - 0s 44ms/step - loss: 0.1354 - acc: 0.9481
Epoch 16/27

8/8 [==============================] - 0s 43ms/step - loss: 0.1331 - acc: 0.9492
Epoch 17/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1285 - acc: 0.9508
Epoch 18/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1205 - acc: 0.9575
Epoch 19/27

8/8 [==============================] - 0s 40ms/step - loss: 0.1182 - acc: 0.9580
Epoch 20/27

8/8 [==============================] - 0s 40ms/step - loss: 0.1089 - acc: 0.9613
Epoch 21/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1039 - acc: 0.9652
Epoch 22/27

8/8 [==============================] - 0s 44ms/step - loss: 0.1031 - acc: 0.9663
Epoch 23/27

8/8 [==============================] - 0s 41ms/step - loss: 0.0984 - acc: 0.9652
Epoch 24/27

8/8 [==============================] - 0s 41ms/step - loss: 0.0977 - acc: 0.9657
Epoch 25/27

8/8 [==============================] - 0s 41ms/step - loss: 0.0954 - acc: 0.9680
Epoch 26/27

8/8 [==============================] - 0s 40ms/step - loss: 0.0923 - acc: 0.9674
Epoch 27/27

8/8 [==============================] - 0s 40ms/step - loss: 0.0906 - acc: 0.9680
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7147
False 1924
True percentage 0.787895491126
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.94      0.94      7318
      B-ORG       0.46      0.08      0.14       296
      B-PER       0.26      0.30      0.28       438
      I-PER       0.20      0.01      0.02       214
      B-LOC       0.31      0.12      0.18       218
      I-LOC       0.00      0.00      0.00       141
      I-ORG       0.16      0.52      0.24       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.80      0.79      0.78      9071

F-1 Score (without O):
0.181567138419
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 6 unique labels.
Found 104037 unique words.
4033 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658432     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 7)        966         bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,118
Trainable params: 6,770,118
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 3s 378ms/step - loss: 0.5183 - acc: 0.8553
Epoch 2/27

8/8 [==============================] - 0s 46ms/step - loss: 0.4851 - acc: 0.8562
Epoch 3/27

8/8 [==============================] - 0s 45ms/step - loss: 0.4483 - acc: 0.8571
Epoch 4/27

8/8 [==============================] - 0s 45ms/step - loss: 0.4185 - acc: 0.8562
Epoch 5/27

8/8 [==============================] - 0s 41ms/step - loss: 0.3881 - acc: 0.8571
Epoch 6/27

8/8 [==============================] - 0s 42ms/step - loss: 0.3451 - acc: 0.8581
Epoch 7/27

8/8 [==============================] - 0s 41ms/step - loss: 0.3180 - acc: 0.8590
Epoch 8/27

8/8 [==============================] - 0s 41ms/step - loss: 0.2735 - acc: 0.8618
Epoch 9/27

8/8 [==============================] - 0s 41ms/step - loss: 0.2453 - acc: 0.8738
Epoch 10/27

8/8 [==============================] - 0s 43ms/step - loss: 0.2133 - acc: 0.9156
Epoch 11/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1862 - acc: 0.9406
Epoch 12/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1641 - acc: 0.9545
Epoch 13/27

8/8 [==============================] - 0s 43ms/step - loss: 0.1529 - acc: 0.9620
Epoch 14/27

8/8 [==============================] - 0s 43ms/step - loss: 0.1293 - acc: 0.9675
Epoch 15/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1185 - acc: 0.9685
Epoch 16/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1087 - acc: 0.9722
Epoch 17/27

8/8 [==============================] - 0s 40ms/step - loss: 0.1027 - acc: 0.9712
Epoch 18/27

8/8 [==============================] - 0s 42ms/step - loss: 0.0998 - acc: 0.9722
Epoch 19/27

8/8 [==============================] - 0s 42ms/step - loss: 0.0969 - acc: 0.9722
Epoch 20/27

8/8 [==============================] - 0s 40ms/step - loss: 0.0982 - acc: 0.9722
Epoch 21/27

8/8 [==============================] - 0s 43ms/step - loss: 0.0957 - acc: 0.9722
Epoch 22/27

8/8 [==============================] - 0s 40ms/step - loss: 0.0982 - acc: 0.9722
Epoch 23/27

8/8 [==============================] - 0s 41ms/step - loss: 0.0874 - acc: 0.9722
Epoch 24/27

8/8 [==============================] - 0s 42ms/step - loss: 0.0859 - acc: 0.9722
Epoch 25/27

8/8 [==============================] - 0s 40ms/step - loss: 0.0828 - acc: 0.9722
Epoch 26/27

8/8 [==============================] - 0s 40ms/step - loss: 0.0780 - acc: 0.9722
Epoch 27/27

8/8 [==============================] - 0s 43ms/step - loss: 0.0823 - acc: 0.9722
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7089
False 1469
True percentage 0.8283477448
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.00      0.00      0.00       438
          O       0.83      0.97      0.90      7318
      B-ORG       0.00      0.00      0.00       296
     B-MISC       0.00      0.00      0.00       141
      I-ORG       0.00      0.00      0.00       151
      I-PER       0.00      0.00      0.00       214

avg / total       0.71      0.83      0.77      8558

F-1 Score (without O):
0.852914636347
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 6 unique labels.
Found 104032 unique words.
4028 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658112     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 7)        966         bidirectional_2[0][0]            
==================================================================================================
Total params: 6,769,798
Trainable params: 6,769,798
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 3s 376ms/step - loss: 0.3798 - acc: 0.8571
Epoch 2/27

8/8 [==============================] - 0s 44ms/step - loss: 0.3487 - acc: 0.8571
Epoch 3/27

8/8 [==============================] - 0s 41ms/step - loss: 0.3245 - acc: 0.8589
Epoch 4/27

8/8 [==============================] - 0s 41ms/step - loss: 0.3012 - acc: 0.8589
Epoch 5/27

8/8 [==============================] - 0s 41ms/step - loss: 0.2686 - acc: 0.8715
Epoch 6/27

8/8 [==============================] - 0s 41ms/step - loss: 0.2517 - acc: 0.8832
Epoch 7/27

8/8 [==============================] - 0s 40ms/step - loss: 0.2288 - acc: 0.9102
Epoch 8/27

8/8 [==============================] - 0s 40ms/step - loss: 0.2065 - acc: 0.9272
Epoch 9/27

8/8 [==============================] - 0s 42ms/step - loss: 0.1945 - acc: 0.9434
Epoch 10/27

8/8 [==============================] - 0s 40ms/step - loss: 0.1733 - acc: 0.9587
Epoch 11/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1612 - acc: 0.9686
Epoch 12/27

8/8 [==============================] - 0s 42ms/step - loss: 0.1487 - acc: 0.9712
Epoch 13/27

8/8 [==============================] - 0s 42ms/step - loss: 0.1361 - acc: 0.9739
Epoch 14/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1272 - acc: 0.9695
Epoch 15/27

8/8 [==============================] - 0s 42ms/step - loss: 0.1147 - acc: 0.9677
Epoch 16/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1100 - acc: 0.9659
Epoch 17/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1012 - acc: 0.9668
Epoch 18/27

8/8 [==============================] - 0s 43ms/step - loss: 0.0983 - acc: 0.9650
Epoch 19/27

8/8 [==============================] - 0s 42ms/step - loss: 0.0920 - acc: 0.9695
Epoch 20/27

8/8 [==============================] - 0s 43ms/step - loss: 0.0883 - acc: 0.9686
Epoch 21/27

8/8 [==============================] - 0s 43ms/step - loss: 0.0801 - acc: 0.9686
Epoch 22/27

8/8 [==============================] - 0s 42ms/step - loss: 0.0782 - acc: 0.9704
Epoch 23/27

8/8 [==============================] - 0s 41ms/step - loss: 0.0742 - acc: 0.9704
Epoch 24/27

8/8 [==============================] - 0s 41ms/step - loss: 0.0730 - acc: 0.9721
Epoch 25/27

8/8 [==============================] - 0s 40ms/step - loss: 0.0657 - acc: 0.9748
Epoch 26/27

8/8 [==============================] - 0s 41ms/step - loss: 0.0675 - acc: 0.9766
Epoch 27/27

8/8 [==============================] - 0s 40ms/step - loss: 0.0660 - acc: 0.9784
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7057
False 1578
True percentage 0.817255356109
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.93      0.94      7318
      B-PER       0.18      0.40      0.25       438
      B-ORG       0.13      0.01      0.02       296
      I-ORG       0.00      0.00      0.00       151
      B-LOC       0.00      0.00      0.00       218
      I-PER       0.21      0.27      0.23       214

avg / total       0.82      0.82      0.81      8635

F-1 Score (without O):
0.181051016494
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 8 unique labels.
Found 104036 unique words.
4032 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658368     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,348
Trainable params: 6,770,348
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 4s 494ms/step - loss: 0.4055 - acc: 0.8840
Epoch 2/27

8/8 [==============================] - 0s 44ms/step - loss: 0.3778 - acc: 0.8822
Epoch 3/27

8/8 [==============================] - 0s 43ms/step - loss: 0.3509 - acc: 0.8871
Epoch 4/27

8/8 [==============================] - 0s 42ms/step - loss: 0.3272 - acc: 0.8871
Epoch 5/27

8/8 [==============================] - 0s 42ms/step - loss: 0.3046 - acc: 0.8877
Epoch 6/27

8/8 [==============================] - 0s 41ms/step - loss: 0.2841 - acc: 0.8889
Epoch 7/27

8/8 [==============================] - 0s 42ms/step - loss: 0.2553 - acc: 0.8932
Epoch 8/27

8/8 [==============================] - 0s 42ms/step - loss: 0.2356 - acc: 0.8962
Epoch 9/27

8/8 [==============================] - 0s 42ms/step - loss: 0.2165 - acc: 0.9054
Epoch 10/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1916 - acc: 0.9237
Epoch 11/27

8/8 [==============================] - 0s 44ms/step - loss: 0.1762 - acc: 0.9402
Epoch 12/27

8/8 [==============================] - 0s 42ms/step - loss: 0.1521 - acc: 0.9573
Epoch 13/27

8/8 [==============================] - 0s 45ms/step - loss: 0.1388 - acc: 0.9621
Epoch 14/27

8/8 [==============================] - 0s 42ms/step - loss: 0.1288 - acc: 0.9640
Epoch 15/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1225 - acc: 0.9628
Epoch 16/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1154 - acc: 0.9628
Epoch 17/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1132 - acc: 0.9597
Epoch 18/27

8/8 [==============================] - 0s 40ms/step - loss: 0.1088 - acc: 0.9579
Epoch 19/27

8/8 [==============================] - 0s 42ms/step - loss: 0.1098 - acc: 0.9603
Epoch 20/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1114 - acc: 0.9567
Epoch 21/27

8/8 [==============================] - 0s 43ms/step - loss: 0.1038 - acc: 0.9591
Epoch 22/27

8/8 [==============================] - 0s 43ms/step - loss: 0.1015 - acc: 0.9615
Epoch 23/27

8/8 [==============================] - 0s 41ms/step - loss: 0.0936 - acc: 0.9646
Epoch 24/27

8/8 [==============================] - 0s 40ms/step - loss: 0.0859 - acc: 0.9670
Epoch 25/27

8/8 [==============================] - 0s 42ms/step - loss: 0.0822 - acc: 0.9707
Epoch 26/27

8/8 [==============================] - 0s 43ms/step - loss: 0.0805 - acc: 0.9725
Epoch 27/27

8/8 [==============================] - 0s 40ms/step - loss: 0.0752 - acc: 0.9750
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7035
False 1895
True percentage 0.787793952968
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.93      0.94      7318
      B-PER       0.08      0.00      0.01       438
      I-PER       0.00      0.00      0.00       214
      B-ORG       0.26      0.31      0.28       296
      I-ORG       0.11      0.67      0.19       151
      B-LOC       0.00      0.00      0.00       218
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.79      0.79      0.78      8930

F-1 Score (without O):
0.135041551247
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 8 unique labels.
Found 104042 unique words.
4038 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 500
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658752     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,732
Trainable params: 6,770,732
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 3s 382ms/step - loss: 0.4461 - acc: 0.8883
Epoch 2/27

8/8 [==============================] - 0s 44ms/step - loss: 0.4251 - acc: 0.8883
Epoch 3/27

8/8 [==============================] - 0s 43ms/step - loss: 0.3867 - acc: 0.8883
Epoch 4/27

8/8 [==============================] - 0s 42ms/step - loss: 0.3651 - acc: 0.8889
Epoch 5/27

8/8 [==============================] - 0s 41ms/step - loss: 0.3430 - acc: 0.8889
Epoch 6/27

8/8 [==============================] - 0s 42ms/step - loss: 0.3198 - acc: 0.8901
Epoch 7/27

8/8 [==============================] - 0s 40ms/step - loss: 0.2957 - acc: 0.8919
Epoch 8/27

8/8 [==============================] - 0s 42ms/step - loss: 0.2763 - acc: 0.8955
Epoch 9/27

8/8 [==============================] - 0s 40ms/step - loss: 0.2529 - acc: 0.9010
Epoch 10/27

8/8 [==============================] - 0s 40ms/step - loss: 0.2315 - acc: 0.9034
Epoch 11/27

8/8 [==============================] - 0s 40ms/step - loss: 0.2087 - acc: 0.9112
Epoch 12/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1973 - acc: 0.9191
Epoch 13/27

8/8 [==============================] - 0s 40ms/step - loss: 0.1773 - acc: 0.9360
Epoch 14/27

8/8 [==============================] - 0s 46ms/step - loss: 0.1642 - acc: 0.9457
Epoch 15/27

8/8 [==============================] - 0s 42ms/step - loss: 0.1547 - acc: 0.9529
Epoch 16/27

8/8 [==============================] - 0s 40ms/step - loss: 0.1450 - acc: 0.9589
Epoch 17/27

8/8 [==============================] - 0s 40ms/step - loss: 0.1358 - acc: 0.9595
Epoch 18/27

8/8 [==============================] - 0s 40ms/step - loss: 0.1293 - acc: 0.9595
Epoch 19/27

8/8 [==============================] - 0s 43ms/step - loss: 0.1254 - acc: 0.9607
Epoch 20/27

8/8 [==============================] - 0s 44ms/step - loss: 0.1257 - acc: 0.9614
Epoch 21/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1209 - acc: 0.9614
Epoch 22/27

8/8 [==============================] - 0s 42ms/step - loss: 0.1090 - acc: 0.9620
Epoch 23/27

8/8 [==============================] - 0s 40ms/step - loss: 0.1133 - acc: 0.9614
Epoch 24/27

8/8 [==============================] - 0s 40ms/step - loss: 0.1029 - acc: 0.9620
Epoch 25/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1014 - acc: 0.9638
Epoch 26/27

8/8 [==============================] - 0s 40ms/step - loss: 0.0919 - acc: 0.9668
Epoch 27/27

8/8 [==============================] - 0s 42ms/step - loss: 0.0932 - acc: 0.9692
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7085
False 1845
True percentage 0.793393057111
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.83      0.97      0.89      7318
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-ORG       0.39      0.04      0.07       296
      B-LOC       0.00      0.00      0.00       218
      B-PER       0.00      0.00      0.00       438
      I-PER       0.00      0.00      0.00       214
      I-ORG       0.02      0.01      0.01       151

avg / total       0.70      0.79      0.74      8930

F-1 Score (without O):
0.0141843971631
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 8
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104041 unique words.
4037 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 281
OOV word occurences: in test 479
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658688     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,818
Trainable params: 6,770,818
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 3s 382ms/step - loss: 0.3573 - acc: 0.9000
Epoch 2/27

8/8 [==============================] - 0s 44ms/step - loss: 0.3287 - acc: 0.9000
Epoch 3/27

8/8 [==============================] - 0s 41ms/step - loss: 0.3127 - acc: 0.9006
Epoch 4/27

8/8 [==============================] - 0s 42ms/step - loss: 0.2964 - acc: 0.9006
Epoch 5/27

8/8 [==============================] - 0s 42ms/step - loss: 0.2764 - acc: 0.9028
Epoch 6/27

8/8 [==============================] - 0s 41ms/step - loss: 0.2623 - acc: 0.9062
Epoch 7/27

8/8 [==============================] - 0s 40ms/step - loss: 0.2456 - acc: 0.9102
Epoch 8/27

8/8 [==============================] - 0s 41ms/step - loss: 0.2315 - acc: 0.9124
Epoch 9/27

8/8 [==============================] - 0s 41ms/step - loss: 0.2175 - acc: 0.9186
Epoch 10/27

8/8 [==============================] - 0s 40ms/step - loss: 0.2070 - acc: 0.9288
Epoch 11/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1977 - acc: 0.9373
Epoch 12/27

8/8 [==============================] - 0s 40ms/step - loss: 0.1906 - acc: 0.9367
Epoch 13/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1739 - acc: 0.9452
Epoch 14/27

8/8 [==============================] - 0s 40ms/step - loss: 0.1659 - acc: 0.9514
Epoch 15/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1609 - acc: 0.9520
Epoch 16/27

8/8 [==============================] - 0s 43ms/step - loss: 0.1569 - acc: 0.9486
Epoch 17/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1520 - acc: 0.9531
Epoch 18/27

8/8 [==============================] - 0s 42ms/step - loss: 0.1500 - acc: 0.9508
Epoch 19/27

8/8 [==============================] - 0s 42ms/step - loss: 0.1429 - acc: 0.9537
Epoch 20/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1426 - acc: 0.9554
Epoch 21/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1381 - acc: 0.9554
Epoch 22/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1301 - acc: 0.9599
Epoch 23/27

8/8 [==============================] - 0s 43ms/step - loss: 0.1269 - acc: 0.9644
Epoch 24/27

8/8 [==============================] - 0s 42ms/step - loss: 0.1277 - acc: 0.9588
Epoch 25/27

8/8 [==============================] - 0s 40ms/step - loss: 0.1213 - acc: 0.9610
Epoch 26/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1180 - acc: 0.9633
Epoch 27/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1134 - acc: 0.9655
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7131
False 1940
True percentage 0.786131628266
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.87      0.96      0.91      7318
     B-MISC       0.00      0.00      0.00       141
      B-ORG       0.19      0.30      0.23       296
      B-PER       0.43      0.09      0.14       438
     I-MISC       0.00      0.00      0.00       154
      I-PER       0.00      0.00      0.00       214
      I-ORG       0.00      0.00      0.00       151
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141

avg / total       0.73      0.79      0.75      9071

F-1 Score (without O):
0.110243055556
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 9
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104035 unique words.
4031 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 486
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658304     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,434
Trainable params: 6,770,434
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 3s 382ms/step - loss: 0.3977 - acc: 0.9000
Epoch 2/27

8/8 [==============================] - 0s 44ms/step - loss: 0.3760 - acc: 0.9000
Epoch 3/27

8/8 [==============================] - 0s 43ms/step - loss: 0.3533 - acc: 0.9000
Epoch 4/27

8/8 [==============================] - 0s 41ms/step - loss: 0.3300 - acc: 0.9000
Epoch 5/27

8/8 [==============================] - 0s 41ms/step - loss: 0.3075 - acc: 0.9000
Epoch 6/27

8/8 [==============================] - 0s 41ms/step - loss: 0.2789 - acc: 0.9000
Epoch 7/27

8/8 [==============================] - 0s 41ms/step - loss: 0.2669 - acc: 0.8994
Epoch 8/27

8/8 [==============================] - 0s 41ms/step - loss: 0.2498 - acc: 0.8989
Epoch 9/27

8/8 [==============================] - 0s 40ms/step - loss: 0.2271 - acc: 0.9040
Epoch 10/27

8/8 [==============================] - 0s 44ms/step - loss: 0.2049 - acc: 0.9102
Epoch 11/27

8/8 [==============================] - 0s 42ms/step - loss: 0.1873 - acc: 0.9249
Epoch 12/27

8/8 [==============================] - 0s 44ms/step - loss: 0.1724 - acc: 0.9379
Epoch 13/27

8/8 [==============================] - 0s 42ms/step - loss: 0.1591 - acc: 0.9435
Epoch 14/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1484 - acc: 0.9520
Epoch 15/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1385 - acc: 0.9582
Epoch 16/27

8/8 [==============================] - 0s 44ms/step - loss: 0.1336 - acc: 0.9616
Epoch 17/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1204 - acc: 0.9633
Epoch 18/27

8/8 [==============================] - 0s 40ms/step - loss: 0.1178 - acc: 0.9638
Epoch 19/27

8/8 [==============================] - 0s 44ms/step - loss: 0.1138 - acc: 0.9638
Epoch 20/27

8/8 [==============================] - 0s 40ms/step - loss: 0.1106 - acc: 0.9644
Epoch 21/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1016 - acc: 0.9650
Epoch 22/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1082 - acc: 0.9638
Epoch 23/27

8/8 [==============================] - 0s 41ms/step - loss: 0.0969 - acc: 0.9650
Epoch 24/27

8/8 [==============================] - 0s 43ms/step - loss: 0.0913 - acc: 0.9655
Epoch 25/27

8/8 [==============================] - 0s 41ms/step - loss: 0.0935 - acc: 0.9667
Epoch 26/27

8/8 [==============================] - 0s 42ms/step - loss: 0.0870 - acc: 0.9729
Epoch 27/27

8/8 [==============================] - 0s 41ms/step - loss: 0.0908 - acc: 0.9734
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7102
False 1969
True percentage 0.782934626833
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.85      0.97      0.90      7318
      B-PER       0.00      0.00      0.00       438
      B-ORG       0.20      0.02      0.03       296
      I-ORG       0.09      0.12      0.10       151
      I-PER       0.00      0.00      0.00       214
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.69      0.78      0.73      9071

F-1 Score (without O):
0.023314749113
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 10
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 7 unique labels.
Found 104041 unique words.
4037 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 279
OOV word occurences: in test 469
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658688     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 8)        1112        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,520
Trainable params: 6,770,520
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 3s 381ms/step - loss: 0.4178 - acc: 0.8750
Epoch 2/27

8/8 [==============================] - 0s 45ms/step - loss: 0.3984 - acc: 0.8750
Epoch 3/27

8/8 [==============================] - 0s 42ms/step - loss: 0.3783 - acc: 0.8750
Epoch 4/27

8/8 [==============================] - 0s 42ms/step - loss: 0.3480 - acc: 0.8750
Epoch 5/27

8/8 [==============================] - 0s 41ms/step - loss: 0.3203 - acc: 0.8756
Epoch 6/27

8/8 [==============================] - 0s 41ms/step - loss: 0.2976 - acc: 0.8768
Epoch 7/27

8/8 [==============================] - 0s 41ms/step - loss: 0.2735 - acc: 0.8866
Epoch 8/27

8/8 [==============================] - 0s 43ms/step - loss: 0.2536 - acc: 0.8939
Epoch 9/27

8/8 [==============================] - 0s 40ms/step - loss: 0.2259 - acc: 0.9104
Epoch 10/27

8/8 [==============================] - 0s 40ms/step - loss: 0.2061 - acc: 0.9274
Epoch 11/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1808 - acc: 0.9439
Epoch 12/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1724 - acc: 0.9500
Epoch 13/27

8/8 [==============================] - 0s 40ms/step - loss: 0.1565 - acc: 0.9555
Epoch 14/27

8/8 [==============================] - 0s 42ms/step - loss: 0.1544 - acc: 0.9530
Epoch 15/27

8/8 [==============================] - 0s 42ms/step - loss: 0.1461 - acc: 0.9518
Epoch 16/27

8/8 [==============================] - 0s 44ms/step - loss: 0.1417 - acc: 0.9506
Epoch 17/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1359 - acc: 0.9506
Epoch 18/27

8/8 [==============================] - 0s 43ms/step - loss: 0.1313 - acc: 0.9537
Epoch 19/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1258 - acc: 0.9518
Epoch 20/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1144 - acc: 0.9561
Epoch 21/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1225 - acc: 0.9518
Epoch 22/27

8/8 [==============================] - 0s 42ms/step - loss: 0.1101 - acc: 0.9598
Epoch 23/27

8/8 [==============================] - 0s 43ms/step - loss: 0.1024 - acc: 0.9640
Epoch 24/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1021 - acc: 0.9665
Epoch 25/27

8/8 [==============================] - 0s 40ms/step - loss: 0.0952 - acc: 0.9689
Epoch 26/27

8/8 [==============================] - 0s 40ms/step - loss: 0.0976 - acc: 0.9683
Epoch 27/27

8/8 [==============================] - 0s 41ms/step - loss: 0.0929 - acc: 0.9683
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7199
False 1513
True percentage 0.826331496786
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.89      0.96      0.92      7318
      B-PER       0.24      0.30      0.27       438
      B-ORG       0.26      0.13      0.17       296
      I-ORG       0.00      0.00      0.00       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      I-PER       0.00      0.00      0.00       214

avg / total       0.77      0.83      0.80      8712

F-1 Score (without O):
0.161290322581
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 11
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 8 unique labels.
Found 104031 unique words.
4027 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 567
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658048     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,028
Trainable params: 6,770,028
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 3s 377ms/step - loss: 0.2591 - acc: 0.8938
Epoch 2/27

8/8 [==============================] - 0s 43ms/step - loss: 0.2383 - acc: 0.9001
Epoch 3/27

8/8 [==============================] - 0s 43ms/step - loss: 0.2160 - acc: 0.9036
Epoch 4/27

8/8 [==============================] - 0s 42ms/step - loss: 0.1919 - acc: 0.9203
Epoch 5/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1711 - acc: 0.9329
Epoch 6/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1549 - acc: 0.9518
Epoch 7/27

8/8 [==============================] - 0s 40ms/step - loss: 0.1369 - acc: 0.9630
Epoch 8/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1221 - acc: 0.9679
Epoch 9/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1107 - acc: 0.9713
Epoch 10/27

8/8 [==============================] - 0s 41ms/step - loss: 0.0988 - acc: 0.9755
Epoch 11/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0912 - acc: 0.9769
Epoch 12/27

8/8 [==============================] - 0s 42ms/step - loss: 0.0897 - acc: 0.9755
Epoch 13/27

8/8 [==============================] - 0s 41ms/step - loss: 0.0812 - acc: 0.9748
Epoch 14/27

8/8 [==============================] - 0s 41ms/step - loss: 0.0805 - acc: 0.9734
Epoch 15/27

8/8 [==============================] - 0s 44ms/step - loss: 0.0811 - acc: 0.9713
Epoch 16/27

8/8 [==============================] - 0s 44ms/step - loss: 0.0758 - acc: 0.9734
Epoch 17/27

8/8 [==============================] - 0s 41ms/step - loss: 0.0711 - acc: 0.9741
Epoch 18/27

8/8 [==============================] - 0s 40ms/step - loss: 0.0677 - acc: 0.9734
Epoch 19/27

8/8 [==============================] - 0s 40ms/step - loss: 0.0641 - acc: 0.9762
Epoch 20/27

8/8 [==============================] - 0s 41ms/step - loss: 0.0598 - acc: 0.9776
Epoch 21/27

8/8 [==============================] - 0s 42ms/step - loss: 0.0579 - acc: 0.9790
Epoch 22/27

8/8 [==============================] - 0s 42ms/step - loss: 0.0537 - acc: 0.9818
Epoch 23/27

8/8 [==============================] - 0s 43ms/step - loss: 0.0517 - acc: 0.9811
Epoch 24/27

8/8 [==============================] - 0s 40ms/step - loss: 0.0514 - acc: 0.9825
Epoch 25/27

8/8 [==============================] - 0s 42ms/step - loss: 0.0506 - acc: 0.9818
Epoch 26/27

8/8 [==============================] - 0s 39ms/step - loss: 0.0474 - acc: 0.9832
Epoch 27/27

8/8 [==============================] - 0s 42ms/step - loss: 0.0467 - acc: 0.9839
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7149
False 1771
True percentage 0.801457399103
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.20      0.43      0.27       296
          O       0.90      0.95      0.93      7318
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-PER       0.49      0.08      0.13       438
      I-PER       0.19      0.03      0.06       214
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141

avg / total       0.77      0.80      0.78      8920

F-1 Score (without O):
0.851221138113
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104032 unique words.
4028 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658112     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,242
Trainable params: 6,770,242
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 4s 455ms/step - loss: 0.3581 - acc: 0.9000
Epoch 2/27

8/8 [==============================] - 0s 44ms/step - loss: 0.3285 - acc: 0.9000
Epoch 3/27

8/8 [==============================] - 0s 45ms/step - loss: 0.3048 - acc: 0.9000
Epoch 4/27

8/8 [==============================] - 0s 43ms/step - loss: 0.2891 - acc: 0.9000
Epoch 5/27

8/8 [==============================] - 0s 42ms/step - loss: 0.2663 - acc: 0.9006
Epoch 6/27

8/8 [==============================] - 0s 42ms/step - loss: 0.2520 - acc: 0.9013
Epoch 7/27

8/8 [==============================] - 0s 41ms/step - loss: 0.2255 - acc: 0.9089
Epoch 8/27

8/8 [==============================] - 0s 41ms/step - loss: 0.2075 - acc: 0.9152
Epoch 9/27

8/8 [==============================] - 0s 44ms/step - loss: 0.1901 - acc: 0.9266
Epoch 10/27

8/8 [==============================] - 0s 45ms/step - loss: 0.1702 - acc: 0.9443
Epoch 11/27

8/8 [==============================] - 0s 42ms/step - loss: 0.1585 - acc: 0.9519
Epoch 12/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1430 - acc: 0.9633
Epoch 13/27

8/8 [==============================] - 0s 42ms/step - loss: 0.1269 - acc: 0.9703
Epoch 14/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1180 - acc: 0.9696
Epoch 15/27

8/8 [==============================] - 0s 42ms/step - loss: 0.1101 - acc: 0.9728
Epoch 16/27

8/8 [==============================] - 0s 43ms/step - loss: 0.1055 - acc: 0.9709
Epoch 17/27

8/8 [==============================] - 0s 44ms/step - loss: 0.1004 - acc: 0.9677
Epoch 18/27

8/8 [==============================] - 0s 41ms/step - loss: 0.0965 - acc: 0.9677
Epoch 19/27

8/8 [==============================] - 0s 42ms/step - loss: 0.0959 - acc: 0.9690
Epoch 20/27

8/8 [==============================] - 0s 40ms/step - loss: 0.0884 - acc: 0.9677
Epoch 21/27

8/8 [==============================] - 0s 40ms/step - loss: 0.0831 - acc: 0.9715
Epoch 22/27

8/8 [==============================] - 0s 42ms/step - loss: 0.0790 - acc: 0.9728
Epoch 23/27

8/8 [==============================] - 0s 41ms/step - loss: 0.0744 - acc: 0.9734
Epoch 24/27

8/8 [==============================] - 0s 43ms/step - loss: 0.0723 - acc: 0.9722
Epoch 25/27

8/8 [==============================] - 0s 42ms/step - loss: 0.0700 - acc: 0.9759
Epoch 26/27

8/8 [==============================] - 0s 43ms/step - loss: 0.0650 - acc: 0.9778
Epoch 27/27

8/8 [==============================] - 0s 40ms/step - loss: 0.0633 - acc: 0.9791
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7082
False 1989
True percentage 0.780729798258
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.66      0.10      0.17       438
      I-PER       0.00      0.00      0.00       214
          O       0.88      0.96      0.92      7318
      B-ORG       0.00      0.00      0.00       296
      B-LOC       0.00      0.00      0.00       218
      I-ORG       0.09      0.28      0.13       151
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.74      0.78      0.75      9071

F-1 Score (without O):
0.824673422764
