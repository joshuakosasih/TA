Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.4688 - acc: 0.8642
Epoch 2/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.2240 - acc: 0.9333
Epoch 3/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1694 - acc: 0.9502
Epoch 4/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1368 - acc: 0.9604
Epoch 5/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1186 - acc: 0.9664
Epoch 6/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1047 - acc: 0.9704
Epoch 7/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0927 - acc: 0.9732
Epoch 8/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0803 - acc: 0.9774
Epoch 9/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0741 - acc: 0.9797
Epoch 10/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0693 - acc: 0.9802
Epoch 11/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0616 - acc: 0.9824
Epoch 12/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0569 - acc: 0.9841
Epoch 13/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0529 - acc: 0.9853
Epoch 14/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0497 - acc: 0.9855
Epoch 15/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0457 - acc: 0.9871
Epoch 16/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0422 - acc: 0.9879
Epoch 17/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0421 - acc: 0.9879
Epoch 18/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0397 - acc: 0.9888
Epoch 19/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0363 - acc: 0.9895
Epoch 20/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0355 - acc: 0.9896
Epoch 21/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0331 - acc: 0.9909
Epoch 22/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0333 - acc: 0.9899
Epoch 23/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0292 - acc: 0.9919
Epoch 24/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0290 - acc: 0.9914
Epoch 25/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0281 - acc: 0.9917
Epoch 26/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0282 - acc: 0.9916
Epoch 27/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0254 - acc: 0.9932
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8244
False 827
True percentage 0.908830338441
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.90      0.82      0.86       438
      B-ORG       0.77      0.76      0.76       296
      I-ORG       0.66      0.66      0.66       151
      I-PER       0.90      0.66      0.76       214
      B-LOC       0.73      0.73      0.73       218
     B-MISC       0.40      0.30      0.34       141
      I-LOC       0.73      0.81      0.77       141
     I-MISC       0.55      0.45      0.49       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.720285969616
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.4741 - acc: 0.8640
Epoch 2/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.2258 - acc: 0.9322
Epoch 3/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1747 - acc: 0.9470
Epoch 4/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1460 - acc: 0.9567
Epoch 5/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1248 - acc: 0.9624
Epoch 6/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1076 - acc: 0.9686
Epoch 7/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0980 - acc: 0.9718
Epoch 8/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0878 - acc: 0.9748
Epoch 9/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0796 - acc: 0.9768
Epoch 10/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0715 - acc: 0.9798
Epoch 11/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0664 - acc: 0.9814
Epoch 12/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0594 - acc: 0.9840
Epoch 13/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0558 - acc: 0.9840
Epoch 14/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0515 - acc: 0.9856
Epoch 15/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0487 - acc: 0.9864
Epoch 16/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0459 - acc: 0.9875
Epoch 17/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0417 - acc: 0.9882
Epoch 18/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0398 - acc: 0.9888
Epoch 19/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0372 - acc: 0.9893
Epoch 20/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0373 - acc: 0.9896
Epoch 21/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0341 - acc: 0.9901
Epoch 22/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0335 - acc: 0.9905
Epoch 23/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0320 - acc: 0.9910
Epoch 24/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0310 - acc: 0.9906
Epoch 25/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0287 - acc: 0.9913
Epoch 26/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0285 - acc: 0.9917
Epoch 27/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0264 - acc: 0.9927
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8207
False 864
True percentage 0.904751405578
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.77      0.72      0.74       296
      I-ORG       0.64      0.56      0.60       151
      B-PER       0.91      0.82      0.86       438
      B-LOC       0.75      0.70      0.72       218
      I-LOC       0.73      0.79      0.76       141
      I-PER       0.89      0.64      0.74       214
     B-MISC       0.38      0.30      0.33       141
     I-MISC       0.49      0.45      0.47       154

avg / total       0.94      0.90      0.92      9071

F-1 Score (without O):
0.704394942806
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.4752 - acc: 0.8637
Epoch 2/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.2316 - acc: 0.9308
Epoch 3/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1755 - acc: 0.9460
Epoch 4/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1464 - acc: 0.9564
Epoch 5/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1275 - acc: 0.9631
Epoch 6/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1094 - acc: 0.9687
Epoch 7/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0979 - acc: 0.9709
Epoch 8/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0874 - acc: 0.9755
Epoch 9/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0801 - acc: 0.9774
Epoch 10/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0752 - acc: 0.9787
Epoch 11/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0680 - acc: 0.9805
Epoch 12/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0618 - acc: 0.9819
Epoch 13/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0569 - acc: 0.9832
Epoch 14/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0530 - acc: 0.9849
Epoch 15/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0504 - acc: 0.9864
Epoch 16/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0478 - acc: 0.9861
Epoch 17/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0440 - acc: 0.9876
Epoch 18/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0415 - acc: 0.9883
Epoch 19/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0384 - acc: 0.9895
Epoch 20/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0377 - acc: 0.9890
Epoch 21/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0353 - acc: 0.9905
Epoch 22/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0332 - acc: 0.9905
Epoch 23/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0325 - acc: 0.9905
Epoch 24/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0321 - acc: 0.9909
Epoch 25/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0300 - acc: 0.9913
Epoch 26/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0290 - acc: 0.9915
Epoch 27/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0260 - acc: 0.9928
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8243
False 828
True percentage 0.908720097012
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.93      0.82      0.87       438
      B-ORG       0.78      0.75      0.76       296
      I-ORG       0.66      0.63      0.64       151
     B-MISC       0.39      0.32      0.35       141
     I-MISC       0.49      0.45      0.47       154
      I-PER       0.94      0.64      0.76       214
      B-LOC       0.77      0.72      0.75       218
      I-LOC       0.76      0.78      0.77       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.718796992481
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.4671 - acc: 0.8652
Epoch 2/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.2273 - acc: 0.9324
Epoch 3/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1751 - acc: 0.9481
Epoch 4/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1452 - acc: 0.9566
Epoch 5/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1249 - acc: 0.9630
Epoch 6/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1111 - acc: 0.9682
Epoch 7/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0966 - acc: 0.9724
Epoch 8/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0877 - acc: 0.9750
Epoch 9/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0795 - acc: 0.9778
Epoch 10/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0711 - acc: 0.9795
Epoch 11/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0661 - acc: 0.9811
Epoch 12/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0627 - acc: 0.9828
Epoch 13/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0565 - acc: 0.9839
Epoch 14/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0544 - acc: 0.9846
Epoch 15/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0495 - acc: 0.9863
Epoch 16/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0476 - acc: 0.9869
Epoch 17/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0444 - acc: 0.9869
Epoch 18/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0423 - acc: 0.9884
Epoch 19/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0406 - acc: 0.9887
Epoch 20/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0370 - acc: 0.9899
Epoch 21/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0357 - acc: 0.9899
Epoch 22/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0336 - acc: 0.9903
Epoch 23/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0327 - acc: 0.9902
Epoch 24/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0314 - acc: 0.9910
Epoch 25/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0298 - acc: 0.9913
Epoch 26/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0281 - acc: 0.9922
Epoch 27/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0274 - acc: 0.9921
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8244
False 827
True percentage 0.908830338441
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
      B-ORG       0.75      0.76      0.76       296
      B-PER       0.91      0.83      0.87       438
      I-PER       0.89      0.64      0.74       214
      B-LOC       0.75      0.74      0.75       218
      I-LOC       0.73      0.80      0.76       141
      I-ORG       0.66      0.66      0.66       151
     B-MISC       0.43      0.35      0.39       141
     I-MISC       0.53      0.46      0.49       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.723227528923
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.4773 - acc: 0.8596
Epoch 2/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.2292 - acc: 0.9313
Epoch 3/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1748 - acc: 0.9472
Epoch 4/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1453 - acc: 0.9562
Epoch 5/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1243 - acc: 0.9634
Epoch 6/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1099 - acc: 0.9681
Epoch 7/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0969 - acc: 0.9720
Epoch 8/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0869 - acc: 0.9749
Epoch 9/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0799 - acc: 0.9771
Epoch 10/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0725 - acc: 0.9791
Epoch 11/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0674 - acc: 0.9809
Epoch 12/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0596 - acc: 0.9834
Epoch 13/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0567 - acc: 0.9844
Epoch 14/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0512 - acc: 0.9866
Epoch 15/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0475 - acc: 0.9868
Epoch 16/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0443 - acc: 0.9876
Epoch 17/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0413 - acc: 0.9889
Epoch 18/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0401 - acc: 0.9885
Epoch 19/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0364 - acc: 0.9897
Epoch 20/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0365 - acc: 0.9894
Epoch 21/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0350 - acc: 0.9901
Epoch 22/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0323 - acc: 0.9907
Epoch 23/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0307 - acc: 0.9918
Epoch 24/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0297 - acc: 0.9917
Epoch 25/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0286 - acc: 0.9921
Epoch 26/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0270 - acc: 0.9923
Epoch 27/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0266 - acc: 0.9919
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8262
False 809
True percentage 0.910814684158
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.88      0.84      0.86       438
          O       0.99      0.96      0.97      7318
      B-ORG       0.76      0.78      0.77       296
     B-MISC       0.45      0.30      0.36       141
      I-ORG       0.61      0.66      0.63       151
      I-PER       0.91      0.66      0.76       214
     I-MISC       0.56      0.46      0.51       154
      B-LOC       0.77      0.74      0.75       218
      I-LOC       0.77      0.83      0.80       141

avg / total       0.94      0.91      0.93      9071

F-1 Score (without O):
0.930676727187
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.4501 - acc: 0.8699
Epoch 2/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.2220 - acc: 0.9336
Epoch 3/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1697 - acc: 0.9493
Epoch 4/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1404 - acc: 0.9587
Epoch 5/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1211 - acc: 0.9653
Epoch 6/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1040 - acc: 0.9695
Epoch 7/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0933 - acc: 0.9730
Epoch 8/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0830 - acc: 0.9761
Epoch 9/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0758 - acc: 0.9789
Epoch 10/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0705 - acc: 0.9805
Epoch 11/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0648 - acc: 0.9813
Epoch 12/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0587 - acc: 0.9834
Epoch 13/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0568 - acc: 0.9836
Epoch 14/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0506 - acc: 0.9862
Epoch 15/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0477 - acc: 0.9866
Epoch 16/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0446 - acc: 0.9874
Epoch 17/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0426 - acc: 0.9882
Epoch 18/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0409 - acc: 0.9888
Epoch 19/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0373 - acc: 0.9898
Epoch 20/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0369 - acc: 0.9891
Epoch 21/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0343 - acc: 0.9902
Epoch 22/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0336 - acc: 0.9897
Epoch 23/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0321 - acc: 0.9909
Epoch 24/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0297 - acc: 0.9911
Epoch 25/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0277 - acc: 0.9926
Epoch 26/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0282 - acc: 0.9919
Epoch 27/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0266 - acc: 0.9925
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8227
False 844
True percentage 0.906956234153
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.92      0.80      0.86       438
      B-ORG       0.77      0.76      0.76       296
      I-ORG       0.60      0.64      0.62       151
      B-LOC       0.75      0.73      0.74       218
      I-PER       0.91      0.64      0.75       214
     B-MISC       0.41      0.34      0.37       141
      I-LOC       0.73      0.77      0.75       141
     I-MISC       0.53      0.47      0.50       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.713987473904
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.4516 - acc: 0.8659
Epoch 2/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.2245 - acc: 0.9322
Epoch 3/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1723 - acc: 0.9487
Epoch 4/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1422 - acc: 0.9583
Epoch 5/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1236 - acc: 0.9651
Epoch 6/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1062 - acc: 0.9688
Epoch 7/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0963 - acc: 0.9729
Epoch 8/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0850 - acc: 0.9760
Epoch 9/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0782 - acc: 0.9777
Epoch 10/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0705 - acc: 0.9799
Epoch 11/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0639 - acc: 0.9824
Epoch 12/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0602 - acc: 0.9826
Epoch 13/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0552 - acc: 0.9836
Epoch 14/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0520 - acc: 0.9853
Epoch 15/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0484 - acc: 0.9863
Epoch 16/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0449 - acc: 0.9867
Epoch 17/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0434 - acc: 0.9874
Epoch 18/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0409 - acc: 0.9883
Epoch 19/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0390 - acc: 0.9888
Epoch 20/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0360 - acc: 0.9893
Epoch 21/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0343 - acc: 0.9892
Epoch 22/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0326 - acc: 0.9905
Epoch 23/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0317 - acc: 0.9908
Epoch 24/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0292 - acc: 0.9914
Epoch 25/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0278 - acc: 0.9919
Epoch 26/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0290 - acc: 0.9916
Epoch 27/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0274 - acc: 0.9919
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8244
False 827
True percentage 0.908830338441
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.92      0.82      0.87       438
      I-PER       0.91      0.65      0.76       214
      B-ORG       0.76      0.76      0.76       296
      I-ORG       0.65      0.64      0.65       151
      B-LOC       0.73      0.76      0.74       218
     B-MISC       0.43      0.28      0.34       141
     I-MISC       0.57      0.39      0.46       154
      I-LOC       0.75      0.82      0.78       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.723007518797
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.4616 - acc: 0.8662
Epoch 2/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.2244 - acc: 0.9314
Epoch 3/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1736 - acc: 0.9475
Epoch 4/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1441 - acc: 0.9568
Epoch 5/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1239 - acc: 0.9646
Epoch 6/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1081 - acc: 0.9687
Epoch 7/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0971 - acc: 0.9724
Epoch 8/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0854 - acc: 0.9751
Epoch 9/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0790 - acc: 0.9766
Epoch 10/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0720 - acc: 0.9798
Epoch 11/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0663 - acc: 0.9815
Epoch 12/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0609 - acc: 0.9829
Epoch 13/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0589 - acc: 0.9829
Epoch 14/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0539 - acc: 0.9841
Epoch 15/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0497 - acc: 0.9865
Epoch 16/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0469 - acc: 0.9869
Epoch 17/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0438 - acc: 0.9873
Epoch 18/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0421 - acc: 0.9873
Epoch 19/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0395 - acc: 0.9888
Epoch 20/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0370 - acc: 0.9902
Epoch 21/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0354 - acc: 0.9899
Epoch 22/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0347 - acc: 0.9897
Epoch 23/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0321 - acc: 0.9910
Epoch 24/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0303 - acc: 0.9910
Epoch 25/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0295 - acc: 0.9911
Epoch 26/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0285 - acc: 0.9912
Epoch 27/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0281 - acc: 0.9919
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8251
False 820
True percentage 0.909602028442
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
     B-MISC       0.47      0.29      0.36       141
     I-MISC       0.56      0.39      0.46       154
      B-ORG       0.74      0.76      0.75       296
      B-LOC       0.78      0.74      0.76       218
      B-PER       0.91      0.84      0.87       438
      I-PER       0.91      0.65      0.76       214
      I-ORG       0.62      0.70      0.66       151
      I-LOC       0.79      0.78      0.78       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.727654469106
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 8
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.4522 - acc: 0.8684
Epoch 2/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.2225 - acc: 0.9328
Epoch 3/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1698 - acc: 0.9497
Epoch 4/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1434 - acc: 0.9574
Epoch 5/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1253 - acc: 0.9628
Epoch 6/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1084 - acc: 0.9692
Epoch 7/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0965 - acc: 0.9732
Epoch 8/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0879 - acc: 0.9751
Epoch 9/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0785 - acc: 0.9779
Epoch 10/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0718 - acc: 0.9798
Epoch 11/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0650 - acc: 0.9818
Epoch 12/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0608 - acc: 0.9824
Epoch 13/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0561 - acc: 0.9843
Epoch 14/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0521 - acc: 0.9850
Epoch 15/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0498 - acc: 0.9858
Epoch 16/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0450 - acc: 0.9869
Epoch 17/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0432 - acc: 0.9874
Epoch 18/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0404 - acc: 0.9885
Epoch 19/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0388 - acc: 0.9888
Epoch 20/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0362 - acc: 0.9901
Epoch 21/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0339 - acc: 0.9903
Epoch 22/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0345 - acc: 0.9902
Epoch 23/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0302 - acc: 0.9916
Epoch 24/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0287 - acc: 0.9918
Epoch 25/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0287 - acc: 0.9917
Epoch 26/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0286 - acc: 0.9921
Epoch 27/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0261 - acc: 0.9927
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8249
False 822
True percentage 0.909381545585
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
     B-MISC       0.40      0.28      0.33       141
      B-ORG       0.76      0.73      0.75       296
      B-PER       0.93      0.84      0.88       438
     I-MISC       0.54      0.45      0.49       154
      I-PER       0.94      0.64      0.76       214
      I-ORG       0.65      0.63      0.64       151
      B-LOC       0.73      0.77      0.75       218
      I-LOC       0.72      0.80      0.76       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.723302422973
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 9
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.4764 - acc: 0.8614
Epoch 2/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.2343 - acc: 0.9297
Epoch 3/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1772 - acc: 0.9478
Epoch 4/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1474 - acc: 0.9564
Epoch 5/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1266 - acc: 0.9634
Epoch 6/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1091 - acc: 0.9680
Epoch 7/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0977 - acc: 0.9720
Epoch 8/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0890 - acc: 0.9744
Epoch 9/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0801 - acc: 0.9778
Epoch 10/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0741 - acc: 0.9791
Epoch 11/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0649 - acc: 0.9821
Epoch 12/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0640 - acc: 0.9818
Epoch 13/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0567 - acc: 0.9844
Epoch 14/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0535 - acc: 0.9850
Epoch 15/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0502 - acc: 0.9862
Epoch 16/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0466 - acc: 0.9869
Epoch 17/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0438 - acc: 0.9874
Epoch 18/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0397 - acc: 0.9896
Epoch 19/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0401 - acc: 0.9884
Epoch 20/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0383 - acc: 0.9892
Epoch 21/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0356 - acc: 0.9898
Epoch 22/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0331 - acc: 0.9902
Epoch 23/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0314 - acc: 0.9913
Epoch 24/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0313 - acc: 0.9913
Epoch 25/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0306 - acc: 0.9914
Epoch 26/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0289 - acc: 0.9913
Epoch 27/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0281 - acc: 0.9922
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8241
False 830
True percentage 0.908499614155
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.90      0.83      0.86       438
      B-ORG       0.78      0.73      0.75       296
      I-ORG       0.66      0.68      0.67       151
      I-PER       0.93      0.65      0.77       214
      B-LOC       0.76      0.75      0.76       218
      I-LOC       0.77      0.79      0.78       141
     B-MISC       0.40      0.30      0.34       141
     I-MISC       0.50      0.42      0.46       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.722205573869
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 10
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.4483 - acc: 0.8686
Epoch 2/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.2212 - acc: 0.9327
Epoch 3/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1735 - acc: 0.9476
Epoch 4/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1437 - acc: 0.9563
Epoch 5/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1256 - acc: 0.9637
Epoch 6/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1114 - acc: 0.9680
Epoch 7/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0968 - acc: 0.9723
Epoch 8/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0883 - acc: 0.9746
Epoch 9/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0815 - acc: 0.9768
Epoch 10/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0715 - acc: 0.9800
Epoch 11/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0672 - acc: 0.9811
Epoch 12/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0620 - acc: 0.9825
Epoch 13/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0583 - acc: 0.9837
Epoch 14/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0536 - acc: 0.9843
Epoch 15/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0502 - acc: 0.9858
Epoch 16/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0455 - acc: 0.9875
Epoch 17/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0431 - acc: 0.9878
Epoch 18/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0418 - acc: 0.9881
Epoch 19/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0386 - acc: 0.9887
Epoch 20/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0357 - acc: 0.9897
Epoch 21/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0347 - acc: 0.9896
Epoch 22/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0342 - acc: 0.9902
Epoch 23/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0322 - acc: 0.9904
Epoch 24/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0298 - acc: 0.9913
Epoch 25/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0305 - acc: 0.9912
Epoch 26/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0284 - acc: 0.9913
Epoch 27/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0271 - acc: 0.9922
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8266
False 805
True percentage 0.911255649873
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.90      0.84      0.87       438
      B-ORG       0.74      0.77      0.75       296
      I-ORG       0.64      0.68      0.66       151
     B-MISC       0.47      0.30      0.37       141
     I-MISC       0.61      0.38      0.47       154
      I-PER       0.93      0.66      0.77       214
      B-LOC       0.78      0.73      0.76       218
      I-LOC       0.74      0.81      0.77       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.730769230769
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 11
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.4311 - acc: 0.8764
Epoch 2/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.2156 - acc: 0.9336
Epoch 3/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1657 - acc: 0.9497
Epoch 4/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1408 - acc: 0.9593
Epoch 5/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1215 - acc: 0.9641
Epoch 6/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1069 - acc: 0.9693
Epoch 7/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0950 - acc: 0.9727
Epoch 8/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0836 - acc: 0.9766
Epoch 9/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0755 - acc: 0.9789
Epoch 10/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0692 - acc: 0.9803
Epoch 11/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0627 - acc: 0.9823
Epoch 12/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0592 - acc: 0.9835
Epoch 13/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0563 - acc: 0.9842
Epoch 14/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0529 - acc: 0.9848
Epoch 15/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0473 - acc: 0.9868
Epoch 16/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0451 - acc: 0.9872
Epoch 17/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0427 - acc: 0.9879
Epoch 18/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0403 - acc: 0.9886
Epoch 19/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0370 - acc: 0.9900
Epoch 20/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0359 - acc: 0.9895
Epoch 21/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0341 - acc: 0.9895
Epoch 22/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0315 - acc: 0.9909
Epoch 23/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0308 - acc: 0.9906
Epoch 24/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0307 - acc: 0.9907
Epoch 25/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0291 - acc: 0.9912
Epoch 26/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0272 - acc: 0.9923
Epoch 27/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0263 - acc: 0.9924
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8246
False 825
True percentage 0.909050821299
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.77      0.75      0.76       296
          O       0.98      0.96      0.97      7318
     B-MISC       0.41      0.35      0.38       141
     I-MISC       0.51      0.46      0.48       154
      B-PER       0.90      0.83      0.86       438
      I-PER       0.91      0.64      0.75       214
      B-LOC       0.78      0.73      0.75       218
      I-LOC       0.77      0.79      0.78       141
      I-ORG       0.64      0.66      0.65       151

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.931298595799
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.4424 - acc: 0.8715
Epoch 2/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.2139 - acc: 0.9368
Epoch 3/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1619 - acc: 0.9522
Epoch 4/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1352 - acc: 0.9622
Epoch 5/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1147 - acc: 0.9671
Epoch 6/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0991 - acc: 0.9712
Epoch 7/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0884 - acc: 0.9743
Epoch 8/27

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0782 - acc: 0.9782
Epoch 9/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0720 - acc: 0.9794
Epoch 10/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0643 - acc: 0.9817
Epoch 11/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0609 - acc: 0.9832
Epoch 12/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0573 - acc: 0.9849
Epoch 13/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0514 - acc: 0.9854
Epoch 14/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0483 - acc: 0.9862
Epoch 15/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0450 - acc: 0.9870
Epoch 16/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0416 - acc: 0.9880
Epoch 17/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0396 - acc: 0.9887
Epoch 18/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0365 - acc: 0.9896
Epoch 19/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0358 - acc: 0.9901
Epoch 20/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0339 - acc: 0.9900
Epoch 21/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0327 - acc: 0.9907
Epoch 22/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0302 - acc: 0.9917
Epoch 23/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0292 - acc: 0.9917
Epoch 24/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0275 - acc: 0.9924
Epoch 25/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0264 - acc: 0.9923
Epoch 26/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0269 - acc: 0.9918
Epoch 27/27

1674/1674 [==============================] - 41s 25ms/step - loss: 0.0250 - acc: 0.9929
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8245
False 826
True percentage 0.90894057987
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.90      0.83      0.87       438
      I-PER       0.91      0.66      0.77       214
          O       0.98      0.96      0.97      7318
      B-ORG       0.76      0.75      0.76       296
      B-LOC       0.75      0.76      0.76       218
      I-ORG       0.68      0.66      0.67       151
      I-LOC       0.73      0.82      0.77       141
     B-MISC       0.39      0.26      0.31       141
     I-MISC       0.53      0.39      0.45       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.928424153166
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100836 unique words.
Found 94 unique chars.
Found 9 unique labels.
832 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 256
OOV word occurences: 362
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6453568     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,560,130
Trainable params: 6,560,130
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 25s 30ms/step - loss: 0.5702 - acc: 0.8386
Epoch 2/27

837/837 [==============================] - 21s 26ms/step - loss: 0.2807 - acc: 0.9161
Epoch 3/27

837/837 [==============================] - 21s 25ms/step - loss: 0.2160 - acc: 0.9367
Epoch 4/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1763 - acc: 0.9478
Epoch 5/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1470 - acc: 0.9581
Epoch 6/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1251 - acc: 0.9649
Epoch 7/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1109 - acc: 0.9688
Epoch 8/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0992 - acc: 0.9725
Epoch 9/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0915 - acc: 0.9754
Epoch 10/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0799 - acc: 0.9781
Epoch 11/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0736 - acc: 0.9801
Epoch 12/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0666 - acc: 0.9828
Epoch 13/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0617 - acc: 0.9841
Epoch 14/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0557 - acc: 0.9858
Epoch 15/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0529 - acc: 0.9869
Epoch 16/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0483 - acc: 0.9878
Epoch 17/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0452 - acc: 0.9894
Epoch 18/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0442 - acc: 0.9884
Epoch 19/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0419 - acc: 0.9886
Epoch 20/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0371 - acc: 0.9902
Epoch 21/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0355 - acc: 0.9914
Epoch 22/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0328 - acc: 0.9914
Epoch 23/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0311 - acc: 0.9927
Epoch 24/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0288 - acc: 0.9927
Epoch 25/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0275 - acc: 0.9931
Epoch 26/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0277 - acc: 0.9930
Epoch 27/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0286 - acc: 0.9924
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8186
False 885
True percentage 0.902436335575
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.92      0.83      0.87       438
      B-ORG       0.79      0.69      0.74       296
      I-ORG       0.65      0.54      0.59       151
      I-PER       0.91      0.59      0.72       214
      B-LOC       0.72      0.79      0.76       218
     B-MISC       0.42      0.30      0.35       141
      I-LOC       0.70      0.80      0.75       141
     I-MISC       0.47      0.47      0.47       154

avg / total       0.94      0.90      0.92      9071

F-1 Score (without O):
0.708358388455
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 100808 unique words.
Found 94 unique chars.
Found 9 unique labels.
804 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 253
OOV word occurences: 387
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6451776     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,558,338
Trainable params: 6,558,338
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 25s 30ms/step - loss: 0.5780 - acc: 0.8385
Epoch 2/27

837/837 [==============================] - 21s 25ms/step - loss: 0.2933 - acc: 0.9131
Epoch 3/27

837/837 [==============================] - 21s 25ms/step - loss: 0.2205 - acc: 0.9351
Epoch 4/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1778 - acc: 0.9476
Epoch 5/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1515 - acc: 0.9553
Epoch 6/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1325 - acc: 0.9618
Epoch 7/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1144 - acc: 0.9683
Epoch 8/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1037 - acc: 0.9714
Epoch 9/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0933 - acc: 0.9751
Epoch 10/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0823 - acc: 0.9777
Epoch 11/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0758 - acc: 0.9800
Epoch 12/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0669 - acc: 0.9825
Epoch 13/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0626 - acc: 0.9829
Epoch 14/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0577 - acc: 0.9842
Epoch 15/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0520 - acc: 0.9867
Epoch 16/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0474 - acc: 0.9881
Epoch 17/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0449 - acc: 0.9887
Epoch 18/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0417 - acc: 0.9897
Epoch 19/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0379 - acc: 0.9905
Epoch 20/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0351 - acc: 0.9912
Epoch 21/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0352 - acc: 0.9916
Epoch 22/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0326 - acc: 0.9924
Epoch 23/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0315 - acc: 0.9917
Epoch 24/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0288 - acc: 0.9927
Epoch 25/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0279 - acc: 0.9932
Epoch 26/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0259 - acc: 0.9933
Epoch 27/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0256 - acc: 0.9930
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8122
False 949
True percentage 0.895380884136
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.74      0.74      0.74       296
      I-ORG       0.62      0.56      0.59       151
      B-PER       0.88      0.74      0.80       438
      B-LOC       0.74      0.68      0.71       218
      I-LOC       0.79      0.74      0.77       141
      I-PER       0.91      0.60      0.72       214
     B-MISC       0.34      0.23      0.27       141
     I-MISC       0.49      0.44      0.46       154

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.680994780473
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100788 unique words.
Found 94 unique chars.
Found 9 unique labels.
784 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 261
OOV word occurences: 373
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6450496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,557,058
Trainable params: 6,557,058
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 25s 30ms/step - loss: 0.6396 - acc: 0.8184
Epoch 2/27

837/837 [==============================] - 21s 25ms/step - loss: 0.3257 - acc: 0.9035
Epoch 3/27

837/837 [==============================] - 21s 25ms/step - loss: 0.2336 - acc: 0.9334
Epoch 4/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1877 - acc: 0.9459
Epoch 5/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1617 - acc: 0.9558
Epoch 6/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1373 - acc: 0.9615
Epoch 7/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1239 - acc: 0.9650
Epoch 8/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1079 - acc: 0.9703
Epoch 9/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0963 - acc: 0.9738
Epoch 10/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0879 - acc: 0.9772
Epoch 11/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0819 - acc: 0.9781
Epoch 12/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0733 - acc: 0.9804
Epoch 13/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0670 - acc: 0.9826
Epoch 14/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0617 - acc: 0.9832
Epoch 15/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0580 - acc: 0.9835
Epoch 16/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0532 - acc: 0.9860
Epoch 17/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0520 - acc: 0.9854
Epoch 18/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0468 - acc: 0.9879
Epoch 19/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0443 - acc: 0.9882
Epoch 20/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0408 - acc: 0.9885
Epoch 21/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0400 - acc: 0.9889
Epoch 22/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0372 - acc: 0.9894
Epoch 23/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0346 - acc: 0.9908
Epoch 24/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0344 - acc: 0.9904
Epoch 25/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0310 - acc: 0.9923
Epoch 26/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0302 - acc: 0.9920
Epoch 27/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0270 - acc: 0.9935
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8158
False 913
True percentage 0.89934957557
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.89      0.79      0.84       438
      B-ORG       0.75      0.74      0.75       296
      I-ORG       0.61      0.52      0.56       151
     B-MISC       0.43      0.29      0.35       141
     I-MISC       0.47      0.41      0.44       154
      I-PER       0.90      0.62      0.74       214
      B-LOC       0.75      0.71      0.73       218
      I-LOC       0.79      0.78      0.79       141

avg / total       0.93      0.90      0.92      9071

F-1 Score (without O):
0.699330493001
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 100784 unique words.
Found 94 unique chars.
Found 9 unique labels.
780 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 262
OOV word occurences: 376
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6450240     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,556,802
Trainable params: 6,556,802
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 25s 30ms/step - loss: 0.6007 - acc: 0.8288
Epoch 2/27

837/837 [==============================] - 21s 26ms/step - loss: 0.2903 - acc: 0.9143
Epoch 3/27

837/837 [==============================] - 21s 25ms/step - loss: 0.2151 - acc: 0.9375
Epoch 4/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1749 - acc: 0.9502
Epoch 5/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1493 - acc: 0.9573
Epoch 6/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1312 - acc: 0.9630
Epoch 7/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1168 - acc: 0.9674
Epoch 8/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1023 - acc: 0.9722
Epoch 9/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0927 - acc: 0.9747
Epoch 10/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0818 - acc: 0.9788
Epoch 11/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0755 - acc: 0.9807
Epoch 12/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0680 - acc: 0.9829
Epoch 13/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0642 - acc: 0.9831
Epoch 14/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0592 - acc: 0.9848
Epoch 15/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0553 - acc: 0.9859
Epoch 16/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0496 - acc: 0.9869
Epoch 17/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0455 - acc: 0.9884
Epoch 18/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0432 - acc: 0.9893
Epoch 19/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0412 - acc: 0.9895
Epoch 20/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0380 - acc: 0.9901
Epoch 21/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0360 - acc: 0.9910
Epoch 22/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0341 - acc: 0.9911
Epoch 23/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0343 - acc: 0.9903
Epoch 24/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0301 - acc: 0.9929
Epoch 25/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0306 - acc: 0.9916
Epoch 26/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0279 - acc: 0.9923
Epoch 27/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0269 - acc: 0.9927
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8141
False 930
True percentage 0.897475471282
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.74      0.74      0.74       296
      B-PER       0.90      0.77      0.83       438
      I-PER       0.86      0.61      0.72       214
      B-LOC       0.74      0.67      0.71       218
      I-LOC       0.81      0.77      0.79       141
      I-ORG       0.60      0.63      0.61       151
     B-MISC       0.43      0.28      0.34       141
     I-MISC       0.41      0.33      0.37       154

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.687824229478
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 100817 unique words.
Found 94 unique chars.
Found 9 unique labels.
813 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 255
OOV word occurences: 395
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6452352     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,558,914
Trainable params: 6,558,914
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 25s 30ms/step - loss: 0.6084 - acc: 0.8234
Epoch 2/27

837/837 [==============================] - 21s 25ms/step - loss: 0.3088 - acc: 0.9065
Epoch 3/27

837/837 [==============================] - 21s 25ms/step - loss: 0.2277 - acc: 0.9318
Epoch 4/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1821 - acc: 0.9460
Epoch 5/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1572 - acc: 0.9543
Epoch 6/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1395 - acc: 0.9591
Epoch 7/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1226 - acc: 0.9643
Epoch 8/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1098 - acc: 0.9700
Epoch 9/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0997 - acc: 0.9732
Epoch 10/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0896 - acc: 0.9768
Epoch 11/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0818 - acc: 0.9778
Epoch 12/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0754 - acc: 0.9794
Epoch 13/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0669 - acc: 0.9817
Epoch 14/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0636 - acc: 0.9837
Epoch 15/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0585 - acc: 0.9841
Epoch 16/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0537 - acc: 0.9860
Epoch 17/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0509 - acc: 0.9868
Epoch 18/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0464 - acc: 0.9882
Epoch 19/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0448 - acc: 0.9879
Epoch 20/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0426 - acc: 0.9887
Epoch 21/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0395 - acc: 0.9901
Epoch 22/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0356 - acc: 0.9902
Epoch 23/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0346 - acc: 0.9911
Epoch 24/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0324 - acc: 0.9917
Epoch 25/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0310 - acc: 0.9924
Epoch 26/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0300 - acc: 0.9924
Epoch 27/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0281 - acc: 0.9929
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8128
False 943
True percentage 0.896042332709
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.90      0.72      0.80       438
          O       0.98      0.96      0.97      7318
      B-ORG       0.75      0.72      0.73       296
     B-MISC       0.37      0.26      0.30       141
      I-ORG       0.68      0.57      0.62       151
      I-PER       0.91      0.61      0.73       214
     I-MISC       0.52      0.47      0.50       154
      B-LOC       0.76      0.68      0.72       218
      I-LOC       0.72      0.79      0.75       141

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.921380123857
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 100800 unique words.
Found 94 unique chars.
Found 9 unique labels.
796 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 259
OOV word occurences: 369
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6451264     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,557,826
Trainable params: 6,557,826
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 25s 30ms/step - loss: 0.6198 - acc: 0.8198
Epoch 2/27

837/837 [==============================] - 21s 26ms/step - loss: 0.3100 - acc: 0.9080
Epoch 3/27

837/837 [==============================] - 21s 25ms/step - loss: 0.2330 - acc: 0.9303
Epoch 4/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1897 - acc: 0.9450
Epoch 5/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1609 - acc: 0.9540
Epoch 6/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1402 - acc: 0.9608
Epoch 7/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1247 - acc: 0.9654
Epoch 8/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1107 - acc: 0.9691
Epoch 9/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0950 - acc: 0.9747
Epoch 10/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0877 - acc: 0.9751
Epoch 11/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0797 - acc: 0.9787
Epoch 12/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0736 - acc: 0.9792
Epoch 13/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0678 - acc: 0.9816
Epoch 14/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0634 - acc: 0.9822
Epoch 15/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0586 - acc: 0.9843
Epoch 16/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0513 - acc: 0.9863
Epoch 17/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0495 - acc: 0.9870
Epoch 18/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0458 - acc: 0.9886
Epoch 19/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0424 - acc: 0.9893
Epoch 20/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0392 - acc: 0.9898
Epoch 21/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0368 - acc: 0.9905
Epoch 22/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0376 - acc: 0.9902
Epoch 23/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0350 - acc: 0.9904
Epoch 24/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0321 - acc: 0.9914
Epoch 25/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0324 - acc: 0.9919
Epoch 26/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0300 - acc: 0.9918
Epoch 27/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0295 - acc: 0.9921
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8131
False 940
True percentage 0.896373056995
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.89      0.80      0.85       438
      B-ORG       0.75      0.72      0.73       296
      I-ORG       0.53      0.46      0.49       151
      B-LOC       0.73      0.70      0.72       218
      I-PER       0.90      0.63      0.74       214
     B-MISC       0.40      0.25      0.31       141
      I-LOC       0.71      0.78      0.74       141
     I-MISC       0.40      0.36      0.38       154

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.679176755448
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 100824 unique words.
Found 94 unique chars.
Found 9 unique labels.
820 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 254
OOV word occurences: 370
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6452800     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,559,362
Trainable params: 6,559,362
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 25s 30ms/step - loss: 0.6131 - acc: 0.8240
Epoch 2/27

837/837 [==============================] - 21s 26ms/step - loss: 0.3135 - acc: 0.9049
Epoch 3/27

837/837 [==============================] - 21s 25ms/step - loss: 0.2316 - acc: 0.9313
Epoch 4/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1854 - acc: 0.9456
Epoch 5/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1555 - acc: 0.9552
Epoch 6/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1388 - acc: 0.9619
Epoch 7/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1227 - acc: 0.9666
Epoch 8/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1103 - acc: 0.9699
Epoch 9/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0988 - acc: 0.9735
Epoch 10/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0919 - acc: 0.9759
Epoch 11/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0814 - acc: 0.9800
Epoch 12/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0748 - acc: 0.9813
Epoch 13/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0697 - acc: 0.9818
Epoch 14/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0650 - acc: 0.9836
Epoch 15/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0575 - acc: 0.9862
Epoch 16/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0561 - acc: 0.9863
Epoch 17/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0513 - acc: 0.9869
Epoch 18/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0490 - acc: 0.9879
Epoch 19/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0454 - acc: 0.9890
Epoch 20/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0417 - acc: 0.9904
Epoch 21/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0408 - acc: 0.9900
Epoch 22/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0385 - acc: 0.9904
Epoch 23/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0366 - acc: 0.9903
Epoch 24/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0318 - acc: 0.9923
Epoch 25/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0325 - acc: 0.9914
Epoch 26/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0308 - acc: 0.9915
Epoch 27/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0289 - acc: 0.9925
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8147
False 924
True percentage 0.898136919854
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.88      0.74      0.80       438
      I-PER       0.91      0.61      0.73       214
      B-ORG       0.79      0.72      0.75       296
      I-ORG       0.67      0.62      0.64       151
      B-LOC       0.73      0.72      0.73       218
     B-MISC       0.37      0.27      0.31       141
     I-MISC       0.44      0.42      0.43       154
      I-LOC       0.79      0.74      0.76       141

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.688474472638
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 100841 unique words.
Found 94 unique chars.
Found 9 unique labels.
837 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 258
OOV word occurences: 402
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6453888     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,560,450
Trainable params: 6,560,450
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 25s 30ms/step - loss: 0.6045 - acc: 0.8340
Epoch 2/27

837/837 [==============================] - 21s 25ms/step - loss: 0.3180 - acc: 0.9016
Epoch 3/27

837/837 [==============================] - 21s 25ms/step - loss: 0.2400 - acc: 0.9274
Epoch 4/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1940 - acc: 0.9429
Epoch 5/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1657 - acc: 0.9519
Epoch 6/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1436 - acc: 0.9599
Epoch 7/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1228 - acc: 0.9659
Epoch 8/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1124 - acc: 0.9680
Epoch 9/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1002 - acc: 0.9726
Epoch 10/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0876 - acc: 0.9772
Epoch 11/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0800 - acc: 0.9795
Epoch 12/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0758 - acc: 0.9799
Epoch 13/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0685 - acc: 0.9822
Epoch 14/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0652 - acc: 0.9829
Epoch 15/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0601 - acc: 0.9842
Epoch 16/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0534 - acc: 0.9871
Epoch 17/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0521 - acc: 0.9858
Epoch 18/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0484 - acc: 0.9876
Epoch 19/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0433 - acc: 0.9894
Epoch 20/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0404 - acc: 0.9906
Epoch 21/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0401 - acc: 0.9886
Epoch 22/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0387 - acc: 0.9900
Epoch 23/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0374 - acc: 0.9904
Epoch 24/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0356 - acc: 0.9910
Epoch 25/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0306 - acc: 0.9925
Epoch 26/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0310 - acc: 0.9925
Epoch 27/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0302 - acc: 0.9925
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8064
False 1007
True percentage 0.88898688127
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
     B-MISC       0.32      0.33      0.32       141
     I-MISC       0.39      0.46      0.42       154
      B-ORG       0.74      0.62      0.68       296
      B-LOC       0.75      0.70      0.73       218
      B-PER       0.90      0.71      0.79       438
      I-PER       0.92      0.62      0.74       214
      I-ORG       0.52      0.38      0.44       151
      I-LOC       0.73      0.77      0.75       141

avg / total       0.93      0.89      0.91      9071

F-1 Score (without O):
0.648385131018
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 8
Found 100004 word vectors.
Found 84 char vectors.
Found 100822 unique words.
Found 94 unique chars.
Found 9 unique labels.
818 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 252
OOV word occurences: 386
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6452672     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,559,234
Trainable params: 6,559,234
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 25s 30ms/step - loss: 0.5765 - acc: 0.8325
Epoch 2/27

837/837 [==============================] - 21s 26ms/step - loss: 0.2910 - acc: 0.9115
Epoch 3/27

837/837 [==============================] - 21s 25ms/step - loss: 0.2197 - acc: 0.9333
Epoch 4/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1772 - acc: 0.9466
Epoch 5/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1520 - acc: 0.9545
Epoch 6/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1324 - acc: 0.9613
Epoch 7/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1137 - acc: 0.9675
Epoch 8/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1017 - acc: 0.9726
Epoch 9/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0902 - acc: 0.9764
Epoch 10/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0827 - acc: 0.9776
Epoch 11/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0735 - acc: 0.9801
Epoch 12/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0663 - acc: 0.9827
Epoch 13/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0606 - acc: 0.9840
Epoch 14/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0562 - acc: 0.9861
Epoch 15/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0531 - acc: 0.9861
Epoch 16/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0472 - acc: 0.9876
Epoch 17/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0451 - acc: 0.9875
Epoch 18/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0436 - acc: 0.9883
Epoch 19/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0412 - acc: 0.9890
Epoch 20/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0388 - acc: 0.9897
Epoch 21/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0356 - acc: 0.9910
Epoch 22/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0325 - acc: 0.9913
Epoch 23/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0315 - acc: 0.9925
Epoch 24/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0284 - acc: 0.9932
Epoch 25/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0263 - acc: 0.9939
Epoch 26/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0258 - acc: 0.9933
Epoch 27/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0257 - acc: 0.9930
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8141
False 930
True percentage 0.897475471282
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
     B-MISC       0.35      0.28      0.31       141
      B-ORG       0.74      0.67      0.71       296
      B-PER       0.88      0.74      0.80       438
     I-MISC       0.56      0.50      0.53       154
      I-PER       0.87      0.64      0.74       214
      I-ORG       0.62      0.57      0.59       151
      B-LOC       0.72      0.74      0.73       218
      I-LOC       0.71      0.80      0.75       141

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.686540198735
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 9
Found 100004 word vectors.
Found 84 char vectors.
Found 100794 unique words.
Found 94 unique chars.
Found 9 unique labels.
790 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 257
OOV word occurences: 394
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6450880     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,557,442
Trainable params: 6,557,442
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 25s 30ms/step - loss: 0.5943 - acc: 0.8256
Epoch 2/27

837/837 [==============================] - 21s 26ms/step - loss: 0.2957 - acc: 0.9104
Epoch 3/27

837/837 [==============================] - 21s 25ms/step - loss: 0.2192 - acc: 0.9347
Epoch 4/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1811 - acc: 0.9472
Epoch 5/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1497 - acc: 0.9568
Epoch 6/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1275 - acc: 0.9618
Epoch 7/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1160 - acc: 0.9678
Epoch 8/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1012 - acc: 0.9705
Epoch 9/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0903 - acc: 0.9744
Epoch 10/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0836 - acc: 0.9768
Epoch 11/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0732 - acc: 0.9802
Epoch 12/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0683 - acc: 0.9816
Epoch 13/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0619 - acc: 0.9829
Epoch 14/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0572 - acc: 0.9845
Epoch 15/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0555 - acc: 0.9854
Epoch 16/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0496 - acc: 0.9867
Epoch 17/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0452 - acc: 0.9882
Epoch 18/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0417 - acc: 0.9894
Epoch 19/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0406 - acc: 0.9889
Epoch 20/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0378 - acc: 0.9910
Epoch 21/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0350 - acc: 0.9913
Epoch 22/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0327 - acc: 0.9924
Epoch 23/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0301 - acc: 0.9924
Epoch 24/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0295 - acc: 0.9922
Epoch 25/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0274 - acc: 0.9934
Epoch 26/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0271 - acc: 0.9933
Epoch 27/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0254 - acc: 0.9939
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8092
False 979
True percentage 0.892073641274
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.87      0.76      0.81       438
      B-ORG       0.70      0.75      0.72       296
      I-ORG       0.54      0.60      0.57       151
      I-PER       0.91      0.62      0.74       214
      B-LOC       0.68      0.70      0.69       218
      I-LOC       0.67      0.80      0.73       141
     B-MISC       0.33      0.13      0.19       141
     I-MISC       0.56      0.24      0.34       154

avg / total       0.93      0.89      0.91      9071

F-1 Score (without O):
0.670319634703
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 10
Found 100004 word vectors.
Found 84 char vectors.
Found 100827 unique words.
Found 94 unique chars.
Found 9 unique labels.
823 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 256
OOV word occurences: 396
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6452992     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,559,554
Trainable params: 6,559,554
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 25s 30ms/step - loss: 0.6003 - acc: 0.8244
Epoch 2/27

837/837 [==============================] - 22s 26ms/step - loss: 0.3036 - acc: 0.9112
Epoch 3/27

837/837 [==============================] - 21s 26ms/step - loss: 0.2223 - acc: 0.9335
Epoch 4/27

837/837 [==============================] - 21s 26ms/step - loss: 0.1808 - acc: 0.9454
Epoch 5/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1549 - acc: 0.9539
Epoch 6/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1319 - acc: 0.9622
Epoch 7/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1164 - acc: 0.9675
Epoch 8/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1024 - acc: 0.9715
Epoch 9/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0943 - acc: 0.9744
Epoch 10/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0834 - acc: 0.9783
Epoch 11/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0754 - acc: 0.9802
Epoch 12/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0697 - acc: 0.9814
Epoch 13/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0643 - acc: 0.9831
Epoch 14/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0571 - acc: 0.9840
Epoch 15/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0536 - acc: 0.9858
Epoch 16/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0501 - acc: 0.9866
Epoch 17/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0486 - acc: 0.9866
Epoch 18/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0447 - acc: 0.9873
Epoch 19/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0411 - acc: 0.9893
Epoch 20/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0385 - acc: 0.9899
Epoch 21/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0353 - acc: 0.9909
Epoch 22/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0329 - acc: 0.9921
Epoch 23/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0314 - acc: 0.9917
Epoch 24/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0306 - acc: 0.9919
Epoch 25/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0283 - acc: 0.9928
Epoch 26/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0272 - acc: 0.9923
Epoch 27/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0253 - acc: 0.9928
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8108
False 963
True percentage 0.893837504134
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.86      0.76      0.81       438
      B-ORG       0.73      0.64      0.68       296
      I-ORG       0.54      0.46      0.50       151
     B-MISC       0.38      0.28      0.32       141
     I-MISC       0.43      0.44      0.43       154
      I-PER       0.95      0.61      0.74       214
      B-LOC       0.75      0.73      0.74       218
      I-LOC       0.79      0.73      0.76       141

avg / total       0.93      0.89      0.91      9071

F-1 Score (without O):
0.669724770642
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 11
Found 100004 word vectors.
Found 84 char vectors.
Found 100780 unique words.
Found 94 unique chars.
Found 9 unique labels.
776 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 256
OOV word occurences: 358
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6449984     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,556,546
Trainable params: 6,556,546
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 25s 30ms/step - loss: 0.5639 - acc: 0.8390
Epoch 2/27

837/837 [==============================] - 21s 25ms/step - loss: 0.2779 - acc: 0.9216
Epoch 3/27

837/837 [==============================] - 21s 25ms/step - loss: 0.2066 - acc: 0.9399
Epoch 4/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1707 - acc: 0.9504
Epoch 5/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1424 - acc: 0.9595
Epoch 6/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1251 - acc: 0.9660
Epoch 7/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1106 - acc: 0.9698
Epoch 8/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0990 - acc: 0.9735
Epoch 9/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0871 - acc: 0.9780
Epoch 10/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0780 - acc: 0.9793
Epoch 11/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0717 - acc: 0.9816
Epoch 12/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0633 - acc: 0.9846
Epoch 13/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0596 - acc: 0.9848
Epoch 14/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0551 - acc: 0.9867
Epoch 15/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0493 - acc: 0.9882
Epoch 16/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0452 - acc: 0.9891
Epoch 17/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0423 - acc: 0.9885
Epoch 18/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0392 - acc: 0.9904
Epoch 19/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0368 - acc: 0.9900
Epoch 20/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0337 - acc: 0.9919
Epoch 21/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0304 - acc: 0.9925
Epoch 22/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0293 - acc: 0.9930
Epoch 23/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0279 - acc: 0.9936
Epoch 24/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0272 - acc: 0.9928
Epoch 25/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0243 - acc: 0.9946
Epoch 26/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0216 - acc: 0.9948
Epoch 27/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0239 - acc: 0.9937
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8105
False 966
True percentage 0.893506779848
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.72      0.69      0.70       296
          O       0.98      0.96      0.97      7318
     B-MISC       0.34      0.23      0.27       141
     I-MISC       0.38      0.25      0.30       154
      B-PER       0.89      0.82      0.85       438
      I-PER       0.86      0.60      0.71       214
      B-LOC       0.67      0.72      0.69       218
      I-LOC       0.61      0.77      0.68       141
      I-ORG       0.51      0.48      0.49       151

avg / total       0.93      0.89      0.91      9071

F-1 Score (without O):
0.918453937809
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 100794 unique words.
Found 94 unique chars.
Found 9 unique labels.
790 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 254
OOV word occurences: 397
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6450880     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,557,442
Trainable params: 6,557,442
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 25s 30ms/step - loss: 0.5861 - acc: 0.8265
Epoch 2/27

837/837 [==============================] - 21s 26ms/step - loss: 0.2935 - acc: 0.9138
Epoch 3/27

837/837 [==============================] - 21s 25ms/step - loss: 0.2183 - acc: 0.9375
Epoch 4/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1776 - acc: 0.9490
Epoch 5/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1539 - acc: 0.9536
Epoch 6/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1356 - acc: 0.9610
Epoch 7/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1157 - acc: 0.9682
Epoch 8/27

837/837 [==============================] - 21s 25ms/step - loss: 0.1054 - acc: 0.9695
Epoch 9/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0947 - acc: 0.9747
Epoch 10/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0870 - acc: 0.9758
Epoch 11/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0801 - acc: 0.9785
Epoch 12/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0699 - acc: 0.9823
Epoch 13/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0652 - acc: 0.9835
Epoch 14/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0604 - acc: 0.9836
Epoch 15/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0573 - acc: 0.9843
Epoch 16/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0536 - acc: 0.9864
Epoch 17/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0494 - acc: 0.9865
Epoch 18/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0447 - acc: 0.9884
Epoch 19/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0406 - acc: 0.9904
Epoch 20/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0394 - acc: 0.9897
Epoch 21/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0396 - acc: 0.9897
Epoch 22/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0343 - acc: 0.9917
Epoch 23/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0313 - acc: 0.9931
Epoch 24/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0323 - acc: 0.9915
Epoch 25/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0292 - acc: 0.9934
Epoch 26/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0280 - acc: 0.9931
Epoch 27/27

837/837 [==============================] - 21s 25ms/step - loss: 0.0248 - acc: 0.9937
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8120
False 951
True percentage 0.895160401279
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.88      0.74      0.80       438
      I-PER       0.89      0.61      0.73       214
          O       0.98      0.95      0.97      7318
      B-ORG       0.73      0.71      0.72       296
      B-LOC       0.71      0.72      0.72       218
      I-ORG       0.58      0.62      0.60       151
      I-LOC       0.74      0.72      0.73       141
     B-MISC       0.47      0.35      0.40       141
     I-MISC       0.48      0.45      0.47       154

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.920651788877
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100383 unique words.
Found 94 unique chars.
Found 9 unique labels.
379 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 289
OOV word occurences: 465
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6424576     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,531,138
Trainable params: 6,531,138
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 13s 38ms/step - loss: 0.8557 - acc: 0.7699
Epoch 2/27

334/334 [==============================] - 9s 26ms/step - loss: 0.4583 - acc: 0.8632
Epoch 3/27

334/334 [==============================] - 9s 26ms/step - loss: 0.3482 - acc: 0.8978
Epoch 4/27

334/334 [==============================] - 8s 25ms/step - loss: 0.2727 - acc: 0.9246
Epoch 5/27

334/334 [==============================] - 9s 25ms/step - loss: 0.2184 - acc: 0.9446
Epoch 6/27

334/334 [==============================] - 9s 26ms/step - loss: 0.1846 - acc: 0.9506
Epoch 7/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1562 - acc: 0.9612
Epoch 8/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1395 - acc: 0.9642
Epoch 9/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1209 - acc: 0.9708
Epoch 10/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1085 - acc: 0.9729
Epoch 11/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1017 - acc: 0.9754
Epoch 12/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0906 - acc: 0.9792
Epoch 13/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0812 - acc: 0.9810
Epoch 14/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0773 - acc: 0.9821
Epoch 15/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0690 - acc: 0.9845
Epoch 16/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0641 - acc: 0.9857
Epoch 17/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0598 - acc: 0.9877
Epoch 18/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0519 - acc: 0.9887
Epoch 19/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0484 - acc: 0.9896
Epoch 20/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0477 - acc: 0.9905
Epoch 21/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0448 - acc: 0.9908
Epoch 22/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0400 - acc: 0.9922
Epoch 23/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0358 - acc: 0.9928
Epoch 24/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0358 - acc: 0.9925
Epoch 25/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0313 - acc: 0.9940
Epoch 26/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0317 - acc: 0.9944
Epoch 27/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0297 - acc: 0.9946
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7989
False 1082
True percentage 0.880718774115
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.96      0.96      7318
      B-PER       0.89      0.67      0.76       438
      B-ORG       0.77      0.61      0.68       296
      I-ORG       0.54      0.50      0.52       151
      I-PER       0.90      0.56      0.69       214
      B-LOC       0.72      0.73      0.73       218
     B-MISC       0.30      0.11      0.16       141
      I-LOC       0.68      0.75      0.72       141
     I-MISC       0.47      0.18      0.26       154

avg / total       0.92      0.88      0.89      9071

F-1 Score (without O):
0.635684107897
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 100399 unique words.
Found 94 unique chars.
Found 9 unique labels.
395 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 278
OOV word occurences: 441
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6425600     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,532,162
Trainable params: 6,532,162
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 12s 37ms/step - loss: 0.7890 - acc: 0.7783
Epoch 2/27

334/334 [==============================] - 9s 26ms/step - loss: 0.4299 - acc: 0.8701
Epoch 3/27

334/334 [==============================] - 9s 26ms/step - loss: 0.3324 - acc: 0.9060
Epoch 4/27

334/334 [==============================] - 8s 25ms/step - loss: 0.2646 - acc: 0.9257
Epoch 5/27

334/334 [==============================] - 9s 25ms/step - loss: 0.2176 - acc: 0.9386
Epoch 6/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1809 - acc: 0.9513
Epoch 7/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1669 - acc: 0.9562
Epoch 8/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1426 - acc: 0.9628
Epoch 9/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1278 - acc: 0.9650
Epoch 10/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1147 - acc: 0.9714
Epoch 11/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1042 - acc: 0.9748
Epoch 12/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0927 - acc: 0.9770
Epoch 13/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0893 - acc: 0.9775
Epoch 14/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0783 - acc: 0.9814
Epoch 15/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0734 - acc: 0.9835
Epoch 16/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0668 - acc: 0.9851
Epoch 17/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0619 - acc: 0.9867
Epoch 18/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0580 - acc: 0.9868
Epoch 19/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0511 - acc: 0.9882
Epoch 20/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0492 - acc: 0.9903
Epoch 21/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0453 - acc: 0.9901
Epoch 22/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0432 - acc: 0.9903
Epoch 23/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0407 - acc: 0.9903
Epoch 24/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0351 - acc: 0.9942
Epoch 25/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0355 - acc: 0.9919
Epoch 26/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0331 - acc: 0.9932
Epoch 27/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0292 - acc: 0.9942
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7948
False 1123
True percentage 0.876198875537
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-ORG       0.72      0.68      0.70       296
      I-ORG       0.51      0.45      0.48       151
      B-PER       0.84      0.65      0.73       438
      B-LOC       0.71      0.61      0.66       218
      I-LOC       0.71      0.64      0.67       141
      I-PER       0.78      0.61      0.68       214
     B-MISC       0.29      0.22      0.25       141
     I-MISC       0.41      0.41      0.41       154

avg / total       0.92      0.88      0.89      9071

F-1 Score (without O):
0.617139334155
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100367 unique words.
Found 94 unique chars.
Found 9 unique labels.
363 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 292
OOV word occurences: 453
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6423552     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,530,114
Trainable params: 6,530,114
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 12s 35ms/step - loss: 0.8124 - acc: 0.7731
Epoch 2/27

334/334 [==============================] - 9s 26ms/step - loss: 0.4480 - acc: 0.8631
Epoch 3/27

334/334 [==============================] - 9s 26ms/step - loss: 0.3442 - acc: 0.8983
Epoch 4/27

334/334 [==============================] - 9s 26ms/step - loss: 0.2800 - acc: 0.9199
Epoch 5/27

334/334 [==============================] - 9s 26ms/step - loss: 0.2315 - acc: 0.9312
Epoch 6/27

334/334 [==============================] - 8s 25ms/step - loss: 0.2015 - acc: 0.9419
Epoch 7/27

334/334 [==============================] - 9s 25ms/step - loss: 0.1717 - acc: 0.9549
Epoch 8/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1492 - acc: 0.9583
Epoch 9/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1342 - acc: 0.9631
Epoch 10/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1205 - acc: 0.9682
Epoch 11/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1079 - acc: 0.9725
Epoch 12/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0953 - acc: 0.9757
Epoch 13/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0852 - acc: 0.9798
Epoch 14/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0804 - acc: 0.9815
Epoch 15/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0749 - acc: 0.9809
Epoch 16/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0639 - acc: 0.9853
Epoch 17/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0643 - acc: 0.9848
Epoch 18/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0550 - acc: 0.9890
Epoch 19/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0557 - acc: 0.9879
Epoch 20/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0495 - acc: 0.9894
Epoch 21/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0476 - acc: 0.9885
Epoch 22/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0450 - acc: 0.9896
Epoch 23/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0420 - acc: 0.9895
Epoch 24/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0396 - acc: 0.9921
Epoch 25/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0367 - acc: 0.9912
Epoch 26/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0320 - acc: 0.9931
Epoch 27/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0352 - acc: 0.9926
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7946
False 1125
True percentage 0.87597839268
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-PER       0.85      0.70      0.77       438
      B-ORG       0.69      0.64      0.66       296
      I-ORG       0.50      0.34      0.40       151
     B-MISC       0.27      0.17      0.21       141
     I-MISC       0.37      0.41      0.39       154
      I-PER       0.88      0.60      0.72       214
      B-LOC       0.68      0.67      0.67       218
      I-LOC       0.74      0.73      0.73       141

avg / total       0.92      0.88      0.89      9071

F-1 Score (without O):
0.621538461538
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 100386 unique words.
Found 94 unique chars.
Found 9 unique labels.
382 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 284
OOV word occurences: 440
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6424768     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,531,330
Trainable params: 6,531,330
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 12s 35ms/step - loss: 0.8586 - acc: 0.7714
Epoch 2/27

334/334 [==============================] - 9s 26ms/step - loss: 0.4943 - acc: 0.8467
Epoch 3/27

334/334 [==============================] - 8s 25ms/step - loss: 0.3481 - acc: 0.8953
Epoch 4/27

334/334 [==============================] - 8s 25ms/step - loss: 0.2898 - acc: 0.9173
Epoch 5/27

334/334 [==============================] - 8s 25ms/step - loss: 0.2329 - acc: 0.9374
Epoch 6/27

334/334 [==============================] - 8s 25ms/step - loss: 0.2016 - acc: 0.9427
Epoch 7/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1698 - acc: 0.9539
Epoch 8/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1522 - acc: 0.9590
Epoch 9/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1371 - acc: 0.9635
Epoch 10/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1221 - acc: 0.9696
Epoch 11/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1097 - acc: 0.9716
Epoch 12/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1004 - acc: 0.9741
Epoch 13/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0948 - acc: 0.9763
Epoch 14/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0837 - acc: 0.9797
Epoch 15/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0783 - acc: 0.9816
Epoch 16/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0717 - acc: 0.9836
Epoch 17/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0668 - acc: 0.9846
Epoch 18/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0643 - acc: 0.9846
Epoch 19/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0575 - acc: 0.9867
Epoch 20/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0526 - acc: 0.9884
Epoch 21/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0499 - acc: 0.9885
Epoch 22/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0490 - acc: 0.9892
Epoch 23/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0451 - acc: 0.9899
Epoch 24/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0417 - acc: 0.9908
Epoch 25/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0395 - acc: 0.9909
Epoch 26/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0358 - acc: 0.9917
Epoch 27/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0344 - acc: 0.9934
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8035
False 1036
True percentage 0.885789879837
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-ORG       0.69      0.75      0.72       296
      B-PER       0.89      0.64      0.74       438
      I-PER       0.88      0.59      0.70       214
      B-LOC       0.68      0.67      0.68       218
      I-LOC       0.78      0.73      0.75       141
      I-ORG       0.53      0.68      0.60       151
     B-MISC       0.53      0.21      0.30       141
     I-MISC       0.56      0.29      0.38       154

avg / total       0.93      0.89      0.90      9071

F-1 Score (without O):
0.65710723192
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 100382 unique words.
Found 94 unique chars.
Found 9 unique labels.
378 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 282
OOV word occurences: 446
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6424512     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,531,074
Trainable params: 6,531,074
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 12s 35ms/step - loss: 0.7727 - acc: 0.7802
Epoch 2/27

334/334 [==============================] - 9s 26ms/step - loss: 0.4276 - acc: 0.8724
Epoch 3/27

334/334 [==============================] - 9s 26ms/step - loss: 0.3140 - acc: 0.9080
Epoch 4/27

334/334 [==============================] - 9s 26ms/step - loss: 0.2511 - acc: 0.9280
Epoch 5/27

334/334 [==============================] - 8s 25ms/step - loss: 0.2121 - acc: 0.9396
Epoch 6/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1817 - acc: 0.9462
Epoch 7/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1598 - acc: 0.9549
Epoch 8/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1366 - acc: 0.9597
Epoch 9/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1277 - acc: 0.9627
Epoch 10/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1116 - acc: 0.9710
Epoch 11/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1030 - acc: 0.9734
Epoch 12/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0943 - acc: 0.9780
Epoch 13/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0841 - acc: 0.9798
Epoch 14/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0755 - acc: 0.9821
Epoch 15/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0687 - acc: 0.9846
Epoch 16/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0645 - acc: 0.9865
Epoch 17/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0588 - acc: 0.9884
Epoch 18/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0557 - acc: 0.9877
Epoch 19/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0497 - acc: 0.9888
Epoch 20/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0447 - acc: 0.9902
Epoch 21/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0444 - acc: 0.9910
Epoch 22/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0389 - acc: 0.9921
Epoch 23/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0360 - acc: 0.9935
Epoch 24/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0350 - acc: 0.9929
Epoch 25/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0318 - acc: 0.9935
Epoch 26/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0302 - acc: 0.9947
Epoch 27/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0288 - acc: 0.9954
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7933
False 1138
True percentage 0.874545254106
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.87      0.57      0.69       438
          O       0.97      0.95      0.96      7318
      B-ORG       0.72      0.60      0.66       296
     B-MISC       0.27      0.27      0.27       141
      I-ORG       0.60      0.36      0.45       151
      I-PER       0.80      0.58      0.67       214
     I-MISC       0.38      0.49      0.42       154
      B-LOC       0.74      0.68      0.71       218
      I-LOC       0.70      0.77      0.73       141

avg / total       0.92      0.87      0.89      9071

F-1 Score (without O):
0.905502533286
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 100397 unique words.
Found 94 unique chars.
Found 9 unique labels.
393 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 284
OOV word occurences: 454
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6425472     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,532,034
Trainable params: 6,532,034
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 12s 35ms/step - loss: 0.8885 - acc: 0.7516
Epoch 2/27

334/334 [==============================] - 9s 26ms/step - loss: 0.4941 - acc: 0.8483
Epoch 3/27

334/334 [==============================] - 9s 26ms/step - loss: 0.3628 - acc: 0.8880
Epoch 4/27

334/334 [==============================] - 9s 25ms/step - loss: 0.2862 - acc: 0.9169
Epoch 5/27

334/334 [==============================] - 8s 25ms/step - loss: 0.2357 - acc: 0.9306
Epoch 6/27

334/334 [==============================] - 8s 25ms/step - loss: 0.2061 - acc: 0.9391
Epoch 7/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1825 - acc: 0.9484
Epoch 8/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1569 - acc: 0.9586
Epoch 9/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1438 - acc: 0.9613
Epoch 10/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1289 - acc: 0.9664
Epoch 11/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1130 - acc: 0.9729
Epoch 12/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1023 - acc: 0.9746
Epoch 13/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0924 - acc: 0.9786
Epoch 14/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0830 - acc: 0.9804
Epoch 15/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0787 - acc: 0.9805
Epoch 16/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0704 - acc: 0.9849
Epoch 17/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0643 - acc: 0.9866
Epoch 18/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0593 - acc: 0.9886
Epoch 19/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0550 - acc: 0.9891
Epoch 20/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0535 - acc: 0.9883
Epoch 21/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0487 - acc: 0.9893
Epoch 22/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0435 - acc: 0.9914
Epoch 23/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0439 - acc: 0.9901
Epoch 24/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0379 - acc: 0.9925
Epoch 25/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0338 - acc: 0.9940
Epoch 26/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0354 - acc: 0.9924
Epoch 27/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0311 - acc: 0.9943
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7929
False 1142
True percentage 0.874104288392
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-PER       0.82      0.62      0.70       438
      B-ORG       0.71      0.53      0.61       296
      I-ORG       0.54      0.48      0.51       151
      B-LOC       0.71      0.68      0.70       218
      I-PER       0.83      0.54      0.66       214
     B-MISC       0.33      0.28      0.30       141
      I-LOC       0.69      0.77      0.72       141
     I-MISC       0.49      0.30      0.37       154

avg / total       0.91      0.87      0.89      9071

F-1 Score (without O):
0.606329113924
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 100385 unique words.
Found 94 unique chars.
Found 9 unique labels.
381 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 288
OOV word occurences: 472
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6424704     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,531,266
Trainable params: 6,531,266
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 12s 36ms/step - loss: 0.8371 - acc: 0.7703
Epoch 2/27

334/334 [==============================] - 9s 26ms/step - loss: 0.5441 - acc: 0.8507
Epoch 3/27

334/334 [==============================] - 9s 26ms/step - loss: 0.3758 - acc: 0.8865
Epoch 4/27

334/334 [==============================] - 9s 26ms/step - loss: 0.2954 - acc: 0.9165
Epoch 5/27

334/334 [==============================] - 8s 25ms/step - loss: 0.2474 - acc: 0.9287
Epoch 6/27

334/334 [==============================] - 8s 25ms/step - loss: 0.2122 - acc: 0.9423
Epoch 7/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1803 - acc: 0.9524
Epoch 8/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1577 - acc: 0.9589
Epoch 9/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1391 - acc: 0.9624
Epoch 10/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1261 - acc: 0.9677
Epoch 11/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1121 - acc: 0.9728
Epoch 12/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1054 - acc: 0.9758
Epoch 13/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0918 - acc: 0.9796
Epoch 14/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0833 - acc: 0.9815
Epoch 15/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0788 - acc: 0.9830
Epoch 16/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0707 - acc: 0.9839
Epoch 17/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0656 - acc: 0.9873
Epoch 18/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0583 - acc: 0.9886
Epoch 19/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0541 - acc: 0.9893
Epoch 20/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0530 - acc: 0.9888
Epoch 21/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0508 - acc: 0.9883
Epoch 22/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0460 - acc: 0.9906
Epoch 23/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0455 - acc: 0.9915
Epoch 24/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0411 - acc: 0.9917
Epoch 25/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0393 - acc: 0.9916
Epoch 26/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0349 - acc: 0.9935
Epoch 27/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0339 - acc: 0.9931
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7903
False 1168
True percentage 0.871238011245
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.94      0.96      7318
      B-PER       0.83      0.62      0.71       438
      I-PER       0.76      0.57      0.65       214
      B-ORG       0.64      0.56      0.59       296
      I-ORG       0.50      0.54      0.52       151
      B-LOC       0.68      0.71      0.69       218
     B-MISC       0.45      0.26      0.33       141
     I-MISC       0.44      0.35      0.39       154
      I-LOC       0.61      0.72      0.66       141

avg / total       0.91      0.87      0.89      9071

F-1 Score (without O):
0.605206738132
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 100380 unique words.
Found 94 unique chars.
Found 9 unique labels.
376 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 280
OOV word occurences: 449
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6424384     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,530,946
Trainable params: 6,530,946
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 12s 35ms/step - loss: 0.8297 - acc: 0.7679
Epoch 2/27

334/334 [==============================] - 9s 26ms/step - loss: 0.4821 - acc: 0.8484
Epoch 3/27

334/334 [==============================] - 8s 25ms/step - loss: 0.3480 - acc: 0.8942
Epoch 4/27

334/334 [==============================] - 8s 25ms/step - loss: 0.2792 - acc: 0.9201
Epoch 5/27

334/334 [==============================] - 8s 25ms/step - loss: 0.2322 - acc: 0.9341
Epoch 6/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1997 - acc: 0.9416
Epoch 7/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1753 - acc: 0.9509
Epoch 8/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1555 - acc: 0.9559
Epoch 9/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1393 - acc: 0.9603
Epoch 10/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1227 - acc: 0.9667
Epoch 11/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1110 - acc: 0.9720
Epoch 12/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1021 - acc: 0.9737
Epoch 13/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0888 - acc: 0.9776
Epoch 14/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0873 - acc: 0.9782
Epoch 15/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0769 - acc: 0.9817
Epoch 16/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0736 - acc: 0.9833
Epoch 17/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0700 - acc: 0.9839
Epoch 18/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0634 - acc: 0.9837
Epoch 19/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0578 - acc: 0.9874
Epoch 20/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0555 - acc: 0.9868
Epoch 21/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0501 - acc: 0.9901
Epoch 22/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0486 - acc: 0.9904
Epoch 23/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0478 - acc: 0.9882
Epoch 24/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0447 - acc: 0.9888
Epoch 25/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0408 - acc: 0.9900
Epoch 26/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0362 - acc: 0.9921
Epoch 27/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0368 - acc: 0.9916
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7868
False 1203
True percentage 0.867379561239
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.95      0.96      7318
     B-MISC       0.29      0.25      0.27       141
     I-MISC       0.33      0.22      0.26       154
      B-ORG       0.63      0.58      0.61       296
      B-LOC       0.71      0.63      0.67       218
      B-PER       0.87      0.61      0.71       438
      I-PER       0.91      0.54      0.67       214
      I-ORG       0.41      0.36      0.39       151
      I-LOC       0.65      0.73      0.69       141

avg / total       0.91      0.87      0.88      9071

F-1 Score (without O):
0.579728449637
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 8
Found 100004 word vectors.
Found 84 char vectors.
Found 100382 unique words.
Found 94 unique chars.
Found 9 unique labels.
378 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 277
OOV word occurences: 434
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6424512     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,531,074
Trainable params: 6,531,074
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 12s 35ms/step - loss: 0.8102 - acc: 0.7753
Epoch 2/27

334/334 [==============================] - 9s 26ms/step - loss: 0.4508 - acc: 0.8612
Epoch 3/27

334/334 [==============================] - 9s 25ms/step - loss: 0.3464 - acc: 0.8960
Epoch 4/27

334/334 [==============================] - 8s 25ms/step - loss: 0.2750 - acc: 0.9216
Epoch 5/27

334/334 [==============================] - 8s 25ms/step - loss: 0.2309 - acc: 0.9335
Epoch 6/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1989 - acc: 0.9449
Epoch 7/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1667 - acc: 0.9561
Epoch 8/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1480 - acc: 0.9625
Epoch 9/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1341 - acc: 0.9665
Epoch 10/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1144 - acc: 0.9728
Epoch 11/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1018 - acc: 0.9758
Epoch 12/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0959 - acc: 0.9779
Epoch 13/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0847 - acc: 0.9793
Epoch 14/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0779 - acc: 0.9828
Epoch 15/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0689 - acc: 0.9841
Epoch 16/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0644 - acc: 0.9866
Epoch 17/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0571 - acc: 0.9883
Epoch 18/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0543 - acc: 0.9887
Epoch 19/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0507 - acc: 0.9897
Epoch 20/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0454 - acc: 0.9894
Epoch 21/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0431 - acc: 0.9913
Epoch 22/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0402 - acc: 0.9917
Epoch 23/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0348 - acc: 0.9935
Epoch 24/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0341 - acc: 0.9939
Epoch 25/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0345 - acc: 0.9939
Epoch 26/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0305 - acc: 0.9945
Epoch 27/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0288 - acc: 0.9949
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7977
False 1094
True percentage 0.879395876971
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
     B-MISC       0.34      0.26      0.29       141
      B-ORG       0.72      0.61      0.66       296
      B-PER       0.85      0.71      0.77       438
     I-MISC       0.36      0.31      0.33       154
      I-PER       0.82      0.54      0.65       214
      I-ORG       0.55      0.40      0.47       151
      B-LOC       0.69      0.75      0.72       218
      I-LOC       0.57      0.74      0.65       141

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.621193666261
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 9
Found 100004 word vectors.
Found 84 char vectors.
Found 100390 unique words.
Found 94 unique chars.
Found 9 unique labels.
386 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 280
OOV word occurences: 432
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6425024     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,531,586
Trainable params: 6,531,586
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 12s 35ms/step - loss: 0.7458 - acc: 0.7865
Epoch 2/27

334/334 [==============================] - 9s 26ms/step - loss: 0.4255 - acc: 0.8667
Epoch 3/27

334/334 [==============================] - 9s 26ms/step - loss: 0.3060 - acc: 0.9096
Epoch 4/27

334/334 [==============================] - 9s 26ms/step - loss: 0.2444 - acc: 0.9350
Epoch 5/27

334/334 [==============================] - 9s 26ms/step - loss: 0.2004 - acc: 0.9486
Epoch 6/27

334/334 [==============================] - 9s 25ms/step - loss: 0.1670 - acc: 0.9581
Epoch 7/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1399 - acc: 0.9644
Epoch 8/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1258 - acc: 0.9662
Epoch 9/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1078 - acc: 0.9719
Epoch 10/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1003 - acc: 0.9743
Epoch 11/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0839 - acc: 0.9792
Epoch 12/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0793 - acc: 0.9791
Epoch 13/27

334/334 [==============================] - 9s 25ms/step - loss: 0.0711 - acc: 0.9829
Epoch 14/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0647 - acc: 0.9851
Epoch 15/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0601 - acc: 0.9870
Epoch 16/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0533 - acc: 0.9888
Epoch 17/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0459 - acc: 0.9918
Epoch 18/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0457 - acc: 0.9909
Epoch 19/27

334/334 [==============================] - 9s 26ms/step - loss: 0.0440 - acc: 0.9897
Epoch 20/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0387 - acc: 0.9919
Epoch 21/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0331 - acc: 0.9939
Epoch 22/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0338 - acc: 0.9937
Epoch 23/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0284 - acc: 0.9955
Epoch 24/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0272 - acc: 0.9947
Epoch 25/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0267 - acc: 0.9959
Epoch 26/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0272 - acc: 0.9940
Epoch 27/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0235 - acc: 0.9959
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7957
False 1114
True percentage 0.877191048396
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-PER       0.83      0.69      0.75       438
      B-ORG       0.71      0.66      0.69       296
      I-ORG       0.55      0.44      0.49       151
      I-PER       0.86      0.60      0.71       214
      B-LOC       0.62      0.65      0.63       218
      I-LOC       0.62      0.71      0.66       141
     B-MISC       0.27      0.18      0.21       141
     I-MISC       0.37      0.18      0.24       154

avg / total       0.91      0.88      0.89      9071

F-1 Score (without O):
0.613184079602
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 10
Found 100004 word vectors.
Found 84 char vectors.
Found 100411 unique words.
Found 94 unique chars.
Found 9 unique labels.
407 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 280
OOV word occurences: 443
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6426368     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,532,930
Trainable params: 6,532,930
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 12s 36ms/step - loss: 0.7977 - acc: 0.7774
Epoch 2/27

334/334 [==============================] - 9s 26ms/step - loss: 0.4458 - acc: 0.8656
Epoch 3/27

334/334 [==============================] - 9s 26ms/step - loss: 0.3274 - acc: 0.9019
Epoch 4/27

334/334 [==============================] - 9s 25ms/step - loss: 0.2624 - acc: 0.9246
Epoch 5/27

334/334 [==============================] - 8s 25ms/step - loss: 0.2170 - acc: 0.9352
Epoch 6/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1865 - acc: 0.9461
Epoch 7/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1609 - acc: 0.9536
Epoch 8/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1366 - acc: 0.9600
Epoch 9/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1233 - acc: 0.9669
Epoch 10/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1111 - acc: 0.9711
Epoch 11/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0977 - acc: 0.9751
Epoch 12/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0878 - acc: 0.9782
Epoch 13/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0793 - acc: 0.9804
Epoch 14/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0711 - acc: 0.9836
Epoch 15/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0676 - acc: 0.9838
Epoch 16/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0593 - acc: 0.9873
Epoch 17/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0545 - acc: 0.9877
Epoch 18/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0552 - acc: 0.9878
Epoch 19/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0490 - acc: 0.9892
Epoch 20/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0430 - acc: 0.9909
Epoch 21/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0397 - acc: 0.9919
Epoch 22/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0366 - acc: 0.9926
Epoch 23/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0371 - acc: 0.9928
Epoch 24/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0342 - acc: 0.9932
Epoch 25/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0291 - acc: 0.9951
Epoch 26/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0309 - acc: 0.9936
Epoch 27/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0273 - acc: 0.9957
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7935
False 1136
True percentage 0.874765736964
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-PER       0.88      0.69      0.77       438
      B-ORG       0.61      0.61      0.61       296
      I-ORG       0.44      0.40      0.42       151
     B-MISC       0.18      0.13      0.15       141
     I-MISC       0.38      0.27      0.31       154
      I-PER       0.84      0.62      0.71       214
      B-LOC       0.68      0.66      0.67       218
      I-LOC       0.78      0.72      0.75       141

avg / total       0.91      0.87      0.89      9071

F-1 Score (without O):
0.605442176871
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 11
Found 100004 word vectors.
Found 84 char vectors.
Found 100358 unique words.
Found 94 unique chars.
Found 9 unique labels.
354 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 282
OOV word occurences: 466
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6422976     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,529,538
Trainable params: 6,529,538
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 12s 35ms/step - loss: 0.7973 - acc: 0.7788
Epoch 2/27

334/334 [==============================] - 9s 26ms/step - loss: 0.4454 - acc: 0.8689
Epoch 3/27

334/334 [==============================] - 9s 26ms/step - loss: 0.3237 - acc: 0.9056
Epoch 4/27

334/334 [==============================] - 8s 25ms/step - loss: 0.2546 - acc: 0.9260
Epoch 5/27

334/334 [==============================] - 8s 25ms/step - loss: 0.2124 - acc: 0.9362
Epoch 6/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1830 - acc: 0.9440
Epoch 7/27

334/334 [==============================] - 9s 25ms/step - loss: 0.1651 - acc: 0.9541
Epoch 8/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1490 - acc: 0.9597
Epoch 9/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1269 - acc: 0.9656
Epoch 10/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1119 - acc: 0.9701
Epoch 11/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0997 - acc: 0.9761
Epoch 12/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0899 - acc: 0.9790
Epoch 13/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0779 - acc: 0.9829
Epoch 14/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0775 - acc: 0.9822
Epoch 15/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0662 - acc: 0.9874
Epoch 16/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0620 - acc: 0.9864
Epoch 17/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0528 - acc: 0.9904
Epoch 18/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0527 - acc: 0.9896
Epoch 19/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0449 - acc: 0.9912
Epoch 20/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0446 - acc: 0.9917
Epoch 21/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0395 - acc: 0.9931
Epoch 22/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0360 - acc: 0.9928
Epoch 23/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0347 - acc: 0.9933
Epoch 24/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0306 - acc: 0.9948
Epoch 25/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0308 - acc: 0.9955
Epoch 26/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0262 - acc: 0.9955
Epoch 27/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0269 - acc: 0.9957
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7935
False 1136
True percentage 0.874765736964
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.66      0.65      0.65       296
          O       0.97      0.95      0.96      7318
     B-MISC       0.36      0.12      0.18       141
     I-MISC       0.39      0.20      0.27       154
      B-PER       0.86      0.64      0.73       438
      I-PER       0.86      0.50      0.64       214
      B-LOC       0.69      0.69      0.69       218
      I-LOC       0.66      0.74      0.70       141
      I-ORG       0.46      0.59      0.51       151

avg / total       0.91      0.87      0.89      9071

F-1 Score (without O):
0.90631400316
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 100335 unique words.
Found 94 unique chars.
Found 9 unique labels.
331 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 279
OOV word occurences: 449
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6421504     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,528,066
Trainable params: 6,528,066
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 12s 35ms/step - loss: 0.8108 - acc: 0.7789
Epoch 2/27

334/334 [==============================] - 9s 26ms/step - loss: 0.4555 - acc: 0.8649
Epoch 3/27

334/334 [==============================] - 9s 26ms/step - loss: 0.3388 - acc: 0.9004
Epoch 4/27

334/334 [==============================] - 9s 26ms/step - loss: 0.2700 - acc: 0.9213
Epoch 5/27

334/334 [==============================] - 9s 26ms/step - loss: 0.2244 - acc: 0.9372
Epoch 6/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1967 - acc: 0.9462
Epoch 7/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1664 - acc: 0.9551
Epoch 8/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1508 - acc: 0.9622
Epoch 9/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1274 - acc: 0.9664
Epoch 10/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1190 - acc: 0.9714
Epoch 11/27

334/334 [==============================] - 8s 25ms/step - loss: 0.1085 - acc: 0.9736
Epoch 12/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0999 - acc: 0.9759
Epoch 13/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0915 - acc: 0.9778
Epoch 14/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0861 - acc: 0.9801
Epoch 15/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0751 - acc: 0.9822
Epoch 16/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0712 - acc: 0.9831
Epoch 17/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0655 - acc: 0.9850
Epoch 18/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0600 - acc: 0.9873
Epoch 19/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0548 - acc: 0.9895
Epoch 20/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0515 - acc: 0.9892
Epoch 21/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0487 - acc: 0.9894
Epoch 22/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0462 - acc: 0.9905
Epoch 23/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0434 - acc: 0.9913
Epoch 24/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0420 - acc: 0.9906
Epoch 25/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0388 - acc: 0.9924
Epoch 26/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0349 - acc: 0.9926
Epoch 27/27

334/334 [==============================] - 8s 25ms/step - loss: 0.0341 - acc: 0.9921
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7943
False 1128
True percentage 0.875647668394
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.83      0.68      0.75       438
      I-PER       0.75      0.62      0.68       214
          O       0.98      0.94      0.96      7318
      B-ORG       0.69      0.67      0.68       296
      B-LOC       0.73      0.67      0.70       218
      I-ORG       0.38      0.48      0.42       151
      I-LOC       0.71      0.71      0.71       141
     B-MISC       0.31      0.26      0.28       141
     I-MISC       0.40      0.31      0.35       154

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.904947916667
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100202 unique words.
Found 94 unique chars.
Found 9 unique labels.
198 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 306
OOV word occurences: 516
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6412992     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,519,554
Trainable params: 6,519,554
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 7s 44ms/step - loss: 1.0005 - acc: 0.7342
Epoch 2/27

167/167 [==============================] - 5s 27ms/step - loss: 0.5643 - acc: 0.8326
Epoch 3/27

167/167 [==============================] - 4s 27ms/step - loss: 0.4239 - acc: 0.8713
Epoch 4/27

167/167 [==============================] - 4s 27ms/step - loss: 0.3446 - acc: 0.8988
Epoch 5/27

167/167 [==============================] - 4s 26ms/step - loss: 0.2963 - acc: 0.9217
Epoch 6/27

167/167 [==============================] - 4s 26ms/step - loss: 0.2511 - acc: 0.9327
Epoch 7/27

167/167 [==============================] - 4s 26ms/step - loss: 0.2139 - acc: 0.9450
Epoch 8/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1923 - acc: 0.9473
Epoch 9/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1751 - acc: 0.9562
Epoch 10/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1561 - acc: 0.9603
Epoch 11/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1394 - acc: 0.9677
Epoch 12/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1313 - acc: 0.9698
Epoch 13/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1166 - acc: 0.9748
Epoch 14/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1052 - acc: 0.9768
Epoch 15/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1010 - acc: 0.9808
Epoch 16/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0902 - acc: 0.9794
Epoch 17/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0856 - acc: 0.9848
Epoch 18/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0821 - acc: 0.9811
Epoch 19/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0760 - acc: 0.9843
Epoch 20/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0688 - acc: 0.9867
Epoch 21/27

167/167 [==============================] - 4s 25ms/step - loss: 0.0643 - acc: 0.9864
Epoch 22/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0580 - acc: 0.9900
Epoch 23/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0599 - acc: 0.9889
Epoch 24/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0509 - acc: 0.9900
Epoch 25/27

167/167 [==============================] - 4s 25ms/step - loss: 0.0554 - acc: 0.9889
Epoch 26/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0500 - acc: 0.9903
Epoch 27/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0465 - acc: 0.9924
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7861
False 1210
True percentage 0.866607871238
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.95      0.95      7318
      B-PER       0.88      0.64      0.74       438
      B-ORG       0.62      0.64      0.63       296
      I-ORG       0.38      0.38      0.38       151
      I-PER       0.78      0.59      0.67       214
      B-LOC       0.73      0.62      0.67       218
     B-MISC       0.55      0.11      0.19       141
      I-LOC       0.80      0.55      0.65       141
     I-MISC       0.59      0.12      0.20       154

avg / total       0.91      0.87      0.88      9071

F-1 Score (without O):
0.59373970346
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 100210 unique words.
Found 94 unique chars.
Found 9 unique labels.
206 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 296
OOV word occurences: 490
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6413504     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,520,066
Trainable params: 6,520,066
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 7s 44ms/step - loss: 0.9608 - acc: 0.7650
Epoch 2/27

167/167 [==============================] - 5s 27ms/step - loss: 0.5678 - acc: 0.8239
Epoch 3/27

167/167 [==============================] - 4s 26ms/step - loss: 0.4369 - acc: 0.8706
Epoch 4/27

167/167 [==============================] - 4s 26ms/step - loss: 0.3406 - acc: 0.9005
Epoch 5/27

167/167 [==============================] - 4s 26ms/step - loss: 0.2882 - acc: 0.9176
Epoch 6/27

167/167 [==============================] - 4s 26ms/step - loss: 0.2592 - acc: 0.9290
Epoch 7/27

167/167 [==============================] - 4s 26ms/step - loss: 0.2224 - acc: 0.9355
Epoch 8/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1963 - acc: 0.9503
Epoch 9/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1792 - acc: 0.9531
Epoch 10/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1576 - acc: 0.9605
Epoch 11/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1425 - acc: 0.9629
Epoch 12/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1241 - acc: 0.9708
Epoch 13/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1164 - acc: 0.9751
Epoch 14/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1092 - acc: 0.9752
Epoch 15/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1006 - acc: 0.9767
Epoch 16/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0911 - acc: 0.9817
Epoch 17/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0825 - acc: 0.9827
Epoch 18/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0730 - acc: 0.9866
Epoch 19/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0675 - acc: 0.9860
Epoch 20/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0626 - acc: 0.9878
Epoch 21/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0567 - acc: 0.9908
Epoch 22/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0535 - acc: 0.9906
Epoch 23/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0494 - acc: 0.9920
Epoch 24/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0455 - acc: 0.9932
Epoch 25/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0426 - acc: 0.9917
Epoch 26/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0439 - acc: 0.9920
Epoch 27/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0405 - acc: 0.9930
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7820
False 1251
True percentage 0.86208797266
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.95      0.96      7318
      B-ORG       0.64      0.51      0.57       296
      I-ORG       0.40      0.18      0.25       151
      B-PER       0.79      0.66      0.71       438
      B-LOC       0.67      0.59      0.63       218
      I-LOC       0.82      0.42      0.55       141
      I-PER       0.74      0.60      0.66       214
     B-MISC       0.37      0.22      0.28       141
     I-MISC       0.35      0.44      0.39       154

avg / total       0.90      0.86      0.88      9071

F-1 Score (without O):
0.560586734694
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100187 unique words.
Found 94 unique chars.
Found 9 unique labels.
183 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 304
OOV word occurences: 482
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6412032     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,518,594
Trainable params: 6,518,594
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 7s 44ms/step - loss: 1.0345 - acc: 0.7327
Epoch 2/27

167/167 [==============================] - 5s 27ms/step - loss: 0.6300 - acc: 0.8117
Epoch 3/27

167/167 [==============================] - 4s 27ms/step - loss: 0.4865 - acc: 0.8523
Epoch 4/27

167/167 [==============================] - 4s 26ms/step - loss: 0.4015 - acc: 0.8814
Epoch 5/27

167/167 [==============================] - 4s 26ms/step - loss: 0.3232 - acc: 0.9045
Epoch 6/27

167/167 [==============================] - 4s 26ms/step - loss: 0.2845 - acc: 0.9242
Epoch 7/27

167/167 [==============================] - 4s 26ms/step - loss: 0.2409 - acc: 0.9378
Epoch 8/27

167/167 [==============================] - 4s 26ms/step - loss: 0.2085 - acc: 0.9440
Epoch 9/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1942 - acc: 0.9510
Epoch 10/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1658 - acc: 0.9574
Epoch 11/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1452 - acc: 0.9673
Epoch 12/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1354 - acc: 0.9693
Epoch 13/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1238 - acc: 0.9704
Epoch 14/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1098 - acc: 0.9777
Epoch 15/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1010 - acc: 0.9806
Epoch 16/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0918 - acc: 0.9819
Epoch 17/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0828 - acc: 0.9825
Epoch 18/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0775 - acc: 0.9861
Epoch 19/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0695 - acc: 0.9871
Epoch 20/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0667 - acc: 0.9875
Epoch 21/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0599 - acc: 0.9891
Epoch 22/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0580 - acc: 0.9902
Epoch 23/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0526 - acc: 0.9911
Epoch 24/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0464 - acc: 0.9939
Epoch 25/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0441 - acc: 0.9923
Epoch 26/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0406 - acc: 0.9948
Epoch 27/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0398 - acc: 0.9931
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7867
False 1204
True percentage 0.86726931981
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.95      0.96      7318
      B-PER       0.83      0.69      0.75       438
      B-ORG       0.62      0.61      0.62       296
      I-ORG       0.42      0.44      0.43       151
     B-MISC       0.19      0.09      0.12       141
     I-MISC       0.32      0.21      0.26       154
      I-PER       0.84      0.56      0.67       214
      B-LOC       0.77      0.64      0.70       218
      I-LOC       0.83      0.61      0.70       141

avg / total       0.91      0.87      0.88      9071

F-1 Score (without O):
0.594560404807
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 100217 unique words.
Found 94 unique chars.
Found 9 unique labels.
213 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 302
OOV word occurences: 503
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6413952     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,520,514
Trainable params: 6,520,514
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 7s 44ms/step - loss: 1.1508 - acc: 0.7041
Epoch 2/27

167/167 [==============================] - 5s 27ms/step - loss: 0.6658 - acc: 0.7969
Epoch 3/27

167/167 [==============================] - 4s 27ms/step - loss: 0.5300 - acc: 0.8392
Epoch 4/27

167/167 [==============================] - 4s 26ms/step - loss: 0.4339 - acc: 0.8668
Epoch 5/27

167/167 [==============================] - 4s 26ms/step - loss: 0.3730 - acc: 0.8868
Epoch 6/27

167/167 [==============================] - 4s 26ms/step - loss: 0.3183 - acc: 0.9091
Epoch 7/27

167/167 [==============================] - 4s 26ms/step - loss: 0.2795 - acc: 0.9232
Epoch 8/27

167/167 [==============================] - 4s 26ms/step - loss: 0.2434 - acc: 0.9338
Epoch 9/27

167/167 [==============================] - 4s 26ms/step - loss: 0.2160 - acc: 0.9454
Epoch 10/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1971 - acc: 0.9514
Epoch 11/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1743 - acc: 0.9574
Epoch 12/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1589 - acc: 0.9638
Epoch 13/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1439 - acc: 0.9674
Epoch 14/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1315 - acc: 0.9705
Epoch 15/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1141 - acc: 0.9736
Epoch 16/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1139 - acc: 0.9743
Epoch 17/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1058 - acc: 0.9752
Epoch 18/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0945 - acc: 0.9826
Epoch 19/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0916 - acc: 0.9823
Epoch 20/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0814 - acc: 0.9844
Epoch 21/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0790 - acc: 0.9847
Epoch 22/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0761 - acc: 0.9863
Epoch 23/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0688 - acc: 0.9853
Epoch 24/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0687 - acc: 0.9863
Epoch 25/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0580 - acc: 0.9900
Epoch 26/27

167/167 [==============================] - 4s 25ms/step - loss: 0.0559 - acc: 0.9882
Epoch 27/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0560 - acc: 0.9888
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7870
False 1201
True percentage 0.867600044097
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-ORG       0.64      0.62      0.63       296
      B-PER       0.86      0.63      0.73       438
      I-PER       0.82      0.45      0.58       214
      B-LOC       0.73      0.60      0.66       218
      I-LOC       0.80      0.60      0.68       141
      I-ORG       0.41      0.43      0.42       151
     B-MISC       0.24      0.14      0.18       141
     I-MISC       0.42      0.32      0.36       154

avg / total       0.91      0.87      0.89      9071

F-1 Score (without O):
0.579589216945
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 100204 unique words.
Found 94 unique chars.
Found 9 unique labels.
200 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 303
OOV word occurences: 577
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6413120     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,519,682
Trainable params: 6,519,682
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 8s 45ms/step - loss: 0.9650 - acc: 0.7512
Epoch 2/27

167/167 [==============================] - 5s 27ms/step - loss: 0.5525 - acc: 0.8313
Epoch 3/27

167/167 [==============================] - 4s 27ms/step - loss: 0.4455 - acc: 0.8676
Epoch 4/27

167/167 [==============================] - 4s 26ms/step - loss: 0.3527 - acc: 0.8923
Epoch 5/27

167/167 [==============================] - 4s 27ms/step - loss: 0.3017 - acc: 0.9116
Epoch 6/27

167/167 [==============================] - 4s 26ms/step - loss: 0.2615 - acc: 0.9256
Epoch 7/27

167/167 [==============================] - 4s 26ms/step - loss: 0.2295 - acc: 0.9351
Epoch 8/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1982 - acc: 0.9440
Epoch 9/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1758 - acc: 0.9530
Epoch 10/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1569 - acc: 0.9611
Epoch 11/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1404 - acc: 0.9633
Epoch 12/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1211 - acc: 0.9691
Epoch 13/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1163 - acc: 0.9708
Epoch 14/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1022 - acc: 0.9757
Epoch 15/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0950 - acc: 0.9808
Epoch 16/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0844 - acc: 0.9817
Epoch 17/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0790 - acc: 0.9838
Epoch 18/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0719 - acc: 0.9869
Epoch 19/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0676 - acc: 0.9878
Epoch 20/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0629 - acc: 0.9880
Epoch 21/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0576 - acc: 0.9903
Epoch 22/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0501 - acc: 0.9934
Epoch 23/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0499 - acc: 0.9944
Epoch 24/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0465 - acc: 0.9942
Epoch 25/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0400 - acc: 0.9945
Epoch 26/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0402 - acc: 0.9954
Epoch 27/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0353 - acc: 0.9944
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7757
False 1314
True percentage 0.85514276265
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.83      0.53      0.64       438
          O       0.98      0.94      0.96      7318
      B-ORG       0.63      0.56      0.59       296
     B-MISC       0.31      0.30      0.30       141
      I-ORG       0.47      0.30      0.37       151
      I-PER       0.70      0.42      0.52       214
     I-MISC       0.33      0.40      0.36       154
      B-LOC       0.75      0.65      0.69       218
      I-LOC       0.61      0.67      0.64       141

avg / total       0.91      0.86      0.88      9071

F-1 Score (without O):
0.893399810066
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 100223 unique words.
Found 94 unique chars.
Found 9 unique labels.
219 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 299
OOV word occurences: 500
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6414336     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,520,898
Trainable params: 6,520,898
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 7s 44ms/step - loss: 1.0440 - acc: 0.7126
Epoch 2/27

167/167 [==============================] - 5s 27ms/step - loss: 0.6257 - acc: 0.8004
Epoch 3/27

167/167 [==============================] - 4s 27ms/step - loss: 0.4714 - acc: 0.8482
Epoch 4/27

167/167 [==============================] - 4s 26ms/step - loss: 0.3937 - acc: 0.8808
Epoch 5/27

167/167 [==============================] - 4s 26ms/step - loss: 0.3214 - acc: 0.9091
Epoch 6/27

167/167 [==============================] - 4s 26ms/step - loss: 0.2751 - acc: 0.9203
Epoch 7/27

167/167 [==============================] - 4s 26ms/step - loss: 0.2318 - acc: 0.9363
Epoch 8/27

167/167 [==============================] - 4s 26ms/step - loss: 0.2036 - acc: 0.9435
Epoch 9/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1791 - acc: 0.9544
Epoch 10/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1560 - acc: 0.9595
Epoch 11/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1381 - acc: 0.9670
Epoch 12/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1263 - acc: 0.9743
Epoch 13/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1164 - acc: 0.9710
Epoch 14/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1045 - acc: 0.9764
Epoch 15/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0954 - acc: 0.9823
Epoch 16/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0907 - acc: 0.9803
Epoch 17/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0842 - acc: 0.9840
Epoch 18/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0712 - acc: 0.9883
Epoch 19/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0653 - acc: 0.9865
Epoch 20/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0618 - acc: 0.9906
Epoch 21/27

167/167 [==============================] - 4s 25ms/step - loss: 0.0572 - acc: 0.9891
Epoch 22/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0543 - acc: 0.9920
Epoch 23/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0501 - acc: 0.9911
Epoch 24/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0454 - acc: 0.9926
Epoch 25/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0445 - acc: 0.9930
Epoch 26/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0388 - acc: 0.9953
Epoch 27/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0384 - acc: 0.9947
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7836
False 1235
True percentage 0.86385183552
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-PER       0.80      0.68      0.74       438
      B-ORG       0.65      0.43      0.51       296
      I-ORG       0.40      0.26      0.32       151
      B-LOC       0.65      0.63      0.64       218
      I-PER       0.77      0.46      0.58       214
     B-MISC       0.25      0.20      0.22       141
      I-LOC       0.71      0.70      0.70       141
     I-MISC       0.39      0.33      0.36       154

avg / total       0.90      0.86      0.88      9071

F-1 Score (without O):
0.55905762496
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 100207 unique words.
Found 94 unique chars.
Found 9 unique labels.
203 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 309
OOV word occurences: 592
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6413312     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,519,874
Trainable params: 6,519,874
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 7s 44ms/step - loss: 0.9713 - acc: 0.7448
Epoch 2/27

167/167 [==============================] - 4s 27ms/step - loss: 0.5734 - acc: 0.8253
Epoch 3/27

167/167 [==============================] - 4s 27ms/step - loss: 0.4428 - acc: 0.8630
Epoch 4/27

167/167 [==============================] - 4s 26ms/step - loss: 0.3511 - acc: 0.8976
Epoch 5/27

167/167 [==============================] - 4s 26ms/step - loss: 0.3013 - acc: 0.9217
Epoch 6/27

167/167 [==============================] - 4s 26ms/step - loss: 0.2476 - acc: 0.9309
Epoch 7/27

167/167 [==============================] - 4s 26ms/step - loss: 0.2139 - acc: 0.9425
Epoch 8/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1928 - acc: 0.9492
Epoch 9/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1727 - acc: 0.9538
Epoch 10/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1536 - acc: 0.9574
Epoch 11/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1399 - acc: 0.9612
Epoch 12/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1245 - acc: 0.9661
Epoch 13/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1114 - acc: 0.9722
Epoch 14/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1033 - acc: 0.9750
Epoch 15/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0980 - acc: 0.9761
Epoch 16/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0881 - acc: 0.9790
Epoch 17/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0779 - acc: 0.9842
Epoch 18/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0759 - acc: 0.9844
Epoch 19/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0666 - acc: 0.9846
Epoch 20/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0603 - acc: 0.9865
Epoch 21/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0564 - acc: 0.9925
Epoch 22/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0547 - acc: 0.9891
Epoch 23/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0484 - acc: 0.9923
Epoch 24/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0455 - acc: 0.9918
Epoch 25/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0456 - acc: 0.9905
Epoch 26/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0395 - acc: 0.9942
Epoch 27/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0395 - acc: 0.9931
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7649
False 1422
True percentage 0.843236688347
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.93      0.95      7318
      B-PER       0.80      0.48      0.60       438
      I-PER       0.75      0.45      0.56       214
      B-ORG       0.52      0.52      0.52       296
      I-ORG       0.34      0.42      0.37       151
      B-LOC       0.63      0.68      0.66       218
     B-MISC       0.31      0.15      0.20       141
     I-MISC       0.35      0.18      0.23       154
      I-LOC       0.63      0.65      0.64       141

avg / total       0.89      0.84      0.86      9071

F-1 Score (without O):
0.514719848053
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 100205 unique words.
Found 94 unique chars.
Found 9 unique labels.
201 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 300
OOV word occurences: 499
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6413184     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,519,746
Trainable params: 6,519,746
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 7s 44ms/step - loss: 1.0283 - acc: 0.7274
Epoch 2/27

167/167 [==============================] - 4s 27ms/step - loss: 0.6023 - acc: 0.8171
Epoch 3/27

167/167 [==============================] - 4s 27ms/step - loss: 0.4709 - acc: 0.8535
Epoch 4/27

167/167 [==============================] - 4s 26ms/step - loss: 0.3875 - acc: 0.8799
Epoch 5/27

167/167 [==============================] - 4s 26ms/step - loss: 0.3196 - acc: 0.9084
Epoch 6/27

167/167 [==============================] - 4s 26ms/step - loss: 0.2679 - acc: 0.9211
Epoch 7/27

167/167 [==============================] - 4s 26ms/step - loss: 0.2306 - acc: 0.9389
Epoch 8/27

167/167 [==============================] - 4s 26ms/step - loss: 0.2106 - acc: 0.9415
Epoch 9/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1874 - acc: 0.9516
Epoch 10/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1734 - acc: 0.9524
Epoch 11/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1487 - acc: 0.9600
Epoch 12/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1365 - acc: 0.9685
Epoch 13/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1247 - acc: 0.9745
Epoch 14/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1139 - acc: 0.9754
Epoch 15/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1065 - acc: 0.9779
Epoch 16/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0958 - acc: 0.9791
Epoch 17/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0933 - acc: 0.9790
Epoch 18/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0806 - acc: 0.9837
Epoch 19/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0780 - acc: 0.9867
Epoch 20/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0675 - acc: 0.9886
Epoch 21/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0687 - acc: 0.9886
Epoch 22/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0623 - acc: 0.9897
Epoch 23/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0590 - acc: 0.9875
Epoch 24/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0531 - acc: 0.9917
Epoch 25/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0531 - acc: 0.9908
Epoch 26/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0501 - acc: 0.9914
Epoch 27/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0447 - acc: 0.9926
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7753
False 1318
True percentage 0.854701796935
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.94      0.95      7318
     B-MISC       0.29      0.28      0.29       141
     I-MISC       0.33      0.25      0.29       154
      B-ORG       0.61      0.43      0.51       296
      B-LOC       0.68      0.60      0.64       218
      B-PER       0.82      0.58      0.67       438
      I-PER       0.83      0.50      0.62       214
      I-ORG       0.43      0.40      0.42       151
      I-LOC       0.67      0.65      0.66       141

avg / total       0.90      0.85      0.87      9071

F-1 Score (without O):
0.543012472018
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 8
Found 100004 word vectors.
Found 84 char vectors.
Found 100211 unique words.
Found 94 unique chars.
Found 9 unique labels.
207 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 299
OOV word occurences: 484
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6413568     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,520,130
Trainable params: 6,520,130
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 7s 44ms/step - loss: 0.9492 - acc: 0.7808
Epoch 2/27

167/167 [==============================] - 5s 27ms/step - loss: 0.6089 - acc: 0.8201
Epoch 3/27

167/167 [==============================] - 4s 26ms/step - loss: 0.4565 - acc: 0.8597
Epoch 4/27

167/167 [==============================] - 4s 26ms/step - loss: 0.3703 - acc: 0.8891
Epoch 5/27

167/167 [==============================] - 4s 26ms/step - loss: 0.3069 - acc: 0.9118
Epoch 6/27

167/167 [==============================] - 4s 26ms/step - loss: 0.2635 - acc: 0.9264
Epoch 7/27

167/167 [==============================] - 4s 26ms/step - loss: 0.2369 - acc: 0.9350
Epoch 8/27

167/167 [==============================] - 4s 26ms/step - loss: 0.2010 - acc: 0.9446
Epoch 9/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1728 - acc: 0.9523
Epoch 10/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1565 - acc: 0.9606
Epoch 11/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1387 - acc: 0.9640
Epoch 12/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1287 - acc: 0.9658
Epoch 13/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1165 - acc: 0.9742
Epoch 14/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1099 - acc: 0.9736
Epoch 15/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0971 - acc: 0.9780
Epoch 16/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0912 - acc: 0.9808
Epoch 17/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0885 - acc: 0.9802
Epoch 18/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0767 - acc: 0.9861
Epoch 19/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0743 - acc: 0.9869
Epoch 20/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0688 - acc: 0.9855
Epoch 21/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0611 - acc: 0.9905
Epoch 22/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0579 - acc: 0.9911
Epoch 23/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0561 - acc: 0.9898
Epoch 24/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0488 - acc: 0.9920
Epoch 25/27

167/167 [==============================] - 4s 25ms/step - loss: 0.0466 - acc: 0.9929
Epoch 26/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0444 - acc: 0.9930
Epoch 27/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0421 - acc: 0.9941
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7883
False 1188
True percentage 0.86903318267
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
     B-MISC       0.21      0.13      0.17       141
      B-ORG       0.67      0.65      0.66       296
      B-PER       0.88      0.62      0.73       438
     I-MISC       0.25      0.23      0.24       154
      I-PER       0.78      0.52      0.63       214
      I-ORG       0.51      0.40      0.45       151
      B-LOC       0.70      0.68      0.69       218
      I-LOC       0.80      0.64      0.71       141

avg / total       0.91      0.87      0.89      9071

F-1 Score (without O):
0.587492103601
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 9
Found 100004 word vectors.
Found 84 char vectors.
Found 100220 unique words.
Found 94 unique chars.
Found 9 unique labels.
216 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 299
OOV word occurences: 499
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6414144     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,520,706
Trainable params: 6,520,706
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 8s 48ms/step - loss: 1.0050 - acc: 0.7430
Epoch 2/27

167/167 [==============================] - 5s 27ms/step - loss: 0.5777 - acc: 0.8290
Epoch 3/27

167/167 [==============================] - 4s 26ms/step - loss: 0.4483 - acc: 0.8565
Epoch 4/27

167/167 [==============================] - 4s 26ms/step - loss: 0.3767 - acc: 0.8856
Epoch 5/27

167/167 [==============================] - 4s 26ms/step - loss: 0.3284 - acc: 0.9039
Epoch 6/27

167/167 [==============================] - 4s 26ms/step - loss: 0.2729 - acc: 0.9216
Epoch 7/27

167/167 [==============================] - 4s 26ms/step - loss: 0.2385 - acc: 0.9377
Epoch 8/27

167/167 [==============================] - 4s 26ms/step - loss: 0.2089 - acc: 0.9418
Epoch 9/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1876 - acc: 0.9507
Epoch 10/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1726 - acc: 0.9528
Epoch 11/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1504 - acc: 0.9601
Epoch 12/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1351 - acc: 0.9684
Epoch 13/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1241 - acc: 0.9687
Epoch 14/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1127 - acc: 0.9730
Epoch 15/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1032 - acc: 0.9795
Epoch 16/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0937 - acc: 0.9799
Epoch 17/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0905 - acc: 0.9811
Epoch 18/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0819 - acc: 0.9829
Epoch 19/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0735 - acc: 0.9852
Epoch 20/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0680 - acc: 0.9871
Epoch 21/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0647 - acc: 0.9893
Epoch 22/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0583 - acc: 0.9910
Epoch 23/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0539 - acc: 0.9917
Epoch 24/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0487 - acc: 0.9921
Epoch 25/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0431 - acc: 0.9958
Epoch 26/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0432 - acc: 0.9938
Epoch 27/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0415 - acc: 0.9943
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7729
False 1342
True percentage 0.852056002646
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.94      0.95      7318
      B-PER       0.83      0.63      0.72       438
      B-ORG       0.53      0.43      0.47       296
      I-ORG       0.32      0.48      0.38       151
      I-PER       0.83      0.46      0.59       214
      B-LOC       0.67      0.61      0.64       218
      I-LOC       0.71      0.58      0.64       141
     B-MISC       0.09      0.03      0.04       141
     I-MISC       0.29      0.14      0.19       154

avg / total       0.89      0.85      0.87      9071

F-1 Score (without O):
0.52465356107
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 10
Found 100004 word vectors.
Found 84 char vectors.
Found 100218 unique words.
Found 94 unique chars.
Found 9 unique labels.
214 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 300
OOV word occurences: 479
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6414016     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,520,578
Trainable params: 6,520,578
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 7s 44ms/step - loss: 1.0373 - acc: 0.7153
Epoch 2/27

167/167 [==============================] - 4s 27ms/step - loss: 0.6035 - acc: 0.8033
Epoch 3/27

167/167 [==============================] - 4s 27ms/step - loss: 0.4913 - acc: 0.8410
Epoch 4/27

167/167 [==============================] - 4s 27ms/step - loss: 0.3983 - acc: 0.8807
Epoch 5/27

167/167 [==============================] - 4s 26ms/step - loss: 0.3406 - acc: 0.9044
Epoch 6/27

167/167 [==============================] - 4s 26ms/step - loss: 0.2909 - acc: 0.9113
Epoch 7/27

167/167 [==============================] - 4s 26ms/step - loss: 0.2553 - acc: 0.9264
Epoch 8/27

167/167 [==============================] - 4s 26ms/step - loss: 0.2157 - acc: 0.9418
Epoch 9/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1858 - acc: 0.9526
Epoch 10/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1705 - acc: 0.9535
Epoch 11/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1532 - acc: 0.9591
Epoch 12/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1412 - acc: 0.9634
Epoch 13/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1203 - acc: 0.9716
Epoch 14/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1125 - acc: 0.9749
Epoch 15/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1030 - acc: 0.9764
Epoch 16/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0946 - acc: 0.9798
Epoch 17/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0895 - acc: 0.9813
Epoch 18/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0808 - acc: 0.9838
Epoch 19/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0731 - acc: 0.9874
Epoch 20/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0703 - acc: 0.9885
Epoch 21/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0619 - acc: 0.9880
Epoch 22/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0589 - acc: 0.9914
Epoch 23/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0563 - acc: 0.9890
Epoch 24/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0496 - acc: 0.9913
Epoch 25/27

167/167 [==============================] - 4s 25ms/step - loss: 0.0460 - acc: 0.9931
Epoch 26/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0422 - acc: 0.9949
Epoch 27/27

167/167 [==============================] - 4s 25ms/step - loss: 0.0432 - acc: 0.9935
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7809
False 1262
True percentage 0.860875316944
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.95      0.95      7318
      B-PER       0.83      0.62      0.71       438
      B-ORG       0.58      0.65      0.61       296
      I-ORG       0.43      0.45      0.44       151
     B-MISC       0.30      0.13      0.19       141
     I-MISC       0.39      0.19      0.26       154
      I-PER       0.77      0.40      0.52       214
      B-LOC       0.69      0.59      0.64       218
      I-LOC       0.70      0.69      0.69       141

avg / total       0.90      0.86      0.88      9071

F-1 Score (without O):
0.566529056843
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 11
Found 100004 word vectors.
Found 84 char vectors.
Found 100185 unique words.
Found 94 unique chars.
Found 9 unique labels.
181 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 293
OOV word occurences: 495
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6411904     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,518,466
Trainable params: 6,518,466
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 7s 44ms/step - loss: 0.9426 - acc: 0.7399
Epoch 2/27

167/167 [==============================] - 5s 27ms/step - loss: 0.5383 - acc: 0.8351
Epoch 3/27

167/167 [==============================] - 4s 26ms/step - loss: 0.4403 - acc: 0.8693
Epoch 4/27

167/167 [==============================] - 4s 26ms/step - loss: 0.3272 - acc: 0.8972
Epoch 5/27

167/167 [==============================] - 4s 27ms/step - loss: 0.2750 - acc: 0.9183
Epoch 6/27

167/167 [==============================] - 4s 26ms/step - loss: 0.2250 - acc: 0.9329
Epoch 7/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1943 - acc: 0.9450
Epoch 8/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1666 - acc: 0.9550
Epoch 9/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1463 - acc: 0.9586
Epoch 10/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1270 - acc: 0.9662
Epoch 11/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1137 - acc: 0.9731
Epoch 12/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1056 - acc: 0.9712
Epoch 13/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0958 - acc: 0.9774
Epoch 14/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0884 - acc: 0.9798
Epoch 15/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0794 - acc: 0.9833
Epoch 16/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0745 - acc: 0.9843
Epoch 17/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0668 - acc: 0.9868
Epoch 18/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0593 - acc: 0.9885
Epoch 19/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0568 - acc: 0.9885
Epoch 20/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0502 - acc: 0.9932
Epoch 21/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0440 - acc: 0.9935
Epoch 22/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0451 - acc: 0.9933
Epoch 23/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0396 - acc: 0.9960
Epoch 24/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0367 - acc: 0.9949
Epoch 25/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0348 - acc: 0.9944
Epoch 26/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0299 - acc: 0.9981
Epoch 27/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0288 - acc: 0.9967
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7795
False 1276
True percentage 0.859331936942
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.62      0.53      0.57       296
          O       0.96      0.95      0.95      7318
     B-MISC       0.10      0.04      0.05       141
     I-MISC       0.13      0.06      0.09       154
      B-PER       0.85      0.67      0.75       438
      I-PER       0.84      0.48      0.61       214
      B-LOC       0.65      0.63      0.64       218
      I-LOC       0.58      0.70      0.63       141
      I-ORG       0.40      0.23      0.29       151

avg / total       0.89      0.86      0.87      9071

F-1 Score (without O):
0.893398046898
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 100192 unique words.
Found 94 unique chars.
Found 9 unique labels.
188 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 295
OOV word occurences: 555
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6412352     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,518,914
Trainable params: 6,518,914
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 7s 44ms/step - loss: 0.9417 - acc: 0.7678
Epoch 2/27

167/167 [==============================] - 5s 27ms/step - loss: 0.5617 - acc: 0.8277
Epoch 3/27

167/167 [==============================] - 4s 26ms/step - loss: 0.4475 - acc: 0.8694
Epoch 4/27

167/167 [==============================] - 4s 26ms/step - loss: 0.3509 - acc: 0.8950
Epoch 5/27

167/167 [==============================] - 4s 26ms/step - loss: 0.2937 - acc: 0.9186
Epoch 6/27

167/167 [==============================] - 4s 26ms/step - loss: 0.2450 - acc: 0.9359
Epoch 7/27

167/167 [==============================] - 4s 26ms/step - loss: 0.2182 - acc: 0.9399
Epoch 8/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1849 - acc: 0.9529
Epoch 9/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1658 - acc: 0.9571
Epoch 10/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1505 - acc: 0.9626
Epoch 11/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1309 - acc: 0.9670
Epoch 12/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1229 - acc: 0.9672
Epoch 13/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1114 - acc: 0.9698
Epoch 14/27

167/167 [==============================] - 4s 26ms/step - loss: 0.1000 - acc: 0.9774
Epoch 15/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0924 - acc: 0.9794
Epoch 16/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0890 - acc: 0.9815
Epoch 17/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0803 - acc: 0.9838
Epoch 18/27

167/167 [==============================] - 4s 25ms/step - loss: 0.0733 - acc: 0.9852
Epoch 19/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0689 - acc: 0.9865
Epoch 20/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0641 - acc: 0.9874
Epoch 21/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0559 - acc: 0.9911
Epoch 22/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0521 - acc: 0.9897
Epoch 23/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0474 - acc: 0.9919
Epoch 24/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0446 - acc: 0.9920
Epoch 25/27

167/167 [==============================] - 4s 25ms/step - loss: 0.0448 - acc: 0.9900
Epoch 26/27

167/167 [==============================] - 4s 26ms/step - loss: 0.0409 - acc: 0.9925
Epoch 27/27

167/167 [==============================] - 4s 25ms/step - loss: 0.0353 - acc: 0.9952
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7761
False 1310
True percentage 0.855583728365
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.85      0.48      0.61       438
      I-PER       0.75      0.42      0.53       214
          O       0.97      0.94      0.96      7318
      B-ORG       0.62      0.57      0.60       296
      B-LOC       0.71      0.63      0.67       218
      I-ORG       0.45      0.38      0.41       151
      I-LOC       0.75      0.71      0.73       141
     B-MISC       0.26      0.20      0.23       141
     I-MISC       0.33      0.43      0.37       154

avg / total       0.91      0.86      0.88      9071

F-1 Score (without O):
0.893622056561
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100102 unique words.
Found 94 unique chars.
Found 9 unique labels.
98 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 317
OOV word occurences: 620
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6406592     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,513,154
Trainable params: 6,513,154
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 5s 61ms/step - loss: 1.1919 - acc: 0.6600
Epoch 2/27

83/83 [==============================] - 2s 28ms/step - loss: 0.6743 - acc: 0.8139
Epoch 3/27

83/83 [==============================] - 2s 28ms/step - loss: 0.5805 - acc: 0.8251
Epoch 4/27

83/83 [==============================] - 2s 28ms/step - loss: 0.4758 - acc: 0.8543
Epoch 5/27

83/83 [==============================] - 2s 28ms/step - loss: 0.4154 - acc: 0.8818
Epoch 6/27

83/83 [==============================] - 2s 28ms/step - loss: 0.3606 - acc: 0.8946
Epoch 7/27

83/83 [==============================] - 2s 28ms/step - loss: 0.3036 - acc: 0.9110
Epoch 8/27

83/83 [==============================] - 2s 28ms/step - loss: 0.2624 - acc: 0.9275
Epoch 9/27

83/83 [==============================] - 2s 27ms/step - loss: 0.2440 - acc: 0.9357
Epoch 10/27

83/83 [==============================] - 2s 28ms/step - loss: 0.2067 - acc: 0.9496
Epoch 11/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1865 - acc: 0.9559
Epoch 12/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1792 - acc: 0.9516
Epoch 13/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1601 - acc: 0.9628
Epoch 14/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1588 - acc: 0.9587
Epoch 15/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1485 - acc: 0.9621
Epoch 16/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1276 - acc: 0.9671
Epoch 17/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1218 - acc: 0.9688
Epoch 18/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1118 - acc: 0.9746
Epoch 19/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1072 - acc: 0.9755
Epoch 20/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0917 - acc: 0.9821
Epoch 21/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0923 - acc: 0.9814
Epoch 22/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0925 - acc: 0.9781
Epoch 23/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0815 - acc: 0.9832
Epoch 24/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0840 - acc: 0.9830
Epoch 25/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0699 - acc: 0.9859
Epoch 26/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0717 - acc: 0.9825
Epoch 27/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0669 - acc: 0.9896
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7629
False 1442
True percentage 0.841031859773
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.94      0.95      7318
      B-PER       0.79      0.52      0.63       438
      B-ORG       0.51      0.50      0.51       296
      I-ORG       0.25      0.40      0.31       151
      I-PER       0.83      0.38      0.52       214
      B-LOC       0.74      0.60      0.66       218
     B-MISC       0.69      0.08      0.14       141
      I-LOC       0.66      0.42      0.51       141
     I-MISC       0.69      0.12      0.20       154

avg / total       0.90      0.84      0.86      9071

F-1 Score (without O):
0.493959731544
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 100126 unique words.
Found 94 unique chars.
Found 9 unique labels.
122 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 306
OOV word occurences: 521
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6408128     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,514,690
Trainable params: 6,514,690
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 5s 62ms/step - loss: 1.1729 - acc: 0.6734
Epoch 2/27

83/83 [==============================] - 2s 29ms/step - loss: 0.6881 - acc: 0.8110
Epoch 3/27

83/83 [==============================] - 2s 29ms/step - loss: 0.5828 - acc: 0.8231
Epoch 4/27

83/83 [==============================] - 2s 28ms/step - loss: 0.4895 - acc: 0.8507
Epoch 5/27

83/83 [==============================] - 2s 28ms/step - loss: 0.4275 - acc: 0.8678
Epoch 6/27

83/83 [==============================] - 2s 28ms/step - loss: 0.3879 - acc: 0.8812
Epoch 7/27

83/83 [==============================] - 2s 28ms/step - loss: 0.3436 - acc: 0.8896
Epoch 8/27

83/83 [==============================] - 2s 28ms/step - loss: 0.3046 - acc: 0.9054
Epoch 9/27

83/83 [==============================] - 2s 28ms/step - loss: 0.2869 - acc: 0.9096
Epoch 10/27

83/83 [==============================] - 2s 27ms/step - loss: 0.2578 - acc: 0.9245
Epoch 11/27

83/83 [==============================] - 2s 27ms/step - loss: 0.2334 - acc: 0.9374
Epoch 12/27

83/83 [==============================] - 2s 27ms/step - loss: 0.2105 - acc: 0.9477
Epoch 13/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1908 - acc: 0.9484
Epoch 14/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1700 - acc: 0.9568
Epoch 15/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1552 - acc: 0.9681
Epoch 16/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1393 - acc: 0.9687
Epoch 17/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1350 - acc: 0.9739
Epoch 18/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1175 - acc: 0.9796
Epoch 19/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1129 - acc: 0.9769
Epoch 20/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1078 - acc: 0.9777
Epoch 21/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1000 - acc: 0.9805
Epoch 22/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0915 - acc: 0.9844
Epoch 23/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0870 - acc: 0.9833
Epoch 24/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0786 - acc: 0.9884
Epoch 25/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0717 - acc: 0.9881
Epoch 26/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0658 - acc: 0.9891
Epoch 27/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0600 - acc: 0.9879
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7677
False 1394
True percentage 0.846323448352
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.94      0.95      7318
      B-ORG       0.46      0.48      0.47       296
      I-ORG       0.33      0.29      0.31       151
      B-PER       0.79      0.57      0.66       438
      B-LOC       0.67      0.50      0.58       218
      I-LOC       0.62      0.38      0.47       141
      I-PER       0.78      0.55      0.65       214
     B-MISC       0.42      0.11      0.17       141
     I-MISC       0.39      0.24      0.30       154

avg / total       0.88      0.85      0.86      9071

F-1 Score (without O):
0.505090311987
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100100 unique words.
Found 94 unique chars.
Found 9 unique labels.
96 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 312
OOV word occurences: 517
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6406464     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,513,026
Trainable params: 6,513,026
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 5s 61ms/step - loss: 1.3000 - acc: 0.6416
Epoch 2/27

83/83 [==============================] - 2s 28ms/step - loss: 0.7316 - acc: 0.7948
Epoch 3/27

83/83 [==============================] - 2s 29ms/step - loss: 0.6208 - acc: 0.8082
Epoch 4/27

83/83 [==============================] - 2s 28ms/step - loss: 0.5457 - acc: 0.8412
Epoch 5/27

83/83 [==============================] - 2s 28ms/step - loss: 0.4495 - acc: 0.8544
Epoch 6/27

83/83 [==============================] - 2s 28ms/step - loss: 0.3958 - acc: 0.8737
Epoch 7/27

83/83 [==============================] - 2s 27ms/step - loss: 0.3524 - acc: 0.8891
Epoch 8/27

83/83 [==============================] - 2s 28ms/step - loss: 0.3044 - acc: 0.9116
Epoch 9/27

83/83 [==============================] - 2s 28ms/step - loss: 0.2755 - acc: 0.9184
Epoch 10/27

83/83 [==============================] - 2s 28ms/step - loss: 0.2480 - acc: 0.9391
Epoch 11/27

83/83 [==============================] - 2s 27ms/step - loss: 0.2166 - acc: 0.9426
Epoch 12/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1961 - acc: 0.9507
Epoch 13/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1910 - acc: 0.9498
Epoch 14/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1627 - acc: 0.9684
Epoch 15/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1525 - acc: 0.9628
Epoch 16/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1396 - acc: 0.9732
Epoch 17/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1398 - acc: 0.9657
Epoch 18/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1133 - acc: 0.9764
Epoch 19/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1128 - acc: 0.9753
Epoch 20/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1024 - acc: 0.9803
Epoch 21/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0924 - acc: 0.9853
Epoch 22/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0904 - acc: 0.9830
Epoch 23/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0841 - acc: 0.9842
Epoch 24/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0773 - acc: 0.9867
Epoch 25/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0732 - acc: 0.9902
Epoch 26/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0672 - acc: 0.9901
Epoch 27/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0646 - acc: 0.9910
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7722
False 1349
True percentage 0.851284312645
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.94      0.95      7318
      B-PER       0.80      0.63      0.70       438
      B-ORG       0.55      0.49      0.52       296
      I-ORG       0.43      0.17      0.24       151
     B-MISC       0.17      0.06      0.08       141
     I-MISC       0.36      0.21      0.26       154
      I-PER       0.69      0.50      0.58       214
      B-LOC       0.57      0.63      0.60       218
      I-LOC       0.78      0.58      0.67       141

avg / total       0.88      0.85      0.86      9071

F-1 Score (without O):
0.529931305201
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 100124 unique words.
Found 94 unique chars.
Found 9 unique labels.
120 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 318
OOV word occurences: 605
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6408000     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,514,562
Trainable params: 6,514,562
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 5s 62ms/step - loss: 1.2520 - acc: 0.6260
Epoch 2/27

83/83 [==============================] - 2s 29ms/step - loss: 0.7825 - acc: 0.7726
Epoch 3/27

83/83 [==============================] - 2s 28ms/step - loss: 0.6211 - acc: 0.8029
Epoch 4/27

83/83 [==============================] - 2s 28ms/step - loss: 0.5322 - acc: 0.8382
Epoch 5/27

83/83 [==============================] - 2s 28ms/step - loss: 0.4552 - acc: 0.8762
Epoch 6/27

83/83 [==============================] - 2s 28ms/step - loss: 0.3850 - acc: 0.9028
Epoch 7/27

83/83 [==============================] - 2s 27ms/step - loss: 0.3876 - acc: 0.8958
Epoch 8/27

83/83 [==============================] - 2s 28ms/step - loss: 0.3094 - acc: 0.9204
Epoch 9/27

83/83 [==============================] - 2s 28ms/step - loss: 0.2719 - acc: 0.9301
Epoch 10/27

83/83 [==============================] - 2s 28ms/step - loss: 0.2431 - acc: 0.9384
Epoch 11/27

83/83 [==============================] - 2s 28ms/step - loss: 0.2189 - acc: 0.9445
Epoch 12/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1952 - acc: 0.9505
Epoch 13/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1759 - acc: 0.9607
Epoch 14/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1594 - acc: 0.9587
Epoch 15/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1558 - acc: 0.9596
Epoch 16/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1365 - acc: 0.9726
Epoch 17/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1230 - acc: 0.9773
Epoch 18/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1269 - acc: 0.9703
Epoch 19/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1204 - acc: 0.9724
Epoch 20/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1058 - acc: 0.9812
Epoch 21/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1077 - acc: 0.9790
Epoch 22/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0918 - acc: 0.9806
Epoch 23/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0887 - acc: 0.9841
Epoch 24/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0820 - acc: 0.9848
Epoch 25/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0759 - acc: 0.9845
Epoch 26/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0702 - acc: 0.9874
Epoch 27/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0682 - acc: 0.9909
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7667
False 1404
True percentage 0.845221034065
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.94      0.95      7318
      B-ORG       0.60      0.59      0.60       296
      B-PER       0.81      0.43      0.57       438
      I-PER       0.62      0.32      0.42       214
      B-LOC       0.68      0.68      0.68       218
      I-LOC       0.67      0.72      0.70       141
      I-ORG       0.28      0.36      0.32       151
     B-MISC       0.29      0.06      0.10       141
     I-MISC       0.42      0.21      0.28       154

avg / total       0.89      0.85      0.86      9071

F-1 Score (without O):
0.50947093403
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 100106 unique words.
Found 94 unique chars.
Found 9 unique labels.
102 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 315
OOV word occurences: 620
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6406848     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,513,410
Trainable params: 6,513,410
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 6s 69ms/step - loss: 1.1703 - acc: 0.6982
Epoch 2/27

83/83 [==============================] - 2s 28ms/step - loss: 0.6934 - acc: 0.8090
Epoch 3/27

83/83 [==============================] - 2s 29ms/step - loss: 0.5709 - acc: 0.8229
Epoch 4/27

83/83 [==============================] - 2s 28ms/step - loss: 0.4728 - acc: 0.8567
Epoch 5/27

83/83 [==============================] - 2s 28ms/step - loss: 0.4198 - acc: 0.8659
Epoch 6/27

83/83 [==============================] - 2s 28ms/step - loss: 0.3971 - acc: 0.8745
Epoch 7/27

83/83 [==============================] - 2s 28ms/step - loss: 0.3360 - acc: 0.8992
Epoch 8/27

83/83 [==============================] - 2s 28ms/step - loss: 0.3086 - acc: 0.9063
Epoch 9/27

83/83 [==============================] - 2s 27ms/step - loss: 0.2807 - acc: 0.9223
Epoch 10/27

83/83 [==============================] - 2s 27ms/step - loss: 0.2526 - acc: 0.9301
Epoch 11/27

83/83 [==============================] - 2s 27ms/step - loss: 0.2249 - acc: 0.9415
Epoch 12/27

83/83 [==============================] - 2s 28ms/step - loss: 0.2076 - acc: 0.9558
Epoch 13/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1866 - acc: 0.9549
Epoch 14/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1801 - acc: 0.9552
Epoch 15/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1561 - acc: 0.9652
Epoch 16/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1531 - acc: 0.9669
Epoch 17/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1295 - acc: 0.9721
Epoch 18/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1268 - acc: 0.9744
Epoch 19/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1184 - acc: 0.9746
Epoch 20/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1012 - acc: 0.9810
Epoch 21/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1058 - acc: 0.9817
Epoch 22/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0937 - acc: 0.9830
Epoch 23/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0881 - acc: 0.9849
Epoch 24/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0847 - acc: 0.9870
Epoch 25/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0742 - acc: 0.9871
Epoch 26/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0680 - acc: 0.9902
Epoch 27/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0656 - acc: 0.9901
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7493
False 1578
True percentage 0.826039025466
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.71      0.34      0.46       438
          O       0.92      0.95      0.93      7318
      B-ORG       0.75      0.35      0.47       296
     B-MISC       0.13      0.06      0.08       141
      I-ORG       0.66      0.15      0.25       151
      I-PER       0.60      0.42      0.49       214
     I-MISC       0.38      0.10      0.16       154
      B-LOC       0.63      0.44      0.52       218
      I-LOC       0.69      0.29      0.41       141

avg / total       0.86      0.83      0.83      9071

F-1 Score (without O):
0.870317686107
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 100106 unique words.
Found 94 unique chars.
Found 9 unique labels.
102 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 313
OOV word occurences: 544
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6406848     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,513,410
Trainable params: 6,513,410
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 5s 62ms/step - loss: 1.1906 - acc: 0.6712
Epoch 2/27

83/83 [==============================] - 2s 29ms/step - loss: 0.7749 - acc: 0.7841
Epoch 3/27

83/83 [==============================] - 2s 28ms/step - loss: 0.6401 - acc: 0.7937
Epoch 4/27

83/83 [==============================] - 2s 28ms/step - loss: 0.5743 - acc: 0.8294
Epoch 5/27

83/83 [==============================] - 2s 28ms/step - loss: 0.4747 - acc: 0.8508
Epoch 6/27

83/83 [==============================] - 2s 27ms/step - loss: 0.4239 - acc: 0.8696
Epoch 7/27

83/83 [==============================] - 2s 27ms/step - loss: 0.3587 - acc: 0.8936
Epoch 8/27

83/83 [==============================] - 2s 27ms/step - loss: 0.3139 - acc: 0.9122
Epoch 9/27

83/83 [==============================] - 2s 27ms/step - loss: 0.2888 - acc: 0.9241
Epoch 10/27

83/83 [==============================] - 2s 27ms/step - loss: 0.2536 - acc: 0.9327
Epoch 11/27

83/83 [==============================] - 2s 27ms/step - loss: 0.2313 - acc: 0.9456
Epoch 12/27

83/83 [==============================] - 2s 28ms/step - loss: 0.2063 - acc: 0.9487
Epoch 13/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1992 - acc: 0.9465
Epoch 14/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1741 - acc: 0.9558
Epoch 15/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1577 - acc: 0.9633
Epoch 16/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1390 - acc: 0.9710
Epoch 17/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1333 - acc: 0.9784
Epoch 18/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1180 - acc: 0.9834
Epoch 19/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1140 - acc: 0.9779
Epoch 20/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1031 - acc: 0.9823
Epoch 21/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0936 - acc: 0.9849
Epoch 22/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0894 - acc: 0.9864
Epoch 23/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0864 - acc: 0.9837
Epoch 24/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0750 - acc: 0.9902
Epoch 25/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0681 - acc: 0.9902
Epoch 26/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0619 - acc: 0.9913
Epoch 27/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0574 - acc: 0.9936
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7630
False 1441
True percentage 0.841142101202
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.94      0.95      7318
      B-PER       0.77      0.55      0.64       438
      B-ORG       0.53      0.40      0.46       296
      I-ORG       0.34      0.23      0.28       151
      B-LOC       0.56      0.65      0.60       218
      I-PER       0.70      0.40      0.51       214
     B-MISC       0.09      0.04      0.05       141
      I-LOC       0.63      0.68      0.65       141
     I-MISC       0.31      0.14      0.19       154

avg / total       0.87      0.84      0.85      9071

F-1 Score (without O):
0.488157894737
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 100093 unique words.
Found 94 unique chars.
Found 9 unique labels.
89 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 319
OOV word occurences: 620
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6406016     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,512,578
Trainable params: 6,512,578
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 5s 62ms/step - loss: 1.3469 - acc: 0.6522
Epoch 2/27

83/83 [==============================] - 2s 28ms/step - loss: 0.7215 - acc: 0.8090
Epoch 3/27

83/83 [==============================] - 2s 29ms/step - loss: 0.6117 - acc: 0.8177
Epoch 4/27

83/83 [==============================] - 2s 28ms/step - loss: 0.5014 - acc: 0.8333
Epoch 5/27

83/83 [==============================] - 2s 28ms/step - loss: 0.4554 - acc: 0.8593
Epoch 6/27

83/83 [==============================] - 2s 28ms/step - loss: 0.3763 - acc: 0.8818
Epoch 7/27

83/83 [==============================] - 2s 28ms/step - loss: 0.3338 - acc: 0.8971
Epoch 8/27

83/83 [==============================] - 2s 28ms/step - loss: 0.2942 - acc: 0.9165
Epoch 9/27

83/83 [==============================] - 2s 27ms/step - loss: 0.2726 - acc: 0.9272
Epoch 10/27

83/83 [==============================] - 2s 28ms/step - loss: 0.2438 - acc: 0.9353
Epoch 11/27

83/83 [==============================] - 2s 27ms/step - loss: 0.2186 - acc: 0.9486
Epoch 12/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1987 - acc: 0.9486
Epoch 13/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1863 - acc: 0.9632
Epoch 14/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1645 - acc: 0.9644
Epoch 15/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1515 - acc: 0.9656
Epoch 16/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1402 - acc: 0.9679
Epoch 17/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1227 - acc: 0.9727
Epoch 18/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1194 - acc: 0.9763
Epoch 19/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1089 - acc: 0.9781
Epoch 20/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1012 - acc: 0.9836
Epoch 21/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0910 - acc: 0.9847
Epoch 22/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0889 - acc: 0.9862
Epoch 23/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0755 - acc: 0.9923
Epoch 24/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0750 - acc: 0.9858
Epoch 25/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0649 - acc: 0.9917
Epoch 26/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0620 - acc: 0.9922
Epoch 27/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0609 - acc: 0.9931
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7548
False 1523
True percentage 0.832102304046
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.94      0.95      7318
      B-PER       0.78      0.37      0.50       438
      I-PER       0.88      0.33      0.48       214
      B-ORG       0.47      0.46      0.46       296
      I-ORG       0.25      0.41      0.31       151
      B-LOC       0.60      0.68      0.64       218
     B-MISC       0.45      0.13      0.20       141
     I-MISC       0.29      0.14      0.19       154
      I-LOC       0.71      0.58      0.64       141

avg / total       0.89      0.83      0.85      9071

F-1 Score (without O):
0.457910252211
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 100107 unique words.
Found 94 unique chars.
Found 9 unique labels.
103 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 312
OOV word occurences: 534
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6406912     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,513,474
Trainable params: 6,513,474
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 5s 62ms/step - loss: 1.4675 - acc: 0.6533
Epoch 2/27

83/83 [==============================] - 2s 28ms/step - loss: 0.7194 - acc: 0.8068
Epoch 3/27

83/83 [==============================] - 2s 29ms/step - loss: 0.5880 - acc: 0.8245
Epoch 4/27

83/83 [==============================] - 2s 28ms/step - loss: 0.4941 - acc: 0.8381
Epoch 5/27

83/83 [==============================] - 2s 28ms/step - loss: 0.4302 - acc: 0.8585
Epoch 6/27

83/83 [==============================] - 2s 28ms/step - loss: 0.3953 - acc: 0.8808
Epoch 7/27

83/83 [==============================] - 2s 28ms/step - loss: 0.3443 - acc: 0.8965
Epoch 8/27

83/83 [==============================] - 2s 28ms/step - loss: 0.3003 - acc: 0.9161
Epoch 9/27

83/83 [==============================] - 2s 27ms/step - loss: 0.2715 - acc: 0.9330
Epoch 10/27

83/83 [==============================] - 2s 27ms/step - loss: 0.2671 - acc: 0.9272
Epoch 11/27

83/83 [==============================] - 2s 27ms/step - loss: 0.2203 - acc: 0.9459
Epoch 12/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1966 - acc: 0.9532
Epoch 13/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1863 - acc: 0.9537
Epoch 14/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1650 - acc: 0.9571
Epoch 15/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1529 - acc: 0.9607
Epoch 16/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1409 - acc: 0.9694
Epoch 17/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1351 - acc: 0.9665
Epoch 18/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1263 - acc: 0.9705
Epoch 19/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1122 - acc: 0.9779
Epoch 20/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1038 - acc: 0.9802
Epoch 21/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0965 - acc: 0.9826
Epoch 22/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0903 - acc: 0.9837
Epoch 23/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0839 - acc: 0.9815
Epoch 24/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0755 - acc: 0.9907
Epoch 25/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0763 - acc: 0.9873
Epoch 26/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0717 - acc: 0.9878
Epoch 27/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0668 - acc: 0.9890
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7624
False 1447
True percentage 0.840480652629
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.95      0.94      7318
     B-MISC       0.17      0.11      0.13       141
     I-MISC       0.22      0.14      0.17       154
      B-ORG       0.51      0.41      0.46       296
      B-LOC       0.77      0.47      0.58       218
      B-PER       0.84      0.57      0.68       438
      I-PER       0.88      0.38      0.53       214
      I-ORG       0.33      0.24      0.28       151
      I-LOC       0.56      0.43      0.49       141

avg / total       0.88      0.84      0.85      9071

F-1 Score (without O):
0.47256515775
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 8
Found 100004 word vectors.
Found 84 char vectors.
Found 100117 unique words.
Found 94 unique chars.
Found 9 unique labels.
113 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 312
OOV word occurences: 518
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6407552     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,514,114
Trainable params: 6,514,114
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 5s 62ms/step - loss: 1.3396 - acc: 0.6445
Epoch 2/27

83/83 [==============================] - 2s 29ms/step - loss: 0.7011 - acc: 0.8020
Epoch 3/27

83/83 [==============================] - 2s 28ms/step - loss: 0.5932 - acc: 0.8141
Epoch 4/27

83/83 [==============================] - 2s 28ms/step - loss: 0.4956 - acc: 0.8470
Epoch 5/27

83/83 [==============================] - 2s 28ms/step - loss: 0.4332 - acc: 0.8581
Epoch 6/27

83/83 [==============================] - 2s 27ms/step - loss: 0.4068 - acc: 0.8815
Epoch 7/27

83/83 [==============================] - 2s 28ms/step - loss: 0.3349 - acc: 0.8990
Epoch 8/27

83/83 [==============================] - 2s 28ms/step - loss: 0.2898 - acc: 0.9135
Epoch 9/27

83/83 [==============================] - 2s 28ms/step - loss: 0.2691 - acc: 0.9178
Epoch 10/27

83/83 [==============================] - 2s 27ms/step - loss: 0.2431 - acc: 0.9230
Epoch 11/27

83/83 [==============================] - 2s 27ms/step - loss: 0.2054 - acc: 0.9476
Epoch 12/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1871 - acc: 0.9552
Epoch 13/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1693 - acc: 0.9648
Epoch 14/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1501 - acc: 0.9711
Epoch 15/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1448 - acc: 0.9620
Epoch 16/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1236 - acc: 0.9756
Epoch 17/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1202 - acc: 0.9795
Epoch 18/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1079 - acc: 0.9805
Epoch 19/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0933 - acc: 0.9857
Epoch 20/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0962 - acc: 0.9887
Epoch 21/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0810 - acc: 0.9869
Epoch 22/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0765 - acc: 0.9904
Epoch 23/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0729 - acc: 0.9895
Epoch 24/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0672 - acc: 0.9873
Epoch 25/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0636 - acc: 0.9922
Epoch 26/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0608 - acc: 0.9904
Epoch 27/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0595 - acc: 0.9947
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7794
False 1277
True percentage 0.859221695513
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.95      0.95      7318
     B-MISC       0.21      0.10      0.14       141
      B-ORG       0.54      0.65      0.59       296
      B-PER       0.89      0.57      0.69       438
     I-MISC       0.43      0.15      0.22       154
      I-PER       0.71      0.50      0.58       214
      I-ORG       0.45      0.41      0.43       151
      B-LOC       0.78      0.57      0.66       218
      I-LOC       0.84      0.61      0.71       141

avg / total       0.90      0.86      0.87      9071

F-1 Score (without O):
0.560209424084
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 9
Found 100004 word vectors.
Found 84 char vectors.
Found 100104 unique words.
Found 94 unique chars.
Found 9 unique labels.
100 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 312
OOV word occurences: 519
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6406720     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,513,282
Trainable params: 6,513,282
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 5s 63ms/step - loss: 1.0476 - acc: 0.8077
Epoch 2/27

83/83 [==============================] - 2s 29ms/step - loss: 0.6723 - acc: 0.8209
Epoch 3/27

83/83 [==============================] - 2s 28ms/step - loss: 0.5586 - acc: 0.8238
Epoch 4/27

83/83 [==============================] - 2s 28ms/step - loss: 0.4581 - acc: 0.8652
Epoch 5/27

83/83 [==============================] - 2s 28ms/step - loss: 0.3965 - acc: 0.8697
Epoch 6/27

83/83 [==============================] - 2s 28ms/step - loss: 0.3390 - acc: 0.8940
Epoch 7/27

83/83 [==============================] - 2s 28ms/step - loss: 0.3037 - acc: 0.9027
Epoch 8/27

83/83 [==============================] - 2s 27ms/step - loss: 0.2729 - acc: 0.9058
Epoch 9/27

83/83 [==============================] - 2s 28ms/step - loss: 0.2454 - acc: 0.9245
Epoch 10/27

83/83 [==============================] - 2s 27ms/step - loss: 0.2024 - acc: 0.9503
Epoch 11/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1881 - acc: 0.9448
Epoch 12/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1783 - acc: 0.9548
Epoch 13/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1543 - acc: 0.9648
Epoch 14/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1473 - acc: 0.9649
Epoch 15/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1283 - acc: 0.9706
Epoch 16/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1178 - acc: 0.9775
Epoch 17/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1088 - acc: 0.9785
Epoch 18/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1062 - acc: 0.9760
Epoch 19/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0959 - acc: 0.9781
Epoch 20/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0925 - acc: 0.9838
Epoch 21/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0827 - acc: 0.9826
Epoch 22/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0787 - acc: 0.9846
Epoch 23/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0723 - acc: 0.9881
Epoch 24/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0667 - acc: 0.9861
Epoch 25/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0609 - acc: 0.9932
Epoch 26/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0648 - acc: 0.9890
Epoch 27/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0577 - acc: 0.9910
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7506
False 1565
True percentage 0.827472164039
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.94      0.94      7318
      B-PER       0.66      0.51      0.58       438
      B-ORG       0.45      0.34      0.39       296
      I-ORG       0.36      0.18      0.24       151
      I-PER       0.63      0.32      0.43       214
      B-LOC       0.72      0.43      0.53       218
      I-LOC       0.83      0.32      0.46       141
     B-MISC       0.17      0.18      0.18       141
     I-MISC       0.22      0.38      0.28       154

avg / total       0.87      0.83      0.84      9071

F-1 Score (without O):
0.415752098128
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 10
Found 100004 word vectors.
Found 84 char vectors.
Found 100114 unique words.
Found 94 unique chars.
Found 9 unique labels.
110 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 314
OOV word occurences: 529
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6407360     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,513,922
Trainable params: 6,513,922
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 6s 71ms/step - loss: 1.3339 - acc: 0.6362
Epoch 2/27

83/83 [==============================] - 2s 28ms/step - loss: 0.7634 - acc: 0.7922
Epoch 3/27

83/83 [==============================] - 2s 28ms/step - loss: 0.6022 - acc: 0.8039
Epoch 4/27

83/83 [==============================] - 2s 29ms/step - loss: 0.5133 - acc: 0.8421
Epoch 5/27

83/83 [==============================] - 2s 29ms/step - loss: 0.5308 - acc: 0.8537
Epoch 6/27

83/83 [==============================] - 2s 28ms/step - loss: 0.4101 - acc: 0.8744
Epoch 7/27

83/83 [==============================] - 2s 28ms/step - loss: 0.3534 - acc: 0.8978
Epoch 8/27

83/83 [==============================] - 2s 28ms/step - loss: 0.3234 - acc: 0.9042
Epoch 9/27

83/83 [==============================] - 2s 27ms/step - loss: 0.2955 - acc: 0.9163
Epoch 10/27

83/83 [==============================] - 2s 27ms/step - loss: 0.2626 - acc: 0.9339
Epoch 11/27

83/83 [==============================] - 2s 27ms/step - loss: 0.2415 - acc: 0.9353
Epoch 12/27

83/83 [==============================] - 2s 27ms/step - loss: 0.2150 - acc: 0.9517
Epoch 13/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1991 - acc: 0.9476
Epoch 14/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1856 - acc: 0.9581
Epoch 15/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1701 - acc: 0.9621
Epoch 16/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1597 - acc: 0.9637
Epoch 17/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1443 - acc: 0.9683
Epoch 18/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1318 - acc: 0.9712
Epoch 19/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1248 - acc: 0.9810
Epoch 20/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1086 - acc: 0.9791
Epoch 21/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1052 - acc: 0.9782
Epoch 22/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0991 - acc: 0.9813
Epoch 23/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0882 - acc: 0.9871
Epoch 24/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0866 - acc: 0.9829
Epoch 25/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0783 - acc: 0.9870
Epoch 26/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0744 - acc: 0.9902
Epoch 27/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0696 - acc: 0.9897
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7712
False 1359
True percentage 0.850181898357
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.95      0.95      7318
      B-PER       0.84      0.57      0.68       438
      B-ORG       0.61      0.47      0.53       296
      I-ORG       0.59      0.24      0.34       151
     B-MISC       0.21      0.08      0.11       141
     I-MISC       0.29      0.23      0.25       154
      I-PER       0.78      0.36      0.49       214
      B-LOC       0.61      0.60      0.60       218
      I-LOC       0.70      0.55      0.61       141

avg / total       0.89      0.85      0.86      9071

F-1 Score (without O):
0.514615907546
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 11
Found 100004 word vectors.
Found 84 char vectors.
Found 100105 unique words.
Found 94 unique chars.
Found 9 unique labels.
101 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 307
OOV word occurences: 603
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6406784     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,513,346
Trainable params: 6,513,346
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 5s 62ms/step - loss: 1.1541 - acc: 0.7220
Epoch 2/27

83/83 [==============================] - 2s 30ms/step - loss: 0.7130 - acc: 0.8165
Epoch 3/27

83/83 [==============================] - 2s 28ms/step - loss: 0.5973 - acc: 0.8170
Epoch 4/27

83/83 [==============================] - 2s 28ms/step - loss: 0.4928 - acc: 0.8348
Epoch 5/27

83/83 [==============================] - 2s 28ms/step - loss: 0.4114 - acc: 0.8758
Epoch 6/27

83/83 [==============================] - 2s 29ms/step - loss: 0.3841 - acc: 0.8936
Epoch 7/27

83/83 [==============================] - 2s 27ms/step - loss: 0.3241 - acc: 0.9149
Epoch 8/27

83/83 [==============================] - 2s 27ms/step - loss: 0.2737 - acc: 0.9268
Epoch 9/27

83/83 [==============================] - 2s 27ms/step - loss: 0.2501 - acc: 0.9288
Epoch 10/27

83/83 [==============================] - 2s 27ms/step - loss: 0.2229 - acc: 0.9415
Epoch 11/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1971 - acc: 0.9439
Epoch 12/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1864 - acc: 0.9420
Epoch 13/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1687 - acc: 0.9540
Epoch 14/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1496 - acc: 0.9610
Epoch 15/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1442 - acc: 0.9606
Epoch 16/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1273 - acc: 0.9723
Epoch 17/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1237 - acc: 0.9762
Epoch 18/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1108 - acc: 0.9751
Epoch 19/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1049 - acc: 0.9788
Epoch 20/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0977 - acc: 0.9838
Epoch 21/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0857 - acc: 0.9842
Epoch 22/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0859 - acc: 0.9821
Epoch 23/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0749 - acc: 0.9889
Epoch 24/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0710 - acc: 0.9914
Epoch 25/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0659 - acc: 0.9976
Epoch 26/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0600 - acc: 0.9938
Epoch 27/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0599 - acc: 0.9953
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7518
False 1553
True percentage 0.828795061184
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.51      0.41      0.46       296
          O       0.94      0.95      0.94      7318
     B-MISC       0.12      0.03      0.05       141
     I-MISC       0.21      0.04      0.07       154
      B-PER       0.70      0.41      0.52       438
      I-PER       0.60      0.37      0.46       214
      B-LOC       0.62      0.50      0.56       218
      I-LOC       0.61      0.48      0.53       141
      I-ORG       0.28      0.17      0.21       151

avg / total       0.85      0.83      0.84      9071

F-1 Score (without O):
0.869825964252
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 100099 unique words.
Found 94 unique chars.
Found 9 unique labels.
95 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 311
OOV word occurences: 584
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6406400     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,512,962
Trainable params: 6,512,962
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 5s 61ms/step - loss: 1.2432 - acc: 0.6685
Epoch 2/27

83/83 [==============================] - 2s 28ms/step - loss: 0.6735 - acc: 0.8246
Epoch 3/27

83/83 [==============================] - 2s 28ms/step - loss: 0.5715 - acc: 0.8306
Epoch 4/27

83/83 [==============================] - 2s 28ms/step - loss: 0.4850 - acc: 0.8445
Epoch 5/27

83/83 [==============================] - 2s 28ms/step - loss: 0.4334 - acc: 0.8602
Epoch 6/27

83/83 [==============================] - 2s 28ms/step - loss: 0.4024 - acc: 0.8830
Epoch 7/27

83/83 [==============================] - 2s 28ms/step - loss: 0.3514 - acc: 0.8971
Epoch 8/27

83/83 [==============================] - 2s 28ms/step - loss: 0.3193 - acc: 0.9043
Epoch 9/27

83/83 [==============================] - 2s 28ms/step - loss: 0.2799 - acc: 0.9215
Epoch 10/27

83/83 [==============================] - 2s 28ms/step - loss: 0.2577 - acc: 0.9274
Epoch 11/27

83/83 [==============================] - 2s 28ms/step - loss: 0.2322 - acc: 0.9327
Epoch 12/27

83/83 [==============================] - 2s 27ms/step - loss: 0.2153 - acc: 0.9372
Epoch 13/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1981 - acc: 0.9418
Epoch 14/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1839 - acc: 0.9524
Epoch 15/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1713 - acc: 0.9514
Epoch 16/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1550 - acc: 0.9590
Epoch 17/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1416 - acc: 0.9626
Epoch 18/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1304 - acc: 0.9658
Epoch 19/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1225 - acc: 0.9693
Epoch 20/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1085 - acc: 0.9753
Epoch 21/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1041 - acc: 0.9760
Epoch 22/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0995 - acc: 0.9818
Epoch 23/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0866 - acc: 0.9833
Epoch 24/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0820 - acc: 0.9906
Epoch 25/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0769 - acc: 0.9892
Epoch 26/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0788 - acc: 0.9866
Epoch 27/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0667 - acc: 0.9900
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7537
False 1534
True percentage 0.83088964833
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.77      0.37      0.50       438
      I-PER       0.67      0.11      0.19       214
          O       0.94      0.95      0.94      7318
      B-ORG       0.57      0.50      0.53       296
      B-LOC       0.67      0.56      0.61       218
      I-ORG       0.33      0.42      0.37       151
      I-LOC       0.83      0.41      0.55       141
     B-MISC       0.20      0.06      0.10       141
     I-MISC       0.25      0.14      0.18       154

avg / total       0.87      0.83      0.84      9071

F-1 Score (without O):
0.872316517831
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100047 unique words.
Found 92 unique chars.
Found 9 unique labels.
43 unique words not found in embedding.
8 unique chars not found in embedding.
Number of OOV: 326
OOV word occurences: 637
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6403072     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,509,506
Trainable params: 6,509,506
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 4s 117ms/step - loss: 1.7416 - acc: 0.4503
Epoch 2/27

33/33 [==============================] - 1s 33ms/step - loss: 0.6828 - acc: 0.8474
Epoch 3/27

33/33 [==============================] - 1s 32ms/step - loss: 0.6050 - acc: 0.8478
Epoch 4/27

33/33 [==============================] - 1s 33ms/step - loss: 0.5480 - acc: 0.8468
Epoch 5/27

33/33 [==============================] - 1s 32ms/step - loss: 0.4611 - acc: 0.8482
Epoch 6/27

33/33 [==============================] - 1s 33ms/step - loss: 0.4123 - acc: 0.8550
Epoch 7/27

33/33 [==============================] - 1s 32ms/step - loss: 0.3701 - acc: 0.8692
Epoch 8/27

33/33 [==============================] - 1s 33ms/step - loss: 0.3330 - acc: 0.8874
Epoch 9/27

33/33 [==============================] - 1s 32ms/step - loss: 0.3043 - acc: 0.9029
Epoch 10/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3042 - acc: 0.9073
Epoch 11/27

33/33 [==============================] - 1s 33ms/step - loss: 0.2641 - acc: 0.9123
Epoch 12/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2598 - acc: 0.9255
Epoch 13/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2294 - acc: 0.9394
Epoch 14/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2323 - acc: 0.9265
Epoch 15/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2172 - acc: 0.9552
Epoch 16/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2043 - acc: 0.9284
Epoch 17/27

33/33 [==============================] - 1s 32ms/step - loss: 0.1882 - acc: 0.9462
Epoch 18/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1759 - acc: 0.9570
Epoch 19/27

33/33 [==============================] - 1s 33ms/step - loss: 0.1696 - acc: 0.9535
Epoch 20/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1565 - acc: 0.9600
Epoch 21/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1532 - acc: 0.9682
Epoch 22/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1481 - acc: 0.9615
Epoch 23/27

33/33 [==============================] - 1s 32ms/step - loss: 0.1290 - acc: 0.9718
Epoch 24/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1348 - acc: 0.9677
Epoch 25/27

33/33 [==============================] - 1s 32ms/step - loss: 0.1169 - acc: 0.9751
Epoch 26/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1187 - acc: 0.9731
Epoch 27/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1016 - acc: 0.9745
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7333
False 1738
True percentage 0.808400396869
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.90      0.95      0.92      7318
      B-PER       0.67      0.50      0.57       438
      B-ORG       0.47      0.41      0.43       296
      I-ORG       0.27      0.18      0.22       151
      I-PER       0.61      0.14      0.23       214
      B-LOC       0.58      0.03      0.06       218
     B-MISC       0.00      0.00      0.00       141
      I-LOC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.81      0.81      0.80      9071

F-1 Score (without O):
0.3216
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 100054 unique words.
Found 94 unique chars.
Found 9 unique labels.
50 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 316
OOV word occurences: 536
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6403520     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,510,082
Trainable params: 6,510,082
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 4s 116ms/step - loss: 1.7895 - acc: 0.4368
Epoch 2/27

33/33 [==============================] - 1s 33ms/step - loss: 0.8335 - acc: 0.8049
Epoch 3/27

33/33 [==============================] - 1s 33ms/step - loss: 0.7841 - acc: 0.8044
Epoch 4/27

33/33 [==============================] - 1s 31ms/step - loss: 0.6844 - acc: 0.8051
Epoch 5/27

33/33 [==============================] - 1s 32ms/step - loss: 0.6054 - acc: 0.8047
Epoch 6/27

33/33 [==============================] - 1s 32ms/step - loss: 0.5806 - acc: 0.8071
Epoch 7/27

33/33 [==============================] - 1s 34ms/step - loss: 0.5312 - acc: 0.8214
Epoch 8/27

33/33 [==============================] - 1s 32ms/step - loss: 0.4695 - acc: 0.8348
Epoch 9/27

33/33 [==============================] - 1s 32ms/step - loss: 0.4529 - acc: 0.8555
Epoch 10/27

33/33 [==============================] - 1s 32ms/step - loss: 0.4000 - acc: 0.8667
Epoch 11/27

33/33 [==============================] - 1s 32ms/step - loss: 0.3836 - acc: 0.8667
Epoch 12/27

33/33 [==============================] - 1s 32ms/step - loss: 0.3557 - acc: 0.8994
Epoch 13/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3342 - acc: 0.8990
Epoch 14/27

33/33 [==============================] - 1s 33ms/step - loss: 0.3231 - acc: 0.9502
Epoch 15/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2724 - acc: 0.9218
Epoch 16/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2537 - acc: 0.9283
Epoch 17/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2384 - acc: 0.9529
Epoch 18/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2309 - acc: 0.9491
Epoch 19/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2320 - acc: 0.9494
Epoch 20/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1985 - acc: 0.9532
Epoch 21/27

33/33 [==============================] - 1s 32ms/step - loss: 0.1791 - acc: 0.9734
Epoch 22/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1657 - acc: 0.9787
Epoch 23/27

33/33 [==============================] - 1s 32ms/step - loss: 0.1601 - acc: 0.9800
Epoch 24/27

33/33 [==============================] - 1s 32ms/step - loss: 0.1560 - acc: 0.9798
Epoch 25/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1806 - acc: 0.9762
Epoch 26/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1298 - acc: 0.9872
Epoch 27/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1281 - acc: 0.9856
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7469
False 1602
True percentage 0.823393231176
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.91      0.95      0.93      7318
      B-ORG       0.46      0.36      0.41       296
      I-ORG       0.70      0.15      0.25       151
      B-PER       0.68      0.44      0.54       438
      B-LOC       0.52      0.38      0.44       218
      I-LOC       0.46      0.23      0.31       141
      I-PER       0.66      0.25      0.36       214
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.83      0.82      0.82      9071

F-1 Score (without O):
0.377243222604
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100038 unique words.
Found 93 unique chars.
Found 9 unique labels.
34 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 322
OOV word occurences: 540
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6402496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,508,994
Trainable params: 6,508,994
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 4s 118ms/step - loss: 1.6894 - acc: 0.4406
Epoch 2/27

33/33 [==============================] - 1s 32ms/step - loss: 0.8372 - acc: 0.8005
Epoch 3/27

33/33 [==============================] - 1s 33ms/step - loss: 0.7368 - acc: 0.8015
Epoch 4/27

33/33 [==============================] - 1s 33ms/step - loss: 0.7593 - acc: 0.8012
Epoch 5/27

33/33 [==============================] - 1s 33ms/step - loss: 0.6300 - acc: 0.8034
Epoch 6/27

33/33 [==============================] - 1s 32ms/step - loss: 0.5621 - acc: 0.8075
Epoch 7/27

33/33 [==============================] - 1s 33ms/step - loss: 0.5238 - acc: 0.8179
Epoch 8/27

33/33 [==============================] - 1s 32ms/step - loss: 0.4809 - acc: 0.8527
Epoch 9/27

33/33 [==============================] - 1s 33ms/step - loss: 0.4533 - acc: 0.8396
Epoch 10/27

33/33 [==============================] - 1s 32ms/step - loss: 0.4070 - acc: 0.8561
Epoch 11/27

33/33 [==============================] - 1s 32ms/step - loss: 0.3734 - acc: 0.8674
Epoch 12/27

33/33 [==============================] - 1s 32ms/step - loss: 0.3891 - acc: 0.8913
Epoch 13/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3246 - acc: 0.9030
Epoch 14/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3153 - acc: 0.9144
Epoch 15/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2890 - acc: 0.9048
Epoch 16/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2692 - acc: 0.9268
Epoch 17/27

33/33 [==============================] - 1s 33ms/step - loss: 0.2637 - acc: 0.9259
Epoch 18/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2421 - acc: 0.9296
Epoch 19/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2797 - acc: 0.9228
Epoch 20/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2287 - acc: 0.9367
Epoch 21/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2048 - acc: 0.9507
Epoch 22/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2071 - acc: 0.9537
Epoch 23/27

33/33 [==============================] - 1s 32ms/step - loss: 0.1763 - acc: 0.9600
Epoch 24/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1704 - acc: 0.9610
Epoch 25/27

33/33 [==============================] - 1s 32ms/step - loss: 0.1613 - acc: 0.9657
Epoch 26/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1437 - acc: 0.9745
Epoch 27/27

33/33 [==============================] - 1s 33ms/step - loss: 0.1378 - acc: 0.9728
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7416
False 1655
True percentage 0.817550435454
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.94      0.93      7318
      B-PER       0.73      0.48      0.58       438
      B-ORG       0.59      0.37      0.45       296
      I-ORG       0.32      0.06      0.10       151
     B-MISC       0.09      0.05      0.06       141
     I-MISC       0.18      0.28      0.22       154
      I-PER       0.56      0.33      0.41       214
      B-LOC       0.52      0.46      0.49       218
      I-LOC       0.82      0.06      0.12       141

avg / total       0.85      0.82      0.83      9071

F-1 Score (without O):
0.385118842577
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 100068 unique words.
Found 94 unique chars.
Found 9 unique labels.
64 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 322
OOV word occurences: 621
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6404416     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,510,978
Trainable params: 6,510,978
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 4s 115ms/step - loss: 1.6834 - acc: 0.4866
Epoch 2/27

33/33 [==============================] - 1s 33ms/step - loss: 0.9683 - acc: 0.7530
Epoch 3/27

33/33 [==============================] - 1s 34ms/step - loss: 0.8496 - acc: 0.7522
Epoch 4/27

33/33 [==============================] - 1s 33ms/step - loss: 0.7852 - acc: 0.7637
Epoch 5/27

33/33 [==============================] - 1s 32ms/step - loss: 0.6898 - acc: 0.7639
Epoch 6/27

33/33 [==============================] - 1s 33ms/step - loss: 0.6324 - acc: 0.7795
Epoch 7/27

33/33 [==============================] - 1s 32ms/step - loss: 0.6177 - acc: 0.8062
Epoch 8/27

33/33 [==============================] - 1s 33ms/step - loss: 0.5224 - acc: 0.8549
Epoch 9/27

33/33 [==============================] - 1s 31ms/step - loss: 0.4862 - acc: 0.8416
Epoch 10/27

33/33 [==============================] - 1s 32ms/step - loss: 0.4567 - acc: 0.8750
Epoch 11/27

33/33 [==============================] - 1s 31ms/step - loss: 0.4076 - acc: 0.8892
Epoch 12/27

33/33 [==============================] - 1s 32ms/step - loss: 0.3776 - acc: 0.8702
Epoch 13/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3645 - acc: 0.9152
Epoch 14/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3104 - acc: 0.9197
Epoch 15/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2905 - acc: 0.9237
Epoch 16/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2723 - acc: 0.9199
Epoch 17/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2531 - acc: 0.9258
Epoch 18/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2441 - acc: 0.9468
Epoch 19/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2165 - acc: 0.9532
Epoch 20/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2103 - acc: 0.9593
Epoch 21/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1938 - acc: 0.9563
Epoch 22/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1843 - acc: 0.9690
Epoch 23/27

33/33 [==============================] - 1s 32ms/step - loss: 0.1620 - acc: 0.9740
Epoch 24/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1591 - acc: 0.9767
Epoch 25/27

33/33 [==============================] - 1s 32ms/step - loss: 0.1452 - acc: 0.9768
Epoch 26/27

33/33 [==============================] - 1s 32ms/step - loss: 0.1271 - acc: 0.9818
Epoch 27/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1280 - acc: 0.9749
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7368
False 1703
True percentage 0.812258846875
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.94      0.94      7318
      B-ORG       0.36      0.44      0.40       296
      B-PER       0.57      0.29      0.38       438
      I-PER       0.61      0.11      0.18       214
      B-LOC       0.73      0.41      0.53       218
      I-LOC       0.61      0.62      0.62       141
      I-ORG       0.20      0.21      0.20       151
     B-MISC       0.03      0.01      0.01       141
     I-MISC       0.36      0.15      0.21       154

avg / total       0.85      0.81      0.82      9071

F-1 Score (without O):
0.354649153128
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 100055 unique words.
Found 94 unique chars.
Found 9 unique labels.
51 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 322
OOV word occurences: 633
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6403584     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,510,146
Trainable params: 6,510,146
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 4s 118ms/step - loss: 1.6120 - acc: 0.5033
Epoch 2/27

33/33 [==============================] - 1s 33ms/step - loss: 0.8175 - acc: 0.8272
Epoch 3/27

33/33 [==============================] - 1s 32ms/step - loss: 0.7069 - acc: 0.8270
Epoch 4/27

33/33 [==============================] - 1s 34ms/step - loss: 0.6342 - acc: 0.8262
Epoch 5/27

33/33 [==============================] - 1s 32ms/step - loss: 0.6052 - acc: 0.8234
Epoch 6/27

33/33 [==============================] - 1s 33ms/step - loss: 0.5485 - acc: 0.8269
Epoch 7/27

33/33 [==============================] - 1s 32ms/step - loss: 0.5599 - acc: 0.8588
Epoch 8/27

33/33 [==============================] - 1s 33ms/step - loss: 0.4815 - acc: 0.8387
Epoch 9/27

33/33 [==============================] - 1s 32ms/step - loss: 0.5062 - acc: 0.8747
Epoch 10/27

33/33 [==============================] - 1s 31ms/step - loss: 0.4164 - acc: 0.8529
Epoch 11/27

33/33 [==============================] - 1s 32ms/step - loss: 0.4029 - acc: 0.8866
Epoch 12/27

33/33 [==============================] - 1s 32ms/step - loss: 0.3530 - acc: 0.8921
Epoch 13/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3540 - acc: 0.8814
Epoch 14/27

33/33 [==============================] - 1s 33ms/step - loss: 0.3293 - acc: 0.8937
Epoch 15/27

33/33 [==============================] - 1s 32ms/step - loss: 0.3061 - acc: 0.9017
Epoch 16/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2921 - acc: 0.8951
Epoch 17/27

33/33 [==============================] - 1s 33ms/step - loss: 0.2781 - acc: 0.9150
Epoch 18/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2443 - acc: 0.9257
Epoch 19/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2477 - acc: 0.9219
Epoch 20/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2365 - acc: 0.9485
Epoch 21/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2480 - acc: 0.9449
Epoch 22/27

33/33 [==============================] - 1s 33ms/step - loss: 0.2172 - acc: 0.9592
Epoch 23/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2008 - acc: 0.9565
Epoch 24/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1914 - acc: 0.9653
Epoch 25/27

33/33 [==============================] - 1s 32ms/step - loss: 0.1848 - acc: 0.9643
Epoch 26/27

33/33 [==============================] - 1s 32ms/step - loss: 0.1741 - acc: 0.9649
Epoch 27/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1654 - acc: 0.9631
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7259
False 1812
True percentage 0.800242531143
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.71      0.21      0.32       438
          O       0.90      0.95      0.92      7318
      B-ORG       0.53      0.32      0.40       296
     B-MISC       0.07      0.06      0.06       141
      I-ORG       0.33      0.15      0.21       151
      I-PER       0.45      0.28      0.34       214
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.80      0.07      0.13       218
      I-LOC       0.73      0.06      0.11       141

avg / total       0.82      0.80      0.79      9071

F-1 Score (without O):
0.846131145606
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 100041 unique words.
Found 93 unique chars.
Found 9 unique labels.
37 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 322
OOV word occurences: 630
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6402688     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,509,186
Trainable params: 6,509,186
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 4s 115ms/step - loss: 1.9905 - acc: 0.3905
Epoch 2/27

33/33 [==============================] - 1s 32ms/step - loss: 0.8667 - acc: 0.8105
Epoch 3/27

33/33 [==============================] - 1s 32ms/step - loss: 0.7659 - acc: 0.8106
Epoch 4/27

33/33 [==============================] - 1s 32ms/step - loss: 0.6737 - acc: 0.8111
Epoch 5/27

33/33 [==============================] - 1s 34ms/step - loss: 0.6331 - acc: 0.8088
Epoch 6/27

33/33 [==============================] - 1s 32ms/step - loss: 0.5548 - acc: 0.8127
Epoch 7/27

33/33 [==============================] - 1s 33ms/step - loss: 0.5159 - acc: 0.8311
Epoch 8/27

33/33 [==============================] - 1s 32ms/step - loss: 0.4529 - acc: 0.8582
Epoch 9/27

33/33 [==============================] - 1s 32ms/step - loss: 0.4213 - acc: 0.8604
Epoch 10/27

33/33 [==============================] - 1s 33ms/step - loss: 0.4410 - acc: 0.9134
Epoch 11/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3641 - acc: 0.8890
Epoch 12/27

33/33 [==============================] - 1s 32ms/step - loss: 0.3206 - acc: 0.9031
Epoch 13/27

33/33 [==============================] - 1s 32ms/step - loss: 0.3231 - acc: 0.9143
Epoch 14/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2829 - acc: 0.9121
Epoch 15/27

33/33 [==============================] - 1s 33ms/step - loss: 0.2666 - acc: 0.9229
Epoch 16/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2548 - acc: 0.9211
Epoch 17/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2715 - acc: 0.9288
Epoch 18/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2316 - acc: 0.9386
Epoch 19/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2179 - acc: 0.9415
Epoch 20/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2031 - acc: 0.9527
Epoch 21/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2084 - acc: 0.9475
Epoch 22/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2038 - acc: 0.9416
Epoch 23/27

33/33 [==============================] - 1s 32ms/step - loss: 0.1908 - acc: 0.9601
Epoch 24/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1748 - acc: 0.9686
Epoch 25/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1655 - acc: 0.9617
Epoch 26/27

33/33 [==============================] - 1s 32ms/step - loss: 0.1629 - acc: 0.9658
Epoch 27/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1502 - acc: 0.9604
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7322
False 1749
True percentage 0.807187741153
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.93      0.93      7318
      B-PER       0.57      0.56      0.57       438
      B-ORG       0.35      0.43      0.38       296
      I-ORG       0.20      0.21      0.20       151
      B-LOC       0.50      0.30      0.38       218
      I-PER       0.47      0.14      0.22       214
     B-MISC       0.00      0.00      0.00       141
      I-LOC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.82      0.81      0.81      9071

F-1 Score (without O):
0.344471236652
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 100038 unique words.
Found 94 unique chars.
Found 9 unique labels.
34 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 325
OOV word occurences: 634
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6402496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,509,058
Trainable params: 6,509,058
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 4s 115ms/step - loss: 1.9501 - acc: 0.4331
Epoch 2/27

33/33 [==============================] - 1s 32ms/step - loss: 0.8898 - acc: 0.8105
Epoch 3/27

33/33 [==============================] - 1s 32ms/step - loss: 0.7049 - acc: 0.8112
Epoch 4/27

33/33 [==============================] - 1s 32ms/step - loss: 0.6214 - acc: 0.8117
Epoch 5/27

33/33 [==============================] - 1s 33ms/step - loss: 0.5921 - acc: 0.8216
Epoch 6/27

33/33 [==============================] - 1s 32ms/step - loss: 0.5964 - acc: 0.8256
Epoch 7/27

33/33 [==============================] - 1s 32ms/step - loss: 0.4945 - acc: 0.8484
Epoch 8/27

33/33 [==============================] - 1s 32ms/step - loss: 0.4325 - acc: 0.8468
Epoch 9/27

33/33 [==============================] - 1s 32ms/step - loss: 0.3888 - acc: 0.8807
Epoch 10/27

33/33 [==============================] - 1s 33ms/step - loss: 0.3519 - acc: 0.8943
Epoch 11/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3218 - acc: 0.9104
Epoch 12/27

33/33 [==============================] - 1s 33ms/step - loss: 0.3476 - acc: 0.9073
Epoch 13/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2902 - acc: 0.9105
Epoch 14/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2770 - acc: 0.9280
Epoch 15/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2468 - acc: 0.9309
Epoch 16/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2266 - acc: 0.9406
Epoch 17/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2304 - acc: 0.9366
Epoch 18/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1969 - acc: 0.9505
Epoch 19/27

33/33 [==============================] - 1s 33ms/step - loss: 0.1986 - acc: 0.9550
Epoch 20/27

33/33 [==============================] - 1s 32ms/step - loss: 0.1745 - acc: 0.9532
Epoch 21/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1650 - acc: 0.9660
Epoch 22/27

33/33 [==============================] - 1s 32ms/step - loss: 0.1663 - acc: 0.9612
Epoch 23/27

33/33 [==============================] - 1s 30ms/step - loss: 0.1512 - acc: 0.9633
Epoch 24/27

33/33 [==============================] - 1s 32ms/step - loss: 0.1387 - acc: 0.9685
Epoch 25/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1416 - acc: 0.9654
Epoch 26/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1227 - acc: 0.9755
Epoch 27/27

33/33 [==============================] - 1s 32ms/step - loss: 0.1196 - acc: 0.9848
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7299
False 1772
True percentage 0.804652188292
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.93      0.93      7318
      B-PER       0.56      0.34      0.42       438
      I-PER       0.52      0.21      0.29       214
      B-ORG       0.33      0.46      0.39       296
      I-ORG       0.28      0.34      0.31       151
      B-LOC       0.48      0.37      0.42       218
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      I-LOC       0.78      0.10      0.18       141

avg / total       0.83      0.80      0.81      9071

F-1 Score (without O):
0.329982668977
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 100039 unique words.
Found 93 unique chars.
Found 9 unique labels.
35 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 321
OOV word occurences: 550
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6402560     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,509,058
Trainable params: 6,509,058
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 4s 116ms/step - loss: 1.6922 - acc: 0.4407
Epoch 2/27

33/33 [==============================] - 1s 33ms/step - loss: 1.2284 - acc: 0.7878
Epoch 3/27

33/33 [==============================] - 1s 33ms/step - loss: 0.9035 - acc: 0.7884
Epoch 4/27

33/33 [==============================] - 1s 33ms/step - loss: 0.7781 - acc: 0.7862
Epoch 5/27

33/33 [==============================] - 1s 32ms/step - loss: 0.7716 - acc: 0.7849
Epoch 6/27

33/33 [==============================] - 1s 33ms/step - loss: 0.7046 - acc: 0.7972
Epoch 7/27

33/33 [==============================] - 1s 31ms/step - loss: 0.6129 - acc: 0.7919
Epoch 8/27

33/33 [==============================] - 1s 33ms/step - loss: 0.5836 - acc: 0.8062
Epoch 9/27

33/33 [==============================] - 1s 32ms/step - loss: 0.5277 - acc: 0.8125
Epoch 10/27

33/33 [==============================] - 1s 31ms/step - loss: 0.4794 - acc: 0.8407
Epoch 11/27

33/33 [==============================] - 1s 32ms/step - loss: 0.4528 - acc: 0.8510
Epoch 12/27

33/33 [==============================] - 1s 31ms/step - loss: 0.4255 - acc: 0.8604
Epoch 13/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3726 - acc: 0.8838
Epoch 14/27

33/33 [==============================] - 1s 32ms/step - loss: 0.3754 - acc: 0.8952
Epoch 15/27

33/33 [==============================] - 1s 32ms/step - loss: 0.3562 - acc: 0.8950
Epoch 16/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3479 - acc: 0.9087
Epoch 17/27

33/33 [==============================] - 1s 32ms/step - loss: 0.3003 - acc: 0.9127
Epoch 18/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3079 - acc: 0.9021
Epoch 19/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2771 - acc: 0.9161
Epoch 20/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2869 - acc: 0.9141
Epoch 21/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2375 - acc: 0.9252
Epoch 22/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2249 - acc: 0.9430
Epoch 23/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2119 - acc: 0.9559
Epoch 24/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2000 - acc: 0.9544
Epoch 25/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1853 - acc: 0.9584
Epoch 26/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1909 - acc: 0.9573
Epoch 27/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2142 - acc: 0.9400
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7362
False 1709
True percentage 0.811597398302
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.91      0.95      0.93      7318
     B-MISC       0.09      0.04      0.05       141
     I-MISC       0.14      0.04      0.06       154
      B-ORG       0.36      0.33      0.35       296
      B-LOC       0.82      0.31      0.45       218
      B-PER       0.72      0.47      0.57       438
      I-PER       0.70      0.15      0.25       214
      I-ORG       0.15      0.15      0.15       151
      I-LOC       0.17      0.01      0.01       141

avg / total       0.83      0.81      0.81      9071

F-1 Score (without O):
0.32539091586
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 8
Found 100004 word vectors.
Found 84 char vectors.
Found 100047 unique words.
Found 94 unique chars.
Found 9 unique labels.
43 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 321
OOV word occurences: 546
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6403072     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,509,634
Trainable params: 6,509,634
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 4s 114ms/step - loss: 1.6333 - acc: 0.4450
Epoch 2/27

33/33 [==============================] - 1s 32ms/step - loss: 1.0439 - acc: 0.7873
Epoch 3/27

33/33 [==============================] - 1s 32ms/step - loss: 0.8319 - acc: 0.7869
Epoch 4/27

33/33 [==============================] - 1s 31ms/step - loss: 0.7343 - acc: 0.7873
Epoch 5/27

33/33 [==============================] - 1s 32ms/step - loss: 0.7166 - acc: 0.7848
Epoch 6/27

33/33 [==============================] - 1s 32ms/step - loss: 0.6497 - acc: 0.7898
Epoch 7/27

33/33 [==============================] - 1s 32ms/step - loss: 0.5889 - acc: 0.7924
Epoch 8/27

33/33 [==============================] - 1s 32ms/step - loss: 0.5576 - acc: 0.8055
Epoch 9/27

33/33 [==============================] - 1s 31ms/step - loss: 0.4764 - acc: 0.8445
Epoch 10/27

33/33 [==============================] - 1s 33ms/step - loss: 0.4624 - acc: 0.8493
Epoch 11/27

33/33 [==============================] - 1s 31ms/step - loss: 0.4359 - acc: 0.8649
Epoch 12/27

33/33 [==============================] - 1s 32ms/step - loss: 0.3788 - acc: 0.8790
Epoch 13/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3717 - acc: 0.8774
Epoch 14/27

33/33 [==============================] - 1s 32ms/step - loss: 0.3456 - acc: 0.8816
Epoch 15/27

33/33 [==============================] - 1s 32ms/step - loss: 0.3661 - acc: 0.8747
Epoch 16/27

33/33 [==============================] - 1s 32ms/step - loss: 0.3060 - acc: 0.9081
Epoch 17/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2887 - acc: 0.9420
Epoch 18/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2736 - acc: 0.9343
Epoch 19/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2601 - acc: 0.9240
Epoch 20/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2412 - acc: 0.9452
Epoch 21/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2287 - acc: 0.9408
Epoch 22/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2248 - acc: 0.9617
Epoch 23/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2061 - acc: 0.9730
Epoch 24/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1957 - acc: 0.9834
Epoch 25/27

33/33 [==============================] - 1s 32ms/step - loss: 0.1889 - acc: 0.9740
Epoch 26/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1791 - acc: 0.9772
Epoch 27/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1691 - acc: 0.9782
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7439
False 1632
True percentage 0.820085988314
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.92      0.95      0.93      7318
     B-MISC       0.33      0.05      0.09       141
      B-ORG       0.38      0.40      0.39       296
      B-PER       0.70      0.44      0.54       438
     I-MISC       0.42      0.03      0.06       154
      I-PER       0.45      0.40      0.42       214
      I-ORG       0.58      0.05      0.09       151
      B-LOC       0.53      0.30      0.38       218
      I-LOC       0.00      0.00      0.00       141

avg / total       0.83      0.82      0.82      9071

F-1 Score (without O):
0.356133828996
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 9
Found 100004 word vectors.
Found 84 char vectors.
Found 100043 unique words.
Found 93 unique chars.
Found 9 unique labels.
39 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 323
OOV word occurences: 555
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6402816     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,509,314
Trainable params: 6,509,314
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 4s 127ms/step - loss: 1.9431 - acc: 0.4345
Epoch 2/27

33/33 [==============================] - 1s 33ms/step - loss: 0.8275 - acc: 0.8123
Epoch 3/27

33/33 [==============================] - 1s 33ms/step - loss: 0.8088 - acc: 0.8103
Epoch 4/27

33/33 [==============================] - 1s 33ms/step - loss: 0.6923 - acc: 0.8153
Epoch 5/27

33/33 [==============================] - 1s 32ms/step - loss: 0.6538 - acc: 0.8125
Epoch 6/27

33/33 [==============================] - 1s 33ms/step - loss: 0.5955 - acc: 0.8210
Epoch 7/27

33/33 [==============================] - 1s 32ms/step - loss: 0.5555 - acc: 0.8149
Epoch 8/27

33/33 [==============================] - 1s 33ms/step - loss: 0.5132 - acc: 0.8159
Epoch 9/27

33/33 [==============================] - 1s 32ms/step - loss: 0.4927 - acc: 0.8367
Epoch 10/27

33/33 [==============================] - 1s 32ms/step - loss: 0.4460 - acc: 0.8269
Epoch 11/27

33/33 [==============================] - 1s 32ms/step - loss: 0.4158 - acc: 0.8557
Epoch 12/27

33/33 [==============================] - 1s 31ms/step - loss: 0.4009 - acc: 0.8677
Epoch 13/27

33/33 [==============================] - 1s 32ms/step - loss: 0.3575 - acc: 0.8898
Epoch 14/27

33/33 [==============================] - 1s 32ms/step - loss: 0.4042 - acc: 0.8768
Epoch 15/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3383 - acc: 0.9049
Epoch 16/27

33/33 [==============================] - 1s 33ms/step - loss: 0.3265 - acc: 0.8945
Epoch 17/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2901 - acc: 0.9134
Epoch 18/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2845 - acc: 0.9226
Epoch 19/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2781 - acc: 0.9177
Epoch 20/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2611 - acc: 0.9218
Epoch 21/27

33/33 [==============================] - 1s 33ms/step - loss: 0.2443 - acc: 0.9309
Epoch 22/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2305 - acc: 0.9416
Epoch 23/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2234 - acc: 0.9341
Epoch 24/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2062 - acc: 0.9503
Epoch 25/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1958 - acc: 0.9471
Epoch 26/27

33/33 [==============================] - 1s 32ms/step - loss: 0.1864 - acc: 0.9586
Epoch 27/27

33/33 [==============================] - 1s 32ms/step - loss: 0.1844 - acc: 0.9538
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7303
False 1768
True percentage 0.805093154007
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.88      0.95      0.92      7318
      B-PER       0.75      0.25      0.37       438
      B-ORG       0.46      0.44      0.45       296
      I-ORG       0.37      0.32      0.35       151
      I-PER       0.94      0.21      0.34       214
      B-LOC       0.36      0.08      0.13       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.67      0.01      0.03       154

avg / total       0.81      0.81      0.79      9071

F-1 Score (without O):
0.292339544513
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 10
Found 100004 word vectors.
Found 84 char vectors.
Found 100055 unique words.
Found 94 unique chars.
Found 9 unique labels.
51 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 318
OOV word occurences: 533
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6403584     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,510,146
Trainable params: 6,510,146
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 4s 117ms/step - loss: 2.2041 - acc: 0.3830
Epoch 2/27

33/33 [==============================] - 1s 33ms/step - loss: 0.9839 - acc: 0.7746
Epoch 3/27

33/33 [==============================] - 1s 32ms/step - loss: 0.9074 - acc: 0.7835
Epoch 4/27

33/33 [==============================] - 1s 34ms/step - loss: 0.7627 - acc: 0.7861
Epoch 5/27

33/33 [==============================] - 1s 32ms/step - loss: 0.6750 - acc: 0.7935
Epoch 6/27

33/33 [==============================] - 1s 33ms/step - loss: 0.6298 - acc: 0.7977
Epoch 7/27

33/33 [==============================] - 1s 32ms/step - loss: 0.5726 - acc: 0.8076
Epoch 8/27

33/33 [==============================] - 1s 34ms/step - loss: 0.5177 - acc: 0.8338
Epoch 9/27

33/33 [==============================] - 1s 32ms/step - loss: 0.4839 - acc: 0.8604
Epoch 10/27

33/33 [==============================] - 1s 31ms/step - loss: 1.2087 - acc: 0.8110
Epoch 11/27

33/33 [==============================] - 1s 32ms/step - loss: 0.4406 - acc: 0.8621
Epoch 12/27

33/33 [==============================] - 1s 31ms/step - loss: 0.4214 - acc: 0.8847
Epoch 13/27

33/33 [==============================] - 1s 33ms/step - loss: 0.4078 - acc: 0.8913
Epoch 14/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3803 - acc: 0.8878
Epoch 15/27

33/33 [==============================] - 1s 32ms/step - loss: 0.3691 - acc: 0.8924
Epoch 16/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3471 - acc: 0.8901
Epoch 17/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3247 - acc: 0.9196
Epoch 18/27

33/33 [==============================] - 1s 32ms/step - loss: 0.3066 - acc: 0.9177
Epoch 19/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2919 - acc: 0.9350
Epoch 20/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2789 - acc: 0.9436
Epoch 21/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2707 - acc: 0.9343
Epoch 22/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2443 - acc: 0.9512
Epoch 23/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2440 - acc: 0.9408
Epoch 24/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2469 - acc: 0.9479
Epoch 25/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2342 - acc: 0.9505
Epoch 26/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2097 - acc: 0.9547
Epoch 27/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2031 - acc: 0.9572
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7459
False 1612
True percentage 0.822290816889
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.95      0.94      7318
      B-PER       0.70      0.52      0.60       438
      B-ORG       0.35      0.40      0.37       296
      I-ORG       0.25      0.36      0.29       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      I-PER       0.51      0.23      0.32       214
      B-LOC       0.68      0.20      0.31       218
      I-LOC       0.77      0.17      0.28       141

avg / total       0.84      0.82      0.82      9071

F-1 Score (without O):
0.365377793544
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 11
Found 100004 word vectors.
Found 84 char vectors.
Found 100041 unique words.
Found 93 unique chars.
Found 9 unique labels.
37 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 322
OOV word occurences: 633
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6402688     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,509,186
Trainable params: 6,509,186
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 4s 116ms/step - loss: 1.9549 - acc: 0.4284
Epoch 2/27

33/33 [==============================] - 1s 33ms/step - loss: 0.7989 - acc: 0.8214
Epoch 3/27

33/33 [==============================] - 1s 33ms/step - loss: 0.7572 - acc: 0.8260
Epoch 4/27

33/33 [==============================] - 1s 33ms/step - loss: 0.6268 - acc: 0.8222
Epoch 5/27

33/33 [==============================] - 1s 32ms/step - loss: 0.5573 - acc: 0.8235
Epoch 6/27

33/33 [==============================] - 1s 33ms/step - loss: 0.5025 - acc: 0.8275
Epoch 7/27

33/33 [==============================] - 1s 32ms/step - loss: 0.4540 - acc: 0.8377
Epoch 8/27

33/33 [==============================] - 1s 33ms/step - loss: 0.4335 - acc: 0.8485
Epoch 9/27

33/33 [==============================] - 1s 32ms/step - loss: 0.3984 - acc: 0.8615
Epoch 10/27

33/33 [==============================] - 1s 32ms/step - loss: 0.4293 - acc: 0.9244
Epoch 11/27

33/33 [==============================] - 1s 32ms/step - loss: 0.3469 - acc: 0.8985
Epoch 12/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3238 - acc: 0.8966
Epoch 13/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2988 - acc: 0.8948
Epoch 14/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2831 - acc: 0.9236
Epoch 15/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2710 - acc: 0.9199
Epoch 16/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2438 - acc: 0.9362
Epoch 17/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2344 - acc: 0.9477
Epoch 18/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2180 - acc: 0.9469
Epoch 19/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2073 - acc: 0.9438
Epoch 20/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1939 - acc: 0.9579
Epoch 21/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1722 - acc: 0.9613
Epoch 22/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1648 - acc: 0.9583
Epoch 23/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1629 - acc: 0.9638
Epoch 24/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1659 - acc: 0.9633
Epoch 25/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1491 - acc: 0.9737
Epoch 26/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1430 - acc: 0.9702
Epoch 27/27

33/33 [==============================] - 1s 32ms/step - loss: 0.1379 - acc: 0.9685
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7231
False 1840
True percentage 0.797155771139
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.43      0.30      0.35       296
          O       0.88      0.95      0.92      7318
     B-MISC       0.09      0.05      0.06       141
     I-MISC       0.03      0.01      0.01       154
      B-PER       0.74      0.26      0.39       438
      I-PER       0.79      0.09      0.16       214
      B-LOC       1.00      0.03      0.06       218
      I-LOC       0.59      0.16      0.26       141
      I-ORG       0.62      0.05      0.10       151

avg / total       0.83      0.80      0.78      9071

F-1 Score (without O):
0.839938845113
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 100047 unique words.
Found 93 unique chars.
Found 9 unique labels.
43 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 322
OOV word occurences: 603
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6403072     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,509,570
Trainable params: 6,509,570
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 4s 117ms/step - loss: 1.5835 - acc: 0.5672
Epoch 2/27

33/33 [==============================] - 1s 33ms/step - loss: 0.8320 - acc: 0.8124
Epoch 3/27

33/33 [==============================] - 1s 32ms/step - loss: 0.7030 - acc: 0.8171
Epoch 4/27

33/33 [==============================] - 1s 34ms/step - loss: 0.7053 - acc: 0.8141
Epoch 5/27

33/33 [==============================] - 1s 32ms/step - loss: 0.6007 - acc: 0.8178
Epoch 6/27

33/33 [==============================] - 1s 34ms/step - loss: 0.5634 - acc: 0.8213
Epoch 7/27

33/33 [==============================] - 1s 32ms/step - loss: 0.5088 - acc: 0.8371
Epoch 8/27

33/33 [==============================] - 1s 31ms/step - loss: 0.4811 - acc: 0.8425
Epoch 9/27

33/33 [==============================] - 1s 33ms/step - loss: 0.4505 - acc: 0.8415
Epoch 10/27

33/33 [==============================] - 1s 31ms/step - loss: 0.4028 - acc: 0.8608
Epoch 11/27

33/33 [==============================] - 1s 32ms/step - loss: 0.3696 - acc: 0.8920
Epoch 12/27

33/33 [==============================] - 1s 31ms/step - loss: 0.5098 - acc: 0.8766
Epoch 13/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3296 - acc: 0.8974
Epoch 14/27

33/33 [==============================] - 1s 32ms/step - loss: 0.3215 - acc: 0.9049
Epoch 15/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3003 - acc: 0.9082
Epoch 16/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2863 - acc: 0.9165
Epoch 17/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2584 - acc: 0.9276
Epoch 18/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2576 - acc: 0.9246
Epoch 19/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2433 - acc: 0.9423
Epoch 20/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2274 - acc: 0.9390
Epoch 21/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2176 - acc: 0.9420
Epoch 22/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2078 - acc: 0.9413
Epoch 23/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2002 - acc: 0.9438
Epoch 24/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1863 - acc: 0.9472
Epoch 25/27

33/33 [==============================] - 1s 32ms/step - loss: 0.1768 - acc: 0.9507
Epoch 26/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1730 - acc: 0.9419
Epoch 27/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1650 - acc: 0.9528
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7239
False 1832
True percentage 0.798037702569
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.69      0.24      0.36       438
      I-PER       0.00      0.00      0.00       214
          O       0.95      0.94      0.94      7318
      B-ORG       0.30      0.61      0.41       296
      B-LOC       1.00      0.01      0.02       218
      I-ORG       0.19      0.58      0.29       151
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.36      0.03      0.05       154

avg / total       0.84      0.80      0.80      9071

F-1 Score (without O):
0.841751239084
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100027 unique words.
Found 87 unique chars.
Found 7 unique labels.
23 unique words not found in embedding.
3 unique chars not found in embedding.
Number of OOV: 327
OOV word occurences: 638
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5632        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401792     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 8)        1112        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,608
Trainable params: 6,507,608
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 3s 195ms/step - loss: 2.1106 - acc: 0.0337
Epoch 2/27

16/16 [==============================] - 0s 28ms/step - loss: 0.9856 - acc: 0.8287
Epoch 3/27

16/16 [==============================] - 0s 27ms/step - loss: 0.7483 - acc: 0.8287
Epoch 4/27

16/16 [==============================] - 0s 26ms/step - loss: 0.6730 - acc: 0.8287
Epoch 5/27

16/16 [==============================] - 0s 27ms/step - loss: 0.5909 - acc: 0.8287
Epoch 6/27

16/16 [==============================] - 0s 25ms/step - loss: 0.5449 - acc: 0.8287
Epoch 7/27

16/16 [==============================] - 0s 27ms/step - loss: 0.5070 - acc: 0.8315
Epoch 8/27

16/16 [==============================] - 0s 27ms/step - loss: 0.4749 - acc: 0.8371
Epoch 9/27

16/16 [==============================] - 0s 28ms/step - loss: 0.4326 - acc: 0.8371
Epoch 10/27

16/16 [==============================] - 0s 26ms/step - loss: 0.3973 - acc: 0.8427
Epoch 11/27

16/16 [==============================] - 0s 26ms/step - loss: 0.3652 - acc: 0.8652
Epoch 12/27

16/16 [==============================] - 0s 26ms/step - loss: 0.3378 - acc: 0.8820
Epoch 13/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2886 - acc: 0.8876
Epoch 14/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2765 - acc: 0.9185
Epoch 15/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2827 - acc: 0.8876
Epoch 16/27

16/16 [==============================] - 0s 26ms/step - loss: 0.3239 - acc: 0.9663
Epoch 17/27

16/16 [==============================] - 0s 25ms/step - loss: 0.2316 - acc: 0.9213
Epoch 18/27

16/16 [==============================] - 0s 26ms/step - loss: 0.2057 - acc: 0.9522
Epoch 19/27

16/16 [==============================] - 0s 26ms/step - loss: 0.1897 - acc: 0.9522
Epoch 20/27

16/16 [==============================] - 0s 26ms/step - loss: 0.1796 - acc: 0.9607
Epoch 21/27

16/16 [==============================] - 0s 26ms/step - loss: 0.1627 - acc: 0.9831
Epoch 22/27

16/16 [==============================] - 0s 25ms/step - loss: 0.1428 - acc: 0.9775
Epoch 23/27

16/16 [==============================] - 0s 24ms/step - loss: 0.1379 - acc: 0.9803
Epoch 24/27

16/16 [==============================] - 0s 26ms/step - loss: 0.1335 - acc: 0.9831
Epoch 25/27

16/16 [==============================] - 0s 25ms/step - loss: 0.1251 - acc: 0.9831
Epoch 26/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1093 - acc: 0.9860
Epoch 27/27

16/16 [==============================] - 0s 25ms/step - loss: 0.1078 - acc: 0.9860
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7186
False 1590
True percentage 0.818824065634
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.87      0.95      0.91      7318
      B-PER       0.73      0.16      0.27       438
      B-ORG       0.41      0.33      0.37       296
      I-ORG       0.13      0.03      0.05       151
      I-PER       0.38      0.14      0.21       214
      B-LOC       0.00      0.00      0.00       218
     B-MISC       0.00      0.00      0.00       141

avg / total       0.79      0.82      0.79      8776

F-1 Score (without O):
0.213836477987
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 100032 unique words.
Found 91 unique chars.
Found 8 unique labels.
28 unique words not found in embedding.
7 unique chars not found in embedding.
Number of OOV: 324
OOV word occurences: 628
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5888        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6402112     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,508,332
Trainable params: 6,508,332
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 3s 195ms/step - loss: 2.1561 - acc: 0.0278
Epoch 2/27

16/16 [==============================] - 0s 28ms/step - loss: 1.0839 - acc: 0.7901
Epoch 3/27

16/16 [==============================] - 0s 26ms/step - loss: 0.9314 - acc: 0.7901
Epoch 4/27

16/16 [==============================] - 0s 27ms/step - loss: 0.8804 - acc: 0.7901
Epoch 5/27

16/16 [==============================] - 0s 26ms/step - loss: 0.7421 - acc: 0.7901
Epoch 6/27

16/16 [==============================] - 0s 27ms/step - loss: 0.6900 - acc: 0.7901
Epoch 7/27

16/16 [==============================] - 0s 27ms/step - loss: 0.6506 - acc: 0.7901
Epoch 8/27

16/16 [==============================] - 0s 30ms/step - loss: 0.6160 - acc: 0.7901
Epoch 9/27

16/16 [==============================] - 0s 26ms/step - loss: 0.5753 - acc: 0.7963
Epoch 10/27

16/16 [==============================] - 0s 27ms/step - loss: 0.5428 - acc: 0.8117
Epoch 11/27

16/16 [==============================] - 0s 26ms/step - loss: 0.5079 - acc: 0.8086
Epoch 12/27

16/16 [==============================] - 0s 27ms/step - loss: 0.4844 - acc: 0.8426
Epoch 13/27

16/16 [==============================] - 0s 27ms/step - loss: 0.4571 - acc: 0.8117
Epoch 14/27

16/16 [==============================] - 0s 27ms/step - loss: 0.4250 - acc: 0.8765
Epoch 15/27

16/16 [==============================] - 0s 26ms/step - loss: 0.4093 - acc: 0.8272
Epoch 16/27

16/16 [==============================] - 0s 26ms/step - loss: 0.3721 - acc: 0.9290
Epoch 17/27

16/16 [==============================] - 0s 26ms/step - loss: 0.3479 - acc: 0.8704
Epoch 18/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3060 - acc: 0.9444
Epoch 19/27

16/16 [==============================] - 0s 29ms/step - loss: 0.3048 - acc: 0.8951
Epoch 20/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2661 - acc: 0.9506
Epoch 21/27

16/16 [==============================] - 0s 26ms/step - loss: 0.2559 - acc: 0.9444
Epoch 22/27

16/16 [==============================] - 0s 26ms/step - loss: 0.2335 - acc: 0.9691
Epoch 23/27

16/16 [==============================] - 0s 26ms/step - loss: 0.2148 - acc: 0.9352
Epoch 24/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2079 - acc: 0.9691
Epoch 25/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1886 - acc: 0.9660
Epoch 26/27

16/16 [==============================] - 0s 26ms/step - loss: 0.1734 - acc: 0.9784
Epoch 27/27

16/16 [==============================] - 0s 25ms/step - loss: 0.1529 - acc: 0.9753
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7202
False 1715
True percentage 0.807670741281
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.90      0.95      0.92      7318
      B-ORG       0.36      0.23      0.28       296
      I-ORG       0.00      0.00      0.00       151
      B-PER       0.49      0.22      0.30       438
      B-LOC       0.37      0.32      0.34       218
      I-LOC       0.30      0.27      0.29       141
      I-PER       0.18      0.02      0.03       214
     B-MISC       0.00      0.00      0.00       141

avg / total       0.79      0.81      0.79      8917

F-1 Score (without O):
0.236819360415
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100017 unique words.
Found 90 unique chars.
Found 9 unique labels.
13 unique words not found in embedding.
6 unique chars not found in embedding.
Number of OOV: 326
OOV word occurences: 636
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5824        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401152     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,458
Trainable params: 6,507,458
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 3s 197ms/step - loss: 2.3714 - acc: 0.0206
Epoch 2/27

16/16 [==============================] - 0s 28ms/step - loss: 1.2131 - acc: 0.8265
Epoch 3/27

16/16 [==============================] - 0s 27ms/step - loss: 0.8111 - acc: 0.8265
Epoch 4/27

16/16 [==============================] - 0s 26ms/step - loss: 0.7431 - acc: 0.8265
Epoch 5/27

16/16 [==============================] - 0s 26ms/step - loss: 0.6676 - acc: 0.8265
Epoch 6/27

16/16 [==============================] - 0s 26ms/step - loss: 0.6232 - acc: 0.8265
Epoch 7/27

16/16 [==============================] - 0s 26ms/step - loss: 0.5853 - acc: 0.8265
Epoch 8/27

16/16 [==============================] - 0s 26ms/step - loss: 0.5505 - acc: 0.8265
Epoch 9/27

16/16 [==============================] - 0s 25ms/step - loss: 0.5279 - acc: 0.8265
Epoch 10/27

16/16 [==============================] - 0s 25ms/step - loss: 0.4957 - acc: 0.8353
Epoch 11/27

16/16 [==============================] - 0s 26ms/step - loss: 0.4643 - acc: 0.8324
Epoch 12/27

16/16 [==============================] - 0s 26ms/step - loss: 0.4243 - acc: 0.8471
Epoch 13/27

16/16 [==============================] - 0s 26ms/step - loss: 0.3930 - acc: 0.8471
Epoch 14/27

16/16 [==============================] - 0s 25ms/step - loss: 0.3688 - acc: 0.8794
Epoch 15/27

16/16 [==============================] - 0s 26ms/step - loss: 0.3304 - acc: 0.8971
Epoch 16/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3046 - acc: 0.9029
Epoch 17/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2743 - acc: 0.9118
Epoch 18/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2521 - acc: 0.9206
Epoch 19/27

16/16 [==============================] - 0s 25ms/step - loss: 0.4210 - acc: 0.8706
Epoch 20/27

16/16 [==============================] - 0s 26ms/step - loss: 0.5172 - acc: 0.9353
Epoch 21/27

16/16 [==============================] - 0s 26ms/step - loss: 0.2386 - acc: 0.9412
Epoch 22/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2264 - acc: 0.9353
Epoch 23/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2137 - acc: 0.9382
Epoch 24/27

16/16 [==============================] - 0s 26ms/step - loss: 0.1985 - acc: 0.9471
Epoch 25/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1848 - acc: 0.9529
Epoch 26/27

16/16 [==============================] - 0s 26ms/step - loss: 0.1752 - acc: 0.9559
Epoch 27/27

16/16 [==============================] - 0s 25ms/step - loss: 0.1642 - acc: 0.9559
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7171
False 1900
True percentage 0.790541285415
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.87      0.95      0.91      7318
      B-PER       0.66      0.18      0.29       438
      B-ORG       0.39      0.33      0.36       296
      I-ORG       0.33      0.01      0.01       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      I-PER       0.36      0.02      0.04       214
      B-LOC       0.67      0.01      0.02       218
      I-LOC       0.00      0.00      0.00       141

avg / total       0.78      0.79      0.76      9071

F-1 Score (without O):
0.173953488372
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 100036 unique words.
Found 94 unique chars.
Found 9 unique labels.
32 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 327
OOV word occurences: 640
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6402368     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,508,930
Trainable params: 6,508,930
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 3s 202ms/step - loss: 2.1871 - acc: 0.2328
Epoch 2/27

16/16 [==============================] - 0s 29ms/step - loss: 1.1393 - acc: 0.7625
Epoch 3/27

16/16 [==============================] - 0s 26ms/step - loss: 1.1090 - acc: 0.7625
Epoch 4/27

16/16 [==============================] - 0s 27ms/step - loss: 0.9798 - acc: 0.7648
Epoch 5/27

16/16 [==============================] - 0s 27ms/step - loss: 0.8357 - acc: 0.7625
Epoch 6/27

16/16 [==============================] - 0s 26ms/step - loss: 0.7625 - acc: 0.7625
Epoch 7/27

16/16 [==============================] - 0s 26ms/step - loss: 0.7224 - acc: 0.7672
Epoch 8/27

16/16 [==============================] - 0s 26ms/step - loss: 0.6861 - acc: 0.7767
Epoch 9/27

16/16 [==============================] - 0s 27ms/step - loss: 0.6405 - acc: 0.7838
Epoch 10/27

16/16 [==============================] - 0s 27ms/step - loss: 0.5923 - acc: 0.7933
Epoch 11/27

16/16 [==============================] - 0s 27ms/step - loss: 0.5585 - acc: 0.8409
Epoch 12/27

16/16 [==============================] - 0s 26ms/step - loss: 0.5441 - acc: 0.8242
Epoch 13/27

16/16 [==============================] - 0s 26ms/step - loss: 0.5026 - acc: 0.8694
Epoch 14/27

16/16 [==============================] - 0s 27ms/step - loss: 0.4773 - acc: 0.8575
Epoch 15/27

16/16 [==============================] - 0s 27ms/step - loss: 0.4415 - acc: 0.8741
Epoch 16/27

16/16 [==============================] - 0s 27ms/step - loss: 0.4101 - acc: 0.8717
Epoch 17/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3745 - acc: 0.8931
Epoch 18/27

16/16 [==============================] - 0s 26ms/step - loss: 0.3602 - acc: 0.8789
Epoch 19/27

16/16 [==============================] - 0s 25ms/step - loss: 0.3303 - acc: 0.9050
Epoch 20/27

16/16 [==============================] - 0s 26ms/step - loss: 0.3141 - acc: 0.9074
Epoch 21/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2995 - acc: 0.9121
Epoch 22/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2845 - acc: 0.9145
Epoch 23/27

16/16 [==============================] - 0s 26ms/step - loss: 0.2742 - acc: 0.9382
Epoch 24/27

16/16 [==============================] - 0s 26ms/step - loss: 0.2339 - acc: 0.9192
Epoch 25/27

16/16 [==============================] - 0s 25ms/step - loss: 0.2176 - acc: 0.9596
Epoch 26/27

16/16 [==============================] - 0s 25ms/step - loss: 0.2072 - acc: 0.9549
Epoch 27/27

16/16 [==============================] - 0s 26ms/step - loss: 0.2014 - acc: 0.9501
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7190
False 1881
True percentage 0.792635872561
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.90      0.95      0.92      7318
      B-ORG       0.30      0.31      0.31       296
      B-PER       0.49      0.20      0.28       438
      I-PER       0.21      0.04      0.06       214
      B-LOC       0.78      0.24      0.37       218
      I-LOC       0.00      0.00      0.00       141
      I-ORG       0.15      0.12      0.13       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.78      0.79      0.78      9071

F-1 Score (without O):
0.208858187729
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 100030 unique words.
Found 94 unique chars.
Found 9 unique labels.
26 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 324
OOV word occurences: 635
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401984     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,508,546
Trainable params: 6,508,546
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 3s 198ms/step - loss: 2.3738 - acc: 0.0172
Epoch 2/27

16/16 [==============================] - 0s 28ms/step - loss: 1.3027 - acc: 0.8534
Epoch 3/27

16/16 [==============================] - 0s 28ms/step - loss: 0.7309 - acc: 0.8534
Epoch 4/27

16/16 [==============================] - 0s 28ms/step - loss: 0.6723 - acc: 0.8534
Epoch 5/27

16/16 [==============================] - 0s 26ms/step - loss: 0.6343 - acc: 0.8534
Epoch 6/27

16/16 [==============================] - 0s 26ms/step - loss: 0.6159 - acc: 0.8534
Epoch 7/27

16/16 [==============================] - 0s 28ms/step - loss: 0.5967 - acc: 0.8534
Epoch 8/27

16/16 [==============================] - 0s 29ms/step - loss: 0.5877 - acc: 0.8534
Epoch 9/27

16/16 [==============================] - 0s 27ms/step - loss: 0.6092 - acc: 0.8534
Epoch 10/27

16/16 [==============================] - 0s 26ms/step - loss: 0.5330 - acc: 0.8534
Epoch 11/27

16/16 [==============================] - 0s 26ms/step - loss: 0.5008 - acc: 0.8534
Epoch 12/27

16/16 [==============================] - 0s 26ms/step - loss: 0.4454 - acc: 0.8534
Epoch 13/27

16/16 [==============================] - 0s 27ms/step - loss: 0.4187 - acc: 0.8534
Epoch 14/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3959 - acc: 0.8563
Epoch 15/27

16/16 [==============================] - 0s 26ms/step - loss: 0.3636 - acc: 0.8592
Epoch 16/27

16/16 [==============================] - 0s 26ms/step - loss: 0.3368 - acc: 0.8621
Epoch 17/27

16/16 [==============================] - 0s 26ms/step - loss: 0.3167 - acc: 0.8851
Epoch 18/27

16/16 [==============================] - 0s 26ms/step - loss: 0.3076 - acc: 0.8879
Epoch 19/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2786 - acc: 0.9023
Epoch 20/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2646 - acc: 0.9023
Epoch 21/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2486 - acc: 0.9425
Epoch 22/27

16/16 [==============================] - 0s 26ms/step - loss: 0.3605 - acc: 0.8707
Epoch 23/27

16/16 [==============================] - 0s 26ms/step - loss: 0.4122 - acc: 0.9569
Epoch 24/27

16/16 [==============================] - 0s 25ms/step - loss: 0.2197 - acc: 0.9483
Epoch 25/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2116 - acc: 0.9425
Epoch 26/27

16/16 [==============================] - 0s 26ms/step - loss: 0.1926 - acc: 0.9626
Epoch 27/27

16/16 [==============================] - 0s 26ms/step - loss: 0.1878 - acc: 0.9569
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7137
False 1934
True percentage 0.786793076838
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.45      0.08      0.14       438
          O       0.86      0.96      0.91      7318
      B-ORG       0.41      0.25      0.31       296
     B-MISC       0.75      0.04      0.08       141
      I-ORG       0.00      0.00      0.00       151
      I-PER       1.00      0.05      0.10       214
     I-MISC       0.25      0.03      0.05       154
      B-LOC       0.04      0.00      0.01       218
      I-LOC       1.00      0.08      0.14       141

avg / total       0.79      0.79      0.76      9071

F-1 Score (without O):
0.83595267526
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 100022 unique words.
Found 90 unique chars.
Found 9 unique labels.
18 unique words not found in embedding.
6 unique chars not found in embedding.
Number of OOV: 323
OOV word occurences: 632
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5824        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401472     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,778
Trainable params: 6,507,778
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 3s 197ms/step - loss: 2.1956 - acc: 0.1761
Epoch 2/27

16/16 [==============================] - 0s 28ms/step - loss: 1.2073 - acc: 0.7925
Epoch 3/27

16/16 [==============================] - 0s 28ms/step - loss: 0.9107 - acc: 0.7956
Epoch 4/27

16/16 [==============================] - 0s 26ms/step - loss: 0.8621 - acc: 0.7956
Epoch 5/27

16/16 [==============================] - 0s 26ms/step - loss: 0.7631 - acc: 0.7956
Epoch 6/27

16/16 [==============================] - 0s 27ms/step - loss: 0.7068 - acc: 0.7956
Epoch 7/27

16/16 [==============================] - 0s 28ms/step - loss: 0.6544 - acc: 0.7956
Epoch 8/27

16/16 [==============================] - 0s 26ms/step - loss: 0.6123 - acc: 0.7956
Epoch 9/27

16/16 [==============================] - 0s 28ms/step - loss: 0.5713 - acc: 0.7956
Epoch 10/27

16/16 [==============================] - 0s 26ms/step - loss: 0.5410 - acc: 0.8270
Epoch 11/27

16/16 [==============================] - 0s 26ms/step - loss: 0.5108 - acc: 0.7956
Epoch 12/27

16/16 [==============================] - 0s 26ms/step - loss: 0.4463 - acc: 0.8774
Epoch 13/27

16/16 [==============================] - 0s 26ms/step - loss: 0.4173 - acc: 0.8428
Epoch 14/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3771 - acc: 0.8994
Epoch 15/27

16/16 [==============================] - 0s 26ms/step - loss: 0.3415 - acc: 0.8774
Epoch 16/27

16/16 [==============================] - 0s 26ms/step - loss: 0.3049 - acc: 0.9434
Epoch 17/27

16/16 [==============================] - 0s 26ms/step - loss: 0.2956 - acc: 0.8931
Epoch 18/27

16/16 [==============================] - 0s 26ms/step - loss: 0.2894 - acc: 0.9560
Epoch 19/27

16/16 [==============================] - 0s 26ms/step - loss: 0.2526 - acc: 0.9119
Epoch 20/27

16/16 [==============================] - 0s 26ms/step - loss: 0.2224 - acc: 0.9591
Epoch 21/27

16/16 [==============================] - 0s 26ms/step - loss: 0.2029 - acc: 0.9591
Epoch 22/27

16/16 [==============================] - 0s 26ms/step - loss: 0.1892 - acc: 0.9654
Epoch 23/27

16/16 [==============================] - 0s 25ms/step - loss: 0.1745 - acc: 0.9654
Epoch 24/27

16/16 [==============================] - 0s 25ms/step - loss: 0.1777 - acc: 0.9654
Epoch 25/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1570 - acc: 0.9748
Epoch 26/27

16/16 [==============================] - 0s 26ms/step - loss: 0.1348 - acc: 0.9811
Epoch 27/27

16/16 [==============================] - 0s 26ms/step - loss: 0.1254 - acc: 0.9811
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7138
False 1933
True percentage 0.786903318267
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.89      0.94      0.91      7318
      B-PER       0.59      0.16      0.25       438
      B-ORG       0.31      0.42      0.36       296
      I-ORG       0.16      0.08      0.11       151
      B-LOC       0.52      0.10      0.17       218
      I-PER       1.00      0.01      0.03       214
     B-MISC       0.00      0.00      0.00       141
      I-LOC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.79      0.79      0.77      9071

F-1 Score (without O):
0.192549183759
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 100019 unique words.
Found 94 unique chars.
Found 9 unique labels.
15 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 326
OOV word occurences: 636
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401280     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,842
Trainable params: 6,507,842
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 3s 197ms/step - loss: 2.2981 - acc: 0.0568
Epoch 2/27

16/16 [==============================] - 0s 28ms/step - loss: 1.2793 - acc: 0.7855
Epoch 3/27

16/16 [==============================] - 0s 27ms/step - loss: 0.9632 - acc: 0.7855
Epoch 4/27

16/16 [==============================] - 0s 27ms/step - loss: 0.9470 - acc: 0.7855
Epoch 5/27

16/16 [==============================] - 0s 28ms/step - loss: 0.7973 - acc: 0.7855
Epoch 6/27

16/16 [==============================] - 0s 27ms/step - loss: 0.7560 - acc: 0.7855
Epoch 7/27

16/16 [==============================] - 0s 27ms/step - loss: 0.6998 - acc: 0.7855
Epoch 8/27

16/16 [==============================] - 0s 27ms/step - loss: 0.6630 - acc: 0.7855
Epoch 9/27

16/16 [==============================] - 0s 29ms/step - loss: 0.6134 - acc: 0.7855
Epoch 10/27

16/16 [==============================] - 0s 27ms/step - loss: 0.5769 - acc: 0.7886
Epoch 11/27

16/16 [==============================] - 0s 26ms/step - loss: 0.5219 - acc: 0.8139
Epoch 12/27

16/16 [==============================] - 0s 26ms/step - loss: 0.4818 - acc: 0.8202
Epoch 13/27

16/16 [==============================] - 0s 26ms/step - loss: 0.4497 - acc: 0.8391
Epoch 14/27

16/16 [==============================] - 0s 27ms/step - loss: 0.4171 - acc: 0.8580
Epoch 15/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3849 - acc: 0.8580
Epoch 16/27

16/16 [==============================] - 0s 26ms/step - loss: 0.3623 - acc: 0.9211
Epoch 17/27

16/16 [==============================] - 0s 26ms/step - loss: 0.4042 - acc: 0.8360
Epoch 18/27

16/16 [==============================] - 0s 25ms/step - loss: 0.4578 - acc: 0.9369
Epoch 19/27

16/16 [==============================] - 0s 25ms/step - loss: 0.2968 - acc: 0.9148
Epoch 20/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2611 - acc: 0.9338
Epoch 21/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2383 - acc: 0.9401
Epoch 22/27

16/16 [==============================] - 0s 26ms/step - loss: 0.2361 - acc: 0.9558
Epoch 23/27

16/16 [==============================] - 0s 26ms/step - loss: 0.2064 - acc: 0.9527
Epoch 24/27

16/16 [==============================] - 0s 25ms/step - loss: 0.2094 - acc: 0.9558
Epoch 25/27

16/16 [==============================] - 0s 25ms/step - loss: 0.1984 - acc: 0.9685
Epoch 26/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1730 - acc: 0.9653
Epoch 27/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1706 - acc: 0.9685
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7275
False 1796
True percentage 0.802006394003
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.88      0.95      0.92      7318
      B-PER       0.83      0.20      0.33       438
      I-PER       0.57      0.19      0.29       214
      B-ORG       0.47      0.33      0.38       296
      I-ORG       0.24      0.07      0.10       151
      B-LOC       0.62      0.27      0.37       218
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      I-LOC       0.61      0.10      0.17       141

avg / total       0.81      0.80      0.79      9071

F-1 Score (without O):
0.268929503916
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 100026 unique words.
Found 89 unique chars.
Found 9 unique labels.
22 unique words not found in embedding.
5 unique chars not found in embedding.
Number of OOV: 325
OOV word occurences: 565
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5760        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401728     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,970
Trainable params: 6,507,970
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 3s 200ms/step - loss: 2.6071 - acc: 0.0082
Epoch 2/27

16/16 [==============================] - 0s 28ms/step - loss: 1.6142 - acc: 0.7534
Epoch 3/27

16/16 [==============================] - 0s 28ms/step - loss: 0.9535 - acc: 0.7890
Epoch 4/27

16/16 [==============================] - 0s 28ms/step - loss: 0.8237 - acc: 0.7890
Epoch 5/27

16/16 [==============================] - 0s 27ms/step - loss: 0.7949 - acc: 0.7890
Epoch 6/27

16/16 [==============================] - 0s 26ms/step - loss: 0.9483 - acc: 0.8192
Epoch 7/27

16/16 [==============================] - 0s 26ms/step - loss: 0.8283 - acc: 0.7890
Epoch 8/27

16/16 [==============================] - 0s 26ms/step - loss: 0.7417 - acc: 0.8027
Epoch 9/27

16/16 [==============================] - 0s 28ms/step - loss: 0.6295 - acc: 0.7945
Epoch 10/27

16/16 [==============================] - 0s 28ms/step - loss: 0.5789 - acc: 0.8027
Epoch 11/27

16/16 [==============================] - 0s 26ms/step - loss: 0.5443 - acc: 0.8219
Epoch 12/27

16/16 [==============================] - 0s 26ms/step - loss: 0.4951 - acc: 0.8301
Epoch 13/27

16/16 [==============================] - 0s 25ms/step - loss: 0.4736 - acc: 0.8411
Epoch 14/27

16/16 [==============================] - 0s 26ms/step - loss: 0.4460 - acc: 0.8548
Epoch 15/27

16/16 [==============================] - 0s 25ms/step - loss: 0.4131 - acc: 0.8603
Epoch 16/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3877 - acc: 0.8630
Epoch 17/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3609 - acc: 0.9041
Epoch 18/27

16/16 [==============================] - 0s 26ms/step - loss: 0.3266 - acc: 0.9014
Epoch 19/27

16/16 [==============================] - 0s 26ms/step - loss: 0.3146 - acc: 0.9178
Epoch 20/27

16/16 [==============================] - 0s 26ms/step - loss: 0.2736 - acc: 0.9205
Epoch 21/27

16/16 [==============================] - 0s 25ms/step - loss: 0.2680 - acc: 0.9205
Epoch 22/27

16/16 [==============================] - 0s 25ms/step - loss: 0.2529 - acc: 0.9342
Epoch 23/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2214 - acc: 0.9479
Epoch 24/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2156 - acc: 0.9479
Epoch 25/27

16/16 [==============================] - 0s 26ms/step - loss: 0.2157 - acc: 0.9370
Epoch 26/27

16/16 [==============================] - 0s 26ms/step - loss: 0.2585 - acc: 0.9534
Epoch 27/27

16/16 [==============================] - 0s 26ms/step - loss: 0.1990 - acc: 0.9562
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7124
False 1947
True percentage 0.785359938265
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.87      0.95      0.91      7318
     B-MISC       0.03      0.01      0.02       141
     I-MISC       0.00      0.00      0.00       154
      B-ORG       0.30      0.31      0.31       296
      B-LOC       0.00      0.00      0.00       218
      B-PER       0.70      0.13      0.21       438
      I-PER       0.50      0.00      0.01       214
      I-ORG       0.15      0.08      0.10       151
      I-LOC       0.00      0.00      0.00       141

avg / total       0.76      0.79      0.76      9071

F-1 Score (without O):
0.142042963612
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 8
Found 100004 word vectors.
Found 84 char vectors.
Found 100030 unique words.
Found 93 unique chars.
Found 9 unique labels.
26 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 321
OOV word occurences: 546
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401984     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,508,482
Trainable params: 6,508,482
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 4s 238ms/step - loss: 2.3352 - acc: 0.0245
Epoch 2/27

16/16 [==============================] - 0s 28ms/step - loss: 1.3789 - acc: 0.7454
Epoch 3/27

16/16 [==============================] - 0s 26ms/step - loss: 1.0793 - acc: 0.7454
Epoch 4/27

16/16 [==============================] - 0s 26ms/step - loss: 1.0571 - acc: 0.7485
Epoch 5/27

16/16 [==============================] - 0s 27ms/step - loss: 0.9260 - acc: 0.7454
Epoch 6/27

16/16 [==============================] - 0s 26ms/step - loss: 0.8950 - acc: 0.7454
Epoch 7/27

16/16 [==============================] - 0s 26ms/step - loss: 0.8388 - acc: 0.7454
Epoch 8/27

16/16 [==============================] - 0s 26ms/step - loss: 0.7815 - acc: 0.7485
Epoch 9/27

16/16 [==============================] - 0s 26ms/step - loss: 0.7299 - acc: 0.7454
Epoch 10/27

16/16 [==============================] - 0s 26ms/step - loss: 0.6830 - acc: 0.7577
Epoch 11/27

16/16 [==============================] - 0s 26ms/step - loss: 0.6341 - acc: 0.7577
Epoch 12/27

16/16 [==============================] - 0s 26ms/step - loss: 0.5953 - acc: 0.7914
Epoch 13/27

16/16 [==============================] - 0s 25ms/step - loss: 0.5479 - acc: 0.7883
Epoch 14/27

16/16 [==============================] - 0s 25ms/step - loss: 0.5178 - acc: 0.8466
Epoch 15/27

16/16 [==============================] - 0s 26ms/step - loss: 0.5040 - acc: 0.7761
Epoch 16/27

16/16 [==============================] - 0s 26ms/step - loss: 0.5040 - acc: 0.8957
Epoch 17/27

16/16 [==============================] - 0s 27ms/step - loss: 0.4272 - acc: 0.8221
Epoch 18/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3840 - acc: 0.8804
Epoch 19/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3679 - acc: 0.8681
Epoch 20/27

16/16 [==============================] - 0s 26ms/step - loss: 0.3251 - acc: 0.8957
Epoch 21/27

16/16 [==============================] - 0s 25ms/step - loss: 0.3089 - acc: 0.8896
Epoch 22/27

16/16 [==============================] - 0s 25ms/step - loss: 0.2872 - acc: 0.9172
Epoch 23/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2651 - acc: 0.9172
Epoch 24/27

16/16 [==============================] - 0s 29ms/step - loss: 0.2482 - acc: 0.9479
Epoch 25/27

16/16 [==============================] - 0s 26ms/step - loss: 0.2422 - acc: 0.9294
Epoch 26/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2635 - acc: 0.9663
Epoch 27/27

16/16 [==============================] - 0s 26ms/step - loss: 0.2046 - acc: 0.9663
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7273
False 1798
True percentage 0.801785911145
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.90      0.95      0.92      7318
     B-MISC       0.44      0.05      0.09       141
      B-ORG       0.31      0.42      0.36       296
      B-PER       0.60      0.21      0.31       438
     I-MISC       0.00      0.00      0.00       154
      I-PER       0.90      0.16      0.28       214
      I-ORG       0.24      0.21      0.22       151
      B-LOC       0.71      0.02      0.04       218
      I-LOC       0.00      0.00      0.00       141

avg / total       0.81      0.80      0.79      9071

F-1 Score (without O):
0.23642172524
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 9
Found 100004 word vectors.
Found 84 char vectors.
Found 100020 unique words.
Found 89 unique chars.
Found 9 unique labels.
16 unique words not found in embedding.
5 unique chars not found in embedding.
Number of OOV: 325
OOV word occurences: 558
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5760        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401344     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,586
Trainable params: 6,507,586
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 3s 198ms/step - loss: 2.3204 - acc: 0.0575
Epoch 2/27

16/16 [==============================] - 0s 28ms/step - loss: 1.1150 - acc: 0.8498
Epoch 3/27

16/16 [==============================] - 0s 26ms/step - loss: 0.6876 - acc: 0.8498
Epoch 4/27

16/16 [==============================] - 0s 28ms/step - loss: 0.6112 - acc: 0.8498
Epoch 5/27

16/16 [==============================] - 0s 28ms/step - loss: 0.5610 - acc: 0.8498
Epoch 6/27

16/16 [==============================] - 0s 27ms/step - loss: 0.5174 - acc: 0.8498
Epoch 7/27

16/16 [==============================] - 0s 26ms/step - loss: 0.4827 - acc: 0.8498
Epoch 8/27

16/16 [==============================] - 0s 28ms/step - loss: 0.4355 - acc: 0.8530
Epoch 9/27

16/16 [==============================] - 0s 29ms/step - loss: 0.4215 - acc: 0.8530
Epoch 10/27

16/16 [==============================] - 0s 26ms/step - loss: 0.4104 - acc: 0.9073
Epoch 11/27

16/16 [==============================] - 0s 26ms/step - loss: 0.4030 - acc: 0.8530
Epoch 12/27

16/16 [==============================] - 0s 26ms/step - loss: 0.3727 - acc: 0.9297
Epoch 13/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3216 - acc: 0.8754
Epoch 14/27

16/16 [==============================] - 0s 26ms/step - loss: 0.2969 - acc: 0.9201
Epoch 15/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2750 - acc: 0.9361
Epoch 16/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2549 - acc: 0.9297
Epoch 17/27

16/16 [==============================] - 0s 26ms/step - loss: 0.2401 - acc: 0.9393
Epoch 18/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2094 - acc: 0.9425
Epoch 19/27

16/16 [==============================] - 0s 26ms/step - loss: 0.2157 - acc: 0.9393
Epoch 20/27

16/16 [==============================] - 0s 26ms/step - loss: 0.2007 - acc: 0.9425
Epoch 21/27

16/16 [==============================] - 0s 26ms/step - loss: 0.1889 - acc: 0.9521
Epoch 22/27

16/16 [==============================] - 0s 26ms/step - loss: 0.1712 - acc: 0.9489
Epoch 23/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1685 - acc: 0.9585
Epoch 24/27

16/16 [==============================] - 0s 26ms/step - loss: 0.1586 - acc: 0.9489
Epoch 25/27

16/16 [==============================] - 0s 26ms/step - loss: 0.1504 - acc: 0.9617
Epoch 26/27

16/16 [==============================] - 0s 26ms/step - loss: 0.1441 - acc: 0.9521
Epoch 27/27

16/16 [==============================] - 0s 25ms/step - loss: 0.1532 - acc: 0.9649
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7196
False 1875
True percentage 0.793297321133
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.86      0.96      0.91      7318
      B-PER       0.67      0.13      0.21       438
      B-ORG       0.49      0.31      0.38       296
      I-ORG       0.36      0.36      0.36       151
      I-PER       0.00      0.00      0.00       214
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.75      0.79      0.76      9071

F-1 Score (without O):
0.187070151307
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 10
Found 100004 word vectors.
Found 84 char vectors.
Found 100028 unique words.
Found 92 unique chars.
Found 9 unique labels.
24 unique words not found in embedding.
8 unique chars not found in embedding.
Number of OOV: 320
OOV word occurences: 536
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401856     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,508,290
Trainable params: 6,508,290
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 3s 200ms/step - loss: 2.3388 - acc: 0.0506
Epoch 2/27

16/16 [==============================] - 0s 28ms/step - loss: 1.3599 - acc: 0.7837
Epoch 3/27

16/16 [==============================] - 0s 28ms/step - loss: 0.9283 - acc: 0.7837
Epoch 4/27

16/16 [==============================] - 0s 25ms/step - loss: 0.8298 - acc: 0.7837
Epoch 5/27

16/16 [==============================] - 0s 26ms/step - loss: 0.8290 - acc: 0.7837
Epoch 6/27

16/16 [==============================] - 0s 26ms/step - loss: 0.9240 - acc: 0.7949
Epoch 7/27

16/16 [==============================] - 0s 25ms/step - loss: 0.7114 - acc: 0.7837
Epoch 8/27

16/16 [==============================] - 0s 26ms/step - loss: 0.6522 - acc: 0.7837
Epoch 9/27

16/16 [==============================] - 0s 26ms/step - loss: 0.6140 - acc: 0.7865
Epoch 10/27

16/16 [==============================] - 0s 26ms/step - loss: 0.5691 - acc: 0.7949
Epoch 11/27

16/16 [==============================] - 0s 26ms/step - loss: 0.5279 - acc: 0.8090
Epoch 12/27

16/16 [==============================] - 0s 28ms/step - loss: 0.4836 - acc: 0.8258
Epoch 13/27

16/16 [==============================] - 0s 27ms/step - loss: 0.4600 - acc: 0.8567
Epoch 14/27

16/16 [==============================] - 0s 28ms/step - loss: 0.4238 - acc: 0.8904
Epoch 15/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3899 - acc: 0.8652
Epoch 16/27

16/16 [==============================] - 0s 26ms/step - loss: 0.4259 - acc: 0.9242
Epoch 17/27

16/16 [==============================] - 0s 25ms/step - loss: 0.3593 - acc: 0.8792
Epoch 18/27

16/16 [==============================] - 0s 26ms/step - loss: 0.3353 - acc: 0.9270
Epoch 19/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2894 - acc: 0.9213
Epoch 20/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2694 - acc: 0.9326
Epoch 21/27

16/16 [==============================] - 0s 25ms/step - loss: 0.2619 - acc: 0.9270
Epoch 22/27

16/16 [==============================] - 0s 26ms/step - loss: 0.2294 - acc: 0.9607
Epoch 23/27

16/16 [==============================] - 0s 26ms/step - loss: 0.2203 - acc: 0.9354
Epoch 24/27

16/16 [==============================] - 0s 25ms/step - loss: 0.2296 - acc: 0.9663
Epoch 25/27

16/16 [==============================] - 0s 26ms/step - loss: 0.1984 - acc: 0.9326
Epoch 26/27

16/16 [==============================] - 0s 26ms/step - loss: 0.2234 - acc: 0.9831
Epoch 27/27

16/16 [==============================] - 0s 26ms/step - loss: 0.1768 - acc: 0.9635
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7358
False 1713
True percentage 0.811156432587
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.90      0.95      0.93      7318
      B-PER       0.63      0.42      0.50       438
      B-ORG       0.37      0.42      0.39       296
      I-ORG       0.30      0.16      0.21       151
     B-MISC       0.58      0.05      0.09       141
     I-MISC       0.23      0.06      0.10       154
      I-PER       0.78      0.17      0.28       214
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141

avg / total       0.81      0.81      0.80      9071

F-1 Score (without O):
0.300857365549
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 11
Found 100004 word vectors.
Found 84 char vectors.
Found 100017 unique words.
Found 89 unique chars.
Found 9 unique labels.
13 unique words not found in embedding.
5 unique chars not found in embedding.
Number of OOV: 325
OOV word occurences: 636
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5760        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401152     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,394
Trainable params: 6,507,394
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 3s 197ms/step - loss: 2.3258 - acc: 0.0272
Epoch 2/27

16/16 [==============================] - 0s 28ms/step - loss: 1.0642 - acc: 0.8435
Epoch 3/27

16/16 [==============================] - 0s 27ms/step - loss: 0.7049 - acc: 0.8435
Epoch 4/27

16/16 [==============================] - 0s 26ms/step - loss: 0.6549 - acc: 0.8435
Epoch 5/27

16/16 [==============================] - 0s 27ms/step - loss: 0.5968 - acc: 0.8435
Epoch 6/27

16/16 [==============================] - 0s 27ms/step - loss: 0.5563 - acc: 0.8435
Epoch 7/27

16/16 [==============================] - 0s 26ms/step - loss: 0.5283 - acc: 0.8435
Epoch 8/27

16/16 [==============================] - 0s 26ms/step - loss: 0.4909 - acc: 0.8435
Epoch 9/27

16/16 [==============================] - 0s 27ms/step - loss: 0.4588 - acc: 0.8469
Epoch 10/27

16/16 [==============================] - 0s 25ms/step - loss: 0.4355 - acc: 0.8537
Epoch 11/27

16/16 [==============================] - 0s 25ms/step - loss: 0.3996 - acc: 0.8707
Epoch 12/27

16/16 [==============================] - 0s 26ms/step - loss: 0.3760 - acc: 0.8673
Epoch 13/27

16/16 [==============================] - 0s 26ms/step - loss: 0.3443 - acc: 0.8878
Epoch 14/27

16/16 [==============================] - 0s 26ms/step - loss: 0.3380 - acc: 0.8707
Epoch 15/27

16/16 [==============================] - 0s 26ms/step - loss: 0.3286 - acc: 0.9388
Epoch 16/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3336 - acc: 0.8673
Epoch 17/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3087 - acc: 0.9490
Epoch 18/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2598 - acc: 0.9048
Epoch 19/27

16/16 [==============================] - 0s 26ms/step - loss: 0.2400 - acc: 0.9286
Epoch 20/27

16/16 [==============================] - 0s 26ms/step - loss: 0.2205 - acc: 0.9524
Epoch 21/27

16/16 [==============================] - 0s 26ms/step - loss: 0.2022 - acc: 0.9490
Epoch 22/27

16/16 [==============================] - 0s 26ms/step - loss: 0.1905 - acc: 0.9592
Epoch 23/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1789 - acc: 0.9592
Epoch 24/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1639 - acc: 0.9626
Epoch 25/27

16/16 [==============================] - 0s 26ms/step - loss: 0.1599 - acc: 0.9626
Epoch 26/27

16/16 [==============================] - 0s 25ms/step - loss: 0.1529 - acc: 0.9660
Epoch 27/27

16/16 [==============================] - 0s 26ms/step - loss: 0.1442 - acc: 0.9626
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7129
False 1942
True percentage 0.785911145408
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.33      0.26      0.29       296
          O       0.87      0.95      0.91      7318
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-PER       0.56      0.11      0.18       438
      I-PER       0.30      0.07      0.11       214
      B-LOC       0.30      0.06      0.10       218
      I-LOC       0.00      0.00      0.00       141
      I-ORG       0.00      0.00      0.00       151

avg / total       0.75      0.79      0.76      9071

F-1 Score (without O):
0.830751104566
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 100017 unique words.
Found 92 unique chars.
Found 9 unique labels.
13 unique words not found in embedding.
8 unique chars not found in embedding.
Number of OOV: 326
OOV word occurences: 638
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401152     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,586
Trainable params: 6,507,586
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 3s 201ms/step - loss: 2.5899 - acc: 0.0128
Epoch 2/27

16/16 [==============================] - 0s 28ms/step - loss: 1.4743 - acc: 0.8013
Epoch 3/27

16/16 [==============================] - 0s 26ms/step - loss: 0.8369 - acc: 0.8173
Epoch 4/27

16/16 [==============================] - 0s 27ms/step - loss: 0.7470 - acc: 0.8173
Epoch 5/27

16/16 [==============================] - 0s 26ms/step - loss: 0.6980 - acc: 0.8173
Epoch 6/27

16/16 [==============================] - 0s 26ms/step - loss: 0.6697 - acc: 0.8173
Epoch 7/27

16/16 [==============================] - 0s 26ms/step - loss: 0.6965 - acc: 0.8173
Epoch 8/27

16/16 [==============================] - 0s 26ms/step - loss: 0.7278 - acc: 0.8622
Epoch 9/27

16/16 [==============================] - 0s 26ms/step - loss: 0.5764 - acc: 0.8173
Epoch 10/27

16/16 [==============================] - 0s 26ms/step - loss: 0.5335 - acc: 0.8462
Epoch 11/27

16/16 [==============================] - 0s 25ms/step - loss: 0.4823 - acc: 0.8397
Epoch 12/27

16/16 [==============================] - 0s 26ms/step - loss: 0.4637 - acc: 0.8590
Epoch 13/27

16/16 [==============================] - 0s 26ms/step - loss: 0.4343 - acc: 0.8494
Epoch 14/27

16/16 [==============================] - 0s 25ms/step - loss: 0.3988 - acc: 0.8590
Epoch 15/27

16/16 [==============================] - 0s 26ms/step - loss: 0.3686 - acc: 0.8750
Epoch 16/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3604 - acc: 0.8782
Epoch 17/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3201 - acc: 0.8974
Epoch 18/27

16/16 [==============================] - 0s 26ms/step - loss: 0.3084 - acc: 0.9103
Epoch 19/27

16/16 [==============================] - 0s 25ms/step - loss: 0.2823 - acc: 0.9167
Epoch 20/27

16/16 [==============================] - 0s 26ms/step - loss: 0.2695 - acc: 0.9231
Epoch 21/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2506 - acc: 0.9199
Epoch 22/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2469 - acc: 0.9647
Epoch 23/27

16/16 [==============================] - 0s 26ms/step - loss: 0.2275 - acc: 0.9295
Epoch 24/27

16/16 [==============================] - 0s 25ms/step - loss: 0.2117 - acc: 0.9615
Epoch 25/27

16/16 [==============================] - 0s 26ms/step - loss: 0.1936 - acc: 0.9487
Epoch 26/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1961 - acc: 0.9615
Epoch 27/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1894 - acc: 0.9647
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7205
False 1866
True percentage 0.794289493992
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.70      0.10      0.17       438
      I-PER       0.00      0.00      0.00       214
          O       0.90      0.94      0.92      7318
      B-ORG       0.36      0.47      0.40       296
      B-LOC       0.81      0.28      0.41       218
      I-ORG       0.21      0.28      0.24       151
      I-LOC       0.17      0.07      0.10       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.80      0.79      0.78      9071

F-1 Score (without O):
0.842340488092
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100013 unique words.
Found 85 unique chars.
Found 6 unique labels.
9 unique words not found in embedding.
1 unique chars not found in embedding.
Number of OOV: 328
OOV word occurences: 641
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5504        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6400896     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 7)        966         bidirectional_2[0][0]            
==================================================================================================
Total params: 6,506,438
Trainable params: 6,506,438
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 3s 381ms/step - loss: 1.6442 - acc: 0.4309
Epoch 2/27

8/8 [==============================] - 0s 41ms/step - loss: 0.8774 - acc: 0.8729
Epoch 3/27

8/8 [==============================] - 0s 40ms/step - loss: 0.5365 - acc: 0.8729
Epoch 4/27

8/8 [==============================] - 0s 39ms/step - loss: 0.4626 - acc: 0.8729
Epoch 5/27

8/8 [==============================] - 0s 39ms/step - loss: 0.4069 - acc: 0.8729
Epoch 6/27

8/8 [==============================] - 0s 39ms/step - loss: 0.4244 - acc: 0.8729
Epoch 7/27

8/8 [==============================] - 0s 40ms/step - loss: 0.4624 - acc: 0.8895
Epoch 8/27

8/8 [==============================] - 0s 39ms/step - loss: 0.3834 - acc: 0.8729
Epoch 9/27

8/8 [==============================] - 0s 39ms/step - loss: 0.3128 - acc: 0.9061
Epoch 10/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2751 - acc: 0.8950
Epoch 11/27

8/8 [==============================] - 0s 39ms/step - loss: 0.2468 - acc: 0.9006
Epoch 12/27

8/8 [==============================] - 0s 42ms/step - loss: 0.2059 - acc: 0.9282
Epoch 13/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1762 - acc: 0.9503
Epoch 14/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1524 - acc: 0.9558
Epoch 15/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1456 - acc: 0.9669
Epoch 16/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2651 - acc: 0.9171
Epoch 17/27

8/8 [==============================] - 0s 36ms/step - loss: 0.2769 - acc: 0.9779
Epoch 18/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1387 - acc: 0.9834
Epoch 19/27

8/8 [==============================] - 0s 40ms/step - loss: 0.1085 - acc: 0.9834
Epoch 20/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1010 - acc: 0.9779
Epoch 21/27

8/8 [==============================] - 0s 40ms/step - loss: 0.0838 - acc: 0.9890
Epoch 22/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0848 - acc: 0.9890
Epoch 23/27

8/8 [==============================] - 0s 40ms/step - loss: 0.0815 - acc: 0.9834
Epoch 24/27

8/8 [==============================] - 0s 39ms/step - loss: 0.0695 - acc: 0.9945
Epoch 25/27

8/8 [==============================] - 0s 36ms/step - loss: 0.0624 - acc: 1.0000
Epoch 26/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0596 - acc: 0.9890
Epoch 27/27

8/8 [==============================] - 0s 36ms/step - loss: 0.0604 - acc: 0.9945
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7211
False 1424
True percentage 0.835089751013
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.87      0.96      0.91      7318
      B-PER       0.61      0.28      0.38       438
      B-ORG       0.47      0.30      0.36       296
      I-ORG       0.00      0.00      0.00       151
      I-PER       0.56      0.05      0.09       214
      B-LOC       0.00      0.00      0.00       218

avg / total       0.80      0.84      0.81      8635

F-1 Score (without O):
0.256380510441
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 100010 unique words.
Found 88 unique chars.
Found 8 unique labels.
6 unique words not found in embedding.
4 unique chars not found in embedding.
Number of OOV: 328
OOV word occurences: 641
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5696        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6400704     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,506,732
Trainable params: 6,506,732
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 3s 377ms/step - loss: 2.1080 - acc: 0.0282
Epoch 2/27

8/8 [==============================] - 0s 42ms/step - loss: 1.1956 - acc: 0.8451
Epoch 3/27

8/8 [==============================] - 0s 40ms/step - loss: 0.6746 - acc: 0.8521
Epoch 4/27

8/8 [==============================] - 0s 38ms/step - loss: 0.5885 - acc: 0.8521
Epoch 5/27

8/8 [==============================] - 0s 38ms/step - loss: 0.5731 - acc: 0.8521
Epoch 6/27

8/8 [==============================] - 0s 39ms/step - loss: 0.5355 - acc: 0.8521
Epoch 7/27

8/8 [==============================] - 0s 37ms/step - loss: 0.5053 - acc: 0.8521
Epoch 8/27

8/8 [==============================] - 0s 39ms/step - loss: 0.4608 - acc: 0.8521
Epoch 9/27

8/8 [==============================] - 0s 40ms/step - loss: 0.4379 - acc: 0.8592
Epoch 10/27

8/8 [==============================] - 0s 39ms/step - loss: 0.4042 - acc: 0.8521
Epoch 11/27

8/8 [==============================] - 0s 38ms/step - loss: 0.3887 - acc: 0.8803
Epoch 12/27

8/8 [==============================] - 0s 37ms/step - loss: 0.3458 - acc: 0.8662
Epoch 13/27

8/8 [==============================] - 0s 37ms/step - loss: 0.3155 - acc: 0.8944
Epoch 14/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2850 - acc: 0.8803
Epoch 15/27

8/8 [==============================] - 0s 39ms/step - loss: 0.2740 - acc: 0.9225
Epoch 16/27

8/8 [==============================] - 0s 40ms/step - loss: 0.2415 - acc: 0.8873
Epoch 17/27

8/8 [==============================] - 0s 40ms/step - loss: 0.2099 - acc: 0.9577
Epoch 18/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1973 - acc: 0.9225
Epoch 19/27

8/8 [==============================] - 0s 40ms/step - loss: 0.1832 - acc: 0.9437
Epoch 20/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1668 - acc: 0.9437
Epoch 21/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1594 - acc: 0.9577
Epoch 22/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1555 - acc: 0.9437
Epoch 23/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1485 - acc: 0.9789
Epoch 24/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1023 - acc: 0.9859
Epoch 25/27

8/8 [==============================] - 0s 39ms/step - loss: 0.0974 - acc: 1.0000
Epoch 26/27

8/8 [==============================] - 0s 40ms/step - loss: 0.1013 - acc: 0.9789
Epoch 27/27

8/8 [==============================] - 0s 40ms/step - loss: 0.0852 - acc: 0.9930
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7077
False 1840
True percentage 0.793652573736
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.86      0.95      0.90      7318
      B-ORG       0.25      0.14      0.18       296
      I-ORG       0.06      0.01      0.01       151
      B-PER       0.48      0.15      0.23       438
      B-LOC       0.00      0.00      0.00       218
      I-LOC       1.00      0.01      0.01       141
      I-PER       0.00      0.00      0.00       214
     B-MISC       0.00      0.00      0.00       141

avg / total       0.75      0.79      0.76      8917

F-1 Score (without O):
0.115085536547
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100010 unique words.
Found 89 unique chars.
Found 9 unique labels.
6 unique words not found in embedding.
5 unique chars not found in embedding.
Number of OOV: 328
OOV word occurences: 641
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5760        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6400704     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,506,946
Trainable params: 6,506,946
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 3s 377ms/step - loss: 2.3321 - acc: 0.0116
Epoch 2/27

8/8 [==============================] - 0s 39ms/step - loss: 1.2429 - acc: 0.8208
Epoch 3/27

8/8 [==============================] - 0s 40ms/step - loss: 0.8229 - acc: 0.8208
Epoch 4/27

8/8 [==============================] - 0s 39ms/step - loss: 0.7643 - acc: 0.8208
Epoch 5/27

8/8 [==============================] - 0s 40ms/step - loss: 0.6987 - acc: 0.8208
Epoch 6/27

8/8 [==============================] - 0s 39ms/step - loss: 0.6610 - acc: 0.8208
Epoch 7/27

8/8 [==============================] - 0s 38ms/step - loss: 0.6274 - acc: 0.8208
Epoch 8/27

8/8 [==============================] - 0s 38ms/step - loss: 0.6005 - acc: 0.8208
Epoch 9/27

8/8 [==============================] - 0s 39ms/step - loss: 0.5296 - acc: 0.8208
Epoch 10/27

8/8 [==============================] - 0s 39ms/step - loss: 0.5091 - acc: 0.8208
Epoch 11/27

8/8 [==============================] - 0s 39ms/step - loss: 0.4541 - acc: 0.8208
Epoch 12/27

8/8 [==============================] - 0s 37ms/step - loss: 0.4296 - acc: 0.8382
Epoch 13/27

8/8 [==============================] - 0s 40ms/step - loss: 0.3957 - acc: 0.8266
Epoch 14/27

8/8 [==============================] - 0s 42ms/step - loss: 0.3616 - acc: 0.9017
Epoch 15/27

8/8 [==============================] - 0s 40ms/step - loss: 0.3119 - acc: 0.8902
Epoch 16/27

8/8 [==============================] - 0s 38ms/step - loss: 0.3072 - acc: 0.9249
Epoch 17/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2868 - acc: 0.8960
Epoch 18/27

8/8 [==============================] - 0s 37ms/step - loss: 0.3332 - acc: 0.9480
Epoch 19/27

8/8 [==============================] - 0s 36ms/step - loss: 0.2453 - acc: 0.9249
Epoch 20/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2231 - acc: 0.9422
Epoch 21/27

8/8 [==============================] - 0s 41ms/step - loss: 0.2174 - acc: 0.9422
Epoch 22/27

8/8 [==============================] - 0s 40ms/step - loss: 0.1886 - acc: 0.9364
Epoch 23/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1814 - acc: 0.9422
Epoch 24/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1794 - acc: 0.9480
Epoch 25/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1497 - acc: 0.9711
Epoch 26/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1449 - acc: 0.9711
Epoch 27/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1372 - acc: 0.9711
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7134
False 1937
True percentage 0.786462352552
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.87      0.95      0.91      7318
      B-PER       0.52      0.18      0.26       438
      B-ORG       0.38      0.32      0.35       296
      I-ORG       0.00      0.00      0.00       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      I-PER       0.23      0.01      0.03       214
      B-LOC       0.43      0.01      0.03       218
      I-LOC       0.00      0.00      0.00       141

avg / total       0.75      0.79      0.76      9071

F-1 Score (without O):
0.164370982553
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 100013 unique words.
Found 93 unique chars.
Found 9 unique labels.
9 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 327
OOV word occurences: 640
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6400896     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,394
Trainable params: 6,507,394
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 3s 410ms/step - loss: 2.5921 - acc: 0.0221
Epoch 2/27

8/8 [==============================] - 0s 42ms/step - loss: 1.3798 - acc: 0.7238
Epoch 3/27

8/8 [==============================] - 0s 40ms/step - loss: 1.1677 - acc: 0.7238
Epoch 4/27

8/8 [==============================] - 0s 39ms/step - loss: 1.0617 - acc: 0.7238
Epoch 5/27

8/8 [==============================] - 0s 39ms/step - loss: 0.9454 - acc: 0.7238
Epoch 6/27

8/8 [==============================] - 0s 38ms/step - loss: 0.8822 - acc: 0.7238
Epoch 7/27

8/8 [==============================] - 0s 39ms/step - loss: 0.8424 - acc: 0.7293
Epoch 8/27

8/8 [==============================] - 0s 38ms/step - loss: 0.7907 - acc: 0.7293
Epoch 9/27

8/8 [==============================] - 0s 38ms/step - loss: 0.7224 - acc: 0.7624
Epoch 10/27

8/8 [==============================] - 0s 38ms/step - loss: 0.6732 - acc: 0.7680
Epoch 11/27

8/8 [==============================] - 0s 40ms/step - loss: 0.6141 - acc: 0.7901
Epoch 12/27

8/8 [==============================] - 0s 41ms/step - loss: 0.5860 - acc: 0.7956
Epoch 13/27

8/8 [==============================] - 0s 39ms/step - loss: 0.5386 - acc: 0.8177
Epoch 14/27

8/8 [==============================] - 0s 38ms/step - loss: 0.4893 - acc: 0.8508
Epoch 15/27

8/8 [==============================] - 0s 37ms/step - loss: 0.4309 - acc: 0.8785
Epoch 16/27

8/8 [==============================] - 0s 38ms/step - loss: 0.3694 - acc: 0.8895
Epoch 17/27

8/8 [==============================] - 0s 39ms/step - loss: 0.3467 - acc: 0.9282
Epoch 18/27

8/8 [==============================] - 0s 36ms/step - loss: 0.4156 - acc: 0.8453
Epoch 19/27

8/8 [==============================] - 0s 39ms/step - loss: 0.4963 - acc: 0.9337
Epoch 20/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2705 - acc: 0.9337
Epoch 21/27

8/8 [==============================] - 0s 39ms/step - loss: 0.2563 - acc: 0.9558
Epoch 22/27

8/8 [==============================] - 0s 37ms/step - loss: 0.2393 - acc: 0.9613
Epoch 23/27

8/8 [==============================] - 0s 39ms/step - loss: 0.2127 - acc: 0.9613
Epoch 24/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1988 - acc: 0.9613
Epoch 25/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1836 - acc: 0.9945
Epoch 26/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1660 - acc: 0.9890
Epoch 27/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1571 - acc: 0.9834
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7237
False 1834
True percentage 0.797817219711
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.88      0.95      0.92      7318
      B-ORG       0.53      0.27      0.36       296
      B-PER       0.49      0.21      0.29       438
      I-PER       0.36      0.06      0.10       214
      B-LOC       0.51      0.33      0.40       218
      I-LOC       0.00      0.00      0.00       141
      I-ORG       0.44      0.05      0.08       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.78      0.80      0.78      9071

F-1 Score (without O):
0.22864651774
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 100015 unique words.
Found 92 unique chars.
Found 6 unique labels.
11 unique words not found in embedding.
8 unique chars not found in embedding.
Number of OOV: 327
OOV word occurences: 639
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401024     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 7)        966         bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,014
Trainable params: 6,507,014
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 3s 380ms/step - loss: 1.8094 - acc: 0.0909
Epoch 2/27

8/8 [==============================] - 0s 41ms/step - loss: 0.6713 - acc: 0.9026
Epoch 3/27

8/8 [==============================] - 0s 40ms/step - loss: 0.4877 - acc: 0.9026
Epoch 4/27

8/8 [==============================] - 0s 39ms/step - loss: 0.4296 - acc: 0.9026
Epoch 5/27

8/8 [==============================] - 0s 40ms/step - loss: 0.4023 - acc: 0.9026
Epoch 6/27

8/8 [==============================] - 0s 40ms/step - loss: 0.3688 - acc: 0.9026
Epoch 7/27

8/8 [==============================] - 0s 40ms/step - loss: 0.3480 - acc: 0.9026
Epoch 8/27

8/8 [==============================] - 0s 40ms/step - loss: 0.3320 - acc: 0.9026
Epoch 9/27

8/8 [==============================] - 0s 38ms/step - loss: 0.3108 - acc: 0.9026
Epoch 10/27

8/8 [==============================] - 0s 39ms/step - loss: 0.2834 - acc: 0.9091
Epoch 11/27

8/8 [==============================] - 0s 40ms/step - loss: 0.2620 - acc: 0.9026
Epoch 12/27

8/8 [==============================] - 0s 43ms/step - loss: 0.2418 - acc: 0.9286
Epoch 13/27

8/8 [==============================] - 0s 41ms/step - loss: 0.2362 - acc: 0.9091
Epoch 14/27

8/8 [==============================] - 0s 39ms/step - loss: 0.2252 - acc: 0.9416
Epoch 15/27

8/8 [==============================] - 0s 39ms/step - loss: 0.2233 - acc: 0.9091
Epoch 16/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1919 - acc: 0.9416
Epoch 17/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1692 - acc: 0.9286
Epoch 18/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1616 - acc: 0.9481
Epoch 19/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1440 - acc: 0.9416
Epoch 20/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1286 - acc: 0.9545
Epoch 21/27

8/8 [==============================] - 0s 40ms/step - loss: 0.1177 - acc: 0.9545
Epoch 22/27

8/8 [==============================] - 0s 40ms/step - loss: 0.1044 - acc: 0.9870
Epoch 23/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1158 - acc: 0.9545
Epoch 24/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1723 - acc: 0.9675
Epoch 25/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1027 - acc: 0.9675
Epoch 26/27

8/8 [==============================] - 0s 37ms/step - loss: 0.0904 - acc: 0.9935
Epoch 27/27

8/8 [==============================] - 0s 36ms/step - loss: 0.0881 - acc: 0.9935
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7035
False 1523
True percentage 0.822037859313
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.25      0.06      0.09       438
          O       0.84      0.96      0.90      7318
      B-ORG       0.37      0.05      0.09       296
     B-MISC       0.00      0.00      0.00       141
      I-ORG       0.00      0.00      0.00       151
      I-PER       0.00      0.00      0.00       214

avg / total       0.75      0.82      0.77      8558

F-1 Score (without O):
0.852227828096
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 100008 unique words.
Found 84 unique chars.
Found 6 unique labels.
4 unique words not found in embedding.
0 unique chars not found in embedding.
Number of OOV: 328
OOV word occurences: 641
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5440        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6400576     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 7)        966         bidirectional_2[0][0]            
==================================================================================================
Total params: 6,506,054
Trainable params: 6,506,054
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 3s 376ms/step - loss: 2.1461 - acc: 0.0314
Epoch 2/27

8/8 [==============================] - 0s 41ms/step - loss: 1.0299 - acc: 0.8365
Epoch 3/27

8/8 [==============================] - 0s 40ms/step - loss: 0.6961 - acc: 0.8365
Epoch 4/27

8/8 [==============================] - 0s 40ms/step - loss: 0.6592 - acc: 0.8365
Epoch 5/27

8/8 [==============================] - 0s 38ms/step - loss: 0.5910 - acc: 0.8365
Epoch 6/27

8/8 [==============================] - 0s 41ms/step - loss: 0.5560 - acc: 0.8365
Epoch 7/27

8/8 [==============================] - 0s 38ms/step - loss: 0.4947 - acc: 0.8365
Epoch 8/27

8/8 [==============================] - 0s 39ms/step - loss: 0.4635 - acc: 0.8365
Epoch 9/27

8/8 [==============================] - 0s 38ms/step - loss: 0.4479 - acc: 0.8365
Epoch 10/27

8/8 [==============================] - 0s 37ms/step - loss: 0.4041 - acc: 0.8365
Epoch 11/27

8/8 [==============================] - 0s 37ms/step - loss: 0.3908 - acc: 0.8491
Epoch 12/27

8/8 [==============================] - 0s 38ms/step - loss: 0.3603 - acc: 0.8365
Epoch 13/27

8/8 [==============================] - 0s 37ms/step - loss: 0.3207 - acc: 0.9119
Epoch 14/27

8/8 [==============================] - 0s 38ms/step - loss: 0.3232 - acc: 0.8679
Epoch 15/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2795 - acc: 0.9245
Epoch 16/27

8/8 [==============================] - 0s 39ms/step - loss: 0.2520 - acc: 0.9057
Epoch 17/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2230 - acc: 0.9560
Epoch 18/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1992 - acc: 0.9371
Epoch 19/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1981 - acc: 0.9686
Epoch 20/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1806 - acc: 0.9371
Epoch 21/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1761 - acc: 0.9748
Epoch 22/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1398 - acc: 0.9748
Epoch 23/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1252 - acc: 0.9686
Epoch 24/27

8/8 [==============================] - 0s 40ms/step - loss: 0.1214 - acc: 0.9874
Epoch 25/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1011 - acc: 0.9937
Epoch 26/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1122 - acc: 0.9811
Epoch 27/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0959 - acc: 0.9937
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7082
False 1553
True percentage 0.820150550087
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.86      0.95      0.90      7318
      B-PER       0.30      0.16      0.21       438
      B-ORG       0.40      0.07      0.12       296
      I-ORG       0.00      0.00      0.00       151
      B-LOC       0.33      0.03      0.05       218
      I-PER       0.57      0.02      0.04       214

avg / total       0.78      0.82      0.78      8635

F-1 Score (without O):
0.124078624079
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 100012 unique words.
Found 91 unique chars.
Found 8 unique labels.
8 unique words not found in embedding.
7 unique chars not found in embedding.
Number of OOV: 327
OOV word occurences: 637
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5888        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6400832     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,052
Trainable params: 6,507,052
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 4s 443ms/step - loss: 2.1826 - acc: 0.1154
Epoch 2/27

8/8 [==============================] - 0s 40ms/step - loss: 1.0444 - acc: 0.7802
Epoch 3/27

8/8 [==============================] - 0s 40ms/step - loss: 0.9863 - acc: 0.7802
Epoch 4/27

8/8 [==============================] - 0s 41ms/step - loss: 0.8827 - acc: 0.7857
Epoch 5/27

8/8 [==============================] - 0s 41ms/step - loss: 0.7193 - acc: 0.7802
Epoch 6/27

8/8 [==============================] - 0s 40ms/step - loss: 0.6453 - acc: 0.7802
Epoch 7/27

8/8 [==============================] - 0s 39ms/step - loss: 0.6791 - acc: 0.8077
Epoch 8/27

8/8 [==============================] - 0s 38ms/step - loss: 0.5988 - acc: 0.7802
Epoch 9/27

8/8 [==============================] - 0s 38ms/step - loss: 0.5554 - acc: 0.8187
Epoch 10/27

8/8 [==============================] - 0s 38ms/step - loss: 0.5030 - acc: 0.8077
Epoch 11/27

8/8 [==============================] - 0s 39ms/step - loss: 0.4662 - acc: 0.8462
Epoch 12/27

8/8 [==============================] - 0s 40ms/step - loss: 0.4446 - acc: 0.8187
Epoch 13/27

8/8 [==============================] - 0s 40ms/step - loss: 0.4106 - acc: 0.8626
Epoch 14/27

8/8 [==============================] - 0s 41ms/step - loss: 0.4035 - acc: 0.8516
Epoch 15/27

8/8 [==============================] - 0s 38ms/step - loss: 0.3691 - acc: 0.8846
Epoch 16/27

8/8 [==============================] - 0s 39ms/step - loss: 0.3435 - acc: 0.8791
Epoch 17/27

8/8 [==============================] - 0s 38ms/step - loss: 0.3309 - acc: 0.9121
Epoch 18/27

8/8 [==============================] - 0s 37ms/step - loss: 0.3024 - acc: 0.9066
Epoch 19/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2726 - acc: 0.9505
Epoch 20/27

8/8 [==============================] - 0s 39ms/step - loss: 0.2574 - acc: 0.9451
Epoch 21/27

8/8 [==============================] - 0s 39ms/step - loss: 0.2339 - acc: 0.9505
Epoch 22/27

8/8 [==============================] - 0s 40ms/step - loss: 0.2118 - acc: 0.9505
Epoch 23/27

8/8 [==============================] - 0s 40ms/step - loss: 0.2176 - acc: 0.9560
Epoch 24/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1939 - acc: 0.9615
Epoch 25/27

8/8 [==============================] - 0s 40ms/step - loss: 0.1862 - acc: 0.9560
Epoch 26/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1778 - acc: 0.9505
Epoch 27/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1532 - acc: 0.9780
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7086
False 1844
True percentage 0.793505039194
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.87      0.95      0.91      7318
      B-PER       0.51      0.15      0.23       438
      I-PER       0.60      0.01      0.03       214
      B-ORG       0.30      0.16      0.21       296
      I-ORG       0.17      0.19      0.18       151
      B-LOC       0.00      0.00      0.00       218
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.77      0.79      0.77      8930

F-1 Score (without O):
0.139130434783
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 100017 unique words.
Found 86 unique chars.
Found 8 unique labels.
13 unique words not found in embedding.
2 unique chars not found in embedding.
Number of OOV: 327
OOV word occurences: 573
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5568        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401152     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,052
Trainable params: 6,507,052
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 3s 408ms/step - loss: 2.2034 - acc: 0.0652
Epoch 2/27

8/8 [==============================] - 0s 40ms/step - loss: 0.9912 - acc: 0.8261
Epoch 3/27

8/8 [==============================] - 0s 41ms/step - loss: 0.8510 - acc: 0.8261
Epoch 4/27

8/8 [==============================] - 0s 41ms/step - loss: 0.7380 - acc: 0.8261
Epoch 5/27

8/8 [==============================] - 0s 40ms/step - loss: 0.6345 - acc: 0.8261
Epoch 6/27

8/8 [==============================] - 0s 41ms/step - loss: 0.5938 - acc: 0.8261
Epoch 7/27

8/8 [==============================] - 0s 39ms/step - loss: 0.5522 - acc: 0.8261
Epoch 8/27

8/8 [==============================] - 0s 40ms/step - loss: 0.5121 - acc: 0.8424
Epoch 9/27

8/8 [==============================] - 0s 39ms/step - loss: 0.4975 - acc: 0.8370
Epoch 10/27

8/8 [==============================] - 0s 38ms/step - loss: 0.4581 - acc: 0.8370
Epoch 11/27

8/8 [==============================] - 0s 38ms/step - loss: 0.4329 - acc: 0.8587
Epoch 12/27

8/8 [==============================] - 0s 38ms/step - loss: 0.4078 - acc: 0.8533
Epoch 13/27

8/8 [==============================] - 0s 38ms/step - loss: 0.3811 - acc: 0.8804
Epoch 14/27

8/8 [==============================] - 0s 37ms/step - loss: 0.3753 - acc: 0.8533
Epoch 15/27

8/8 [==============================] - 0s 39ms/step - loss: 0.3554 - acc: 0.9076
Epoch 16/27

8/8 [==============================] - 0s 41ms/step - loss: 0.3504 - acc: 0.8750
Epoch 17/27

8/8 [==============================] - 0s 42ms/step - loss: 0.2990 - acc: 0.9130
Epoch 18/27

8/8 [==============================] - 0s 43ms/step - loss: 0.2797 - acc: 0.9022
Epoch 19/27

8/8 [==============================] - 0s 39ms/step - loss: 0.2626 - acc: 0.9239
Epoch 20/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2460 - acc: 0.9457
Epoch 21/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2228 - acc: 0.9293
Epoch 22/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2177 - acc: 0.9511
Epoch 23/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2100 - acc: 0.9348
Epoch 24/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1861 - acc: 0.9565
Epoch 25/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1667 - acc: 0.9565
Epoch 26/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1474 - acc: 0.9728
Epoch 27/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1395 - acc: 0.9565
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7069
False 1861
True percentage 0.791601343785
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.86      0.95      0.90      7318
     B-MISC       0.03      0.01      0.02       141
     I-MISC       0.00      0.00      0.00       154
      B-ORG       0.38      0.19      0.26       296
      B-LOC       0.00      0.00      0.00       218
      B-PER       0.53      0.05      0.10       438
      I-PER       0.00      0.00      0.00       214
      I-ORG       0.11      0.08      0.09       151

avg / total       0.75      0.79      0.76      8930

F-1 Score (without O):
0.0943301555444
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 8
Found 100004 word vectors.
Found 84 char vectors.
Found 100019 unique words.
Found 91 unique chars.
Found 9 unique labels.
15 unique words not found in embedding.
7 unique chars not found in embedding.
Number of OOV: 323
OOV word occurences: 548
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5888        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401280     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,650
Trainable params: 6,507,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 3s 378ms/step - loss: 2.1112 - acc: 0.3672
Epoch 2/27

8/8 [==============================] - 0s 40ms/step - loss: 1.3504 - acc: 0.6949
Epoch 3/27

8/8 [==============================] - 0s 40ms/step - loss: 1.2540 - acc: 0.6949
Epoch 4/27

8/8 [==============================] - 0s 39ms/step - loss: 1.1986 - acc: 0.6949
Epoch 5/27

8/8 [==============================] - 0s 38ms/step - loss: 0.9837 - acc: 0.6949
Epoch 6/27

8/8 [==============================] - 0s 38ms/step - loss: 0.9351 - acc: 0.6949
Epoch 7/27

8/8 [==============================] - 0s 38ms/step - loss: 0.8851 - acc: 0.6949
Epoch 8/27

8/8 [==============================] - 0s 38ms/step - loss: 0.7981 - acc: 0.7006
Epoch 9/27

8/8 [==============================] - 0s 38ms/step - loss: 0.7619 - acc: 0.7175
Epoch 10/27

8/8 [==============================] - 0s 37ms/step - loss: 0.7036 - acc: 0.7119
Epoch 11/27

8/8 [==============================] - 0s 38ms/step - loss: 0.6506 - acc: 0.7627
Epoch 12/27

8/8 [==============================] - 0s 37ms/step - loss: 0.5749 - acc: 0.8079
Epoch 13/27

8/8 [==============================] - 0s 37ms/step - loss: 0.5301 - acc: 0.8362
Epoch 14/27

8/8 [==============================] - 0s 38ms/step - loss: 0.4858 - acc: 0.8418
Epoch 15/27

8/8 [==============================] - 0s 37ms/step - loss: 0.4507 - acc: 0.8870
Epoch 16/27

8/8 [==============================] - 0s 38ms/step - loss: 0.3791 - acc: 0.9096
Epoch 17/27

8/8 [==============================] - 0s 39ms/step - loss: 0.3777 - acc: 0.9040
Epoch 18/27

8/8 [==============================] - 0s 40ms/step - loss: 0.3207 - acc: 0.9492
Epoch 19/27

8/8 [==============================] - 0s 39ms/step - loss: 0.2829 - acc: 0.9718
Epoch 20/27

8/8 [==============================] - 0s 38ms/step - loss: 0.4287 - acc: 0.8249
Epoch 21/27

8/8 [==============================] - 0s 38ms/step - loss: 0.5101 - acc: 0.9153
Epoch 22/27

8/8 [==============================] - 0s 39ms/step - loss: 0.2415 - acc: 0.9887
Epoch 23/27

8/8 [==============================] - 0s 40ms/step - loss: 0.2022 - acc: 0.9944
Epoch 24/27

8/8 [==============================] - 0s 41ms/step - loss: 0.1806 - acc: 0.9831
Epoch 25/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1809 - acc: 0.9887
Epoch 26/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1764 - acc: 0.9718
Epoch 27/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1348 - acc: 0.9887
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7298
False 1773
True percentage 0.804541946864
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.90      0.95      0.92      7318
     B-MISC       0.24      0.06      0.10       141
      B-ORG       0.35      0.44      0.39       296
      B-PER       0.56      0.36      0.44       438
     I-MISC       0.27      0.02      0.04       154
      I-PER       0.70      0.15      0.25       214
      I-ORG       0.36      0.07      0.11       151
      B-LOC       0.75      0.03      0.05       218
      I-LOC       0.75      0.09      0.15       141

avg / total       0.82      0.80      0.79      9071

F-1 Score (without O):
0.281225451689
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 9
Found 100004 word vectors.
Found 84 char vectors.
Found 100013 unique words.
Found 89 unique chars.
Found 9 unique labels.
9 unique words not found in embedding.
5 unique chars not found in embedding.
Number of OOV: 325
OOV word occurences: 558
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5760        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6400896     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,138
Trainable params: 6,507,138
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 3s 375ms/step - loss: 2.1776 - acc: 0.0621
Epoch 2/27

8/8 [==============================] - 0s 41ms/step - loss: 1.0913 - acc: 0.8192
Epoch 3/27

8/8 [==============================] - 0s 41ms/step - loss: 0.8789 - acc: 0.8192
Epoch 4/27

8/8 [==============================] - 0s 39ms/step - loss: 0.7577 - acc: 0.8192
Epoch 5/27

8/8 [==============================] - 0s 39ms/step - loss: 0.6682 - acc: 0.8192
Epoch 6/27

8/8 [==============================] - 0s 41ms/step - loss: 0.6063 - acc: 0.8192
Epoch 7/27

8/8 [==============================] - 0s 38ms/step - loss: 0.5670 - acc: 0.8192
Epoch 8/27

8/8 [==============================] - 0s 39ms/step - loss: 0.5277 - acc: 0.8192
Epoch 9/27

8/8 [==============================] - 0s 40ms/step - loss: 0.5027 - acc: 0.8305
Epoch 10/27

8/8 [==============================] - 0s 39ms/step - loss: 0.4754 - acc: 0.8305
Epoch 11/27

8/8 [==============================] - 0s 40ms/step - loss: 0.4382 - acc: 0.8701
Epoch 12/27

8/8 [==============================] - 0s 40ms/step - loss: 0.4138 - acc: 0.8362
Epoch 13/27

8/8 [==============================] - 0s 38ms/step - loss: 0.4001 - acc: 0.8757
Epoch 14/27

8/8 [==============================] - 0s 40ms/step - loss: 0.3872 - acc: 0.8531
Epoch 15/27

8/8 [==============================] - 0s 39ms/step - loss: 0.3667 - acc: 0.9096
Epoch 16/27

8/8 [==============================] - 0s 39ms/step - loss: 0.3390 - acc: 0.8701
Epoch 17/27

8/8 [==============================] - 0s 38ms/step - loss: 0.3141 - acc: 0.8983
Epoch 18/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2890 - acc: 0.9153
Epoch 19/27

8/8 [==============================] - 0s 41ms/step - loss: 0.2710 - acc: 0.9322
Epoch 20/27

8/8 [==============================] - 0s 41ms/step - loss: 0.2629 - acc: 0.9266
Epoch 21/27

8/8 [==============================] - 0s 39ms/step - loss: 0.2329 - acc: 0.9266
Epoch 22/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2251 - acc: 0.9379
Epoch 23/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2025 - acc: 0.9435
Epoch 24/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1980 - acc: 0.9435
Epoch 25/27

8/8 [==============================] - 0s 39ms/step - loss: 0.2004 - acc: 0.9492
Epoch 26/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1679 - acc: 0.9435
Epoch 27/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1633 - acc: 0.9435
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7100
False 1971
True percentage 0.782714143975
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.85      0.96      0.90      7318
      B-PER       1.00      0.01      0.02       438
      B-ORG       0.39      0.18      0.24       296
      I-ORG       0.26      0.25      0.25       151
      I-PER       0.00      0.00      0.00       214
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.75      0.78      0.74      9071

F-1 Score (without O):
0.0912659470069
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 10
Found 100004 word vectors.
Found 84 char vectors.
Found 100022 unique words.
Found 92 unique chars.
Found 7 unique labels.
18 unique words not found in embedding.
8 unique chars not found in embedding.
Number of OOV: 321
OOV word occurences: 539
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401472     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 8)        1112        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,608
Trainable params: 6,507,608
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 3s 380ms/step - loss: 1.8430 - acc: 0.3268
Epoch 2/27

8/8 [==============================] - 0s 41ms/step - loss: 1.0142 - acc: 0.7854
Epoch 3/27

8/8 [==============================] - 0s 39ms/step - loss: 0.9343 - acc: 0.7854
Epoch 4/27

8/8 [==============================] - 0s 39ms/step - loss: 0.8637 - acc: 0.7854
Epoch 5/27

8/8 [==============================] - 0s 40ms/step - loss: 0.7286 - acc: 0.7854
Epoch 6/27

8/8 [==============================] - 0s 40ms/step - loss: 0.6753 - acc: 0.7854
Epoch 7/27

8/8 [==============================] - 0s 39ms/step - loss: 0.6349 - acc: 0.7854
Epoch 8/27

8/8 [==============================] - 0s 39ms/step - loss: 0.5948 - acc: 0.7854
Epoch 9/27

8/8 [==============================] - 0s 38ms/step - loss: 0.5604 - acc: 0.7902
Epoch 10/27

8/8 [==============================] - 0s 39ms/step - loss: 0.5167 - acc: 0.7902
Epoch 11/27

8/8 [==============================] - 0s 38ms/step - loss: 0.4841 - acc: 0.7951
Epoch 12/27

8/8 [==============================] - 0s 40ms/step - loss: 0.4428 - acc: 0.8732
Epoch 13/27

8/8 [==============================] - 0s 39ms/step - loss: 0.4023 - acc: 0.8439
Epoch 14/27

8/8 [==============================] - 0s 40ms/step - loss: 0.3760 - acc: 0.9024
Epoch 15/27

8/8 [==============================] - 0s 39ms/step - loss: 0.3360 - acc: 0.8976
Epoch 16/27

8/8 [==============================] - 0s 40ms/step - loss: 0.3072 - acc: 0.9171
Epoch 17/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2718 - acc: 0.9317
Epoch 18/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2476 - acc: 0.9268
Epoch 19/27

8/8 [==============================] - 0s 37ms/step - loss: 0.2215 - acc: 0.9707
Epoch 20/27

8/8 [==============================] - 0s 39ms/step - loss: 0.4837 - acc: 0.8244
Epoch 21/27

8/8 [==============================] - 0s 39ms/step - loss: 0.4032 - acc: 0.9512
Epoch 22/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2137 - acc: 0.9756
Epoch 23/27

8/8 [==============================] - 0s 40ms/step - loss: 0.1928 - acc: 0.9854
Epoch 24/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1667 - acc: 0.9902
Epoch 25/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1572 - acc: 0.9902
Epoch 26/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1465 - acc: 0.9756
Epoch 27/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1339 - acc: 0.9854
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7213
False 1499
True percentage 0.827938475666
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.86      0.96      0.91      7318
      B-PER       0.56      0.19      0.29       438
      B-ORG       0.48      0.26      0.34       296
      I-ORG       0.39      0.09      0.15       151
     B-MISC       0.50      0.04      0.08       141
     I-MISC       0.16      0.03      0.04       154
      I-PER       0.54      0.07      0.12       214

avg / total       0.80      0.83      0.80      8712

F-1 Score (without O):
0.222222222222
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 11
Found 100004 word vectors.
Found 84 char vectors.
Found 100008 unique words.
Found 87 unique chars.
Found 8 unique labels.
4 unique words not found in embedding.
3 unique chars not found in embedding.
Number of OOV: 326
OOV word occurences: 637
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5632        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6400576     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,506,540
Trainable params: 6,506,540
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 3s 372ms/step - loss: 2.0303 - acc: 0.2075
Epoch 2/27

8/8 [==============================] - 0s 41ms/step - loss: 0.8719 - acc: 0.8616
Epoch 3/27

8/8 [==============================] - 0s 40ms/step - loss: 0.5842 - acc: 0.8616
Epoch 4/27

8/8 [==============================] - 0s 39ms/step - loss: 0.5465 - acc: 0.8616
Epoch 5/27

8/8 [==============================] - 0s 40ms/step - loss: 0.4907 - acc: 0.8616
Epoch 6/27

8/8 [==============================] - 0s 40ms/step - loss: 0.4598 - acc: 0.8616
Epoch 7/27

8/8 [==============================] - 0s 39ms/step - loss: 0.4259 - acc: 0.8616
Epoch 8/27

8/8 [==============================] - 0s 39ms/step - loss: 0.4091 - acc: 0.8616
Epoch 9/27

8/8 [==============================] - 0s 39ms/step - loss: 0.3780 - acc: 0.8616
Epoch 10/27

8/8 [==============================] - 0s 37ms/step - loss: 0.3508 - acc: 0.8742
Epoch 11/27

8/8 [==============================] - 0s 38ms/step - loss: 0.3305 - acc: 0.8742
Epoch 12/27

8/8 [==============================] - 0s 38ms/step - loss: 0.3032 - acc: 0.8805
Epoch 13/27

8/8 [==============================] - 0s 41ms/step - loss: 0.2725 - acc: 0.8931
Epoch 14/27

8/8 [==============================] - 0s 41ms/step - loss: 0.2481 - acc: 0.9182
Epoch 15/27

8/8 [==============================] - 0s 39ms/step - loss: 0.2381 - acc: 0.9182
Epoch 16/27

8/8 [==============================] - 0s 39ms/step - loss: 0.2127 - acc: 0.9497
Epoch 17/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2022 - acc: 0.9182
Epoch 18/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1978 - acc: 0.9937
Epoch 19/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1618 - acc: 0.9560
Epoch 20/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1486 - acc: 0.9811
Epoch 21/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1292 - acc: 0.9874
Epoch 22/27

8/8 [==============================] - 0s 40ms/step - loss: 0.1217 - acc: 0.9811
Epoch 23/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1086 - acc: 0.9937
Epoch 24/27

8/8 [==============================] - 0s 39ms/step - loss: 0.0956 - acc: 0.9874
Epoch 25/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0941 - acc: 1.0000
Epoch 26/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0993 - acc: 0.9748
Epoch 27/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1059 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7067
False 1853
True percentage 0.792264573991
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.40      0.11      0.17       296
          O       0.84      0.96      0.90      7318
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-PER       0.52      0.05      0.09       438
      I-PER       1.00      0.05      0.09       214
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141

avg / total       0.76      0.79      0.75      8920

F-1 Score (without O):
0.828699340245
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 100009 unique words.
Found 92 unique chars.
Found 9 unique labels.
5 unique words not found in embedding.
8 unique chars not found in embedding.
Number of OOV: 327
OOV word occurences: 640
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6400640     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,074
Trainable params: 6,507,074
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 3s 377ms/step - loss: 2.0971 - acc: 0.4557
Epoch 2/27

8/8 [==============================] - 0s 40ms/step - loss: 1.1063 - acc: 0.8291
Epoch 3/27

8/8 [==============================] - 0s 39ms/step - loss: 0.7472 - acc: 0.8291
Epoch 4/27

8/8 [==============================] - 0s 41ms/step - loss: 0.6770 - acc: 0.8291
Epoch 5/27

8/8 [==============================] - 0s 39ms/step - loss: 0.6258 - acc: 0.8291
Epoch 6/27

8/8 [==============================] - 0s 39ms/step - loss: 0.5642 - acc: 0.8291
Epoch 7/27

8/8 [==============================] - 0s 38ms/step - loss: 0.5414 - acc: 0.8544
Epoch 8/27

8/8 [==============================] - 0s 37ms/step - loss: 0.5098 - acc: 0.8291
Epoch 9/27

8/8 [==============================] - 0s 38ms/step - loss: 0.4780 - acc: 0.8797
Epoch 10/27

8/8 [==============================] - 0s 38ms/step - loss: 0.4574 - acc: 0.8544
Epoch 11/27

8/8 [==============================] - 0s 38ms/step - loss: 0.4182 - acc: 0.8861
Epoch 12/27

8/8 [==============================] - 0s 39ms/step - loss: 0.3966 - acc: 0.8734
Epoch 13/27

8/8 [==============================] - 0s 38ms/step - loss: 0.3413 - acc: 0.8861
Epoch 14/27

8/8 [==============================] - 0s 37ms/step - loss: 0.3050 - acc: 0.8987
Epoch 15/27

8/8 [==============================] - 0s 37ms/step - loss: 0.2954 - acc: 0.9114
Epoch 16/27

8/8 [==============================] - 0s 39ms/step - loss: 0.2661 - acc: 0.9177
Epoch 17/27

8/8 [==============================] - 0s 40ms/step - loss: 0.2351 - acc: 0.9177
Epoch 18/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2198 - acc: 0.9304
Epoch 19/27

8/8 [==============================] - 0s 40ms/step - loss: 0.2081 - acc: 0.9177
Epoch 20/27

8/8 [==============================] - 0s 37ms/step - loss: 0.2165 - acc: 0.9494
Epoch 21/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1997 - acc: 0.9367
Epoch 22/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1825 - acc: 0.9620
Epoch 23/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1562 - acc: 0.9494
Epoch 24/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1505 - acc: 0.9684
Epoch 25/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1344 - acc: 0.9620
Epoch 26/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1344 - acc: 0.9747
Epoch 27/27

8/8 [==============================] - 0s 40ms/step - loss: 0.1194 - acc: 0.9747
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7091
False 1980
True percentage 0.781721971117
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.35      0.09      0.14       438
      I-PER       0.00      0.00      0.00       214
          O       0.89      0.95      0.91      7318
      B-ORG       0.30      0.37      0.33       296
      B-LOC       1.00      0.01      0.03       218
      I-ORG       0.14      0.12      0.13       151
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.77      0.78      0.76      9071

F-1 Score (without O):
0.832016043412
