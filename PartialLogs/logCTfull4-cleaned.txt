Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.4134 - acc: 0.8752
Epoch 2/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.2379 - acc: 0.9304
Epoch 3/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1842 - acc: 0.9459
Epoch 4/28

1674/1674 [==============================] - 44s 27ms/step - loss: 0.1534 - acc: 0.9550
Epoch 5/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.1327 - acc: 0.9618
Epoch 6/28

1674/1674 [==============================] - 44s 27ms/step - loss: 0.1139 - acc: 0.9681
Epoch 7/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.1028 - acc: 0.9703
Epoch 8/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0929 - acc: 0.9735
Epoch 9/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0837 - acc: 0.9764
Epoch 10/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0760 - acc: 0.9788
Epoch 11/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0699 - acc: 0.9800
Epoch 12/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0655 - acc: 0.9812
Epoch 13/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0594 - acc: 0.9830
Epoch 14/28

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0560 - acc: 0.9840
Epoch 15/28

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0521 - acc: 0.9853
Epoch 16/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0495 - acc: 0.9855
Epoch 17/28

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0474 - acc: 0.9865
Epoch 18/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0443 - acc: 0.9872
Epoch 19/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0421 - acc: 0.9879
Epoch 20/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0408 - acc: 0.9884
Epoch 21/28

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0380 - acc: 0.9890
Epoch 22/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0363 - acc: 0.9895
Epoch 23/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0361 - acc: 0.9894
Epoch 24/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0346 - acc: 0.9901
Epoch 25/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0320 - acc: 0.9906
Epoch 26/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0311 - acc: 0.9909
Epoch 27/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0299 - acc: 0.9915
Epoch 28/28

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0276 - acc: 0.9925
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8229
False 842
True percentage 0.90717671701
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-LOC       0.76      0.74      0.75       218
      I-LOC       0.74      0.78      0.76       141
      B-PER       0.90      0.84      0.87       438
      B-ORG       0.76      0.73      0.74       296
      I-ORG       0.62      0.64      0.63       151
     B-MISC       0.37      0.30      0.33       141
     I-MISC       0.47      0.40      0.43       154
      I-PER       0.93      0.65      0.77       214

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.71254095919
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.3885 - acc: 0.8817
Epoch 2/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.2255 - acc: 0.9312
Epoch 3/28

1674/1674 [==============================] - 44s 27ms/step - loss: 0.1783 - acc: 0.9464
Epoch 4/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.1521 - acc: 0.9550
Epoch 5/28

1674/1674 [==============================] - 44s 27ms/step - loss: 0.1287 - acc: 0.9617
Epoch 6/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.1155 - acc: 0.9655
Epoch 7/28

1674/1674 [==============================] - 44s 27ms/step - loss: 0.1019 - acc: 0.9705
Epoch 8/28

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0935 - acc: 0.9730
Epoch 9/28

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0817 - acc: 0.9767
Epoch 10/28

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0770 - acc: 0.9775
Epoch 11/28

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0727 - acc: 0.9786
Epoch 12/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0661 - acc: 0.9813
Epoch 13/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0622 - acc: 0.9822
Epoch 14/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0593 - acc: 0.9833
Epoch 15/28

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0531 - acc: 0.9847
Epoch 16/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0500 - acc: 0.9866
Epoch 17/28

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0472 - acc: 0.9864
Epoch 18/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0452 - acc: 0.9872
Epoch 19/28

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0424 - acc: 0.9881
Epoch 20/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0404 - acc: 0.9886
Epoch 21/28

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0386 - acc: 0.9887
Epoch 22/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0372 - acc: 0.9893
Epoch 23/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0349 - acc: 0.9901
Epoch 24/28

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0351 - acc: 0.9897
Epoch 25/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0331 - acc: 0.9899
Epoch 26/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0311 - acc: 0.9909
Epoch 27/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0290 - acc: 0.9919
Epoch 28/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0290 - acc: 0.9915
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8257
False 814
True percentage 0.910263477015
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
      B-PER       0.90      0.84      0.87       438
      B-LOC       0.72      0.76      0.74       218
     B-MISC       0.43      0.28      0.34       141
     I-MISC       0.57      0.38      0.46       154
      B-ORG       0.74      0.74      0.74       296
      I-ORG       0.62      0.70      0.66       151
      I-LOC       0.73      0.81      0.77       141
      I-PER       0.95      0.67      0.79       214

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.723543400713
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.4172 - acc: 0.8684
Epoch 2/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.2492 - acc: 0.9237
Epoch 3/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1978 - acc: 0.9407
Epoch 4/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1649 - acc: 0.9508
Epoch 5/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1426 - acc: 0.9585
Epoch 6/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1249 - acc: 0.9628
Epoch 7/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1124 - acc: 0.9674
Epoch 8/28

1674/1674 [==============================] - 44s 27ms/step - loss: 0.1003 - acc: 0.9707
Epoch 9/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0910 - acc: 0.9744
Epoch 10/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0841 - acc: 0.9765
Epoch 11/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0755 - acc: 0.9782
Epoch 12/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0718 - acc: 0.9803
Epoch 13/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0651 - acc: 0.9812
Epoch 14/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0619 - acc: 0.9827
Epoch 15/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0560 - acc: 0.9848
Epoch 16/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0530 - acc: 0.9850
Epoch 17/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0514 - acc: 0.9857
Epoch 18/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0474 - acc: 0.9867
Epoch 19/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0460 - acc: 0.9873
Epoch 20/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0432 - acc: 0.9879
Epoch 21/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0413 - acc: 0.9883
Epoch 22/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0394 - acc: 0.9887
Epoch 23/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0385 - acc: 0.9897
Epoch 24/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0362 - acc: 0.9897
Epoch 25/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0335 - acc: 0.9911
Epoch 26/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0323 - acc: 0.9904
Epoch 27/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0322 - acc: 0.9904
Epoch 28/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0304 - acc: 0.9915
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8229
False 842
True percentage 0.90717671701
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
      B-ORG       0.74      0.73      0.73       296
      I-ORG       0.63      0.66      0.64       151
      B-PER       0.91      0.83      0.87       438
      I-PER       0.93      0.65      0.76       214
      B-LOC       0.75      0.71      0.73       218
      I-LOC       0.75      0.74      0.75       141
     B-MISC       0.36      0.32      0.34       141
     I-MISC       0.50      0.48      0.49       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.709409320273
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.3978 - acc: 0.8763
Epoch 2/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.2419 - acc: 0.9285
Epoch 3/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1889 - acc: 0.9436
Epoch 4/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.1583 - acc: 0.9542
Epoch 5/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1366 - acc: 0.9611
Epoch 6/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1167 - acc: 0.9661
Epoch 7/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.1068 - acc: 0.9691
Epoch 8/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0939 - acc: 0.9732
Epoch 9/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0858 - acc: 0.9756
Epoch 10/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0788 - acc: 0.9776
Epoch 11/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0726 - acc: 0.9798
Epoch 12/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0660 - acc: 0.9812
Epoch 13/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0613 - acc: 0.9829
Epoch 14/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0590 - acc: 0.9833
Epoch 15/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0548 - acc: 0.9849
Epoch 16/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0515 - acc: 0.9857
Epoch 17/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0478 - acc: 0.9869
Epoch 18/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0445 - acc: 0.9881
Epoch 19/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0433 - acc: 0.9877
Epoch 20/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0418 - acc: 0.9885
Epoch 21/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0381 - acc: 0.9893
Epoch 22/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0360 - acc: 0.9902
Epoch 23/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0368 - acc: 0.9896
Epoch 24/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0324 - acc: 0.9912
Epoch 25/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0331 - acc: 0.9903
Epoch 26/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0323 - acc: 0.9907
Epoch 27/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0290 - acc: 0.9925
Epoch 28/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0284 - acc: 0.9923
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8250
False 821
True percentage 0.909491787014
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.76      0.75      0.75       296
          O       0.98      0.96      0.97      7318
     B-MISC       0.42      0.26      0.32       141
     I-MISC       0.57      0.40      0.47       154
      B-LOC       0.73      0.76      0.74       218
      I-LOC       0.70      0.79      0.74       141
      B-PER       0.89      0.85      0.87       438
      I-PER       0.87      0.67      0.76       214
      I-ORG       0.67      0.59      0.63       151

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.931330472103
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.4083 - acc: 0.8748
Epoch 2/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.2404 - acc: 0.9261
Epoch 3/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1911 - acc: 0.9427
Epoch 4/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1590 - acc: 0.9534
Epoch 5/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1378 - acc: 0.9599
Epoch 6/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1225 - acc: 0.9636
Epoch 7/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1063 - acc: 0.9689
Epoch 8/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0972 - acc: 0.9720
Epoch 9/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0846 - acc: 0.9757
Epoch 10/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0805 - acc: 0.9776
Epoch 11/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0709 - acc: 0.9796
Epoch 12/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0684 - acc: 0.9809
Epoch 13/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0607 - acc: 0.9834
Epoch 14/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0591 - acc: 0.9835
Epoch 15/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0557 - acc: 0.9844
Epoch 16/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0529 - acc: 0.9852
Epoch 17/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0491 - acc: 0.9857
Epoch 18/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0460 - acc: 0.9871
Epoch 19/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0432 - acc: 0.9880
Epoch 20/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0432 - acc: 0.9877
Epoch 21/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0429 - acc: 0.9876
Epoch 22/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0385 - acc: 0.9889
Epoch 23/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0368 - acc: 0.9901
Epoch 24/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0350 - acc: 0.9901
Epoch 25/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0340 - acc: 0.9906
Epoch 26/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0327 - acc: 0.9905
Epoch 27/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0306 - acc: 0.9910
Epoch 28/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0296 - acc: 0.9920
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8240
False 831
True percentage 0.908389372726
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
      B-PER       0.91      0.84      0.87       438
      B-ORG       0.72      0.74      0.73       296
     B-MISC       0.43      0.33      0.38       141
      I-PER       0.90      0.66      0.76       214
      I-ORG       0.63      0.61      0.62       151
     I-MISC       0.55      0.45      0.49       154
      B-LOC       0.74      0.75      0.75       218
      I-LOC       0.67      0.79      0.72       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.714876033058
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104754 unique words.
4750 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 246
OOV word occurences: in test 365
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6704320     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,816,450
Trainable params: 6,816,450
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 24s 29ms/step - loss: 0.5284 - acc: 0.8397
Epoch 2/28

837/837 [==============================] - 23s 27ms/step - loss: 0.3124 - acc: 0.9067
Epoch 3/28

837/837 [==============================] - 23s 27ms/step - loss: 0.2460 - acc: 0.9268
Epoch 4/28

837/837 [==============================] - 23s 27ms/step - loss: 0.2094 - acc: 0.9383
Epoch 5/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1837 - acc: 0.9471
Epoch 6/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1581 - acc: 0.9546
Epoch 7/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1420 - acc: 0.9595
Epoch 8/28

837/837 [==============================] - 22s 27ms/step - loss: 0.1292 - acc: 0.9636
Epoch 9/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1138 - acc: 0.9680
Epoch 10/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1027 - acc: 0.9724
Epoch 11/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0957 - acc: 0.9746
Epoch 12/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0845 - acc: 0.9776
Epoch 13/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0800 - acc: 0.9783
Epoch 14/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0730 - acc: 0.9793
Epoch 15/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0696 - acc: 0.9809
Epoch 16/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0629 - acc: 0.9830
Epoch 17/28

837/837 [==============================] - 22s 27ms/step - loss: 0.0608 - acc: 0.9834
Epoch 18/28

837/837 [==============================] - 22s 27ms/step - loss: 0.0543 - acc: 0.9855
Epoch 19/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0518 - acc: 0.9859
Epoch 20/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0488 - acc: 0.9873
Epoch 21/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0470 - acc: 0.9870
Epoch 22/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0418 - acc: 0.9890
Epoch 23/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0412 - acc: 0.9888
Epoch 24/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0382 - acc: 0.9897
Epoch 25/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0359 - acc: 0.9913
Epoch 26/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0345 - acc: 0.9917
Epoch 27/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0332 - acc: 0.9909
Epoch 28/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0317 - acc: 0.9925
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8156
False 915
True percentage 0.899129092713
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-LOC       0.71      0.72      0.71       218
      I-LOC       0.75      0.80      0.77       141
      B-PER       0.87      0.77      0.82       438
      B-ORG       0.70      0.71      0.71       296
      I-ORG       0.58      0.56      0.57       151
     B-MISC       0.51      0.30      0.38       141
     I-MISC       0.48      0.38      0.42       154
      I-PER       0.88      0.64      0.74       214

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.687368103708
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104723 unique words.
4719 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 247
OOV word occurences: in test 373
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6702336     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,814,466
Trainable params: 6,814,466
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 24s 29ms/step - loss: 0.5073 - acc: 0.8486
Epoch 2/28

837/837 [==============================] - 23s 27ms/step - loss: 0.2965 - acc: 0.9119
Epoch 3/28

837/837 [==============================] - 23s 27ms/step - loss: 0.2354 - acc: 0.9293
Epoch 4/28

837/837 [==============================] - 23s 27ms/step - loss: 0.2019 - acc: 0.9398
Epoch 5/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1722 - acc: 0.9496
Epoch 6/28

837/837 [==============================] - 22s 27ms/step - loss: 0.1532 - acc: 0.9564
Epoch 7/28

837/837 [==============================] - 22s 27ms/step - loss: 0.1335 - acc: 0.9623
Epoch 8/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1225 - acc: 0.9647
Epoch 9/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1058 - acc: 0.9703
Epoch 10/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0973 - acc: 0.9725
Epoch 11/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0914 - acc: 0.9737
Epoch 12/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0824 - acc: 0.9773
Epoch 13/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0762 - acc: 0.9792
Epoch 14/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0703 - acc: 0.9812
Epoch 15/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0644 - acc: 0.9839
Epoch 16/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0590 - acc: 0.9846
Epoch 17/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0566 - acc: 0.9839
Epoch 18/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0531 - acc: 0.9855
Epoch 19/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0513 - acc: 0.9858
Epoch 20/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0473 - acc: 0.9881
Epoch 21/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0459 - acc: 0.9880
Epoch 22/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0401 - acc: 0.9899
Epoch 23/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0399 - acc: 0.9892
Epoch 24/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0384 - acc: 0.9901
Epoch 25/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0372 - acc: 0.9906
Epoch 26/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0351 - acc: 0.9905
Epoch 27/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0330 - acc: 0.9910
Epoch 28/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0313 - acc: 0.9926
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8137
False 934
True percentage 0.897034505567
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.87      0.75      0.80       438
      B-LOC       0.71      0.64      0.67       218
     B-MISC       0.45      0.34      0.39       141
     I-MISC       0.52      0.44      0.48       154
      B-ORG       0.69      0.74      0.71       296
      I-ORG       0.52      0.61      0.56       151
      I-LOC       0.84      0.71      0.77       141
      I-PER       0.92      0.60      0.73       214

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.677127338564
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104674 unique words.
4670 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 246
OOV word occurences: in test 375
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6699200     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,811,330
Trainable params: 6,811,330
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 24s 29ms/step - loss: 0.4831 - acc: 0.8542
Epoch 2/28

837/837 [==============================] - 23s 27ms/step - loss: 0.2814 - acc: 0.9161
Epoch 3/28

837/837 [==============================] - 23s 27ms/step - loss: 0.2226 - acc: 0.9345
Epoch 4/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1895 - acc: 0.9442
Epoch 5/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1659 - acc: 0.9526
Epoch 6/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1461 - acc: 0.9599
Epoch 7/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1302 - acc: 0.9638
Epoch 8/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1150 - acc: 0.9690
Epoch 9/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1059 - acc: 0.9716
Epoch 10/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0949 - acc: 0.9740
Epoch 11/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0864 - acc: 0.9776
Epoch 12/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0807 - acc: 0.9782
Epoch 13/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0731 - acc: 0.9808
Epoch 14/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0696 - acc: 0.9809
Epoch 15/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0615 - acc: 0.9843
Epoch 16/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0589 - acc: 0.9851
Epoch 17/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0573 - acc: 0.9842
Epoch 18/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0518 - acc: 0.9863
Epoch 19/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0525 - acc: 0.9850
Epoch 20/28

837/837 [==============================] - 22s 27ms/step - loss: 0.0469 - acc: 0.9881
Epoch 21/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0420 - acc: 0.9893
Epoch 22/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0433 - acc: 0.9880
Epoch 23/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0386 - acc: 0.9903
Epoch 24/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0356 - acc: 0.9912
Epoch 25/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0351 - acc: 0.9905
Epoch 26/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0333 - acc: 0.9908
Epoch 27/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0319 - acc: 0.9919
Epoch 28/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0317 - acc: 0.9913
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8139
False 932
True percentage 0.897254988425
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.71      0.72      0.72       296
      I-ORG       0.60      0.52      0.56       151
      B-PER       0.88      0.75      0.81       438
      I-PER       0.93      0.64      0.76       214
      B-LOC       0.69      0.73      0.71       218
      I-LOC       0.61      0.73      0.66       141
     B-MISC       0.45      0.29      0.35       141
     I-MISC       0.53      0.36      0.43       154

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.676372459812
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104740 unique words.
4736 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 245
OOV word occurences: in test 354
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6703424     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,815,554
Trainable params: 6,815,554
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 24s 29ms/step - loss: 0.5243 - acc: 0.8395
Epoch 2/28

837/837 [==============================] - 23s 27ms/step - loss: 0.3016 - acc: 0.9112
Epoch 3/28

837/837 [==============================] - 23s 27ms/step - loss: 0.2450 - acc: 0.9293
Epoch 4/28

837/837 [==============================] - 23s 27ms/step - loss: 0.2015 - acc: 0.9434
Epoch 5/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1752 - acc: 0.9505
Epoch 6/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1517 - acc: 0.9572
Epoch 7/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1333 - acc: 0.9641
Epoch 8/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1214 - acc: 0.9673
Epoch 9/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1064 - acc: 0.9711
Epoch 10/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0988 - acc: 0.9735
Epoch 11/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0918 - acc: 0.9760
Epoch 12/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0827 - acc: 0.9775
Epoch 13/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0753 - acc: 0.9806
Epoch 14/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0703 - acc: 0.9821
Epoch 15/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0660 - acc: 0.9840
Epoch 16/28

837/837 [==============================] - 22s 27ms/step - loss: 0.0608 - acc: 0.9841
Epoch 17/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0567 - acc: 0.9867
Epoch 18/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0519 - acc: 0.9868
Epoch 19/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0488 - acc: 0.9881
Epoch 20/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0462 - acc: 0.9883
Epoch 21/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0443 - acc: 0.9892
Epoch 22/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0420 - acc: 0.9886
Epoch 23/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0398 - acc: 0.9896
Epoch 24/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0375 - acc: 0.9912
Epoch 25/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0366 - acc: 0.9912
Epoch 26/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0347 - acc: 0.9909
Epoch 27/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0341 - acc: 0.9914
Epoch 28/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0322 - acc: 0.9917
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8166
False 905
True percentage 0.900231507
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.74      0.70      0.72       296
          O       0.98      0.96      0.97      7318
     B-MISC       0.51      0.28      0.36       141
     I-MISC       0.55      0.36      0.44       154
      B-LOC       0.68      0.71      0.69       218
      I-LOC       0.73      0.77      0.75       141
      B-PER       0.88      0.78      0.83       438
      I-PER       0.86      0.65      0.74       214
      I-ORG       0.62      0.52      0.57       151

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.924811156304
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104701 unique words.
4697 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 246
OOV word occurences: in test 382
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6700928     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,813,058
Trainable params: 6,813,058
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 25s 29ms/step - loss: 0.4820 - acc: 0.8502
Epoch 2/28

837/837 [==============================] - 23s 27ms/step - loss: 0.2962 - acc: 0.9099
Epoch 3/28

837/837 [==============================] - 22s 27ms/step - loss: 0.2340 - acc: 0.9313
Epoch 4/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1983 - acc: 0.9412
Epoch 5/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1701 - acc: 0.9502
Epoch 6/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1519 - acc: 0.9577
Epoch 7/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1400 - acc: 0.9610
Epoch 8/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1225 - acc: 0.9656
Epoch 9/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1105 - acc: 0.9700
Epoch 10/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0992 - acc: 0.9734
Epoch 11/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0907 - acc: 0.9757
Epoch 12/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0838 - acc: 0.9773
Epoch 13/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0786 - acc: 0.9790
Epoch 14/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0703 - acc: 0.9811
Epoch 15/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0673 - acc: 0.9819
Epoch 16/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0642 - acc: 0.9824
Epoch 17/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0570 - acc: 0.9860
Epoch 18/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0538 - acc: 0.9860
Epoch 19/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0514 - acc: 0.9869
Epoch 20/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0487 - acc: 0.9875
Epoch 21/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0449 - acc: 0.9889
Epoch 22/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0431 - acc: 0.9884
Epoch 23/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0404 - acc: 0.9900
Epoch 24/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0413 - acc: 0.9889
Epoch 25/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0371 - acc: 0.9904
Epoch 26/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0371 - acc: 0.9903
Epoch 27/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0331 - acc: 0.9918
Epoch 28/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0314 - acc: 0.9928
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8095
False 976
True percentage 0.892404365561
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.97      7318
      B-PER       0.86      0.74      0.79       438
      B-ORG       0.65      0.69      0.67       296
     B-MISC       0.43      0.28      0.34       141
      I-PER       0.90      0.61      0.72       214
      I-ORG       0.51      0.52      0.51       151
     I-MISC       0.50      0.51      0.51       154
      B-LOC       0.73      0.72      0.73       218
      I-LOC       0.74      0.72      0.73       141

avg / total       0.93      0.89      0.91      9071

F-1 Score (without O):
0.665668064709
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104344 unique words.
4340 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 264
OOV word occurences: in test 412
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678080     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,210
Trainable params: 6,790,210
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 11s 32ms/step - loss: 0.6543 - acc: 0.7957
Epoch 2/28

334/334 [==============================] - 9s 27ms/step - loss: 0.3936 - acc: 0.8823
Epoch 3/28

334/334 [==============================] - 9s 27ms/step - loss: 0.3258 - acc: 0.9010
Epoch 4/28

334/334 [==============================] - 9s 27ms/step - loss: 0.2824 - acc: 0.9162
Epoch 5/28

334/334 [==============================] - 9s 27ms/step - loss: 0.2480 - acc: 0.9294
Epoch 6/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2243 - acc: 0.9362
Epoch 7/28

334/334 [==============================] - 9s 27ms/step - loss: 0.2045 - acc: 0.9420
Epoch 8/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1771 - acc: 0.9488
Epoch 9/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1597 - acc: 0.9566
Epoch 10/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1529 - acc: 0.9584
Epoch 11/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1362 - acc: 0.9648
Epoch 12/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1242 - acc: 0.9681
Epoch 13/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1113 - acc: 0.9712
Epoch 14/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1056 - acc: 0.9727
Epoch 15/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0941 - acc: 0.9786
Epoch 16/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0879 - acc: 0.9790
Epoch 17/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0787 - acc: 0.9835
Epoch 18/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0716 - acc: 0.9812
Epoch 19/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0673 - acc: 0.9842
Epoch 20/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0599 - acc: 0.9858
Epoch 21/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0565 - acc: 0.9882
Epoch 22/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0526 - acc: 0.9889
Epoch 23/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0491 - acc: 0.9893
Epoch 24/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0478 - acc: 0.9886
Epoch 25/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0460 - acc: 0.9898
Epoch 26/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0438 - acc: 0.9904
Epoch 27/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0406 - acc: 0.9919
Epoch 28/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0375 - acc: 0.9920
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8021
False 1050
True percentage 0.884246499835
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-LOC       0.69      0.68      0.68       218
      I-LOC       0.77      0.68      0.72       141
      B-PER       0.89      0.69      0.78       438
      B-ORG       0.63      0.68      0.66       296
      I-ORG       0.48      0.48      0.48       151
     B-MISC       0.53      0.25      0.34       141
     I-MISC       0.45      0.36      0.40       154
      I-PER       0.81      0.59      0.68       214

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.638991389914
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104341 unique words.
4337 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 260
OOV word occurences: in test 400
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6677888     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,018
Trainable params: 6,790,018
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 11s 32ms/step - loss: 0.5924 - acc: 0.8162
Epoch 2/28

334/334 [==============================] - 9s 28ms/step - loss: 0.3349 - acc: 0.8959
Epoch 3/28

334/334 [==============================] - 9s 27ms/step - loss: 0.2741 - acc: 0.9225
Epoch 4/28

334/334 [==============================] - 9s 27ms/step - loss: 0.2387 - acc: 0.9300
Epoch 5/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2087 - acc: 0.9382
Epoch 6/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1856 - acc: 0.9456
Epoch 7/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1628 - acc: 0.9564
Epoch 8/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1482 - acc: 0.9568
Epoch 9/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1338 - acc: 0.9616
Epoch 10/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1216 - acc: 0.9689
Epoch 11/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1110 - acc: 0.9710
Epoch 12/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1021 - acc: 0.9719
Epoch 13/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0951 - acc: 0.9754
Epoch 14/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0871 - acc: 0.9794
Epoch 15/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0773 - acc: 0.9805
Epoch 16/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0706 - acc: 0.9834
Epoch 17/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0678 - acc: 0.9815
Epoch 18/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0607 - acc: 0.9846
Epoch 19/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0582 - acc: 0.9874
Epoch 20/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0526 - acc: 0.9879
Epoch 21/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0503 - acc: 0.9903
Epoch 22/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0476 - acc: 0.9896
Epoch 23/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0452 - acc: 0.9905
Epoch 24/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0415 - acc: 0.9921
Epoch 25/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0384 - acc: 0.9922
Epoch 26/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0377 - acc: 0.9913
Epoch 27/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0372 - acc: 0.9926
Epoch 28/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0325 - acc: 0.9940
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8043
False 1028
True percentage 0.886671811267
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.97      7318
      B-PER       0.84      0.73      0.78       438
      B-LOC       0.72      0.70      0.71       218
     B-MISC       0.42      0.32      0.36       141
     I-MISC       0.41      0.39      0.40       154
      B-ORG       0.66      0.66      0.66       296
      I-ORG       0.53      0.45      0.49       151
      I-LOC       0.77      0.67      0.72       141
      I-PER       0.80      0.64      0.71       214

avg / total       0.92      0.89      0.90      9071

F-1 Score (without O):
0.646190906354
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104352 unique words.
4348 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 259
OOV word occurences: in test 420
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678592     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,722
Trainable params: 6,790,722
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 11s 33ms/step - loss: 0.6880 - acc: 0.8028
Epoch 2/28

334/334 [==============================] - 9s 27ms/step - loss: 0.3537 - acc: 0.8922
Epoch 3/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2973 - acc: 0.9100
Epoch 4/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2524 - acc: 0.9243
Epoch 5/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2177 - acc: 0.9388
Epoch 6/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1880 - acc: 0.9477
Epoch 7/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1686 - acc: 0.9536
Epoch 8/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1509 - acc: 0.9588
Epoch 9/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1307 - acc: 0.9644
Epoch 10/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1210 - acc: 0.9674
Epoch 11/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1072 - acc: 0.9733
Epoch 12/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0993 - acc: 0.9754
Epoch 13/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0905 - acc: 0.9784
Epoch 14/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0822 - acc: 0.9776
Epoch 15/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0741 - acc: 0.9829
Epoch 16/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0671 - acc: 0.9849
Epoch 17/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0642 - acc: 0.9853
Epoch 18/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0592 - acc: 0.9871
Epoch 19/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0549 - acc: 0.9872
Epoch 20/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0512 - acc: 0.9885
Epoch 21/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0473 - acc: 0.9897
Epoch 22/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0444 - acc: 0.9897
Epoch 23/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0393 - acc: 0.9931
Epoch 24/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0406 - acc: 0.9904
Epoch 25/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0378 - acc: 0.9914
Epoch 26/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0346 - acc: 0.9942
Epoch 27/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0341 - acc: 0.9925
Epoch 28/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0319 - acc: 0.9934
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7973
False 1098
True percentage 0.878954911256
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.97      7318
      B-ORG       0.61      0.68      0.65       296
      I-ORG       0.37      0.52      0.43       151
      B-PER       0.86      0.69      0.77       438
      I-PER       0.94      0.54      0.69       214
      B-LOC       0.70      0.64      0.67       218
      I-LOC       0.68      0.70      0.69       141
     B-MISC       0.33      0.23      0.27       141
     I-MISC       0.45      0.31      0.36       154

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.612552806276
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104323 unique words.
4319 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 265
OOV word occurences: in test 448
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6676736     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,788,866
Trainable params: 6,788,866
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 11s 33ms/step - loss: 0.7150 - acc: 0.7904
Epoch 2/28

334/334 [==============================] - 9s 28ms/step - loss: 0.3831 - acc: 0.8829
Epoch 3/28

334/334 [==============================] - 9s 28ms/step - loss: 0.3201 - acc: 0.9028
Epoch 4/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2778 - acc: 0.9180
Epoch 5/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2441 - acc: 0.9279
Epoch 6/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2116 - acc: 0.9414
Epoch 7/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1967 - acc: 0.9476
Epoch 8/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1717 - acc: 0.9566
Epoch 9/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1605 - acc: 0.9578
Epoch 10/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1449 - acc: 0.9620
Epoch 11/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1297 - acc: 0.9659
Epoch 12/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1223 - acc: 0.9712
Epoch 13/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1058 - acc: 0.9749
Epoch 14/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0997 - acc: 0.9779
Epoch 15/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0930 - acc: 0.9781
Epoch 16/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0891 - acc: 0.9782
Epoch 17/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0796 - acc: 0.9820
Epoch 18/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0722 - acc: 0.9843
Epoch 19/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0671 - acc: 0.9851
Epoch 20/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0626 - acc: 0.9862
Epoch 21/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0592 - acc: 0.9872
Epoch 22/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0559 - acc: 0.9873
Epoch 23/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0541 - acc: 0.9859
Epoch 24/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0490 - acc: 0.9891
Epoch 25/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0491 - acc: 0.9887
Epoch 26/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0457 - acc: 0.9890
Epoch 27/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0422 - acc: 0.9903
Epoch 28/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0402 - acc: 0.9904
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7946
False 1125
True percentage 0.87597839268
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.64      0.56      0.60       296
          O       0.97      0.96      0.96      7318
     B-MISC       0.38      0.21      0.27       141
     I-MISC       0.47      0.29      0.36       154
      B-LOC       0.67      0.67      0.67       218
      I-LOC       0.68      0.62      0.65       141
      B-PER       0.82      0.67      0.73       438
      I-PER       0.88      0.58      0.70       214
      I-ORG       0.41      0.43      0.42       151

avg / total       0.91      0.88      0.89      9071

F-1 Score (without O):
0.907976892105
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104315 unique words.
4311 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 264
OOV word occurences: in test 444
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6676224     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,788,354
Trainable params: 6,788,354
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 11s 32ms/step - loss: 0.6308 - acc: 0.8048
Epoch 2/28

334/334 [==============================] - 9s 28ms/step - loss: 0.3613 - acc: 0.8835
Epoch 3/28

334/334 [==============================] - 9s 27ms/step - loss: 0.2955 - acc: 0.9131
Epoch 4/28

334/334 [==============================] - 9s 27ms/step - loss: 0.2588 - acc: 0.9218
Epoch 5/28

334/334 [==============================] - 9s 27ms/step - loss: 0.2247 - acc: 0.9338
Epoch 6/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2061 - acc: 0.9413
Epoch 7/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1812 - acc: 0.9477
Epoch 8/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1593 - acc: 0.9563
Epoch 9/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1493 - acc: 0.9592
Epoch 10/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1375 - acc: 0.9632
Epoch 11/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1286 - acc: 0.9700
Epoch 12/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1135 - acc: 0.9707
Epoch 13/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1099 - acc: 0.9713
Epoch 14/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0968 - acc: 0.9753
Epoch 15/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0861 - acc: 0.9799
Epoch 16/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0826 - acc: 0.9807
Epoch 17/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0764 - acc: 0.9824
Epoch 18/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0668 - acc: 0.9864
Epoch 19/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0666 - acc: 0.9833
Epoch 20/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0608 - acc: 0.9864
Epoch 21/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0582 - acc: 0.9863
Epoch 22/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0571 - acc: 0.9863
Epoch 23/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0505 - acc: 0.9885
Epoch 24/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0472 - acc: 0.9897
Epoch 25/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0447 - acc: 0.9902
Epoch 26/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0428 - acc: 0.9897
Epoch 27/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0412 - acc: 0.9909
Epoch 28/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0397 - acc: 0.9909
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7896
False 1175
True percentage 0.870466321244
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.94      0.96      7318
      B-PER       0.85      0.64      0.73       438
      B-ORG       0.53      0.52      0.53       296
     B-MISC       0.36      0.34      0.35       141
      I-PER       0.81      0.62      0.70       214
      I-ORG       0.35      0.41      0.38       151
     I-MISC       0.40      0.46      0.43       154
      B-LOC       0.74      0.68      0.71       218
      I-LOC       0.72      0.62      0.67       141

avg / total       0.92      0.87      0.89      9071

F-1 Score (without O):
0.587989244099
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104210 unique words.
4206 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 272
OOV word occurences: in test 488
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6669504     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,781,634
Trainable params: 6,781,634
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 6s 38ms/step - loss: 0.9794 - acc: 0.7295
Epoch 2/28

167/167 [==============================] - 5s 28ms/step - loss: 0.5202 - acc: 0.8291
Epoch 3/28

167/167 [==============================] - 5s 28ms/step - loss: 0.4469 - acc: 0.8563
Epoch 4/28

167/167 [==============================] - 5s 28ms/step - loss: 0.3845 - acc: 0.8797
Epoch 5/28

167/167 [==============================] - 5s 28ms/step - loss: 0.3486 - acc: 0.8927
Epoch 6/28

167/167 [==============================] - 5s 28ms/step - loss: 0.3226 - acc: 0.9048
Epoch 7/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2962 - acc: 0.9165
Epoch 8/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2738 - acc: 0.9208
Epoch 9/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2508 - acc: 0.9301
Epoch 10/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2345 - acc: 0.9329
Epoch 11/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2160 - acc: 0.9435
Epoch 12/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1992 - acc: 0.9429
Epoch 13/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1889 - acc: 0.9509
Epoch 14/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1722 - acc: 0.9590
Epoch 15/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1568 - acc: 0.9642
Epoch 16/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1556 - acc: 0.9614
Epoch 17/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1382 - acc: 0.9682
Epoch 18/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1283 - acc: 0.9720
Epoch 19/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1224 - acc: 0.9700
Epoch 20/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1144 - acc: 0.9747
Epoch 21/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1062 - acc: 0.9769
Epoch 22/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0963 - acc: 0.9810
Epoch 23/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0916 - acc: 0.9848
Epoch 24/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0840 - acc: 0.9834
Epoch 25/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0840 - acc: 0.9821
Epoch 26/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0749 - acc: 0.9863
Epoch 27/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0739 - acc: 0.9863
Epoch 28/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0691 - acc: 0.9865
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7717
False 1354
True percentage 0.850733105501
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.94      0.96      7318
      B-LOC       0.65      0.60      0.62       218
      I-LOC       0.56      0.46      0.50       141
      B-PER       0.85      0.50      0.63       438
      B-ORG       0.54      0.65      0.58       296
      I-ORG       0.30      0.44      0.36       151
     B-MISC       0.34      0.22      0.27       141
     I-MISC       0.32      0.31      0.32       154
      I-PER       0.62      0.40      0.48       214

avg / total       0.90      0.85      0.87      9071

F-1 Score (without O):
0.509911558402
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104194 unique words.
4190 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 269
OOV word occurences: in test 437
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6668480     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,780,610
Trainable params: 6,780,610
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 6s 37ms/step - loss: 0.9274 - acc: 0.7355
Epoch 2/28

167/167 [==============================] - 4s 26ms/step - loss: 0.4662 - acc: 0.8558
Epoch 3/28

167/167 [==============================] - 5s 27ms/step - loss: 0.4064 - acc: 0.8744
Epoch 4/28

167/167 [==============================] - 5s 27ms/step - loss: 0.3346 - acc: 0.8964
Epoch 5/28

167/167 [==============================] - 4s 27ms/step - loss: 0.3063 - acc: 0.9079
Epoch 6/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2664 - acc: 0.9257
Epoch 7/28

167/167 [==============================] - 4s 27ms/step - loss: 0.2483 - acc: 0.9283
Epoch 8/28

167/167 [==============================] - 5s 27ms/step - loss: 0.2275 - acc: 0.9372
Epoch 9/28

167/167 [==============================] - 5s 27ms/step - loss: 0.2080 - acc: 0.9455
Epoch 10/28

167/167 [==============================] - 5s 27ms/step - loss: 0.1941 - acc: 0.9484
Epoch 11/28

167/167 [==============================] - 4s 27ms/step - loss: 0.1795 - acc: 0.9537
Epoch 12/28

167/167 [==============================] - 5s 27ms/step - loss: 0.1686 - acc: 0.9549
Epoch 13/28

167/167 [==============================] - 4s 27ms/step - loss: 0.1561 - acc: 0.9609
Epoch 14/28

167/167 [==============================] - 4s 27ms/step - loss: 0.1418 - acc: 0.9642
Epoch 15/28

167/167 [==============================] - 5s 27ms/step - loss: 0.1326 - acc: 0.9691
Epoch 16/28

167/167 [==============================] - 5s 27ms/step - loss: 0.1175 - acc: 0.9719
Epoch 17/28

167/167 [==============================] - 4s 27ms/step - loss: 0.1153 - acc: 0.9752
Epoch 18/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1047 - acc: 0.9777
Epoch 19/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0949 - acc: 0.9817
Epoch 20/28

167/167 [==============================] - 4s 27ms/step - loss: 0.0907 - acc: 0.9803
Epoch 21/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0857 - acc: 0.9833
Epoch 22/28

167/167 [==============================] - 4s 27ms/step - loss: 0.0789 - acc: 0.9827
Epoch 23/28

167/167 [==============================] - 4s 27ms/step - loss: 0.0736 - acc: 0.9848
Epoch 24/28

167/167 [==============================] - 4s 27ms/step - loss: 0.0688 - acc: 0.9868
Epoch 25/28

167/167 [==============================] - 4s 27ms/step - loss: 0.0681 - acc: 0.9870
Epoch 26/28

167/167 [==============================] - 4s 27ms/step - loss: 0.0645 - acc: 0.9864
Epoch 27/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0621 - acc: 0.9873
Epoch 28/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0563 - acc: 0.9907
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7796
False 1275
True percentage 0.859442178371
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.95      0.95      7318
      B-PER       0.82      0.61      0.70       438
      B-LOC       0.68      0.58      0.63       218
     B-MISC       0.25      0.17      0.20       141
     I-MISC       0.33      0.32      0.33       154
      B-ORG       0.63      0.63      0.63       296
      I-ORG       0.30      0.26      0.28       151
      I-LOC       0.65      0.36      0.46       141
      I-PER       0.78      0.47      0.58       214

avg / total       0.89      0.86      0.87      9071

F-1 Score (without O):
0.537702831689
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104204 unique words.
4200 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 266
OOV word occurences: in test 469
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6669120     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,781,250
Trainable params: 6,781,250
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 6s 37ms/step - loss: 0.8565 - acc: 0.7397
Epoch 2/28

167/167 [==============================] - 5s 27ms/step - loss: 0.4635 - acc: 0.8562
Epoch 3/28

167/167 [==============================] - 5s 27ms/step - loss: 0.3849 - acc: 0.8823
Epoch 4/28

167/167 [==============================] - 5s 27ms/step - loss: 0.3204 - acc: 0.9071
Epoch 5/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2905 - acc: 0.9164
Epoch 6/28

167/167 [==============================] - 5s 27ms/step - loss: 0.2584 - acc: 0.9269
Epoch 7/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2318 - acc: 0.9383
Epoch 8/28

167/167 [==============================] - 5s 27ms/step - loss: 0.1984 - acc: 0.9481
Epoch 9/28

167/167 [==============================] - 5s 27ms/step - loss: 0.1769 - acc: 0.9577
Epoch 10/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1681 - acc: 0.9569
Epoch 11/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1506 - acc: 0.9640
Epoch 12/28

167/167 [==============================] - 5s 27ms/step - loss: 0.1376 - acc: 0.9692
Epoch 13/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1301 - acc: 0.9694
Epoch 14/28

167/167 [==============================] - 5s 27ms/step - loss: 0.1175 - acc: 0.9729
Epoch 15/28

167/167 [==============================] - 5s 27ms/step - loss: 0.1047 - acc: 0.9770
Epoch 16/28

167/167 [==============================] - 5s 27ms/step - loss: 0.1000 - acc: 0.9781
Epoch 17/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0896 - acc: 0.9822
Epoch 18/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0843 - acc: 0.9836
Epoch 19/28

167/167 [==============================] - 4s 27ms/step - loss: 0.0791 - acc: 0.9841
Epoch 20/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0712 - acc: 0.9852
Epoch 21/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0670 - acc: 0.9877
Epoch 22/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0613 - acc: 0.9891
Epoch 23/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0615 - acc: 0.9875
Epoch 24/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0542 - acc: 0.9906
Epoch 25/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0520 - acc: 0.9906
Epoch 26/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0482 - acc: 0.9927
Epoch 27/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0452 - acc: 0.9912
Epoch 28/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0406 - acc: 0.9935
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7811
False 1260
True percentage 0.861095799802
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-ORG       0.54      0.49      0.51       296
      I-ORG       0.27      0.43      0.33       151
      B-PER       0.81      0.64      0.72       438
      I-PER       0.80      0.51      0.62       214
      B-LOC       0.68      0.58      0.63       218
      I-LOC       0.76      0.30      0.43       141
     B-MISC       0.39      0.29      0.33       141
     I-MISC       0.41      0.32      0.36       154

avg / total       0.91      0.86      0.88      9071

F-1 Score (without O):
0.534412955466
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104186 unique words.
4182 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 269
OOV word occurences: in test 453
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6667968     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,780,098
Trainable params: 6,780,098
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 6s 39ms/step - loss: 0.8104 - acc: 0.7785
Epoch 2/28

167/167 [==============================] - 5s 29ms/step - loss: 0.4199 - acc: 0.8691
Epoch 3/28

167/167 [==============================] - 5s 29ms/step - loss: 0.3589 - acc: 0.8928
Epoch 4/28

167/167 [==============================] - 5s 29ms/step - loss: 0.3113 - acc: 0.9006
Epoch 5/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2751 - acc: 0.9135
Epoch 6/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2517 - acc: 0.9226
Epoch 7/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2270 - acc: 0.9308
Epoch 8/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2083 - acc: 0.9388
Epoch 9/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1896 - acc: 0.9466
Epoch 10/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1737 - acc: 0.9516
Epoch 11/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1585 - acc: 0.9588
Epoch 12/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1434 - acc: 0.9619
Epoch 13/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1332 - acc: 0.9684
Epoch 14/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1246 - acc: 0.9700
Epoch 15/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1163 - acc: 0.9738
Epoch 16/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1021 - acc: 0.9807
Epoch 17/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1043 - acc: 0.9764
Epoch 18/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0926 - acc: 0.9810
Epoch 19/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0867 - acc: 0.9826
Epoch 20/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0809 - acc: 0.9846
Epoch 21/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0730 - acc: 0.9873
Epoch 22/28

167/167 [==============================] - 5s 30ms/step - loss: 0.0664 - acc: 0.9902
Epoch 23/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0650 - acc: 0.9896
Epoch 24/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0618 - acc: 0.9883
Epoch 25/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0576 - acc: 0.9891
Epoch 26/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0560 - acc: 0.9893
Epoch 27/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0515 - acc: 0.9914
Epoch 28/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0479 - acc: 0.9938
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7817
False 1254
True percentage 0.861757248374
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.61      0.52      0.56       296
          O       0.96      0.95      0.96      7318
     B-MISC       0.34      0.22      0.27       141
     I-MISC       0.28      0.24      0.26       154
      B-LOC       0.66      0.51      0.58       218
      I-LOC       0.77      0.39      0.52       141
      B-PER       0.73      0.68      0.71       438
      I-PER       0.82      0.50      0.62       214
      I-ORG       0.42      0.28      0.34       151

avg / total       0.89      0.86      0.88      9071

F-1 Score (without O):
0.894165694282
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104165 unique words.
4161 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 270
OOV word occurences: in test 538
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6666624     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,778,754
Trainable params: 6,778,754
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 6s 38ms/step - loss: 0.9465 - acc: 0.7320
Epoch 2/28

167/167 [==============================] - 5s 29ms/step - loss: 0.4564 - acc: 0.8559
Epoch 3/28

167/167 [==============================] - 5s 28ms/step - loss: 0.3828 - acc: 0.8791
Epoch 4/28

167/167 [==============================] - 5s 29ms/step - loss: 0.3372 - acc: 0.9001
Epoch 5/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2924 - acc: 0.9139
Epoch 6/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2654 - acc: 0.9222
Epoch 7/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2401 - acc: 0.9349
Epoch 8/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2208 - acc: 0.9372
Epoch 9/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2056 - acc: 0.9425
Epoch 10/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1853 - acc: 0.9524
Epoch 11/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1754 - acc: 0.9544
Epoch 12/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1587 - acc: 0.9599
Epoch 13/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1491 - acc: 0.9663
Epoch 14/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1415 - acc: 0.9628
Epoch 15/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1289 - acc: 0.9735
Epoch 16/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1223 - acc: 0.9730
Epoch 17/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1131 - acc: 0.9736
Epoch 18/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1091 - acc: 0.9730
Epoch 19/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1034 - acc: 0.9769
Epoch 20/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0901 - acc: 0.9795
Epoch 21/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0870 - acc: 0.9817
Epoch 22/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0849 - acc: 0.9818
Epoch 23/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0797 - acc: 0.9824
Epoch 24/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0778 - acc: 0.9828
Epoch 25/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0713 - acc: 0.9814
Epoch 26/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0648 - acc: 0.9877
Epoch 27/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0647 - acc: 0.9852
Epoch 28/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0634 - acc: 0.9848
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7764
False 1307
True percentage 0.855914452651
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-PER       0.72      0.51      0.60       438
      B-ORG       0.54      0.44      0.49       296
     B-MISC       0.37      0.28      0.32       141
      I-PER       0.73      0.48      0.58       214
      I-ORG       0.30      0.46      0.36       151
     I-MISC       0.40      0.24      0.30       154
      B-LOC       0.81      0.61      0.69       218
      I-LOC       0.72      0.56      0.63       141

avg / total       0.90      0.86      0.88      9071

F-1 Score (without O):
0.516518424396
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104116 unique words.
4112 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 278
OOV word occurences: in test 539
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663488     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,618
Trainable params: 6,775,618
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 4s 48ms/step - loss: 1.0153 - acc: 0.6892
Epoch 2/28

83/83 [==============================] - 2s 29ms/step - loss: 0.5158 - acc: 0.8321
Epoch 3/28

83/83 [==============================] - 2s 29ms/step - loss: 0.4325 - acc: 0.8569
Epoch 4/28

83/83 [==============================] - 2s 29ms/step - loss: 0.3937 - acc: 0.8608
Epoch 5/28

83/83 [==============================] - 2s 29ms/step - loss: 0.3501 - acc: 0.8997
Epoch 6/28

83/83 [==============================] - 2s 29ms/step - loss: 0.3191 - acc: 0.9030
Epoch 7/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2817 - acc: 0.9168
Epoch 8/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2665 - acc: 0.9236
Epoch 9/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2476 - acc: 0.9296
Epoch 10/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2305 - acc: 0.9359
Epoch 11/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2098 - acc: 0.9526
Epoch 12/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1989 - acc: 0.9537
Epoch 13/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1900 - acc: 0.9536
Epoch 14/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1696 - acc: 0.9627
Epoch 15/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1588 - acc: 0.9668
Epoch 16/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1458 - acc: 0.9733
Epoch 17/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1384 - acc: 0.9801
Epoch 18/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1245 - acc: 0.9785
Epoch 19/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1230 - acc: 0.9739
Epoch 20/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1113 - acc: 0.9830
Epoch 21/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1039 - acc: 0.9822
Epoch 22/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0960 - acc: 0.9874
Epoch 23/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0969 - acc: 0.9846
Epoch 24/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0868 - acc: 0.9885
Epoch 25/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0852 - acc: 0.9890
Epoch 26/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0776 - acc: 0.9909
Epoch 27/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0732 - acc: 0.9952
Epoch 28/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0709 - acc: 0.9923
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7574
False 1497
True percentage 0.834968581193
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.94      0.96      7318
      B-LOC       0.62      0.51      0.56       218
      I-LOC       0.50      0.23      0.32       141
      B-PER       0.73      0.45      0.55       438
      B-ORG       0.46      0.60      0.53       296
      I-ORG       0.19      0.33      0.24       151
     B-MISC       0.22      0.12      0.16       141
     I-MISC       0.41      0.27      0.32       154
      I-PER       0.62      0.40      0.49       214

avg / total       0.89      0.83      0.86      9071

F-1 Score (without O):
0.440185471406
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104112 unique words.
4108 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 277
OOV word occurences: in test 484
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663232     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,362
Trainable params: 6,775,362
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 4s 49ms/step - loss: 0.9765 - acc: 0.6916
Epoch 2/28

83/83 [==============================] - 2s 29ms/step - loss: 0.4983 - acc: 0.8485
Epoch 3/28

83/83 [==============================] - 2s 30ms/step - loss: 0.4217 - acc: 0.8726
Epoch 4/28

83/83 [==============================] - 2s 30ms/step - loss: 0.3657 - acc: 0.8902
Epoch 5/28

83/83 [==============================] - 2s 30ms/step - loss: 0.3310 - acc: 0.8978
Epoch 6/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2962 - acc: 0.9112
Epoch 7/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2693 - acc: 0.9217
Epoch 8/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2430 - acc: 0.9323
Epoch 9/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2224 - acc: 0.9435
Epoch 10/28

83/83 [==============================] - 3s 30ms/step - loss: 0.2102 - acc: 0.9451
Epoch 11/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1970 - acc: 0.9512
Epoch 12/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1868 - acc: 0.9504
Epoch 13/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1702 - acc: 0.9660
Epoch 14/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1587 - acc: 0.9650
Epoch 15/28

83/83 [==============================] - 2s 30ms/step - loss: 0.1462 - acc: 0.9630
Epoch 16/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1340 - acc: 0.9696
Epoch 17/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1283 - acc: 0.9697
Epoch 18/28

83/83 [==============================] - 2s 30ms/step - loss: 0.1174 - acc: 0.9751
Epoch 19/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1109 - acc: 0.9725
Epoch 20/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1044 - acc: 0.9805
Epoch 21/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0984 - acc: 0.9794
Epoch 22/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0984 - acc: 0.9802
Epoch 23/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0883 - acc: 0.9830
Epoch 24/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0886 - acc: 0.9824
Epoch 25/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0798 - acc: 0.9848
Epoch 26/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0707 - acc: 0.9873
Epoch 27/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0692 - acc: 0.9858
Epoch 28/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0653 - acc: 0.9918
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7664
False 1407
True percentage 0.844890309778
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-PER       0.77      0.57      0.66       438
      B-LOC       0.61      0.56      0.59       218
     B-MISC       0.18      0.11      0.14       141
     I-MISC       0.29      0.21      0.25       154
      B-ORG       0.45      0.46      0.46       296
      I-ORG       0.27      0.40      0.32       151
      I-LOC       0.60      0.37      0.46       141
      I-PER       0.79      0.32      0.46       214

avg / total       0.89      0.84      0.86      9071

F-1 Score (without O):
0.464912280702
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104117 unique words.
4113 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 275
OOV word occurences: in test 481
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663552     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,682
Trainable params: 6,775,682
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 4s 48ms/step - loss: 1.2959 - acc: 0.6261
Epoch 2/28

83/83 [==============================] - 2s 28ms/step - loss: 0.5578 - acc: 0.8195
Epoch 3/28

83/83 [==============================] - 2s 28ms/step - loss: 0.5038 - acc: 0.8414
Epoch 4/28

83/83 [==============================] - 2s 28ms/step - loss: 0.4396 - acc: 0.8644
Epoch 5/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3964 - acc: 0.8834
Epoch 6/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3546 - acc: 0.8954
Epoch 7/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3191 - acc: 0.9120
Epoch 8/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2936 - acc: 0.9196
Epoch 9/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2739 - acc: 0.9302
Epoch 10/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2510 - acc: 0.9378
Epoch 11/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2334 - acc: 0.9367
Epoch 12/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2174 - acc: 0.9471
Epoch 13/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1923 - acc: 0.9603
Epoch 14/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1822 - acc: 0.9582
Epoch 15/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1731 - acc: 0.9601
Epoch 16/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1596 - acc: 0.9676
Epoch 17/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1472 - acc: 0.9673
Epoch 18/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1350 - acc: 0.9731
Epoch 19/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1248 - acc: 0.9745
Epoch 20/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1182 - acc: 0.9759
Epoch 21/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1134 - acc: 0.9827
Epoch 22/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1052 - acc: 0.9754
Epoch 23/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0994 - acc: 0.9787
Epoch 24/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0946 - acc: 0.9837
Epoch 25/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0929 - acc: 0.9854
Epoch 26/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0809 - acc: 0.9850
Epoch 27/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0769 - acc: 0.9864
Epoch 28/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0730 - acc: 0.9866
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7748
False 1323
True percentage 0.854150589792
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-ORG       0.51      0.48      0.50       296
      I-ORG       0.31      0.36      0.33       151
      B-PER       0.72      0.61      0.66       438
      I-PER       0.66      0.56      0.61       214
      B-LOC       0.66      0.52      0.58       218
      I-LOC       0.65      0.39      0.49       141
     B-MISC       0.33      0.14      0.20       141
     I-MISC       0.38      0.29      0.33       154

avg / total       0.89      0.85      0.87      9071

F-1 Score (without O):
0.51240188383
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104120 unique words.
4116 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 279
OOV word occurences: in test 552
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663744     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,874
Trainable params: 6,775,874
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 4s 49ms/step - loss: 1.0712 - acc: 0.6888
Epoch 2/28

83/83 [==============================] - 2s 28ms/step - loss: 0.5036 - acc: 0.8423
Epoch 3/28

83/83 [==============================] - 2s 28ms/step - loss: 0.4096 - acc: 0.8781
Epoch 4/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3554 - acc: 0.8851
Epoch 5/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3439 - acc: 0.8959
Epoch 6/28

83/83 [==============================] - 2s 29ms/step - loss: 0.3084 - acc: 0.9169
Epoch 7/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2684 - acc: 0.9252
Epoch 8/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2479 - acc: 0.9317
Epoch 9/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2257 - acc: 0.9350
Epoch 10/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2140 - acc: 0.9389
Epoch 11/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2030 - acc: 0.9428
Epoch 12/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1891 - acc: 0.9502
Epoch 13/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1694 - acc: 0.9579
Epoch 14/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1659 - acc: 0.9576
Epoch 15/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1574 - acc: 0.9647
Epoch 16/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1405 - acc: 0.9760
Epoch 17/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1337 - acc: 0.9711
Epoch 18/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1262 - acc: 0.9748
Epoch 19/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1180 - acc: 0.9743
Epoch 20/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1098 - acc: 0.9755
Epoch 21/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0984 - acc: 0.9800
Epoch 22/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1010 - acc: 0.9823
Epoch 23/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0932 - acc: 0.9859
Epoch 24/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0913 - acc: 0.9868
Epoch 25/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0808 - acc: 0.9862
Epoch 26/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0843 - acc: 0.9821
Epoch 27/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0753 - acc: 0.9921
Epoch 28/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0689 - acc: 0.9898
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7541
False 1530
True percentage 0.831330614045
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.53      0.43      0.47       296
          O       0.95      0.95      0.95      7318
     B-MISC       0.27      0.26      0.26       141
     I-MISC       0.23      0.38      0.29       154
      B-LOC       0.74      0.40      0.52       218
      I-LOC       0.68      0.12      0.20       141
      B-PER       0.67      0.41      0.51       438
      I-PER       0.62      0.30      0.41       214
      I-ORG       0.31      0.22      0.26       151

avg / total       0.88      0.83      0.85      9071

F-1 Score (without O):
0.869539724421
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104103 unique words.
4099 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 277
OOV word occurences: in test 557
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6662656     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,774,786
Trainable params: 6,774,786
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 4s 48ms/step - loss: 1.1272 - acc: 0.6939
Epoch 2/28

83/83 [==============================] - 2s 28ms/step - loss: 0.4783 - acc: 0.8567
Epoch 3/28

83/83 [==============================] - 2s 29ms/step - loss: 0.3929 - acc: 0.8777
Epoch 4/28

83/83 [==============================] - 2s 29ms/step - loss: 0.3613 - acc: 0.8836
Epoch 5/28

83/83 [==============================] - 2s 29ms/step - loss: 0.3443 - acc: 0.8855
Epoch 6/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2911 - acc: 0.9109
Epoch 7/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2612 - acc: 0.9190
Epoch 8/28

83/83 [==============================] - 2s 30ms/step - loss: 0.2466 - acc: 0.9231
Epoch 9/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2254 - acc: 0.9333
Epoch 10/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2092 - acc: 0.9481
Epoch 11/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1870 - acc: 0.9526
Epoch 12/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1773 - acc: 0.9607
Epoch 13/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1710 - acc: 0.9497
Epoch 14/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1512 - acc: 0.9658
Epoch 15/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1437 - acc: 0.9676
Epoch 16/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1315 - acc: 0.9741
Epoch 17/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1268 - acc: 0.9708
Epoch 18/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1158 - acc: 0.9784
Epoch 19/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1128 - acc: 0.9783
Epoch 20/28

83/83 [==============================] - 2s 30ms/step - loss: 0.1029 - acc: 0.9818
Epoch 21/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0933 - acc: 0.9880
Epoch 22/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0928 - acc: 0.9837
Epoch 23/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0788 - acc: 0.9893
Epoch 24/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0755 - acc: 0.9883
Epoch 25/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0772 - acc: 0.9890
Epoch 26/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0709 - acc: 0.9910
Epoch 27/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0667 - acc: 0.9925
Epoch 28/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0625 - acc: 0.9942
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7610
False 1461
True percentage 0.838937272627
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.94      0.96      7318
      B-PER       0.63      0.43      0.51       438
      B-ORG       0.45      0.40      0.43       296
     B-MISC       0.38      0.29      0.33       141
      I-PER       0.62      0.43      0.51       214
      I-ORG       0.33      0.33      0.33       151
     I-MISC       0.28      0.32      0.30       154
      B-LOC       0.71      0.47      0.57       218
      I-LOC       0.56      0.54      0.55       141

avg / total       0.89      0.84      0.86      9071

F-1 Score (without O):
0.452687834014
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104064 unique words.
4060 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 558
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660160     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,290
Trainable params: 6,772,290
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 3s 81ms/step - loss: 1.9366 - acc: 0.4116
Epoch 2/28

33/33 [==============================] - 1s 31ms/step - loss: 0.9153 - acc: 0.7820
Epoch 3/28

33/33 [==============================] - 1s 31ms/step - loss: 0.6812 - acc: 0.7940
Epoch 4/28

33/33 [==============================] - 1s 31ms/step - loss: 0.5987 - acc: 0.7940
Epoch 5/28

33/33 [==============================] - 1s 31ms/step - loss: 0.5233 - acc: 0.8307
Epoch 6/28

33/33 [==============================] - 1s 31ms/step - loss: 0.4826 - acc: 0.8508
Epoch 7/28

33/33 [==============================] - 1s 32ms/step - loss: 0.5164 - acc: 0.8320
Epoch 8/28

33/33 [==============================] - 1s 31ms/step - loss: 0.4117 - acc: 0.8681
Epoch 9/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3781 - acc: 0.8736
Epoch 10/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3382 - acc: 0.9076
Epoch 11/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3268 - acc: 0.9195
Epoch 12/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3172 - acc: 0.9223
Epoch 13/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2871 - acc: 0.9298
Epoch 14/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2710 - acc: 0.9394
Epoch 15/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2742 - acc: 0.9419
Epoch 16/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2512 - acc: 0.9519
Epoch 17/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2616 - acc: 0.9227
Epoch 18/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2162 - acc: 0.9542
Epoch 19/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2223 - acc: 0.9607
Epoch 20/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2033 - acc: 0.9637
Epoch 21/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1974 - acc: 0.9531
Epoch 22/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1844 - acc: 0.9618
Epoch 23/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1858 - acc: 0.9732
Epoch 24/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1695 - acc: 0.9761
Epoch 25/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1582 - acc: 0.9647
Epoch 26/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1570 - acc: 0.9713
Epoch 27/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1578 - acc: 0.9762
Epoch 28/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1479 - acc: 0.9790
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7478
False 1593
True percentage 0.824385404035
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.94      0.95      7318
      B-LOC       0.58      0.40      0.48       218
      I-LOC       0.63      0.23      0.34       141
      B-PER       0.71      0.37      0.48       438
      B-ORG       0.38      0.46      0.42       296
      I-ORG       0.21      0.30      0.25       151
     B-MISC       0.44      0.19      0.27       141
     I-MISC       0.25      0.28      0.27       154
      I-PER       0.65      0.24      0.35       214

avg / total       0.87      0.82      0.84      9071

F-1 Score (without O):
0.381510416667
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104062 unique words.
4058 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 280
OOV word occurences: in test 496
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660032     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,162
Trainable params: 6,772,162
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 3s 79ms/step - loss: 2.0189 - acc: 0.4312
Epoch 2/28

33/33 [==============================] - 1s 30ms/step - loss: 0.7314 - acc: 0.7984
Epoch 3/28

33/33 [==============================] - 1s 31ms/step - loss: 0.5343 - acc: 0.8261
Epoch 4/28

33/33 [==============================] - 1s 30ms/step - loss: 0.4918 - acc: 0.8401
Epoch 5/28

33/33 [==============================] - 1s 30ms/step - loss: 0.4451 - acc: 0.8737
Epoch 6/28

33/33 [==============================] - 1s 30ms/step - loss: 0.4263 - acc: 0.8938
Epoch 7/28

33/33 [==============================] - 1s 30ms/step - loss: 0.3884 - acc: 0.8948
Epoch 8/28

33/33 [==============================] - 1s 30ms/step - loss: 0.3567 - acc: 0.8999
Epoch 9/28

33/33 [==============================] - 1s 30ms/step - loss: 0.3708 - acc: 0.9054
Epoch 10/28

33/33 [==============================] - 1s 30ms/step - loss: 0.3224 - acc: 0.9182
Epoch 11/28

33/33 [==============================] - 1s 29ms/step - loss: 0.2927 - acc: 0.9154
Epoch 12/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2907 - acc: 0.9332
Epoch 13/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2670 - acc: 0.9274
Epoch 14/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2877 - acc: 0.9279
Epoch 15/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2462 - acc: 0.9235
Epoch 16/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2354 - acc: 0.9280
Epoch 17/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2160 - acc: 0.9388
Epoch 18/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2172 - acc: 0.9348
Epoch 19/28

33/33 [==============================] - 1s 29ms/step - loss: 0.2134 - acc: 0.9396
Epoch 20/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1961 - acc: 0.9525
Epoch 21/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1979 - acc: 0.9573
Epoch 22/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1749 - acc: 0.9630
Epoch 23/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1745 - acc: 0.9588
Epoch 24/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1653 - acc: 0.9643
Epoch 25/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1497 - acc: 0.9733
Epoch 26/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1515 - acc: 0.9630
Epoch 27/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1411 - acc: 0.9660
Epoch 28/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1366 - acc: 0.9626
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7350
False 1721
True percentage 0.810274501158
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.94      0.94      7318
      B-PER       0.63      0.47      0.54       438
      B-LOC       0.78      0.26      0.39       218
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-ORG       0.30      0.46      0.36       296
      I-ORG       0.12      0.30      0.17       151
      I-LOC       0.00      0.00      0.00       141
      I-PER       0.64      0.16      0.25       214

avg / total       0.84      0.81      0.82      9071

F-1 Score (without O):
0.311662855276
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104072 unique words.
4068 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 279
OOV word occurences: in test 552
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660672     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,802
Trainable params: 6,772,802
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 3s 81ms/step - loss: 1.6361 - acc: 0.4942
Epoch 2/28

33/33 [==============================] - 1s 30ms/step - loss: 0.7608 - acc: 0.7905
Epoch 3/28

33/33 [==============================] - 1s 31ms/step - loss: 0.6334 - acc: 0.8187
Epoch 4/28

33/33 [==============================] - 1s 30ms/step - loss: 0.5266 - acc: 0.8445
Epoch 5/28

33/33 [==============================] - 1s 31ms/step - loss: 0.4909 - acc: 0.8638
Epoch 6/28

33/33 [==============================] - 1s 31ms/step - loss: 0.4508 - acc: 0.8619
Epoch 7/28

33/33 [==============================] - 1s 31ms/step - loss: 0.4317 - acc: 0.8848
Epoch 8/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3884 - acc: 0.9014
Epoch 9/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3516 - acc: 0.9104
Epoch 10/28

33/33 [==============================] - 1s 30ms/step - loss: 0.3314 - acc: 0.9016
Epoch 11/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3208 - acc: 0.8967
Epoch 12/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2987 - acc: 0.9128
Epoch 13/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2742 - acc: 0.9258
Epoch 14/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2712 - acc: 0.9282
Epoch 15/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2588 - acc: 0.9247
Epoch 16/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2544 - acc: 0.9390
Epoch 17/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2507 - acc: 0.9186
Epoch 18/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2223 - acc: 0.9461
Epoch 19/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2175 - acc: 0.9364
Epoch 20/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1981 - acc: 0.9513
Epoch 21/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1829 - acc: 0.9631
Epoch 22/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1794 - acc: 0.9601
Epoch 23/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1800 - acc: 0.9639
Epoch 24/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1634 - acc: 0.9708
Epoch 25/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1617 - acc: 0.9639
Epoch 26/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1620 - acc: 0.9630
Epoch 27/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1358 - acc: 0.9811
Epoch 28/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1388 - acc: 0.9793
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7340
False 1731
True percentage 0.80917208687
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.93      0.95      7318
      B-ORG       0.31      0.44      0.36       296
      I-ORG       0.17      0.24      0.20       151
      B-PER       0.62      0.37      0.47       438
      I-PER       0.33      0.49      0.39       214
      B-LOC       0.70      0.30      0.42       218
      I-LOC       1.00      0.01      0.01       141
     B-MISC       0.34      0.13      0.19       141
     I-MISC       0.24      0.29      0.26       154

avg / total       0.88      0.81      0.83      9071

F-1 Score (without O):
0.340929808569
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104069 unique words.
4065 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 281
OOV word occurences: in test 562
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660480     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,610
Trainable params: 6,772,610
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 3s 80ms/step - loss: 1.6726 - acc: 0.5158
Epoch 2/28

33/33 [==============================] - 1s 30ms/step - loss: 0.6300 - acc: 0.8187
Epoch 3/28

33/33 [==============================] - 1s 31ms/step - loss: 0.5579 - acc: 0.8181
Epoch 4/28

33/33 [==============================] - 1s 31ms/step - loss: 0.4534 - acc: 0.8566
Epoch 5/28

33/33 [==============================] - 1s 31ms/step - loss: 0.4012 - acc: 0.8688
Epoch 6/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3644 - acc: 0.8867
Epoch 7/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3409 - acc: 0.9016
Epoch 8/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3593 - acc: 0.8769
Epoch 9/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3155 - acc: 0.8929
Epoch 10/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3253 - acc: 0.8968
Epoch 11/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2631 - acc: 0.9295
Epoch 12/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2568 - acc: 0.9357
Epoch 13/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2566 - acc: 0.9292
Epoch 14/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2468 - acc: 0.9331
Epoch 15/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2306 - acc: 0.9249
Epoch 16/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2142 - acc: 0.9392
Epoch 17/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2127 - acc: 0.9448
Epoch 18/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1869 - acc: 0.9606
Epoch 19/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1892 - acc: 0.9589
Epoch 20/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1933 - acc: 0.9553
Epoch 21/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1962 - acc: 0.9504
Epoch 22/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1785 - acc: 0.9653
Epoch 23/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1655 - acc: 0.9665
Epoch 24/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1538 - acc: 0.9695
Epoch 25/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1556 - acc: 0.9675
Epoch 26/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1434 - acc: 0.9711
Epoch 27/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1419 - acc: 0.9716
Epoch 28/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1349 - acc: 0.9796
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7278
False 1793
True percentage 0.802337118289
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.29      0.39      0.33       296
          O       0.98      0.92      0.95      7318
     B-MISC       0.16      0.16      0.16       141
     I-MISC       0.20      0.67      0.31       154
      B-LOC       0.58      0.49      0.53       218
      I-LOC       1.00      0.07      0.13       141
      B-PER       0.57      0.26      0.36       438
      I-PER       0.40      0.28      0.33       214
      I-ORG       0.00      0.00      0.00       151

avg / total       0.87      0.80      0.82      9071

F-1 Score (without O):
0.848445365709
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104064 unique words.
4060 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 280
OOV word occurences: in test 560
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660160     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,290
Trainable params: 6,772,290
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 3s 80ms/step - loss: 1.5220 - acc: 0.5229
Epoch 2/28

33/33 [==============================] - 1s 32ms/step - loss: 0.5559 - acc: 0.8382
Epoch 3/28

33/33 [==============================] - 1s 32ms/step - loss: 0.4191 - acc: 0.8655
Epoch 4/28

33/33 [==============================] - 1s 31ms/step - loss: 0.4079 - acc: 0.8622
Epoch 5/28

33/33 [==============================] - 1s 33ms/step - loss: 0.3429 - acc: 0.8850
Epoch 6/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3579 - acc: 0.8904
Epoch 7/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2953 - acc: 0.9188
Epoch 8/28

33/33 [==============================] - 1s 31ms/step - loss: 0.4114 - acc: 0.8862
Epoch 9/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2697 - acc: 0.9164
Epoch 10/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2490 - acc: 0.9318
Epoch 11/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2330 - acc: 0.9399
Epoch 12/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2320 - acc: 0.9274
Epoch 13/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2073 - acc: 0.9407
Epoch 14/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2124 - acc: 0.9295
Epoch 15/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2095 - acc: 0.9447
Epoch 16/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1947 - acc: 0.9478
Epoch 17/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1818 - acc: 0.9587
Epoch 18/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1844 - acc: 0.9609
Epoch 19/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1689 - acc: 0.9579
Epoch 20/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1711 - acc: 0.9618
Epoch 21/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1674 - acc: 0.9641
Epoch 22/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1564 - acc: 0.9713
Epoch 23/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1465 - acc: 0.9669
Epoch 24/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1361 - acc: 0.9709
Epoch 25/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1471 - acc: 0.9653
Epoch 26/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1377 - acc: 0.9650
Epoch 27/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1240 - acc: 0.9751
Epoch 28/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1261 - acc: 0.9733
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7401
False 1670
True percentage 0.815896814023
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.95      0.94      7318
      B-PER       0.54      0.45      0.49       438
      B-ORG       0.39      0.35      0.37       296
     B-MISC       0.20      0.16      0.18       141
      I-PER       0.62      0.26      0.37       214
      I-ORG       0.27      0.13      0.17       151
     I-MISC       0.21      0.12      0.15       154
      B-LOC       0.52      0.06      0.10       218
      I-LOC       0.51      0.13      0.21       141

avg / total       0.84      0.82      0.82      9071

F-1 Score (without O):
0.319602272727
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 8 unique labels.
Found 104048 unique words.
4044 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 567
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659136     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,116
Trainable params: 6,771,116
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 2s 131ms/step - loss: 2.7027 - acc: 0.0295
Epoch 2/28

16/16 [==============================] - 0s 28ms/step - loss: 1.1265 - acc: 0.8230
Epoch 3/28

16/16 [==============================] - 0s 28ms/step - loss: 0.6372 - acc: 0.8466
Epoch 4/28

16/16 [==============================] - 0s 27ms/step - loss: 0.5114 - acc: 0.8673
Epoch 5/28

16/16 [==============================] - 0s 27ms/step - loss: 0.4598 - acc: 0.8525
Epoch 6/28

16/16 [==============================] - 0s 28ms/step - loss: 0.4416 - acc: 0.8879
Epoch 7/28

16/16 [==============================] - 0s 28ms/step - loss: 0.3952 - acc: 0.8525
Epoch 8/28

16/16 [==============================] - 0s 28ms/step - loss: 0.3358 - acc: 0.9145
Epoch 9/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2894 - acc: 0.8938
Epoch 10/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2648 - acc: 0.9322
Epoch 11/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2533 - acc: 0.9233
Epoch 12/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2320 - acc: 0.9499
Epoch 13/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2215 - acc: 0.9469
Epoch 14/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2048 - acc: 0.9558
Epoch 15/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1994 - acc: 0.9469
Epoch 16/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1874 - acc: 0.9617
Epoch 17/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1776 - acc: 0.9705
Epoch 18/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1642 - acc: 0.9764
Epoch 19/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1621 - acc: 0.9646
Epoch 20/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1501 - acc: 0.9882
Epoch 21/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1566 - acc: 0.9587
Epoch 22/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1484 - acc: 0.9735
Epoch 23/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1364 - acc: 0.9705
Epoch 24/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1228 - acc: 0.9853
Epoch 25/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1177 - acc: 0.9823
Epoch 26/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1244 - acc: 0.9853
Epoch 27/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1049 - acc: 0.9794
Epoch 28/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1037 - acc: 0.9912
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7219
False 1638
True percentage 0.815061533251
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.95      0.94      7318
      B-LOC       0.25      0.10      0.14       218
      I-LOC       0.09      0.09      0.09       141
      B-PER       0.72      0.21      0.33       438
      B-ORG       0.27      0.47      0.35       296
      I-ORG       0.20      0.20      0.20       151
     B-MISC       0.03      0.01      0.01       141
     I-MISC       0.17      0.03      0.05       154

avg / total       0.83      0.82      0.81      8857

F-1 Score (without O):
0.230563002681
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104048 unique words.
4044 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 565
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659136     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,266
Trainable params: 6,771,266
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 2s 131ms/step - loss: 2.2766 - acc: 0.0867
Epoch 2/28

16/16 [==============================] - 0s 27ms/step - loss: 0.8822 - acc: 0.7802
Epoch 3/28

16/16 [==============================] - 0s 27ms/step - loss: 0.7148 - acc: 0.8204
Epoch 4/28

16/16 [==============================] - 0s 27ms/step - loss: 0.6494 - acc: 0.7864
Epoch 5/28

16/16 [==============================] - 0s 26ms/step - loss: 0.6167 - acc: 0.8607
Epoch 6/28

16/16 [==============================] - 0s 27ms/step - loss: 0.4820 - acc: 0.8359
Epoch 7/28

16/16 [==============================] - 0s 27ms/step - loss: 0.4361 - acc: 0.9102
Epoch 8/28

16/16 [==============================] - 0s 27ms/step - loss: 0.4116 - acc: 0.8885
Epoch 9/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3635 - acc: 0.9102
Epoch 10/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3564 - acc: 0.9195
Epoch 11/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3261 - acc: 0.9288
Epoch 12/28

16/16 [==============================] - 0s 26ms/step - loss: 0.3027 - acc: 0.9288
Epoch 13/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2930 - acc: 0.9381
Epoch 14/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2653 - acc: 0.9288
Epoch 15/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2500 - acc: 0.9536
Epoch 16/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2405 - acc: 0.9412
Epoch 17/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2221 - acc: 0.9505
Epoch 18/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2078 - acc: 0.9505
Epoch 19/28

16/16 [==============================] - 0s 25ms/step - loss: 0.1931 - acc: 0.9721
Epoch 20/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1772 - acc: 0.9752
Epoch 21/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1614 - acc: 0.9752
Epoch 22/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1541 - acc: 0.9783
Epoch 23/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1510 - acc: 0.9814
Epoch 24/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1558 - acc: 0.9752
Epoch 25/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1422 - acc: 0.9752
Epoch 26/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1316 - acc: 0.9876
Epoch 27/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1209 - acc: 0.9907
Epoch 28/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1151 - acc: 0.9938
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7278
False 1793
True percentage 0.802337118289
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.94      0.94      7318
      B-PER       0.52      0.47      0.50       438
      B-LOC       0.49      0.26      0.34       218
     B-MISC       0.10      0.06      0.08       141
     I-MISC       0.06      0.01      0.01       154
      B-ORG       0.34      0.36      0.35       296
      I-ORG       0.15      0.22      0.17       151
      I-LOC       0.29      0.01      0.03       141
      I-PER       0.50      0.02      0.04       214

avg / total       0.82      0.80      0.80      9071

F-1 Score (without O):
0.28678729942
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104056 unique words.
4052 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 559
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659648     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,778
Trainable params: 6,771,778
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 2s 129ms/step - loss: 2.3707 - acc: 0.1432
Epoch 2/28

16/16 [==============================] - 0s 28ms/step - loss: 1.0929 - acc: 0.7666
Epoch 3/28

16/16 [==============================] - 0s 29ms/step - loss: 0.8245 - acc: 0.7745
Epoch 4/28

16/16 [==============================] - 0s 28ms/step - loss: 0.8481 - acc: 0.7825
Epoch 5/28

16/16 [==============================] - 0s 29ms/step - loss: 0.8848 - acc: 0.7692
Epoch 6/28

16/16 [==============================] - 0s 28ms/step - loss: 0.6551 - acc: 0.8515
Epoch 7/28

16/16 [==============================] - 0s 28ms/step - loss: 0.5566 - acc: 0.8276
Epoch 8/28

16/16 [==============================] - 0s 28ms/step - loss: 0.5128 - acc: 0.8515
Epoch 9/28

16/16 [==============================] - 0s 29ms/step - loss: 0.4614 - acc: 0.8727
Epoch 10/28

16/16 [==============================] - 0s 28ms/step - loss: 0.4476 - acc: 0.8833
Epoch 11/28

16/16 [==============================] - 0s 28ms/step - loss: 0.3981 - acc: 0.8886
Epoch 12/28

16/16 [==============================] - 0s 28ms/step - loss: 0.3948 - acc: 0.8966
Epoch 13/28

16/16 [==============================] - 0s 28ms/step - loss: 0.3406 - acc: 0.9098
Epoch 14/28

16/16 [==============================] - 0s 29ms/step - loss: 0.3453 - acc: 0.9284
Epoch 15/28

16/16 [==============================] - 0s 29ms/step - loss: 0.3089 - acc: 0.9310
Epoch 16/28

16/16 [==============================] - 0s 29ms/step - loss: 0.3007 - acc: 0.9443
Epoch 17/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2646 - acc: 0.9549
Epoch 18/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2677 - acc: 0.9469
Epoch 19/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2515 - acc: 0.9523
Epoch 20/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2314 - acc: 0.9496
Epoch 21/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2137 - acc: 0.9549
Epoch 22/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2142 - acc: 0.9496
Epoch 23/28

16/16 [==============================] - 0s 30ms/step - loss: 0.2124 - acc: 0.9708
Epoch 24/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2020 - acc: 0.9761
Epoch 25/28

16/16 [==============================] - 0s 30ms/step - loss: 0.1775 - acc: 0.9735
Epoch 26/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1697 - acc: 0.9761
Epoch 27/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1792 - acc: 0.9655
Epoch 28/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1626 - acc: 0.9682
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7182
False 1889
True percentage 0.791753941131
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.93      0.93      7318
      B-ORG       0.27      0.34      0.30       296
      I-ORG       0.13      0.32      0.19       151
      B-PER       0.45      0.15      0.23       438
      I-PER       0.45      0.35      0.39       214
      B-LOC       0.52      0.33      0.41       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.18      0.06      0.09       154

avg / total       0.81      0.79      0.80      9071

F-1 Score (without O):
0.247994652406
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104049 unique words.
4045 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 564
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659200     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,330
Trainable params: 6,771,330
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 2s 129ms/step - loss: 2.3316 - acc: 0.1118
Epoch 2/28

16/16 [==============================] - 0s 27ms/step - loss: 0.8731 - acc: 0.8257
Epoch 3/28

16/16 [==============================] - 0s 28ms/step - loss: 0.6022 - acc: 0.8257
Epoch 4/28

16/16 [==============================] - 0s 27ms/step - loss: 0.5328 - acc: 0.8684
Epoch 5/28

16/16 [==============================] - 0s 28ms/step - loss: 0.5776 - acc: 0.8257
Epoch 6/28

16/16 [==============================] - 0s 27ms/step - loss: 0.4873 - acc: 0.8980
Epoch 7/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3909 - acc: 0.8651
Epoch 8/28

16/16 [==============================] - 0s 28ms/step - loss: 0.3334 - acc: 0.9145
Epoch 9/28

16/16 [==============================] - 0s 28ms/step - loss: 0.3135 - acc: 0.9079
Epoch 10/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2889 - acc: 0.9375
Epoch 11/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2610 - acc: 0.9309
Epoch 12/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2448 - acc: 0.9507
Epoch 13/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2340 - acc: 0.9572
Epoch 14/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2121 - acc: 0.9539
Epoch 15/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2019 - acc: 0.9671
Epoch 16/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1910 - acc: 0.9572
Epoch 17/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1779 - acc: 0.9770
Epoch 18/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1639 - acc: 0.9770
Epoch 19/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1633 - acc: 0.9836
Epoch 20/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1421 - acc: 0.9737
Epoch 21/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1345 - acc: 0.9934
Epoch 22/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1262 - acc: 0.9934
Epoch 23/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1104 - acc: 0.9901
Epoch 24/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1107 - acc: 0.9868
Epoch 25/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1023 - acc: 0.9934
Epoch 26/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1076 - acc: 0.9901
Epoch 27/28

16/16 [==============================] - 0s 28ms/step - loss: 0.0996 - acc: 0.9901
Epoch 28/28

16/16 [==============================] - 0s 28ms/step - loss: 0.0997 - acc: 0.9934
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7183
False 1888
True percentage 0.79186418256
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.21      0.34      0.26       296
          O       0.96      0.92      0.94      7318
     B-MISC       0.23      0.07      0.11       141
     I-MISC       0.16      0.37      0.23       154
      B-LOC       0.49      0.22      0.30       218
      I-LOC       0.46      0.43      0.45       141
      B-PER       0.39      0.17      0.23       438
      I-PER       0.42      0.32      0.36       214
      I-ORG       0.00      0.00      0.00       151

avg / total       0.84      0.79      0.81      9071

F-1 Score (without O):
0.843679256523
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 8 unique labels.
Found 104049 unique words.
4045 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 564
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659200     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,180
Trainable params: 6,771,180
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 2s 131ms/step - loss: 2.5908 - acc: 0.0751
Epoch 2/28

16/16 [==============================] - 0s 28ms/step - loss: 0.8536 - acc: 0.8123
Epoch 3/28

16/16 [==============================] - 0s 28ms/step - loss: 0.5198 - acc: 0.8362
Epoch 4/28

16/16 [==============================] - 0s 27ms/step - loss: 0.4378 - acc: 0.8874
Epoch 5/28

16/16 [==============================] - 0s 28ms/step - loss: 0.3617 - acc: 0.8669
Epoch 6/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3420 - acc: 0.9386
Epoch 7/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2856 - acc: 0.9044
Epoch 8/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2557 - acc: 0.9590
Epoch 9/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2302 - acc: 0.9386
Epoch 10/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2103 - acc: 0.9625
Epoch 11/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1987 - acc: 0.9420
Epoch 12/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1829 - acc: 0.9590
Epoch 13/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1637 - acc: 0.9625
Epoch 14/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1531 - acc: 0.9556
Epoch 15/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1431 - acc: 0.9659
Epoch 16/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1396 - acc: 0.9625
Epoch 17/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1177 - acc: 0.9795
Epoch 18/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1096 - acc: 0.9727
Epoch 19/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1117 - acc: 0.9727
Epoch 20/28

16/16 [==============================] - 0s 28ms/step - loss: 0.0948 - acc: 0.9863
Epoch 21/28

16/16 [==============================] - 0s 27ms/step - loss: 0.0885 - acc: 0.9829
Epoch 22/28

16/16 [==============================] - 0s 27ms/step - loss: 0.0898 - acc: 0.9863
Epoch 23/28

16/16 [==============================] - 0s 28ms/step - loss: 0.0823 - acc: 0.9829
Epoch 24/28

16/16 [==============================] - 0s 28ms/step - loss: 0.0822 - acc: 0.9863
Epoch 25/28

16/16 [==============================] - 0s 28ms/step - loss: 0.0814 - acc: 0.9932
Epoch 26/28

16/16 [==============================] - 0s 28ms/step - loss: 0.0674 - acc: 0.9932
Epoch 27/28

16/16 [==============================] - 0s 28ms/step - loss: 0.0659 - acc: 0.9898
Epoch 28/28

16/16 [==============================] - 0s 27ms/step - loss: 0.0654 - acc: 0.9932
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7250
False 1680
True percentage 0.811870100784
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.92      0.94      0.93      7318
      B-PER       0.47      0.30      0.37       438
      B-ORG       0.27      0.37      0.31       296
     B-MISC       0.00      0.00      0.00       141
      I-PER       0.35      0.33      0.34       214
      I-ORG       0.14      0.07      0.10       151
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.85      0.05      0.10       218

avg / total       0.82      0.81      0.80      8930

F-1 Score (without O):
0.257767548907
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 8 unique labels.
Found 104041 unique words.
4037 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658688     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,668
Trainable params: 6,770,668
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 2s 249ms/step - loss: 2.2175 - acc: 0.0662
Epoch 2/28

8/8 [==============================] - 0s 33ms/step - loss: 0.8046 - acc: 0.8013
Epoch 3/28

8/8 [==============================] - 0s 33ms/step - loss: 0.5780 - acc: 0.8411
Epoch 4/28

8/8 [==============================] - 0s 33ms/step - loss: 0.4846 - acc: 0.8079
Epoch 5/28

8/8 [==============================] - 0s 32ms/step - loss: 0.4773 - acc: 0.9139
Epoch 6/28

8/8 [==============================] - 0s 32ms/step - loss: 0.4373 - acc: 0.8278
Epoch 7/28

8/8 [==============================] - 0s 33ms/step - loss: 0.3730 - acc: 0.9470
Epoch 8/28

8/8 [==============================] - 0s 32ms/step - loss: 0.2441 - acc: 0.9536
Epoch 9/28

8/8 [==============================] - 0s 32ms/step - loss: 0.2487 - acc: 0.9669
Epoch 10/28

8/8 [==============================] - 0s 32ms/step - loss: 0.2233 - acc: 0.9603
Epoch 11/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1911 - acc: 0.9669
Epoch 12/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1861 - acc: 0.9669
Epoch 13/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1516 - acc: 0.9735
Epoch 14/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1450 - acc: 0.9868
Epoch 15/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1283 - acc: 0.9934
Epoch 16/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1166 - acc: 0.9934
Epoch 17/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1144 - acc: 0.9934
Epoch 18/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1207 - acc: 0.9868
Epoch 19/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1033 - acc: 0.9934
Epoch 20/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0886 - acc: 0.9934
Epoch 21/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0843 - acc: 0.9934
Epoch 22/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0743 - acc: 0.9934
Epoch 23/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0704 - acc: 0.9934
Epoch 24/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0655 - acc: 1.0000
Epoch 25/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0639 - acc: 1.0000
Epoch 26/28

8/8 [==============================] - 0s 32ms/step - loss: 0.0698 - acc: 0.9868
Epoch 27/28

8/8 [==============================] - 0s 32ms/step - loss: 0.0613 - acc: 1.0000
Epoch 28/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0514 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7094
False 1763
True percentage 0.800948402394
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.91      0.94      7318
      B-LOC       0.80      0.11      0.19       218
      I-LOC       0.23      0.43      0.30       141
      B-PER       0.56      0.25      0.35       438
      B-ORG       0.22      0.56      0.31       296
      I-ORG       0.15      0.15      0.15       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.17      0.15      0.16       154

avg / total       0.86      0.80      0.82      8857

F-1 Score (without O):
0.263956114876
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104043 unique words.
4039 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 565
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658816     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,946
Trainable params: 6,770,946
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 2s 234ms/step - loss: 2.5429 - acc: 0.0414
Epoch 2/28

8/8 [==============================] - 0s 34ms/step - loss: 0.9584 - acc: 0.7870
Epoch 3/28

8/8 [==============================] - 0s 33ms/step - loss: 0.6153 - acc: 0.7929
Epoch 4/28

8/8 [==============================] - 0s 34ms/step - loss: 0.6194 - acc: 0.8225
Epoch 5/28

8/8 [==============================] - 0s 34ms/step - loss: 0.5070 - acc: 0.7988
Epoch 6/28

8/8 [==============================] - 0s 33ms/step - loss: 0.4611 - acc: 0.9231
Epoch 7/28

8/8 [==============================] - 0s 33ms/step - loss: 0.3709 - acc: 0.8521
Epoch 8/28

8/8 [==============================] - 0s 33ms/step - loss: 0.3242 - acc: 0.9467
Epoch 9/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2960 - acc: 0.9467
Epoch 10/28

8/8 [==============================] - 0s 32ms/step - loss: 0.2734 - acc: 0.9349
Epoch 11/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2390 - acc: 0.9645
Epoch 12/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2220 - acc: 0.9704
Epoch 13/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2080 - acc: 0.9882
Epoch 14/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1867 - acc: 0.9822
Epoch 15/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1488 - acc: 0.9941
Epoch 16/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1552 - acc: 0.9882
Epoch 17/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1356 - acc: 0.9941
Epoch 18/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1294 - acc: 0.9941
Epoch 19/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1300 - acc: 0.9882
Epoch 20/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1304 - acc: 1.0000
Epoch 21/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1011 - acc: 1.0000
Epoch 22/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0978 - acc: 1.0000
Epoch 23/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0909 - acc: 0.9941
Epoch 24/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0843 - acc: 1.0000
Epoch 25/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0893 - acc: 1.0000
Epoch 26/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0828 - acc: 1.0000
Epoch 27/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0705 - acc: 1.0000
Epoch 28/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0712 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7289
False 1782
True percentage 0.803549774005
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.92      0.94      0.93      7318
      B-PER       0.47      0.36      0.41       438
      B-LOC       0.52      0.37      0.43       218
     B-MISC       1.00      0.01      0.01       141
     I-MISC       0.00      0.00      0.00       154
      B-ORG       0.41      0.34      0.38       296
      I-ORG       0.10      0.15      0.12       151
      I-LOC       0.72      0.09      0.16       141
      I-PER       0.59      0.06      0.11       214

avg / total       0.83      0.80      0.80      9071

F-1 Score (without O):
0.281781963057
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104046 unique words.
4042 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 559
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659008     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,138
Trainable params: 6,771,138
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 2s 234ms/step - loss: 3.0266 - acc: 0.0110
Epoch 2/28

8/8 [==============================] - 0s 32ms/step - loss: 1.5172 - acc: 0.6298
Epoch 3/28

8/8 [==============================] - 0s 33ms/step - loss: 1.0880 - acc: 0.6519
Epoch 4/28

8/8 [==============================] - 0s 32ms/step - loss: 0.9654 - acc: 0.7459
Epoch 5/28

8/8 [==============================] - 0s 35ms/step - loss: 0.9071 - acc: 0.6575
Epoch 6/28

8/8 [==============================] - 0s 33ms/step - loss: 0.8039 - acc: 0.8453
Epoch 7/28

8/8 [==============================] - 0s 33ms/step - loss: 0.6666 - acc: 0.7735
Epoch 8/28

8/8 [==============================] - 0s 33ms/step - loss: 0.6085 - acc: 0.8674
Epoch 9/28

8/8 [==============================] - 0s 33ms/step - loss: 0.5481 - acc: 0.9061
Epoch 10/28

8/8 [==============================] - 0s 33ms/step - loss: 0.4786 - acc: 0.9006
Epoch 11/28

8/8 [==============================] - 0s 32ms/step - loss: 0.4765 - acc: 0.9061
Epoch 12/28

8/8 [==============================] - 0s 32ms/step - loss: 0.4152 - acc: 0.9171
Epoch 13/28

8/8 [==============================] - 0s 32ms/step - loss: 0.3786 - acc: 0.9227
Epoch 14/28

8/8 [==============================] - 0s 33ms/step - loss: 0.3632 - acc: 0.9392
Epoch 15/28

8/8 [==============================] - 0s 32ms/step - loss: 0.3464 - acc: 0.9227
Epoch 16/28

8/8 [==============================] - 0s 32ms/step - loss: 0.3339 - acc: 0.9503
Epoch 17/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2882 - acc: 0.9392
Epoch 18/28

8/8 [==============================] - 0s 32ms/step - loss: 0.2752 - acc: 0.9669
Epoch 19/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2403 - acc: 0.9613
Epoch 20/28

8/8 [==============================] - 0s 32ms/step - loss: 0.2483 - acc: 0.9448
Epoch 21/28

8/8 [==============================] - 0s 31ms/step - loss: 0.2201 - acc: 0.9613
Epoch 22/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1864 - acc: 0.9779
Epoch 23/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1816 - acc: 0.9669
Epoch 24/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1789 - acc: 0.9890
Epoch 25/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1480 - acc: 0.9834
Epoch 26/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1492 - acc: 0.9890
Epoch 27/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1440 - acc: 0.9890
Epoch 28/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1332 - acc: 0.9779
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7082
False 1989
True percentage 0.780729798258
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.91      0.94      7318
      B-ORG       0.28      0.35      0.31       296
      I-ORG       0.14      0.58      0.23       151
      B-PER       0.40      0.33      0.36       438
      I-PER       0.33      0.19      0.24       214
      B-LOC       1.00      0.00      0.01       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.45      0.04      0.07       141
     I-MISC       0.23      0.08      0.12       154

avg / total       0.85      0.78      0.79      9071

F-1 Score (without O):
0.24063356686
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 8 unique labels.
Found 104043 unique words.
4039 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 564
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658816     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,796
Trainable params: 6,770,796
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 2s 247ms/step - loss: 2.4122 - acc: 0.1519
Epoch 2/28

8/8 [==============================] - 0s 33ms/step - loss: 0.7542 - acc: 0.8418
Epoch 3/28

8/8 [==============================] - 0s 33ms/step - loss: 0.5768 - acc: 0.8291
Epoch 4/28

8/8 [==============================] - 0s 33ms/step - loss: 0.4869 - acc: 0.8797
Epoch 5/28

8/8 [==============================] - 0s 32ms/step - loss: 0.3953 - acc: 0.8734
Epoch 6/28

8/8 [==============================] - 0s 33ms/step - loss: 0.3544 - acc: 0.9051
Epoch 7/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2910 - acc: 0.9304
Epoch 8/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2423 - acc: 0.9557
Epoch 9/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2211 - acc: 0.9684
Epoch 10/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1974 - acc: 0.9747
Epoch 11/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1764 - acc: 0.9620
Epoch 12/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1574 - acc: 0.9810
Epoch 13/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1386 - acc: 0.9873
Epoch 14/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1352 - acc: 0.9937
Epoch 15/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1109 - acc: 1.0000
Epoch 16/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0958 - acc: 0.9937
Epoch 17/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0957 - acc: 0.9937
Epoch 18/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0863 - acc: 1.0000
Epoch 19/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0841 - acc: 0.9937
Epoch 20/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0746 - acc: 1.0000
Epoch 21/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0655 - acc: 1.0000
Epoch 22/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0562 - acc: 1.0000
Epoch 23/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0627 - acc: 1.0000
Epoch 24/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0606 - acc: 1.0000
Epoch 25/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0542 - acc: 1.0000
Epoch 26/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0520 - acc: 1.0000
Epoch 27/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0386 - acc: 1.0000
Epoch 28/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0401 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7128
False 1792
True percentage 0.799103139013
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.16      0.37      0.22       296
          O       0.95      0.93      0.94      7318
     B-MISC       0.12      0.02      0.04       141
     I-MISC       0.20      0.15      0.17       154
      B-LOC       0.45      0.34      0.39       218
      I-LOC       0.35      0.06      0.10       141
      B-PER       0.28      0.11      0.16       438
      I-PER       0.28      0.15      0.20       214

avg / total       0.83      0.80      0.81      8920

F-1 Score (without O):
0.854290931223
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 8 unique labels.
Found 104041 unique words.
4037 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 567
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658688     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,668
Trainable params: 6,770,668
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 2s 235ms/step - loss: 2.4702 - acc: 0.0604
Epoch 2/28

8/8 [==============================] - 0s 34ms/step - loss: 0.8988 - acc: 0.8255
Epoch 3/28

8/8 [==============================] - 0s 35ms/step - loss: 0.5387 - acc: 0.8591
Epoch 4/28

8/8 [==============================] - 0s 33ms/step - loss: 0.4800 - acc: 0.9195
Epoch 5/28

8/8 [==============================] - 0s 34ms/step - loss: 0.4325 - acc: 0.8658
Epoch 6/28

8/8 [==============================] - 0s 33ms/step - loss: 0.3616 - acc: 0.9195
Epoch 7/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2985 - acc: 0.8859
Epoch 8/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2424 - acc: 0.9329
Epoch 9/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2244 - acc: 0.9396
Epoch 10/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2051 - acc: 0.9463
Epoch 11/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1994 - acc: 0.9597
Epoch 12/28

8/8 [==============================] - 0s 35ms/step - loss: 0.1676 - acc: 0.9597
Epoch 13/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1577 - acc: 0.9664
Epoch 14/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1408 - acc: 0.9732
Epoch 15/28

8/8 [==============================] - 0s 35ms/step - loss: 0.1307 - acc: 0.9732
Epoch 16/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1163 - acc: 0.9732
Epoch 17/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1231 - acc: 0.9597
Epoch 18/28

8/8 [==============================] - 0s 35ms/step - loss: 0.1227 - acc: 0.9799
Epoch 19/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0861 - acc: 1.0000
Epoch 20/28

8/8 [==============================] - 0s 35ms/step - loss: 0.0830 - acc: 1.0000
Epoch 21/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0910 - acc: 0.9799
Epoch 22/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0747 - acc: 1.0000
Epoch 23/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0814 - acc: 1.0000
Epoch 24/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0721 - acc: 0.9933
Epoch 25/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0536 - acc: 1.0000
Epoch 26/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0610 - acc: 1.0000
Epoch 27/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0519 - acc: 1.0000
Epoch 28/28

8/8 [==============================] - 0s 35ms/step - loss: 0.0533 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7096
False 1834
True percentage 0.794624860022
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.91      0.94      0.92      7318
      B-PER       0.52      0.21      0.30       438
      B-ORG       0.16      0.32      0.21       296
     B-MISC       0.03      0.01      0.01       141
      I-PER       0.29      0.21      0.24       214
      I-ORG       0.00      0.00      0.00       151
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.46      0.06      0.10       218

avg / total       0.80      0.79      0.79      8930

F-1 Score (without O):
0.189127105666
