Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.4594 - acc: 0.8667
Epoch 2/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.2221 - acc: 0.9350
Epoch 3/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1700 - acc: 0.9501
Epoch 4/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1422 - acc: 0.9582
Epoch 5/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1185 - acc: 0.9659
Epoch 6/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1041 - acc: 0.9696
Epoch 7/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0930 - acc: 0.9731
Epoch 8/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0826 - acc: 0.9764
Epoch 9/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0745 - acc: 0.9793
Epoch 10/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0661 - acc: 0.9811
Epoch 11/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0629 - acc: 0.9817
Epoch 12/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0578 - acc: 0.9838
Epoch 13/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0527 - acc: 0.9849
Epoch 14/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0496 - acc: 0.9859
Epoch 15/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0445 - acc: 0.9868
Epoch 16/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0442 - acc: 0.9875
Epoch 17/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0414 - acc: 0.9883
Epoch 18/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0386 - acc: 0.9888
Epoch 19/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0362 - acc: 0.9896
Epoch 20/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0346 - acc: 0.9900
Epoch 21/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0348 - acc: 0.9899
Epoch 22/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0318 - acc: 0.9914
Epoch 23/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0301 - acc: 0.9912
Epoch 24/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0299 - acc: 0.9912
Epoch 25/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0291 - acc: 0.9916
Epoch 26/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0283 - acc: 0.9915
Epoch 27/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0265 - acc: 0.9920
Epoch 28/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0254 - acc: 0.9930
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8270
False 801
True percentage 0.911696615588
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-LOC       0.75      0.76      0.76       218
      I-LOC       0.77      0.81      0.79       141
      B-PER       0.91      0.84      0.88       438
      B-ORG       0.79      0.74      0.77       296
      I-ORG       0.67      0.68      0.68       151
     B-MISC       0.40      0.30      0.34       141
     I-MISC       0.55      0.45      0.49       154
      I-PER       0.92      0.66      0.77       214

avg / total       0.94      0.91      0.93      9071

F-1 Score (without O):
0.732874663476
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 49s 29ms/step - loss: 0.4656 - acc: 0.8652
Epoch 2/28

1674/1674 [==============================] - 48s 28ms/step - loss: 0.2278 - acc: 0.9307
Epoch 3/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.1736 - acc: 0.9478
Epoch 4/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.1449 - acc: 0.9580
Epoch 5/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.1235 - acc: 0.9646
Epoch 6/28

1674/1674 [==============================] - 48s 28ms/step - loss: 0.1097 - acc: 0.9684
Epoch 7/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0973 - acc: 0.9731
Epoch 8/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0864 - acc: 0.9758
Epoch 9/28

1674/1674 [==============================] - 48s 28ms/step - loss: 0.0766 - acc: 0.9788
Epoch 10/28

1674/1674 [==============================] - 48s 28ms/step - loss: 0.0709 - acc: 0.9806
Epoch 11/28

1674/1674 [==============================] - 48s 28ms/step - loss: 0.0675 - acc: 0.9816
Epoch 12/28

1674/1674 [==============================] - 48s 28ms/step - loss: 0.0612 - acc: 0.9824
Epoch 13/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0572 - acc: 0.9836
Epoch 14/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0529 - acc: 0.9855
Epoch 15/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0488 - acc: 0.9863
Epoch 16/28

1674/1674 [==============================] - 48s 28ms/step - loss: 0.0480 - acc: 0.9859
Epoch 17/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0429 - acc: 0.9879
Epoch 18/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0413 - acc: 0.9883
Epoch 19/28

1674/1674 [==============================] - 48s 28ms/step - loss: 0.0398 - acc: 0.9887
Epoch 20/28

1674/1674 [==============================] - 48s 28ms/step - loss: 0.0368 - acc: 0.9898
Epoch 21/28

1674/1674 [==============================] - 48s 28ms/step - loss: 0.0356 - acc: 0.9897
Epoch 22/28

1674/1674 [==============================] - 48s 28ms/step - loss: 0.0339 - acc: 0.9906
Epoch 23/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0316 - acc: 0.9910
Epoch 24/28

1674/1674 [==============================] - 48s 28ms/step - loss: 0.0305 - acc: 0.9916
Epoch 25/28

1674/1674 [==============================] - 48s 28ms/step - loss: 0.0288 - acc: 0.9917
Epoch 26/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0271 - acc: 0.9921
Epoch 27/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0277 - acc: 0.9915
Epoch 28/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0261 - acc: 0.9926
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8247
False 824
True percentage 0.909161062727
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.92      0.83      0.87       438
      I-PER       0.91      0.64      0.76       214
          O       0.98      0.96      0.97      7318
      B-ORG       0.77      0.73      0.75       296
      I-ORG       0.66      0.64      0.65       151
      B-LOC       0.72      0.75      0.74       218
      I-LOC       0.74      0.81      0.77       141
     B-MISC       0.40      0.30      0.35       141
     I-MISC       0.54      0.44      0.48       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.928348542832
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.4622 - acc: 0.8682
Epoch 2/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.2175 - acc: 0.9343
Epoch 3/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.1690 - acc: 0.9495
Epoch 4/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.1403 - acc: 0.9593
Epoch 5/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.1196 - acc: 0.9653
Epoch 6/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.1057 - acc: 0.9702
Epoch 7/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0924 - acc: 0.9733
Epoch 8/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0850 - acc: 0.9754
Epoch 9/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0757 - acc: 0.9779
Epoch 10/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0696 - acc: 0.9803
Epoch 11/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0648 - acc: 0.9812
Epoch 12/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0590 - acc: 0.9835
Epoch 13/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0543 - acc: 0.9842
Epoch 14/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0525 - acc: 0.9849
Epoch 15/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0477 - acc: 0.9862
Epoch 16/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0438 - acc: 0.9872
Epoch 17/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0439 - acc: 0.9876
Epoch 18/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0399 - acc: 0.9885
Epoch 19/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0369 - acc: 0.9889
Epoch 20/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0356 - acc: 0.9893
Epoch 21/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0340 - acc: 0.9904
Epoch 22/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0312 - acc: 0.9911
Epoch 23/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0302 - acc: 0.9908
Epoch 24/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0295 - acc: 0.9912
Epoch 25/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0286 - acc: 0.9920
Epoch 26/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0260 - acc: 0.9925
Epoch 27/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0262 - acc: 0.9929
Epoch 28/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0246 - acc: 0.9928
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8233
False 838
True percentage 0.907617682725
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.90      0.84      0.87       438
      B-LOC       0.76      0.73      0.74       218
     B-MISC       0.35      0.28      0.31       141
     I-MISC       0.52      0.45      0.48       154
      B-ORG       0.78      0.72      0.75       296
      I-ORG       0.69      0.61      0.65       151
      I-LOC       0.75      0.79      0.77       141
      I-PER       0.91      0.65      0.76       214

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.717809867629
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 49s 29ms/step - loss: 0.4837 - acc: 0.8618
Epoch 2/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.2271 - acc: 0.9339
Epoch 3/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.1692 - acc: 0.9499
Epoch 4/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.1438 - acc: 0.9568
Epoch 5/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.1230 - acc: 0.9648
Epoch 6/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.1047 - acc: 0.9704
Epoch 7/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0939 - acc: 0.9740
Epoch 8/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0839 - acc: 0.9768
Epoch 9/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0750 - acc: 0.9801
Epoch 10/28

1674/1674 [==============================] - 48s 28ms/step - loss: 0.0699 - acc: 0.9803
Epoch 11/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0639 - acc: 0.9824
Epoch 12/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0586 - acc: 0.9841
Epoch 13/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0564 - acc: 0.9840
Epoch 14/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0522 - acc: 0.9844
Epoch 15/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0483 - acc: 0.9866
Epoch 16/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0460 - acc: 0.9870
Epoch 17/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0421 - acc: 0.9884
Epoch 18/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0396 - acc: 0.9890
Epoch 19/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0380 - acc: 0.9886
Epoch 20/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0355 - acc: 0.9901
Epoch 21/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0333 - acc: 0.9909
Epoch 22/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0324 - acc: 0.9908
Epoch 23/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0317 - acc: 0.9908
Epoch 24/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0302 - acc: 0.9914
Epoch 25/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0291 - acc: 0.9920
Epoch 26/28

1674/1674 [==============================] - 48s 28ms/step - loss: 0.0272 - acc: 0.9918
Epoch 27/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0258 - acc: 0.9928
Epoch 28/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0258 - acc: 0.9926
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8254
False 817
True percentage 0.909932752728
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.79      0.73      0.76       296
      I-ORG       0.69      0.61      0.65       151
      B-PER       0.91      0.82      0.86       438
      I-PER       0.92      0.65      0.76       214
      B-LOC       0.77      0.76      0.77       218
      I-LOC       0.74      0.81      0.77       141
     B-MISC       0.40      0.32      0.36       141
     I-MISC       0.52      0.48      0.50       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.724541904476
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.4663 - acc: 0.8663
Epoch 2/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.2278 - acc: 0.9324
Epoch 3/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.1734 - acc: 0.9492
Epoch 4/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.1440 - acc: 0.9578
Epoch 5/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.1218 - acc: 0.9647
Epoch 6/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.1081 - acc: 0.9685
Epoch 7/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0949 - acc: 0.9730
Epoch 8/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0851 - acc: 0.9761
Epoch 9/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0778 - acc: 0.9787
Epoch 10/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0698 - acc: 0.9806
Epoch 11/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0655 - acc: 0.9811
Epoch 12/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0596 - acc: 0.9828
Epoch 13/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0577 - acc: 0.9833
Epoch 14/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0520 - acc: 0.9858
Epoch 15/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0474 - acc: 0.9868
Epoch 16/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0446 - acc: 0.9878
Epoch 17/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0435 - acc: 0.9874
Epoch 18/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0391 - acc: 0.9891
Epoch 19/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0367 - acc: 0.9890
Epoch 20/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0363 - acc: 0.9898
Epoch 21/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0345 - acc: 0.9898
Epoch 22/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0323 - acc: 0.9908
Epoch 23/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0319 - acc: 0.9911
Epoch 24/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0301 - acc: 0.9913
Epoch 25/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0286 - acc: 0.9916
Epoch 26/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0277 - acc: 0.9925
Epoch 27/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0269 - acc: 0.9923
Epoch 28/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0248 - acc: 0.9928
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8246
False 825
True percentage 0.909050821299
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.79      0.75      0.77       296
      I-ORG       0.65      0.68      0.66       151
      B-PER       0.90      0.82      0.86       438
      I-PER       0.93      0.63      0.75       214
     B-MISC       0.38      0.32      0.34       141
     I-MISC       0.51      0.41      0.45       154
      B-LOC       0.78      0.76      0.77       218
      I-LOC       0.77      0.79      0.78       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.721174004193
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 49s 30ms/step - loss: 0.4538 - acc: 0.8701
Epoch 2/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.2173 - acc: 0.9347
Epoch 3/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.1707 - acc: 0.9488
Epoch 4/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.1375 - acc: 0.9610
Epoch 5/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.1157 - acc: 0.9666
Epoch 6/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.1020 - acc: 0.9710
Epoch 7/28

1674/1674 [==============================] - 48s 28ms/step - loss: 0.0905 - acc: 0.9743
Epoch 8/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0783 - acc: 0.9791
Epoch 9/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0734 - acc: 0.9781
Epoch 10/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0677 - acc: 0.9806
Epoch 11/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0598 - acc: 0.9838
Epoch 12/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0574 - acc: 0.9837
Epoch 13/28

1674/1674 [==============================] - 48s 28ms/step - loss: 0.0512 - acc: 0.9859
Epoch 14/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0487 - acc: 0.9864
Epoch 15/28

1674/1674 [==============================] - 48s 28ms/step - loss: 0.0444 - acc: 0.9874
Epoch 16/28

1674/1674 [==============================] - 48s 28ms/step - loss: 0.0419 - acc: 0.9883
Epoch 17/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0411 - acc: 0.9880
Epoch 18/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0383 - acc: 0.9892
Epoch 19/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0360 - acc: 0.9897
Epoch 20/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0344 - acc: 0.9903
Epoch 21/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0320 - acc: 0.9912
Epoch 22/28

1674/1674 [==============================] - 48s 28ms/step - loss: 0.0314 - acc: 0.9910
Epoch 23/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0305 - acc: 0.9910
Epoch 24/28

1674/1674 [==============================] - 48s 28ms/step - loss: 0.0274 - acc: 0.9922
Epoch 25/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0270 - acc: 0.9925
Epoch 26/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0262 - acc: 0.9929
Epoch 27/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0256 - acc: 0.9927
Epoch 28/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0235 - acc: 0.9927
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8261
False 810
True percentage 0.91070444273
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.90      0.83      0.86       438
          O       0.99      0.96      0.97      7318
      B-LOC       0.74      0.74      0.74       218
      B-ORG       0.76      0.77      0.77       296
      I-PER       0.88      0.65      0.75       214
     B-MISC       0.43      0.30      0.36       141
     I-MISC       0.56      0.44      0.49       154
      I-ORG       0.66      0.69      0.67       151
      I-LOC       0.76      0.85      0.81       141

avg / total       0.94      0.91      0.93      9071

F-1 Score (without O):
0.930427098675
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.4492 - acc: 0.8695
Epoch 2/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.2204 - acc: 0.9349
Epoch 3/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1697 - acc: 0.9505
Epoch 4/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1392 - acc: 0.9597
Epoch 5/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1201 - acc: 0.9652
Epoch 6/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1044 - acc: 0.9710
Epoch 7/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0921 - acc: 0.9730
Epoch 8/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0836 - acc: 0.9767
Epoch 9/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0752 - acc: 0.9790
Epoch 10/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0681 - acc: 0.9810
Epoch 11/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0640 - acc: 0.9824
Epoch 12/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0586 - acc: 0.9838
Epoch 13/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0547 - acc: 0.9845
Epoch 14/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0508 - acc: 0.9859
Epoch 15/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0480 - acc: 0.9869
Epoch 16/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0458 - acc: 0.9866
Epoch 17/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0427 - acc: 0.9878
Epoch 18/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0407 - acc: 0.9888
Epoch 19/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0371 - acc: 0.9898
Epoch 20/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0355 - acc: 0.9898
Epoch 21/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0333 - acc: 0.9907
Epoch 22/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0327 - acc: 0.9902
Epoch 23/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0298 - acc: 0.9915
Epoch 24/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0296 - acc: 0.9918
Epoch 25/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0292 - acc: 0.9913
Epoch 26/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0273 - acc: 0.9916
Epoch 27/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0265 - acc: 0.9921
Epoch 28/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0253 - acc: 0.9925
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8243
False 828
True percentage 0.908720097012
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
     B-MISC       0.40      0.28      0.33       141
      B-ORG       0.77      0.76      0.77       296
     I-MISC       0.51      0.45      0.48       154
      B-LOC       0.74      0.73      0.74       218
      I-ORG       0.66      0.64      0.65       151
      B-PER       0.91      0.84      0.87       438
      I-PER       0.92      0.64      0.75       214
      I-LOC       0.76      0.79      0.77       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.721606233144
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.4587 - acc: 0.8681
Epoch 2/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.2251 - acc: 0.9337
Epoch 3/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.1693 - acc: 0.9501
Epoch 4/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.1397 - acc: 0.9590
Epoch 5/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.1206 - acc: 0.9658
Epoch 6/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.1052 - acc: 0.9699
Epoch 7/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0932 - acc: 0.9731
Epoch 8/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0843 - acc: 0.9764
Epoch 9/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0746 - acc: 0.9788
Epoch 10/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0698 - acc: 0.9799
Epoch 11/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0633 - acc: 0.9823
Epoch 12/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0589 - acc: 0.9838
Epoch 13/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0540 - acc: 0.9853
Epoch 14/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0494 - acc: 0.9859
Epoch 15/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0475 - acc: 0.9862
Epoch 16/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0443 - acc: 0.9875
Epoch 17/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0409 - acc: 0.9884
Epoch 18/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0398 - acc: 0.9886
Epoch 19/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0373 - acc: 0.9895
Epoch 20/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0352 - acc: 0.9901
Epoch 21/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0332 - acc: 0.9904
Epoch 22/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0315 - acc: 0.9911
Epoch 23/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0322 - acc: 0.9907
Epoch 24/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0286 - acc: 0.9920
Epoch 25/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0291 - acc: 0.9913
Epoch 26/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0275 - acc: 0.9922
Epoch 27/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0257 - acc: 0.9929
Epoch 28/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0259 - acc: 0.9922
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8249
False 822
True percentage 0.909381545585
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.77      0.75      0.76       296
          O       0.98      0.96      0.97      7318
     B-MISC       0.43      0.31      0.36       141
     I-MISC       0.58      0.42      0.48       154
      B-LOC       0.76      0.73      0.75       218
      I-LOC       0.74      0.77      0.76       141
      B-PER       0.91      0.84      0.87       438
      I-PER       0.93      0.64      0.76       214
      I-ORG       0.63      0.65      0.64       151

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.931476646359
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 49s 30ms/step - loss: 0.4529 - acc: 0.8677
Epoch 2/28

1674/1674 [==============================] - 48s 28ms/step - loss: 0.2203 - acc: 0.9345
Epoch 3/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.1674 - acc: 0.9502
Epoch 4/28

1674/1674 [==============================] - 48s 28ms/step - loss: 0.1408 - acc: 0.9575
Epoch 5/28

1674/1674 [==============================] - 48s 28ms/step - loss: 0.1214 - acc: 0.9651
Epoch 6/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.1050 - acc: 0.9693
Epoch 7/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0933 - acc: 0.9735
Epoch 8/28

1674/1674 [==============================] - 48s 28ms/step - loss: 0.0845 - acc: 0.9752
Epoch 9/28

1674/1674 [==============================] - 48s 28ms/step - loss: 0.0764 - acc: 0.9779
Epoch 10/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0690 - acc: 0.9803
Epoch 11/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0643 - acc: 0.9820
Epoch 12/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0587 - acc: 0.9833
Epoch 13/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0541 - acc: 0.9849
Epoch 14/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0512 - acc: 0.9854
Epoch 15/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0470 - acc: 0.9864
Epoch 16/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0443 - acc: 0.9878
Epoch 17/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0413 - acc: 0.9880
Epoch 18/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0378 - acc: 0.9896
Epoch 19/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0373 - acc: 0.9895
Epoch 20/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0354 - acc: 0.9902
Epoch 21/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0338 - acc: 0.9906
Epoch 22/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0323 - acc: 0.9904
Epoch 23/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0305 - acc: 0.9916
Epoch 24/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0284 - acc: 0.9921
Epoch 25/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0271 - acc: 0.9922
Epoch 26/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0259 - acc: 0.9927
Epoch 27/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0265 - acc: 0.9924
Epoch 28/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0255 - acc: 0.9930
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8245
False 826
True percentage 0.90894057987
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
      B-PER       0.90      0.84      0.87       438
      B-ORG       0.77      0.75      0.76       296
     B-MISC       0.39      0.28      0.33       141
      I-PER       0.93      0.65      0.76       214
      I-ORG       0.66      0.63      0.65       151
     I-MISC       0.49      0.45      0.47       154
      B-LOC       0.74      0.73      0.74       218
      I-LOC       0.73      0.80      0.76       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.718926974665
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100819 unique words.
Found 94 unique chars.
Found 9 unique labels.
815 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 256
OOV word occurences: 380
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6452480     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,559,042
Trainable params: 6,559,042
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 25s 29ms/step - loss: 0.6156 - acc: 0.8226
Epoch 2/28

837/837 [==============================] - 23s 27ms/step - loss: 0.3061 - acc: 0.9119
Epoch 3/28

837/837 [==============================] - 23s 27ms/step - loss: 0.2305 - acc: 0.9311
Epoch 4/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1877 - acc: 0.9457
Epoch 5/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1619 - acc: 0.9529
Epoch 6/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1405 - acc: 0.9600
Epoch 7/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1249 - acc: 0.9658
Epoch 8/28

837/837 [==============================] - 22s 27ms/step - loss: 0.1110 - acc: 0.9691
Epoch 9/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0997 - acc: 0.9719
Epoch 10/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0894 - acc: 0.9757
Epoch 11/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0828 - acc: 0.9771
Epoch 12/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0750 - acc: 0.9803
Epoch 13/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0691 - acc: 0.9806
Epoch 14/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0637 - acc: 0.9826
Epoch 15/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0587 - acc: 0.9846
Epoch 16/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0558 - acc: 0.9852
Epoch 17/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0513 - acc: 0.9864
Epoch 18/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0476 - acc: 0.9877
Epoch 19/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0434 - acc: 0.9888
Epoch 20/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0433 - acc: 0.9888
Epoch 21/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0398 - acc: 0.9893
Epoch 22/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0362 - acc: 0.9903
Epoch 23/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0362 - acc: 0.9903
Epoch 24/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0336 - acc: 0.9907
Epoch 25/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0336 - acc: 0.9910
Epoch 26/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0307 - acc: 0.9919
Epoch 27/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0289 - acc: 0.9923
Epoch 28/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0270 - acc: 0.9934
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8160
False 911
True percentage 0.899570058428
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-LOC       0.72      0.73      0.72       218
      I-LOC       0.69      0.82      0.75       141
      B-PER       0.90      0.79      0.84       438
      B-ORG       0.73      0.69      0.71       296
      I-ORG       0.66      0.58      0.62       151
     B-MISC       0.44      0.20      0.27       141
     I-MISC       0.57      0.32      0.41       154
      I-PER       0.92      0.63      0.74       214

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.693069306931
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 100791 unique words.
Found 94 unique chars.
Found 9 unique labels.
787 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 260
OOV word occurences: 406
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6450688     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,557,250
Trainable params: 6,557,250
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 25s 30ms/step - loss: 0.6015 - acc: 0.8256
Epoch 2/28

837/837 [==============================] - 24s 28ms/step - loss: 0.3017 - acc: 0.9124
Epoch 3/28

837/837 [==============================] - 24s 28ms/step - loss: 0.2262 - acc: 0.9333
Epoch 4/28

837/837 [==============================] - 24s 28ms/step - loss: 0.1859 - acc: 0.9442
Epoch 5/28

837/837 [==============================] - 24s 28ms/step - loss: 0.1579 - acc: 0.9539
Epoch 6/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1406 - acc: 0.9598
Epoch 7/28

837/837 [==============================] - 24s 28ms/step - loss: 0.1227 - acc: 0.9650
Epoch 8/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1087 - acc: 0.9691
Epoch 9/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0960 - acc: 0.9736
Epoch 10/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0867 - acc: 0.9770
Epoch 11/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0796 - acc: 0.9788
Epoch 12/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0741 - acc: 0.9799
Epoch 13/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0674 - acc: 0.9823
Epoch 14/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0622 - acc: 0.9838
Epoch 15/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0566 - acc: 0.9853
Epoch 16/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0534 - acc: 0.9870
Epoch 17/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0500 - acc: 0.9873
Epoch 18/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0470 - acc: 0.9885
Epoch 19/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0438 - acc: 0.9893
Epoch 20/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0402 - acc: 0.9907
Epoch 21/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0378 - acc: 0.9906
Epoch 22/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0355 - acc: 0.9918
Epoch 23/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0343 - acc: 0.9921
Epoch 24/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0319 - acc: 0.9921
Epoch 25/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0302 - acc: 0.9932
Epoch 26/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0296 - acc: 0.9924
Epoch 27/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0278 - acc: 0.9930
Epoch 28/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0266 - acc: 0.9932
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8119
False 952
True percentage 0.89505015985
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.90      0.74      0.81       438
      I-PER       0.92      0.61      0.74       214
          O       0.98      0.96      0.97      7318
      B-ORG       0.79      0.71      0.75       296
      I-ORG       0.58      0.55      0.56       151
      B-LOC       0.73      0.75      0.74       218
      I-LOC       0.69      0.78      0.73       141
     B-MISC       0.32      0.26      0.28       141
     I-MISC       0.47      0.32      0.38       154

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.920425029516
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100794 unique words.
Found 94 unique chars.
Found 9 unique labels.
790 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 260
OOV word occurences: 391
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6450880     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,557,442
Trainable params: 6,557,442
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 26s 31ms/step - loss: 0.5840 - acc: 0.8328
Epoch 2/28

837/837 [==============================] - 24s 29ms/step - loss: 0.2935 - acc: 0.9134
Epoch 3/28

837/837 [==============================] - 24s 29ms/step - loss: 0.2157 - acc: 0.9355
Epoch 4/28

837/837 [==============================] - 24s 29ms/step - loss: 0.1722 - acc: 0.9503
Epoch 5/28

837/837 [==============================] - 24s 29ms/step - loss: 0.1488 - acc: 0.9566
Epoch 6/28

837/837 [==============================] - 24s 29ms/step - loss: 0.1283 - acc: 0.9622
Epoch 7/28

837/837 [==============================] - 24s 29ms/step - loss: 0.1129 - acc: 0.9680
Epoch 8/28

837/837 [==============================] - 24s 29ms/step - loss: 0.1003 - acc: 0.9706
Epoch 9/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0923 - acc: 0.9742
Epoch 10/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0823 - acc: 0.9772
Epoch 11/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0739 - acc: 0.9792
Epoch 12/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0671 - acc: 0.9818
Epoch 13/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0622 - acc: 0.9834
Epoch 14/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0535 - acc: 0.9860
Epoch 15/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0539 - acc: 0.9850
Epoch 16/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0515 - acc: 0.9866
Epoch 17/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0465 - acc: 0.9879
Epoch 18/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0411 - acc: 0.9894
Epoch 19/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0391 - acc: 0.9898
Epoch 20/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0392 - acc: 0.9894
Epoch 21/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0358 - acc: 0.9911
Epoch 22/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0333 - acc: 0.9909
Epoch 23/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0314 - acc: 0.9923
Epoch 24/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0299 - acc: 0.9922
Epoch 25/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0288 - acc: 0.9927
Epoch 26/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0264 - acc: 0.9931
Epoch 27/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0245 - acc: 0.9943
Epoch 28/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0244 - acc: 0.9941
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8110
False 961
True percentage 0.894057986992
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.90      0.76      0.82       438
      B-LOC       0.74      0.68      0.71       218
     B-MISC       0.36      0.33      0.34       141
     I-MISC       0.43      0.42      0.42       154
      B-ORG       0.73      0.72      0.73       296
      I-ORG       0.55      0.52      0.53       151
      I-LOC       0.77      0.72      0.74       141
      I-PER       0.90      0.64      0.75       214

avg / total       0.93      0.89      0.91      9071

F-1 Score (without O):
0.675301204819
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 100743 unique words.
Found 94 unique chars.
Found 9 unique labels.
739 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 259
OOV word occurences: 396
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6447616     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,554,178
Trainable params: 6,554,178
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 25s 30ms/step - loss: 0.5911 - acc: 0.8307
Epoch 2/28

837/837 [==============================] - 23s 28ms/step - loss: 0.3001 - acc: 0.9118
Epoch 3/28

837/837 [==============================] - 23s 28ms/step - loss: 0.2214 - acc: 0.9357
Epoch 4/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1849 - acc: 0.9463
Epoch 5/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1550 - acc: 0.9570
Epoch 6/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1336 - acc: 0.9622
Epoch 7/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1207 - acc: 0.9672
Epoch 8/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1061 - acc: 0.9704
Epoch 9/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0953 - acc: 0.9740
Epoch 10/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0852 - acc: 0.9773
Epoch 11/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0789 - acc: 0.9798
Epoch 12/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0740 - acc: 0.9799
Epoch 13/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0643 - acc: 0.9836
Epoch 14/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0619 - acc: 0.9843
Epoch 15/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0563 - acc: 0.9858
Epoch 16/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0535 - acc: 0.9862
Epoch 17/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0485 - acc: 0.9872
Epoch 18/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0447 - acc: 0.9877
Epoch 19/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0403 - acc: 0.9888
Epoch 20/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0384 - acc: 0.9894
Epoch 21/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0388 - acc: 0.9901
Epoch 22/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0342 - acc: 0.9910
Epoch 23/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0327 - acc: 0.9912
Epoch 24/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0301 - acc: 0.9919
Epoch 25/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0294 - acc: 0.9926
Epoch 26/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0291 - acc: 0.9921
Epoch 27/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0278 - acc: 0.9931
Epoch 28/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0249 - acc: 0.9933
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8138
False 933
True percentage 0.897144746996
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.77      0.70      0.73       296
      I-ORG       0.64      0.56      0.59       151
      B-PER       0.89      0.74      0.80       438
      I-PER       0.92      0.63      0.74       214
      B-LOC       0.73      0.72      0.72       218
      I-LOC       0.74      0.79      0.77       141
     B-MISC       0.38      0.38      0.38       141
     I-MISC       0.49      0.44      0.46       154

avg / total       0.94      0.90      0.92      9071

F-1 Score (without O):
0.687254011505
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 100791 unique words.
Found 94 unique chars.
Found 9 unique labels.
787 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 254
OOV word occurences: 388
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6450688     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,557,250
Trainable params: 6,557,250
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 25s 30ms/step - loss: 0.5809 - acc: 0.8335
Epoch 2/28

837/837 [==============================] - 23s 28ms/step - loss: 0.2880 - acc: 0.9144
Epoch 3/28

837/837 [==============================] - 23s 28ms/step - loss: 0.2093 - acc: 0.9373
Epoch 4/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1743 - acc: 0.9490
Epoch 5/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1446 - acc: 0.9577
Epoch 6/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1248 - acc: 0.9649
Epoch 7/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1129 - acc: 0.9683
Epoch 8/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0986 - acc: 0.9735
Epoch 9/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0895 - acc: 0.9765
Epoch 10/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0794 - acc: 0.9791
Epoch 11/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0717 - acc: 0.9812
Epoch 12/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0648 - acc: 0.9839
Epoch 13/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0600 - acc: 0.9839
Epoch 14/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0558 - acc: 0.9856
Epoch 15/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0508 - acc: 0.9869
Epoch 16/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0470 - acc: 0.9882
Epoch 17/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0451 - acc: 0.9885
Epoch 18/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0432 - acc: 0.9883
Epoch 19/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0382 - acc: 0.9901
Epoch 20/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0367 - acc: 0.9907
Epoch 21/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0348 - acc: 0.9912
Epoch 22/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0343 - acc: 0.9913
Epoch 23/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0322 - acc: 0.9913
Epoch 24/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0293 - acc: 0.9931
Epoch 25/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0270 - acc: 0.9934
Epoch 26/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0273 - acc: 0.9927
Epoch 27/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0254 - acc: 0.9937
Epoch 28/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0236 - acc: 0.9941
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8125
False 946
True percentage 0.895711608422
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.74      0.71      0.73       296
      I-ORG       0.68      0.48      0.56       151
      B-PER       0.89      0.77      0.83       438
      I-PER       0.87      0.62      0.72       214
     B-MISC       0.39      0.23      0.29       141
     I-MISC       0.50      0.39      0.44       154
      B-LOC       0.68      0.66      0.67       218
      I-LOC       0.75      0.73      0.74       141

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.676789587852
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 100816 unique words.
Found 94 unique chars.
Found 9 unique labels.
812 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 253
OOV word occurences: 361
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6452288     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,558,850
Trainable params: 6,558,850
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 25s 30ms/step - loss: 0.6082 - acc: 0.8281
Epoch 2/28

837/837 [==============================] - 23s 28ms/step - loss: 0.3011 - acc: 0.9131
Epoch 3/28

837/837 [==============================] - 23s 28ms/step - loss: 0.2218 - acc: 0.9361
Epoch 4/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1811 - acc: 0.9471
Epoch 5/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1505 - acc: 0.9554
Epoch 6/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1308 - acc: 0.9612
Epoch 7/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1159 - acc: 0.9666
Epoch 8/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1064 - acc: 0.9718
Epoch 9/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0914 - acc: 0.9766
Epoch 10/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0846 - acc: 0.9790
Epoch 11/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0761 - acc: 0.9799
Epoch 12/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0712 - acc: 0.9809
Epoch 13/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0626 - acc: 0.9838
Epoch 14/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0581 - acc: 0.9858
Epoch 15/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0540 - acc: 0.9854
Epoch 16/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0475 - acc: 0.9875
Epoch 17/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0449 - acc: 0.9879
Epoch 18/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0413 - acc: 0.9897
Epoch 19/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0392 - acc: 0.9901
Epoch 20/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0363 - acc: 0.9904
Epoch 21/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0352 - acc: 0.9911
Epoch 22/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0339 - acc: 0.9913
Epoch 23/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0310 - acc: 0.9922
Epoch 24/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0294 - acc: 0.9924
Epoch 25/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0283 - acc: 0.9929
Epoch 26/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0252 - acc: 0.9941
Epoch 27/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0251 - acc: 0.9936
Epoch 28/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0238 - acc: 0.9940
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8130
False 941
True percentage 0.896262815566
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.90      0.78      0.84       438
          O       0.98      0.96      0.97      7318
      B-LOC       0.72      0.70      0.71       218
      B-ORG       0.75      0.71      0.73       296
      I-PER       0.87      0.65      0.75       214
     B-MISC       0.33      0.24      0.28       141
     I-MISC       0.46      0.38      0.42       154
      I-ORG       0.56      0.54      0.55       151
      I-LOC       0.64      0.77      0.70       141

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.91811589931
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 100782 unique words.
Found 94 unique chars.
Found 9 unique labels.
778 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 259
OOV word occurences: 372
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6450112     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,556,674
Trainable params: 6,556,674
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 25s 30ms/step - loss: 0.5855 - acc: 0.8311
Epoch 2/28

837/837 [==============================] - 23s 28ms/step - loss: 0.2851 - acc: 0.9171
Epoch 3/28

837/837 [==============================] - 23s 28ms/step - loss: 0.2126 - acc: 0.9374
Epoch 4/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1753 - acc: 0.9495
Epoch 5/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1482 - acc: 0.9567
Epoch 6/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1311 - acc: 0.9625
Epoch 7/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1175 - acc: 0.9668
Epoch 8/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1064 - acc: 0.9699
Epoch 9/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0937 - acc: 0.9736
Epoch 10/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0853 - acc: 0.9768
Epoch 11/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0780 - acc: 0.9794
Epoch 12/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0693 - acc: 0.9829
Epoch 13/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0621 - acc: 0.9841
Epoch 14/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0604 - acc: 0.9832
Epoch 15/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0559 - acc: 0.9854
Epoch 16/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0499 - acc: 0.9864
Epoch 17/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0469 - acc: 0.9882
Epoch 18/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0432 - acc: 0.9886
Epoch 19/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0425 - acc: 0.9887
Epoch 20/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0387 - acc: 0.9902
Epoch 21/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0372 - acc: 0.9907
Epoch 22/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0327 - acc: 0.9925
Epoch 23/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0331 - acc: 0.9912
Epoch 24/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0290 - acc: 0.9928
Epoch 25/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0290 - acc: 0.9932
Epoch 26/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0265 - acc: 0.9930
Epoch 27/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0264 - acc: 0.9933
Epoch 28/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0244 - acc: 0.9943
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8145
False 926
True percentage 0.897916436997
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.97      7318
     B-MISC       0.41      0.33      0.36       141
      B-ORG       0.70      0.67      0.69       296
     I-MISC       0.46      0.43      0.44       154
      B-LOC       0.74      0.72      0.73       218
      I-ORG       0.56      0.55      0.56       151
      B-PER       0.89      0.83      0.86       438
      I-PER       0.88      0.64      0.74       214
      I-LOC       0.79      0.76      0.78       141

avg / total       0.93      0.90      0.92      9071

F-1 Score (without O):
0.689901697945
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 100805 unique words.
Found 94 unique chars.
Found 9 unique labels.
801 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 260
OOV word occurences: 372
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6451584     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,558,146
Trainable params: 6,558,146
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 25s 30ms/step - loss: 0.5808 - acc: 0.8305
Epoch 2/28

837/837 [==============================] - 24s 28ms/step - loss: 0.2908 - acc: 0.9143
Epoch 3/28

837/837 [==============================] - 24s 28ms/step - loss: 0.2101 - acc: 0.9385
Epoch 4/28

837/837 [==============================] - 24s 28ms/step - loss: 0.1675 - acc: 0.9516
Epoch 5/28

837/837 [==============================] - 24s 28ms/step - loss: 0.1444 - acc: 0.9585
Epoch 6/28

837/837 [==============================] - 24s 28ms/step - loss: 0.1253 - acc: 0.9649
Epoch 7/28

837/837 [==============================] - 24s 28ms/step - loss: 0.1073 - acc: 0.9714
Epoch 8/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0978 - acc: 0.9737
Epoch 9/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0873 - acc: 0.9780
Epoch 10/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0796 - acc: 0.9798
Epoch 11/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0702 - acc: 0.9816
Epoch 12/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0644 - acc: 0.9841
Epoch 13/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0585 - acc: 0.9859
Epoch 14/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0538 - acc: 0.9861
Epoch 15/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0495 - acc: 0.9886
Epoch 16/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0469 - acc: 0.9883
Epoch 17/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0416 - acc: 0.9903
Epoch 18/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0392 - acc: 0.9906
Epoch 19/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0380 - acc: 0.9907
Epoch 20/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0361 - acc: 0.9918
Epoch 21/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0327 - acc: 0.9920
Epoch 22/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0316 - acc: 0.9919
Epoch 23/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0302 - acc: 0.9929
Epoch 24/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0289 - acc: 0.9929
Epoch 25/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0261 - acc: 0.9937
Epoch 26/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0267 - acc: 0.9938
Epoch 27/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0244 - acc: 0.9941
Epoch 28/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0244 - acc: 0.9938
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8159
False 912
True percentage 0.899459816999
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.83      0.68      0.75       296
          O       0.97      0.96      0.97      7318
     B-MISC       0.39      0.24      0.30       141
     I-MISC       0.56      0.39      0.46       154
      B-LOC       0.70      0.78      0.74       218
      I-LOC       0.74      0.79      0.76       141
      B-PER       0.89      0.77      0.83       438
      I-PER       0.90      0.64      0.75       214
      I-ORG       0.66      0.52      0.58       151

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.923684057803
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 100771 unique words.
Found 94 unique chars.
Found 9 unique labels.
767 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 257
OOV word occurences: 396
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6449408     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,555,970
Trainable params: 6,555,970
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 25s 30ms/step - loss: 0.5978 - acc: 0.8284
Epoch 2/28

837/837 [==============================] - 24s 29ms/step - loss: 0.3014 - acc: 0.9125
Epoch 3/28

837/837 [==============================] - 24s 28ms/step - loss: 0.2165 - acc: 0.9373
Epoch 4/28

837/837 [==============================] - 24s 28ms/step - loss: 0.1795 - acc: 0.9464
Epoch 5/28

837/837 [==============================] - 24s 28ms/step - loss: 0.1544 - acc: 0.9541
Epoch 6/28

837/837 [==============================] - 24s 28ms/step - loss: 0.1342 - acc: 0.9598
Epoch 7/28

837/837 [==============================] - 24s 28ms/step - loss: 0.1211 - acc: 0.9655
Epoch 8/28

837/837 [==============================] - 24s 29ms/step - loss: 0.1081 - acc: 0.9690
Epoch 9/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0988 - acc: 0.9725
Epoch 10/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0901 - acc: 0.9759
Epoch 11/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0835 - acc: 0.9766
Epoch 12/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0765 - acc: 0.9796
Epoch 13/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0726 - acc: 0.9799
Epoch 14/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0640 - acc: 0.9840
Epoch 15/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0620 - acc: 0.9844
Epoch 16/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0570 - acc: 0.9857
Epoch 17/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0538 - acc: 0.9866
Epoch 18/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0515 - acc: 0.9868
Epoch 19/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0486 - acc: 0.9877
Epoch 20/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0459 - acc: 0.9874
Epoch 21/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0420 - acc: 0.9894
Epoch 22/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0423 - acc: 0.9886
Epoch 23/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0397 - acc: 0.9886
Epoch 24/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0379 - acc: 0.9903
Epoch 25/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0336 - acc: 0.9908
Epoch 26/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0333 - acc: 0.9913
Epoch 27/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0302 - acc: 0.9924
Epoch 28/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0301 - acc: 0.9917
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8038
False 1033
True percentage 0.886120604123
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.97      7318
      B-PER       0.88      0.71      0.79       438
      B-ORG       0.72      0.66      0.69       296
     B-MISC       0.31      0.33      0.32       141
      I-PER       0.86      0.63      0.72       214
      I-ORG       0.47      0.52      0.49       151
     I-MISC       0.40      0.40      0.40       154
      B-LOC       0.74      0.74      0.74       218
      I-LOC       0.71      0.77      0.74       141

avg / total       0.93      0.89      0.91      9071

F-1 Score (without O):
0.649896419059
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100357 unique words.
Found 94 unique chars.
Found 9 unique labels.
353 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 289
OOV word occurences: 446
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6422912     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,529,474
Trainable params: 6,529,474
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 11s 33ms/step - loss: 0.7979 - acc: 0.7798
Epoch 2/28

334/334 [==============================] - 9s 28ms/step - loss: 0.4530 - acc: 0.8648
Epoch 3/28

334/334 [==============================] - 9s 28ms/step - loss: 0.3504 - acc: 0.8972
Epoch 4/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2740 - acc: 0.9206
Epoch 5/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2307 - acc: 0.9356
Epoch 6/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1972 - acc: 0.9444
Epoch 7/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1739 - acc: 0.9520
Epoch 8/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1562 - acc: 0.9576
Epoch 9/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1390 - acc: 0.9608
Epoch 10/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1218 - acc: 0.9673
Epoch 11/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1133 - acc: 0.9708
Epoch 12/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1025 - acc: 0.9737
Epoch 13/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0941 - acc: 0.9778
Epoch 14/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0883 - acc: 0.9771
Epoch 15/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0791 - acc: 0.9810
Epoch 16/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0731 - acc: 0.9832
Epoch 17/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0657 - acc: 0.9846
Epoch 18/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0618 - acc: 0.9849
Epoch 19/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0561 - acc: 0.9871
Epoch 20/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0500 - acc: 0.9891
Epoch 21/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0480 - acc: 0.9879
Epoch 22/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0474 - acc: 0.9885
Epoch 23/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0438 - acc: 0.9901
Epoch 24/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0417 - acc: 0.9903
Epoch 25/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0382 - acc: 0.9917
Epoch 26/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0353 - acc: 0.9926
Epoch 27/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0335 - acc: 0.9922
Epoch 28/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0319 - acc: 0.9937
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8026
False 1045
True percentage 0.884797706978
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-LOC       0.74      0.72      0.73       218
      I-LOC       0.80      0.78      0.79       141
      B-PER       0.87      0.71      0.78       438
      B-ORG       0.73      0.69      0.71       296
      I-ORG       0.59      0.52      0.55       151
     B-MISC       0.45      0.27      0.34       141
     I-MISC       0.44      0.42      0.43       154
      I-PER       0.86      0.53      0.66       214

avg / total       0.93      0.88      0.90      9071

F-1 Score (without O):
0.664195242508
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 100385 unique words.
Found 94 unique chars.
Found 9 unique labels.
381 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 282
OOV word occurences: 460
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6424704     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,531,266
Trainable params: 6,531,266
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 11s 34ms/step - loss: 0.8224 - acc: 0.7747
Epoch 2/28

334/334 [==============================] - 10s 29ms/step - loss: 0.4559 - acc: 0.8662
Epoch 3/28

334/334 [==============================] - 10s 29ms/step - loss: 0.3452 - acc: 0.8948
Epoch 4/28

334/334 [==============================] - 10s 29ms/step - loss: 0.2802 - acc: 0.9164
Epoch 5/28

334/334 [==============================] - 10s 29ms/step - loss: 0.2371 - acc: 0.9297
Epoch 6/28

334/334 [==============================] - 10s 29ms/step - loss: 0.2073 - acc: 0.9376
Epoch 7/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1832 - acc: 0.9462
Epoch 8/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1605 - acc: 0.9568
Epoch 9/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1455 - acc: 0.9588
Epoch 10/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1316 - acc: 0.9656
Epoch 11/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1176 - acc: 0.9707
Epoch 12/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1059 - acc: 0.9742
Epoch 13/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0948 - acc: 0.9776
Epoch 14/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0869 - acc: 0.9784
Epoch 15/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0818 - acc: 0.9789
Epoch 16/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0765 - acc: 0.9814
Epoch 17/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0670 - acc: 0.9841
Epoch 18/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0659 - acc: 0.9831
Epoch 19/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0568 - acc: 0.9863
Epoch 20/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0549 - acc: 0.9871
Epoch 21/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0503 - acc: 0.9877
Epoch 22/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0482 - acc: 0.9884
Epoch 23/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0428 - acc: 0.9907
Epoch 24/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0389 - acc: 0.9917
Epoch 25/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0377 - acc: 0.9925
Epoch 26/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0383 - acc: 0.9915
Epoch 27/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0353 - acc: 0.9909
Epoch 28/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0317 - acc: 0.9941
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7936
False 1135
True percentage 0.874875978393
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.82      0.66      0.73       438
      I-PER       0.90      0.54      0.67       214
          O       0.97      0.95      0.96      7318
      B-ORG       0.70      0.64      0.67       296
      I-ORG       0.48      0.50      0.49       151
      B-LOC       0.65      0.66      0.66       218
      I-LOC       0.69      0.69      0.69       141
     B-MISC       0.26      0.13      0.17       141
     I-MISC       0.36      0.19      0.25       154

avg / total       0.91      0.87      0.89      9071

F-1 Score (without O):
0.905280606204
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100372 unique words.
Found 94 unique chars.
Found 9 unique labels.
368 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 283
OOV word occurences: 438
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6423872     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,530,434
Trainable params: 6,530,434
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 11s 34ms/step - loss: 0.7616 - acc: 0.7840
Epoch 2/28

334/334 [==============================] - 10s 29ms/step - loss: 0.4261 - acc: 0.8707
Epoch 3/28

334/334 [==============================] - 9s 28ms/step - loss: 0.3212 - acc: 0.9093
Epoch 4/28

334/334 [==============================] - 10s 29ms/step - loss: 0.2573 - acc: 0.9284
Epoch 5/28

334/334 [==============================] - 10s 29ms/step - loss: 0.2082 - acc: 0.9409
Epoch 6/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1771 - acc: 0.9496
Epoch 7/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1553 - acc: 0.9562
Epoch 8/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1325 - acc: 0.9661
Epoch 9/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1184 - acc: 0.9685
Epoch 10/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1068 - acc: 0.9726
Epoch 11/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0944 - acc: 0.9767
Epoch 12/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0855 - acc: 0.9804
Epoch 13/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0772 - acc: 0.9811
Epoch 14/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0707 - acc: 0.9855
Epoch 15/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0682 - acc: 0.9837
Epoch 16/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0592 - acc: 0.9868
Epoch 17/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0544 - acc: 0.9883
Epoch 18/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0512 - acc: 0.9886
Epoch 19/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0484 - acc: 0.9889
Epoch 20/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0440 - acc: 0.9893
Epoch 21/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0404 - acc: 0.9916
Epoch 22/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0389 - acc: 0.9922
Epoch 23/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0367 - acc: 0.9918
Epoch 24/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0336 - acc: 0.9930
Epoch 25/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0326 - acc: 0.9941
Epoch 26/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0290 - acc: 0.9952
Epoch 27/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0324 - acc: 0.9934
Epoch 28/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0260 - acc: 0.9952
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7993
False 1078
True percentage 0.88115973983
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-PER       0.87      0.69      0.77       438
      B-LOC       0.69      0.65      0.67       218
     B-MISC       0.35      0.30      0.32       141
     I-MISC       0.39      0.36      0.38       154
      B-ORG       0.74      0.67      0.71       296
      I-ORG       0.53      0.47      0.50       151
      I-LOC       0.77      0.67      0.72       141
      I-PER       0.83      0.60      0.70       214

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.637342356198
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 100379 unique words.
Found 94 unique chars.
Found 9 unique labels.
375 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 284
OOV word occurences: 466
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6424320     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,530,882
Trainable params: 6,530,882
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 11s 34ms/step - loss: 0.7821 - acc: 0.7772
Epoch 2/28

334/334 [==============================] - 9s 28ms/step - loss: 0.4356 - acc: 0.8737
Epoch 3/28

334/334 [==============================] - 10s 29ms/step - loss: 0.3207 - acc: 0.9105
Epoch 4/28

334/334 [==============================] - 10s 29ms/step - loss: 0.2533 - acc: 0.9291
Epoch 5/28

334/334 [==============================] - 10s 29ms/step - loss: 0.2092 - acc: 0.9406
Epoch 6/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1702 - acc: 0.9517
Epoch 7/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1508 - acc: 0.9605
Epoch 8/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1311 - acc: 0.9619
Epoch 9/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1144 - acc: 0.9699
Epoch 10/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1011 - acc: 0.9744
Epoch 11/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0953 - acc: 0.9763
Epoch 12/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0876 - acc: 0.9778
Epoch 13/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0770 - acc: 0.9814
Epoch 14/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0709 - acc: 0.9831
Epoch 15/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0678 - acc: 0.9840
Epoch 16/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0613 - acc: 0.9850
Epoch 17/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0585 - acc: 0.9846
Epoch 18/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0511 - acc: 0.9879
Epoch 19/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0471 - acc: 0.9891
Epoch 20/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0456 - acc: 0.9884
Epoch 21/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0408 - acc: 0.9907
Epoch 22/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0394 - acc: 0.9918
Epoch 23/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0381 - acc: 0.9917
Epoch 24/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0329 - acc: 0.9937
Epoch 25/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0337 - acc: 0.9925
Epoch 26/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0317 - acc: 0.9934
Epoch 27/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0283 - acc: 0.9933
Epoch 28/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0265 - acc: 0.9954
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7917
False 1154
True percentage 0.872781391247
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.94      0.96      7318
      B-ORG       0.68      0.66      0.67       296
      I-ORG       0.48      0.45      0.46       151
      B-PER       0.88      0.69      0.77       438
      I-PER       0.81      0.57      0.67       214
      B-LOC       0.70      0.66      0.68       218
      I-LOC       0.71      0.75      0.73       141
     B-MISC       0.26      0.23      0.25       141
     I-MISC       0.38      0.32      0.35       154

avg / total       0.92      0.87      0.89      9071

F-1 Score (without O):
0.620668693009
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 100389 unique words.
Found 94 unique chars.
Found 9 unique labels.
385 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 280
OOV word occurences: 436
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6424960     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,531,522
Trainable params: 6,531,522
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 11s 33ms/step - loss: 0.7928 - acc: 0.7878
Epoch 2/28

334/334 [==============================] - 10s 29ms/step - loss: 0.4439 - acc: 0.8622
Epoch 3/28

334/334 [==============================] - 10s 29ms/step - loss: 0.3373 - acc: 0.8924
Epoch 4/28

334/334 [==============================] - 10s 29ms/step - loss: 0.2665 - acc: 0.9181
Epoch 5/28

334/334 [==============================] - 10s 28ms/step - loss: 0.2240 - acc: 0.9342
Epoch 6/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1900 - acc: 0.9470
Epoch 7/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1718 - acc: 0.9519
Epoch 8/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1444 - acc: 0.9610
Epoch 9/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1343 - acc: 0.9635
Epoch 10/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1173 - acc: 0.9695
Epoch 11/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1107 - acc: 0.9695
Epoch 12/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0984 - acc: 0.9766
Epoch 13/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0871 - acc: 0.9804
Epoch 14/28

334/334 [==============================] - 10s 28ms/step - loss: 0.0825 - acc: 0.9797
Epoch 15/28

334/334 [==============================] - 10s 28ms/step - loss: 0.0761 - acc: 0.9817
Epoch 16/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0690 - acc: 0.9819
Epoch 17/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0648 - acc: 0.9845
Epoch 18/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0588 - acc: 0.9864
Epoch 19/28

334/334 [==============================] - 10s 28ms/step - loss: 0.0554 - acc: 0.9885
Epoch 20/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0499 - acc: 0.9894
Epoch 21/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0463 - acc: 0.9893
Epoch 22/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0479 - acc: 0.9888
Epoch 23/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0447 - acc: 0.9905
Epoch 24/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0378 - acc: 0.9915
Epoch 25/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0361 - acc: 0.9920
Epoch 26/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0346 - acc: 0.9911
Epoch 27/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0333 - acc: 0.9926
Epoch 28/28

334/334 [==============================] - 10s 28ms/step - loss: 0.0323 - acc: 0.9934
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7986
False 1085
True percentage 0.880388049829
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.96      0.96      7318
      B-ORG       0.70      0.68      0.69       296
      I-ORG       0.55      0.44      0.49       151
      B-PER       0.86      0.69      0.77       438
      I-PER       0.84      0.53      0.65       214
     B-MISC       0.28      0.14      0.19       141
     I-MISC       0.46      0.27      0.34       154
      B-LOC       0.67      0.66      0.67       218
      I-LOC       0.79      0.62      0.70       141

avg / total       0.91      0.88      0.89      9071

F-1 Score (without O):
0.623484365029
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 100374 unique words.
Found 94 unique chars.
Found 9 unique labels.
370 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 283
OOV word occurences: 451
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6424000     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,530,562
Trainable params: 6,530,562
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 11s 34ms/step - loss: 0.8434 - acc: 0.7749
Epoch 2/28

334/334 [==============================] - 10s 29ms/step - loss: 0.4810 - acc: 0.8547
Epoch 3/28

334/334 [==============================] - 10s 29ms/step - loss: 0.3538 - acc: 0.8972
Epoch 4/28

334/334 [==============================] - 10s 29ms/step - loss: 0.2799 - acc: 0.9234
Epoch 5/28

334/334 [==============================] - 10s 28ms/step - loss: 0.2265 - acc: 0.9383
Epoch 6/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1908 - acc: 0.9473
Epoch 7/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1732 - acc: 0.9535
Epoch 8/28

334/334 [==============================] - 10s 28ms/step - loss: 0.1488 - acc: 0.9587
Epoch 9/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1349 - acc: 0.9647
Epoch 10/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1203 - acc: 0.9692
Epoch 11/28

334/334 [==============================] - 10s 28ms/step - loss: 0.1061 - acc: 0.9730
Epoch 12/28

334/334 [==============================] - 10s 28ms/step - loss: 0.0952 - acc: 0.9769
Epoch 13/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0865 - acc: 0.9783
Epoch 14/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0796 - acc: 0.9811
Epoch 15/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0748 - acc: 0.9816
Epoch 16/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0663 - acc: 0.9840
Epoch 17/28

334/334 [==============================] - 10s 28ms/step - loss: 0.0617 - acc: 0.9865
Epoch 18/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0579 - acc: 0.9877
Epoch 19/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0569 - acc: 0.9866
Epoch 20/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0482 - acc: 0.9883
Epoch 21/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0480 - acc: 0.9899
Epoch 22/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0444 - acc: 0.9909
Epoch 23/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0437 - acc: 0.9905
Epoch 24/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0381 - acc: 0.9924
Epoch 25/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0375 - acc: 0.9921
Epoch 26/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0336 - acc: 0.9937
Epoch 27/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0311 - acc: 0.9931
Epoch 28/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0290 - acc: 0.9956
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7989
False 1082
True percentage 0.880718774115
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.84      0.69      0.76       438
          O       0.97      0.95      0.96      7318
      B-LOC       0.73      0.67      0.70       218
      B-ORG       0.70      0.71      0.70       296
      I-PER       0.91      0.53      0.67       214
     B-MISC       0.29      0.11      0.16       141
     I-MISC       0.33      0.34      0.34       154
      I-ORG       0.59      0.57      0.58       151
      I-LOC       0.78      0.72      0.75       141

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.910027228602
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 100377 unique words.
Found 94 unique chars.
Found 9 unique labels.
373 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 288
OOV word occurences: 432
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6424192     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,530,754
Trainable params: 6,530,754
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 11s 34ms/step - loss: 0.7906 - acc: 0.7752
Epoch 2/28

334/334 [==============================] - 10s 29ms/step - loss: 0.4414 - acc: 0.8648
Epoch 3/28

334/334 [==============================] - 10s 29ms/step - loss: 0.3307 - acc: 0.8994
Epoch 4/28

334/334 [==============================] - 10s 29ms/step - loss: 0.2670 - acc: 0.9191
Epoch 5/28

334/334 [==============================] - 10s 29ms/step - loss: 0.2221 - acc: 0.9318
Epoch 6/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1913 - acc: 0.9414
Epoch 7/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1675 - acc: 0.9506
Epoch 8/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1453 - acc: 0.9561
Epoch 9/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1344 - acc: 0.9627
Epoch 10/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1135 - acc: 0.9679
Epoch 11/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1057 - acc: 0.9718
Epoch 12/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0958 - acc: 0.9756
Epoch 13/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0860 - acc: 0.9799
Epoch 14/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0798 - acc: 0.9806
Epoch 15/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0725 - acc: 0.9838
Epoch 16/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0666 - acc: 0.9843
Epoch 17/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0623 - acc: 0.9843
Epoch 18/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0562 - acc: 0.9889
Epoch 19/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0527 - acc: 0.9883
Epoch 20/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0507 - acc: 0.9876
Epoch 21/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0434 - acc: 0.9900
Epoch 22/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0416 - acc: 0.9911
Epoch 23/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0400 - acc: 0.9925
Epoch 24/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0387 - acc: 0.9917
Epoch 25/28

334/334 [==============================] - 10s 28ms/step - loss: 0.0337 - acc: 0.9937
Epoch 26/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0324 - acc: 0.9947
Epoch 27/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0298 - acc: 0.9946
Epoch 28/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0292 - acc: 0.9941
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7971
False 1100
True percentage 0.878734428398
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
     B-MISC       0.35      0.27      0.31       141
      B-ORG       0.69      0.65      0.67       296
     I-MISC       0.41      0.38      0.40       154
      B-LOC       0.72      0.68      0.70       218
      I-ORG       0.44      0.40      0.42       151
      B-PER       0.88      0.75      0.81       438
      I-PER       0.75      0.55      0.63       214
      I-LOC       0.66      0.72      0.69       141

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.632850241546
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 100351 unique words.
Found 94 unique chars.
Found 9 unique labels.
347 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 286
OOV word occurences: 481
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6422528     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,529,090
Trainable params: 6,529,090
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 11s 33ms/step - loss: 0.7912 - acc: 0.7791
Epoch 2/28

334/334 [==============================] - 9s 28ms/step - loss: 0.4489 - acc: 0.8624
Epoch 3/28

334/334 [==============================] - 9s 28ms/step - loss: 0.3303 - acc: 0.9033
Epoch 4/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2723 - acc: 0.9242
Epoch 5/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2192 - acc: 0.9424
Epoch 6/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1872 - acc: 0.9503
Epoch 7/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1620 - acc: 0.9573
Epoch 8/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1437 - acc: 0.9620
Epoch 9/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1218 - acc: 0.9712
Epoch 10/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1124 - acc: 0.9718
Epoch 11/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1011 - acc: 0.9769
Epoch 12/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0917 - acc: 0.9787
Epoch 13/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0866 - acc: 0.9793
Epoch 14/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0742 - acc: 0.9844
Epoch 15/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0702 - acc: 0.9855
Epoch 16/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0640 - acc: 0.9858
Epoch 17/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0571 - acc: 0.9869
Epoch 18/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0531 - acc: 0.9892
Epoch 19/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0518 - acc: 0.9894
Epoch 20/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0474 - acc: 0.9895
Epoch 21/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0423 - acc: 0.9910
Epoch 22/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0383 - acc: 0.9920
Epoch 23/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0384 - acc: 0.9914
Epoch 24/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0328 - acc: 0.9936
Epoch 25/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0334 - acc: 0.9922
Epoch 26/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0323 - acc: 0.9932
Epoch 27/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0291 - acc: 0.9943
Epoch 28/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0299 - acc: 0.9932
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7943
False 1128
True percentage 0.875647668394
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.72      0.51      0.60       296
          O       0.97      0.95      0.96      7318
     B-MISC       0.29      0.18      0.23       141
     I-MISC       0.40      0.41      0.40       154
      B-LOC       0.71      0.69      0.70       218
      I-LOC       0.77      0.65      0.71       141
      B-PER       0.86      0.69      0.76       438
      I-PER       0.89      0.58      0.70       214
      I-ORG       0.58      0.38      0.46       151

avg / total       0.92      0.88      0.89      9071

F-1 Score (without O):
0.908423200233
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 100348 unique words.
Found 94 unique chars.
Found 9 unique labels.
344 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 283
OOV word occurences: 477
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6422336     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,528,898
Trainable params: 6,528,898
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 11s 34ms/step - loss: 0.8291 - acc: 0.7715
Epoch 2/28

334/334 [==============================] - 10s 29ms/step - loss: 0.4743 - acc: 0.8519
Epoch 3/28

334/334 [==============================] - 9s 28ms/step - loss: 0.3559 - acc: 0.8917
Epoch 4/28

334/334 [==============================] - 10s 29ms/step - loss: 0.2769 - acc: 0.9171
Epoch 5/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2317 - acc: 0.9304
Epoch 6/28

334/334 [==============================] - 10s 29ms/step - loss: 0.2013 - acc: 0.9398
Epoch 7/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1762 - acc: 0.9481
Epoch 8/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1583 - acc: 0.9545
Epoch 9/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1419 - acc: 0.9603
Epoch 10/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1297 - acc: 0.9664
Epoch 11/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1167 - acc: 0.9659
Epoch 12/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1048 - acc: 0.9734
Epoch 13/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1000 - acc: 0.9751
Epoch 14/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0906 - acc: 0.9768
Epoch 15/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0849 - acc: 0.9775
Epoch 16/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0763 - acc: 0.9815
Epoch 17/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0694 - acc: 0.9838
Epoch 18/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0650 - acc: 0.9844
Epoch 19/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0622 - acc: 0.9859
Epoch 20/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0559 - acc: 0.9867
Epoch 21/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0530 - acc: 0.9872
Epoch 22/28

334/334 [==============================] - 10s 28ms/step - loss: 0.0494 - acc: 0.9888
Epoch 23/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0483 - acc: 0.9893
Epoch 24/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0448 - acc: 0.9890
Epoch 25/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0419 - acc: 0.9907
Epoch 26/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0414 - acc: 0.9907
Epoch 27/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0380 - acc: 0.9920
Epoch 28/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0377 - acc: 0.9901
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7889
False 1182
True percentage 0.869694631242
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-PER       0.84      0.63      0.72       438
      B-ORG       0.57      0.57      0.57       296
     B-MISC       0.40      0.23      0.30       141
      I-PER       0.85      0.56      0.67       214
      I-ORG       0.50      0.37      0.43       151
     I-MISC       0.36      0.47      0.41       154
      B-LOC       0.74      0.66      0.70       218
      I-LOC       0.79      0.68      0.73       141

avg / total       0.92      0.87      0.89      9071

F-1 Score (without O):
0.597651421508
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100207 unique words.
Found 94 unique chars.
Found 9 unique labels.
203 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 299
OOV word occurences: 525
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6413312     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,519,874
Trainable params: 6,519,874
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 7s 39ms/step - loss: 1.0015 - acc: 0.7247
Epoch 2/28

167/167 [==============================] - 5s 28ms/step - loss: 0.6148 - acc: 0.8135
Epoch 3/28

167/167 [==============================] - 5s 28ms/step - loss: 0.4927 - acc: 0.8451
Epoch 4/28

167/167 [==============================] - 5s 29ms/step - loss: 0.4012 - acc: 0.8739
Epoch 5/28

167/167 [==============================] - 5s 29ms/step - loss: 0.3470 - acc: 0.8946
Epoch 6/28

167/167 [==============================] - 5s 29ms/step - loss: 0.3054 - acc: 0.9125
Epoch 7/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2579 - acc: 0.9245
Epoch 8/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2272 - acc: 0.9379
Epoch 9/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2003 - acc: 0.9455
Epoch 10/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1720 - acc: 0.9600
Epoch 11/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1588 - acc: 0.9613
Epoch 12/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1440 - acc: 0.9650
Epoch 13/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1293 - acc: 0.9718
Epoch 14/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1151 - acc: 0.9740
Epoch 15/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1119 - acc: 0.9736
Epoch 16/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0983 - acc: 0.9818
Epoch 17/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0895 - acc: 0.9813
Epoch 18/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0813 - acc: 0.9859
Epoch 19/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0759 - acc: 0.9850
Epoch 20/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0693 - acc: 0.9887
Epoch 21/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0632 - acc: 0.9881
Epoch 22/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0594 - acc: 0.9912
Epoch 23/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0553 - acc: 0.9927
Epoch 24/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0507 - acc: 0.9926
Epoch 25/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0468 - acc: 0.9937
Epoch 26/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0466 - acc: 0.9916
Epoch 27/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0406 - acc: 0.9941
Epoch 28/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0361 - acc: 0.9957
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7685
False 1386
True percentage 0.847205379782
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.94      0.95      7318
      B-LOC       0.68      0.61      0.65       218
      I-LOC       0.75      0.63      0.68       141
      B-PER       0.75      0.43      0.55       438
      B-ORG       0.62      0.60      0.61       296
      I-ORG       0.54      0.37      0.44       151
     B-MISC       0.23      0.11      0.15       141
     I-MISC       0.32      0.39      0.35       154
      I-PER       0.58      0.42      0.48       214

avg / total       0.89      0.85      0.86      9071

F-1 Score (without O):
0.518873960333
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 100214 unique words.
Found 94 unique chars.
Found 9 unique labels.
210 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 297
OOV word occurences: 499
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6413760     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,520,322
Trainable params: 6,520,322
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 6s 39ms/step - loss: 0.9326 - acc: 0.7480
Epoch 2/28

167/167 [==============================] - 5s 29ms/step - loss: 0.5768 - acc: 0.8299
Epoch 3/28

167/167 [==============================] - 5s 29ms/step - loss: 0.4469 - acc: 0.8690
Epoch 4/28

167/167 [==============================] - 5s 29ms/step - loss: 0.3680 - acc: 0.8969
Epoch 5/28

167/167 [==============================] - 5s 29ms/step - loss: 0.3170 - acc: 0.9094
Epoch 6/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2706 - acc: 0.9208
Epoch 7/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2354 - acc: 0.9319
Epoch 8/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2113 - acc: 0.9411
Epoch 9/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1888 - acc: 0.9464
Epoch 10/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1697 - acc: 0.9529
Epoch 11/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1439 - acc: 0.9619
Epoch 12/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1382 - acc: 0.9625
Epoch 13/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1242 - acc: 0.9712
Epoch 14/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1117 - acc: 0.9717
Epoch 15/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1045 - acc: 0.9770
Epoch 16/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0973 - acc: 0.9789
Epoch 17/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0870 - acc: 0.9820
Epoch 18/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0833 - acc: 0.9817
Epoch 19/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0745 - acc: 0.9849
Epoch 20/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0679 - acc: 0.9877
Epoch 21/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0641 - acc: 0.9879
Epoch 22/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0603 - acc: 0.9865
Epoch 23/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0555 - acc: 0.9917
Epoch 24/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0494 - acc: 0.9898
Epoch 25/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0467 - acc: 0.9931
Epoch 26/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0488 - acc: 0.9908
Epoch 27/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0441 - acc: 0.9928
Epoch 28/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0401 - acc: 0.9933
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7844
False 1227
True percentage 0.86473376695
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.83      0.66      0.74       438
      I-PER       0.85      0.54      0.66       214
          O       0.97      0.95      0.96      7318
      B-ORG       0.65      0.53      0.59       296
      I-ORG       0.40      0.34      0.37       151
      B-LOC       0.65      0.68      0.67       218
      I-LOC       0.79      0.48      0.59       141
     B-MISC       0.26      0.11      0.15       141
     I-MISC       0.28      0.23      0.26       154

avg / total       0.90      0.86      0.88      9071

F-1 Score (without O):
0.896338930754
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100196 unique words.
Found 94 unique chars.
Found 9 unique labels.
192 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 300
OOV word occurences: 485
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6412608     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,519,170
Trainable params: 6,519,170
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 6s 38ms/step - loss: 1.0400 - acc: 0.7279
Epoch 2/28

167/167 [==============================] - 5s 28ms/step - loss: 0.5577 - acc: 0.8287
Epoch 3/28

167/167 [==============================] - 5s 28ms/step - loss: 0.4354 - acc: 0.8732
Epoch 4/28

167/167 [==============================] - 5s 28ms/step - loss: 0.3618 - acc: 0.8954
Epoch 5/28

167/167 [==============================] - 5s 28ms/step - loss: 0.3009 - acc: 0.9133
Epoch 6/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2611 - acc: 0.9269
Epoch 7/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2370 - acc: 0.9351
Epoch 8/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1976 - acc: 0.9446
Epoch 9/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1721 - acc: 0.9611
Epoch 10/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1536 - acc: 0.9617
Epoch 11/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1378 - acc: 0.9692
Epoch 12/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1258 - acc: 0.9721
Epoch 13/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1230 - acc: 0.9730
Epoch 14/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1078 - acc: 0.9760
Epoch 15/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1005 - acc: 0.9786
Epoch 16/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0901 - acc: 0.9789
Epoch 17/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0850 - acc: 0.9835
Epoch 18/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0726 - acc: 0.9854
Epoch 19/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0721 - acc: 0.9847
Epoch 20/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0657 - acc: 0.9834
Epoch 21/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0667 - acc: 0.9863
Epoch 22/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0640 - acc: 0.9848
Epoch 23/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0545 - acc: 0.9890
Epoch 24/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0508 - acc: 0.9895
Epoch 25/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0469 - acc: 0.9907
Epoch 26/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0451 - acc: 0.9926
Epoch 27/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0414 - acc: 0.9934
Epoch 28/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0391 - acc: 0.9942
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7714
False 1357
True percentage 0.850402381215
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.95      0.95      7318
      B-PER       0.81      0.56      0.66       438
      B-LOC       0.62      0.56      0.59       218
     B-MISC       0.18      0.09      0.12       141
     I-MISC       0.29      0.27      0.28       154
      B-ORG       0.65      0.58      0.61       296
      I-ORG       0.48      0.22      0.30       151
      I-LOC       0.82      0.55      0.66       141
      I-PER       0.93      0.30      0.46       214

avg / total       0.89      0.85      0.86      9071

F-1 Score (without O):
0.519419115164
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 100204 unique words.
Found 94 unique chars.
Found 9 unique labels.
200 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 295
OOV word occurences: 519
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6413120     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,519,682
Trainable params: 6,519,682
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 7s 39ms/step - loss: 1.0026 - acc: 0.7361
Epoch 2/28

167/167 [==============================] - 5s 30ms/step - loss: 0.5690 - acc: 0.8242
Epoch 3/28

167/167 [==============================] - 5s 29ms/step - loss: 0.4287 - acc: 0.8714
Epoch 4/28

167/167 [==============================] - 5s 29ms/step - loss: 0.3541 - acc: 0.8981
Epoch 5/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2906 - acc: 0.9176
Epoch 6/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2448 - acc: 0.9354
Epoch 7/28

167/167 [==============================] - 5s 30ms/step - loss: 0.2178 - acc: 0.9425
Epoch 8/28

167/167 [==============================] - 5s 30ms/step - loss: 0.1852 - acc: 0.9515
Epoch 9/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1628 - acc: 0.9601
Epoch 10/28

167/167 [==============================] - 5s 30ms/step - loss: 0.1485 - acc: 0.9638
Epoch 11/28

167/167 [==============================] - 5s 30ms/step - loss: 0.1392 - acc: 0.9652
Epoch 12/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1192 - acc: 0.9705
Epoch 13/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1076 - acc: 0.9764
Epoch 14/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0991 - acc: 0.9801
Epoch 15/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0882 - acc: 0.9835
Epoch 16/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0972 - acc: 0.9788
Epoch 17/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0791 - acc: 0.9857
Epoch 18/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0741 - acc: 0.9841
Epoch 19/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0648 - acc: 0.9873
Epoch 20/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0599 - acc: 0.9879
Epoch 21/28

167/167 [==============================] - 5s 30ms/step - loss: 0.0515 - acc: 0.9903
Epoch 22/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0517 - acc: 0.9908
Epoch 23/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0465 - acc: 0.9922
Epoch 24/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0450 - acc: 0.9915
Epoch 25/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0460 - acc: 0.9894
Epoch 26/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0393 - acc: 0.9935
Epoch 27/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0361 - acc: 0.9932
Epoch 28/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0360 - acc: 0.9941
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7812
False 1259
True percentage 0.86120604123
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.94      0.96      7318
      B-ORG       0.59      0.49      0.54       296
      I-ORG       0.39      0.36      0.38       151
      B-PER       0.80      0.68      0.74       438
      I-PER       0.86      0.54      0.66       214
      B-LOC       0.76      0.56      0.64       218
      I-LOC       0.76      0.42      0.54       141
     B-MISC       0.29      0.27      0.28       141
     I-MISC       0.36      0.48      0.41       154

avg / total       0.91      0.86      0.88      9071

F-1 Score (without O):
0.562306261624
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 100238 unique words.
Found 94 unique chars.
Found 9 unique labels.
234 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 300
OOV word occurences: 517
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6415296     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,521,858
Trainable params: 6,521,858
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 7s 39ms/step - loss: 0.9730 - acc: 0.7491
Epoch 2/28

167/167 [==============================] - 5s 29ms/step - loss: 0.5681 - acc: 0.8340
Epoch 3/28

167/167 [==============================] - 5s 29ms/step - loss: 0.4205 - acc: 0.8655
Epoch 4/28

167/167 [==============================] - 5s 29ms/step - loss: 0.3568 - acc: 0.8915
Epoch 5/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2930 - acc: 0.9139
Epoch 6/28

167/167 [==============================] - 5s 30ms/step - loss: 0.2506 - acc: 0.9290
Epoch 7/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2278 - acc: 0.9311
Epoch 8/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1921 - acc: 0.9476
Epoch 9/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1705 - acc: 0.9549
Epoch 10/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1522 - acc: 0.9621
Epoch 11/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1349 - acc: 0.9671
Epoch 12/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1246 - acc: 0.9695
Epoch 13/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1138 - acc: 0.9707
Epoch 14/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1012 - acc: 0.9789
Epoch 15/28

167/167 [==============================] - 5s 30ms/step - loss: 0.0921 - acc: 0.9817
Epoch 16/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0855 - acc: 0.9823
Epoch 17/28

167/167 [==============================] - 5s 30ms/step - loss: 0.0800 - acc: 0.9844
Epoch 18/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0755 - acc: 0.9833
Epoch 19/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0712 - acc: 0.9843
Epoch 20/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0651 - acc: 0.9882
Epoch 21/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0581 - acc: 0.9913
Epoch 22/28

167/167 [==============================] - 5s 30ms/step - loss: 0.0547 - acc: 0.9882
Epoch 23/28

167/167 [==============================] - 5s 30ms/step - loss: 0.0521 - acc: 0.9892
Epoch 24/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0464 - acc: 0.9926
Epoch 25/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0480 - acc: 0.9915
Epoch 26/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0419 - acc: 0.9925
Epoch 27/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0387 - acc: 0.9932
Epoch 28/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0361 - acc: 0.9938
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7806
False 1265
True percentage 0.860544592658
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.95      0.96      7318
      B-ORG       0.53      0.48      0.50       296
      I-ORG       0.47      0.36      0.41       151
      B-PER       0.84      0.65      0.73       438
      I-PER       0.80      0.44      0.57       214
     B-MISC       0.15      0.04      0.06       141
     I-MISC       0.30      0.18      0.22       154
      B-LOC       0.65      0.67      0.66       218
      I-LOC       0.65      0.65      0.65       141

avg / total       0.90      0.86      0.87      9071

F-1 Score (without O):
0.547518650665
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 100225 unique words.
Found 94 unique chars.
Found 9 unique labels.
221 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 300
OOV word occurences: 484
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6414464     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,521,026
Trainable params: 6,521,026
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 7s 39ms/step - loss: 0.9986 - acc: 0.7234
Epoch 2/28

167/167 [==============================] - 5s 29ms/step - loss: 0.6106 - acc: 0.8166
Epoch 3/28

167/167 [==============================] - 5s 29ms/step - loss: 0.4825 - acc: 0.8488
Epoch 4/28

167/167 [==============================] - 5s 29ms/step - loss: 0.3962 - acc: 0.8753
Epoch 5/28

167/167 [==============================] - 5s 29ms/step - loss: 0.3398 - acc: 0.8965
Epoch 6/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2898 - acc: 0.9171
Epoch 7/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2482 - acc: 0.9280
Epoch 8/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2313 - acc: 0.9381
Epoch 9/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1895 - acc: 0.9477
Epoch 10/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1689 - acc: 0.9542
Epoch 11/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1570 - acc: 0.9594
Epoch 12/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1349 - acc: 0.9680
Epoch 13/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1233 - acc: 0.9705
Epoch 14/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1118 - acc: 0.9734
Epoch 15/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1009 - acc: 0.9765
Epoch 16/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0889 - acc: 0.9816
Epoch 17/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0856 - acc: 0.9826
Epoch 18/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0799 - acc: 0.9833
Epoch 19/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0688 - acc: 0.9880
Epoch 20/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0671 - acc: 0.9867
Epoch 21/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0624 - acc: 0.9861
Epoch 22/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0598 - acc: 0.9871
Epoch 23/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0564 - acc: 0.9898
Epoch 24/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0515 - acc: 0.9899
Epoch 25/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0487 - acc: 0.9911
Epoch 26/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0477 - acc: 0.9915
Epoch 27/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0425 - acc: 0.9919
Epoch 28/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0412 - acc: 0.9913
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7871
False 1200
True percentage 0.867710285525
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.82      0.65      0.73       438
          O       0.97      0.95      0.96      7318
      B-LOC       0.74      0.64      0.69       218
      B-ORG       0.63      0.70      0.66       296
      I-PER       0.79      0.53      0.63       214
     B-MISC       0.22      0.09      0.12       141
     I-MISC       0.39      0.23      0.29       154
      I-ORG       0.38      0.48      0.42       151
      I-LOC       0.74      0.63      0.68       141

avg / total       0.91      0.87      0.89      9071

F-1 Score (without O):
0.899122807018
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 100206 unique words.
Found 94 unique chars.
Found 9 unique labels.
202 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 303
OOV word occurences: 526
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6413248     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,519,810
Trainable params: 6,519,810
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 7s 39ms/step - loss: 0.9992 - acc: 0.7251
Epoch 2/28

167/167 [==============================] - 5s 29ms/step - loss: 0.5644 - acc: 0.8246
Epoch 3/28

167/167 [==============================] - 5s 29ms/step - loss: 0.4589 - acc: 0.8572
Epoch 4/28

167/167 [==============================] - 5s 29ms/step - loss: 0.3741 - acc: 0.8796
Epoch 5/28

167/167 [==============================] - 5s 29ms/step - loss: 0.3192 - acc: 0.9053
Epoch 6/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2760 - acc: 0.9160
Epoch 7/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2398 - acc: 0.9330
Epoch 8/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2122 - acc: 0.9409
Epoch 9/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1880 - acc: 0.9496
Epoch 10/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1632 - acc: 0.9553
Epoch 11/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1505 - acc: 0.9625
Epoch 12/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1330 - acc: 0.9674
Epoch 13/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1196 - acc: 0.9727
Epoch 14/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1101 - acc: 0.9743
Epoch 15/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0986 - acc: 0.9801
Epoch 16/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0891 - acc: 0.9804
Epoch 17/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0812 - acc: 0.9855
Epoch 18/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0735 - acc: 0.9882
Epoch 19/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0668 - acc: 0.9880
Epoch 20/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0623 - acc: 0.9895
Epoch 21/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0556 - acc: 0.9908
Epoch 22/28

167/167 [==============================] - 5s 30ms/step - loss: 0.0538 - acc: 0.9924
Epoch 23/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0514 - acc: 0.9918
Epoch 24/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0453 - acc: 0.9941
Epoch 25/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0440 - acc: 0.9924
Epoch 26/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0427 - acc: 0.9935
Epoch 27/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0387 - acc: 0.9943
Epoch 28/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0359 - acc: 0.9945
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7799
False 1272
True percentage 0.859772902657
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.94      0.96      7318
     B-MISC       0.34      0.17      0.23       141
      B-ORG       0.63      0.51      0.56       296
     I-MISC       0.36      0.25      0.30       154
      B-LOC       0.64      0.72      0.68       218
      I-ORG       0.44      0.34      0.38       151
      B-PER       0.80      0.59      0.68       438
      I-PER       0.78      0.57      0.66       214
      I-LOC       0.57      0.74      0.65       141

avg / total       0.90      0.86      0.88      9071

F-1 Score (without O):
0.566771159875
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 100194 unique words.
Found 94 unique chars.
Found 9 unique labels.
190 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 299
OOV word occurences: 502
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6412480     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,519,042
Trainable params: 6,519,042
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 6s 39ms/step - loss: 0.9146 - acc: 0.7470
Epoch 2/28

167/167 [==============================] - 5s 28ms/step - loss: 0.5455 - acc: 0.8381
Epoch 3/28

167/167 [==============================] - 5s 29ms/step - loss: 0.4190 - acc: 0.8666
Epoch 4/28

167/167 [==============================] - 5s 29ms/step - loss: 0.3494 - acc: 0.8928
Epoch 5/28

167/167 [==============================] - 5s 29ms/step - loss: 0.3120 - acc: 0.9129
Epoch 6/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2637 - acc: 0.9221
Epoch 7/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2334 - acc: 0.9335
Epoch 8/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2051 - acc: 0.9439
Epoch 9/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1767 - acc: 0.9535
Epoch 10/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1582 - acc: 0.9614
Epoch 11/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1422 - acc: 0.9689
Epoch 12/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1288 - acc: 0.9699
Epoch 13/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1144 - acc: 0.9758
Epoch 14/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1051 - acc: 0.9787
Epoch 15/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0972 - acc: 0.9782
Epoch 16/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0852 - acc: 0.9841
Epoch 17/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0835 - acc: 0.9851
Epoch 18/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0696 - acc: 0.9873
Epoch 19/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0626 - acc: 0.9897
Epoch 20/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0593 - acc: 0.9899
Epoch 21/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0546 - acc: 0.9902
Epoch 22/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0500 - acc: 0.9920
Epoch 23/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0463 - acc: 0.9928
Epoch 24/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0429 - acc: 0.9954
Epoch 25/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0439 - acc: 0.9927
Epoch 26/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0391 - acc: 0.9934
Epoch 27/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0366 - acc: 0.9961
Epoch 28/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0330 - acc: 0.9951
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7854
False 1217
True percentage 0.865836181237
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.73      0.56      0.63       296
          O       0.96      0.95      0.96      7318
     B-MISC       0.27      0.14      0.19       141
     I-MISC       0.30      0.38      0.34       154
      B-LOC       0.75      0.59      0.66       218
      I-LOC       0.77      0.50      0.60       141
      B-PER       0.84      0.69      0.76       438
      I-PER       0.84      0.53      0.65       214
      I-ORG       0.61      0.28      0.38       151

avg / total       0.91      0.87      0.88      9071

F-1 Score (without O):
0.898405094351
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 100169 unique words.
Found 94 unique chars.
Found 9 unique labels.
165 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 299
OOV word occurences: 584
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6410880     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,517,442
Trainable params: 6,517,442
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 7s 40ms/step - loss: 0.9981 - acc: 0.7328
Epoch 2/28

167/167 [==============================] - 5s 30ms/step - loss: 0.5829 - acc: 0.8144
Epoch 3/28

167/167 [==============================] - 5s 29ms/step - loss: 0.4584 - acc: 0.8544
Epoch 4/28

167/167 [==============================] - 5s 30ms/step - loss: 0.3724 - acc: 0.8825
Epoch 5/28

167/167 [==============================] - 5s 30ms/step - loss: 0.3070 - acc: 0.9077
Epoch 6/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2649 - acc: 0.9227
Epoch 7/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2268 - acc: 0.9355
Epoch 8/28

167/167 [==============================] - 5s 30ms/step - loss: 0.2018 - acc: 0.9434
Epoch 9/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1776 - acc: 0.9532
Epoch 10/28

167/167 [==============================] - 5s 30ms/step - loss: 0.1622 - acc: 0.9579
Epoch 11/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1462 - acc: 0.9640
Epoch 12/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1322 - acc: 0.9678
Epoch 13/28

167/167 [==============================] - 5s 30ms/step - loss: 0.1217 - acc: 0.9731
Epoch 14/28

167/167 [==============================] - 5s 30ms/step - loss: 0.1099 - acc: 0.9719
Epoch 15/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1003 - acc: 0.9762
Epoch 16/28

167/167 [==============================] - 5s 30ms/step - loss: 0.0911 - acc: 0.9795
Epoch 17/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0849 - acc: 0.9796
Epoch 18/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0812 - acc: 0.9815
Epoch 19/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0729 - acc: 0.9837
Epoch 20/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0715 - acc: 0.9849
Epoch 21/28

167/167 [==============================] - 5s 30ms/step - loss: 0.0637 - acc: 0.9836
Epoch 22/28

167/167 [==============================] - 5s 30ms/step - loss: 0.0603 - acc: 0.9870
Epoch 23/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0533 - acc: 0.9895
Epoch 24/28

167/167 [==============================] - 5s 30ms/step - loss: 0.0492 - acc: 0.9904
Epoch 25/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0491 - acc: 0.9891
Epoch 26/28

167/167 [==============================] - 5s 30ms/step - loss: 0.0452 - acc: 0.9919
Epoch 27/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0407 - acc: 0.9909
Epoch 28/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0379 - acc: 0.9931
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7695
False 1376
True percentage 0.848307794069
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.94      0.95      7318
      B-PER       0.74      0.51      0.60       438
      B-ORG       0.54      0.49      0.51       296
     B-MISC       0.26      0.18      0.21       141
      I-PER       0.80      0.44      0.57       214
      I-ORG       0.39      0.42      0.40       151
     I-MISC       0.31      0.28      0.29       154
      B-LOC       0.83      0.54      0.65       218
      I-LOC       0.78      0.62      0.69       141

avg / total       0.90      0.85      0.87      9071

F-1 Score (without O):
0.516149870801
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100098 unique words.
Found 94 unique chars.
Found 9 unique labels.
94 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 315
OOV word occurences: 594
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6406336     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,512,898
Trainable params: 6,512,898
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 4s 50ms/step - loss: 1.3529 - acc: 0.6398
Epoch 2/28

83/83 [==============================] - 2s 29ms/step - loss: 0.7609 - acc: 0.7971
Epoch 3/28

83/83 [==============================] - 2s 29ms/step - loss: 0.6294 - acc: 0.8040
Epoch 4/28

83/83 [==============================] - 2s 29ms/step - loss: 0.5231 - acc: 0.8299
Epoch 5/28

83/83 [==============================] - 2s 29ms/step - loss: 0.4592 - acc: 0.8555
Epoch 6/28

83/83 [==============================] - 2s 29ms/step - loss: 0.4150 - acc: 0.8787
Epoch 7/28

83/83 [==============================] - 3s 30ms/step - loss: 0.3558 - acc: 0.8960
Epoch 8/28

83/83 [==============================] - 2s 29ms/step - loss: 0.3079 - acc: 0.9084
Epoch 9/28

83/83 [==============================] - 2s 30ms/step - loss: 0.2884 - acc: 0.9288
Epoch 10/28

83/83 [==============================] - 2s 30ms/step - loss: 0.2480 - acc: 0.9242
Epoch 11/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2191 - acc: 0.9486
Epoch 12/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1967 - acc: 0.9622
Epoch 13/28

83/83 [==============================] - 2s 30ms/step - loss: 0.1878 - acc: 0.9634
Epoch 14/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1612 - acc: 0.9694
Epoch 15/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1490 - acc: 0.9731
Epoch 16/28

83/83 [==============================] - 2s 30ms/step - loss: 0.1301 - acc: 0.9774
Epoch 17/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1250 - acc: 0.9731
Epoch 18/28

83/83 [==============================] - 2s 30ms/step - loss: 0.1125 - acc: 0.9769
Epoch 19/28

83/83 [==============================] - 2s 30ms/step - loss: 0.1013 - acc: 0.9895
Epoch 20/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0975 - acc: 0.9793
Epoch 21/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0835 - acc: 0.9895
Epoch 22/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0833 - acc: 0.9897
Epoch 23/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0776 - acc: 0.9905
Epoch 24/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0708 - acc: 0.9890
Epoch 25/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0710 - acc: 0.9880
Epoch 26/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0627 - acc: 0.9921
Epoch 27/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0614 - acc: 0.9925
Epoch 28/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0503 - acc: 0.9973
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7610
False 1461
True percentage 0.838937272627
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.94      0.94      7318
      B-LOC       0.65      0.57      0.61       218
      I-LOC       0.72      0.56      0.63       141
      B-PER       0.69      0.38      0.49       438
      B-ORG       0.52      0.58      0.55       296
      I-ORG       0.46      0.40      0.43       151
     B-MISC       0.54      0.09      0.16       141
     I-MISC       0.47      0.23      0.31       154
      I-PER       0.62      0.36      0.46       214

avg / total       0.88      0.84      0.85      9071

F-1 Score (without O):
0.490604026846
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 100110 unique words.
Found 94 unique chars.
Found 9 unique labels.
106 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 313
OOV word occurences: 522
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6407104     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,513,666
Trainable params: 6,513,666
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 4s 51ms/step - loss: 1.2495 - acc: 0.6555
Epoch 2/28

83/83 [==============================] - 3s 30ms/step - loss: 0.7186 - acc: 0.8061
Epoch 3/28

83/83 [==============================] - 3s 30ms/step - loss: 0.6146 - acc: 0.8106
Epoch 4/28

83/83 [==============================] - 3s 31ms/step - loss: 0.5249 - acc: 0.8342
Epoch 5/28

83/83 [==============================] - 3s 30ms/step - loss: 0.4476 - acc: 0.8539
Epoch 6/28

83/83 [==============================] - 3s 30ms/step - loss: 0.3879 - acc: 0.8786
Epoch 7/28

83/83 [==============================] - 3s 31ms/step - loss: 0.3530 - acc: 0.8913
Epoch 8/28

83/83 [==============================] - 3s 30ms/step - loss: 0.3048 - acc: 0.9140
Epoch 9/28

83/83 [==============================] - 3s 30ms/step - loss: 0.2812 - acc: 0.9294
Epoch 10/28

83/83 [==============================] - 3s 31ms/step - loss: 0.2471 - acc: 0.9304
Epoch 11/28

83/83 [==============================] - 3s 30ms/step - loss: 0.2216 - acc: 0.9435
Epoch 12/28

83/83 [==============================] - 3s 30ms/step - loss: 0.2042 - acc: 0.9443
Epoch 13/28

83/83 [==============================] - 3s 30ms/step - loss: 0.1948 - acc: 0.9496
Epoch 14/28

83/83 [==============================] - 3s 31ms/step - loss: 0.1746 - acc: 0.9524
Epoch 15/28

83/83 [==============================] - 2s 30ms/step - loss: 0.1617 - acc: 0.9546
Epoch 16/28

83/83 [==============================] - 3s 30ms/step - loss: 0.1507 - acc: 0.9651
Epoch 17/28

83/83 [==============================] - 3s 30ms/step - loss: 0.1454 - acc: 0.9585
Epoch 18/28

83/83 [==============================] - 3s 30ms/step - loss: 0.1240 - acc: 0.9686
Epoch 19/28

83/83 [==============================] - 3s 30ms/step - loss: 0.1215 - acc: 0.9697
Epoch 20/28

83/83 [==============================] - 3s 30ms/step - loss: 0.1159 - acc: 0.9671
Epoch 21/28

83/83 [==============================] - 3s 30ms/step - loss: 0.1098 - acc: 0.9731
Epoch 22/28

83/83 [==============================] - 3s 30ms/step - loss: 0.1034 - acc: 0.9750
Epoch 23/28

83/83 [==============================] - 3s 30ms/step - loss: 0.0930 - acc: 0.9789
Epoch 24/28

83/83 [==============================] - 3s 30ms/step - loss: 0.0943 - acc: 0.9773
Epoch 25/28

83/83 [==============================] - 3s 30ms/step - loss: 0.0875 - acc: 0.9794
Epoch 26/28

83/83 [==============================] - 3s 30ms/step - loss: 0.0761 - acc: 0.9847
Epoch 27/28

83/83 [==============================] - 3s 30ms/step - loss: 0.0772 - acc: 0.9818
Epoch 28/28

83/83 [==============================] - 3s 30ms/step - loss: 0.0748 - acc: 0.9803
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7680
False 1391
True percentage 0.846654172638
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.80      0.63      0.71       438
      I-PER       0.81      0.49      0.61       214
          O       0.94      0.95      0.95      7318
      B-ORG       0.52      0.50      0.51       296
      I-ORG       0.38      0.34      0.36       151
      B-LOC       0.64      0.44      0.52       218
      I-LOC       1.00      0.11      0.20       141
     B-MISC       0.30      0.05      0.09       141
     I-MISC       0.26      0.17      0.20       154

avg / total       0.88      0.85      0.86      9071

F-1 Score (without O):
0.879425041578
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100100 unique words.
Found 94 unique chars.
Found 9 unique labels.
96 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 313
OOV word occurences: 541
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6406464     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,513,026
Trainable params: 6,513,026
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 4s 49ms/step - loss: 1.2160 - acc: 0.6635
Epoch 2/28

83/83 [==============================] - 2s 29ms/step - loss: 0.7207 - acc: 0.8099
Epoch 3/28

83/83 [==============================] - 2s 28ms/step - loss: 0.5920 - acc: 0.8184
Epoch 4/28

83/83 [==============================] - 2s 29ms/step - loss: 0.4884 - acc: 0.8456
Epoch 5/28

83/83 [==============================] - 2s 29ms/step - loss: 0.4211 - acc: 0.8817
Epoch 6/28

83/83 [==============================] - 2s 29ms/step - loss: 0.3727 - acc: 0.8917
Epoch 7/28

83/83 [==============================] - 2s 29ms/step - loss: 0.3226 - acc: 0.9070
Epoch 8/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2909 - acc: 0.9159
Epoch 9/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2618 - acc: 0.9264
Epoch 10/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2445 - acc: 0.9315
Epoch 11/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2181 - acc: 0.9417
Epoch 12/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2074 - acc: 0.9489
Epoch 13/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1792 - acc: 0.9529
Epoch 14/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1641 - acc: 0.9567
Epoch 15/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1562 - acc: 0.9639
Epoch 16/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1400 - acc: 0.9704
Epoch 17/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1264 - acc: 0.9714
Epoch 18/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1207 - acc: 0.9748
Epoch 19/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1178 - acc: 0.9775
Epoch 20/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1049 - acc: 0.9798
Epoch 21/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0967 - acc: 0.9835
Epoch 22/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0900 - acc: 0.9831
Epoch 23/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0798 - acc: 0.9866
Epoch 24/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0879 - acc: 0.9845
Epoch 25/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0726 - acc: 0.9907
Epoch 26/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0671 - acc: 0.9910
Epoch 27/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0595 - acc: 0.9942
Epoch 28/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0598 - acc: 0.9915
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7587
False 1484
True percentage 0.836401719766
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.94      0.94      7318
      B-PER       0.80      0.51      0.62       438
      B-LOC       0.55      0.58      0.56       218
     B-MISC       0.14      0.03      0.05       141
     I-MISC       0.24      0.13      0.17       154
      B-ORG       0.45      0.47      0.46       296
      I-ORG       0.34      0.25      0.28       151
      I-LOC       0.89      0.51      0.65       141
      I-PER       0.75      0.36      0.49       214

avg / total       0.87      0.84      0.85      9071

F-1 Score (without O):
0.46877098724
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 100101 unique words.
Found 94 unique chars.
Found 9 unique labels.
97 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 311
OOV word occurences: 542
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6406528     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,513,090
Trainable params: 6,513,090
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 4s 50ms/step - loss: 1.2374 - acc: 0.6574
Epoch 2/28

83/83 [==============================] - 2s 30ms/step - loss: 0.7615 - acc: 0.7847
Epoch 3/28

83/83 [==============================] - 2s 30ms/step - loss: 0.6394 - acc: 0.8006
Epoch 4/28

83/83 [==============================] - 2s 30ms/step - loss: 0.5148 - acc: 0.8400
Epoch 5/28

83/83 [==============================] - 2s 30ms/step - loss: 0.4399 - acc: 0.8648
Epoch 6/28

83/83 [==============================] - 2s 30ms/step - loss: 0.4134 - acc: 0.8897
Epoch 7/28

83/83 [==============================] - 3s 30ms/step - loss: 0.3432 - acc: 0.9039
Epoch 8/28

83/83 [==============================] - 2s 30ms/step - loss: 0.2979 - acc: 0.9187
Epoch 9/28

83/83 [==============================] - 3s 31ms/step - loss: 0.2649 - acc: 0.9336
Epoch 10/28

83/83 [==============================] - 3s 30ms/step - loss: 0.2414 - acc: 0.9347
Epoch 11/28

83/83 [==============================] - 2s 30ms/step - loss: 0.2080 - acc: 0.9429
Epoch 12/28

83/83 [==============================] - 3s 30ms/step - loss: 0.2011 - acc: 0.9440
Epoch 13/28

83/83 [==============================] - 2s 30ms/step - loss: 0.1779 - acc: 0.9537
Epoch 14/28

83/83 [==============================] - 2s 30ms/step - loss: 0.1622 - acc: 0.9628
Epoch 15/28

83/83 [==============================] - 3s 30ms/step - loss: 0.1581 - acc: 0.9619
Epoch 16/28

83/83 [==============================] - 2s 30ms/step - loss: 0.1417 - acc: 0.9599
Epoch 17/28

83/83 [==============================] - 2s 30ms/step - loss: 0.1267 - acc: 0.9717
Epoch 18/28

83/83 [==============================] - 2s 30ms/step - loss: 0.1165 - acc: 0.9761
Epoch 19/28

83/83 [==============================] - 2s 30ms/step - loss: 0.1149 - acc: 0.9728
Epoch 20/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0976 - acc: 0.9835
Epoch 21/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0917 - acc: 0.9880
Epoch 22/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0857 - acc: 0.9853
Epoch 23/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0821 - acc: 0.9885
Epoch 24/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0743 - acc: 0.9876
Epoch 25/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0754 - acc: 0.9847
Epoch 26/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0690 - acc: 0.9881
Epoch 27/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0641 - acc: 0.9920
Epoch 28/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0550 - acc: 0.9947
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7734
False 1337
True percentage 0.852607209789
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.94      0.95      7318
      B-ORG       0.55      0.55      0.55       296
      I-ORG       0.43      0.39      0.41       151
      B-PER       0.84      0.57      0.68       438
      I-PER       0.71      0.48      0.57       214
      B-LOC       0.73      0.55      0.63       218
      I-LOC       0.86      0.40      0.54       141
     B-MISC       0.30      0.09      0.14       141
     I-MISC       0.42      0.38      0.40       154

avg / total       0.89      0.85      0.87      9071

F-1 Score (without O):
0.540362438221
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 100119 unique words.
Found 94 unique chars.
Found 9 unique labels.
115 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 311
OOV word occurences: 550
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6407680     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,514,242
Trainable params: 6,514,242
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 4s 50ms/step - loss: 1.1466 - acc: 0.7280
Epoch 2/28

83/83 [==============================] - 3s 30ms/step - loss: 0.6741 - acc: 0.8259
Epoch 3/28

83/83 [==============================] - 3s 30ms/step - loss: 0.5502 - acc: 0.8285
Epoch 4/28

83/83 [==============================] - 2s 30ms/step - loss: 0.4564 - acc: 0.8619
Epoch 5/28

83/83 [==============================] - 3s 30ms/step - loss: 0.3808 - acc: 0.8781
Epoch 6/28

83/83 [==============================] - 3s 30ms/step - loss: 0.3308 - acc: 0.8951
Epoch 7/28

83/83 [==============================] - 3s 30ms/step - loss: 0.2947 - acc: 0.9008
Epoch 8/28

83/83 [==============================] - 3s 30ms/step - loss: 0.2571 - acc: 0.9272
Epoch 9/28

83/83 [==============================] - 2s 30ms/step - loss: 0.2330 - acc: 0.9347
Epoch 10/28

83/83 [==============================] - 3s 30ms/step - loss: 0.2087 - acc: 0.9453
Epoch 11/28

83/83 [==============================] - 3s 31ms/step - loss: 0.1938 - acc: 0.9450
Epoch 12/28

83/83 [==============================] - 3s 30ms/step - loss: 0.1827 - acc: 0.9602
Epoch 13/28

83/83 [==============================] - 3s 30ms/step - loss: 0.1573 - acc: 0.9610
Epoch 14/28

83/83 [==============================] - 2s 30ms/step - loss: 0.1481 - acc: 0.9692
Epoch 15/28

83/83 [==============================] - 3s 30ms/step - loss: 0.1342 - acc: 0.9713
Epoch 16/28

83/83 [==============================] - 2s 30ms/step - loss: 0.1256 - acc: 0.9730
Epoch 17/28

83/83 [==============================] - 3s 30ms/step - loss: 0.1187 - acc: 0.9790
Epoch 18/28

83/83 [==============================] - 3s 30ms/step - loss: 0.1059 - acc: 0.9799
Epoch 19/28

83/83 [==============================] - 3s 30ms/step - loss: 0.1061 - acc: 0.9787
Epoch 20/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0936 - acc: 0.9838
Epoch 21/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0872 - acc: 0.9852
Epoch 22/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0807 - acc: 0.9843
Epoch 23/28

83/83 [==============================] - 3s 31ms/step - loss: 0.0789 - acc: 0.9878
Epoch 24/28

83/83 [==============================] - 3s 30ms/step - loss: 0.0730 - acc: 0.9887
Epoch 25/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0672 - acc: 0.9875
Epoch 26/28

83/83 [==============================] - 3s 30ms/step - loss: 0.0656 - acc: 0.9894
Epoch 27/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0606 - acc: 0.9897
Epoch 28/28

83/83 [==============================] - 3s 30ms/step - loss: 0.0569 - acc: 0.9927
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7656
False 1415
True percentage 0.844008378349
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.94      0.95      7318
      B-ORG       0.49      0.48      0.48       296
      I-ORG       0.57      0.28      0.38       151
      B-PER       0.79      0.62      0.70       438
      I-PER       0.79      0.44      0.56       214
     B-MISC       0.07      0.04      0.05       141
     I-MISC       0.17      0.07      0.10       154
      B-LOC       0.72      0.40      0.52       218
      I-LOC       0.52      0.60      0.56       141

avg / total       0.88      0.84      0.86      9071

F-1 Score (without O):
0.492358803987
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 100126 unique words.
Found 94 unique chars.
Found 9 unique labels.
122 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 309
OOV word occurences: 506
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6408128     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,514,690
Trainable params: 6,514,690
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 4s 51ms/step - loss: 1.2814 - acc: 0.6622
Epoch 2/28

83/83 [==============================] - 3s 30ms/step - loss: 0.6598 - acc: 0.8152
Epoch 3/28

83/83 [==============================] - 3s 30ms/step - loss: 0.5479 - acc: 0.8316
Epoch 4/28

83/83 [==============================] - 2s 30ms/step - loss: 0.4347 - acc: 0.8688
Epoch 5/28

83/83 [==============================] - 2s 30ms/step - loss: 0.3886 - acc: 0.8854
Epoch 6/28

83/83 [==============================] - 3s 30ms/step - loss: 0.3385 - acc: 0.9048
Epoch 7/28

83/83 [==============================] - 3s 31ms/step - loss: 0.3012 - acc: 0.9230
Epoch 8/28

83/83 [==============================] - 2s 30ms/step - loss: 0.2602 - acc: 0.9349
Epoch 9/28

83/83 [==============================] - 3s 30ms/step - loss: 0.2409 - acc: 0.9390
Epoch 10/28

83/83 [==============================] - 3s 30ms/step - loss: 0.2181 - acc: 0.9436
Epoch 11/28

83/83 [==============================] - 3s 30ms/step - loss: 0.2004 - acc: 0.9526
Epoch 12/28

83/83 [==============================] - 3s 30ms/step - loss: 0.1762 - acc: 0.9556
Epoch 13/28

83/83 [==============================] - 2s 30ms/step - loss: 0.1591 - acc: 0.9561
Epoch 14/28

83/83 [==============================] - 3s 30ms/step - loss: 0.1512 - acc: 0.9644
Epoch 15/28

83/83 [==============================] - 2s 30ms/step - loss: 0.1352 - acc: 0.9634
Epoch 16/28

83/83 [==============================] - 2s 30ms/step - loss: 0.1237 - acc: 0.9711
Epoch 17/28

83/83 [==============================] - 3s 30ms/step - loss: 0.1180 - acc: 0.9695
Epoch 18/28

83/83 [==============================] - 3s 30ms/step - loss: 0.1066 - acc: 0.9741
Epoch 19/28

83/83 [==============================] - 2s 30ms/step - loss: 0.1002 - acc: 0.9763
Epoch 20/28

83/83 [==============================] - 3s 30ms/step - loss: 0.0918 - acc: 0.9770
Epoch 21/28

83/83 [==============================] - 3s 30ms/step - loss: 0.0849 - acc: 0.9799
Epoch 22/28

83/83 [==============================] - 3s 31ms/step - loss: 0.0804 - acc: 0.9833
Epoch 23/28

83/83 [==============================] - 3s 30ms/step - loss: 0.0818 - acc: 0.9838
Epoch 24/28

83/83 [==============================] - 3s 30ms/step - loss: 0.0720 - acc: 0.9898
Epoch 25/28

83/83 [==============================] - 3s 30ms/step - loss: 0.0628 - acc: 0.9923
Epoch 26/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0615 - acc: 0.9919
Epoch 27/28

83/83 [==============================] - 3s 30ms/step - loss: 0.0570 - acc: 0.9915
Epoch 28/28

83/83 [==============================] - 3s 30ms/step - loss: 0.0534 - acc: 0.9938
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7644
False 1427
True percentage 0.842685481204
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.79      0.58      0.67       438
          O       0.94      0.95      0.95      7318
      B-LOC       0.70      0.43      0.53       218
      B-ORG       0.63      0.59      0.61       296
      I-PER       0.60      0.44      0.51       214
     B-MISC       0.10      0.02      0.04       141
     I-MISC       0.33      0.09      0.14       154
      I-ORG       0.18      0.23      0.20       151
      I-LOC       0.73      0.27      0.39       141

avg / total       0.87      0.84      0.85      9071

F-1 Score (without O):
0.875851851852
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 100098 unique words.
Found 94 unique chars.
Found 9 unique labels.
94 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 317
OOV word occurences: 615
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6406336     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,512,898
Trainable params: 6,512,898
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 4s 50ms/step - loss: 1.2494 - acc: 0.6638
Epoch 2/28

83/83 [==============================] - 2s 29ms/step - loss: 0.7442 - acc: 0.8110
Epoch 3/28

83/83 [==============================] - 2s 29ms/step - loss: 0.5696 - acc: 0.8241
Epoch 4/28

83/83 [==============================] - 2s 29ms/step - loss: 0.4810 - acc: 0.8418
Epoch 5/28

83/83 [==============================] - 2s 29ms/step - loss: 0.4133 - acc: 0.8639
Epoch 6/28

83/83 [==============================] - 2s 30ms/step - loss: 0.3789 - acc: 0.8815
Epoch 7/28

83/83 [==============================] - 2s 30ms/step - loss: 0.3194 - acc: 0.9049
Epoch 8/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2823 - acc: 0.9188
Epoch 9/28

83/83 [==============================] - 2s 30ms/step - loss: 0.2519 - acc: 0.9296
Epoch 10/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2273 - acc: 0.9362
Epoch 11/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2048 - acc: 0.9445
Epoch 12/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1949 - acc: 0.9410
Epoch 13/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1680 - acc: 0.9626
Epoch 14/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1740 - acc: 0.9659
Epoch 15/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1440 - acc: 0.9636
Epoch 16/28

83/83 [==============================] - 2s 30ms/step - loss: 0.1315 - acc: 0.9755
Epoch 17/28

83/83 [==============================] - 2s 30ms/step - loss: 0.1169 - acc: 0.9807
Epoch 18/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1097 - acc: 0.9811
Epoch 19/28

83/83 [==============================] - 2s 30ms/step - loss: 0.1023 - acc: 0.9836
Epoch 20/28

83/83 [==============================] - 3s 30ms/step - loss: 0.0966 - acc: 0.9832
Epoch 21/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0860 - acc: 0.9873
Epoch 22/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0860 - acc: 0.9838
Epoch 23/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0790 - acc: 0.9892
Epoch 24/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0718 - acc: 0.9920
Epoch 25/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0659 - acc: 0.9919
Epoch 26/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0663 - acc: 0.9872
Epoch 27/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0596 - acc: 0.9913
Epoch 28/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0551 - acc: 0.9935
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7551
False 1520
True percentage 0.832433028332
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.95      0.95      7318
     B-MISC       0.06      0.01      0.02       141
      B-ORG       0.44      0.42      0.43       296
     I-MISC       0.36      0.18      0.24       154
      B-LOC       0.64      0.59      0.61       218
      I-ORG       0.34      0.20      0.25       151
      B-PER       0.70      0.44      0.54       438
      I-PER       0.63      0.31      0.41       214
      I-LOC       0.72      0.40      0.51       141

avg / total       0.87      0.83      0.84      9071

F-1 Score (without O):
0.434060228453
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 100112 unique words.
Found 94 unique chars.
Found 9 unique labels.
108 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 315
OOV word occurences: 610
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6407232     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,513,794
Trainable params: 6,513,794
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 4s 49ms/step - loss: 1.2267 - acc: 0.6789
Epoch 2/28

83/83 [==============================] - 2s 29ms/step - loss: 0.6986 - acc: 0.8221
Epoch 3/28

83/83 [==============================] - 2s 28ms/step - loss: 0.5675 - acc: 0.8246
Epoch 4/28

83/83 [==============================] - 2s 29ms/step - loss: 0.4938 - acc: 0.8495
Epoch 5/28

83/83 [==============================] - 2s 28ms/step - loss: 0.4225 - acc: 0.8645
Epoch 6/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3824 - acc: 0.8798
Epoch 7/28

83/83 [==============================] - 2s 29ms/step - loss: 0.3239 - acc: 0.8984
Epoch 8/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2972 - acc: 0.9249
Epoch 9/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2591 - acc: 0.9362
Epoch 10/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2393 - acc: 0.9399
Epoch 11/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2154 - acc: 0.9476
Epoch 12/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1911 - acc: 0.9536
Epoch 13/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1762 - acc: 0.9555
Epoch 14/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1688 - acc: 0.9623
Epoch 15/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1477 - acc: 0.9646
Epoch 16/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1415 - acc: 0.9726
Epoch 17/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1203 - acc: 0.9809
Epoch 18/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1121 - acc: 0.9811
Epoch 19/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1055 - acc: 0.9821
Epoch 20/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0962 - acc: 0.9830
Epoch 21/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0972 - acc: 0.9830
Epoch 22/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0822 - acc: 0.9869
Epoch 23/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0786 - acc: 0.9882
Epoch 24/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0787 - acc: 0.9876
Epoch 25/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0708 - acc: 0.9903
Epoch 26/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0669 - acc: 0.9911
Epoch 27/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0610 - acc: 0.9912
Epoch 28/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0587 - acc: 0.9916
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7481
False 1590
True percentage 0.824716128321
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.52      0.42      0.46       296
          O       0.93      0.95      0.94      7318
     B-MISC       0.12      0.06      0.08       141
     I-MISC       0.25      0.23      0.24       154
      B-LOC       0.61      0.37      0.46       218
      I-LOC       0.77      0.07      0.13       141
      B-PER       0.71      0.49      0.58       438
      I-PER       0.71      0.31      0.44       214
      I-ORG       0.62      0.15      0.24       151

avg / total       0.86      0.82      0.83      9071

F-1 Score (without O):
0.865631250735
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 100094 unique words.
Found 94 unique chars.
Found 9 unique labels.
90 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 312
OOV word occurences: 614
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6406080     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,512,642
Trainable params: 6,512,642
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 4s 50ms/step - loss: 1.0930 - acc: 0.7363
Epoch 2/28

83/83 [==============================] - 2s 29ms/step - loss: 0.6492 - acc: 0.8216
Epoch 3/28

83/83 [==============================] - 2s 29ms/step - loss: 0.5157 - acc: 0.8468
Epoch 4/28

83/83 [==============================] - 2s 30ms/step - loss: 0.4455 - acc: 0.8588
Epoch 5/28

83/83 [==============================] - 2s 29ms/step - loss: 0.3852 - acc: 0.8860
Epoch 6/28

83/83 [==============================] - 2s 29ms/step - loss: 0.3642 - acc: 0.8894
Epoch 7/28

83/83 [==============================] - 2s 29ms/step - loss: 0.3172 - acc: 0.8973
Epoch 8/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2790 - acc: 0.9078
Epoch 9/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2556 - acc: 0.9237
Epoch 10/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2297 - acc: 0.9255
Epoch 11/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2156 - acc: 0.9355
Epoch 12/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1940 - acc: 0.9434
Epoch 13/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1800 - acc: 0.9480
Epoch 14/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1537 - acc: 0.9691
Epoch 15/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1406 - acc: 0.9681
Epoch 16/28

83/83 [==============================] - 2s 30ms/step - loss: 0.1252 - acc: 0.9806
Epoch 17/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1142 - acc: 0.9781
Epoch 18/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1018 - acc: 0.9844
Epoch 19/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0898 - acc: 0.9918
Epoch 20/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0849 - acc: 0.9901
Epoch 21/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0819 - acc: 0.9909
Epoch 22/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0733 - acc: 0.9919
Epoch 23/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0659 - acc: 0.9952
Epoch 24/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0639 - acc: 0.9932
Epoch 25/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0583 - acc: 0.9938
Epoch 26/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0543 - acc: 0.9943
Epoch 27/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0502 - acc: 0.9953
Epoch 28/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0464 - acc: 0.9970
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7537
False 1534
True percentage 0.83088964833
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.93      0.95      7318
      B-PER       0.69      0.44      0.54       438
      B-ORG       0.46      0.48      0.47       296
     B-MISC       0.29      0.10      0.15       141
      I-PER       0.74      0.38      0.50       214
      I-ORG       0.38      0.36      0.37       151
     I-MISC       0.24      0.11      0.15       154
      B-LOC       0.71      0.50      0.59       218
      I-LOC       0.39      0.70      0.51       141

avg / total       0.88      0.83      0.85      9071

F-1 Score (without O):
0.455566249599
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100039 unique words.
Found 93 unique chars.
Found 9 unique labels.
35 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 322
OOV word occurences: 617
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6402560     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,509,058
Trainable params: 6,509,058
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 3s 83ms/step - loss: 1.8673 - acc: 0.4018
Epoch 2/28

33/33 [==============================] - 1s 31ms/step - loss: 0.9774 - acc: 0.7795
Epoch 3/28

33/33 [==============================] - 1s 32ms/step - loss: 0.8791 - acc: 0.7779
Epoch 4/28

33/33 [==============================] - 1s 32ms/step - loss: 0.7904 - acc: 0.7808
Epoch 5/28

33/33 [==============================] - 1s 32ms/step - loss: 0.7051 - acc: 0.7872
Epoch 6/28

33/33 [==============================] - 1s 32ms/step - loss: 0.6490 - acc: 0.7849
Epoch 7/28

33/33 [==============================] - 1s 31ms/step - loss: 0.5783 - acc: 0.7895
Epoch 8/28

33/33 [==============================] - 1s 31ms/step - loss: 0.5417 - acc: 0.8181
Epoch 9/28

33/33 [==============================] - 1s 32ms/step - loss: 0.4832 - acc: 0.8430
Epoch 10/28

33/33 [==============================] - 1s 31ms/step - loss: 0.4307 - acc: 0.8590
Epoch 11/28

33/33 [==============================] - 1s 32ms/step - loss: 0.4413 - acc: 0.8760
Epoch 12/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3859 - acc: 0.8774
Epoch 13/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3534 - acc: 0.9012
Epoch 14/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3379 - acc: 0.8972
Epoch 15/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3030 - acc: 0.9180
Epoch 16/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2848 - acc: 0.9259
Epoch 17/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3115 - acc: 0.9062
Epoch 18/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2635 - acc: 0.9293
Epoch 19/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2438 - acc: 0.9324
Epoch 20/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2269 - acc: 0.9292
Epoch 21/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2021 - acc: 0.9471
Epoch 22/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2025 - acc: 0.9426
Epoch 23/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2001 - acc: 0.9475
Epoch 24/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1892 - acc: 0.9598
Epoch 25/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1814 - acc: 0.9570
Epoch 26/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1612 - acc: 0.9813
Epoch 27/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1695 - acc: 0.9686
Epoch 28/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1486 - acc: 0.9674
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7409
False 1662
True percentage 0.816778745453
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.92      0.95      0.93      7318
      B-LOC       0.70      0.40      0.51       218
      I-LOC       0.67      0.48      0.56       141
      B-PER       0.65      0.31      0.42       438
      B-ORG       0.41      0.43      0.42       296
      I-ORG       0.38      0.28      0.32       151
     B-MISC       0.08      0.01      0.02       141
     I-MISC       0.45      0.09      0.15       154
      I-PER       0.86      0.09      0.16       214

avg / total       0.85      0.82      0.82      9071

F-1 Score (without O):
0.36681547619
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 100047 unique words.
Found 94 unique chars.
Found 9 unique labels.
43 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 320
OOV word occurences: 539
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6403072     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,509,634
Trainable params: 6,509,634
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 3s 83ms/step - loss: 1.8297 - acc: 0.3855
Epoch 2/28

33/33 [==============================] - 1s 31ms/step - loss: 0.9080 - acc: 0.7729
Epoch 3/28

33/33 [==============================] - 1s 32ms/step - loss: 0.9339 - acc: 0.7754
Epoch 4/28

33/33 [==============================] - 1s 31ms/step - loss: 0.7358 - acc: 0.7727
Epoch 5/28

33/33 [==============================] - 1s 32ms/step - loss: 0.6837 - acc: 0.7892
Epoch 6/28

33/33 [==============================] - 1s 32ms/step - loss: 0.6278 - acc: 0.8000
Epoch 7/28

33/33 [==============================] - 1s 32ms/step - loss: 0.5832 - acc: 0.8065
Epoch 8/28

33/33 [==============================] - 1s 32ms/step - loss: 0.5390 - acc: 0.8275
Epoch 9/28

33/33 [==============================] - 1s 32ms/step - loss: 0.5076 - acc: 0.8315
Epoch 10/28

33/33 [==============================] - 1s 32ms/step - loss: 0.4629 - acc: 0.8664
Epoch 11/28

33/33 [==============================] - 1s 31ms/step - loss: 0.4332 - acc: 0.8729
Epoch 12/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3965 - acc: 0.8864
Epoch 13/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3869 - acc: 0.9068
Epoch 14/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3596 - acc: 0.9056
Epoch 15/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3361 - acc: 0.9087
Epoch 16/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3084 - acc: 0.9317
Epoch 17/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2964 - acc: 0.9175
Epoch 18/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3065 - acc: 0.9385
Epoch 19/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2688 - acc: 0.9363
Epoch 20/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2475 - acc: 0.9486
Epoch 21/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2356 - acc: 0.9389
Epoch 22/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2259 - acc: 0.9480
Epoch 23/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2148 - acc: 0.9438
Epoch 24/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2050 - acc: 0.9534
Epoch 25/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2327 - acc: 0.9311
Epoch 26/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1858 - acc: 0.9550
Epoch 27/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1710 - acc: 0.9551
Epoch 28/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1689 - acc: 0.9565
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7379
False 1692
True percentage 0.813471502591
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.62      0.35      0.45       438
      I-PER       0.68      0.28      0.39       214
          O       0.89      0.95      0.92      7318
      B-ORG       0.51      0.36      0.42       296
      I-ORG       0.39      0.31      0.35       151
      B-LOC       0.95      0.19      0.32       218
      I-LOC       1.00      0.01      0.01       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.21      0.02      0.04       154

avg / total       0.83      0.81      0.80      9071

F-1 Score (without O):
0.854254124047
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100037 unique words.
Found 92 unique chars.
Found 9 unique labels.
33 unique words not found in embedding.
8 unique chars not found in embedding.
Number of OOV: 322
OOV word occurences: 564
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6402432     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,508,866
Trainable params: 6,508,866
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 3s 84ms/step - loss: 1.7307 - acc: 0.4678
Epoch 2/28

33/33 [==============================] - 1s 31ms/step - loss: 0.8674 - acc: 0.7924
Epoch 3/28

33/33 [==============================] - 1s 32ms/step - loss: 0.8207 - acc: 0.7990
Epoch 4/28

33/33 [==============================] - 1s 32ms/step - loss: 0.7142 - acc: 0.7941
Epoch 5/28

33/33 [==============================] - 1s 31ms/step - loss: 0.6550 - acc: 0.7944
Epoch 6/28

33/33 [==============================] - 1s 31ms/step - loss: 0.5894 - acc: 0.8019
Epoch 7/28

33/33 [==============================] - 1s 31ms/step - loss: 0.5440 - acc: 0.8246
Epoch 8/28

33/33 [==============================] - 1s 32ms/step - loss: 0.5080 - acc: 0.8491
Epoch 9/28

33/33 [==============================] - 1s 31ms/step - loss: 0.4753 - acc: 0.8869
Epoch 10/28

33/33 [==============================] - 1s 32ms/step - loss: 0.4263 - acc: 0.8850
Epoch 11/28

33/33 [==============================] - 1s 32ms/step - loss: 0.4217 - acc: 0.8955
Epoch 12/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3776 - acc: 0.8874
Epoch 13/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3568 - acc: 0.8968
Epoch 14/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3416 - acc: 0.9056
Epoch 15/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3319 - acc: 0.9096
Epoch 16/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3280 - acc: 0.9331
Epoch 17/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2896 - acc: 0.9321
Epoch 18/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2851 - acc: 0.9305
Epoch 19/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2663 - acc: 0.9408
Epoch 20/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2602 - acc: 0.9327
Epoch 21/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2461 - acc: 0.9435
Epoch 22/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2290 - acc: 0.9409
Epoch 23/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2267 - acc: 0.9414
Epoch 24/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2215 - acc: 0.9473
Epoch 25/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1966 - acc: 0.9539
Epoch 26/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1907 - acc: 0.9558
Epoch 27/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1792 - acc: 0.9544
Epoch 28/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1734 - acc: 0.9543
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7303
False 1768
True percentage 0.805093154007
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.93      0.93      7318
      B-PER       0.70      0.46      0.55       438
      B-LOC       0.67      0.28      0.39       218
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-ORG       0.34      0.58      0.43       296
      I-ORG       0.17      0.42      0.25       151
      I-LOC       0.00      0.00      0.00       141
      I-PER       1.00      0.03      0.05       214

avg / total       0.84      0.81      0.81      9071

F-1 Score (without O):
0.333778371162
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 100050 unique words.
Found 94 unique chars.
Found 9 unique labels.
46 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 319
OOV word occurences: 620
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6403264     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,509,826
Trainable params: 6,509,826
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 3s 85ms/step - loss: 1.7405 - acc: 0.4959
Epoch 2/28

33/33 [==============================] - 1s 31ms/step - loss: 1.0011 - acc: 0.7876
Epoch 3/28

33/33 [==============================] - 1s 31ms/step - loss: 0.8452 - acc: 0.7870
Epoch 4/28

33/33 [==============================] - 1s 32ms/step - loss: 0.7665 - acc: 0.7858
Epoch 5/28

33/33 [==============================] - 1s 32ms/step - loss: 0.7151 - acc: 0.7843
Epoch 6/28

33/33 [==============================] - 1s 32ms/step - loss: 0.6532 - acc: 0.7910
Epoch 7/28

33/33 [==============================] - 1s 32ms/step - loss: 0.6216 - acc: 0.7917
Epoch 8/28

33/33 [==============================] - 1s 31ms/step - loss: 0.6209 - acc: 0.8021
Epoch 9/28

33/33 [==============================] - 1s 31ms/step - loss: 0.5440 - acc: 0.8130
Epoch 10/28

33/33 [==============================] - 1s 31ms/step - loss: 0.4972 - acc: 0.8293
Epoch 11/28

33/33 [==============================] - 1s 32ms/step - loss: 0.4550 - acc: 0.8446
Epoch 12/28

33/33 [==============================] - 1s 31ms/step - loss: 0.4343 - acc: 0.8492
Epoch 13/28

33/33 [==============================] - 1s 30ms/step - loss: 0.4029 - acc: 0.8676
Epoch 14/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3965 - acc: 0.8767
Epoch 15/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3625 - acc: 0.8896
Epoch 16/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3591 - acc: 0.9031
Epoch 17/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3310 - acc: 0.9112
Epoch 18/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3465 - acc: 0.9351
Epoch 19/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2932 - acc: 0.9215
Epoch 20/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2767 - acc: 0.9230
Epoch 21/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2745 - acc: 0.9258
Epoch 22/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2453 - acc: 0.9384
Epoch 23/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2411 - acc: 0.9408
Epoch 24/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2284 - acc: 0.9447
Epoch 25/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2155 - acc: 0.9376
Epoch 26/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2060 - acc: 0.9524
Epoch 27/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2028 - acc: 0.9520
Epoch 28/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1731 - acc: 0.9631
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7257
False 1814
True percentage 0.800022048286
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.92      0.93      0.92      7318
      B-ORG       0.33      0.41      0.36       296
      I-ORG       0.41      0.20      0.27       151
      B-PER       0.82      0.36      0.50       438
      I-PER       0.54      0.29      0.37       214
      B-LOC       1.00      0.19      0.32       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.16      0.24      0.19       154

avg / total       0.84      0.80      0.80      9071

F-1 Score (without O):
0.323210412148
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 100046 unique words.
Found 93 unique chars.
Found 9 unique labels.
42 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 321
OOV word occurences: 563
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6403008     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,509,506
Trainable params: 6,509,506
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 3s 84ms/step - loss: 1.6320 - acc: 0.4949
Epoch 2/28

33/33 [==============================] - 1s 32ms/step - loss: 0.8599 - acc: 0.8048
Epoch 3/28

33/33 [==============================] - 1s 32ms/step - loss: 0.7539 - acc: 0.8056
Epoch 4/28

33/33 [==============================] - 1s 32ms/step - loss: 0.7010 - acc: 0.8052
Epoch 5/28

33/33 [==============================] - 1s 31ms/step - loss: 0.6207 - acc: 0.8065
Epoch 6/28

33/33 [==============================] - 1s 31ms/step - loss: 0.5814 - acc: 0.8027
Epoch 7/28

33/33 [==============================] - 1s 31ms/step - loss: 0.5369 - acc: 0.8124
Epoch 8/28

33/33 [==============================] - 1s 31ms/step - loss: 0.4846 - acc: 0.8311
Epoch 9/28

33/33 [==============================] - 1s 31ms/step - loss: 0.4414 - acc: 0.8564
Epoch 10/28

33/33 [==============================] - 1s 31ms/step - loss: 0.4094 - acc: 0.8539
Epoch 11/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3717 - acc: 0.8891
Epoch 12/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3633 - acc: 0.8800
Epoch 13/28

33/33 [==============================] - 1s 30ms/step - loss: 0.3358 - acc: 0.8958
Epoch 14/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3503 - acc: 0.8913
Epoch 15/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3238 - acc: 0.8873
Epoch 16/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2891 - acc: 0.9031
Epoch 17/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2729 - acc: 0.9208
Epoch 18/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2606 - acc: 0.9177
Epoch 19/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2472 - acc: 0.9221
Epoch 20/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2313 - acc: 0.9301
Epoch 21/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2121 - acc: 0.9660
Epoch 22/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2088 - acc: 0.9553
Epoch 23/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1982 - acc: 0.9745
Epoch 24/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1817 - acc: 0.9620
Epoch 25/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1776 - acc: 0.9733
Epoch 26/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1682 - acc: 0.9739
Epoch 27/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1515 - acc: 0.9733
Epoch 28/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1523 - acc: 0.9765
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7420
False 1651
True percentage 0.817991401169
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.92      0.95      0.93      7318
      B-ORG       0.48      0.30      0.37       296
      I-ORG       0.38      0.21      0.27       151
      B-PER       0.70      0.46      0.56       438
      I-PER       0.84      0.23      0.36       214
     B-MISC       0.11      0.08      0.09       141
     I-MISC       0.12      0.03      0.04       154
      B-LOC       0.49      0.39      0.43       218
      I-LOC       0.65      0.18      0.29       141

avg / total       0.84      0.82      0.82      9071

F-1 Score (without O):
0.366911764706
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 100063 unique words.
Found 94 unique chars.
Found 9 unique labels.
59 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 320
OOV word occurences: 604
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6404096     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,510,658
Trainable params: 6,510,658
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 3s 82ms/step - loss: 1.7944 - acc: 0.4040
Epoch 2/28

33/33 [==============================] - 1s 31ms/step - loss: 0.9183 - acc: 0.7918
Epoch 3/28

33/33 [==============================] - 1s 32ms/step - loss: 0.8586 - acc: 0.8010
Epoch 4/28

33/33 [==============================] - 1s 31ms/step - loss: 0.7564 - acc: 0.7975
Epoch 5/28

33/33 [==============================] - 1s 31ms/step - loss: 0.6694 - acc: 0.7998
Epoch 6/28

33/33 [==============================] - 1s 31ms/step - loss: 0.6109 - acc: 0.8100
Epoch 7/28

33/33 [==============================] - 1s 31ms/step - loss: 0.5821 - acc: 0.8098
Epoch 8/28

33/33 [==============================] - 1s 31ms/step - loss: 0.5232 - acc: 0.8270
Epoch 9/28

33/33 [==============================] - 1s 31ms/step - loss: 0.4943 - acc: 0.8393
Epoch 10/28

33/33 [==============================] - 1s 31ms/step - loss: 0.5124 - acc: 0.8710
Epoch 11/28

33/33 [==============================] - 1s 31ms/step - loss: 0.4168 - acc: 0.8707
Epoch 12/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3872 - acc: 0.8705
Epoch 13/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3690 - acc: 0.8865
Epoch 14/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3667 - acc: 0.9066
Epoch 15/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3512 - acc: 0.8900
Epoch 16/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3164 - acc: 0.8926
Epoch 17/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3028 - acc: 0.9081
Epoch 18/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2829 - acc: 0.9199
Epoch 19/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2732 - acc: 0.9267
Epoch 20/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2586 - acc: 0.9251
Epoch 21/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2667 - acc: 0.9165
Epoch 22/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2377 - acc: 0.9364
Epoch 23/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2324 - acc: 0.9473
Epoch 24/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2191 - acc: 0.9531
Epoch 25/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2016 - acc: 0.9576
Epoch 26/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2025 - acc: 0.9685
Epoch 27/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1792 - acc: 0.9685
Epoch 28/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1815 - acc: 0.9614
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7366
False 1705
True percentage 0.812038364017
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.67      0.34      0.45       438
          O       0.91      0.95      0.93      7318
      B-LOC       0.54      0.27      0.36       218
      B-ORG       0.42      0.51      0.46       296
      I-PER       0.68      0.18      0.28       214
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.14      0.01      0.01       154
      I-ORG       0.24      0.12      0.16       151
      I-LOC       0.00      0.00      0.00       141

avg / total       0.82      0.81      0.80      9071

F-1 Score (without O):
0.855263937437
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 100036 unique words.
Found 93 unique chars.
Found 9 unique labels.
32 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 323
OOV word occurences: 623
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6402368     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,508,866
Trainable params: 6,508,866
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 3s 85ms/step - loss: 1.7390 - acc: 0.4475
Epoch 2/28

33/33 [==============================] - 1s 32ms/step - loss: 0.8904 - acc: 0.7775
Epoch 3/28

33/33 [==============================] - 1s 33ms/step - loss: 0.8628 - acc: 0.7866
Epoch 4/28

33/33 [==============================] - 1s 32ms/step - loss: 0.7275 - acc: 0.7807
Epoch 5/28

33/33 [==============================] - 1s 32ms/step - loss: 0.6487 - acc: 0.7884
Epoch 6/28

33/33 [==============================] - 1s 32ms/step - loss: 0.5581 - acc: 0.8117
Epoch 7/28

33/33 [==============================] - 1s 32ms/step - loss: 0.5173 - acc: 0.8308
Epoch 8/28

33/33 [==============================] - 1s 32ms/step - loss: 0.5096 - acc: 0.8499
Epoch 9/28

33/33 [==============================] - 1s 32ms/step - loss: 0.4135 - acc: 0.8633
Epoch 10/28

33/33 [==============================] - 1s 32ms/step - loss: 0.4010 - acc: 0.8922
Epoch 11/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3667 - acc: 0.8634
Epoch 12/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3420 - acc: 0.9038
Epoch 13/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3527 - acc: 0.9109
Epoch 14/28

33/33 [==============================] - 1s 33ms/step - loss: 0.3017 - acc: 0.9108
Epoch 15/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2891 - acc: 0.9279
Epoch 16/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2653 - acc: 0.9410
Epoch 17/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2512 - acc: 0.9507
Epoch 18/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2299 - acc: 0.9474
Epoch 19/28

33/33 [==============================] - 1s 33ms/step - loss: 0.2125 - acc: 0.9626
Epoch 20/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2445 - acc: 0.9339
Epoch 21/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1880 - acc: 0.9734
Epoch 22/28

33/33 [==============================] - 1s 33ms/step - loss: 0.1813 - acc: 0.9644
Epoch 23/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1627 - acc: 0.9614
Epoch 24/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1541 - acc: 0.9721
Epoch 25/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1479 - acc: 0.9750
Epoch 26/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1519 - acc: 0.9612
Epoch 27/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1181 - acc: 0.9755
Epoch 28/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1160 - acc: 0.9834
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7350
False 1721
True percentage 0.810274501158
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.95      0.94      7318
     B-MISC       0.06      0.01      0.01       141
      B-ORG       0.33      0.56      0.42       296
     I-MISC       0.10      0.04      0.06       154
      B-LOC       0.57      0.35      0.44       218
      I-ORG       0.29      0.19      0.23       151
      B-PER       0.76      0.24      0.36       438
      I-PER       0.80      0.21      0.33       214
      I-LOC       0.00      0.00      0.00       141

avg / total       0.84      0.81      0.81      9071

F-1 Score (without O):
0.310869565217
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 100048 unique words.
Found 93 unique chars.
Found 9 unique labels.
44 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 320
OOV word occurences: 625
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6403136     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,509,634
Trainable params: 6,509,634
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 3s 88ms/step - loss: 1.7731 - acc: 0.4400
Epoch 2/28

33/33 [==============================] - 1s 32ms/step - loss: 0.8168 - acc: 0.8107
Epoch 3/28

33/33 [==============================] - 1s 32ms/step - loss: 0.7159 - acc: 0.8101
Epoch 4/28

33/33 [==============================] - 1s 32ms/step - loss: 0.6519 - acc: 0.8106
Epoch 5/28

33/33 [==============================] - 1s 31ms/step - loss: 0.6111 - acc: 0.8105
Epoch 6/28

33/33 [==============================] - 1s 32ms/step - loss: 0.5714 - acc: 0.8139
Epoch 7/28

33/33 [==============================] - 1s 32ms/step - loss: 0.5139 - acc: 0.8302
Epoch 8/28

33/33 [==============================] - 1s 32ms/step - loss: 0.5068 - acc: 0.8593
Epoch 9/28

33/33 [==============================] - 1s 32ms/step - loss: 0.4502 - acc: 0.8601
Epoch 10/28

33/33 [==============================] - 1s 32ms/step - loss: 0.4146 - acc: 0.8645
Epoch 11/28

33/33 [==============================] - 1s 33ms/step - loss: 0.3776 - acc: 0.8544
Epoch 12/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3580 - acc: 0.8909
Epoch 13/28

33/33 [==============================] - 1s 33ms/step - loss: 0.3345 - acc: 0.9067
Epoch 14/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3243 - acc: 0.8944
Epoch 15/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3075 - acc: 0.9185
Epoch 16/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2777 - acc: 0.9193
Epoch 17/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2437 - acc: 0.9675
Epoch 18/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2712 - acc: 0.9370
Epoch 19/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2209 - acc: 0.9575
Epoch 20/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2142 - acc: 0.9586
Epoch 21/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2108 - acc: 0.9659
Epoch 22/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1982 - acc: 0.9565
Epoch 23/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1950 - acc: 0.9634
Epoch 24/28

33/33 [==============================] - 1s 33ms/step - loss: 0.2308 - acc: 0.9417
Epoch 25/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1661 - acc: 0.9721
Epoch 26/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1615 - acc: 0.9687
Epoch 27/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1632 - acc: 0.9664
Epoch 28/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1507 - acc: 0.9730
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7242
False 1829
True percentage 0.798368426855
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.37      0.30      0.33       296
          O       0.94      0.93      0.93      7318
     B-MISC       0.16      0.06      0.08       141
     I-MISC       0.16      0.40      0.23       154
      B-LOC       0.61      0.36      0.45       218
      I-LOC       0.89      0.17      0.29       141
      B-PER       0.47      0.32      0.38       438
      I-PER       0.65      0.21      0.31       214
      I-ORG       0.00      0.00      0.00       151

avg / total       0.84      0.80      0.81      9071

F-1 Score (without O):
0.842638398115
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 100043 unique words.
Found 94 unique chars.
Found 9 unique labels.
39 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 320
OOV word occurences: 626
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6402816     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,509,378
Trainable params: 6,509,378
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 3s 84ms/step - loss: 1.7661 - acc: 0.4342
Epoch 2/28

33/33 [==============================] - 1s 31ms/step - loss: 0.7211 - acc: 0.8333
Epoch 3/28

33/33 [==============================] - 1s 31ms/step - loss: 0.6993 - acc: 0.8322
Epoch 4/28

33/33 [==============================] - 1s 31ms/step - loss: 0.6242 - acc: 0.8314
Epoch 5/28

33/33 [==============================] - 1s 30ms/step - loss: 0.5769 - acc: 0.8327
Epoch 6/28

33/33 [==============================] - 1s 31ms/step - loss: 0.5283 - acc: 0.8344
Epoch 7/28

33/33 [==============================] - 1s 31ms/step - loss: 0.4914 - acc: 0.8426
Epoch 8/28

33/33 [==============================] - 1s 32ms/step - loss: 0.4686 - acc: 0.8390
Epoch 9/28

33/33 [==============================] - 1s 31ms/step - loss: 0.4369 - acc: 0.8730
Epoch 10/28

33/33 [==============================] - 1s 30ms/step - loss: 0.4016 - acc: 0.8739
Epoch 11/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3843 - acc: 0.8915
Epoch 12/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3570 - acc: 0.8756
Epoch 13/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3288 - acc: 0.9011
Epoch 14/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3109 - acc: 0.8928
Epoch 15/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3012 - acc: 0.9005
Epoch 16/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2832 - acc: 0.9084
Epoch 17/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2647 - acc: 0.9284
Epoch 18/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2606 - acc: 0.9163
Epoch 19/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2626 - acc: 0.9323
Epoch 20/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2464 - acc: 0.9247
Epoch 21/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2431 - acc: 0.9183
Epoch 22/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2240 - acc: 0.9253
Epoch 23/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2146 - acc: 0.9273
Epoch 24/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2048 - acc: 0.9397
Epoch 25/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2057 - acc: 0.9447
Epoch 26/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1831 - acc: 0.9511
Epoch 27/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1792 - acc: 0.9606
Epoch 28/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1695 - acc: 0.9560
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7054
False 2017
True percentage 0.777643038254
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.84      0.96      0.89      7318
      B-PER       0.08      0.00      0.00       438
      B-ORG       0.71      0.06      0.11       296
     B-MISC       0.00      0.00      0.00       141
      I-PER       0.00      0.00      0.00       214
      I-ORG       0.00      0.00      0.00       151
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141

avg / total       0.70      0.78      0.73      9071

F-1 Score (without O):
0.0201229737283
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100022 unique words.
Found 92 unique chars.
Found 8 unique labels.
18 unique words not found in embedding.
8 unique chars not found in embedding.
Number of OOV: 324
OOV word occurences: 632
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401472     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,756
Trainable params: 6,507,756
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 2s 134ms/step - loss: 2.1485 - acc: 0.1121
Epoch 2/28

16/16 [==============================] - 0s 30ms/step - loss: 1.0444 - acc: 0.8466
Epoch 3/28

16/16 [==============================] - 0s 29ms/step - loss: 0.6989 - acc: 0.8466
Epoch 4/28

16/16 [==============================] - 0s 30ms/step - loss: 0.6652 - acc: 0.8466
Epoch 5/28

16/16 [==============================] - 0s 30ms/step - loss: 0.6183 - acc: 0.8466
Epoch 6/28

16/16 [==============================] - 0s 29ms/step - loss: 0.5855 - acc: 0.8466
Epoch 7/28

16/16 [==============================] - 0s 29ms/step - loss: 0.5623 - acc: 0.8466
Epoch 8/28

16/16 [==============================] - 0s 30ms/step - loss: 0.5291 - acc: 0.8466
Epoch 9/28

16/16 [==============================] - 0s 30ms/step - loss: 0.5000 - acc: 0.8466
Epoch 10/28

16/16 [==============================] - 0s 29ms/step - loss: 0.4777 - acc: 0.8466
Epoch 11/28

16/16 [==============================] - 0s 30ms/step - loss: 0.4440 - acc: 0.8466
Epoch 12/28

16/16 [==============================] - 0s 28ms/step - loss: 0.4250 - acc: 0.8732
Epoch 13/28

16/16 [==============================] - 0s 29ms/step - loss: 0.3985 - acc: 0.8614
Epoch 14/28

16/16 [==============================] - 0s 29ms/step - loss: 0.3759 - acc: 0.8761
Epoch 15/28

16/16 [==============================] - 0s 30ms/step - loss: 0.3480 - acc: 0.8791
Epoch 16/28

16/16 [==============================] - 0s 28ms/step - loss: 0.3135 - acc: 0.8909
Epoch 17/28

16/16 [==============================] - 0s 30ms/step - loss: 0.2900 - acc: 0.9027
Epoch 18/28

16/16 [==============================] - 0s 30ms/step - loss: 0.2704 - acc: 0.9174
Epoch 19/28

16/16 [==============================] - 0s 30ms/step - loss: 0.2564 - acc: 0.9174
Epoch 20/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2310 - acc: 0.9440
Epoch 21/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2289 - acc: 0.9115
Epoch 22/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2396 - acc: 0.9735
Epoch 23/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2036 - acc: 0.9263
Epoch 24/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1705 - acc: 0.9558
Epoch 25/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1615 - acc: 0.9617
Epoch 26/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1528 - acc: 0.9705
Epoch 27/28

16/16 [==============================] - 0s 30ms/step - loss: 0.1393 - acc: 0.9705
Epoch 28/28

16/16 [==============================] - 0s 30ms/step - loss: 0.1248 - acc: 0.9794
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7168
False 1689
True percentage 0.809303375861
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.87      0.96      0.91      7318
      B-LOC       0.47      0.11      0.17       218
      I-LOC       0.83      0.07      0.13       141
      B-PER       0.55      0.10      0.17       438
      B-ORG       0.36      0.31      0.33       296
      I-ORG       0.31      0.03      0.06       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.18      0.01      0.02       154

avg / total       0.79      0.81      0.78      8857

F-1 Score (without O):
0.180527383367
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 100025 unique words.
Found 92 unique chars.
Found 9 unique labels.
21 unique words not found in embedding.
8 unique chars not found in embedding.
Number of OOV: 327
OOV word occurences: 640
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401664     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,508,098
Trainable params: 6,508,098
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 2s 135ms/step - loss: 2.0708 - acc: 0.2673
Epoch 2/28

16/16 [==============================] - 0s 29ms/step - loss: 1.0631 - acc: 0.7642
Epoch 3/28

16/16 [==============================] - 0s 29ms/step - loss: 1.0833 - acc: 0.7642
Epoch 4/28

16/16 [==============================] - 0s 29ms/step - loss: 1.0079 - acc: 0.7642
Epoch 5/28

16/16 [==============================] - 0s 28ms/step - loss: 0.8505 - acc: 0.7642
Epoch 6/28

16/16 [==============================] - 0s 28ms/step - loss: 0.7923 - acc: 0.7642
Epoch 7/28

16/16 [==============================] - 0s 29ms/step - loss: 0.7530 - acc: 0.7642
Epoch 8/28

16/16 [==============================] - 0s 28ms/step - loss: 0.7157 - acc: 0.7673
Epoch 9/28

16/16 [==============================] - 0s 27ms/step - loss: 0.6793 - acc: 0.7673
Epoch 10/28

16/16 [==============================] - 0s 28ms/step - loss: 0.6441 - acc: 0.7925
Epoch 11/28

16/16 [==============================] - 0s 28ms/step - loss: 0.6196 - acc: 0.7767
Epoch 12/28

16/16 [==============================] - 0s 28ms/step - loss: 0.5685 - acc: 0.7987
Epoch 13/28

16/16 [==============================] - 0s 29ms/step - loss: 0.5321 - acc: 0.8082
Epoch 14/28

16/16 [==============================] - 0s 28ms/step - loss: 0.4986 - acc: 0.8113
Epoch 15/28

16/16 [==============================] - 0s 27ms/step - loss: 0.4677 - acc: 0.8459
Epoch 16/28

16/16 [==============================] - 0s 29ms/step - loss: 0.4366 - acc: 0.8459
Epoch 17/28

16/16 [==============================] - 0s 29ms/step - loss: 0.4079 - acc: 0.8774
Epoch 18/28

16/16 [==============================] - 0s 28ms/step - loss: 0.3921 - acc: 0.8616
Epoch 19/28

16/16 [==============================] - 0s 29ms/step - loss: 0.3625 - acc: 0.8836
Epoch 20/28

16/16 [==============================] - 0s 28ms/step - loss: 0.3365 - acc: 0.9025
Epoch 21/28

16/16 [==============================] - 0s 28ms/step - loss: 0.3094 - acc: 0.9340
Epoch 22/28

16/16 [==============================] - 0s 28ms/step - loss: 0.3085 - acc: 0.8899
Epoch 23/28

16/16 [==============================] - 0s 28ms/step - loss: 0.3100 - acc: 0.9434
Epoch 24/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2827 - acc: 0.9151
Epoch 25/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2508 - acc: 0.9528
Epoch 26/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2251 - acc: 0.9465
Epoch 27/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2193 - acc: 0.9528
Epoch 28/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2017 - acc: 0.9560
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7216
False 1855
True percentage 0.795502149708
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.49      0.32      0.38       438
      I-PER       0.52      0.05      0.09       214
          O       0.89      0.95      0.92      7318
      B-ORG       0.54      0.18      0.27       296
      I-ORG       0.55      0.08      0.14       151
      B-LOC       0.35      0.27      0.30       218
      I-LOC       1.00      0.01      0.01       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.80      0.80      0.78      9071

F-1 Score (without O):
0.843554443054
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100018 unique words.
Found 91 unique chars.
Found 9 unique labels.
14 unique words not found in embedding.
7 unique chars not found in embedding.
Number of OOV: 326
OOV word occurences: 638
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5888        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401216     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,586
Trainable params: 6,507,586
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 2s 136ms/step - loss: 2.6006 - acc: 0.0186
Epoch 2/28

16/16 [==============================] - 0s 28ms/step - loss: 1.3664 - acc: 0.7802
Epoch 3/28

16/16 [==============================] - 0s 29ms/step - loss: 1.0349 - acc: 0.7802
Epoch 4/28

16/16 [==============================] - 0s 29ms/step - loss: 0.9858 - acc: 0.7833
Epoch 5/28

16/16 [==============================] - 0s 29ms/step - loss: 0.8319 - acc: 0.7802
Epoch 6/28

16/16 [==============================] - 0s 29ms/step - loss: 0.7899 - acc: 0.7802
Epoch 7/28

16/16 [==============================] - 0s 29ms/step - loss: 0.7606 - acc: 0.7802
Epoch 8/28

16/16 [==============================] - 0s 29ms/step - loss: 0.7156 - acc: 0.7833
Epoch 9/28

16/16 [==============================] - 0s 29ms/step - loss: 0.6800 - acc: 0.7833
Epoch 10/28

16/16 [==============================] - 0s 28ms/step - loss: 0.6361 - acc: 0.7833
Epoch 11/28

16/16 [==============================] - 0s 29ms/step - loss: 0.6142 - acc: 0.7864
Epoch 12/28

16/16 [==============================] - 0s 29ms/step - loss: 0.5705 - acc: 0.8080
Epoch 13/28

16/16 [==============================] - 0s 29ms/step - loss: 0.5432 - acc: 0.8050
Epoch 14/28

16/16 [==============================] - 0s 28ms/step - loss: 0.5029 - acc: 0.8545
Epoch 15/28

16/16 [==============================] - 0s 28ms/step - loss: 0.4843 - acc: 0.8545
Epoch 16/28

16/16 [==============================] - 0s 29ms/step - loss: 0.4621 - acc: 0.8731
Epoch 17/28

16/16 [==============================] - 0s 29ms/step - loss: 0.4407 - acc: 0.8514
Epoch 18/28

16/16 [==============================] - 0s 28ms/step - loss: 0.4297 - acc: 0.9040
Epoch 19/28

16/16 [==============================] - 0s 29ms/step - loss: 0.3964 - acc: 0.8576
Epoch 20/28

16/16 [==============================] - 0s 29ms/step - loss: 0.3703 - acc: 0.9195
Epoch 21/28

16/16 [==============================] - 0s 29ms/step - loss: 0.3386 - acc: 0.9071
Epoch 22/28

16/16 [==============================] - 0s 30ms/step - loss: 0.3215 - acc: 0.9164
Epoch 23/28

16/16 [==============================] - 0s 29ms/step - loss: 0.3012 - acc: 0.9226
Epoch 24/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2989 - acc: 0.9102
Epoch 25/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2871 - acc: 0.9381
Epoch 26/28

16/16 [==============================] - 0s 30ms/step - loss: 0.2594 - acc: 0.9226
Epoch 27/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2521 - acc: 0.9505
Epoch 28/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2247 - acc: 0.9474
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7216
False 1855
True percentage 0.795502149708
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.89      0.95      0.92      7318
      B-PER       0.61      0.24      0.34       438
      B-LOC       0.65      0.17      0.26       218
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-ORG       0.41      0.40      0.40       296
      I-ORG       0.27      0.26      0.27       151
      I-LOC       0.00      0.00      0.00       141
      I-PER       0.00      0.00      0.00       214

avg / total       0.78      0.80      0.78      9071

F-1 Score (without O):
0.245150639703
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 100030 unique words.
Found 93 unique chars.
Found 9 unique labels.
26 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 324
OOV word occurences: 628
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401984     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,508,482
Trainable params: 6,508,482
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 2s 133ms/step - loss: 2.3805 - acc: 0.0451
Epoch 2/28

16/16 [==============================] - 0s 29ms/step - loss: 1.4951 - acc: 0.7639
Epoch 3/28

16/16 [==============================] - 0s 28ms/step - loss: 0.9333 - acc: 0.7692
Epoch 4/28

16/16 [==============================] - 0s 29ms/step - loss: 0.8697 - acc: 0.7692
Epoch 5/28

16/16 [==============================] - 0s 28ms/step - loss: 0.8219 - acc: 0.7692
Epoch 6/28

16/16 [==============================] - 0s 28ms/step - loss: 0.8291 - acc: 0.7745
Epoch 7/28

16/16 [==============================] - 0s 28ms/step - loss: 0.7559 - acc: 0.7692
Epoch 8/28

16/16 [==============================] - 0s 28ms/step - loss: 0.7394 - acc: 0.7851
Epoch 9/28

16/16 [==============================] - 0s 29ms/step - loss: 0.6341 - acc: 0.7798
Epoch 10/28

16/16 [==============================] - 0s 29ms/step - loss: 0.6000 - acc: 0.8143
Epoch 11/28

16/16 [==============================] - 0s 29ms/step - loss: 0.5574 - acc: 0.7931
Epoch 12/28

16/16 [==============================] - 0s 28ms/step - loss: 0.4961 - acc: 0.8462
Epoch 13/28

16/16 [==============================] - 0s 28ms/step - loss: 0.4619 - acc: 0.8594
Epoch 14/28

16/16 [==============================] - 0s 28ms/step - loss: 0.4356 - acc: 0.8700
Epoch 15/28

16/16 [==============================] - 0s 30ms/step - loss: 0.3858 - acc: 0.8780
Epoch 16/28

16/16 [==============================] - 0s 28ms/step - loss: 0.3492 - acc: 0.8966
Epoch 17/28

16/16 [==============================] - 0s 29ms/step - loss: 0.3246 - acc: 0.9072
Epoch 18/28

16/16 [==============================] - 0s 29ms/step - loss: 0.3067 - acc: 0.9284
Epoch 19/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2862 - acc: 0.9231
Epoch 20/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2729 - acc: 0.9576
Epoch 21/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2463 - acc: 0.9496
Epoch 22/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2443 - acc: 0.9629
Epoch 23/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2293 - acc: 0.9469
Epoch 24/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2081 - acc: 0.9761
Epoch 25/28

16/16 [==============================] - 0s 30ms/step - loss: 0.1805 - acc: 0.9655
Epoch 26/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1602 - acc: 0.9761
Epoch 27/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1462 - acc: 0.9814
Epoch 28/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1458 - acc: 0.9788
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7160
False 1911
True percentage 0.789328629699
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.88      0.94      0.91      7318
      B-ORG       0.44      0.24      0.31       296
      I-ORG       0.00      0.00      0.00       151
      B-PER       0.58      0.21      0.30       438
      I-PER       0.41      0.14      0.20       214
      B-LOC       0.66      0.24      0.36       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.12      0.11      0.12       154

avg / total       0.78      0.79      0.78      9071

F-1 Score (without O):
0.218501465048
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 100028 unique words.
Found 93 unique chars.
Found 9 unique labels.
24 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 326
OOV word occurences: 637
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401856     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,508,354
Trainable params: 6,508,354
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 2s 133ms/step - loss: 2.4062 - acc: 0.0268
Epoch 2/28

16/16 [==============================] - 0s 30ms/step - loss: 1.3655 - acc: 0.7694
Epoch 3/28

16/16 [==============================] - 0s 29ms/step - loss: 1.0199 - acc: 0.7748
Epoch 4/28

16/16 [==============================] - 0s 29ms/step - loss: 1.0002 - acc: 0.7748
Epoch 5/28

16/16 [==============================] - 0s 29ms/step - loss: 0.8501 - acc: 0.7748
Epoch 6/28

16/16 [==============================] - 0s 28ms/step - loss: 0.8030 - acc: 0.7748
Epoch 7/28

16/16 [==============================] - 0s 28ms/step - loss: 0.7545 - acc: 0.7748
Epoch 8/28

16/16 [==============================] - 0s 29ms/step - loss: 0.6957 - acc: 0.7748
Epoch 9/28

16/16 [==============================] - 0s 28ms/step - loss: 0.6549 - acc: 0.7748
Epoch 10/28

16/16 [==============================] - 0s 29ms/step - loss: 0.6145 - acc: 0.7775
Epoch 11/28

16/16 [==============================] - 0s 29ms/step - loss: 0.5666 - acc: 0.7802
Epoch 12/28

16/16 [==============================] - 0s 29ms/step - loss: 0.5178 - acc: 0.8284
Epoch 13/28

16/16 [==============================] - 0s 28ms/step - loss: 0.4742 - acc: 0.8499
Epoch 14/28

16/16 [==============================] - 0s 27ms/step - loss: 0.4397 - acc: 0.8633
Epoch 15/28

16/16 [==============================] - 0s 28ms/step - loss: 0.4033 - acc: 0.8954
Epoch 16/28

16/16 [==============================] - 0s 27ms/step - loss: 0.4406 - acc: 0.8552
Epoch 17/28

16/16 [==============================] - 0s 28ms/step - loss: 0.5655 - acc: 0.9383
Epoch 18/28

16/16 [==============================] - 0s 28ms/step - loss: 0.3557 - acc: 0.8928
Epoch 19/28

16/16 [==============================] - 0s 28ms/step - loss: 0.3245 - acc: 0.9142
Epoch 20/28

16/16 [==============================] - 0s 29ms/step - loss: 0.3143 - acc: 0.9223
Epoch 21/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2742 - acc: 0.9491
Epoch 22/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2589 - acc: 0.9383
Epoch 23/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2506 - acc: 0.9464
Epoch 24/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2380 - acc: 0.9517
Epoch 25/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2189 - acc: 0.9625
Epoch 26/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2055 - acc: 0.9732
Epoch 27/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1964 - acc: 0.9812
Epoch 28/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1830 - acc: 0.9705
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7170
False 1901
True percentage 0.790431043986
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.89      0.95      0.92      7318
      B-ORG       0.35      0.26      0.30       296
      I-ORG       0.11      0.01      0.01       151
      B-PER       0.58      0.21      0.31       438
      I-PER       0.48      0.07      0.12       214
     B-MISC       0.07      0.06      0.06       141
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.77      0.05      0.09       218
      I-LOC       1.00      0.08      0.14       141

avg / total       0.80      0.79      0.77      9071

F-1 Score (without O):
0.183612183612
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 100034 unique words.
Found 93 unique chars.
Found 9 unique labels.
30 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 323
OOV word occurences: 621
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6402240     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,508,738
Trainable params: 6,508,738
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 2s 134ms/step - loss: 2.4465 - acc: 0.0270
Epoch 2/28

16/16 [==============================] - 0s 29ms/step - loss: 1.3451 - acc: 0.7978
Epoch 3/28

16/16 [==============================] - 0s 28ms/step - loss: 0.8728 - acc: 0.8005
Epoch 4/28

16/16 [==============================] - 0s 28ms/step - loss: 0.8567 - acc: 0.8005
Epoch 5/28

16/16 [==============================] - 0s 28ms/step - loss: 0.7756 - acc: 0.8005
Epoch 6/28

16/16 [==============================] - 0s 29ms/step - loss: 0.7264 - acc: 0.8005
Epoch 7/28

16/16 [==============================] - 0s 28ms/step - loss: 0.6841 - acc: 0.8005
Epoch 8/28

16/16 [==============================] - 0s 28ms/step - loss: 0.6594 - acc: 0.8005
Epoch 9/28

16/16 [==============================] - 0s 29ms/step - loss: 0.6223 - acc: 0.8005
Epoch 10/28

16/16 [==============================] - 0s 28ms/step - loss: 0.5808 - acc: 0.8005
Epoch 11/28

16/16 [==============================] - 0s 29ms/step - loss: 0.5496 - acc: 0.8005
Epoch 12/28

16/16 [==============================] - 0s 28ms/step - loss: 0.5141 - acc: 0.8086
Epoch 13/28

16/16 [==============================] - 0s 29ms/step - loss: 0.4864 - acc: 0.8086
Epoch 14/28

16/16 [==============================] - 0s 29ms/step - loss: 0.4691 - acc: 0.8356
Epoch 15/28

16/16 [==============================] - 0s 29ms/step - loss: 0.4388 - acc: 0.8464
Epoch 16/28

16/16 [==============================] - 0s 29ms/step - loss: 0.4122 - acc: 0.8518
Epoch 17/28

16/16 [==============================] - 0s 30ms/step - loss: 0.3872 - acc: 0.8652
Epoch 18/28

16/16 [==============================] - 0s 28ms/step - loss: 0.3618 - acc: 0.8814
Epoch 19/28

16/16 [==============================] - 0s 29ms/step - loss: 0.3404 - acc: 0.8814
Epoch 20/28

16/16 [==============================] - 0s 29ms/step - loss: 0.3248 - acc: 0.8922
Epoch 21/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2984 - acc: 0.9137
Epoch 22/28

16/16 [==============================] - 0s 30ms/step - loss: 0.3184 - acc: 0.9434
Epoch 23/28

16/16 [==============================] - 0s 29ms/step - loss: 0.3264 - acc: 0.8787
Epoch 24/28

16/16 [==============================] - 0s 29ms/step - loss: 0.3094 - acc: 0.9353
Epoch 25/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2545 - acc: 0.9407
Epoch 26/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2334 - acc: 0.9596
Epoch 27/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2224 - acc: 0.9515
Epoch 28/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2118 - acc: 0.9596
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7229
False 1842
True percentage 0.796935288281
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.60      0.25      0.36       438
          O       0.88      0.96      0.92      7318
      B-LOC       0.38      0.01      0.03       218
      B-ORG       0.47      0.33      0.39       296
      I-PER       0.26      0.05      0.08       214
     B-MISC       0.13      0.05      0.07       141
     I-MISC       0.00      0.00      0.00       154
      I-ORG       0.19      0.05      0.07       151
      I-LOC       0.00      0.00      0.00       141

avg / total       0.78      0.80      0.78      9071

F-1 Score (without O):
0.842516423034
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 100021 unique words.
Found 92 unique chars.
Found 9 unique labels.
17 unique words not found in embedding.
8 unique chars not found in embedding.
Number of OOV: 325
OOV word occurences: 636
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401408     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,842
Trainable params: 6,507,842
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 2s 137ms/step - loss: 2.1486 - acc: 0.2394
Epoch 2/28

16/16 [==============================] - 0s 29ms/step - loss: 1.2785 - acc: 0.7430
Epoch 3/28

16/16 [==============================] - 0s 28ms/step - loss: 1.0169 - acc: 0.7430
Epoch 4/28

16/16 [==============================] - 0s 29ms/step - loss: 0.9817 - acc: 0.7430
Epoch 5/28

16/16 [==============================] - 0s 27ms/step - loss: 0.8707 - acc: 0.7430
Epoch 6/28

16/16 [==============================] - 0s 30ms/step - loss: 0.8079 - acc: 0.7430
Epoch 7/28

16/16 [==============================] - 0s 29ms/step - loss: 0.7429 - acc: 0.7500
Epoch 8/28

16/16 [==============================] - 0s 29ms/step - loss: 0.6813 - acc: 0.7817
Epoch 9/28

16/16 [==============================] - 0s 29ms/step - loss: 0.6318 - acc: 0.7817
Epoch 10/28

16/16 [==============================] - 0s 29ms/step - loss: 0.5708 - acc: 0.8204
Epoch 11/28

16/16 [==============================] - 0s 29ms/step - loss: 0.5222 - acc: 0.7958
Epoch 12/28

16/16 [==============================] - 0s 30ms/step - loss: 0.4865 - acc: 0.8556
Epoch 13/28

16/16 [==============================] - 0s 29ms/step - loss: 0.4656 - acc: 0.8099
Epoch 14/28

16/16 [==============================] - 0s 27ms/step - loss: 0.4472 - acc: 0.9085
Epoch 15/28

16/16 [==============================] - 0s 29ms/step - loss: 0.3716 - acc: 0.8908
Epoch 16/28

16/16 [==============================] - 0s 29ms/step - loss: 0.3348 - acc: 0.9190
Epoch 17/28

16/16 [==============================] - 0s 28ms/step - loss: 0.3071 - acc: 0.9401
Epoch 18/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2762 - acc: 0.9366
Epoch 19/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2554 - acc: 0.9472
Epoch 20/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2356 - acc: 0.9683
Epoch 21/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2270 - acc: 0.9366
Epoch 22/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2483 - acc: 0.9754
Epoch 23/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1847 - acc: 0.9683
Epoch 24/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1655 - acc: 0.9754
Epoch 25/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1496 - acc: 0.9754
Epoch 26/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1455 - acc: 0.9859
Epoch 27/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1157 - acc: 0.9859
Epoch 28/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1155 - acc: 0.9824
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7188
False 1883
True percentage 0.792415389703
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.89      0.95      0.92      7318
     B-MISC       0.04      0.01      0.02       141
      B-ORG       0.33      0.35      0.34       296
     I-MISC       0.28      0.07      0.11       154
      B-LOC       0.55      0.27      0.36       218
      I-ORG       0.32      0.06      0.10       151
      B-PER       0.53      0.08      0.14       438
      I-PER       0.48      0.21      0.29       214
      I-LOC       1.00      0.01      0.01       141

avg / total       0.81      0.79      0.78      9071

F-1 Score (without O):
0.21760391198
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 100021 unique words.
Found 89 unique chars.
Found 9 unique labels.
17 unique words not found in embedding.
5 unique chars not found in embedding.
Number of OOV: 325
OOV word occurences: 635
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5760        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401408     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,650
Trainable params: 6,507,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 2s 135ms/step - loss: 2.1089 - acc: 0.1678
Epoch 2/28

16/16 [==============================] - 0s 27ms/step - loss: 1.0359 - acc: 0.8257
Epoch 3/28

16/16 [==============================] - 0s 27ms/step - loss: 0.7977 - acc: 0.8257
Epoch 4/28

16/16 [==============================] - 0s 28ms/step - loss: 0.7607 - acc: 0.8257
Epoch 5/28

16/16 [==============================] - 0s 28ms/step - loss: 0.6772 - acc: 0.8257
Epoch 6/28

16/16 [==============================] - 0s 27ms/step - loss: 0.6425 - acc: 0.8257
Epoch 7/28

16/16 [==============================] - 0s 28ms/step - loss: 0.6082 - acc: 0.8257
Epoch 8/28

16/16 [==============================] - 0s 28ms/step - loss: 0.5715 - acc: 0.8257
Epoch 9/28

16/16 [==============================] - 0s 28ms/step - loss: 0.5455 - acc: 0.8257
Epoch 10/28

16/16 [==============================] - 0s 28ms/step - loss: 0.5096 - acc: 0.8257
Epoch 11/28

16/16 [==============================] - 0s 29ms/step - loss: 0.4743 - acc: 0.8257
Epoch 12/28

16/16 [==============================] - 0s 27ms/step - loss: 0.4484 - acc: 0.8355
Epoch 13/28

16/16 [==============================] - 0s 28ms/step - loss: 0.4315 - acc: 0.8322
Epoch 14/28

16/16 [==============================] - 0s 28ms/step - loss: 0.4125 - acc: 0.8618
Epoch 15/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3970 - acc: 0.8322
Epoch 16/28

16/16 [==============================] - 0s 28ms/step - loss: 0.3860 - acc: 0.9145
Epoch 17/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3272 - acc: 0.8750
Epoch 18/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2945 - acc: 0.9079
Epoch 19/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2847 - acc: 0.9243
Epoch 20/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2647 - acc: 0.9145
Epoch 21/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2543 - acc: 0.9441
Epoch 22/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2319 - acc: 0.9276
Epoch 23/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2233 - acc: 0.9605
Epoch 24/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2103 - acc: 0.9539
Epoch 25/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2096 - acc: 0.9737
Epoch 26/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1809 - acc: 0.9671
Epoch 27/28

16/16 [==============================] - 0s 30ms/step - loss: 0.1795 - acc: 0.9638
Epoch 28/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1516 - acc: 0.9836
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7139
False 1932
True percentage 0.787013559696
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.39      0.27      0.32       296
          O       0.87      0.95      0.91      7318
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.20      0.14      0.17       154
      B-LOC       0.56      0.07      0.12       218
      I-LOC       0.45      0.04      0.07       141
      B-PER       0.51      0.09      0.15       438
      I-PER       0.52      0.06      0.10       214
      I-ORG       0.00      0.00      0.00       151

avg / total       0.78      0.79      0.76      9071

F-1 Score (without O):
0.830255264087
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 100018 unique words.
Found 93 unique chars.
Found 8 unique labels.
14 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 325
OOV word occurences: 636
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401216     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,564
Trainable params: 6,507,564
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 2s 133ms/step - loss: 2.5576 - acc: 0.0137
Epoch 2/28

16/16 [==============================] - 0s 28ms/step - loss: 1.5568 - acc: 0.8259
Epoch 3/28

16/16 [==============================] - 0s 28ms/step - loss: 0.7727 - acc: 0.8328
Epoch 4/28

16/16 [==============================] - 0s 28ms/step - loss: 0.7534 - acc: 0.8328
Epoch 5/28

16/16 [==============================] - 0s 28ms/step - loss: 0.6848 - acc: 0.8328
Epoch 6/28

16/16 [==============================] - 0s 29ms/step - loss: 0.5513 - acc: 0.8328
Epoch 7/28

16/16 [==============================] - 0s 28ms/step - loss: 0.5025 - acc: 0.8328
Epoch 8/28

16/16 [==============================] - 0s 28ms/step - loss: 0.4686 - acc: 0.8328
Epoch 9/28

16/16 [==============================] - 0s 29ms/step - loss: 0.4373 - acc: 0.8362
Epoch 10/28

16/16 [==============================] - 0s 30ms/step - loss: 0.4114 - acc: 0.8601
Epoch 11/28

16/16 [==============================] - 0s 29ms/step - loss: 0.3821 - acc: 0.8771
Epoch 12/28

16/16 [==============================] - 0s 29ms/step - loss: 0.3667 - acc: 0.9010
Epoch 13/28

16/16 [==============================] - 0s 29ms/step - loss: 0.3327 - acc: 0.8874
Epoch 14/28

16/16 [==============================] - 0s 28ms/step - loss: 0.3102 - acc: 0.9010
Epoch 15/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2816 - acc: 0.9079
Epoch 16/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2714 - acc: 0.9113
Epoch 17/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2526 - acc: 0.9283
Epoch 18/28

16/16 [==============================] - 0s 30ms/step - loss: 0.2364 - acc: 0.9215
Epoch 19/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2177 - acc: 0.9352
Epoch 20/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2137 - acc: 0.9386
Epoch 21/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1946 - acc: 0.9420
Epoch 22/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2378 - acc: 0.9488
Epoch 23/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1784 - acc: 0.9488
Epoch 24/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1704 - acc: 0.9454
Epoch 25/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1643 - acc: 0.9590
Epoch 26/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1507 - acc: 0.9522
Epoch 27/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1458 - acc: 0.9556
Epoch 28/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1405 - acc: 0.9556
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7175
False 1755
True percentage 0.803471444569
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.87      0.95      0.91      7318
      B-PER       0.66      0.21      0.31       438
      B-ORG       0.32      0.33      0.33       296
     B-MISC       0.00      0.00      0.00       141
      I-PER       0.75      0.07      0.13       214
      I-ORG       0.00      0.00      0.00       151
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.00      0.00      0.00       218

avg / total       0.78      0.80      0.78      8930

F-1 Score (without O):
0.196437168994
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100010 unique words.
Found 87 unique chars.
Found 8 unique labels.
6 unique words not found in embedding.
3 unique chars not found in embedding.
Number of OOV: 327
OOV word occurences: 639
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5632        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6400704     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,506,668
Trainable params: 6,506,668
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 2s 245ms/step - loss: 2.3773 - acc: 0.0066
Epoch 2/28

8/8 [==============================] - 0s 34ms/step - loss: 1.2670 - acc: 0.8013
Epoch 3/28

8/8 [==============================] - 0s 34ms/step - loss: 0.8565 - acc: 0.8013
Epoch 4/28

8/8 [==============================] - 0s 33ms/step - loss: 0.8562 - acc: 0.8013
Epoch 5/28

8/8 [==============================] - 0s 34ms/step - loss: 0.7661 - acc: 0.8013
Epoch 6/28

8/8 [==============================] - 0s 34ms/step - loss: 0.7116 - acc: 0.8013
Epoch 7/28

8/8 [==============================] - 0s 34ms/step - loss: 0.6435 - acc: 0.8013
Epoch 8/28

8/8 [==============================] - 0s 35ms/step - loss: 0.6085 - acc: 0.8013
Epoch 9/28

8/8 [==============================] - 0s 34ms/step - loss: 0.5767 - acc: 0.8013
Epoch 10/28

8/8 [==============================] - 0s 35ms/step - loss: 0.5493 - acc: 0.8146
Epoch 11/28

8/8 [==============================] - 0s 34ms/step - loss: 0.5000 - acc: 0.8278
Epoch 12/28

8/8 [==============================] - 0s 34ms/step - loss: 0.4499 - acc: 0.8543
Epoch 13/28

8/8 [==============================] - 0s 33ms/step - loss: 0.4032 - acc: 0.8675
Epoch 14/28

8/8 [==============================] - 0s 34ms/step - loss: 0.3711 - acc: 0.8675
Epoch 15/28

8/8 [==============================] - 0s 35ms/step - loss: 0.3420 - acc: 0.8940
Epoch 16/28

8/8 [==============================] - 0s 35ms/step - loss: 0.3253 - acc: 0.8675
Epoch 17/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2793 - acc: 0.9272
Epoch 18/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2470 - acc: 0.9338
Epoch 19/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2292 - acc: 0.9536
Epoch 20/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2173 - acc: 0.9470
Epoch 21/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1918 - acc: 0.9603
Epoch 22/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1764 - acc: 0.9470
Epoch 23/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1635 - acc: 0.9801
Epoch 24/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1468 - acc: 0.9669
Epoch 25/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1187 - acc: 0.9801
Epoch 26/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1279 - acc: 0.9735
Epoch 27/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1303 - acc: 0.9934
Epoch 28/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1700 - acc: 0.9272
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 6958
False 1899
True percentage 0.785593316021
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.91      0.92      7318
      B-LOC       0.31      0.18      0.23       218
      I-LOC       0.35      0.15      0.21       141
      B-PER       0.40      0.17      0.24       438
      B-ORG       0.17      0.36      0.23       296
      I-ORG       0.19      0.18      0.18       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.04      0.04      0.04       154

avg / total       0.82      0.79      0.80      8857

F-1 Score (without O):
0.19427764041
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 100016 unique words.
Found 91 unique chars.
Found 9 unique labels.
12 unique words not found in embedding.
7 unique chars not found in embedding.
Number of OOV: 328
OOV word occurences: 641
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5888        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,458
Trainable params: 6,507,458
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 2s 263ms/step - loss: 2.3810 - acc: 0.0680
Epoch 2/28

8/8 [==============================] - 0s 34ms/step - loss: 1.4840 - acc: 0.7687
Epoch 3/28

8/8 [==============================] - 0s 34ms/step - loss: 0.9930 - acc: 0.7687
Epoch 4/28

8/8 [==============================] - 0s 34ms/step - loss: 0.9537 - acc: 0.7687
Epoch 5/28

8/8 [==============================] - 0s 34ms/step - loss: 0.8890 - acc: 0.7687
Epoch 6/28

8/8 [==============================] - 0s 34ms/step - loss: 0.8461 - acc: 0.7755
Epoch 7/28

8/8 [==============================] - 0s 34ms/step - loss: 0.7405 - acc: 0.7687
Epoch 8/28

8/8 [==============================] - 0s 34ms/step - loss: 0.6969 - acc: 0.7687
Epoch 9/28

8/8 [==============================] - 0s 34ms/step - loss: 0.6381 - acc: 0.8027
Epoch 10/28

8/8 [==============================] - 0s 34ms/step - loss: 0.5868 - acc: 0.7959
Epoch 11/28

8/8 [==============================] - 0s 34ms/step - loss: 0.5620 - acc: 0.8367
Epoch 12/28

8/8 [==============================] - 0s 34ms/step - loss: 0.5188 - acc: 0.8095
Epoch 13/28

8/8 [==============================] - 0s 34ms/step - loss: 0.4908 - acc: 0.8707
Epoch 14/28

8/8 [==============================] - 0s 35ms/step - loss: 0.4532 - acc: 0.8367
Epoch 15/28

8/8 [==============================] - 0s 34ms/step - loss: 0.4038 - acc: 0.8912
Epoch 16/28

8/8 [==============================] - 0s 35ms/step - loss: 0.3980 - acc: 0.8571
Epoch 17/28

8/8 [==============================] - 0s 34ms/step - loss: 0.3442 - acc: 0.9184
Epoch 18/28

8/8 [==============================] - 0s 34ms/step - loss: 0.3553 - acc: 0.8776
Epoch 19/28

8/8 [==============================] - 0s 34ms/step - loss: 0.3012 - acc: 0.9320
Epoch 20/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2702 - acc: 0.9184
Epoch 21/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2483 - acc: 0.9456
Epoch 22/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2261 - acc: 0.9388
Epoch 23/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1900 - acc: 0.9592
Epoch 24/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1851 - acc: 0.9932
Epoch 25/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2188 - acc: 0.9524
Epoch 26/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2982 - acc: 0.9796
Epoch 27/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1645 - acc: 0.9796
Epoch 28/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1378 - acc: 0.9932
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7136
False 1935
True percentage 0.78668283541
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.39      0.06      0.11       438
      I-PER       0.69      0.05      0.10       214
          O       0.88      0.95      0.91      7318
      B-ORG       0.33      0.33      0.33       296
      I-ORG       0.33      0.19      0.24       151
      B-LOC       0.97      0.13      0.23       218
      I-LOC       0.86      0.04      0.08       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.79      0.79      0.76      9071

F-1 Score (without O):
0.836697463662
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100012 unique words.
Found 91 unique chars.
Found 9 unique labels.
8 unique words not found in embedding.
7 unique chars not found in embedding.
Number of OOV: 326
OOV word occurences: 638
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5888        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6400832     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,202
Trainable params: 6,507,202
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 2s 246ms/step - loss: 2.1134 - acc: 0.2249
Epoch 2/28

8/8 [==============================] - 0s 33ms/step - loss: 1.2516 - acc: 0.7870
Epoch 3/28

8/8 [==============================] - 0s 32ms/step - loss: 0.9080 - acc: 0.7870
Epoch 4/28

8/8 [==============================] - 0s 33ms/step - loss: 0.8933 - acc: 0.7870
Epoch 5/28

8/8 [==============================] - 0s 33ms/step - loss: 0.8082 - acc: 0.7870
Epoch 6/28

8/8 [==============================] - 0s 34ms/step - loss: 0.7644 - acc: 0.7870
Epoch 7/28

8/8 [==============================] - 0s 34ms/step - loss: 0.6976 - acc: 0.7870
Epoch 8/28

8/8 [==============================] - 0s 34ms/step - loss: 0.6125 - acc: 0.7870
Epoch 9/28

8/8 [==============================] - 0s 34ms/step - loss: 0.5949 - acc: 0.7870
Epoch 10/28

8/8 [==============================] - 0s 32ms/step - loss: 0.5585 - acc: 0.7870
Epoch 11/28

8/8 [==============================] - 0s 32ms/step - loss: 0.4977 - acc: 0.8284
Epoch 12/28

8/8 [==============================] - 0s 33ms/step - loss: 0.4558 - acc: 0.8166
Epoch 13/28

8/8 [==============================] - 0s 33ms/step - loss: 0.4074 - acc: 0.8757
Epoch 14/28

8/8 [==============================] - 0s 33ms/step - loss: 0.3664 - acc: 0.8462
Epoch 15/28

8/8 [==============================] - 0s 33ms/step - loss: 0.3261 - acc: 0.9349
Epoch 16/28

8/8 [==============================] - 0s 34ms/step - loss: 0.3120 - acc: 0.8757
Epoch 17/28

8/8 [==============================] - 0s 32ms/step - loss: 0.2876 - acc: 0.9408
Epoch 18/28

8/8 [==============================] - 0s 32ms/step - loss: 0.2632 - acc: 0.9231
Epoch 19/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2372 - acc: 0.9527
Epoch 20/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2035 - acc: 0.9290
Epoch 21/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1788 - acc: 0.9645
Epoch 22/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1532 - acc: 0.9645
Epoch 23/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1652 - acc: 0.9704
Epoch 24/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1226 - acc: 0.9941
Epoch 25/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1218 - acc: 0.9822
Epoch 26/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1070 - acc: 1.0000
Epoch 27/28

8/8 [==============================] - 0s 32ms/step - loss: 0.0947 - acc: 0.9882
Epoch 28/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0880 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7202
False 1869
True percentage 0.793958769706
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.88      0.95      0.91      7318
      B-PER       0.43      0.24      0.31       438
      B-LOC       0.52      0.29      0.37       218
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-ORG       0.42      0.24      0.30       296
      I-ORG       0.38      0.09      0.14       151
      I-LOC       0.71      0.04      0.07       141
      I-PER       1.00      0.04      0.08       214

avg / total       0.80      0.79      0.78      9071

F-1 Score (without O):
0.228571428571
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 100017 unique words.
Found 92 unique chars.
Found 9 unique labels.
13 unique words not found in embedding.
8 unique chars not found in embedding.
Number of OOV: 325
OOV word occurences: 630
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401152     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,586
Trainable params: 6,507,586
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 2s 246ms/step - loss: 2.1306 - acc: 0.2818
Epoch 2/28

8/8 [==============================] - 0s 34ms/step - loss: 1.3684 - acc: 0.6464
Epoch 3/28

8/8 [==============================] - 0s 35ms/step - loss: 1.3299 - acc: 0.6464
Epoch 4/28

8/8 [==============================] - 0s 34ms/step - loss: 1.2676 - acc: 0.6851
Epoch 5/28

8/8 [==============================] - 0s 34ms/step - loss: 1.0690 - acc: 0.6464
Epoch 6/28

8/8 [==============================] - 0s 33ms/step - loss: 0.9969 - acc: 0.6519
Epoch 7/28

8/8 [==============================] - 0s 34ms/step - loss: 0.9217 - acc: 0.6685
Epoch 8/28

8/8 [==============================] - 0s 34ms/step - loss: 0.8716 - acc: 0.7017
Epoch 9/28

8/8 [==============================] - 0s 35ms/step - loss: 0.7879 - acc: 0.7182
Epoch 10/28

8/8 [==============================] - 0s 34ms/step - loss: 0.7389 - acc: 0.7735
Epoch 11/28

8/8 [==============================] - 0s 34ms/step - loss: 0.7018 - acc: 0.7569
Epoch 12/28

8/8 [==============================] - 0s 33ms/step - loss: 0.6218 - acc: 0.8619
Epoch 13/28

8/8 [==============================] - 0s 34ms/step - loss: 0.5703 - acc: 0.8287
Epoch 14/28

8/8 [==============================] - 0s 34ms/step - loss: 0.5186 - acc: 0.9227
Epoch 15/28

8/8 [==============================] - 0s 33ms/step - loss: 0.4738 - acc: 0.8729
Epoch 16/28

8/8 [==============================] - 0s 34ms/step - loss: 0.4058 - acc: 0.9337
Epoch 17/28

8/8 [==============================] - 0s 33ms/step - loss: 0.3670 - acc: 0.9171
Epoch 18/28

8/8 [==============================] - 0s 34ms/step - loss: 0.3189 - acc: 0.9613
Epoch 19/28

8/8 [==============================] - 0s 33ms/step - loss: 0.3082 - acc: 0.9503
Epoch 20/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2814 - acc: 0.9558
Epoch 21/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2512 - acc: 0.9613
Epoch 22/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2350 - acc: 0.9448
Epoch 23/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2505 - acc: 0.9448
Epoch 24/28

8/8 [==============================] - 0s 32ms/step - loss: 0.2330 - acc: 0.9558
Epoch 25/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1766 - acc: 0.9613
Epoch 26/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1726 - acc: 0.9669
Epoch 27/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1525 - acc: 0.9779
Epoch 28/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1368 - acc: 0.9724
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7178
False 1893
True percentage 0.791312975416
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.89      0.95      0.92      7318
      B-ORG       0.49      0.24      0.32       296
      I-ORG       0.10      0.11      0.10       151
      B-PER       0.50      0.23      0.32       438
      I-PER       0.42      0.22      0.29       214
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.50      0.03      0.06       154

avg / total       0.78      0.79      0.78      9071

F-1 Score (without O):
0.202521008403
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 100020 unique words.
Found 92 unique chars.
Found 9 unique labels.
16 unique words not found in embedding.
8 unique chars not found in embedding.
Number of OOV: 327
OOV word occurences: 638
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401344     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,778
Trainable params: 6,507,778
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 2s 246ms/step - loss: 2.4847 - acc: 0.0511
Epoch 2/28

8/8 [==============================] - 0s 33ms/step - loss: 1.4142 - acc: 0.7841
Epoch 3/28

8/8 [==============================] - 0s 34ms/step - loss: 0.9346 - acc: 0.7841
Epoch 4/28

8/8 [==============================] - 0s 33ms/step - loss: 0.8729 - acc: 0.7841
Epoch 5/28

8/8 [==============================] - 0s 34ms/step - loss: 0.8167 - acc: 0.7841
Epoch 6/28

8/8 [==============================] - 0s 33ms/step - loss: 0.7712 - acc: 0.7841
Epoch 7/28

8/8 [==============================] - 0s 33ms/step - loss: 0.7210 - acc: 0.7841
Epoch 8/28

8/8 [==============================] - 0s 32ms/step - loss: 0.6860 - acc: 0.7898
Epoch 9/28

8/8 [==============================] - 0s 32ms/step - loss: 0.6379 - acc: 0.7841
Epoch 10/28

8/8 [==============================] - 0s 33ms/step - loss: 0.5637 - acc: 0.7898
Epoch 11/28

8/8 [==============================] - 0s 32ms/step - loss: 0.5167 - acc: 0.8182
Epoch 12/28

8/8 [==============================] - 0s 33ms/step - loss: 0.4940 - acc: 0.8295
Epoch 13/28

8/8 [==============================] - 0s 33ms/step - loss: 0.4562 - acc: 0.8693
Epoch 14/28

8/8 [==============================] - 0s 33ms/step - loss: 0.4124 - acc: 0.8580
Epoch 15/28

8/8 [==============================] - 0s 34ms/step - loss: 0.4415 - acc: 0.9261
Epoch 16/28

8/8 [==============================] - 0s 32ms/step - loss: 0.3584 - acc: 0.8807
Epoch 17/28

8/8 [==============================] - 0s 33ms/step - loss: 0.3501 - acc: 0.9148
Epoch 18/28

8/8 [==============================] - 0s 34ms/step - loss: 0.3070 - acc: 0.9034
Epoch 19/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2833 - acc: 0.9261
Epoch 20/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2560 - acc: 0.9318
Epoch 21/28

8/8 [==============================] - 0s 32ms/step - loss: 0.2265 - acc: 0.9602
Epoch 22/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2242 - acc: 0.9489
Epoch 23/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2398 - acc: 0.9716
Epoch 24/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2074 - acc: 0.9602
Epoch 25/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1781 - acc: 0.9659
Epoch 26/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1750 - acc: 0.9716
Epoch 27/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1583 - acc: 0.9773
Epoch 28/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1452 - acc: 0.9830
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7052
False 2019
True percentage 0.777422555396
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.88      0.94      0.91      7318
      B-ORG       0.32      0.21      0.25       296
      I-ORG       0.20      0.13      0.16       151
      B-PER       0.70      0.08      0.15       438
      I-PER       0.18      0.01      0.02       214
     B-MISC       0.06      0.09      0.08       141
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.40      0.05      0.08       218
      I-LOC       0.75      0.02      0.04       141

avg / total       0.79      0.78      0.76      9071

F-1 Score (without O):
0.124308216262
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 100019 unique words.
Found 92 unique chars.
Found 9 unique labels.
15 unique words not found in embedding.
8 unique chars not found in embedding.
Number of OOV: 324
OOV word occurences: 623
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401280     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,714
Trainable params: 6,507,714
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 2s 243ms/step - loss: 2.1150 - acc: 0.3005
Epoch 2/28

8/8 [==============================] - 0s 34ms/step - loss: 0.9938 - acc: 0.8290
Epoch 3/28

8/8 [==============================] - 0s 34ms/step - loss: 0.8325 - acc: 0.8290
Epoch 4/28

8/8 [==============================] - 0s 33ms/step - loss: 0.7295 - acc: 0.8290
Epoch 5/28

8/8 [==============================] - 0s 34ms/step - loss: 0.6538 - acc: 0.8290
Epoch 6/28

8/8 [==============================] - 0s 33ms/step - loss: 0.6110 - acc: 0.8290
Epoch 7/28

8/8 [==============================] - 0s 35ms/step - loss: 0.5731 - acc: 0.8290
Epoch 8/28

8/8 [==============================] - 0s 33ms/step - loss: 0.5559 - acc: 0.8290
Epoch 9/28

8/8 [==============================] - 0s 33ms/step - loss: 0.5162 - acc: 0.8290
Epoch 10/28

8/8 [==============================] - 0s 33ms/step - loss: 0.4907 - acc: 0.8342
Epoch 11/28

8/8 [==============================] - 0s 33ms/step - loss: 0.4677 - acc: 0.8342
Epoch 12/28

8/8 [==============================] - 0s 33ms/step - loss: 0.4345 - acc: 0.8342
Epoch 13/28

8/8 [==============================] - 0s 34ms/step - loss: 0.4115 - acc: 0.8497
Epoch 14/28

8/8 [==============================] - 0s 34ms/step - loss: 0.3618 - acc: 0.8653
Epoch 15/28

8/8 [==============================] - 0s 32ms/step - loss: 0.3465 - acc: 0.8756
Epoch 16/28

8/8 [==============================] - 0s 33ms/step - loss: 0.3119 - acc: 0.8756
Epoch 17/28

8/8 [==============================] - 0s 32ms/step - loss: 0.2952 - acc: 0.9067
Epoch 18/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2680 - acc: 0.9119
Epoch 19/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2654 - acc: 0.9223
Epoch 20/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2495 - acc: 0.9119
Epoch 21/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2385 - acc: 0.9534
Epoch 22/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1963 - acc: 0.9482
Epoch 23/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1930 - acc: 0.9534
Epoch 24/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1755 - acc: 0.9741
Epoch 25/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1695 - acc: 0.9637
Epoch 26/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1450 - acc: 0.9741
Epoch 27/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1434 - acc: 0.9845
Epoch 28/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1404 - acc: 0.9637
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7174
False 1897
True percentage 0.790872009701
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.43      0.40      0.41       438
          O       0.90      0.94      0.92      7318
      B-LOC       0.08      0.00      0.01       218
      B-ORG       0.37      0.38      0.37       296
      I-PER       0.23      0.05      0.08       214
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      I-ORG       0.13      0.06      0.08       151
      I-LOC       0.00      0.00      0.00       141

avg / total       0.77      0.79      0.78      9071

F-1 Score (without O):
0.839510615329
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 100010 unique words.
Found 88 unique chars.
Found 9 unique labels.
6 unique words not found in embedding.
4 unique chars not found in embedding.
Number of OOV: 328
OOV word occurences: 641
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5696        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6400704     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,506,882
Trainable params: 6,506,882
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 2s 248ms/step - loss: 2.3269 - acc: 0.0152
Epoch 2/28

8/8 [==============================] - 0s 33ms/step - loss: 1.5508 - acc: 0.7576
Epoch 3/28

8/8 [==============================] - 0s 34ms/step - loss: 0.9563 - acc: 0.7273
Epoch 4/28

8/8 [==============================] - 0s 34ms/step - loss: 1.0087 - acc: 0.7955
Epoch 5/28

8/8 [==============================] - 0s 34ms/step - loss: 1.0181 - acc: 0.7273
Epoch 6/28

8/8 [==============================] - 0s 34ms/step - loss: 0.9284 - acc: 0.8106
Epoch 7/28

8/8 [==============================] - 0s 33ms/step - loss: 0.7296 - acc: 0.7576
Epoch 8/28

8/8 [==============================] - 0s 34ms/step - loss: 0.6606 - acc: 0.7576
Epoch 9/28

8/8 [==============================] - 0s 34ms/step - loss: 0.6100 - acc: 0.8030
Epoch 10/28

8/8 [==============================] - 0s 33ms/step - loss: 0.5878 - acc: 0.7955
Epoch 11/28

8/8 [==============================] - 0s 33ms/step - loss: 0.5338 - acc: 0.8333
Epoch 12/28

8/8 [==============================] - 0s 34ms/step - loss: 0.5013 - acc: 0.8409
Epoch 13/28

8/8 [==============================] - 0s 33ms/step - loss: 0.4662 - acc: 0.8485
Epoch 14/28

8/8 [==============================] - 0s 34ms/step - loss: 0.4276 - acc: 0.8561
Epoch 15/28

8/8 [==============================] - 0s 34ms/step - loss: 0.3875 - acc: 0.8788
Epoch 16/28

8/8 [==============================] - 0s 34ms/step - loss: 0.3382 - acc: 0.8712
Epoch 17/28

8/8 [==============================] - 0s 34ms/step - loss: 0.3217 - acc: 0.9545
Epoch 18/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2976 - acc: 0.9167
Epoch 19/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2571 - acc: 0.9773
Epoch 20/28

8/8 [==============================] - 0s 35ms/step - loss: 0.2498 - acc: 0.9470
Epoch 21/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2293 - acc: 0.9848
Epoch 22/28

8/8 [==============================] - 0s 35ms/step - loss: 0.1897 - acc: 0.9924
Epoch 23/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1676 - acc: 0.9924
Epoch 24/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1658 - acc: 0.9773
Epoch 25/28

8/8 [==============================] - 0s 35ms/step - loss: 0.1546 - acc: 0.9924
Epoch 26/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1628 - acc: 0.9697
Epoch 27/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2034 - acc: 0.9773
Epoch 28/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1197 - acc: 0.9924
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7111
False 1960
True percentage 0.783926799691
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.89      0.94      0.91      7318
     B-MISC       0.00      0.00      0.00       141
      B-ORG       0.26      0.39      0.31       296
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.53      0.27      0.35       218
      I-ORG       0.50      0.05      0.08       151
      B-PER       0.91      0.02      0.04       438
      I-PER       0.45      0.11      0.18       214
      I-LOC       0.00      0.00      0.00       141

avg / total       0.80      0.78      0.76      9071

F-1 Score (without O):
0.176836861768
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 100014 unique words.
Found 87 unique chars.
Found 8 unique labels.
10 unique words not found in embedding.
3 unique chars not found in embedding.
Number of OOV: 325
OOV word occurences: 635
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5632        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6400960     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,506,924
Trainable params: 6,506,924
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 2s 246ms/step - loss: 2.1470 - acc: 0.0380
Epoch 2/28

8/8 [==============================] - 0s 33ms/step - loss: 1.0960 - acc: 0.8291
Epoch 3/28

8/8 [==============================] - 0s 33ms/step - loss: 0.7762 - acc: 0.8291
Epoch 4/28

8/8 [==============================] - 0s 34ms/step - loss: 0.7235 - acc: 0.8291
Epoch 5/28

8/8 [==============================] - 0s 33ms/step - loss: 0.6523 - acc: 0.8291
Epoch 6/28

8/8 [==============================] - 0s 33ms/step - loss: 0.6113 - acc: 0.8291
Epoch 7/28

8/8 [==============================] - 0s 35ms/step - loss: 0.5903 - acc: 0.8291
Epoch 8/28

8/8 [==============================] - 0s 34ms/step - loss: 0.5402 - acc: 0.8291
Epoch 9/28

8/8 [==============================] - 0s 34ms/step - loss: 0.5122 - acc: 0.8291
Epoch 10/28

8/8 [==============================] - 0s 33ms/step - loss: 0.4649 - acc: 0.8291
Epoch 11/28

8/8 [==============================] - 0s 34ms/step - loss: 0.4475 - acc: 0.8481
Epoch 12/28

8/8 [==============================] - 0s 33ms/step - loss: 0.4238 - acc: 0.8291
Epoch 13/28

8/8 [==============================] - 0s 34ms/step - loss: 0.4036 - acc: 0.9177
Epoch 14/28

8/8 [==============================] - 0s 33ms/step - loss: 0.3442 - acc: 0.8291
Epoch 15/28

8/8 [==============================] - 0s 33ms/step - loss: 0.3068 - acc: 0.9241
Epoch 16/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2747 - acc: 0.9177
Epoch 17/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2585 - acc: 0.9241
Epoch 18/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2263 - acc: 0.9557
Epoch 19/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2090 - acc: 0.9430
Epoch 20/28

8/8 [==============================] - 0s 32ms/step - loss: 0.2051 - acc: 0.9810
Epoch 21/28

8/8 [==============================] - 0s 34ms/step - loss: 0.3420 - acc: 0.9114
Epoch 22/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2322 - acc: 0.9937
Epoch 23/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1728 - acc: 0.9873
Epoch 24/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1419 - acc: 0.9873
Epoch 25/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1340 - acc: 0.9873
Epoch 26/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1134 - acc: 1.0000
Epoch 27/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1116 - acc: 0.9937
Epoch 28/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0973 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7116
False 1804
True percentage 0.797757847534
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.35      0.32      0.33       296
          O       0.86      0.96      0.91      7318
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.71      0.05      0.09       218
      I-LOC       0.00      0.00      0.00       141
      B-PER       0.64      0.02      0.04       438
      I-PER       0.71      0.05      0.09       214

avg / total       0.78      0.80      0.76      8920

F-1 Score (without O):
0.836480609996
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 100010 unique words.
Found 91 unique chars.
Found 8 unique labels.
6 unique words not found in embedding.
7 unique chars not found in embedding.
Number of OOV: 326
OOV word occurences: 639
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5888        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6400704     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,506,924
Trainable params: 6,506,924
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 2s 261ms/step - loss: 1.9348 - acc: 0.3356
Epoch 2/28

8/8 [==============================] - 0s 33ms/step - loss: 0.8461 - acc: 0.8591
Epoch 3/28

8/8 [==============================] - 0s 34ms/step - loss: 0.7183 - acc: 0.8591
Epoch 4/28

8/8 [==============================] - 0s 34ms/step - loss: 0.6029 - acc: 0.8591
Epoch 5/28

8/8 [==============================] - 0s 35ms/step - loss: 0.5191 - acc: 0.8591
Epoch 6/28

8/8 [==============================] - 0s 34ms/step - loss: 0.4863 - acc: 0.8591
Epoch 7/28

8/8 [==============================] - 0s 34ms/step - loss: 0.4547 - acc: 0.8591
Epoch 8/28

8/8 [==============================] - 0s 33ms/step - loss: 0.4174 - acc: 0.8591
Epoch 9/28

8/8 [==============================] - 0s 34ms/step - loss: 0.3841 - acc: 0.8591
Epoch 10/28

8/8 [==============================] - 0s 33ms/step - loss: 0.3568 - acc: 0.8658
Epoch 11/28

8/8 [==============================] - 0s 34ms/step - loss: 0.3412 - acc: 0.8792
Epoch 12/28

8/8 [==============================] - 0s 33ms/step - loss: 0.3042 - acc: 0.8792
Epoch 13/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2860 - acc: 0.8993
Epoch 14/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2629 - acc: 0.8926
Epoch 15/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2314 - acc: 0.9396
Epoch 16/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2172 - acc: 0.9262
Epoch 17/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2024 - acc: 0.9597
Epoch 18/28

8/8 [==============================] - 0s 35ms/step - loss: 0.1868 - acc: 0.9195
Epoch 19/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2009 - acc: 0.9530
Epoch 20/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1543 - acc: 0.9530
Epoch 21/28

8/8 [==============================] - 0s 35ms/step - loss: 0.1435 - acc: 0.9597
Epoch 22/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1274 - acc: 0.9799
Epoch 23/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1196 - acc: 0.9799
Epoch 24/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1009 - acc: 0.9866
Epoch 25/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1017 - acc: 0.9866
Epoch 26/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0947 - acc: 0.9866
Epoch 27/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0885 - acc: 0.9933
Epoch 28/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1105 - acc: 0.9463
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7064
False 1866
True percentage 0.791041433371
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.88      0.94      0.91      7318
      B-PER       0.36      0.17      0.23       438
      B-ORG       0.27      0.32      0.30       296
     B-MISC       0.00      0.00      0.00       141
      I-PER       0.61      0.07      0.12       214
      I-ORG       0.00      0.00      0.00       151
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.00      0.00      0.00       218

avg / total       0.76      0.79      0.77      8930

F-1 Score (without O):
0.167272727273
