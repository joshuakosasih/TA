Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.4424 - acc: 0.8734
Epoch 2/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.2166 - acc: 0.9355
Epoch 3/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.1620 - acc: 0.9517
Epoch 4/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.1367 - acc: 0.9596
Epoch 5/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.1163 - acc: 0.9659
Epoch 6/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.1019 - acc: 0.9703
Epoch 7/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0908 - acc: 0.9738
Epoch 8/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0802 - acc: 0.9774
Epoch 9/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0736 - acc: 0.9795
Epoch 10/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0646 - acc: 0.9824
Epoch 11/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0601 - acc: 0.9830
Epoch 12/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0559 - acc: 0.9844
Epoch 13/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0525 - acc: 0.9857
Epoch 14/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0480 - acc: 0.9864
Epoch 15/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0447 - acc: 0.9873
Epoch 16/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0415 - acc: 0.9884
Epoch 17/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0414 - acc: 0.9882
Epoch 18/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0384 - acc: 0.9888
Epoch 19/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0356 - acc: 0.9896
Epoch 20/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0329 - acc: 0.9903
Epoch 21/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0332 - acc: 0.9903
Epoch 22/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0326 - acc: 0.9901
Epoch 23/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0288 - acc: 0.9919
Epoch 24/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0289 - acc: 0.9922
Epoch 25/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0259 - acc: 0.9929
Epoch 26/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0254 - acc: 0.9930
Epoch 27/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0245 - acc: 0.9931
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8247
False 824
True percentage 0.909161062727
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
      B-LOC       0.74      0.74      0.74       218
      I-LOC       0.70      0.78      0.74       141
      B-PER       0.92      0.84      0.88       438
      B-ORG       0.73      0.77      0.75       296
      I-ORG       0.60      0.64      0.62       151
     B-MISC       0.43      0.26      0.32       141
     I-MISC       0.57      0.42      0.49       154
      I-PER       0.92      0.65      0.77       214

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.718377088305
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.4631 - acc: 0.8654
Epoch 2/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.2232 - acc: 0.9339
Epoch 3/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.1695 - acc: 0.9491
Epoch 4/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.1382 - acc: 0.9590
Epoch 5/27

1674/1674 [==============================] - 48s 28ms/step - loss: 0.1193 - acc: 0.9645
Epoch 6/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.1023 - acc: 0.9703
Epoch 7/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0915 - acc: 0.9742
Epoch 8/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0825 - acc: 0.9764
Epoch 9/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0747 - acc: 0.9791
Epoch 10/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0683 - acc: 0.9805
Epoch 11/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0630 - acc: 0.9826
Epoch 12/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0574 - acc: 0.9838
Epoch 13/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0538 - acc: 0.9844
Epoch 14/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0496 - acc: 0.9861
Epoch 15/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0469 - acc: 0.9866
Epoch 16/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0439 - acc: 0.9873
Epoch 17/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0411 - acc: 0.9882
Epoch 18/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0384 - acc: 0.9889
Epoch 19/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0360 - acc: 0.9900
Epoch 20/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0333 - acc: 0.9905
Epoch 21/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0339 - acc: 0.9906
Epoch 22/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0315 - acc: 0.9906
Epoch 23/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0304 - acc: 0.9909
Epoch 24/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0295 - acc: 0.9908
Epoch 25/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0288 - acc: 0.9918
Epoch 26/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0262 - acc: 0.9926
Epoch 27/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0260 - acc: 0.9925
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8239
False 832
True percentage 0.908279131298
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.93      0.83      0.88       438
      I-PER       0.94      0.65      0.77       214
          O       0.98      0.96      0.97      7318
      B-ORG       0.76      0.72      0.74       296
      I-ORG       0.65      0.60      0.62       151
      B-LOC       0.78      0.74      0.76       218
      I-LOC       0.72      0.81      0.76       141
     B-MISC       0.38      0.30      0.34       141
     I-MISC       0.52      0.44      0.48       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.92711644884
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 48s 28ms/step - loss: 0.4696 - acc: 0.8633
Epoch 2/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.2278 - acc: 0.9333
Epoch 3/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.1771 - acc: 0.9489
Epoch 4/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.1434 - acc: 0.9578
Epoch 5/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.1248 - acc: 0.9643
Epoch 6/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.1092 - acc: 0.9688
Epoch 7/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0958 - acc: 0.9727
Epoch 8/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0862 - acc: 0.9760
Epoch 9/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0770 - acc: 0.9792
Epoch 10/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0721 - acc: 0.9801
Epoch 11/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0662 - acc: 0.9814
Epoch 12/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0597 - acc: 0.9837
Epoch 13/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0571 - acc: 0.9844
Epoch 14/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0516 - acc: 0.9859
Epoch 15/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0488 - acc: 0.9860
Epoch 16/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0448 - acc: 0.9877
Epoch 17/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0430 - acc: 0.9877
Epoch 18/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0409 - acc: 0.9877
Epoch 19/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0395 - acc: 0.9888
Epoch 20/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0369 - acc: 0.9900
Epoch 21/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0338 - acc: 0.9907
Epoch 22/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0328 - acc: 0.9903
Epoch 23/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0319 - acc: 0.9909
Epoch 24/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0301 - acc: 0.9910
Epoch 25/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0306 - acc: 0.9912
Epoch 26/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0286 - acc: 0.9914
Epoch 27/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0277 - acc: 0.9920
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8242
False 829
True percentage 0.908609855584
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.91      0.83      0.87       438
      B-LOC       0.74      0.78      0.76       218
     B-MISC       0.42      0.29      0.34       141
     I-MISC       0.54      0.42      0.47       154
      B-ORG       0.77      0.74      0.75       296
      I-ORG       0.63      0.66      0.64       151
      I-LOC       0.73      0.80      0.77       141
      I-PER       0.90      0.62      0.74       214

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.720047804004
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.4523 - acc: 0.8690
Epoch 2/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.2177 - acc: 0.9350
Epoch 3/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.1685 - acc: 0.9498
Epoch 4/27

1674/1674 [==============================] - 48s 28ms/step - loss: 0.1390 - acc: 0.9580
Epoch 5/27

1674/1674 [==============================] - 48s 28ms/step - loss: 0.1217 - acc: 0.9644
Epoch 6/27

1674/1674 [==============================] - 48s 28ms/step - loss: 0.1031 - acc: 0.9701
Epoch 7/27

1674/1674 [==============================] - 48s 28ms/step - loss: 0.0937 - acc: 0.9732
Epoch 8/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0841 - acc: 0.9765
Epoch 9/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0756 - acc: 0.9785
Epoch 10/27

1674/1674 [==============================] - 48s 28ms/step - loss: 0.0694 - acc: 0.9802
Epoch 11/27

1674/1674 [==============================] - 48s 28ms/step - loss: 0.0637 - acc: 0.9820
Epoch 12/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0573 - acc: 0.9835
Epoch 13/27

1674/1674 [==============================] - 48s 28ms/step - loss: 0.0537 - acc: 0.9845
Epoch 14/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0506 - acc: 0.9856
Epoch 15/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0476 - acc: 0.9859
Epoch 16/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0429 - acc: 0.9878
Epoch 17/27

1674/1674 [==============================] - 48s 28ms/step - loss: 0.0429 - acc: 0.9873
Epoch 18/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0389 - acc: 0.9897
Epoch 19/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0375 - acc: 0.9893
Epoch 20/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0347 - acc: 0.9900
Epoch 21/27

1674/1674 [==============================] - 48s 28ms/step - loss: 0.0324 - acc: 0.9906
Epoch 22/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0320 - acc: 0.9911
Epoch 23/27

1674/1674 [==============================] - 48s 28ms/step - loss: 0.0302 - acc: 0.9912
Epoch 24/27

1674/1674 [==============================] - 48s 28ms/step - loss: 0.0287 - acc: 0.9916
Epoch 25/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0274 - acc: 0.9923
Epoch 26/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0258 - acc: 0.9930
Epoch 27/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0250 - acc: 0.9927
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8262
False 809
True percentage 0.910814684158
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.78      0.73      0.75       296
      I-ORG       0.65      0.63      0.64       151
      B-PER       0.91      0.85      0.88       438
      I-PER       0.93      0.64      0.76       214
      B-LOC       0.78      0.74      0.76       218
      I-LOC       0.76      0.78      0.77       141
     B-MISC       0.44      0.34      0.38       141
     I-MISC       0.54      0.47      0.50       154

avg / total       0.94      0.91      0.93      9071

F-1 Score (without O):
0.729348152598
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.4553 - acc: 0.8642
Epoch 2/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.2146 - acc: 0.9356
Epoch 3/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.1678 - acc: 0.9484
Epoch 4/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.1398 - acc: 0.9578
Epoch 5/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.1217 - acc: 0.9641
Epoch 6/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.1059 - acc: 0.9688
Epoch 7/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0930 - acc: 0.9732
Epoch 8/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0857 - acc: 0.9746
Epoch 9/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0772 - acc: 0.9780
Epoch 10/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0709 - acc: 0.9804
Epoch 11/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0641 - acc: 0.9820
Epoch 12/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0597 - acc: 0.9834
Epoch 13/27

1674/1674 [==============================] - 48s 28ms/step - loss: 0.0555 - acc: 0.9843
Epoch 14/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0523 - acc: 0.9853
Epoch 15/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0481 - acc: 0.9869
Epoch 16/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0442 - acc: 0.9873
Epoch 17/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0419 - acc: 0.9878
Epoch 18/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0388 - acc: 0.9889
Epoch 19/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0385 - acc: 0.9895
Epoch 20/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0345 - acc: 0.9907
Epoch 21/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0347 - acc: 0.9899
Epoch 22/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0321 - acc: 0.9909
Epoch 23/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0308 - acc: 0.9914
Epoch 24/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0293 - acc: 0.9914
Epoch 25/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0281 - acc: 0.9921
Epoch 26/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0264 - acc: 0.9924
Epoch 27/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0250 - acc: 0.9930
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8229
False 842
True percentage 0.90717671701
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.74      0.75      0.75       296
      I-ORG       0.60      0.65      0.62       151
      B-PER       0.90      0.82      0.86       438
      I-PER       0.90      0.65      0.76       214
     B-MISC       0.44      0.27      0.33       141
     I-MISC       0.58      0.38      0.46       154
      B-LOC       0.74      0.73      0.74       218
      I-LOC       0.73      0.77      0.75       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.7134256472
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.4528 - acc: 0.8684
Epoch 2/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.2213 - acc: 0.9330
Epoch 3/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.1707 - acc: 0.9486
Epoch 4/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.1446 - acc: 0.9561
Epoch 5/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.1220 - acc: 0.9639
Epoch 6/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.1075 - acc: 0.9689
Epoch 7/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0963 - acc: 0.9722
Epoch 8/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0858 - acc: 0.9752
Epoch 9/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0776 - acc: 0.9781
Epoch 10/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0704 - acc: 0.9800
Epoch 11/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0646 - acc: 0.9818
Epoch 12/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0588 - acc: 0.9827
Epoch 13/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0552 - acc: 0.9844
Epoch 14/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0510 - acc: 0.9854
Epoch 15/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0489 - acc: 0.9860
Epoch 16/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0442 - acc: 0.9875
Epoch 17/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0417 - acc: 0.9884
Epoch 18/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0380 - acc: 0.9893
Epoch 19/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0381 - acc: 0.9893
Epoch 20/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0359 - acc: 0.9899
Epoch 21/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0338 - acc: 0.9904
Epoch 22/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0332 - acc: 0.9908
Epoch 23/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0300 - acc: 0.9914
Epoch 24/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0282 - acc: 0.9925
Epoch 25/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0280 - acc: 0.9922
Epoch 26/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0263 - acc: 0.9927
Epoch 27/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0257 - acc: 0.9928
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8258
False 813
True percentage 0.910373718443
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.90      0.83      0.87       438
          O       0.99      0.96      0.97      7318
      B-LOC       0.77      0.73      0.75       218
      B-ORG       0.78      0.75      0.76       296
      I-PER       0.88      0.63      0.74       214
     B-MISC       0.43      0.34      0.38       141
     I-MISC       0.52      0.53      0.53       154
      I-ORG       0.66      0.63      0.64       151
      I-LOC       0.77      0.79      0.78       141

avg / total       0.94      0.91      0.93      9071

F-1 Score (without O):
0.929901036758
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.4640 - acc: 0.8659
Epoch 2/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.2286 - acc: 0.9315
Epoch 3/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.1731 - acc: 0.9477
Epoch 4/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.1436 - acc: 0.9575
Epoch 5/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.1234 - acc: 0.9642
Epoch 6/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.1068 - acc: 0.9695
Epoch 7/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0952 - acc: 0.9729
Epoch 8/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0870 - acc: 0.9752
Epoch 9/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0764 - acc: 0.9785
Epoch 10/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0698 - acc: 0.9802
Epoch 11/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0630 - acc: 0.9823
Epoch 12/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0600 - acc: 0.9827
Epoch 13/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0569 - acc: 0.9842
Epoch 14/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0494 - acc: 0.9862
Epoch 15/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0475 - acc: 0.9873
Epoch 16/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0449 - acc: 0.9874
Epoch 17/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0420 - acc: 0.9873
Epoch 18/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0389 - acc: 0.9889
Epoch 19/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0371 - acc: 0.9894
Epoch 20/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0348 - acc: 0.9901
Epoch 21/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0351 - acc: 0.9899
Epoch 22/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0326 - acc: 0.9905
Epoch 23/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0311 - acc: 0.9913
Epoch 24/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0288 - acc: 0.9919
Epoch 25/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0282 - acc: 0.9920
Epoch 26/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0272 - acc: 0.9918
Epoch 27/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0273 - acc: 0.9919
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8240
False 831
True percentage 0.908389372726
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
     B-MISC       0.39      0.26      0.31       141
      B-ORG       0.78      0.74      0.76       296
     I-MISC       0.51      0.41      0.45       154
      B-LOC       0.75      0.76      0.76       218
      I-ORG       0.62      0.62      0.62       151
      B-PER       0.94      0.83      0.88       438
      I-PER       0.93      0.64      0.76       214
      I-LOC       0.77      0.80      0.78       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.721886336155
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.4472 - acc: 0.8684
Epoch 2/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.2188 - acc: 0.9340
Epoch 3/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.1690 - acc: 0.9492
Epoch 4/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.1381 - acc: 0.9597
Epoch 5/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.1199 - acc: 0.9642
Epoch 6/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.1043 - acc: 0.9704
Epoch 7/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0921 - acc: 0.9739
Epoch 8/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0832 - acc: 0.9762
Epoch 9/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0747 - acc: 0.9786
Epoch 10/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0685 - acc: 0.9811
Epoch 11/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0636 - acc: 0.9828
Epoch 12/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0579 - acc: 0.9837
Epoch 13/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0541 - acc: 0.9845
Epoch 14/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0488 - acc: 0.9864
Epoch 15/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0458 - acc: 0.9866
Epoch 16/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0451 - acc: 0.9871
Epoch 17/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0415 - acc: 0.9880
Epoch 18/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0393 - acc: 0.9889
Epoch 19/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0375 - acc: 0.9891
Epoch 20/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0366 - acc: 0.9893
Epoch 21/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0346 - acc: 0.9898
Epoch 22/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0325 - acc: 0.9903
Epoch 23/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0314 - acc: 0.9911
Epoch 24/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0284 - acc: 0.9917
Epoch 25/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0279 - acc: 0.9914
Epoch 26/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0273 - acc: 0.9919
Epoch 27/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0265 - acc: 0.9923
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8266
False 805
True percentage 0.911255649873
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.81      0.75      0.78       296
          O       0.99      0.96      0.97      7318
     B-MISC       0.41      0.34      0.37       141
     I-MISC       0.50      0.45      0.48       154
      B-LOC       0.75      0.78      0.77       218
      I-LOC       0.74      0.84      0.79       141
      B-PER       0.91      0.84      0.87       438
      I-PER       0.92      0.64      0.75       214
      I-ORG       0.66      0.68      0.67       151

avg / total       0.94      0.91      0.93      9071

F-1 Score (without O):
0.93262987013
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 8
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.4620 - acc: 0.8641
Epoch 2/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.2250 - acc: 0.9329
Epoch 3/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.1739 - acc: 0.9492
Epoch 4/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.1431 - acc: 0.9580
Epoch 5/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.1222 - acc: 0.9647
Epoch 6/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.1075 - acc: 0.9691
Epoch 7/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0945 - acc: 0.9733
Epoch 8/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0834 - acc: 0.9763
Epoch 9/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0766 - acc: 0.9790
Epoch 10/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0716 - acc: 0.9801
Epoch 11/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0648 - acc: 0.9819
Epoch 12/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0612 - acc: 0.9824
Epoch 13/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0544 - acc: 0.9850
Epoch 14/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0516 - acc: 0.9859
Epoch 15/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0480 - acc: 0.9864
Epoch 16/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0431 - acc: 0.9881
Epoch 17/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0408 - acc: 0.9887
Epoch 18/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0395 - acc: 0.9886
Epoch 19/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0377 - acc: 0.9893
Epoch 20/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0366 - acc: 0.9896
Epoch 21/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0332 - acc: 0.9907
Epoch 22/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0329 - acc: 0.9907
Epoch 23/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0314 - acc: 0.9916
Epoch 24/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0304 - acc: 0.9911
Epoch 25/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0280 - acc: 0.9917
Epoch 26/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0277 - acc: 0.9914
Epoch 27/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0265 - acc: 0.9926
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8234
False 837
True percentage 0.907727924154
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.77      0.72      0.74       296
          O       0.98      0.96      0.97      7318
      B-LOC       0.74      0.73      0.74       218
      I-LOC       0.74      0.77      0.76       141
      I-ORG       0.64      0.65      0.65       151
      B-PER       0.91      0.83      0.87       438
      I-PER       0.93      0.65      0.77       214
     B-MISC       0.40      0.32      0.35       141
     I-MISC       0.51      0.48      0.49       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.930294595222
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 9
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.4748 - acc: 0.8634
Epoch 2/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.2300 - acc: 0.9318
Epoch 3/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.1758 - acc: 0.9476
Epoch 4/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.1458 - acc: 0.9576
Epoch 5/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.1229 - acc: 0.9647
Epoch 6/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.1073 - acc: 0.9687
Epoch 7/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0958 - acc: 0.9715
Epoch 8/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0865 - acc: 0.9748
Epoch 9/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0774 - acc: 0.9784
Epoch 10/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0697 - acc: 0.9801
Epoch 11/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0640 - acc: 0.9818
Epoch 12/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0584 - acc: 0.9834
Epoch 13/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0543 - acc: 0.9851
Epoch 14/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0511 - acc: 0.9854
Epoch 15/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0470 - acc: 0.9872
Epoch 16/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0437 - acc: 0.9878
Epoch 17/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0412 - acc: 0.9883
Epoch 18/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0408 - acc: 0.9883
Epoch 19/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0367 - acc: 0.9894
Epoch 20/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0357 - acc: 0.9894
Epoch 21/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0325 - acc: 0.9909
Epoch 22/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0325 - acc: 0.9910
Epoch 23/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0298 - acc: 0.9913
Epoch 24/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0289 - acc: 0.9916
Epoch 25/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0285 - acc: 0.9914
Epoch 26/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0267 - acc: 0.9924
Epoch 27/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0259 - acc: 0.9928
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8244
False 827
True percentage 0.908830338441
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-LOC       0.76      0.73      0.75       218
      I-LOC       0.77      0.77      0.77       141
      B-ORG       0.77      0.75      0.76       296
      B-PER       0.89      0.84      0.86       438
      I-PER       0.92      0.64      0.76       214
      I-ORG       0.63      0.64      0.63       151
     B-MISC       0.38      0.29      0.33       141
     I-MISC       0.55      0.48      0.51       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.721194029851
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 10
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.4602 - acc: 0.8642
Epoch 2/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.2214 - acc: 0.9335
Epoch 3/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.1683 - acc: 0.9499
Epoch 4/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.1396 - acc: 0.9591
Epoch 5/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.1174 - acc: 0.9647
Epoch 6/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.1033 - acc: 0.9702
Epoch 7/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0912 - acc: 0.9739
Epoch 8/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0804 - acc: 0.9780
Epoch 9/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0737 - acc: 0.9798
Epoch 10/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0667 - acc: 0.9815
Epoch 11/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0641 - acc: 0.9820
Epoch 12/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0577 - acc: 0.9838
Epoch 13/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0540 - acc: 0.9847
Epoch 14/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0498 - acc: 0.9857
Epoch 15/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0481 - acc: 0.9863
Epoch 16/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0440 - acc: 0.9876
Epoch 17/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0417 - acc: 0.9883
Epoch 18/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0388 - acc: 0.9891
Epoch 19/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0365 - acc: 0.9902
Epoch 20/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0352 - acc: 0.9901
Epoch 21/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0324 - acc: 0.9912
Epoch 22/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0309 - acc: 0.9913
Epoch 23/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0302 - acc: 0.9917
Epoch 24/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0289 - acc: 0.9917
Epoch 25/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0293 - acc: 0.9913
Epoch 26/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0288 - acc: 0.9913
Epoch 27/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0252 - acc: 0.9927
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8224
False 847
True percentage 0.906625509867
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.78      0.75      0.76       296
      I-ORG       0.65      0.58      0.61       151
      B-LOC       0.74      0.72      0.73       218
      B-PER       0.88      0.84      0.86       438
      I-PER       0.89      0.64      0.75       214
     B-MISC       0.36      0.28      0.32       141
     I-MISC       0.50      0.43      0.46       154
      I-LOC       0.74      0.80      0.77       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.710196779964
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 11
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.4487 - acc: 0.8713
Epoch 2/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.2192 - acc: 0.9343
Epoch 3/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.1701 - acc: 0.9485
Epoch 4/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.1424 - acc: 0.9586
Epoch 5/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.1219 - acc: 0.9638
Epoch 6/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.1043 - acc: 0.9699
Epoch 7/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0940 - acc: 0.9734
Epoch 8/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0844 - acc: 0.9760
Epoch 9/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0770 - acc: 0.9783
Epoch 10/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0674 - acc: 0.9818
Epoch 11/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0637 - acc: 0.9821
Epoch 12/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0578 - acc: 0.9835
Epoch 13/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0541 - acc: 0.9851
Epoch 14/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0514 - acc: 0.9858
Epoch 15/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0480 - acc: 0.9868
Epoch 16/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0437 - acc: 0.9877
Epoch 17/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0416 - acc: 0.9880
Epoch 18/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0419 - acc: 0.9875
Epoch 19/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0383 - acc: 0.9888
Epoch 20/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0349 - acc: 0.9898
Epoch 21/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0355 - acc: 0.9902
Epoch 22/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0314 - acc: 0.9909
Epoch 23/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0312 - acc: 0.9909
Epoch 24/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0279 - acc: 0.9924
Epoch 25/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0289 - acc: 0.9918
Epoch 26/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0283 - acc: 0.9915
Epoch 27/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0262 - acc: 0.9920
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8241
False 830
True percentage 0.908499614155
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
      B-ORG       0.78      0.73      0.76       296
      I-ORG       0.64      0.64      0.64       151
     B-MISC       0.39      0.40      0.40       141
      B-LOC       0.77      0.72      0.75       218
      B-PER       0.92      0.84      0.88       438
     I-MISC       0.46      0.47      0.47       154
      I-PER       0.92      0.63      0.75       214
      I-LOC       0.73      0.77      0.75       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.716780112459
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 48s 28ms/step - loss: 0.4816 - acc: 0.8622
Epoch 2/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.2287 - acc: 0.9316
Epoch 3/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.1745 - acc: 0.9486
Epoch 4/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.1443 - acc: 0.9582
Epoch 5/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.1233 - acc: 0.9642
Epoch 6/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.1073 - acc: 0.9697
Epoch 7/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0958 - acc: 0.9729
Epoch 8/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0872 - acc: 0.9757
Epoch 9/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0780 - acc: 0.9775
Epoch 10/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0717 - acc: 0.9800
Epoch 11/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0646 - acc: 0.9820
Epoch 12/27

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0608 - acc: 0.9833
Epoch 13/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0574 - acc: 0.9838
Epoch 14/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0525 - acc: 0.9855
Epoch 15/27

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0487 - acc: 0.9867
Epoch 16/27

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0460 - acc: 0.9873
Epoch 17/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0452 - acc: 0.9867
Epoch 18/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0413 - acc: 0.9881
Epoch 19/27

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0396 - acc: 0.9887
Epoch 20/27

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0370 - acc: 0.9894
Epoch 21/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0368 - acc: 0.9897
Epoch 22/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0341 - acc: 0.9901
Epoch 23/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0327 - acc: 0.9905
Epoch 24/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0295 - acc: 0.9913
Epoch 25/27

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0301 - acc: 0.9912
Epoch 26/27

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0279 - acc: 0.9916
Epoch 27/27

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0258 - acc: 0.9927
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8236
False 835
True percentage 0.907948407011
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
      B-PER       0.91      0.83      0.87       438
      B-ORG       0.75      0.75      0.75       296
     B-MISC       0.38      0.30      0.33       141
      I-PER       0.87      0.66      0.75       214
      I-ORG       0.63      0.63      0.63       151
     I-MISC       0.50      0.43      0.46       154
      B-LOC       0.76      0.73      0.75       218
      I-LOC       0.75      0.82      0.78       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.713946587537
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100819 unique words.
Found 94 unique chars.
Found 9 unique labels.
815 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 256
OOV word occurences: 380
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6452480     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,559,042
Trainable params: 6,559,042
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 25s 30ms/step - loss: 0.5880 - acc: 0.8289
Epoch 2/27

837/837 [==============================] - 23s 28ms/step - loss: 0.2974 - acc: 0.9132
Epoch 3/27

837/837 [==============================] - 23s 28ms/step - loss: 0.2209 - acc: 0.9357
Epoch 4/27

837/837 [==============================] - 23s 28ms/step - loss: 0.1824 - acc: 0.9472
Epoch 5/27

837/837 [==============================] - 23s 28ms/step - loss: 0.1551 - acc: 0.9562
Epoch 6/27

837/837 [==============================] - 23s 28ms/step - loss: 0.1340 - acc: 0.9636
Epoch 7/27

837/837 [==============================] - 23s 28ms/step - loss: 0.1176 - acc: 0.9677
Epoch 8/27

837/837 [==============================] - 23s 28ms/step - loss: 0.1050 - acc: 0.9712
Epoch 9/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0936 - acc: 0.9755
Epoch 10/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0875 - acc: 0.9767
Epoch 11/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0768 - acc: 0.9804
Epoch 12/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0695 - acc: 0.9824
Epoch 13/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0634 - acc: 0.9829
Epoch 14/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0588 - acc: 0.9844
Epoch 15/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0543 - acc: 0.9860
Epoch 16/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0504 - acc: 0.9867
Epoch 17/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0468 - acc: 0.9869
Epoch 18/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0430 - acc: 0.9891
Epoch 19/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0430 - acc: 0.9876
Epoch 20/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0402 - acc: 0.9887
Epoch 21/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0367 - acc: 0.9902
Epoch 22/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0355 - acc: 0.9895
Epoch 23/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0319 - acc: 0.9921
Epoch 24/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0305 - acc: 0.9928
Epoch 25/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0283 - acc: 0.9933
Epoch 26/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0276 - acc: 0.9920
Epoch 27/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0286 - acc: 0.9923
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8153
False 918
True percentage 0.898798368427
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-LOC       0.69      0.75      0.72       218
      I-LOC       0.72      0.82      0.77       141
      B-PER       0.90      0.79      0.84       438
      B-ORG       0.74      0.70      0.72       296
      I-ORG       0.62      0.55      0.58       151
     B-MISC       0.41      0.21      0.28       141
     I-MISC       0.48      0.36      0.41       154
      I-PER       0.92      0.62      0.74       214

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.691674290942
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 100791 unique words.
Found 94 unique chars.
Found 9 unique labels.
787 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 260
OOV word occurences: 406
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6450688     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,557,250
Trainable params: 6,557,250
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 24s 29ms/step - loss: 0.6189 - acc: 0.8259
Epoch 2/27

837/837 [==============================] - 23s 27ms/step - loss: 0.3119 - acc: 0.9059
Epoch 3/27

837/837 [==============================] - 23s 27ms/step - loss: 0.2344 - acc: 0.9312
Epoch 4/27

837/837 [==============================] - 23s 27ms/step - loss: 0.1894 - acc: 0.9450
Epoch 5/27

837/837 [==============================] - 23s 27ms/step - loss: 0.1563 - acc: 0.9548
Epoch 6/27

837/837 [==============================] - 23s 27ms/step - loss: 0.1377 - acc: 0.9615
Epoch 7/27

837/837 [==============================] - 23s 27ms/step - loss: 0.1211 - acc: 0.9651
Epoch 8/27

837/837 [==============================] - 23s 27ms/step - loss: 0.1099 - acc: 0.9680
Epoch 9/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0959 - acc: 0.9732
Epoch 10/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0870 - acc: 0.9768
Epoch 11/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0811 - acc: 0.9781
Epoch 12/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0735 - acc: 0.9795
Epoch 13/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0675 - acc: 0.9814
Epoch 14/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0629 - acc: 0.9830
Epoch 15/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0581 - acc: 0.9855
Epoch 16/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0550 - acc: 0.9852
Epoch 17/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0499 - acc: 0.9862
Epoch 18/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0462 - acc: 0.9883
Epoch 19/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0457 - acc: 0.9884
Epoch 20/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0419 - acc: 0.9889
Epoch 21/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0389 - acc: 0.9905
Epoch 22/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0369 - acc: 0.9907
Epoch 23/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0340 - acc: 0.9919
Epoch 24/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0326 - acc: 0.9921
Epoch 25/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0326 - acc: 0.9915
Epoch 26/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0275 - acc: 0.9934
Epoch 27/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0270 - acc: 0.9938
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8107
False 964
True percentage 0.893727262705
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.90      0.73      0.80       438
      I-PER       0.92      0.61      0.73       214
          O       0.98      0.96      0.97      7318
      B-ORG       0.74      0.72      0.73       296
      I-ORG       0.57      0.62      0.59       151
      B-LOC       0.73      0.70      0.71       218
      I-LOC       0.74      0.72      0.73       141
     B-MISC       0.38      0.23      0.29       141
     I-MISC       0.44      0.30      0.36       154

avg / total       0.93      0.89      0.91      9071

F-1 Score (without O):
0.919371974973
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100794 unique words.
Found 94 unique chars.
Found 9 unique labels.
790 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 260
OOV word occurences: 391
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6450880     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,557,442
Trainable params: 6,557,442
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 26s 31ms/step - loss: 0.5857 - acc: 0.8296
Epoch 2/27

837/837 [==============================] - 24s 28ms/step - loss: 0.3030 - acc: 0.9133
Epoch 3/27

837/837 [==============================] - 24s 28ms/step - loss: 0.2161 - acc: 0.9390
Epoch 4/27

837/837 [==============================] - 24s 28ms/step - loss: 0.1747 - acc: 0.9466
Epoch 5/27

837/837 [==============================] - 24s 28ms/step - loss: 0.1521 - acc: 0.9550
Epoch 6/27

837/837 [==============================] - 24s 28ms/step - loss: 0.1308 - acc: 0.9610
Epoch 7/27

837/837 [==============================] - 24s 29ms/step - loss: 0.1124 - acc: 0.9676
Epoch 8/27

837/837 [==============================] - 24s 28ms/step - loss: 0.1018 - acc: 0.9701
Epoch 9/27

837/837 [==============================] - 24s 28ms/step - loss: 0.0874 - acc: 0.9768
Epoch 10/27

837/837 [==============================] - 24s 29ms/step - loss: 0.0828 - acc: 0.9768
Epoch 11/27

837/837 [==============================] - 24s 28ms/step - loss: 0.0768 - acc: 0.9775
Epoch 12/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0689 - acc: 0.9808
Epoch 13/27

837/837 [==============================] - 24s 28ms/step - loss: 0.0630 - acc: 0.9839
Epoch 14/27

837/837 [==============================] - 24s 28ms/step - loss: 0.0576 - acc: 0.9839
Epoch 15/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0557 - acc: 0.9848
Epoch 16/27

837/837 [==============================] - 24s 28ms/step - loss: 0.0496 - acc: 0.9868
Epoch 17/27

837/837 [==============================] - 24s 28ms/step - loss: 0.0460 - acc: 0.9875
Epoch 18/27

837/837 [==============================] - 24s 28ms/step - loss: 0.0430 - acc: 0.9884
Epoch 19/27

837/837 [==============================] - 24s 28ms/step - loss: 0.0399 - acc: 0.9900
Epoch 20/27

837/837 [==============================] - 24s 29ms/step - loss: 0.0373 - acc: 0.9906
Epoch 21/27

837/837 [==============================] - 24s 28ms/step - loss: 0.0339 - acc: 0.9923
Epoch 22/27

837/837 [==============================] - 24s 28ms/step - loss: 0.0332 - acc: 0.9918
Epoch 23/27

837/837 [==============================] - 24s 29ms/step - loss: 0.0321 - acc: 0.9927
Epoch 24/27

837/837 [==============================] - 24s 28ms/step - loss: 0.0300 - acc: 0.9929
Epoch 25/27

837/837 [==============================] - 24s 28ms/step - loss: 0.0289 - acc: 0.9924
Epoch 26/27

837/837 [==============================] - 24s 28ms/step - loss: 0.0281 - acc: 0.9928
Epoch 27/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0262 - acc: 0.9939
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8094
False 977
True percentage 0.892294124132
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.97      7318
      B-PER       0.90      0.73      0.81       438
      B-LOC       0.75      0.68      0.71       218
     B-MISC       0.33      0.32      0.32       141
     I-MISC       0.46      0.50      0.48       154
      B-ORG       0.74      0.70      0.72       296
      I-ORG       0.54      0.56      0.55       151
      I-LOC       0.80      0.70      0.75       141
      I-PER       0.90      0.62      0.73       214

avg / total       0.93      0.89      0.91      9071

F-1 Score (without O):
0.670488835244
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 100743 unique words.
Found 94 unique chars.
Found 9 unique labels.
739 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 259
OOV word occurences: 396
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6447616     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,554,178
Trainable params: 6,554,178
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 25s 29ms/step - loss: 0.5698 - acc: 0.8371
Epoch 2/27

837/837 [==============================] - 23s 27ms/step - loss: 0.2812 - acc: 0.9181
Epoch 3/27

837/837 [==============================] - 23s 27ms/step - loss: 0.2150 - acc: 0.9360
Epoch 4/27

837/837 [==============================] - 23s 27ms/step - loss: 0.1787 - acc: 0.9490
Epoch 5/27

837/837 [==============================] - 23s 27ms/step - loss: 0.1511 - acc: 0.9565
Epoch 6/27

837/837 [==============================] - 22s 27ms/step - loss: 0.1308 - acc: 0.9629
Epoch 7/27

837/837 [==============================] - 23s 27ms/step - loss: 0.1173 - acc: 0.9667
Epoch 8/27

837/837 [==============================] - 23s 27ms/step - loss: 0.1066 - acc: 0.9708
Epoch 9/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0930 - acc: 0.9754
Epoch 10/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0834 - acc: 0.9772
Epoch 11/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0752 - acc: 0.9802
Epoch 12/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0701 - acc: 0.9812
Epoch 13/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0623 - acc: 0.9839
Epoch 14/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0590 - acc: 0.9846
Epoch 15/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0547 - acc: 0.9858
Epoch 16/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0493 - acc: 0.9882
Epoch 17/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0464 - acc: 0.9869
Epoch 18/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0432 - acc: 0.9886
Epoch 19/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0399 - acc: 0.9897
Epoch 20/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0376 - acc: 0.9901
Epoch 21/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0343 - acc: 0.9912
Epoch 22/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0326 - acc: 0.9916
Epoch 23/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0319 - acc: 0.9909
Epoch 24/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0293 - acc: 0.9919
Epoch 25/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0282 - acc: 0.9928
Epoch 26/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0258 - acc: 0.9935
Epoch 27/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0250 - acc: 0.9938
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8125
False 946
True percentage 0.895711608422
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.76      0.74      0.75       296
      I-ORG       0.60      0.54      0.57       151
      B-PER       0.89      0.73      0.80       438
      I-PER       0.87      0.65      0.75       214
      B-LOC       0.69      0.69      0.69       218
      I-LOC       0.75      0.74      0.74       141
     B-MISC       0.40      0.33      0.36       141
     I-MISC       0.58      0.33      0.42       154

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.682432432432
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 100791 unique words.
Found 94 unique chars.
Found 9 unique labels.
787 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 254
OOV word occurences: 388
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6450688     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,557,250
Trainable params: 6,557,250
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 25s 30ms/step - loss: 0.5724 - acc: 0.8343
Epoch 2/27

837/837 [==============================] - 24s 29ms/step - loss: 0.2801 - acc: 0.9177
Epoch 3/27

837/837 [==============================] - 24s 28ms/step - loss: 0.2150 - acc: 0.9345
Epoch 4/27

837/837 [==============================] - 24s 28ms/step - loss: 0.1682 - acc: 0.9503
Epoch 5/27

837/837 [==============================] - 23s 28ms/step - loss: 0.1424 - acc: 0.9586
Epoch 6/27

837/837 [==============================] - 23s 28ms/step - loss: 0.1219 - acc: 0.9667
Epoch 7/27

837/837 [==============================] - 23s 28ms/step - loss: 0.1099 - acc: 0.9690
Epoch 8/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0958 - acc: 0.9743
Epoch 9/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0847 - acc: 0.9772
Epoch 10/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0768 - acc: 0.9796
Epoch 11/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0702 - acc: 0.9821
Epoch 12/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0668 - acc: 0.9818
Epoch 13/27

837/837 [==============================] - 24s 28ms/step - loss: 0.0603 - acc: 0.9842
Epoch 14/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0542 - acc: 0.9861
Epoch 15/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0520 - acc: 0.9857
Epoch 16/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0470 - acc: 0.9873
Epoch 17/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0419 - acc: 0.9896
Epoch 18/27

837/837 [==============================] - 24s 28ms/step - loss: 0.0401 - acc: 0.9894
Epoch 19/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0409 - acc: 0.9891
Epoch 20/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0362 - acc: 0.9904
Epoch 21/27

837/837 [==============================] - 24s 28ms/step - loss: 0.0328 - acc: 0.9917
Epoch 22/27

837/837 [==============================] - 24s 28ms/step - loss: 0.0327 - acc: 0.9905
Epoch 23/27

837/837 [==============================] - 24s 28ms/step - loss: 0.0294 - acc: 0.9931
Epoch 24/27

837/837 [==============================] - 24s 28ms/step - loss: 0.0295 - acc: 0.9923
Epoch 25/27

837/837 [==============================] - 24s 28ms/step - loss: 0.0268 - acc: 0.9931
Epoch 26/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0271 - acc: 0.9931
Epoch 27/27

837/837 [==============================] - 24s 28ms/step - loss: 0.0251 - acc: 0.9938
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8108
False 963
True percentage 0.893837504134
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.78      0.68      0.72       296
      I-ORG       0.60      0.48      0.53       151
      B-PER       0.90      0.75      0.82       438
      I-PER       0.88      0.62      0.73       214
     B-MISC       0.39      0.23      0.29       141
     I-MISC       0.41      0.31      0.35       154
      B-LOC       0.68      0.73      0.70       218
      I-LOC       0.71      0.73      0.72       141

avg / total       0.93      0.89      0.91      9071

F-1 Score (without O):
0.666666666667
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 100816 unique words.
Found 94 unique chars.
Found 9 unique labels.
812 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 253
OOV word occurences: 361
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6452288     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,558,850
Trainable params: 6,558,850
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 25s 30ms/step - loss: 0.5804 - acc: 0.8339
Epoch 2/27

837/837 [==============================] - 23s 27ms/step - loss: 0.2881 - acc: 0.9145
Epoch 3/27

837/837 [==============================] - 23s 27ms/step - loss: 0.2034 - acc: 0.9410
Epoch 4/27

837/837 [==============================] - 23s 27ms/step - loss: 0.1681 - acc: 0.9501
Epoch 5/27

837/837 [==============================] - 23s 28ms/step - loss: 0.1417 - acc: 0.9592
Epoch 6/27

837/837 [==============================] - 23s 27ms/step - loss: 0.1218 - acc: 0.9657
Epoch 7/27

837/837 [==============================] - 23s 28ms/step - loss: 0.1087 - acc: 0.9687
Epoch 8/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0967 - acc: 0.9729
Epoch 9/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0879 - acc: 0.9757
Epoch 10/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0791 - acc: 0.9785
Epoch 11/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0713 - acc: 0.9808
Epoch 12/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0649 - acc: 0.9836
Epoch 13/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0598 - acc: 0.9846
Epoch 14/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0542 - acc: 0.9857
Epoch 15/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0514 - acc: 0.9862
Epoch 16/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0465 - acc: 0.9880
Epoch 17/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0432 - acc: 0.9885
Epoch 18/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0406 - acc: 0.9892
Epoch 19/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0390 - acc: 0.9891
Epoch 20/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0351 - acc: 0.9908
Epoch 21/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0344 - acc: 0.9906
Epoch 22/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0321 - acc: 0.9914
Epoch 23/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0293 - acc: 0.9927
Epoch 24/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0283 - acc: 0.9920
Epoch 25/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0258 - acc: 0.9935
Epoch 26/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0252 - acc: 0.9935
Epoch 27/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0245 - acc: 0.9934
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8137
False 934
True percentage 0.897034505567
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.89      0.79      0.84       438
          O       0.98      0.96      0.97      7318
      B-LOC       0.70      0.72      0.71       218
      B-ORG       0.72      0.75      0.73       296
      I-PER       0.86      0.67      0.75       214
     B-MISC       0.38      0.21      0.27       141
     I-MISC       0.50      0.25      0.34       154
      I-ORG       0.55      0.62      0.59       151
      I-LOC       0.63      0.74      0.68       141

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.919001828801
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 100782 unique words.
Found 94 unique chars.
Found 9 unique labels.
778 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 259
OOV word occurences: 372
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6450112     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,556,674
Trainable params: 6,556,674
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 24s 29ms/step - loss: 0.6030 - acc: 0.8316
Epoch 2/27

837/837 [==============================] - 23s 27ms/step - loss: 0.2986 - acc: 0.9128
Epoch 3/27

837/837 [==============================] - 22s 27ms/step - loss: 0.2218 - acc: 0.9354
Epoch 4/27

837/837 [==============================] - 23s 27ms/step - loss: 0.1789 - acc: 0.9469
Epoch 5/27

837/837 [==============================] - 22s 27ms/step - loss: 0.1512 - acc: 0.9561
Epoch 6/27

837/837 [==============================] - 22s 27ms/step - loss: 0.1314 - acc: 0.9632
Epoch 7/27

837/837 [==============================] - 23s 27ms/step - loss: 0.1160 - acc: 0.9687
Epoch 8/27

837/837 [==============================] - 23s 27ms/step - loss: 0.1003 - acc: 0.9731
Epoch 9/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0938 - acc: 0.9751
Epoch 10/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0825 - acc: 0.9782
Epoch 11/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0756 - acc: 0.9801
Epoch 12/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0692 - acc: 0.9815
Epoch 13/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0616 - acc: 0.9836
Epoch 14/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0572 - acc: 0.9850
Epoch 15/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0557 - acc: 0.9852
Epoch 16/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0487 - acc: 0.9871
Epoch 17/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0459 - acc: 0.9878
Epoch 18/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0442 - acc: 0.9883
Epoch 19/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0396 - acc: 0.9903
Epoch 20/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0370 - acc: 0.9910
Epoch 21/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0350 - acc: 0.9908
Epoch 22/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0332 - acc: 0.9916
Epoch 23/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0308 - acc: 0.9918
Epoch 24/27

837/837 [==============================] - 22s 27ms/step - loss: 0.0300 - acc: 0.9925
Epoch 25/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0285 - acc: 0.9923
Epoch 26/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0280 - acc: 0.9932
Epoch 27/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0280 - acc: 0.9922
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8159
False 912
True percentage 0.899459816999
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
     B-MISC       0.43      0.26      0.33       141
      B-ORG       0.75      0.69      0.72       296
     I-MISC       0.53      0.38      0.44       154
      B-LOC       0.73      0.74      0.73       218
      I-ORG       0.59      0.61      0.60       151
      B-PER       0.90      0.82      0.86       438
      I-PER       0.88      0.64      0.74       214
      I-LOC       0.72      0.79      0.75       141

avg / total       0.93      0.90      0.92      9071

F-1 Score (without O):
0.70015128593
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 100805 unique words.
Found 94 unique chars.
Found 9 unique labels.
801 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 260
OOV word occurences: 372
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6451584     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,558,146
Trainable params: 6,558,146
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 25s 30ms/step - loss: 0.5831 - acc: 0.8296
Epoch 2/27

837/837 [==============================] - 23s 28ms/step - loss: 0.2895 - acc: 0.9156
Epoch 3/27

837/837 [==============================] - 23s 28ms/step - loss: 0.2118 - acc: 0.9368
Epoch 4/27

837/837 [==============================] - 23s 28ms/step - loss: 0.1735 - acc: 0.9484
Epoch 5/27

837/837 [==============================] - 23s 28ms/step - loss: 0.1476 - acc: 0.9581
Epoch 6/27

837/837 [==============================] - 23s 28ms/step - loss: 0.1249 - acc: 0.9642
Epoch 7/27

837/837 [==============================] - 23s 28ms/step - loss: 0.1111 - acc: 0.9684
Epoch 8/27

837/837 [==============================] - 23s 28ms/step - loss: 0.1006 - acc: 0.9724
Epoch 9/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0901 - acc: 0.9763
Epoch 10/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0814 - acc: 0.9787
Epoch 11/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0724 - acc: 0.9814
Epoch 12/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0675 - acc: 0.9829
Epoch 13/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0599 - acc: 0.9839
Epoch 14/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0580 - acc: 0.9851
Epoch 15/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0537 - acc: 0.9864
Epoch 16/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0490 - acc: 0.9871
Epoch 17/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0470 - acc: 0.9883
Epoch 18/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0423 - acc: 0.9892
Epoch 19/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0401 - acc: 0.9898
Epoch 20/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0364 - acc: 0.9910
Epoch 21/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0360 - acc: 0.9907
Epoch 22/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0347 - acc: 0.9910
Epoch 23/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0316 - acc: 0.9921
Epoch 24/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0311 - acc: 0.9916
Epoch 25/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0277 - acc: 0.9931
Epoch 26/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0267 - acc: 0.9931
Epoch 27/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0250 - acc: 0.9940
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8131
False 940
True percentage 0.896373056995
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.70      0.71      0.71       296
          O       0.98      0.96      0.97      7318
     B-MISC       0.43      0.18      0.26       141
     I-MISC       0.50      0.25      0.34       154
      B-LOC       0.68      0.71      0.69       218
      I-LOC       0.74      0.71      0.72       141
      B-PER       0.89      0.80      0.84       438
      I-PER       0.89      0.65      0.75       214
      I-ORG       0.54      0.61      0.57       151

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.922431865828
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 8
Found 100004 word vectors.
Found 84 char vectors.
Found 100820 unique words.
Found 94 unique chars.
Found 9 unique labels.
816 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 259
OOV word occurences: 398
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6452544     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,559,106
Trainable params: 6,559,106
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 25s 29ms/step - loss: 0.6122 - acc: 0.8247
Epoch 2/27

837/837 [==============================] - 23s 27ms/step - loss: 0.2980 - acc: 0.9140
Epoch 3/27

837/837 [==============================] - 23s 27ms/step - loss: 0.2125 - acc: 0.9392
Epoch 4/27

837/837 [==============================] - 23s 27ms/step - loss: 0.1690 - acc: 0.9520
Epoch 5/27

837/837 [==============================] - 23s 27ms/step - loss: 0.1426 - acc: 0.9600
Epoch 6/27

837/837 [==============================] - 23s 27ms/step - loss: 0.1243 - acc: 0.9659
Epoch 7/27

837/837 [==============================] - 23s 27ms/step - loss: 0.1086 - acc: 0.9719
Epoch 8/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0940 - acc: 0.9754
Epoch 9/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0866 - acc: 0.9766
Epoch 10/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0763 - acc: 0.9795
Epoch 11/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0702 - acc: 0.9814
Epoch 12/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0640 - acc: 0.9821
Epoch 13/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0573 - acc: 0.9847
Epoch 14/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0547 - acc: 0.9857
Epoch 15/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0487 - acc: 0.9877
Epoch 16/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0451 - acc: 0.9886
Epoch 17/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0413 - acc: 0.9907
Epoch 18/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0390 - acc: 0.9914
Epoch 19/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0381 - acc: 0.9900
Epoch 20/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0355 - acc: 0.9915
Epoch 21/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0325 - acc: 0.9921
Epoch 22/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0300 - acc: 0.9933
Epoch 23/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0277 - acc: 0.9937
Epoch 24/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0270 - acc: 0.9935
Epoch 25/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0267 - acc: 0.9936
Epoch 26/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0250 - acc: 0.9945
Epoch 27/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0240 - acc: 0.9944
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8102
False 969
True percentage 0.893176055562
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.72      0.73      0.73       296
          O       0.98      0.96      0.97      7318
      B-LOC       0.68      0.69      0.69       218
      I-LOC       0.66      0.74      0.70       141
      I-ORG       0.62      0.55      0.58       151
      B-PER       0.90      0.75      0.82       438
      I-PER       0.94      0.61      0.74       214
     B-MISC       0.34      0.16      0.22       141
     I-MISC       0.46      0.29      0.36       154

avg / total       0.93      0.89      0.91      9071

F-1 Score (without O):
0.919748046192
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 9
Found 100004 word vectors.
Found 84 char vectors.
Found 100826 unique words.
Found 94 unique chars.
Found 9 unique labels.
822 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 258
OOV word occurences: 370
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6452928     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,559,490
Trainable params: 6,559,490
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 25s 30ms/step - loss: 0.5945 - acc: 0.8288
Epoch 2/27

837/837 [==============================] - 23s 27ms/step - loss: 0.2940 - acc: 0.9133
Epoch 3/27

837/837 [==============================] - 23s 27ms/step - loss: 0.2180 - acc: 0.9362
Epoch 4/27

837/837 [==============================] - 23s 27ms/step - loss: 0.1795 - acc: 0.9469
Epoch 5/27

837/837 [==============================] - 23s 27ms/step - loss: 0.1524 - acc: 0.9566
Epoch 6/27

837/837 [==============================] - 23s 27ms/step - loss: 0.1321 - acc: 0.9624
Epoch 7/27

837/837 [==============================] - 23s 27ms/step - loss: 0.1151 - acc: 0.9686
Epoch 8/27

837/837 [==============================] - 23s 27ms/step - loss: 0.1017 - acc: 0.9726
Epoch 9/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0920 - acc: 0.9736
Epoch 10/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0837 - acc: 0.9776
Epoch 11/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0730 - acc: 0.9806
Epoch 12/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0690 - acc: 0.9809
Epoch 13/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0616 - acc: 0.9839
Epoch 14/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0574 - acc: 0.9859
Epoch 15/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0536 - acc: 0.9850
Epoch 16/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0500 - acc: 0.9869
Epoch 17/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0477 - acc: 0.9875
Epoch 18/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0430 - acc: 0.9888
Epoch 19/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0405 - acc: 0.9899
Epoch 20/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0378 - acc: 0.9904
Epoch 21/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0364 - acc: 0.9904
Epoch 22/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0340 - acc: 0.9914
Epoch 23/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0291 - acc: 0.9930
Epoch 24/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0310 - acc: 0.9925
Epoch 25/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0280 - acc: 0.9929
Epoch 26/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0277 - acc: 0.9924
Epoch 27/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0274 - acc: 0.9926
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8170
False 901
True percentage 0.900672472715
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-LOC       0.76      0.75      0.75       218
      I-LOC       0.83      0.77      0.80       141
      B-ORG       0.79      0.73      0.76       296
      B-PER       0.87      0.80      0.83       438
      I-PER       0.88      0.61      0.72       214
      I-ORG       0.63      0.66      0.65       151
     B-MISC       0.37      0.26      0.31       141
     I-MISC       0.47      0.44      0.45       154

avg / total       0.94      0.90      0.92      9071

F-1 Score (without O):
0.705386698766
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 10
Found 100004 word vectors.
Found 84 char vectors.
Found 100794 unique words.
Found 94 unique chars.
Found 9 unique labels.
790 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 261
OOV word occurences: 381
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6450880     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,557,442
Trainable params: 6,557,442
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 25s 30ms/step - loss: 0.5738 - acc: 0.8391
Epoch 2/27

837/837 [==============================] - 23s 27ms/step - loss: 0.2963 - acc: 0.9116
Epoch 3/27

837/837 [==============================] - 23s 28ms/step - loss: 0.2205 - acc: 0.9323
Epoch 4/27

837/837 [==============================] - 23s 28ms/step - loss: 0.1816 - acc: 0.9453
Epoch 5/27

837/837 [==============================] - 23s 28ms/step - loss: 0.1527 - acc: 0.9544
Epoch 6/27

837/837 [==============================] - 23s 28ms/step - loss: 0.1344 - acc: 0.9617
Epoch 7/27

837/837 [==============================] - 23s 28ms/step - loss: 0.1158 - acc: 0.9687
Epoch 8/27

837/837 [==============================] - 23s 28ms/step - loss: 0.1050 - acc: 0.9718
Epoch 9/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0948 - acc: 0.9734
Epoch 10/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0868 - acc: 0.9758
Epoch 11/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0785 - acc: 0.9790
Epoch 12/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0685 - acc: 0.9813
Epoch 13/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0657 - acc: 0.9811
Epoch 14/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0609 - acc: 0.9833
Epoch 15/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0558 - acc: 0.9858
Epoch 16/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0530 - acc: 0.9860
Epoch 17/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0493 - acc: 0.9876
Epoch 18/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0446 - acc: 0.9883
Epoch 19/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0435 - acc: 0.9890
Epoch 20/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0402 - acc: 0.9897
Epoch 21/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0364 - acc: 0.9905
Epoch 22/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0357 - acc: 0.9909
Epoch 23/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0316 - acc: 0.9924
Epoch 24/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0326 - acc: 0.9914
Epoch 25/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0306 - acc: 0.9919
Epoch 26/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0271 - acc: 0.9937
Epoch 27/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0262 - acc: 0.9930
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8161
False 910
True percentage 0.899680299857
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.96      0.97      7318
      B-ORG       0.80      0.69      0.74       296
      I-ORG       0.73      0.53      0.61       151
      B-LOC       0.71      0.72      0.72       218
      B-PER       0.89      0.79      0.84       438
      I-PER       0.94      0.65      0.77       214
     B-MISC       0.44      0.26      0.32       141
     I-MISC       0.47      0.33      0.39       154
      I-LOC       0.71      0.77      0.74       141

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.696300901461
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 11
Found 100004 word vectors.
Found 84 char vectors.
Found 100824 unique words.
Found 94 unique chars.
Found 9 unique labels.
820 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 261
OOV word occurences: 368
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6452800     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,559,362
Trainable params: 6,559,362
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 25s 30ms/step - loss: 0.6049 - acc: 0.8254
Epoch 2/27

837/837 [==============================] - 23s 27ms/step - loss: 0.3039 - acc: 0.9089
Epoch 3/27

837/837 [==============================] - 23s 28ms/step - loss: 0.2270 - acc: 0.9333
Epoch 4/27

837/837 [==============================] - 23s 27ms/step - loss: 0.1861 - acc: 0.9456
Epoch 5/27

837/837 [==============================] - 23s 28ms/step - loss: 0.1576 - acc: 0.9553
Epoch 6/27

837/837 [==============================] - 23s 27ms/step - loss: 0.1380 - acc: 0.9614
Epoch 7/27

837/837 [==============================] - 23s 27ms/step - loss: 0.1158 - acc: 0.9679
Epoch 8/27

837/837 [==============================] - 23s 27ms/step - loss: 0.1053 - acc: 0.9715
Epoch 9/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0950 - acc: 0.9737
Epoch 10/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0829 - acc: 0.9777
Epoch 11/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0756 - acc: 0.9796
Epoch 12/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0684 - acc: 0.9817
Epoch 13/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0639 - acc: 0.9839
Epoch 14/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0591 - acc: 0.9838
Epoch 15/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0552 - acc: 0.9856
Epoch 16/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0493 - acc: 0.9867
Epoch 17/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0449 - acc: 0.9878
Epoch 18/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0424 - acc: 0.9892
Epoch 19/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0391 - acc: 0.9893
Epoch 20/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0377 - acc: 0.9901
Epoch 21/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0374 - acc: 0.9896
Epoch 22/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0345 - acc: 0.9901
Epoch 23/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0330 - acc: 0.9906
Epoch 24/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0302 - acc: 0.9922
Epoch 25/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0284 - acc: 0.9929
Epoch 26/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0255 - acc: 0.9934
Epoch 27/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0259 - acc: 0.9935
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8175
False 896
True percentage 0.901223679859
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.74      0.72      0.73       296
      I-ORG       0.68      0.59      0.63       151
     B-MISC       0.40      0.23      0.29       141
      B-LOC       0.74      0.77      0.75       218
      B-PER       0.89      0.79      0.84       438
     I-MISC       0.51      0.36      0.42       154
      I-PER       0.93      0.62      0.74       214
      I-LOC       0.76      0.77      0.76       141

avg / total       0.93      0.90      0.92      9071

F-1 Score (without O):
0.700183936235
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 100771 unique words.
Found 94 unique chars.
Found 9 unique labels.
767 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 257
OOV word occurences: 396
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6449408     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,555,970
Trainable params: 6,555,970
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 25s 30ms/step - loss: 0.5724 - acc: 0.8345
Epoch 2/27

837/837 [==============================] - 23s 28ms/step - loss: 0.2904 - acc: 0.9139
Epoch 3/27

837/837 [==============================] - 23s 27ms/step - loss: 0.2193 - acc: 0.9346
Epoch 4/27

837/837 [==============================] - 23s 28ms/step - loss: 0.1773 - acc: 0.9463
Epoch 5/27

837/837 [==============================] - 23s 27ms/step - loss: 0.1547 - acc: 0.9542
Epoch 6/27

837/837 [==============================] - 23s 28ms/step - loss: 0.1344 - acc: 0.9596
Epoch 7/27

837/837 [==============================] - 23s 27ms/step - loss: 0.1208 - acc: 0.9665
Epoch 8/27

837/837 [==============================] - 23s 27ms/step - loss: 0.1078 - acc: 0.9694
Epoch 9/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0994 - acc: 0.9717
Epoch 10/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0866 - acc: 0.9766
Epoch 11/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0827 - acc: 0.9767
Epoch 12/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0756 - acc: 0.9800
Epoch 13/27

837/837 [==============================] - 23s 28ms/step - loss: 0.0704 - acc: 0.9809
Epoch 14/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0649 - acc: 0.9826
Epoch 15/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0598 - acc: 0.9846
Epoch 16/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0536 - acc: 0.9862
Epoch 17/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0503 - acc: 0.9860
Epoch 18/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0481 - acc: 0.9874
Epoch 19/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0471 - acc: 0.9872
Epoch 20/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0458 - acc: 0.9877
Epoch 21/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0408 - acc: 0.9894
Epoch 22/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0390 - acc: 0.9899
Epoch 23/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0374 - acc: 0.9895
Epoch 24/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0344 - acc: 0.9906
Epoch 25/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0325 - acc: 0.9916
Epoch 26/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0317 - acc: 0.9921
Epoch 27/27

837/837 [==============================] - 23s 27ms/step - loss: 0.0295 - acc: 0.9927
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8052
False 1019
True percentage 0.887663984125
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.97      7318
      B-PER       0.88      0.72      0.79       438
      B-ORG       0.67      0.67      0.67       296
     B-MISC       0.40      0.35      0.37       141
      I-PER       0.90      0.61      0.73       214
      I-ORG       0.45      0.48      0.46       151
     I-MISC       0.43      0.45      0.44       154
      B-LOC       0.74      0.71      0.72       218
      I-LOC       0.72      0.74      0.73       141

avg / total       0.93      0.89      0.91      9071

F-1 Score (without O):
0.652939421068
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100357 unique words.
Found 94 unique chars.
Found 9 unique labels.
353 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 289
OOV word occurences: 446
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6422912     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,529,474
Trainable params: 6,529,474
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 11s 34ms/step - loss: 0.8448 - acc: 0.7694
Epoch 2/27

334/334 [==============================] - 10s 29ms/step - loss: 0.4637 - acc: 0.8572
Epoch 3/27

334/334 [==============================] - 10s 29ms/step - loss: 0.3633 - acc: 0.8931
Epoch 4/27

334/334 [==============================] - 10s 29ms/step - loss: 0.2811 - acc: 0.9181
Epoch 5/27

334/334 [==============================] - 10s 29ms/step - loss: 0.2362 - acc: 0.9333
Epoch 6/27

334/334 [==============================] - 10s 29ms/step - loss: 0.2078 - acc: 0.9401
Epoch 7/27

334/334 [==============================] - 10s 28ms/step - loss: 0.1759 - acc: 0.9525
Epoch 8/27

334/334 [==============================] - 10s 29ms/step - loss: 0.1555 - acc: 0.9583
Epoch 9/27

334/334 [==============================] - 10s 29ms/step - loss: 0.1398 - acc: 0.9639
Epoch 10/27

334/334 [==============================] - 10s 29ms/step - loss: 0.1297 - acc: 0.9665
Epoch 11/27

334/334 [==============================] - 10s 29ms/step - loss: 0.1133 - acc: 0.9717
Epoch 12/27

334/334 [==============================] - 10s 29ms/step - loss: 0.1043 - acc: 0.9740
Epoch 13/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0943 - acc: 0.9770
Epoch 14/27

334/334 [==============================] - 10s 29ms/step - loss: 0.0849 - acc: 0.9807
Epoch 15/27

334/334 [==============================] - 10s 29ms/step - loss: 0.0780 - acc: 0.9810
Epoch 16/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0700 - acc: 0.9845
Epoch 17/27

334/334 [==============================] - 10s 29ms/step - loss: 0.0653 - acc: 0.9858
Epoch 18/27

334/334 [==============================] - 10s 29ms/step - loss: 0.0617 - acc: 0.9862
Epoch 19/27

334/334 [==============================] - 10s 29ms/step - loss: 0.0592 - acc: 0.9864
Epoch 20/27

334/334 [==============================] - 10s 29ms/step - loss: 0.0508 - acc: 0.9885
Epoch 21/27

334/334 [==============================] - 10s 29ms/step - loss: 0.0489 - acc: 0.9888
Epoch 22/27

334/334 [==============================] - 10s 29ms/step - loss: 0.0438 - acc: 0.9906
Epoch 23/27

334/334 [==============================] - 10s 29ms/step - loss: 0.0422 - acc: 0.9919
Epoch 24/27

334/334 [==============================] - 10s 28ms/step - loss: 0.0408 - acc: 0.9899
Epoch 25/27

334/334 [==============================] - 10s 29ms/step - loss: 0.0370 - acc: 0.9911
Epoch 26/27

334/334 [==============================] - 10s 29ms/step - loss: 0.0361 - acc: 0.9915
Epoch 27/27

334/334 [==============================] - 10s 29ms/step - loss: 0.0338 - acc: 0.9934
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7979
False 1092
True percentage 0.879616359828
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-LOC       0.65      0.64      0.65       218
      I-LOC       0.79      0.70      0.74       141
      B-PER       0.90      0.69      0.78       438
      B-ORG       0.69      0.69      0.69       296
      I-ORG       0.54      0.55      0.55       151
     B-MISC       0.41      0.23      0.29       141
     I-MISC       0.49      0.34      0.40       154
      I-PER       0.84      0.51      0.64       214

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.640375586854
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 100385 unique words.
Found 94 unique chars.
Found 9 unique labels.
381 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 282
OOV word occurences: 460
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6424704     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,531,266
Trainable params: 6,531,266
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 11s 33ms/step - loss: 0.8020 - acc: 0.7792
Epoch 2/27

334/334 [==============================] - 9s 28ms/step - loss: 0.4653 - acc: 0.8648
Epoch 3/27

334/334 [==============================] - 9s 28ms/step - loss: 0.3464 - acc: 0.8985
Epoch 4/27

334/334 [==============================] - 9s 28ms/step - loss: 0.2761 - acc: 0.9173
Epoch 5/27

334/334 [==============================] - 9s 28ms/step - loss: 0.2298 - acc: 0.9334
Epoch 6/27

334/334 [==============================] - 9s 28ms/step - loss: 0.2007 - acc: 0.9409
Epoch 7/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1742 - acc: 0.9534
Epoch 8/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1493 - acc: 0.9599
Epoch 9/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1324 - acc: 0.9656
Epoch 10/27

334/334 [==============================] - 9s 27ms/step - loss: 0.1228 - acc: 0.9676
Epoch 11/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1095 - acc: 0.9695
Epoch 12/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0979 - acc: 0.9784
Epoch 13/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0893 - acc: 0.9777
Epoch 14/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0818 - acc: 0.9792
Epoch 15/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0724 - acc: 0.9824
Epoch 16/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0661 - acc: 0.9847
Epoch 17/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0622 - acc: 0.9860
Epoch 18/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0598 - acc: 0.9850
Epoch 19/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0543 - acc: 0.9881
Epoch 20/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0508 - acc: 0.9889
Epoch 21/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0477 - acc: 0.9891
Epoch 22/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0456 - acc: 0.9888
Epoch 23/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0403 - acc: 0.9923
Epoch 24/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0378 - acc: 0.9918
Epoch 25/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0338 - acc: 0.9938
Epoch 26/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0334 - acc: 0.9929
Epoch 27/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0313 - acc: 0.9931
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7917
False 1154
True percentage 0.872781391247
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.85      0.65      0.74       438
      I-PER       0.86      0.53      0.65       214
          O       0.97      0.95      0.96      7318
      B-ORG       0.73      0.56      0.64       296
      I-ORG       0.48      0.44      0.46       151
      B-LOC       0.67      0.72      0.69       218
      I-LOC       0.63      0.72      0.67       141
     B-MISC       0.27      0.16      0.20       141
     I-MISC       0.29      0.14      0.19       154

avg / total       0.91      0.87      0.89      9071

F-1 Score (without O):
0.902767920511
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100372 unique words.
Found 94 unique chars.
Found 9 unique labels.
368 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 283
OOV word occurences: 438
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6423872     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,530,434
Trainable params: 6,530,434
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 11s 33ms/step - loss: 0.7950 - acc: 0.7807
Epoch 2/27

334/334 [==============================] - 9s 28ms/step - loss: 0.4388 - acc: 0.8687
Epoch 3/27

334/334 [==============================] - 9s 28ms/step - loss: 0.3245 - acc: 0.9007
Epoch 4/27

334/334 [==============================] - 9s 28ms/step - loss: 0.2585 - acc: 0.9278
Epoch 5/27

334/334 [==============================] - 10s 29ms/step - loss: 0.2074 - acc: 0.9444
Epoch 6/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1721 - acc: 0.9534
Epoch 7/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1534 - acc: 0.9576
Epoch 8/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1338 - acc: 0.9633
Epoch 9/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1149 - acc: 0.9710
Epoch 10/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1071 - acc: 0.9716
Epoch 11/27

334/334 [==============================] - 10s 28ms/step - loss: 0.0949 - acc: 0.9760
Epoch 12/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0831 - acc: 0.9803
Epoch 13/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0806 - acc: 0.9801
Epoch 14/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0696 - acc: 0.9840
Epoch 15/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0629 - acc: 0.9858
Epoch 16/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0592 - acc: 0.9858
Epoch 17/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0551 - acc: 0.9880
Epoch 18/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0512 - acc: 0.9894
Epoch 19/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0484 - acc: 0.9885
Epoch 20/27

334/334 [==============================] - 10s 28ms/step - loss: 0.0429 - acc: 0.9924
Epoch 21/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0410 - acc: 0.9907
Epoch 22/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0411 - acc: 0.9912
Epoch 23/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0360 - acc: 0.9932
Epoch 24/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0342 - acc: 0.9929
Epoch 25/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0324 - acc: 0.9939
Epoch 26/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0278 - acc: 0.9947
Epoch 27/27

334/334 [==============================] - 10s 28ms/step - loss: 0.0313 - acc: 0.9936
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8003
False 1068
True percentage 0.882262154118
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-PER       0.87      0.75      0.81       438
      B-LOC       0.68      0.61      0.65       218
     B-MISC       0.30      0.24      0.27       141
     I-MISC       0.40      0.38      0.39       154
      B-ORG       0.72      0.68      0.70       296
      I-ORG       0.58      0.46      0.51       151
      I-LOC       0.83      0.66      0.74       141
      I-PER       0.91      0.59      0.72       214

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.646876932591
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 100379 unique words.
Found 94 unique chars.
Found 9 unique labels.
375 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 284
OOV word occurences: 466
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6424320     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,530,882
Trainable params: 6,530,882
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 11s 33ms/step - loss: 0.7909 - acc: 0.7813
Epoch 2/27

334/334 [==============================] - 9s 27ms/step - loss: 0.4355 - acc: 0.8685
Epoch 3/27

334/334 [==============================] - 9s 27ms/step - loss: 0.3099 - acc: 0.9134
Epoch 4/27

334/334 [==============================] - 9s 28ms/step - loss: 0.2306 - acc: 0.9373
Epoch 5/27

334/334 [==============================] - 9s 27ms/step - loss: 0.1953 - acc: 0.9437
Epoch 6/27

334/334 [==============================] - 9s 27ms/step - loss: 0.1693 - acc: 0.9517
Epoch 7/27

334/334 [==============================] - 9s 27ms/step - loss: 0.1466 - acc: 0.9607
Epoch 8/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1285 - acc: 0.9652
Epoch 9/27

334/334 [==============================] - 9s 27ms/step - loss: 0.1114 - acc: 0.9704
Epoch 10/27

334/334 [==============================] - 9s 27ms/step - loss: 0.1008 - acc: 0.9746
Epoch 11/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0915 - acc: 0.9753
Epoch 12/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0824 - acc: 0.9788
Epoch 13/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0778 - acc: 0.9799
Epoch 14/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0701 - acc: 0.9810
Epoch 15/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0647 - acc: 0.9844
Epoch 16/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0600 - acc: 0.9843
Epoch 17/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0590 - acc: 0.9857
Epoch 18/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0500 - acc: 0.9878
Epoch 19/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0475 - acc: 0.9885
Epoch 20/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0432 - acc: 0.9911
Epoch 21/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0399 - acc: 0.9916
Epoch 22/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0378 - acc: 0.9907
Epoch 23/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0381 - acc: 0.9917
Epoch 24/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0322 - acc: 0.9931
Epoch 25/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0330 - acc: 0.9926
Epoch 26/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0312 - acc: 0.9929
Epoch 27/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0287 - acc: 0.9945
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7902
False 1169
True percentage 0.871127769816
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-ORG       0.75      0.63      0.69       296
      I-ORG       0.51      0.39      0.44       151
      B-PER       0.84      0.67      0.74       438
      I-PER       0.79      0.57      0.66       214
      B-LOC       0.70      0.65      0.67       218
      I-LOC       0.75      0.67      0.71       141
     B-MISC       0.24      0.20      0.22       141
     I-MISC       0.34      0.28      0.31       154

avg / total       0.91      0.87      0.89      9071

F-1 Score (without O):
0.606326338866
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 100389 unique words.
Found 94 unique chars.
Found 9 unique labels.
385 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 280
OOV word occurences: 436
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6424960     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,531,522
Trainable params: 6,531,522
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 11s 33ms/step - loss: 0.8012 - acc: 0.7817
Epoch 2/27

334/334 [==============================] - 9s 28ms/step - loss: 0.4483 - acc: 0.8646
Epoch 3/27

334/334 [==============================] - 10s 28ms/step - loss: 0.3417 - acc: 0.8984
Epoch 4/27

334/334 [==============================] - 10s 28ms/step - loss: 0.2788 - acc: 0.9155
Epoch 5/27

334/334 [==============================] - 9s 28ms/step - loss: 0.2254 - acc: 0.9343
Epoch 6/27

334/334 [==============================] - 9s 28ms/step - loss: 0.2011 - acc: 0.9418
Epoch 7/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1784 - acc: 0.9471
Epoch 8/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1529 - acc: 0.9588
Epoch 9/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1372 - acc: 0.9645
Epoch 10/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1261 - acc: 0.9707
Epoch 11/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1114 - acc: 0.9737
Epoch 12/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1070 - acc: 0.9728
Epoch 13/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0922 - acc: 0.9770
Epoch 14/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0836 - acc: 0.9809
Epoch 15/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0748 - acc: 0.9832
Epoch 16/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0722 - acc: 0.9841
Epoch 17/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0669 - acc: 0.9850
Epoch 18/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0645 - acc: 0.9843
Epoch 19/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0566 - acc: 0.9863
Epoch 20/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0511 - acc: 0.9878
Epoch 21/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0489 - acc: 0.9876
Epoch 22/27

334/334 [==============================] - 10s 28ms/step - loss: 0.0468 - acc: 0.9896
Epoch 23/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0435 - acc: 0.9911
Epoch 24/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0423 - acc: 0.9908
Epoch 25/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0391 - acc: 0.9904
Epoch 26/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0355 - acc: 0.9927
Epoch 27/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0338 - acc: 0.9931
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7998
False 1073
True percentage 0.881710946974
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.96      0.96      7318
      B-ORG       0.73      0.68      0.71       296
      I-ORG       0.48      0.40      0.44       151
      B-PER       0.89      0.70      0.78       438
      I-PER       0.87      0.50      0.64       214
     B-MISC       0.27      0.16      0.20       141
     I-MISC       0.37      0.30      0.33       154
      B-LOC       0.68      0.72      0.70       218
      I-LOC       0.80      0.62      0.70       141

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.623540549069
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 100374 unique words.
Found 94 unique chars.
Found 9 unique labels.
370 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 283
OOV word occurences: 451
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6424000     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,530,562
Trainable params: 6,530,562
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 11s 33ms/step - loss: 0.7984 - acc: 0.7766
Epoch 2/27

334/334 [==============================] - 9s 27ms/step - loss: 0.4683 - acc: 0.8636
Epoch 3/27

334/334 [==============================] - 9s 27ms/step - loss: 0.3461 - acc: 0.8986
Epoch 4/27

334/334 [==============================] - 9s 27ms/step - loss: 0.2735 - acc: 0.9206
Epoch 5/27

334/334 [==============================] - 9s 28ms/step - loss: 0.2341 - acc: 0.9343
Epoch 6/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1924 - acc: 0.9468
Epoch 7/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1714 - acc: 0.9519
Epoch 8/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1513 - acc: 0.9608
Epoch 9/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1353 - acc: 0.9643
Epoch 10/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1211 - acc: 0.9697
Epoch 11/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1089 - acc: 0.9717
Epoch 12/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0981 - acc: 0.9764
Epoch 13/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0890 - acc: 0.9779
Epoch 14/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0842 - acc: 0.9801
Epoch 15/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0751 - acc: 0.9802
Epoch 16/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0696 - acc: 0.9840
Epoch 17/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0653 - acc: 0.9860
Epoch 18/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0605 - acc: 0.9841
Epoch 19/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0545 - acc: 0.9879
Epoch 20/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0527 - acc: 0.9875
Epoch 21/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0461 - acc: 0.9910
Epoch 22/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0432 - acc: 0.9913
Epoch 23/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0444 - acc: 0.9892
Epoch 24/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0383 - acc: 0.9926
Epoch 25/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0373 - acc: 0.9917
Epoch 26/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0341 - acc: 0.9920
Epoch 27/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0323 - acc: 0.9937
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7988
False 1083
True percentage 0.880608532687
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.84      0.68      0.75       438
          O       0.98      0.95      0.96      7318
      B-LOC       0.66      0.71      0.68       218
      B-ORG       0.72      0.70      0.71       296
      I-PER       0.83      0.56      0.67       214
     B-MISC       0.30      0.11      0.16       141
     I-MISC       0.44      0.32      0.37       154
      I-ORG       0.51      0.50      0.51       151
      I-LOC       0.70      0.75      0.72       141

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.910166883655
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 100377 unique words.
Found 94 unique chars.
Found 9 unique labels.
373 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 288
OOV word occurences: 432
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6424192     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,530,754
Trainable params: 6,530,754
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 11s 34ms/step - loss: 0.8212 - acc: 0.7674
Epoch 2/27

334/334 [==============================] - 9s 28ms/step - loss: 0.4657 - acc: 0.8568
Epoch 3/27

334/334 [==============================] - 10s 28ms/step - loss: 0.3410 - acc: 0.8973
Epoch 4/27

334/334 [==============================] - 10s 29ms/step - loss: 0.2719 - acc: 0.9220
Epoch 5/27

334/334 [==============================] - 10s 29ms/step - loss: 0.2270 - acc: 0.9345
Epoch 6/27

334/334 [==============================] - 10s 29ms/step - loss: 0.1934 - acc: 0.9460
Epoch 7/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1699 - acc: 0.9518
Epoch 8/27

334/334 [==============================] - 10s 29ms/step - loss: 0.1491 - acc: 0.9581
Epoch 9/27

334/334 [==============================] - 10s 29ms/step - loss: 0.1290 - acc: 0.9656
Epoch 10/27

334/334 [==============================] - 10s 29ms/step - loss: 0.1131 - acc: 0.9727
Epoch 11/27

334/334 [==============================] - 10s 29ms/step - loss: 0.1050 - acc: 0.9721
Epoch 12/27

334/334 [==============================] - 10s 29ms/step - loss: 0.0959 - acc: 0.9765
Epoch 13/27

334/334 [==============================] - 10s 29ms/step - loss: 0.0898 - acc: 0.9793
Epoch 14/27

334/334 [==============================] - 10s 28ms/step - loss: 0.0791 - acc: 0.9798
Epoch 15/27

334/334 [==============================] - 10s 29ms/step - loss: 0.0717 - acc: 0.9842
Epoch 16/27

334/334 [==============================] - 10s 29ms/step - loss: 0.0677 - acc: 0.9837
Epoch 17/27

334/334 [==============================] - 10s 29ms/step - loss: 0.0629 - acc: 0.9843
Epoch 18/27

334/334 [==============================] - 10s 29ms/step - loss: 0.0565 - acc: 0.9879
Epoch 19/27

334/334 [==============================] - 10s 29ms/step - loss: 0.0519 - acc: 0.9880
Epoch 20/27

334/334 [==============================] - 10s 29ms/step - loss: 0.0508 - acc: 0.9867
Epoch 21/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0439 - acc: 0.9907
Epoch 22/27

334/334 [==============================] - 10s 29ms/step - loss: 0.0400 - acc: 0.9923
Epoch 23/27

334/334 [==============================] - 10s 28ms/step - loss: 0.0370 - acc: 0.9937
Epoch 24/27

334/334 [==============================] - 10s 28ms/step - loss: 0.0386 - acc: 0.9907
Epoch 25/27

334/334 [==============================] - 10s 29ms/step - loss: 0.0327 - acc: 0.9937
Epoch 26/27

334/334 [==============================] - 10s 29ms/step - loss: 0.0326 - acc: 0.9928
Epoch 27/27

334/334 [==============================] - 10s 29ms/step - loss: 0.0279 - acc: 0.9939
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7995
False 1076
True percentage 0.881380222688
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
     B-MISC       0.38      0.23      0.29       141
      B-ORG       0.69      0.67      0.68       296
     I-MISC       0.41      0.38      0.39       154
      B-LOC       0.72      0.71      0.71       218
      I-ORG       0.45      0.43      0.44       151
      B-PER       0.91      0.73      0.81       438
      I-PER       0.88      0.57      0.69       214
      I-LOC       0.68      0.74      0.71       141

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.645062671966
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 100351 unique words.
Found 94 unique chars.
Found 9 unique labels.
347 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 286
OOV word occurences: 481
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6422528     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,529,090
Trainable params: 6,529,090
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 11s 33ms/step - loss: 0.7680 - acc: 0.7823
Epoch 2/27

334/334 [==============================] - 9s 27ms/step - loss: 0.4297 - acc: 0.8686
Epoch 3/27

334/334 [==============================] - 9s 28ms/step - loss: 0.3273 - acc: 0.9049
Epoch 4/27

334/334 [==============================] - 9s 28ms/step - loss: 0.2530 - acc: 0.9270
Epoch 5/27

334/334 [==============================] - 9s 28ms/step - loss: 0.2153 - acc: 0.9385
Epoch 6/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1853 - acc: 0.9476
Epoch 7/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1609 - acc: 0.9584
Epoch 8/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1412 - acc: 0.9624
Epoch 9/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1258 - acc: 0.9683
Epoch 10/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1125 - acc: 0.9739
Epoch 11/27

334/334 [==============================] - 9s 27ms/step - loss: 0.1022 - acc: 0.9758
Epoch 12/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0932 - acc: 0.9774
Epoch 13/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0839 - acc: 0.9821
Epoch 14/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0806 - acc: 0.9784
Epoch 15/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0750 - acc: 0.9826
Epoch 16/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0667 - acc: 0.9854
Epoch 17/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0617 - acc: 0.9860
Epoch 18/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0599 - acc: 0.9862
Epoch 19/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0500 - acc: 0.9893
Epoch 20/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0482 - acc: 0.9900
Epoch 21/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0430 - acc: 0.9907
Epoch 22/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0409 - acc: 0.9921
Epoch 23/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0396 - acc: 0.9916
Epoch 24/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0359 - acc: 0.9932
Epoch 25/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0348 - acc: 0.9925
Epoch 26/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0319 - acc: 0.9934
Epoch 27/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0280 - acc: 0.9937
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7963
False 1108
True percentage 0.877852496968
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.75      0.53      0.62       296
          O       0.96      0.96      0.96      7318
     B-MISC       0.29      0.20      0.23       141
     I-MISC       0.46      0.40      0.43       154
      B-LOC       0.72      0.65      0.69       218
      I-LOC       0.84      0.62      0.72       141
      B-PER       0.87      0.68      0.77       438
      I-PER       0.85      0.60      0.70       214
      I-ORG       0.68      0.44      0.54       151

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.910044890107
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 8
Found 100004 word vectors.
Found 84 char vectors.
Found 100373 unique words.
Found 94 unique chars.
Found 9 unique labels.
369 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 284
OOV word occurences: 455
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6423936     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,530,498
Trainable params: 6,530,498
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 11s 33ms/step - loss: 0.8218 - acc: 0.7705
Epoch 2/27

334/334 [==============================] - 9s 28ms/step - loss: 0.4636 - acc: 0.8563
Epoch 3/27

334/334 [==============================] - 9s 28ms/step - loss: 0.3418 - acc: 0.9009
Epoch 4/27

334/334 [==============================] - 9s 28ms/step - loss: 0.2704 - acc: 0.9228
Epoch 5/27

334/334 [==============================] - 9s 28ms/step - loss: 0.2122 - acc: 0.9413
Epoch 6/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1792 - acc: 0.9506
Epoch 7/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1539 - acc: 0.9560
Epoch 8/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1349 - acc: 0.9617
Epoch 9/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1221 - acc: 0.9648
Epoch 10/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1123 - acc: 0.9702
Epoch 11/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0984 - acc: 0.9746
Epoch 12/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0860 - acc: 0.9799
Epoch 13/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0813 - acc: 0.9808
Epoch 14/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0751 - acc: 0.9807
Epoch 15/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0666 - acc: 0.9837
Epoch 16/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0586 - acc: 0.9859
Epoch 17/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0549 - acc: 0.9873
Epoch 18/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0508 - acc: 0.9885
Epoch 19/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0468 - acc: 0.9888
Epoch 20/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0442 - acc: 0.9907
Epoch 21/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0413 - acc: 0.9902
Epoch 22/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0378 - acc: 0.9911
Epoch 23/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0356 - acc: 0.9930
Epoch 24/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0314 - acc: 0.9946
Epoch 25/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0298 - acc: 0.9948
Epoch 26/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0278 - acc: 0.9942
Epoch 27/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0268 - acc: 0.9946
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7980
False 1091
True percentage 0.879726601257
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.71      0.72      0.72       296
          O       0.97      0.95      0.96      7318
      B-LOC       0.68      0.65      0.67       218
      I-LOC       0.75      0.65      0.69       141
      I-ORG       0.54      0.46      0.49       151
      B-PER       0.88      0.68      0.77       438
      I-PER       0.91      0.58      0.71       214
     B-MISC       0.23      0.11      0.15       141
     I-MISC       0.36      0.26      0.30       154

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.908782400094
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 9
Found 100004 word vectors.
Found 84 char vectors.
Found 100407 unique words.
Found 94 unique chars.
Found 9 unique labels.
403 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 282
OOV word occurences: 417
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6426112     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,532,674
Trainable params: 6,532,674
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 11s 34ms/step - loss: 0.8263 - acc: 0.7687
Epoch 2/27

334/334 [==============================] - 9s 28ms/step - loss: 0.4549 - acc: 0.8612
Epoch 3/27

334/334 [==============================] - 9s 28ms/step - loss: 0.3359 - acc: 0.9005
Epoch 4/27

334/334 [==============================] - 9s 28ms/step - loss: 0.2669 - acc: 0.9212
Epoch 5/27

334/334 [==============================] - 9s 28ms/step - loss: 0.2252 - acc: 0.9355
Epoch 6/27

334/334 [==============================] - 10s 29ms/step - loss: 0.1926 - acc: 0.9430
Epoch 7/27

334/334 [==============================] - 10s 29ms/step - loss: 0.1732 - acc: 0.9504
Epoch 8/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1515 - acc: 0.9573
Epoch 9/27

334/334 [==============================] - 10s 29ms/step - loss: 0.1311 - acc: 0.9646
Epoch 10/27

334/334 [==============================] - 10s 29ms/step - loss: 0.1198 - acc: 0.9691
Epoch 11/27

334/334 [==============================] - 10s 29ms/step - loss: 0.1105 - acc: 0.9694
Epoch 12/27

334/334 [==============================] - 10s 28ms/step - loss: 0.1013 - acc: 0.9748
Epoch 13/27

334/334 [==============================] - 10s 29ms/step - loss: 0.0913 - acc: 0.9761
Epoch 14/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0864 - acc: 0.9771
Epoch 15/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0752 - acc: 0.9830
Epoch 16/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0694 - acc: 0.9840
Epoch 17/27

334/334 [==============================] - 10s 28ms/step - loss: 0.0634 - acc: 0.9856
Epoch 18/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0615 - acc: 0.9863
Epoch 19/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0557 - acc: 0.9875
Epoch 20/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0512 - acc: 0.9883
Epoch 21/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0502 - acc: 0.9886
Epoch 22/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0432 - acc: 0.9911
Epoch 23/27

334/334 [==============================] - 10s 29ms/step - loss: 0.0426 - acc: 0.9901
Epoch 24/27

334/334 [==============================] - 10s 28ms/step - loss: 0.0399 - acc: 0.9916
Epoch 25/27

334/334 [==============================] - 10s 28ms/step - loss: 0.0382 - acc: 0.9928
Epoch 26/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0341 - acc: 0.9930
Epoch 27/27

334/334 [==============================] - 10s 28ms/step - loss: 0.0346 - acc: 0.9921
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7980
False 1091
True percentage 0.879726601257
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-LOC       0.73      0.72      0.72       218
      I-LOC       0.79      0.71      0.75       141
      B-ORG       0.75      0.62      0.68       296
      B-PER       0.86      0.63      0.73       438
      I-PER       0.87      0.58      0.70       214
      I-ORG       0.56      0.40      0.46       151
     B-MISC       0.35      0.28      0.31       141
     I-MISC       0.36      0.47      0.41       154

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.628606887993
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 10
Found 100004 word vectors.
Found 84 char vectors.
Found 100361 unique words.
Found 94 unique chars.
Found 9 unique labels.
357 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 291
OOV word occurences: 440
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6423168     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,529,730
Trainable params: 6,529,730
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 11s 33ms/step - loss: 0.7933 - acc: 0.7782
Epoch 2/27

334/334 [==============================] - 9s 28ms/step - loss: 0.4425 - acc: 0.8646
Epoch 3/27

334/334 [==============================] - 9s 28ms/step - loss: 0.3338 - acc: 0.9050
Epoch 4/27

334/334 [==============================] - 9s 28ms/step - loss: 0.2673 - acc: 0.9284
Epoch 5/27

334/334 [==============================] - 9s 28ms/step - loss: 0.2150 - acc: 0.9426
Epoch 6/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1799 - acc: 0.9520
Epoch 7/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1556 - acc: 0.9605
Epoch 8/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1368 - acc: 0.9637
Epoch 9/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1216 - acc: 0.9707
Epoch 10/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1072 - acc: 0.9735
Epoch 11/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0987 - acc: 0.9760
Epoch 12/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0882 - acc: 0.9795
Epoch 13/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0742 - acc: 0.9838
Epoch 14/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0701 - acc: 0.9855
Epoch 15/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0643 - acc: 0.9865
Epoch 16/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0575 - acc: 0.9875
Epoch 17/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0549 - acc: 0.9889
Epoch 18/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0494 - acc: 0.9900
Epoch 19/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0482 - acc: 0.9890
Epoch 20/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0439 - acc: 0.9913
Epoch 21/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0389 - acc: 0.9922
Epoch 22/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0378 - acc: 0.9938
Epoch 23/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0362 - acc: 0.9919
Epoch 24/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0327 - acc: 0.9931
Epoch 25/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0330 - acc: 0.9941
Epoch 26/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0299 - acc: 0.9944
Epoch 27/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0282 - acc: 0.9945
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7995
False 1076
True percentage 0.881380222688
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-ORG       0.79      0.59      0.68       296
      I-ORG       0.56      0.39      0.46       151
      B-LOC       0.60      0.72      0.66       218
      B-PER       0.88      0.77      0.82       438
      I-PER       0.83      0.57      0.68       214
     B-MISC       0.30      0.13      0.19       141
     I-MISC       0.44      0.32      0.37       154
      I-LOC       0.56      0.78      0.65       141

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.634627233518
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 11
Found 100004 word vectors.
Found 84 char vectors.
Found 100370 unique words.
Found 94 unique chars.
Found 9 unique labels.
366 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 284
OOV word occurences: 433
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6423744     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,530,306
Trainable params: 6,530,306
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 11s 33ms/step - loss: 0.7805 - acc: 0.7855
Epoch 2/27

334/334 [==============================] - 9s 28ms/step - loss: 0.4340 - acc: 0.8628
Epoch 3/27

334/334 [==============================] - 9s 28ms/step - loss: 0.3260 - acc: 0.9025
Epoch 4/27

334/334 [==============================] - 9s 28ms/step - loss: 0.2556 - acc: 0.9230
Epoch 5/27

334/334 [==============================] - 9s 28ms/step - loss: 0.2229 - acc: 0.9334
Epoch 6/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1859 - acc: 0.9465
Epoch 7/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1651 - acc: 0.9545
Epoch 8/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1457 - acc: 0.9585
Epoch 9/27

334/334 [==============================] - 9s 27ms/step - loss: 0.1302 - acc: 0.9658
Epoch 10/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1158 - acc: 0.9686
Epoch 11/27

334/334 [==============================] - 9s 28ms/step - loss: 0.1015 - acc: 0.9744
Epoch 12/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0959 - acc: 0.9769
Epoch 13/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0808 - acc: 0.9807
Epoch 14/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0780 - acc: 0.9798
Epoch 15/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0699 - acc: 0.9851
Epoch 16/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0675 - acc: 0.9840
Epoch 17/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0592 - acc: 0.9873
Epoch 18/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0540 - acc: 0.9874
Epoch 19/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0522 - acc: 0.9895
Epoch 20/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0476 - acc: 0.9889
Epoch 21/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0418 - acc: 0.9907
Epoch 22/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0419 - acc: 0.9897
Epoch 23/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0418 - acc: 0.9903
Epoch 24/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0357 - acc: 0.9928
Epoch 25/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0351 - acc: 0.9918
Epoch 26/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0330 - acc: 0.9927
Epoch 27/27

334/334 [==============================] - 9s 28ms/step - loss: 0.0304 - acc: 0.9941
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8004
False 1067
True percentage 0.882372395546
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-ORG       0.78      0.59      0.67       296
      I-ORG       0.63      0.48      0.55       151
     B-MISC       0.30      0.21      0.24       141
      B-LOC       0.75      0.70      0.73       218
      B-PER       0.85      0.69      0.76       438
     I-MISC       0.41      0.45      0.43       154
      I-PER       0.82      0.58      0.68       214
      I-LOC       0.76      0.69      0.72       141

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.639974976541
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 100348 unique words.
Found 94 unique chars.
Found 9 unique labels.
344 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 283
OOV word occurences: 477
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6422336     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,528,898
Trainable params: 6,528,898
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 11s 32ms/step - loss: 0.8029 - acc: 0.7751
Epoch 2/27

334/334 [==============================] - 9s 27ms/step - loss: 0.4532 - acc: 0.8641
Epoch 3/27

334/334 [==============================] - 9s 27ms/step - loss: 0.3404 - acc: 0.8966
Epoch 4/27

334/334 [==============================] - 9s 27ms/step - loss: 0.2664 - acc: 0.9216
Epoch 5/27

334/334 [==============================] - 9s 27ms/step - loss: 0.2280 - acc: 0.9325
Epoch 6/27

334/334 [==============================] - 9s 27ms/step - loss: 0.1942 - acc: 0.9471
Epoch 7/27

334/334 [==============================] - 9s 27ms/step - loss: 0.1680 - acc: 0.9526
Epoch 8/27

334/334 [==============================] - 9s 27ms/step - loss: 0.1505 - acc: 0.9575
Epoch 9/27

334/334 [==============================] - 9s 27ms/step - loss: 0.1426 - acc: 0.9601
Epoch 10/27

334/334 [==============================] - 9s 27ms/step - loss: 0.1257 - acc: 0.9651
Epoch 11/27

334/334 [==============================] - 9s 27ms/step - loss: 0.1136 - acc: 0.9700
Epoch 12/27

334/334 [==============================] - 9s 27ms/step - loss: 0.1030 - acc: 0.9745
Epoch 13/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0957 - acc: 0.9756
Epoch 14/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0852 - acc: 0.9804
Epoch 15/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0795 - acc: 0.9828
Epoch 16/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0741 - acc: 0.9838
Epoch 17/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0668 - acc: 0.9858
Epoch 18/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0636 - acc: 0.9842
Epoch 19/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0578 - acc: 0.9879
Epoch 20/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0527 - acc: 0.9882
Epoch 21/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0488 - acc: 0.9904
Epoch 22/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0462 - acc: 0.9901
Epoch 23/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0436 - acc: 0.9907
Epoch 24/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0437 - acc: 0.9892
Epoch 25/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0387 - acc: 0.9908
Epoch 26/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0368 - acc: 0.9924
Epoch 27/27

334/334 [==============================] - 9s 27ms/step - loss: 0.0338 - acc: 0.9922
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7896
False 1175
True percentage 0.870466321244
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.94      0.96      7318
      B-PER       0.88      0.64      0.74       438
      B-ORG       0.72      0.51      0.60       296
     B-MISC       0.29      0.34      0.31       141
      I-PER       0.85      0.56      0.68       214
      I-ORG       0.63      0.30      0.41       151
     I-MISC       0.32      0.58      0.41       154
      B-LOC       0.72      0.72      0.72       218
      I-LOC       0.74      0.71      0.72       141

avg / total       0.92      0.87      0.89      9071

F-1 Score (without O):
0.602006688963
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100207 unique words.
Found 94 unique chars.
Found 9 unique labels.
203 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 299
OOV word occurences: 525
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6413312     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,519,874
Trainable params: 6,519,874
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 6s 38ms/step - loss: 1.0686 - acc: 0.7236
Epoch 2/27

167/167 [==============================] - 5s 28ms/step - loss: 0.6382 - acc: 0.8091
Epoch 3/27

167/167 [==============================] - 5s 27ms/step - loss: 0.5007 - acc: 0.8419
Epoch 4/27

167/167 [==============================] - 5s 27ms/step - loss: 0.4071 - acc: 0.8750
Epoch 5/27

167/167 [==============================] - 5s 28ms/step - loss: 0.3441 - acc: 0.8931
Epoch 6/27

167/167 [==============================] - 5s 27ms/step - loss: 0.2942 - acc: 0.9162
Epoch 7/27

167/167 [==============================] - 5s 28ms/step - loss: 0.2648 - acc: 0.9246
Epoch 8/27

167/167 [==============================] - 5s 27ms/step - loss: 0.2272 - acc: 0.9371
Epoch 9/27

167/167 [==============================] - 5s 28ms/step - loss: 0.2077 - acc: 0.9408
Epoch 10/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1789 - acc: 0.9514
Epoch 11/27

167/167 [==============================] - 5s 27ms/step - loss: 0.1672 - acc: 0.9580
Epoch 12/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1456 - acc: 0.9638
Epoch 13/27

167/167 [==============================] - 5s 27ms/step - loss: 0.1334 - acc: 0.9689
Epoch 14/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1190 - acc: 0.9762
Epoch 15/27

167/167 [==============================] - 4s 27ms/step - loss: 0.1066 - acc: 0.9772
Epoch 16/27

167/167 [==============================] - 5s 27ms/step - loss: 0.1017 - acc: 0.9777
Epoch 17/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0871 - acc: 0.9806
Epoch 18/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0810 - acc: 0.9838
Epoch 19/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0741 - acc: 0.9848
Epoch 20/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0723 - acc: 0.9879
Epoch 21/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0617 - acc: 0.9914
Epoch 22/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0589 - acc: 0.9903
Epoch 23/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0566 - acc: 0.9905
Epoch 24/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0507 - acc: 0.9926
Epoch 25/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0506 - acc: 0.9906
Epoch 26/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0450 - acc: 0.9949
Epoch 27/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0415 - acc: 0.9937
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7687
False 1384
True percentage 0.847425862639
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.94      0.95      7318
      B-LOC       0.68      0.61      0.64       218
      I-LOC       0.78      0.54      0.64       141
      B-PER       0.77      0.48      0.59       438
      B-ORG       0.62      0.59      0.60       296
      I-ORG       0.48      0.34      0.40       151
     B-MISC       0.18      0.12      0.14       141
     I-MISC       0.33      0.40      0.36       154
      I-PER       0.55      0.46      0.50       214

avg / total       0.89      0.85      0.87      9071

F-1 Score (without O):
0.519242902208
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 100214 unique words.
Found 94 unique chars.
Found 9 unique labels.
210 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 297
OOV word occurences: 499
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6413760     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,520,322
Trainable params: 6,520,322
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 6s 38ms/step - loss: 0.9341 - acc: 0.7429
Epoch 2/27

167/167 [==============================] - 5s 28ms/step - loss: 0.5589 - acc: 0.8330
Epoch 3/27

167/167 [==============================] - 5s 28ms/step - loss: 0.4383 - acc: 0.8666
Epoch 4/27

167/167 [==============================] - 5s 28ms/step - loss: 0.3601 - acc: 0.8967
Epoch 5/27

167/167 [==============================] - 5s 28ms/step - loss: 0.2979 - acc: 0.9129
Epoch 6/27

167/167 [==============================] - 5s 28ms/step - loss: 0.2603 - acc: 0.9304
Epoch 7/27

167/167 [==============================] - 5s 28ms/step - loss: 0.2204 - acc: 0.9397
Epoch 8/27

167/167 [==============================] - 5s 28ms/step - loss: 0.2026 - acc: 0.9427
Epoch 9/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1805 - acc: 0.9489
Epoch 10/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1624 - acc: 0.9577
Epoch 11/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1433 - acc: 0.9623
Epoch 12/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1362 - acc: 0.9659
Epoch 13/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1232 - acc: 0.9690
Epoch 14/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1161 - acc: 0.9722
Epoch 15/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1088 - acc: 0.9744
Epoch 16/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0939 - acc: 0.9789
Epoch 17/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0927 - acc: 0.9812
Epoch 18/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0847 - acc: 0.9826
Epoch 19/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0787 - acc: 0.9826
Epoch 20/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0741 - acc: 0.9823
Epoch 21/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0691 - acc: 0.9862
Epoch 22/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0605 - acc: 0.9873
Epoch 23/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0578 - acc: 0.9889
Epoch 24/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0553 - acc: 0.9880
Epoch 25/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0495 - acc: 0.9916
Epoch 26/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0463 - acc: 0.9909
Epoch 27/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0445 - acc: 0.9922
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7835
False 1236
True percentage 0.863741594091
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.77      0.65      0.70       438
      I-PER       0.86      0.47      0.61       214
          O       0.96      0.95      0.96      7318
      B-ORG       0.62      0.48      0.54       296
      I-ORG       0.50      0.42      0.45       151
      B-LOC       0.62      0.72      0.67       218
      I-LOC       0.64      0.68      0.66       141
     B-MISC       0.17      0.04      0.07       141
     I-MISC       0.34      0.16      0.21       154

avg / total       0.90      0.86      0.88      9071

F-1 Score (without O):
0.897047466286
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100196 unique words.
Found 94 unique chars.
Found 9 unique labels.
192 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 300
OOV word occurences: 485
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6412608     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,519,170
Trainable params: 6,519,170
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 6s 38ms/step - loss: 1.0034 - acc: 0.7352
Epoch 2/27

167/167 [==============================] - 5s 27ms/step - loss: 0.5740 - acc: 0.8296
Epoch 3/27

167/167 [==============================] - 5s 27ms/step - loss: 0.4511 - acc: 0.8696
Epoch 4/27

167/167 [==============================] - 5s 27ms/step - loss: 0.3716 - acc: 0.8907
Epoch 5/27

167/167 [==============================] - 5s 27ms/step - loss: 0.3147 - acc: 0.9040
Epoch 6/27

167/167 [==============================] - 5s 27ms/step - loss: 0.2763 - acc: 0.9183
Epoch 7/27

167/167 [==============================] - 5s 27ms/step - loss: 0.2375 - acc: 0.9346
Epoch 8/27

167/167 [==============================] - 5s 27ms/step - loss: 0.2079 - acc: 0.9405
Epoch 9/27

167/167 [==============================] - 5s 27ms/step - loss: 0.1862 - acc: 0.9515
Epoch 10/27

167/167 [==============================] - 5s 27ms/step - loss: 0.1659 - acc: 0.9570
Epoch 11/27

167/167 [==============================] - 5s 27ms/step - loss: 0.1508 - acc: 0.9578
Epoch 12/27

167/167 [==============================] - 5s 27ms/step - loss: 0.1360 - acc: 0.9664
Epoch 13/27

167/167 [==============================] - 5s 27ms/step - loss: 0.1245 - acc: 0.9688
Epoch 14/27

167/167 [==============================] - 5s 27ms/step - loss: 0.1115 - acc: 0.9753
Epoch 15/27

167/167 [==============================] - 5s 27ms/step - loss: 0.1018 - acc: 0.9792
Epoch 16/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0938 - acc: 0.9807
Epoch 17/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0846 - acc: 0.9810
Epoch 18/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0761 - acc: 0.9835
Epoch 19/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0701 - acc: 0.9853
Epoch 20/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0683 - acc: 0.9852
Epoch 21/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0589 - acc: 0.9882
Epoch 22/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0620 - acc: 0.9847
Epoch 23/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0546 - acc: 0.9891
Epoch 24/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0527 - acc: 0.9892
Epoch 25/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0474 - acc: 0.9911
Epoch 26/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0429 - acc: 0.9929
Epoch 27/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0451 - acc: 0.9916
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7743
False 1328
True percentage 0.853599382648
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.94      0.95      7318
      B-PER       0.78      0.63      0.69       438
      B-LOC       0.66      0.61      0.63       218
     B-MISC       0.23      0.19      0.21       141
     I-MISC       0.26      0.30      0.28       154
      B-ORG       0.63      0.63      0.63       296
      I-ORG       0.39      0.37      0.38       151
      I-LOC       0.78      0.57      0.66       141
      I-PER       0.76      0.41      0.53       214

avg / total       0.90      0.85      0.87      9071

F-1 Score (without O):
0.546625766871
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 100204 unique words.
Found 94 unique chars.
Found 9 unique labels.
200 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 295
OOV word occurences: 519
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6413120     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,519,682
Trainable params: 6,519,682
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 6s 38ms/step - loss: 1.0057 - acc: 0.7347
Epoch 2/27

167/167 [==============================] - 5s 28ms/step - loss: 0.6210 - acc: 0.8129
Epoch 3/27

167/167 [==============================] - 5s 28ms/step - loss: 0.4741 - acc: 0.8581
Epoch 4/27

167/167 [==============================] - 5s 28ms/step - loss: 0.3764 - acc: 0.8882
Epoch 5/27

167/167 [==============================] - 5s 28ms/step - loss: 0.3327 - acc: 0.9088
Epoch 6/27

167/167 [==============================] - 5s 28ms/step - loss: 0.2710 - acc: 0.9274
Epoch 7/27

167/167 [==============================] - 5s 28ms/step - loss: 0.2293 - acc: 0.9411
Epoch 8/27

167/167 [==============================] - 5s 28ms/step - loss: 0.2021 - acc: 0.9477
Epoch 9/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1764 - acc: 0.9529
Epoch 10/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1642 - acc: 0.9558
Epoch 11/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1418 - acc: 0.9637
Epoch 12/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1271 - acc: 0.9684
Epoch 13/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1146 - acc: 0.9719
Epoch 14/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1097 - acc: 0.9764
Epoch 15/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1015 - acc: 0.9762
Epoch 16/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0907 - acc: 0.9793
Epoch 17/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0823 - acc: 0.9833
Epoch 18/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0790 - acc: 0.9830
Epoch 19/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0672 - acc: 0.9875
Epoch 20/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0666 - acc: 0.9871
Epoch 21/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0611 - acc: 0.9862
Epoch 22/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0562 - acc: 0.9881
Epoch 23/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0531 - acc: 0.9896
Epoch 24/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0449 - acc: 0.9907
Epoch 25/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0490 - acc: 0.9900
Epoch 26/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0443 - acc: 0.9916
Epoch 27/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0398 - acc: 0.9911
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7764
False 1307
True percentage 0.855914452651
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.95      0.95      7318
      B-ORG       0.59      0.44      0.50       296
      I-ORG       0.43      0.26      0.32       151
      B-PER       0.84      0.66      0.74       438
      I-PER       0.85      0.51      0.64       214
      B-LOC       0.74      0.53      0.62       218
      I-LOC       0.78      0.48      0.60       141
     B-MISC       0.26      0.21      0.23       141
     I-MISC       0.29      0.27      0.28       154

avg / total       0.90      0.86      0.87      9071

F-1 Score (without O):
0.542105263158
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 100238 unique words.
Found 94 unique chars.
Found 9 unique labels.
234 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 300
OOV word occurences: 517
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6415296     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,521,858
Trainable params: 6,521,858
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 7s 39ms/step - loss: 0.9782 - acc: 0.7495
Epoch 2/27

167/167 [==============================] - 5s 28ms/step - loss: 0.5571 - acc: 0.8317
Epoch 3/27

167/167 [==============================] - 5s 29ms/step - loss: 0.4291 - acc: 0.8687
Epoch 4/27

167/167 [==============================] - 5s 28ms/step - loss: 0.3513 - acc: 0.8890
Epoch 5/27

167/167 [==============================] - 5s 29ms/step - loss: 0.3059 - acc: 0.9043
Epoch 6/27

167/167 [==============================] - 5s 28ms/step - loss: 0.2520 - acc: 0.9225
Epoch 7/27

167/167 [==============================] - 5s 29ms/step - loss: 0.2215 - acc: 0.9370
Epoch 8/27

167/167 [==============================] - 5s 29ms/step - loss: 0.1915 - acc: 0.9475
Epoch 9/27

167/167 [==============================] - 5s 29ms/step - loss: 0.1754 - acc: 0.9525
Epoch 10/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1624 - acc: 0.9565
Epoch 11/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1415 - acc: 0.9621
Epoch 12/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1279 - acc: 0.9681
Epoch 13/27

167/167 [==============================] - 5s 29ms/step - loss: 0.1220 - acc: 0.9712
Epoch 14/27

167/167 [==============================] - 5s 29ms/step - loss: 0.1102 - acc: 0.9738
Epoch 15/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1036 - acc: 0.9742
Epoch 16/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0928 - acc: 0.9781
Epoch 17/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0883 - acc: 0.9802
Epoch 18/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0839 - acc: 0.9817
Epoch 19/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0751 - acc: 0.9835
Epoch 20/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0717 - acc: 0.9841
Epoch 21/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0687 - acc: 0.9857
Epoch 22/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0644 - acc: 0.9884
Epoch 23/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0587 - acc: 0.9877
Epoch 24/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0539 - acc: 0.9901
Epoch 25/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0493 - acc: 0.9922
Epoch 26/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0496 - acc: 0.9912
Epoch 27/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0463 - acc: 0.9919
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7815
False 1256
True percentage 0.861536765516
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.96      0.96      7318
      B-ORG       0.52      0.49      0.51       296
      I-ORG       0.45      0.42      0.44       151
      B-PER       0.84      0.62      0.71       438
      I-PER       0.83      0.43      0.56       214
     B-MISC       0.25      0.06      0.10       141
     I-MISC       0.41      0.22      0.29       154
      B-LOC       0.66      0.61      0.63       218
      I-LOC       0.73      0.55      0.62       141

avg / total       0.90      0.86      0.88      9071

F-1 Score (without O):
0.544015825915
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 100225 unique words.
Found 94 unique chars.
Found 9 unique labels.
221 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 300
OOV word occurences: 484
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6414464     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,521,026
Trainable params: 6,521,026
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 6s 38ms/step - loss: 1.0019 - acc: 0.7294
Epoch 2/27

167/167 [==============================] - 5s 28ms/step - loss: 0.5968 - acc: 0.8201
Epoch 3/27

167/167 [==============================] - 5s 28ms/step - loss: 0.4708 - acc: 0.8568
Epoch 4/27

167/167 [==============================] - 5s 28ms/step - loss: 0.3849 - acc: 0.8907
Epoch 5/27

167/167 [==============================] - 5s 28ms/step - loss: 0.3194 - acc: 0.9034
Epoch 6/27

167/167 [==============================] - 5s 28ms/step - loss: 0.2804 - acc: 0.9180
Epoch 7/27

167/167 [==============================] - 5s 28ms/step - loss: 0.2344 - acc: 0.9387
Epoch 8/27

167/167 [==============================] - 5s 28ms/step - loss: 0.2048 - acc: 0.9458
Epoch 9/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1838 - acc: 0.9526
Epoch 10/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1679 - acc: 0.9548
Epoch 11/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1456 - acc: 0.9632
Epoch 12/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1367 - acc: 0.9667
Epoch 13/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1206 - acc: 0.9715
Epoch 14/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1099 - acc: 0.9764
Epoch 15/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0957 - acc: 0.9789
Epoch 16/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0861 - acc: 0.9809
Epoch 17/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0846 - acc: 0.9843
Epoch 18/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0789 - acc: 0.9823
Epoch 19/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0657 - acc: 0.9878
Epoch 20/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0594 - acc: 0.9871
Epoch 21/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0555 - acc: 0.9894
Epoch 22/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0542 - acc: 0.9897
Epoch 23/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0479 - acc: 0.9909
Epoch 24/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0475 - acc: 0.9917
Epoch 25/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0445 - acc: 0.9908
Epoch 26/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0385 - acc: 0.9936
Epoch 27/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0384 - acc: 0.9936
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7857
False 1214
True percentage 0.866166905523
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.84      0.61      0.70       438
          O       0.97      0.95      0.96      7318
      B-LOC       0.70      0.62      0.66       218
      B-ORG       0.64      0.71      0.67       296
      I-PER       0.79      0.48      0.60       214
     B-MISC       0.32      0.13      0.19       141
     I-MISC       0.36      0.21      0.26       154
      I-ORG       0.39      0.47      0.43       151
      I-LOC       0.77      0.63      0.69       141

avg / total       0.91      0.87      0.88      9071

F-1 Score (without O):
0.898142671241
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 100206 unique words.
Found 94 unique chars.
Found 9 unique labels.
202 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 303
OOV word occurences: 526
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6413248     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,519,810
Trainable params: 6,519,810
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 6s 38ms/step - loss: 1.0181 - acc: 0.7281
Epoch 2/27

167/167 [==============================] - 5s 28ms/step - loss: 0.6262 - acc: 0.8073
Epoch 3/27

167/167 [==============================] - 5s 28ms/step - loss: 0.4933 - acc: 0.8456
Epoch 4/27

167/167 [==============================] - 5s 28ms/step - loss: 0.3996 - acc: 0.8765
Epoch 5/27

167/167 [==============================] - 5s 28ms/step - loss: 0.3352 - acc: 0.8984
Epoch 6/27

167/167 [==============================] - 5s 28ms/step - loss: 0.2801 - acc: 0.9218
Epoch 7/27

167/167 [==============================] - 5s 28ms/step - loss: 0.2489 - acc: 0.9334
Epoch 8/27

167/167 [==============================] - 5s 28ms/step - loss: 0.2161 - acc: 0.9381
Epoch 9/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1944 - acc: 0.9453
Epoch 10/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1733 - acc: 0.9521
Epoch 11/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1533 - acc: 0.9605
Epoch 12/27

167/167 [==============================] - 5s 27ms/step - loss: 0.1422 - acc: 0.9646
Epoch 13/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1281 - acc: 0.9701
Epoch 14/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1203 - acc: 0.9734
Epoch 15/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1100 - acc: 0.9744
Epoch 16/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0967 - acc: 0.9795
Epoch 17/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0903 - acc: 0.9802
Epoch 18/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0806 - acc: 0.9830
Epoch 19/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0775 - acc: 0.9848
Epoch 20/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0667 - acc: 0.9893
Epoch 21/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0667 - acc: 0.9893
Epoch 22/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0580 - acc: 0.9922
Epoch 23/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0542 - acc: 0.9903
Epoch 24/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0517 - acc: 0.9906
Epoch 25/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0460 - acc: 0.9929
Epoch 26/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0446 - acc: 0.9944
Epoch 27/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0404 - acc: 0.9940
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7798
False 1273
True percentage 0.859662661228
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.94      0.96      7318
     B-MISC       0.25      0.10      0.14       141
      B-ORG       0.55      0.49      0.52       296
     I-MISC       0.41      0.24      0.30       154
      B-LOC       0.63      0.73      0.68       218
      I-ORG       0.43      0.36      0.39       151
      B-PER       0.86      0.58      0.69       438
      I-PER       0.74      0.58      0.65       214
      I-LOC       0.66      0.72      0.69       141

avg / total       0.90      0.86      0.88      9071

F-1 Score (without O):
0.562756876383
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 100194 unique words.
Found 94 unique chars.
Found 9 unique labels.
190 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 299
OOV word occurences: 502
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6412480     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,519,042
Trainable params: 6,519,042
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 6s 38ms/step - loss: 0.9619 - acc: 0.7419
Epoch 2/27

167/167 [==============================] - 5s 28ms/step - loss: 0.5420 - acc: 0.8338
Epoch 3/27

167/167 [==============================] - 5s 28ms/step - loss: 0.4133 - acc: 0.8693
Epoch 4/27

167/167 [==============================] - 5s 28ms/step - loss: 0.3397 - acc: 0.9020
Epoch 5/27

167/167 [==============================] - 5s 28ms/step - loss: 0.2876 - acc: 0.9156
Epoch 6/27

167/167 [==============================] - 5s 28ms/step - loss: 0.2508 - acc: 0.9292
Epoch 7/27

167/167 [==============================] - 5s 28ms/step - loss: 0.2216 - acc: 0.9392
Epoch 8/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1955 - acc: 0.9489
Epoch 9/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1672 - acc: 0.9588
Epoch 10/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1543 - acc: 0.9615
Epoch 11/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1385 - acc: 0.9676
Epoch 12/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1230 - acc: 0.9759
Epoch 13/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1115 - acc: 0.9764
Epoch 14/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0976 - acc: 0.9810
Epoch 15/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0941 - acc: 0.9807
Epoch 16/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0845 - acc: 0.9855
Epoch 17/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0765 - acc: 0.9872
Epoch 18/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0691 - acc: 0.9846
Epoch 19/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0674 - acc: 0.9873
Epoch 20/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0605 - acc: 0.9890
Epoch 21/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0553 - acc: 0.9923
Epoch 22/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0515 - acc: 0.9923
Epoch 23/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0476 - acc: 0.9938
Epoch 24/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0474 - acc: 0.9922
Epoch 25/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0448 - acc: 0.9921
Epoch 26/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0401 - acc: 0.9938
Epoch 27/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0365 - acc: 0.9941
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7849
False 1222
True percentage 0.865284974093
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.75      0.49      0.59       296
          O       0.96      0.95      0.95      7318
     B-MISC       0.25      0.24      0.24       141
     I-MISC       0.35      0.43      0.39       154
      B-LOC       0.72      0.62      0.67       218
      I-LOC       0.88      0.52      0.66       141
      B-PER       0.84      0.69      0.76       438
      I-PER       0.89      0.52      0.65       214
      I-ORG       0.59      0.25      0.35       151

avg / total       0.91      0.87      0.88      9071

F-1 Score (without O):
0.898425655977
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 8
Found 100004 word vectors.
Found 84 char vectors.
Found 100212 unique words.
Found 94 unique chars.
Found 9 unique labels.
208 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 299
OOV word occurences: 478
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6413632     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,520,194
Trainable params: 6,520,194
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 6s 37ms/step - loss: 1.0506 - acc: 0.7150
Epoch 2/27

167/167 [==============================] - 5s 27ms/step - loss: 0.6218 - acc: 0.8007
Epoch 3/27

167/167 [==============================] - 5s 27ms/step - loss: 0.4761 - acc: 0.8596
Epoch 4/27

167/167 [==============================] - 5s 27ms/step - loss: 0.3824 - acc: 0.8864
Epoch 5/27

167/167 [==============================] - 5s 27ms/step - loss: 0.3227 - acc: 0.9112
Epoch 6/27

167/167 [==============================] - 5s 27ms/step - loss: 0.2706 - acc: 0.9310
Epoch 7/27

167/167 [==============================] - 5s 27ms/step - loss: 0.2404 - acc: 0.9363
Epoch 8/27

167/167 [==============================] - 5s 27ms/step - loss: 0.2039 - acc: 0.9491
Epoch 9/27

167/167 [==============================] - 5s 27ms/step - loss: 0.1796 - acc: 0.9524
Epoch 10/27

167/167 [==============================] - 5s 27ms/step - loss: 0.1615 - acc: 0.9578
Epoch 11/27

167/167 [==============================] - 5s 27ms/step - loss: 0.1469 - acc: 0.9627
Epoch 12/27

167/167 [==============================] - 4s 27ms/step - loss: 0.1333 - acc: 0.9659
Epoch 13/27

167/167 [==============================] - 5s 27ms/step - loss: 0.1206 - acc: 0.9705
Epoch 14/27

167/167 [==============================] - 5s 27ms/step - loss: 0.1064 - acc: 0.9743
Epoch 15/27

167/167 [==============================] - 5s 27ms/step - loss: 0.1007 - acc: 0.9749
Epoch 16/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0928 - acc: 0.9775
Epoch 17/27

167/167 [==============================] - 4s 27ms/step - loss: 0.0790 - acc: 0.9851
Epoch 18/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0743 - acc: 0.9863
Epoch 19/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0677 - acc: 0.9877
Epoch 20/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0620 - acc: 0.9883
Epoch 21/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0593 - acc: 0.9901
Epoch 22/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0541 - acc: 0.9897
Epoch 23/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0519 - acc: 0.9906
Epoch 24/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0468 - acc: 0.9925
Epoch 25/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0443 - acc: 0.9934
Epoch 26/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0404 - acc: 0.9950
Epoch 27/27

167/167 [==============================] - 5s 27ms/step - loss: 0.0400 - acc: 0.9940
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7852
False 1219
True percentage 0.865615698379
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.60      0.70      0.64       296
          O       0.96      0.95      0.96      7318
      B-LOC       0.68      0.61      0.64       218
      I-LOC       0.78      0.55      0.65       141
      I-ORG       0.33      0.46      0.39       151
      B-PER       0.87      0.67      0.75       438
      I-PER       0.86      0.50      0.63       214
     B-MISC       0.15      0.01      0.03       141
     I-MISC       0.30      0.10      0.15       154

avg / total       0.90      0.87      0.88      9071

F-1 Score (without O):
0.89836681941
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 9
Found 100004 word vectors.
Found 84 char vectors.
Found 100217 unique words.
Found 94 unique chars.
Found 9 unique labels.
213 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 304
OOV word occurences: 490
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6413952     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,520,514
Trainable params: 6,520,514
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 6s 38ms/step - loss: 1.0403 - acc: 0.7157
Epoch 2/27

167/167 [==============================] - 5s 28ms/step - loss: 0.6114 - acc: 0.8115
Epoch 3/27

167/167 [==============================] - 5s 28ms/step - loss: 0.4745 - acc: 0.8600
Epoch 4/27

167/167 [==============================] - 5s 28ms/step - loss: 0.3775 - acc: 0.8912
Epoch 5/27

167/167 [==============================] - 5s 28ms/step - loss: 0.3104 - acc: 0.9142
Epoch 6/27

167/167 [==============================] - 5s 28ms/step - loss: 0.2603 - acc: 0.9326
Epoch 7/27

167/167 [==============================] - 5s 28ms/step - loss: 0.2266 - acc: 0.9390
Epoch 8/27

167/167 [==============================] - 5s 28ms/step - loss: 0.2015 - acc: 0.9469
Epoch 9/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1668 - acc: 0.9558
Epoch 10/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1547 - acc: 0.9575
Epoch 11/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1380 - acc: 0.9655
Epoch 12/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1281 - acc: 0.9625
Epoch 13/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1180 - acc: 0.9688
Epoch 14/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1066 - acc: 0.9700
Epoch 15/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0990 - acc: 0.9738
Epoch 16/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0909 - acc: 0.9756
Epoch 17/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0866 - acc: 0.9782
Epoch 18/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0815 - acc: 0.9811
Epoch 19/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0771 - acc: 0.9816
Epoch 20/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0708 - acc: 0.9843
Epoch 21/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0657 - acc: 0.9868
Epoch 22/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0632 - acc: 0.9851
Epoch 23/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0564 - acc: 0.9902
Epoch 24/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0563 - acc: 0.9882
Epoch 25/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0503 - acc: 0.9907
Epoch 26/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0516 - acc: 0.9907
Epoch 27/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0496 - acc: 0.9894
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7870
False 1201
True percentage 0.867600044097
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.95      0.96      7318
      B-LOC       0.73      0.65      0.69       218
      I-LOC       0.74      0.65      0.69       141
      B-ORG       0.71      0.60      0.65       296
      B-PER       0.86      0.67      0.75       438
      I-PER       0.73      0.56      0.63       214
      I-ORG       0.50      0.35      0.41       151
     B-MISC       0.19      0.09      0.12       141
     I-MISC       0.33      0.29      0.31       154

avg / total       0.90      0.87      0.88      9071

F-1 Score (without O):
0.595717481624
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 10
Found 100004 word vectors.
Found 84 char vectors.
Found 100196 unique words.
Found 94 unique chars.
Found 9 unique labels.
192 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 306
OOV word occurences: 463
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6412608     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,519,170
Trainable params: 6,519,170
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 6s 38ms/step - loss: 1.0532 - acc: 0.7307
Epoch 2/27

167/167 [==============================] - 5s 28ms/step - loss: 0.5936 - acc: 0.8136
Epoch 3/27

167/167 [==============================] - 5s 28ms/step - loss: 0.4887 - acc: 0.8484
Epoch 4/27

167/167 [==============================] - 5s 28ms/step - loss: 0.3986 - acc: 0.8752
Epoch 5/27

167/167 [==============================] - 5s 28ms/step - loss: 0.3440 - acc: 0.8990
Epoch 6/27

167/167 [==============================] - 5s 28ms/step - loss: 0.2910 - acc: 0.9177
Epoch 7/27

167/167 [==============================] - 5s 28ms/step - loss: 0.2634 - acc: 0.9288
Epoch 8/27

167/167 [==============================] - 5s 28ms/step - loss: 0.2351 - acc: 0.9358
Epoch 9/27

167/167 [==============================] - 5s 28ms/step - loss: 0.2129 - acc: 0.9383
Epoch 10/27

167/167 [==============================] - 5s 27ms/step - loss: 0.1841 - acc: 0.9496
Epoch 11/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1733 - acc: 0.9568
Epoch 12/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1539 - acc: 0.9617
Epoch 13/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1450 - acc: 0.9638
Epoch 14/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1316 - acc: 0.9707
Epoch 15/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1228 - acc: 0.9738
Epoch 16/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1090 - acc: 0.9772
Epoch 17/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1051 - acc: 0.9790
Epoch 18/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0994 - acc: 0.9802
Epoch 19/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0885 - acc: 0.9813
Epoch 20/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0896 - acc: 0.9824
Epoch 21/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0778 - acc: 0.9862
Epoch 22/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0785 - acc: 0.9847
Epoch 23/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0661 - acc: 0.9893
Epoch 24/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0659 - acc: 0.9883
Epoch 25/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0600 - acc: 0.9895
Epoch 26/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0517 - acc: 0.9905
Epoch 27/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0539 - acc: 0.9886
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7886
False 1185
True percentage 0.869363906956
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-ORG       0.75      0.55      0.64       296
      I-ORG       0.46      0.34      0.40       151
      B-LOC       0.57      0.73      0.64       218
      B-PER       0.86      0.72      0.78       438
      I-PER       0.74      0.48      0.58       214
     B-MISC       0.29      0.15      0.20       141
     I-MISC       0.38      0.27      0.32       154
      I-LOC       0.53      0.77      0.63       141

avg / total       0.91      0.87      0.89      9071

F-1 Score (without O):
0.592319508449
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 11
Found 100004 word vectors.
Found 84 char vectors.
Found 100214 unique words.
Found 94 unique chars.
Found 9 unique labels.
210 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 301
OOV word occurences: 496
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6413760     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,520,322
Trainable params: 6,520,322
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 6s 38ms/step - loss: 0.9898 - acc: 0.7386
Epoch 2/27

167/167 [==============================] - 5s 30ms/step - loss: 0.5698 - acc: 0.8288
Epoch 3/27

167/167 [==============================] - 5s 30ms/step - loss: 0.4447 - acc: 0.8623
Epoch 4/27

167/167 [==============================] - 5s 30ms/step - loss: 0.3639 - acc: 0.8911
Epoch 5/27

167/167 [==============================] - 5s 28ms/step - loss: 0.3183 - acc: 0.9041
Epoch 6/27

167/167 [==============================] - 5s 28ms/step - loss: 0.2729 - acc: 0.9198
Epoch 7/27

167/167 [==============================] - 5s 28ms/step - loss: 0.2360 - acc: 0.9335
Epoch 8/27

167/167 [==============================] - 5s 28ms/step - loss: 0.2052 - acc: 0.9404
Epoch 9/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1700 - acc: 0.9562
Epoch 10/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1535 - acc: 0.9574
Epoch 11/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1404 - acc: 0.9619
Epoch 12/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1319 - acc: 0.9679
Epoch 13/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1203 - acc: 0.9692
Epoch 14/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1084 - acc: 0.9757
Epoch 15/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0950 - acc: 0.9773
Epoch 16/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0856 - acc: 0.9807
Epoch 17/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0781 - acc: 0.9848
Epoch 18/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0708 - acc: 0.9855
Epoch 19/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0692 - acc: 0.9861
Epoch 20/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0610 - acc: 0.9889
Epoch 21/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0576 - acc: 0.9918
Epoch 22/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0507 - acc: 0.9921
Epoch 23/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0486 - acc: 0.9929
Epoch 24/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0427 - acc: 0.9932
Epoch 25/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0452 - acc: 0.9932
Epoch 26/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0398 - acc: 0.9938
Epoch 27/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0361 - acc: 0.9940
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7819
False 1252
True percentage 0.861977731231
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.95      0.95      7318
      B-ORG       0.66      0.55      0.60       296
      I-ORG       0.46      0.48      0.47       151
     B-MISC       0.15      0.07      0.10       141
      B-LOC       0.71      0.62      0.66       218
      B-PER       0.86      0.58      0.69       438
     I-MISC       0.35      0.12      0.18       154
      I-PER       0.75      0.50      0.60       214
      I-LOC       0.68      0.66      0.67       141

avg / total       0.90      0.86      0.88      9071

F-1 Score (without O):
0.560606060606
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 100169 unique words.
Found 94 unique chars.
Found 9 unique labels.
165 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 299
OOV word occurences: 584
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6410880     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,517,442
Trainable params: 6,517,442
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 6s 38ms/step - loss: 1.0093 - acc: 0.7325
Epoch 2/27

167/167 [==============================] - 5s 28ms/step - loss: 0.6013 - acc: 0.8208
Epoch 3/27

167/167 [==============================] - 5s 28ms/step - loss: 0.4724 - acc: 0.8493
Epoch 4/27

167/167 [==============================] - 5s 28ms/step - loss: 0.3887 - acc: 0.8758
Epoch 5/27

167/167 [==============================] - 5s 28ms/step - loss: 0.3297 - acc: 0.9054
Epoch 6/27

167/167 [==============================] - 5s 29ms/step - loss: 0.2805 - acc: 0.9159
Epoch 7/27

167/167 [==============================] - 5s 28ms/step - loss: 0.2419 - acc: 0.9333
Epoch 8/27

167/167 [==============================] - 5s 28ms/step - loss: 0.2218 - acc: 0.9355
Epoch 9/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1947 - acc: 0.9459
Epoch 10/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1748 - acc: 0.9510
Epoch 11/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1646 - acc: 0.9533
Epoch 12/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1482 - acc: 0.9604
Epoch 13/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1370 - acc: 0.9633
Epoch 14/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1282 - acc: 0.9686
Epoch 15/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1166 - acc: 0.9710
Epoch 16/27

167/167 [==============================] - 5s 28ms/step - loss: 0.1088 - acc: 0.9749
Epoch 17/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0995 - acc: 0.9762
Epoch 18/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0917 - acc: 0.9791
Epoch 19/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0847 - acc: 0.9800
Epoch 20/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0774 - acc: 0.9835
Epoch 21/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0800 - acc: 0.9807
Epoch 22/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0734 - acc: 0.9844
Epoch 23/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0665 - acc: 0.9860
Epoch 24/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0604 - acc: 0.9874
Epoch 25/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0570 - acc: 0.9892
Epoch 26/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0527 - acc: 0.9892
Epoch 27/27

167/167 [==============================] - 5s 28ms/step - loss: 0.0503 - acc: 0.9895
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7697
False 1374
True percentage 0.848528276926
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.94      0.95      7318
      B-PER       0.83      0.51      0.63       438
      B-ORG       0.48      0.53      0.51       296
     B-MISC       0.33      0.11      0.17       141
      I-PER       0.78      0.46      0.58       214
      I-ORG       0.29      0.51      0.37       151
     I-MISC       0.26      0.12      0.16       154
      B-LOC       0.85      0.58      0.69       218
      I-LOC       0.76      0.64      0.69       141

avg / total       0.90      0.85      0.87      9071

F-1 Score (without O):
0.517098114414
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100098 unique words.
Found 94 unique chars.
Found 9 unique labels.
94 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 315
OOV word occurences: 594
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6406336     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,512,898
Trainable params: 6,512,898
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 4s 50ms/step - loss: 1.2268 - acc: 0.6541
Epoch 2/27

83/83 [==============================] - 2s 30ms/step - loss: 0.7584 - acc: 0.7971
Epoch 3/27

83/83 [==============================] - 2s 29ms/step - loss: 0.6068 - acc: 0.8091
Epoch 4/27

83/83 [==============================] - 2s 30ms/step - loss: 0.5710 - acc: 0.8330
Epoch 5/27

83/83 [==============================] - 2s 30ms/step - loss: 0.4463 - acc: 0.8547
Epoch 6/27

83/83 [==============================] - 2s 30ms/step - loss: 0.3951 - acc: 0.8748
Epoch 7/27

83/83 [==============================] - 2s 29ms/step - loss: 0.3524 - acc: 0.8924
Epoch 8/27

83/83 [==============================] - 2s 29ms/step - loss: 0.3102 - acc: 0.9196
Epoch 9/27

83/83 [==============================] - 2s 30ms/step - loss: 0.2754 - acc: 0.9091
Epoch 10/27

83/83 [==============================] - 2s 30ms/step - loss: 0.2411 - acc: 0.9317
Epoch 11/27

83/83 [==============================] - 2s 29ms/step - loss: 0.2142 - acc: 0.9485
Epoch 12/27

83/83 [==============================] - 2s 30ms/step - loss: 0.1936 - acc: 0.9560
Epoch 13/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1794 - acc: 0.9623
Epoch 14/27

83/83 [==============================] - 2s 30ms/step - loss: 0.1611 - acc: 0.9641
Epoch 15/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1445 - acc: 0.9711
Epoch 16/27

83/83 [==============================] - 2s 30ms/step - loss: 0.1317 - acc: 0.9685
Epoch 17/27

83/83 [==============================] - 2s 30ms/step - loss: 0.1217 - acc: 0.9803
Epoch 18/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1122 - acc: 0.9829
Epoch 19/27

83/83 [==============================] - 2s 30ms/step - loss: 0.0983 - acc: 0.9837
Epoch 20/27

83/83 [==============================] - 2s 30ms/step - loss: 0.0988 - acc: 0.9813
Epoch 21/27

83/83 [==============================] - 2s 30ms/step - loss: 0.0900 - acc: 0.9863
Epoch 22/27

83/83 [==============================] - 2s 30ms/step - loss: 0.0784 - acc: 0.9911
Epoch 23/27

83/83 [==============================] - 2s 30ms/step - loss: 0.0729 - acc: 0.9897
Epoch 24/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0737 - acc: 0.9863
Epoch 25/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0644 - acc: 0.9918
Epoch 26/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0635 - acc: 0.9923
Epoch 27/27

83/83 [==============================] - 2s 30ms/step - loss: 0.0603 - acc: 0.9926
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7532
False 1539
True percentage 0.830338441186
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.93      0.95      7318
      B-LOC       0.58      0.61      0.60       218
      I-LOC       0.69      0.38      0.49       141
      B-PER       0.74      0.38      0.50       438
      B-ORG       0.55      0.57      0.56       296
      I-ORG       0.25      0.35      0.29       151
     B-MISC       0.23      0.10      0.14       141
     I-MISC       0.29      0.21      0.25       154
      I-PER       0.65      0.40      0.49       214

avg / total       0.88      0.83      0.85      9071

F-1 Score (without O):
0.455305466238
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 100110 unique words.
Found 94 unique chars.
Found 9 unique labels.
106 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 313
OOV word occurences: 522
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6407104     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,513,666
Trainable params: 6,513,666
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 4s 49ms/step - loss: 1.1759 - acc: 0.6642
Epoch 2/27

83/83 [==============================] - 2s 29ms/step - loss: 0.7000 - acc: 0.8030
Epoch 3/27

83/83 [==============================] - 2s 29ms/step - loss: 0.5760 - acc: 0.8180
Epoch 4/27

83/83 [==============================] - 2s 29ms/step - loss: 0.5035 - acc: 0.8443
Epoch 5/27

83/83 [==============================] - 2s 29ms/step - loss: 0.4244 - acc: 0.8715
Epoch 6/27

83/83 [==============================] - 2s 29ms/step - loss: 0.3824 - acc: 0.8911
Epoch 7/27

83/83 [==============================] - 2s 29ms/step - loss: 0.3608 - acc: 0.9084
Epoch 8/27

83/83 [==============================] - 2s 29ms/step - loss: 0.3097 - acc: 0.9124
Epoch 9/27

83/83 [==============================] - 2s 29ms/step - loss: 0.2865 - acc: 0.9241
Epoch 10/27

83/83 [==============================] - 2s 29ms/step - loss: 0.2490 - acc: 0.9421
Epoch 11/27

83/83 [==============================] - 2s 29ms/step - loss: 0.2217 - acc: 0.9453
Epoch 12/27

83/83 [==============================] - 2s 29ms/step - loss: 0.2158 - acc: 0.9401
Epoch 13/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1905 - acc: 0.9538
Epoch 14/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1747 - acc: 0.9590
Epoch 15/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1601 - acc: 0.9613
Epoch 16/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1480 - acc: 0.9583
Epoch 17/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1339 - acc: 0.9658
Epoch 18/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1224 - acc: 0.9698
Epoch 19/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1151 - acc: 0.9707
Epoch 20/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1128 - acc: 0.9720
Epoch 21/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1029 - acc: 0.9768
Epoch 22/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0950 - acc: 0.9773
Epoch 23/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0935 - acc: 0.9807
Epoch 24/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0842 - acc: 0.9861
Epoch 25/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0804 - acc: 0.9850
Epoch 26/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0729 - acc: 0.9856
Epoch 27/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0745 - acc: 0.9885
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7652
False 1419
True percentage 0.843567412634
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.80      0.58      0.67       438
      I-PER       0.86      0.50      0.64       214
          O       0.94      0.95      0.95      7318
      B-ORG       0.51      0.55      0.53       296
      I-ORG       0.42      0.36      0.39       151
      B-LOC       0.78      0.34      0.48       218
      I-LOC       1.00      0.08      0.14       141
     B-MISC       0.09      0.03      0.04       141
     I-MISC       0.24      0.15      0.18       154

avg / total       0.88      0.84      0.85      9071

F-1 Score (without O):
0.877253320683
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100100 unique words.
Found 94 unique chars.
Found 9 unique labels.
96 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 313
OOV word occurences: 541
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6406464     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,513,026
Trainable params: 6,513,026
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 4s 48ms/step - loss: 1.1736 - acc: 0.6984
Epoch 2/27

83/83 [==============================] - 2s 29ms/step - loss: 0.6787 - acc: 0.8113
Epoch 3/27

83/83 [==============================] - 2s 28ms/step - loss: 0.5397 - acc: 0.8427
Epoch 4/27

83/83 [==============================] - 2s 29ms/step - loss: 0.4539 - acc: 0.8575
Epoch 5/27

83/83 [==============================] - 2s 29ms/step - loss: 0.3997 - acc: 0.8874
Epoch 6/27

83/83 [==============================] - 2s 29ms/step - loss: 0.3595 - acc: 0.8949
Epoch 7/27

83/83 [==============================] - 2s 28ms/step - loss: 0.3245 - acc: 0.9045
Epoch 8/27

83/83 [==============================] - 2s 29ms/step - loss: 0.2891 - acc: 0.9125
Epoch 9/27

83/83 [==============================] - 2s 28ms/step - loss: 0.2573 - acc: 0.9251
Epoch 10/27

83/83 [==============================] - 2s 28ms/step - loss: 0.2442 - acc: 0.9345
Epoch 11/27

83/83 [==============================] - 2s 28ms/step - loss: 0.2065 - acc: 0.9493
Epoch 12/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1898 - acc: 0.9538
Epoch 13/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1734 - acc: 0.9576
Epoch 14/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1671 - acc: 0.9625
Epoch 15/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1535 - acc: 0.9706
Epoch 16/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1332 - acc: 0.9732
Epoch 17/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1241 - acc: 0.9766
Epoch 18/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1147 - acc: 0.9785
Epoch 19/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1132 - acc: 0.9797
Epoch 20/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1039 - acc: 0.9835
Epoch 21/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0941 - acc: 0.9853
Epoch 22/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0903 - acc: 0.9841
Epoch 23/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0767 - acc: 0.9880
Epoch 24/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0769 - acc: 0.9880
Epoch 25/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0717 - acc: 0.9890
Epoch 26/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0623 - acc: 0.9927
Epoch 27/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0569 - acc: 0.9915
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7620
False 1451
True percentage 0.840039686914
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.95      0.94      7318
      B-PER       0.75      0.51      0.61       438
      B-LOC       0.65      0.52      0.58       218
     B-MISC       0.21      0.04      0.07       141
     I-MISC       0.27      0.17      0.21       154
      B-ORG       0.49      0.50      0.50       296
      I-ORG       0.36      0.21      0.27       151
      I-LOC       0.88      0.54      0.67       141
      I-PER       0.71      0.34      0.46       214

avg / total       0.87      0.84      0.85      9071

F-1 Score (without O):
0.475638841567
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 100101 unique words.
Found 94 unique chars.
Found 9 unique labels.
97 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 311
OOV word occurences: 542
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6406528     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,513,090
Trainable params: 6,513,090
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 4s 49ms/step - loss: 1.3244 - acc: 0.6394
Epoch 2/27

83/83 [==============================] - 2s 29ms/step - loss: 0.7752 - acc: 0.7894
Epoch 3/27

83/83 [==============================] - 2s 29ms/step - loss: 0.6199 - acc: 0.7974
Epoch 4/27

83/83 [==============================] - 2s 29ms/step - loss: 0.5260 - acc: 0.8335
Epoch 5/27

83/83 [==============================] - 2s 28ms/step - loss: 0.4636 - acc: 0.8602
Epoch 6/27

83/83 [==============================] - 2s 29ms/step - loss: 0.4008 - acc: 0.8761
Epoch 7/27

83/83 [==============================] - 2s 29ms/step - loss: 0.3482 - acc: 0.9018
Epoch 8/27

83/83 [==============================] - 2s 28ms/step - loss: 0.3169 - acc: 0.9172
Epoch 9/27

83/83 [==============================] - 2s 29ms/step - loss: 0.2721 - acc: 0.9353
Epoch 10/27

83/83 [==============================] - 2s 29ms/step - loss: 0.2536 - acc: 0.9329
Epoch 11/27

83/83 [==============================] - 2s 29ms/step - loss: 0.2221 - acc: 0.9410
Epoch 12/27

83/83 [==============================] - 2s 28ms/step - loss: 0.2045 - acc: 0.9425
Epoch 13/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1862 - acc: 0.9554
Epoch 14/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1739 - acc: 0.9539
Epoch 15/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1551 - acc: 0.9643
Epoch 16/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1356 - acc: 0.9752
Epoch 17/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1407 - acc: 0.9658
Epoch 18/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1261 - acc: 0.9747
Epoch 19/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1189 - acc: 0.9771
Epoch 20/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1032 - acc: 0.9782
Epoch 21/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0957 - acc: 0.9859
Epoch 22/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0954 - acc: 0.9851
Epoch 23/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0887 - acc: 0.9829
Epoch 24/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0768 - acc: 0.9848
Epoch 25/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0765 - acc: 0.9861
Epoch 26/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0674 - acc: 0.9922
Epoch 27/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0610 - acc: 0.9903
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7687
False 1384
True percentage 0.847425862639
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.95      0.95      7318
      B-ORG       0.51      0.49      0.50       296
      I-ORG       0.37      0.36      0.36       151
      B-PER       0.83      0.58      0.68       438
      I-PER       0.64      0.49      0.55       214
      B-LOC       0.79      0.44      0.56       218
      I-LOC       0.82      0.16      0.27       141
     B-MISC       0.32      0.13      0.18       141
     I-MISC       0.34      0.40      0.36       154

avg / total       0.89      0.85      0.86      9071

F-1 Score (without O):
0.495388669302
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 100119 unique words.
Found 94 unique chars.
Found 9 unique labels.
115 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 311
OOV word occurences: 550
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6407680     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,514,242
Trainable params: 6,514,242
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 4s 49ms/step - loss: 1.2343 - acc: 0.6664
Epoch 2/27

83/83 [==============================] - 2s 28ms/step - loss: 0.6762 - acc: 0.8253
Epoch 3/27

83/83 [==============================] - 2s 28ms/step - loss: 0.5610 - acc: 0.8353
Epoch 4/27

83/83 [==============================] - 2s 28ms/step - loss: 0.4463 - acc: 0.8675
Epoch 5/27

83/83 [==============================] - 2s 28ms/step - loss: 0.4285 - acc: 0.8785
Epoch 6/27

83/83 [==============================] - 2s 28ms/step - loss: 0.3475 - acc: 0.8874
Epoch 7/27

83/83 [==============================] - 2s 28ms/step - loss: 0.3106 - acc: 0.9080
Epoch 8/27

83/83 [==============================] - 2s 28ms/step - loss: 0.2650 - acc: 0.9199
Epoch 9/27

83/83 [==============================] - 2s 28ms/step - loss: 0.2390 - acc: 0.9261
Epoch 10/27

83/83 [==============================] - 2s 28ms/step - loss: 0.2150 - acc: 0.9394
Epoch 11/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1950 - acc: 0.9504
Epoch 12/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1681 - acc: 0.9631
Epoch 13/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1554 - acc: 0.9618
Epoch 14/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1510 - acc: 0.9645
Epoch 15/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1355 - acc: 0.9679
Epoch 16/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1268 - acc: 0.9732
Epoch 17/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1064 - acc: 0.9788
Epoch 18/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0957 - acc: 0.9845
Epoch 19/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0980 - acc: 0.9812
Epoch 20/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0905 - acc: 0.9829
Epoch 21/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0818 - acc: 0.9852
Epoch 22/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0746 - acc: 0.9908
Epoch 23/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0749 - acc: 0.9870
Epoch 24/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0694 - acc: 0.9881
Epoch 25/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0613 - acc: 0.9919
Epoch 26/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0630 - acc: 0.9889
Epoch 27/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0546 - acc: 0.9904
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7658
False 1413
True percentage 0.844228861206
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.95      0.95      7318
      B-ORG       0.46      0.45      0.46       296
      I-ORG       0.38      0.28      0.33       151
      B-PER       0.85      0.57      0.68       438
      I-PER       0.80      0.43      0.56       214
     B-MISC       0.05      0.01      0.01       141
     I-MISC       0.14      0.05      0.08       154
      B-LOC       0.62      0.47      0.54       218
      I-LOC       0.52      0.66      0.58       141

avg / total       0.88      0.84      0.86      9071

F-1 Score (without O):
0.483266398929
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 100126 unique words.
Found 94 unique chars.
Found 9 unique labels.
122 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 309
OOV word occurences: 506
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6408128     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,514,690
Trainable params: 6,514,690
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 4s 48ms/step - loss: 1.1548 - acc: 0.6778
Epoch 2/27

83/83 [==============================] - 2s 28ms/step - loss: 0.6625 - acc: 0.8150
Epoch 3/27

83/83 [==============================] - 2s 28ms/step - loss: 0.5571 - acc: 0.8266
Epoch 4/27

83/83 [==============================] - 2s 28ms/step - loss: 0.4600 - acc: 0.8543
Epoch 5/27

83/83 [==============================] - 2s 28ms/step - loss: 0.4366 - acc: 0.8763
Epoch 6/27

83/83 [==============================] - 2s 28ms/step - loss: 0.3531 - acc: 0.8930
Epoch 7/27

83/83 [==============================] - 2s 28ms/step - loss: 0.3132 - acc: 0.9113
Epoch 8/27

83/83 [==============================] - 2s 28ms/step - loss: 0.2760 - acc: 0.9188
Epoch 9/27

83/83 [==============================] - 2s 28ms/step - loss: 0.2513 - acc: 0.9319
Epoch 10/27

83/83 [==============================] - 2s 28ms/step - loss: 0.2117 - acc: 0.9414
Epoch 11/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1942 - acc: 0.9471
Epoch 12/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1725 - acc: 0.9546
Epoch 13/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1577 - acc: 0.9569
Epoch 14/27

83/83 [==============================] - 2s 27ms/step - loss: 0.1426 - acc: 0.9622
Epoch 15/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1340 - acc: 0.9659
Epoch 16/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1250 - acc: 0.9685
Epoch 17/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1109 - acc: 0.9731
Epoch 18/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1139 - acc: 0.9711
Epoch 19/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0998 - acc: 0.9769
Epoch 20/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0955 - acc: 0.9758
Epoch 21/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0851 - acc: 0.9835
Epoch 22/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0763 - acc: 0.9842
Epoch 23/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0738 - acc: 0.9856
Epoch 24/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0679 - acc: 0.9873
Epoch 25/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0653 - acc: 0.9909
Epoch 26/27

83/83 [==============================] - 2s 27ms/step - loss: 0.0622 - acc: 0.9896
Epoch 27/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0577 - acc: 0.9910
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7659
False 1412
True percentage 0.844339102635
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.82      0.61      0.70       438
          O       0.94      0.95      0.94      7318
      B-LOC       0.75      0.40      0.52       218
      B-ORG       0.54      0.61      0.58       296
      I-PER       0.67      0.41      0.51       214
     B-MISC       0.26      0.06      0.09       141
     I-MISC       0.22      0.08      0.11       154
      I-ORG       0.31      0.38      0.34       151
      I-LOC       0.79      0.27      0.40       141

avg / total       0.88      0.84      0.85      9071

F-1 Score (without O):
0.876325925926
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 100098 unique words.
Found 94 unique chars.
Found 9 unique labels.
94 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 317
OOV word occurences: 615
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6406336     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,512,898
Trainable params: 6,512,898
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 4s 48ms/step - loss: 1.1611 - acc: 0.6910
Epoch 2/27

83/83 [==============================] - 2s 28ms/step - loss: 0.7040 - acc: 0.8070
Epoch 3/27

83/83 [==============================] - 2s 28ms/step - loss: 0.5955 - acc: 0.8189
Epoch 4/27

83/83 [==============================] - 2s 28ms/step - loss: 0.4907 - acc: 0.8354
Epoch 5/27

83/83 [==============================] - 2s 28ms/step - loss: 0.4332 - acc: 0.8532
Epoch 6/27

83/83 [==============================] - 2s 29ms/step - loss: 0.3845 - acc: 0.8766
Epoch 7/27

83/83 [==============================] - 2s 29ms/step - loss: 0.3247 - acc: 0.8980
Epoch 8/27

83/83 [==============================] - 2s 29ms/step - loss: 0.2938 - acc: 0.9118
Epoch 9/27

83/83 [==============================] - 2s 29ms/step - loss: 0.2657 - acc: 0.9287
Epoch 10/27

83/83 [==============================] - 2s 29ms/step - loss: 0.2250 - acc: 0.9392
Epoch 11/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1954 - acc: 0.9512
Epoch 12/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1801 - acc: 0.9535
Epoch 13/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1589 - acc: 0.9616
Epoch 14/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1448 - acc: 0.9695
Epoch 15/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1290 - acc: 0.9717
Epoch 16/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1179 - acc: 0.9789
Epoch 17/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1120 - acc: 0.9754
Epoch 18/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1063 - acc: 0.9856
Epoch 19/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0880 - acc: 0.9877
Epoch 20/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0892 - acc: 0.9868
Epoch 21/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0758 - acc: 0.9902
Epoch 22/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0739 - acc: 0.9871
Epoch 23/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0659 - acc: 0.9928
Epoch 24/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0618 - acc: 0.9933
Epoch 25/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0648 - acc: 0.9896
Epoch 26/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0516 - acc: 0.9938
Epoch 27/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0497 - acc: 0.9954
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7600
False 1471
True percentage 0.83783485834
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.95      0.95      7318
     B-MISC       0.07      0.01      0.02       141
      B-ORG       0.52      0.54      0.53       296
     I-MISC       0.32      0.12      0.18       154
      B-LOC       0.69      0.63      0.66       218
      I-ORG       0.29      0.30      0.30       151
      B-PER       0.77      0.42      0.55       438
      I-PER       0.68      0.32      0.44       214
      I-LOC       0.86      0.43      0.57       141

avg / total       0.88      0.84      0.85      9071

F-1 Score (without O):
0.46511627907
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 100112 unique words.
Found 94 unique chars.
Found 9 unique labels.
108 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 315
OOV word occurences: 610
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6407232     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,513,794
Trainable params: 6,513,794
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 4s 49ms/step - loss: 1.1393 - acc: 0.6767
Epoch 2/27

83/83 [==============================] - 2s 29ms/step - loss: 0.6658 - acc: 0.8208
Epoch 3/27

83/83 [==============================] - 2s 29ms/step - loss: 0.5665 - acc: 0.8303
Epoch 4/27

83/83 [==============================] - 2s 29ms/step - loss: 0.4518 - acc: 0.8511
Epoch 5/27

83/83 [==============================] - 2s 29ms/step - loss: 0.3940 - acc: 0.8788
Epoch 6/27

83/83 [==============================] - 2s 29ms/step - loss: 0.3551 - acc: 0.8973
Epoch 7/27

83/83 [==============================] - 2s 29ms/step - loss: 0.3084 - acc: 0.9079
Epoch 8/27

83/83 [==============================] - 2s 29ms/step - loss: 0.2703 - acc: 0.9260
Epoch 9/27

83/83 [==============================] - 2s 29ms/step - loss: 0.2487 - acc: 0.9356
Epoch 10/27

83/83 [==============================] - 2s 29ms/step - loss: 0.2164 - acc: 0.9426
Epoch 11/27

83/83 [==============================] - 2s 28ms/step - loss: 0.2063 - acc: 0.9492
Epoch 12/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1844 - acc: 0.9518
Epoch 13/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1623 - acc: 0.9675
Epoch 14/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1525 - acc: 0.9587
Epoch 15/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1408 - acc: 0.9681
Epoch 16/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1352 - acc: 0.9654
Epoch 17/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1110 - acc: 0.9779
Epoch 18/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1048 - acc: 0.9779
Epoch 19/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1021 - acc: 0.9816
Epoch 20/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0850 - acc: 0.9881
Epoch 21/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0868 - acc: 0.9838
Epoch 22/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0753 - acc: 0.9888
Epoch 23/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0747 - acc: 0.9917
Epoch 24/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0706 - acc: 0.9884
Epoch 25/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0627 - acc: 0.9919
Epoch 26/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0598 - acc: 0.9912
Epoch 27/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0595 - acc: 0.9919
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7513
False 1558
True percentage 0.82824385404
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.47      0.43      0.45       296
          O       0.95      0.94      0.94      7318
     B-MISC       0.18      0.11      0.13       141
     I-MISC       0.27      0.36      0.31       154
      B-LOC       0.73      0.51      0.60       218
      I-LOC       0.70      0.10      0.17       141
      B-PER       0.85      0.43      0.57       438
      I-PER       0.68      0.31      0.43       214
      I-ORG       0.25      0.19      0.21       151

avg / total       0.88      0.83      0.84      9071

F-1 Score (without O):
0.870595167943
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 8
Found 100004 word vectors.
Found 84 char vectors.
Found 100114 unique words.
Found 94 unique chars.
Found 9 unique labels.
110 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 312
OOV word occurences: 523
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6407360     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,513,922
Trainable params: 6,513,922
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 4s 50ms/step - loss: 1.2834 - acc: 0.6612
Epoch 2/27

83/83 [==============================] - 2s 29ms/step - loss: 0.7538 - acc: 0.7962
Epoch 3/27

83/83 [==============================] - 2s 29ms/step - loss: 0.6192 - acc: 0.8139
Epoch 4/27

83/83 [==============================] - 2s 29ms/step - loss: 0.5154 - acc: 0.8378
Epoch 5/27

83/83 [==============================] - 2s 29ms/step - loss: 0.4824 - acc: 0.8550
Epoch 6/27

83/83 [==============================] - 2s 29ms/step - loss: 0.3871 - acc: 0.8828
Epoch 7/27

83/83 [==============================] - 2s 29ms/step - loss: 0.3366 - acc: 0.9021
Epoch 8/27

83/83 [==============================] - 2s 29ms/step - loss: 0.3047 - acc: 0.9177
Epoch 9/27

83/83 [==============================] - 2s 29ms/step - loss: 0.2730 - acc: 0.9278
Epoch 10/27

83/83 [==============================] - 2s 29ms/step - loss: 0.2365 - acc: 0.9300
Epoch 11/27

83/83 [==============================] - 2s 28ms/step - loss: 0.2152 - acc: 0.9491
Epoch 12/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1892 - acc: 0.9588
Epoch 13/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1873 - acc: 0.9526
Epoch 14/27

83/83 [==============================] - 2s 30ms/step - loss: 0.1596 - acc: 0.9618
Epoch 15/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1404 - acc: 0.9723
Epoch 16/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1333 - acc: 0.9702
Epoch 17/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1258 - acc: 0.9704
Epoch 18/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1202 - acc: 0.9723
Epoch 19/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1076 - acc: 0.9757
Epoch 20/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0982 - acc: 0.9825
Epoch 21/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0891 - acc: 0.9785
Epoch 22/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0810 - acc: 0.9852
Epoch 23/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0819 - acc: 0.9860
Epoch 24/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0740 - acc: 0.9915
Epoch 25/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0689 - acc: 0.9873
Epoch 26/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0616 - acc: 0.9935
Epoch 27/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0591 - acc: 0.9921
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7681
False 1390
True percentage 0.846764414067
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.57      0.61      0.59       296
          O       0.95      0.95      0.95      7318
      B-LOC       0.64      0.58      0.61       218
      I-LOC       0.72      0.63      0.67       141
      I-ORG       0.39      0.35      0.37       151
      B-PER       0.77      0.51      0.61       438
      I-PER       0.70      0.38      0.50       214
     B-MISC       0.13      0.03      0.05       141
     I-MISC       0.11      0.01      0.02       154

avg / total       0.87      0.85      0.86      9071

F-1 Score (without O):
0.882197259307
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 9
Found 100004 word vectors.
Found 84 char vectors.
Found 100125 unique words.
Found 94 unique chars.
Found 9 unique labels.
121 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 312
OOV word occurences: 503
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6408064     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,514,626
Trainable params: 6,514,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 4s 50ms/step - loss: 1.1645 - acc: 0.7291
Epoch 2/27

83/83 [==============================] - 2s 29ms/step - loss: 0.7339 - acc: 0.8062
Epoch 3/27

83/83 [==============================] - 2s 29ms/step - loss: 0.5914 - acc: 0.8112
Epoch 4/27

83/83 [==============================] - 2s 29ms/step - loss: 0.4878 - acc: 0.8439
Epoch 5/27

83/83 [==============================] - 2s 30ms/step - loss: 0.4324 - acc: 0.8693
Epoch 6/27

83/83 [==============================] - 2s 29ms/step - loss: 0.3704 - acc: 0.8930
Epoch 7/27

83/83 [==============================] - 2s 29ms/step - loss: 0.3237 - acc: 0.9078
Epoch 8/27

83/83 [==============================] - 2s 29ms/step - loss: 0.2801 - acc: 0.9271
Epoch 9/27

83/83 [==============================] - 2s 29ms/step - loss: 0.2629 - acc: 0.9311
Epoch 10/27

83/83 [==============================] - 2s 29ms/step - loss: 0.2299 - acc: 0.9441
Epoch 11/27

83/83 [==============================] - 2s 30ms/step - loss: 0.2098 - acc: 0.9514
Epoch 12/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1873 - acc: 0.9550
Epoch 13/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1716 - acc: 0.9611
Epoch 14/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1530 - acc: 0.9637
Epoch 15/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1540 - acc: 0.9613
Epoch 16/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1327 - acc: 0.9688
Epoch 17/27

83/83 [==============================] - 2s 30ms/step - loss: 0.1231 - acc: 0.9695
Epoch 18/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1165 - acc: 0.9772
Epoch 19/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1119 - acc: 0.9778
Epoch 20/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0988 - acc: 0.9790
Epoch 21/27

83/83 [==============================] - 2s 30ms/step - loss: 0.0900 - acc: 0.9815
Epoch 22/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0872 - acc: 0.9811
Epoch 23/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0827 - acc: 0.9845
Epoch 24/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0753 - acc: 0.9882
Epoch 25/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0755 - acc: 0.9848
Epoch 26/27

83/83 [==============================] - 2s 30ms/step - loss: 0.0719 - acc: 0.9873
Epoch 27/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0707 - acc: 0.9850
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7779
False 1292
True percentage 0.857568074082
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.94      0.95      7318
      B-LOC       0.63      0.64      0.64       218
      I-LOC       0.76      0.57      0.65       141
      B-ORG       0.64      0.58      0.61       296
      B-PER       0.81      0.61      0.70       438
      I-PER       0.77      0.57      0.65       214
      I-ORG       0.55      0.34      0.42       151
     B-MISC       0.42      0.08      0.13       141
     I-MISC       0.29      0.23      0.26       154

avg / total       0.89      0.86      0.87      9071

F-1 Score (without O):
0.571428571429
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 10
Found 100004 word vectors.
Found 84 char vectors.
Found 100110 unique words.
Found 94 unique chars.
Found 9 unique labels.
106 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 317
OOV word occurences: 529
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6407104     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,513,666
Trainable params: 6,513,666
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 4s 50ms/step - loss: 1.1989 - acc: 0.7310
Epoch 2/27

83/83 [==============================] - 2s 29ms/step - loss: 0.7662 - acc: 0.7923
Epoch 3/27

83/83 [==============================] - 2s 29ms/step - loss: 0.6506 - acc: 0.7975
Epoch 4/27

83/83 [==============================] - 2s 29ms/step - loss: 0.5440 - acc: 0.8158
Epoch 5/27

83/83 [==============================] - 2s 29ms/step - loss: 0.4907 - acc: 0.8432
Epoch 6/27

83/83 [==============================] - 2s 29ms/step - loss: 0.4036 - acc: 0.8741
Epoch 7/27

83/83 [==============================] - 2s 29ms/step - loss: 0.3563 - acc: 0.8924
Epoch 8/27

83/83 [==============================] - 2s 29ms/step - loss: 0.3299 - acc: 0.9032
Epoch 9/27

83/83 [==============================] - 2s 29ms/step - loss: 0.2837 - acc: 0.9174
Epoch 10/27

83/83 [==============================] - 2s 29ms/step - loss: 0.2542 - acc: 0.9263
Epoch 11/27

83/83 [==============================] - 2s 29ms/step - loss: 0.2217 - acc: 0.9381
Epoch 12/27

83/83 [==============================] - 2s 29ms/step - loss: 0.2104 - acc: 0.9495
Epoch 13/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1935 - acc: 0.9425
Epoch 14/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1775 - acc: 0.9613
Epoch 15/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1613 - acc: 0.9593
Epoch 16/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1402 - acc: 0.9748
Epoch 17/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1278 - acc: 0.9780
Epoch 18/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1250 - acc: 0.9773
Epoch 19/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1045 - acc: 0.9832
Epoch 20/27

83/83 [==============================] - 2s 30ms/step - loss: 0.1056 - acc: 0.9806
Epoch 21/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0947 - acc: 0.9841
Epoch 22/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0890 - acc: 0.9865
Epoch 23/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0783 - acc: 0.9880
Epoch 24/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0762 - acc: 0.9894
Epoch 25/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0698 - acc: 0.9896
Epoch 26/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0617 - acc: 0.9920
Epoch 27/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0603 - acc: 0.9924
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7674
False 1397
True percentage 0.845992724066
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.94      0.95      7318
      B-ORG       0.52      0.63      0.57       296
      I-ORG       0.29      0.60      0.39       151
      B-LOC       0.67      0.56      0.61       218
      B-PER       0.78      0.53      0.63       438
      I-PER       0.81      0.29      0.43       214
     B-MISC       0.28      0.08      0.12       141
     I-MISC       0.38      0.21      0.27       154
      I-LOC       0.68      0.50      0.58       141

avg / total       0.90      0.85      0.86      9071

F-1 Score (without O):
0.502807236432
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 11
Found 100004 word vectors.
Found 84 char vectors.
Found 100112 unique words.
Found 94 unique chars.
Found 9 unique labels.
108 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 314
OOV word occurences: 550
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6407232     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,513,794
Trainable params: 6,513,794
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 4s 49ms/step - loss: 1.2608 - acc: 0.6475
Epoch 2/27

83/83 [==============================] - 2s 29ms/step - loss: 0.7317 - acc: 0.8050
Epoch 3/27

83/83 [==============================] - 2s 29ms/step - loss: 0.6287 - acc: 0.8096
Epoch 4/27

83/83 [==============================] - 2s 29ms/step - loss: 0.5257 - acc: 0.8360
Epoch 5/27

83/83 [==============================] - 2s 29ms/step - loss: 0.4670 - acc: 0.8508
Epoch 6/27

83/83 [==============================] - 2s 29ms/step - loss: 0.3968 - acc: 0.8677
Epoch 7/27

83/83 [==============================] - 2s 29ms/step - loss: 0.3750 - acc: 0.8849
Epoch 8/27

83/83 [==============================] - 2s 29ms/step - loss: 0.3146 - acc: 0.9076
Epoch 9/27

83/83 [==============================] - 2s 29ms/step - loss: 0.2841 - acc: 0.9244
Epoch 10/27

83/83 [==============================] - 2s 29ms/step - loss: 0.2464 - acc: 0.9345
Epoch 11/27

83/83 [==============================] - 2s 29ms/step - loss: 0.2252 - acc: 0.9330
Epoch 12/27

83/83 [==============================] - 2s 29ms/step - loss: 0.2061 - acc: 0.9469
Epoch 13/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1865 - acc: 0.9459
Epoch 14/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1728 - acc: 0.9633
Epoch 15/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1574 - acc: 0.9624
Epoch 16/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1451 - acc: 0.9712
Epoch 17/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1355 - acc: 0.9688
Epoch 18/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1182 - acc: 0.9791
Epoch 19/27

83/83 [==============================] - 2s 28ms/step - loss: 0.1161 - acc: 0.9757
Epoch 20/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1072 - acc: 0.9766
Epoch 21/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1016 - acc: 0.9808
Epoch 22/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0956 - acc: 0.9806
Epoch 23/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0874 - acc: 0.9855
Epoch 24/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0815 - acc: 0.9861
Epoch 25/27

83/83 [==============================] - 2s 28ms/step - loss: 0.0750 - acc: 0.9883
Epoch 26/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0740 - acc: 0.9878
Epoch 27/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0656 - acc: 0.9908
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7592
False 1479
True percentage 0.83695292691
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.93      0.94      7318
      B-ORG       0.52      0.33      0.41       296
      I-ORG       0.35      0.42      0.38       151
     B-MISC       0.19      0.17      0.18       141
      B-LOC       0.71      0.55      0.62       218
      B-PER       0.69      0.58      0.63       438
     I-MISC       0.35      0.15      0.21       154
      I-PER       0.80      0.41      0.54       214
      I-LOC       0.51      0.57      0.54       141

avg / total       0.88      0.84      0.86      9071

F-1 Score (without O):
0.483311938383
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 100094 unique words.
Found 94 unique chars.
Found 9 unique labels.
90 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 312
OOV word occurences: 614
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6406080     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,512,642
Trainable params: 6,512,642
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 4s 50ms/step - loss: 1.2315 - acc: 0.6635
Epoch 2/27

83/83 [==============================] - 2s 29ms/step - loss: 0.6583 - acc: 0.8228
Epoch 3/27

83/83 [==============================] - 2s 30ms/step - loss: 0.5327 - acc: 0.8309
Epoch 4/27

83/83 [==============================] - 2s 29ms/step - loss: 0.4759 - acc: 0.8529
Epoch 5/27

83/83 [==============================] - 2s 29ms/step - loss: 0.3965 - acc: 0.8776
Epoch 6/27

83/83 [==============================] - 2s 30ms/step - loss: 0.3541 - acc: 0.8869
Epoch 7/27

83/83 [==============================] - 2s 29ms/step - loss: 0.3101 - acc: 0.8978
Epoch 8/27

83/83 [==============================] - 2s 29ms/step - loss: 0.2823 - acc: 0.9117
Epoch 9/27

83/83 [==============================] - 2s 29ms/step - loss: 0.2482 - acc: 0.9255
Epoch 10/27

83/83 [==============================] - 2s 29ms/step - loss: 0.2316 - acc: 0.9287
Epoch 11/27

83/83 [==============================] - 2s 30ms/step - loss: 0.2094 - acc: 0.9455
Epoch 12/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1887 - acc: 0.9435
Epoch 13/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1770 - acc: 0.9593
Epoch 14/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1522 - acc: 0.9696
Epoch 15/27

83/83 [==============================] - 2s 30ms/step - loss: 0.1416 - acc: 0.9707
Epoch 16/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1211 - acc: 0.9756
Epoch 17/27

83/83 [==============================] - 2s 29ms/step - loss: 0.1208 - acc: 0.9779
Epoch 18/27

83/83 [==============================] - 3s 30ms/step - loss: 0.1056 - acc: 0.9843
Epoch 19/27

83/83 [==============================] - 2s 30ms/step - loss: 0.0981 - acc: 0.9854
Epoch 20/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0960 - acc: 0.9851
Epoch 21/27

83/83 [==============================] - 2s 30ms/step - loss: 0.0895 - acc: 0.9908
Epoch 22/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0793 - acc: 0.9900
Epoch 23/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0732 - acc: 0.9942
Epoch 24/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0674 - acc: 0.9922
Epoch 25/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0656 - acc: 0.9927
Epoch 26/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0604 - acc: 0.9907
Epoch 27/27

83/83 [==============================] - 2s 29ms/step - loss: 0.0578 - acc: 0.9950
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7570
False 1501
True percentage 0.834527615478
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.94      0.94      7318
      B-PER       0.71      0.41      0.52       438
      B-ORG       0.51      0.42      0.46       296
     B-MISC       0.40      0.14      0.21       141
      I-PER       0.79      0.32      0.46       214
      I-ORG       0.31      0.23      0.26       151
     I-MISC       0.40      0.27      0.32       154
      B-LOC       0.70      0.50      0.58       218
      I-LOC       0.63      0.57      0.60       141

avg / total       0.88      0.83      0.85      9071

F-1 Score (without O):
0.456468955949
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100039 unique words.
Found 93 unique chars.
Found 9 unique labels.
35 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 322
OOV word occurences: 617
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6402560     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,509,058
Trainable params: 6,509,058
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 3s 82ms/step - loss: 1.7098 - acc: 0.4568
Epoch 2/27

33/33 [==============================] - 1s 31ms/step - loss: 0.9519 - acc: 0.7771
Epoch 3/27

33/33 [==============================] - 1s 31ms/step - loss: 0.8744 - acc: 0.7769
Epoch 4/27

33/33 [==============================] - 1s 31ms/step - loss: 0.7723 - acc: 0.7811
Epoch 5/27

33/33 [==============================] - 1s 31ms/step - loss: 0.7391 - acc: 0.7792
Epoch 6/27

33/33 [==============================] - 1s 31ms/step - loss: 0.6914 - acc: 0.7781
Epoch 7/27

33/33 [==============================] - 1s 31ms/step - loss: 0.6441 - acc: 0.8002
Epoch 8/27

33/33 [==============================] - 1s 31ms/step - loss: 0.5883 - acc: 0.8121
Epoch 9/27

33/33 [==============================] - 1s 31ms/step - loss: 0.5495 - acc: 0.8229
Epoch 10/27

33/33 [==============================] - 1s 31ms/step - loss: 0.5131 - acc: 0.8329
Epoch 11/27

33/33 [==============================] - 1s 30ms/step - loss: 0.4842 - acc: 0.8325
Epoch 12/27

33/33 [==============================] - 1s 31ms/step - loss: 0.4520 - acc: 0.8437
Epoch 13/27

33/33 [==============================] - 1s 31ms/step - loss: 0.4297 - acc: 0.8627
Epoch 14/27

33/33 [==============================] - 1s 31ms/step - loss: 0.4031 - acc: 0.8704
Epoch 15/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3930 - acc: 0.8727
Epoch 16/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3667 - acc: 0.9146
Epoch 17/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3547 - acc: 0.9080
Epoch 18/27

33/33 [==============================] - 1s 30ms/step - loss: 0.3303 - acc: 0.9221
Epoch 19/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3056 - acc: 0.9240
Epoch 20/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2996 - acc: 0.9216
Epoch 21/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2817 - acc: 0.9329
Epoch 22/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2823 - acc: 0.9353
Epoch 23/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2525 - acc: 0.9524
Epoch 24/27

33/33 [==============================] - 1s 30ms/step - loss: 0.2352 - acc: 0.9527
Epoch 25/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2249 - acc: 0.9481
Epoch 26/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2120 - acc: 0.9579
Epoch 27/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1979 - acc: 0.9803
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7357
False 1714
True percentage 0.811046191159
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.91      0.95      0.93      7318
      B-LOC       0.84      0.26      0.39       218
      I-LOC       0.76      0.11      0.20       141
      B-PER       0.62      0.28      0.39       438
      B-ORG       0.41      0.40      0.40       296
      I-ORG       0.24      0.26      0.25       151
     B-MISC       0.33      0.01      0.01       141
     I-MISC       0.29      0.14      0.19       154
      I-PER       0.69      0.10      0.18       214

avg / total       0.84      0.81      0.81      9071

F-1 Score (without O):
0.304967269927
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 100047 unique words.
Found 94 unique chars.
Found 9 unique labels.
43 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 320
OOV word occurences: 539
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6403072     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,509,634
Trainable params: 6,509,634
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 3s 81ms/step - loss: 1.7495 - acc: 0.4397
Epoch 2/27

33/33 [==============================] - 1s 30ms/step - loss: 0.9123 - acc: 0.7730
Epoch 3/27

33/33 [==============================] - 1s 31ms/step - loss: 0.8281 - acc: 0.7773
Epoch 4/27

33/33 [==============================] - 1s 30ms/step - loss: 0.7695 - acc: 0.7832
Epoch 5/27

33/33 [==============================] - 1s 30ms/step - loss: 0.6809 - acc: 0.7863
Epoch 6/27

33/33 [==============================] - 1s 30ms/step - loss: 0.6336 - acc: 0.7976
Epoch 7/27

33/33 [==============================] - 1s 30ms/step - loss: 0.5950 - acc: 0.7953
Epoch 8/27

33/33 [==============================] - 1s 30ms/step - loss: 0.5659 - acc: 0.8335
Epoch 9/27

33/33 [==============================] - 1s 31ms/step - loss: 0.5040 - acc: 0.8311
Epoch 10/27

33/33 [==============================] - 1s 31ms/step - loss: 0.4965 - acc: 0.8365
Epoch 11/27

33/33 [==============================] - 1s 31ms/step - loss: 0.4384 - acc: 0.8666
Epoch 12/27

33/33 [==============================] - 1s 30ms/step - loss: 0.4201 - acc: 0.8761
Epoch 13/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3838 - acc: 0.8983
Epoch 14/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3664 - acc: 0.9105
Epoch 15/27

33/33 [==============================] - 1s 30ms/step - loss: 0.3378 - acc: 0.9061
Epoch 16/27

33/33 [==============================] - 1s 30ms/step - loss: 0.3133 - acc: 0.9225
Epoch 17/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2862 - acc: 0.9266
Epoch 18/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2869 - acc: 0.9213
Epoch 19/27

33/33 [==============================] - 1s 30ms/step - loss: 0.2687 - acc: 0.9295
Epoch 20/27

33/33 [==============================] - 1s 30ms/step - loss: 0.2549 - acc: 0.9344
Epoch 21/27

33/33 [==============================] - 1s 30ms/step - loss: 0.2439 - acc: 0.9457
Epoch 22/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2217 - acc: 0.9394
Epoch 23/27

33/33 [==============================] - 1s 30ms/step - loss: 0.2221 - acc: 0.9670
Epoch 24/27

33/33 [==============================] - 1s 30ms/step - loss: 0.1939 - acc: 0.9521
Epoch 25/27

33/33 [==============================] - 1s 30ms/step - loss: 0.2382 - acc: 0.9467
Epoch 26/27

33/33 [==============================] - 1s 30ms/step - loss: 0.1708 - acc: 0.9636
Epoch 27/27

33/33 [==============================] - 1s 30ms/step - loss: 0.1737 - acc: 0.9638
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7420
False 1651
True percentage 0.817991401169
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.66      0.50      0.57       438
      I-PER       0.52      0.41      0.46       214
          O       0.94      0.93      0.94      7318
      B-ORG       0.36      0.54      0.43       296
      I-ORG       0.26      0.43      0.32       151
      B-LOC       0.80      0.19      0.30       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.21      0.05      0.07       154

avg / total       0.84      0.82      0.82      9071

F-1 Score (without O):
0.855598455598
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100037 unique words.
Found 92 unique chars.
Found 9 unique labels.
33 unique words not found in embedding.
8 unique chars not found in embedding.
Number of OOV: 322
OOV word occurences: 564
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6402432     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,508,866
Trainable params: 6,508,866
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 3s 82ms/step - loss: 1.8576 - acc: 0.4228
Epoch 2/27

33/33 [==============================] - 1s 31ms/step - loss: 0.8921 - acc: 0.7921
Epoch 3/27

33/33 [==============================] - 1s 31ms/step - loss: 0.7670 - acc: 0.7970
Epoch 4/27

33/33 [==============================] - 1s 31ms/step - loss: 0.7461 - acc: 0.7933
Epoch 5/27

33/33 [==============================] - 1s 30ms/step - loss: 0.6584 - acc: 0.7936
Epoch 6/27

33/33 [==============================] - 1s 30ms/step - loss: 0.6063 - acc: 0.8013
Epoch 7/27

33/33 [==============================] - 1s 31ms/step - loss: 0.5635 - acc: 0.8086
Epoch 8/27

33/33 [==============================] - 1s 31ms/step - loss: 0.5240 - acc: 0.8548
Epoch 9/27

33/33 [==============================] - 1s 30ms/step - loss: 0.4651 - acc: 0.8515
Epoch 10/27

33/33 [==============================] - 1s 31ms/step - loss: 0.4232 - acc: 0.8691
Epoch 11/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3979 - acc: 0.8963
Epoch 12/27

33/33 [==============================] - 1s 31ms/step - loss: 0.4397 - acc: 0.8843
Epoch 13/27

33/33 [==============================] - 1s 32ms/step - loss: 0.3727 - acc: 0.9117
Epoch 14/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3382 - acc: 0.8981
Epoch 15/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3103 - acc: 0.9041
Epoch 16/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2919 - acc: 0.9202
Epoch 17/27

33/33 [==============================] - 1s 30ms/step - loss: 0.2922 - acc: 0.9122
Epoch 18/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2652 - acc: 0.9355
Epoch 19/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2480 - acc: 0.9389
Epoch 20/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2325 - acc: 0.9454
Epoch 21/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2192 - acc: 0.9450
Epoch 22/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2457 - acc: 0.9378
Epoch 23/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2070 - acc: 0.9584
Epoch 24/27

33/33 [==============================] - 1s 30ms/step - loss: 0.1979 - acc: 0.9527
Epoch 25/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1979 - acc: 0.9547
Epoch 26/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1844 - acc: 0.9573
Epoch 27/27

33/33 [==============================] - 1s 30ms/step - loss: 0.1705 - acc: 0.9525
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7351
False 1720
True percentage 0.810384742586
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.92      0.94      0.93      7318
      B-PER       0.73      0.40      0.52       438
      B-LOC       0.44      0.32      0.37       218
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-ORG       0.47      0.49      0.48       296
      I-ORG       0.18      0.28      0.22       151
      I-LOC       0.00      0.00      0.00       141
      I-PER       0.71      0.16      0.26       214

avg / total       0.82      0.81      0.81      9071

F-1 Score (without O):
0.337445573295
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 100050 unique words.
Found 94 unique chars.
Found 9 unique labels.
46 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 319
OOV word occurences: 620
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6403264     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,509,826
Trainable params: 6,509,826
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 3s 81ms/step - loss: 1.5268 - acc: 0.6513
Epoch 2/27

33/33 [==============================] - 1s 31ms/step - loss: 0.8880 - acc: 0.7863
Epoch 3/27

33/33 [==============================] - 1s 31ms/step - loss: 0.8040 - acc: 0.7830
Epoch 4/27

33/33 [==============================] - 1s 31ms/step - loss: 0.7032 - acc: 0.7923
Epoch 5/27

33/33 [==============================] - 1s 32ms/step - loss: 0.6780 - acc: 0.7874
Epoch 6/27

33/33 [==============================] - 1s 31ms/step - loss: 0.6409 - acc: 0.7905
Epoch 7/27

33/33 [==============================] - 1s 31ms/step - loss: 0.5932 - acc: 0.7962
Epoch 8/27

33/33 [==============================] - 1s 31ms/step - loss: 0.5326 - acc: 0.8063
Epoch 9/27

33/33 [==============================] - 1s 31ms/step - loss: 0.5384 - acc: 0.8564
Epoch 10/27

33/33 [==============================] - 1s 31ms/step - loss: 0.4502 - acc: 0.8475
Epoch 11/27

33/33 [==============================] - 1s 31ms/step - loss: 0.4238 - acc: 0.8651
Epoch 12/27

33/33 [==============================] - 1s 31ms/step - loss: 0.4001 - acc: 0.8783
Epoch 13/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3763 - acc: 0.8878
Epoch 14/27

33/33 [==============================] - 1s 30ms/step - loss: 0.3441 - acc: 0.9192
Epoch 15/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3183 - acc: 0.9150
Epoch 16/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3023 - acc: 0.8966
Epoch 17/27

33/33 [==============================] - 1s 30ms/step - loss: 0.2737 - acc: 0.9302
Epoch 18/27

33/33 [==============================] - 1s 30ms/step - loss: 0.2627 - acc: 0.9450
Epoch 19/27

33/33 [==============================] - 1s 30ms/step - loss: 0.2463 - acc: 0.9421
Epoch 20/27

33/33 [==============================] - 1s 30ms/step - loss: 0.2337 - acc: 0.9498
Epoch 21/27

33/33 [==============================] - 1s 30ms/step - loss: 0.2158 - acc: 0.9534
Epoch 22/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2103 - acc: 0.9676
Epoch 23/27

33/33 [==============================] - 1s 32ms/step - loss: 0.1841 - acc: 0.9615
Epoch 24/27

33/33 [==============================] - 1s 30ms/step - loss: 0.1892 - acc: 0.9616
Epoch 25/27

33/33 [==============================] - 1s 30ms/step - loss: 0.1906 - acc: 0.9540
Epoch 26/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1630 - acc: 0.9670
Epoch 27/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1487 - acc: 0.9705
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7296
False 1775
True percentage 0.804321464006
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.92      0.93      0.93      7318
      B-ORG       0.39      0.36      0.37       296
      I-ORG       0.31      0.22      0.26       151
      B-PER       0.64      0.45      0.53       438
      I-PER       0.54      0.23      0.33       214
      B-LOC       0.70      0.23      0.35       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.20      0.21      0.21       154

avg / total       0.82      0.80      0.81      9071

F-1 Score (without O):
0.337662337662
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 100046 unique words.
Found 93 unique chars.
Found 9 unique labels.
42 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 321
OOV word occurences: 563
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6403008     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,509,506
Trainable params: 6,509,506
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 3s 83ms/step - loss: 1.9275 - acc: 0.4378
Epoch 2/27

33/33 [==============================] - 1s 30ms/step - loss: 0.9462 - acc: 0.8026
Epoch 3/27

33/33 [==============================] - 1s 31ms/step - loss: 0.7752 - acc: 0.8040
Epoch 4/27

33/33 [==============================] - 1s 31ms/step - loss: 0.7346 - acc: 0.8034
Epoch 5/27

33/33 [==============================] - 1s 30ms/step - loss: 0.6821 - acc: 0.8056
Epoch 6/27

33/33 [==============================] - 1s 31ms/step - loss: 0.5820 - acc: 0.8044
Epoch 7/27

33/33 [==============================] - 1s 31ms/step - loss: 0.5497 - acc: 0.8090
Epoch 8/27

33/33 [==============================] - 1s 31ms/step - loss: 0.5046 - acc: 0.8263
Epoch 9/27

33/33 [==============================] - 1s 31ms/step - loss: 0.4832 - acc: 0.8435
Epoch 10/27

33/33 [==============================] - 1s 31ms/step - loss: 0.4318 - acc: 0.8501
Epoch 11/27

33/33 [==============================] - 1s 31ms/step - loss: 0.4063 - acc: 0.8786
Epoch 12/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3873 - acc: 0.8684
Epoch 13/27

33/33 [==============================] - 1s 30ms/step - loss: 0.3760 - acc: 0.8705
Epoch 14/27

33/33 [==============================] - 1s 30ms/step - loss: 0.3545 - acc: 0.8960
Epoch 15/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3276 - acc: 0.8969
Epoch 16/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3231 - acc: 0.9164
Epoch 17/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3140 - acc: 0.9022
Epoch 18/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2830 - acc: 0.9456
Epoch 19/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2777 - acc: 0.9320
Epoch 20/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2475 - acc: 0.9434
Epoch 21/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2540 - acc: 0.9293
Epoch 22/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2402 - acc: 0.9458
Epoch 23/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2292 - acc: 0.9574
Epoch 24/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2117 - acc: 0.9604
Epoch 25/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2000 - acc: 0.9681
Epoch 26/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1890 - acc: 0.9566
Epoch 27/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1748 - acc: 0.9668
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7411
False 1660
True percentage 0.81699922831
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.91      0.95      0.93      7318
      B-ORG       0.40      0.31      0.35       296
      I-ORG       0.32      0.23      0.27       151
      B-PER       0.77      0.45      0.57       438
      I-PER       0.87      0.31      0.46       214
     B-MISC       0.09      0.05      0.06       141
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.71      0.23      0.35       218
      I-LOC       0.41      0.08      0.13       141

avg / total       0.83      0.82      0.81      9071

F-1 Score (without O):
0.352714670774
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 100063 unique words.
Found 94 unique chars.
Found 9 unique labels.
59 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 320
OOV word occurences: 604
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6404096     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,510,658
Trainable params: 6,510,658
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 3s 81ms/step - loss: 1.8765 - acc: 0.4274
Epoch 2/27

33/33 [==============================] - 1s 31ms/step - loss: 0.9045 - acc: 0.7978
Epoch 3/27

33/33 [==============================] - 1s 31ms/step - loss: 0.8544 - acc: 0.7984
Epoch 4/27

33/33 [==============================] - 1s 30ms/step - loss: 0.7233 - acc: 0.7982
Epoch 5/27

33/33 [==============================] - 1s 31ms/step - loss: 0.6886 - acc: 0.7988
Epoch 6/27

33/33 [==============================] - 1s 31ms/step - loss: 0.6319 - acc: 0.8001
Epoch 7/27

33/33 [==============================] - 1s 31ms/step - loss: 0.6190 - acc: 0.8298
Epoch 8/27

33/33 [==============================] - 1s 31ms/step - loss: 0.5264 - acc: 0.8314
Epoch 9/27

33/33 [==============================] - 1s 31ms/step - loss: 0.5052 - acc: 0.8335
Epoch 10/27

33/33 [==============================] - 1s 31ms/step - loss: 0.4678 - acc: 0.8376
Epoch 11/27

33/33 [==============================] - 1s 31ms/step - loss: 0.4557 - acc: 0.8669
Epoch 12/27

33/33 [==============================] - 1s 30ms/step - loss: 0.4039 - acc: 0.8866
Epoch 13/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3873 - acc: 0.8718
Epoch 14/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3719 - acc: 0.8945
Epoch 15/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3802 - acc: 0.8821
Epoch 16/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3339 - acc: 0.8965
Epoch 17/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3239 - acc: 0.9072
Epoch 18/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2980 - acc: 0.9186
Epoch 19/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2993 - acc: 0.9091
Epoch 20/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2982 - acc: 0.9048
Epoch 21/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2852 - acc: 0.9114
Epoch 22/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2698 - acc: 0.9172
Epoch 23/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2451 - acc: 0.9317
Epoch 24/27

33/33 [==============================] - 1s 30ms/step - loss: 0.2351 - acc: 0.9384
Epoch 25/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2289 - acc: 0.9430
Epoch 26/27

33/33 [==============================] - 1s 30ms/step - loss: 0.2075 - acc: 0.9432
Epoch 27/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2039 - acc: 0.9439
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7339
False 1732
True percentage 0.809061845442
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.69      0.33      0.45       438
          O       0.91      0.95      0.93      7318
      B-LOC       0.00      0.00      0.00       218
      B-ORG       0.42      0.53      0.47       296
      I-PER       0.51      0.16      0.24       214
     B-MISC       0.15      0.02      0.04       141
     I-MISC       0.16      0.03      0.04       154
      I-ORG       0.30      0.22      0.25       151
      I-LOC       0.00      0.00      0.00       141

avg / total       0.80      0.81      0.80      9071

F-1 Score (without O):
0.851865008881
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 100036 unique words.
Found 93 unique chars.
Found 9 unique labels.
32 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 323
OOV word occurences: 623
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6402368     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,508,866
Trainable params: 6,508,866
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 3s 82ms/step - loss: 1.6871 - acc: 0.4410
Epoch 2/27

33/33 [==============================] - 1s 31ms/step - loss: 0.9617 - acc: 0.7783
Epoch 3/27

33/33 [==============================] - 1s 31ms/step - loss: 0.8132 - acc: 0.7817
Epoch 4/27

33/33 [==============================] - 1s 31ms/step - loss: 0.7696 - acc: 0.7785
Epoch 5/27

33/33 [==============================] - 1s 30ms/step - loss: 0.6904 - acc: 0.7779
Epoch 6/27

33/33 [==============================] - 1s 30ms/step - loss: 0.6326 - acc: 0.7864
Epoch 7/27

33/33 [==============================] - 1s 31ms/step - loss: 0.5782 - acc: 0.8000
Epoch 8/27

33/33 [==============================] - 1s 30ms/step - loss: 0.5415 - acc: 0.8215
Epoch 9/27

33/33 [==============================] - 1s 30ms/step - loss: 0.4867 - acc: 0.8242
Epoch 10/27

33/33 [==============================] - 1s 31ms/step - loss: 0.4588 - acc: 0.8378
Epoch 11/27

33/33 [==============================] - 1s 31ms/step - loss: 0.4306 - acc: 0.8407
Epoch 12/27

33/33 [==============================] - 1s 30ms/step - loss: 0.3921 - acc: 0.8675
Epoch 13/27

33/33 [==============================] - 1s 30ms/step - loss: 0.3910 - acc: 0.8819
Epoch 14/27

33/33 [==============================] - 1s 30ms/step - loss: 0.3430 - acc: 0.8824
Epoch 15/27

33/33 [==============================] - 1s 30ms/step - loss: 0.3261 - acc: 0.8921
Epoch 16/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3047 - acc: 0.8983
Epoch 17/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2841 - acc: 0.9115
Epoch 18/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2688 - acc: 0.9216
Epoch 19/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2478 - acc: 0.9400
Epoch 20/27

33/33 [==============================] - 1s 30ms/step - loss: 0.2444 - acc: 0.9603
Epoch 21/27

33/33 [==============================] - 1s 30ms/step - loss: 0.2254 - acc: 0.9533
Epoch 22/27

33/33 [==============================] - 1s 30ms/step - loss: 0.2095 - acc: 0.9737
Epoch 23/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1965 - acc: 0.9768
Epoch 24/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1889 - acc: 0.9699
Epoch 25/27

33/33 [==============================] - 1s 30ms/step - loss: 0.1801 - acc: 0.9600
Epoch 26/27

33/33 [==============================] - 1s 30ms/step - loss: 0.1649 - acc: 0.9701
Epoch 27/27

33/33 [==============================] - 1s 30ms/step - loss: 0.1571 - acc: 0.9689
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7357
False 1714
True percentage 0.811046191159
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.91      0.95      0.93      7318
     B-MISC       0.00      0.00      0.00       141
      B-ORG       0.38      0.49      0.43       296
     I-MISC       0.17      0.03      0.04       154
      B-LOC       0.76      0.29      0.42       218
      I-ORG       0.38      0.32      0.35       151
      B-PER       0.71      0.24      0.36       438
      I-PER       0.80      0.21      0.33       214
      I-LOC       0.00      0.00      0.00       141

avg / total       0.83      0.81      0.81      9071

F-1 Score (without O):
0.319099378882
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 100048 unique words.
Found 93 unique chars.
Found 9 unique labels.
44 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 320
OOV word occurences: 625
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6403136     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,509,634
Trainable params: 6,509,634
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 3s 82ms/step - loss: 1.8766 - acc: 0.4249
Epoch 2/27

33/33 [==============================] - 1s 30ms/step - loss: 0.9185 - acc: 0.8091
Epoch 3/27

33/33 [==============================] - 1s 30ms/step - loss: 0.7551 - acc: 0.8121
Epoch 4/27

33/33 [==============================] - 1s 31ms/step - loss: 0.7155 - acc: 0.8097
Epoch 5/27

33/33 [==============================] - 1s 32ms/step - loss: 0.7022 - acc: 0.8089
Epoch 6/27

33/33 [==============================] - 1s 31ms/step - loss: 0.5358 - acc: 0.8262
Epoch 7/27

33/33 [==============================] - 1s 31ms/step - loss: 0.5543 - acc: 0.8258
Epoch 8/27

33/33 [==============================] - 1s 30ms/step - loss: 0.4789 - acc: 0.8362
Epoch 9/27

33/33 [==============================] - 1s 31ms/step - loss: 0.4341 - acc: 0.8518
Epoch 10/27

33/33 [==============================] - 1s 31ms/step - loss: 0.4249 - acc: 0.8609
Epoch 11/27

33/33 [==============================] - 1s 31ms/step - loss: 0.5303 - acc: 0.8702
Epoch 12/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3777 - acc: 0.9104
Epoch 13/27

33/33 [==============================] - 1s 30ms/step - loss: 0.3480 - acc: 0.8819
Epoch 14/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3251 - acc: 0.8987
Epoch 15/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3107 - acc: 0.9037
Epoch 16/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2960 - acc: 0.9232
Epoch 17/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2864 - acc: 0.9284
Epoch 18/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2639 - acc: 0.9313
Epoch 19/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2393 - acc: 0.9468
Epoch 20/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2298 - acc: 0.9575
Epoch 21/27

33/33 [==============================] - 1s 30ms/step - loss: 0.2185 - acc: 0.9579
Epoch 22/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1996 - acc: 0.9731
Epoch 23/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1923 - acc: 0.9712
Epoch 24/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1674 - acc: 0.9722
Epoch 25/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1714 - acc: 0.9768
Epoch 26/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1613 - acc: 0.9734
Epoch 27/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1439 - acc: 0.9789
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7115
False 1956
True percentage 0.784367765406
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.49      0.17      0.25       296
          O       0.96      0.93      0.94      7318
     B-MISC       0.15      0.27      0.19       141
     I-MISC       0.13      0.73      0.23       154
      B-LOC       0.79      0.30      0.43       218
      I-LOC       0.62      0.06      0.10       141
      B-PER       0.91      0.12      0.21       438
      I-PER       0.55      0.08      0.15       214
      I-ORG       0.00      0.00      0.00       151

avg / total       0.88      0.78      0.80      9071

F-1 Score (without O):
0.825419075989
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 8
Found 100004 word vectors.
Found 84 char vectors.
Found 100048 unique words.
Found 94 unique chars.
Found 9 unique labels.
44 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 322
OOV word occurences: 545
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6403136     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,509,698
Trainable params: 6,509,698
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 3s 86ms/step - loss: 1.3970 - acc: 0.7676
Epoch 2/27

33/33 [==============================] - 1s 31ms/step - loss: 0.7792 - acc: 0.8155
Epoch 3/27

33/33 [==============================] - 1s 31ms/step - loss: 0.7371 - acc: 0.8126
Epoch 4/27

33/33 [==============================] - 1s 31ms/step - loss: 0.6253 - acc: 0.8165
Epoch 5/27

33/33 [==============================] - 1s 30ms/step - loss: 0.5712 - acc: 0.8190
Epoch 6/27

33/33 [==============================] - 1s 30ms/step - loss: 0.5655 - acc: 0.8454
Epoch 7/27

33/33 [==============================] - 1s 31ms/step - loss: 0.4725 - acc: 0.8249
Epoch 8/27

33/33 [==============================] - 1s 31ms/step - loss: 0.4479 - acc: 0.8617
Epoch 9/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3822 - acc: 0.8739
Epoch 10/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3611 - acc: 0.8869
Epoch 11/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3363 - acc: 0.8950
Epoch 12/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3108 - acc: 0.9147
Epoch 13/27

33/33 [==============================] - 1s 30ms/step - loss: 0.3296 - acc: 0.9129
Epoch 14/27

33/33 [==============================] - 1s 30ms/step - loss: 0.2542 - acc: 0.9272
Epoch 15/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2452 - acc: 0.9229
Epoch 16/27

33/33 [==============================] - 1s 30ms/step - loss: 0.2186 - acc: 0.9315
Epoch 17/27

33/33 [==============================] - 1s 30ms/step - loss: 0.2294 - acc: 0.9751
Epoch 18/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1992 - acc: 0.9794
Epoch 19/27

33/33 [==============================] - 1s 30ms/step - loss: 0.1842 - acc: 0.9665
Epoch 20/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1700 - acc: 0.9713
Epoch 21/27

33/33 [==============================] - 1s 30ms/step - loss: 0.1656 - acc: 0.9767
Epoch 22/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1452 - acc: 0.9799
Epoch 23/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1389 - acc: 0.9850
Epoch 24/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1381 - acc: 0.9774
Epoch 25/27

33/33 [==============================] - 1s 30ms/step - loss: 0.1156 - acc: 0.9851
Epoch 26/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1148 - acc: 0.9813
Epoch 27/27

33/33 [==============================] - 1s 30ms/step - loss: 0.1079 - acc: 0.9839
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7477
False 1594
True percentage 0.824275162606
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.46      0.55      0.50       296
          O       0.92      0.95      0.93      7318
      B-LOC       0.78      0.21      0.33       218
      I-LOC       0.57      0.48      0.52       141
      I-ORG       0.24      0.19      0.21       151
      B-PER       0.77      0.41      0.53       438
      I-PER       0.54      0.26      0.35       214
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.84      0.82      0.82      9071

F-1 Score (without O):
0.863381528474
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 9
Found 100004 word vectors.
Found 84 char vectors.
Found 100054 unique words.
Found 94 unique chars.
Found 9 unique labels.
50 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 320
OOV word occurences: 619
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6403520     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,510,082
Trainable params: 6,510,082
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 3s 81ms/step - loss: 1.8891 - acc: 0.4050
Epoch 2/27

33/33 [==============================] - 1s 31ms/step - loss: 0.9224 - acc: 0.7922
Epoch 3/27

33/33 [==============================] - 1s 29ms/step - loss: 0.7662 - acc: 0.7939
Epoch 4/27

33/33 [==============================] - 1s 31ms/step - loss: 0.7014 - acc: 0.7934
Epoch 5/27

33/33 [==============================] - 1s 31ms/step - loss: 0.6574 - acc: 0.8006
Epoch 6/27

33/33 [==============================] - 1s 30ms/step - loss: 0.5707 - acc: 0.7999
Epoch 7/27

33/33 [==============================] - 1s 31ms/step - loss: 0.5174 - acc: 0.8289
Epoch 8/27

33/33 [==============================] - 1s 30ms/step - loss: 0.5505 - acc: 0.8263
Epoch 9/27

33/33 [==============================] - 1s 30ms/step - loss: 0.4660 - acc: 0.8569
Epoch 10/27

33/33 [==============================] - 1s 30ms/step - loss: 0.4266 - acc: 0.8607
Epoch 11/27

33/33 [==============================] - 1s 31ms/step - loss: 0.4114 - acc: 0.8631
Epoch 12/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3707 - acc: 0.8788
Epoch 13/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3449 - acc: 0.8940
Epoch 14/27

33/33 [==============================] - 1s 30ms/step - loss: 0.3268 - acc: 0.8969
Epoch 15/27

33/33 [==============================] - 1s 30ms/step - loss: 0.3120 - acc: 0.9009
Epoch 16/27

33/33 [==============================] - 1s 30ms/step - loss: 0.3345 - acc: 0.8898
Epoch 17/27

33/33 [==============================] - 1s 30ms/step - loss: 0.2720 - acc: 0.9243
Epoch 18/27

33/33 [==============================] - 1s 30ms/step - loss: 0.2804 - acc: 0.9382
Epoch 19/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2502 - acc: 0.9317
Epoch 20/27

33/33 [==============================] - 1s 30ms/step - loss: 0.2348 - acc: 0.9522
Epoch 21/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2200 - acc: 0.9561
Epoch 22/27

33/33 [==============================] - 1s 29ms/step - loss: 0.2031 - acc: 0.9522
Epoch 23/27

33/33 [==============================] - 1s 30ms/step - loss: 0.1850 - acc: 0.9507
Epoch 24/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1784 - acc: 0.9606
Epoch 25/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1553 - acc: 0.9728
Epoch 26/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1638 - acc: 0.9625
Epoch 27/27

33/33 [==============================] - 1s 30ms/step - loss: 0.1465 - acc: 0.9724
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7417
False 1654
True percentage 0.817660676882
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.92      0.95      0.93      7318
      B-LOC       0.65      0.56      0.60       218
      I-LOC       0.63      0.48      0.55       141
      B-ORG       0.59      0.27      0.37       296
      B-PER       0.60      0.30      0.40       438
      I-PER       0.67      0.15      0.25       214
      I-ORG       0.40      0.16      0.23       151
     B-MISC       0.14      0.10      0.12       141
     I-MISC       0.38      0.14      0.21       154

avg / total       0.85      0.82      0.82      9071

F-1 Score (without O):
0.3696221474
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 10
Found 100004 word vectors.
Found 84 char vectors.
Found 100049 unique words.
Found 94 unique chars.
Found 9 unique labels.
45 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 324
OOV word occurences: 634
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6403200     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,509,762
Trainable params: 6,509,762
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 3s 81ms/step - loss: 1.7214 - acc: 0.4256
Epoch 2/27

33/33 [==============================] - 1s 31ms/step - loss: 0.8024 - acc: 0.8043
Epoch 3/27

33/33 [==============================] - 1s 32ms/step - loss: 0.7312 - acc: 0.8035
Epoch 4/27

33/33 [==============================] - 1s 31ms/step - loss: 0.7331 - acc: 0.7989
Epoch 5/27

33/33 [==============================] - 1s 31ms/step - loss: 0.6376 - acc: 0.8077
Epoch 6/27

33/33 [==============================] - 1s 31ms/step - loss: 0.5585 - acc: 0.8152
Epoch 7/27

33/33 [==============================] - 1s 32ms/step - loss: 0.5030 - acc: 0.8351
Epoch 8/27

33/33 [==============================] - 1s 32ms/step - loss: 0.4659 - acc: 0.8468
Epoch 9/27

33/33 [==============================] - 1s 32ms/step - loss: 0.4155 - acc: 0.8600
Epoch 10/27

33/33 [==============================] - 1s 32ms/step - loss: 0.4068 - acc: 0.8742
Epoch 11/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3747 - acc: 0.8825
Epoch 12/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3431 - acc: 0.8966
Epoch 13/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3490 - acc: 0.8871
Epoch 14/27

33/33 [==============================] - 1s 30ms/step - loss: 0.3132 - acc: 0.9063
Epoch 15/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2929 - acc: 0.9247
Epoch 16/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2743 - acc: 0.9254
Epoch 17/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2795 - acc: 0.9212
Epoch 18/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2411 - acc: 0.9297
Epoch 19/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2604 - acc: 0.9241
Epoch 20/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2201 - acc: 0.9383
Epoch 21/27

33/33 [==============================] - 1s 30ms/step - loss: 0.2021 - acc: 0.9444
Epoch 22/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2143 - acc: 0.9287
Epoch 23/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2189 - acc: 0.9311
Epoch 24/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1950 - acc: 0.9320
Epoch 25/27

33/33 [==============================] - 1s 30ms/step - loss: 0.1789 - acc: 0.9446
Epoch 26/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1901 - acc: 0.9487
Epoch 27/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1595 - acc: 0.9588
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7299
False 1772
True percentage 0.804652188292
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.94      0.94      7318
      B-ORG       0.38      0.43      0.40       296
      I-ORG       0.18      0.28      0.22       151
      B-LOC       0.56      0.42      0.48       218
      B-PER       0.64      0.26      0.37       438
      I-PER       0.34      0.16      0.22       214
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.32      0.05      0.08       154
      I-LOC       0.00      0.00      0.00       141

avg / total       0.82      0.80      0.81      9071

F-1 Score (without O):
0.298678099321
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 11
Found 100004 word vectors.
Found 84 char vectors.
Found 100049 unique words.
Found 94 unique chars.
Found 9 unique labels.
45 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 324
OOV word occurences: 633
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6403200     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,509,762
Trainable params: 6,509,762
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 3s 82ms/step - loss: 1.8696 - acc: 0.4084
Epoch 2/27

33/33 [==============================] - 1s 32ms/step - loss: 1.0789 - acc: 0.7472
Epoch 3/27

33/33 [==============================] - 1s 31ms/step - loss: 0.9145 - acc: 0.7475
Epoch 4/27

33/33 [==============================] - 1s 31ms/step - loss: 0.8138 - acc: 0.7478
Epoch 5/27

33/33 [==============================] - 1s 31ms/step - loss: 0.7576 - acc: 0.7570
Epoch 6/27

33/33 [==============================] - 1s 31ms/step - loss: 0.6800 - acc: 0.7670
Epoch 7/27

33/33 [==============================] - 1s 32ms/step - loss: 0.6192 - acc: 0.7882
Epoch 8/27

33/33 [==============================] - 1s 31ms/step - loss: 0.5598 - acc: 0.8181
Epoch 9/27

33/33 [==============================] - 1s 31ms/step - loss: 0.5224 - acc: 0.8447
Epoch 10/27

33/33 [==============================] - 1s 31ms/step - loss: 0.4765 - acc: 0.8601
Epoch 11/27

33/33 [==============================] - 1s 31ms/step - loss: 0.4763 - acc: 0.8509
Epoch 12/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3974 - acc: 0.8891
Epoch 13/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3756 - acc: 0.8831
Epoch 14/27

33/33 [==============================] - 1s 32ms/step - loss: 0.3655 - acc: 0.8909
Epoch 15/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3355 - acc: 0.9017
Epoch 16/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3129 - acc: 0.8956
Epoch 17/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2791 - acc: 0.9124
Epoch 18/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2623 - acc: 0.9330
Epoch 19/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2410 - acc: 0.9453
Epoch 20/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2413 - acc: 0.9626
Epoch 21/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2189 - acc: 0.9652
Epoch 22/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2125 - acc: 0.9458
Epoch 23/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1943 - acc: 0.9591
Epoch 24/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1888 - acc: 0.9696
Epoch 25/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1727 - acc: 0.9759
Epoch 26/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1619 - acc: 0.9680
Epoch 27/27

33/33 [==============================] - 1s 32ms/step - loss: 0.1616 - acc: 0.9735
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7335
False 1736
True percentage 0.808620879727
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.92      0.94      0.93      7318
      B-ORG       0.42      0.42      0.42       296
      I-ORG       0.23      0.37      0.29       151
     B-MISC       0.08      0.02      0.03       141
      B-LOC       0.78      0.28      0.42       218
      B-PER       0.62      0.38      0.47       438
     I-MISC       0.00      0.00      0.00       154
      I-PER       0.58      0.07      0.12       214
      I-LOC       0.67      0.03      0.05       141

avg / total       0.84      0.81      0.81      9071

F-1 Score (without O):
0.318701586131
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 100043 unique words.
Found 94 unique chars.
Found 9 unique labels.
39 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 320
OOV word occurences: 626
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6402816     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,509,378
Trainable params: 6,509,378
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 3s 83ms/step - loss: 1.4415 - acc: 0.7453
Epoch 2/27

33/33 [==============================] - 1s 31ms/step - loss: 0.7373 - acc: 0.8323
Epoch 3/27

33/33 [==============================] - 1s 32ms/step - loss: 0.6645 - acc: 0.8337
Epoch 4/27

33/33 [==============================] - 1s 32ms/step - loss: 0.6174 - acc: 0.8338
Epoch 5/27

33/33 [==============================] - 1s 31ms/step - loss: 0.5474 - acc: 0.8313
Epoch 6/27

33/33 [==============================] - 1s 32ms/step - loss: 0.5106 - acc: 0.8425
Epoch 7/27

33/33 [==============================] - 1s 32ms/step - loss: 0.4314 - acc: 0.8472
Epoch 8/27

33/33 [==============================] - 1s 31ms/step - loss: 0.4046 - acc: 0.8681
Epoch 9/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3676 - acc: 0.8865
Epoch 10/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3353 - acc: 0.8936
Epoch 11/27

33/33 [==============================] - 1s 31ms/step - loss: 0.4388 - acc: 0.8899
Epoch 12/27

33/33 [==============================] - 1s 31ms/step - loss: 0.3041 - acc: 0.9173
Epoch 13/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2978 - acc: 0.8936
Epoch 14/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2710 - acc: 0.9113
Epoch 15/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2589 - acc: 0.9225
Epoch 16/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2510 - acc: 0.9378
Epoch 17/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2319 - acc: 0.9519
Epoch 18/27

33/33 [==============================] - 1s 32ms/step - loss: 0.2174 - acc: 0.9309
Epoch 19/27

33/33 [==============================] - 1s 32ms/step - loss: 0.1961 - acc: 0.9538
Epoch 20/27

33/33 [==============================] - 1s 31ms/step - loss: 0.2002 - acc: 0.9496
Epoch 21/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1912 - acc: 0.9550
Epoch 22/27

33/33 [==============================] - 1s 32ms/step - loss: 0.1834 - acc: 0.9551
Epoch 23/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1766 - acc: 0.9557
Epoch 24/27

33/33 [==============================] - 1s 32ms/step - loss: 0.1687 - acc: 0.9586
Epoch 25/27

33/33 [==============================] - 1s 32ms/step - loss: 0.1540 - acc: 0.9688
Epoch 26/27

33/33 [==============================] - 1s 31ms/step - loss: 0.1510 - acc: 0.9715
Epoch 27/27

33/33 [==============================] - 1s 32ms/step - loss: 0.1415 - acc: 0.9728
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7245
False 1826
True percentage 0.798699151141
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.89      0.95      0.92      7318
      B-PER       0.61      0.27      0.37       438
      B-ORG       0.40      0.38      0.39       296
     B-MISC       0.11      0.01      0.01       141
      I-PER       0.63      0.14      0.22       214
      I-ORG       0.22      0.16      0.18       151
     I-MISC       0.07      0.01      0.02       154
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141

avg / total       0.79      0.80      0.78      9071

F-1 Score (without O):
0.236559139785
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100022 unique words.
Found 92 unique chars.
Found 8 unique labels.
18 unique words not found in embedding.
8 unique chars not found in embedding.
Number of OOV: 324
OOV word occurences: 632
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401472     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,756
Trainable params: 6,507,756
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 2s 132ms/step - loss: 2.0474 - acc: 0.1917
Epoch 2/27

16/16 [==============================] - 0s 27ms/step - loss: 0.9925 - acc: 0.8466
Epoch 3/27

16/16 [==============================] - 0s 28ms/step - loss: 0.7300 - acc: 0.8466
Epoch 4/27

16/16 [==============================] - 0s 28ms/step - loss: 0.6752 - acc: 0.8466
Epoch 5/27

16/16 [==============================] - 0s 27ms/step - loss: 0.6207 - acc: 0.8466
Epoch 6/27

16/16 [==============================] - 0s 28ms/step - loss: 0.5948 - acc: 0.8466
Epoch 7/27

16/16 [==============================] - 0s 28ms/step - loss: 0.5529 - acc: 0.8466
Epoch 8/27

16/16 [==============================] - 0s 28ms/step - loss: 0.5251 - acc: 0.8466
Epoch 9/27

16/16 [==============================] - 0s 27ms/step - loss: 0.4989 - acc: 0.8466
Epoch 10/27

16/16 [==============================] - 0s 28ms/step - loss: 0.4648 - acc: 0.8466
Epoch 11/27

16/16 [==============================] - 0s 27ms/step - loss: 0.4307 - acc: 0.8466
Epoch 12/27

16/16 [==============================] - 0s 27ms/step - loss: 0.4006 - acc: 0.8555
Epoch 13/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3717 - acc: 0.8525
Epoch 14/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3456 - acc: 0.8673
Epoch 15/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3194 - acc: 0.8879
Epoch 16/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2934 - acc: 0.8879
Epoch 17/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2781 - acc: 0.9086
Epoch 18/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2564 - acc: 0.9115
Epoch 19/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2394 - acc: 0.9381
Epoch 20/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2237 - acc: 0.9204
Epoch 21/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2077 - acc: 0.9617
Epoch 22/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1858 - acc: 0.9587
Epoch 23/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1759 - acc: 0.9499
Epoch 24/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1617 - acc: 0.9853
Epoch 25/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1436 - acc: 0.9823
Epoch 26/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1306 - acc: 0.9941
Epoch 27/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1266 - acc: 0.9794
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7111
False 1746
True percentage 0.80286778819
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.89      0.95      0.92      7318
      B-LOC       0.58      0.08      0.14       218
      I-LOC       0.75      0.04      0.08       141
      B-PER       0.84      0.06      0.11       438
      B-ORG       0.23      0.43      0.30       296
      I-ORG       0.29      0.10      0.15       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.82      0.80      0.78      8857

F-1 Score (without O):
0.174898051654
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 100025 unique words.
Found 92 unique chars.
Found 9 unique labels.
21 unique words not found in embedding.
8 unique chars not found in embedding.
Number of OOV: 327
OOV word occurences: 640
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401664     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,508,098
Trainable params: 6,508,098
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 2s 133ms/step - loss: 2.2162 - acc: 0.1258
Epoch 2/27

16/16 [==============================] - 0s 28ms/step - loss: 1.2537 - acc: 0.7642
Epoch 3/27

16/16 [==============================] - 0s 29ms/step - loss: 1.0464 - acc: 0.7642
Epoch 4/27

16/16 [==============================] - 0s 29ms/step - loss: 0.9936 - acc: 0.7642
Epoch 5/27

16/16 [==============================] - 0s 28ms/step - loss: 0.8788 - acc: 0.7642
Epoch 6/27

16/16 [==============================] - 0s 28ms/step - loss: 0.8184 - acc: 0.7642
Epoch 7/27

16/16 [==============================] - 0s 29ms/step - loss: 0.7868 - acc: 0.7642
Epoch 8/27

16/16 [==============================] - 0s 29ms/step - loss: 0.7675 - acc: 0.7642
Epoch 9/27

16/16 [==============================] - 0s 27ms/step - loss: 0.7186 - acc: 0.7642
Epoch 10/27

16/16 [==============================] - 0s 28ms/step - loss: 0.6738 - acc: 0.7642
Epoch 11/27

16/16 [==============================] - 0s 28ms/step - loss: 0.6270 - acc: 0.7830
Epoch 12/27

16/16 [==============================] - 0s 28ms/step - loss: 0.6056 - acc: 0.7799
Epoch 13/27

16/16 [==============================] - 0s 29ms/step - loss: 0.5579 - acc: 0.8113
Epoch 14/27

16/16 [==============================] - 0s 29ms/step - loss: 0.5246 - acc: 0.7987
Epoch 15/27

16/16 [==============================] - 0s 29ms/step - loss: 0.4839 - acc: 0.8459
Epoch 16/27

16/16 [==============================] - 0s 29ms/step - loss: 0.4497 - acc: 0.8459
Epoch 17/27

16/16 [==============================] - 0s 28ms/step - loss: 0.4180 - acc: 0.8774
Epoch 18/27

16/16 [==============================] - 0s 29ms/step - loss: 0.3937 - acc: 0.8742
Epoch 19/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3776 - acc: 0.9340
Epoch 20/27

16/16 [==============================] - 0s 29ms/step - loss: 0.3579 - acc: 0.8805
Epoch 21/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3530 - acc: 0.9497
Epoch 22/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3126 - acc: 0.9182
Epoch 23/27

16/16 [==============================] - 0s 29ms/step - loss: 0.2903 - acc: 0.9434
Epoch 24/27

16/16 [==============================] - 0s 29ms/step - loss: 0.2635 - acc: 0.9465
Epoch 25/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2478 - acc: 0.9434
Epoch 26/27

16/16 [==============================] - 0s 29ms/step - loss: 0.2382 - acc: 0.9623
Epoch 27/27

16/16 [==============================] - 0s 29ms/step - loss: 0.2096 - acc: 0.9686
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7193
False 1878
True percentage 0.792966596847
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.61      0.27      0.37       438
      I-PER       0.48      0.05      0.09       214
          O       0.88      0.95      0.91      7318
      B-ORG       0.39      0.19      0.26       296
      I-ORG       0.63      0.15      0.24       151
      B-LOC       0.44      0.22      0.29       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.78      0.79      0.77      9071

F-1 Score (without O):
0.838767042087
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100018 unique words.
Found 91 unique chars.
Found 9 unique labels.
14 unique words not found in embedding.
7 unique chars not found in embedding.
Number of OOV: 326
OOV word occurences: 638
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5888        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401216     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,586
Trainable params: 6,507,586
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 2s 131ms/step - loss: 2.3693 - acc: 0.0310
Epoch 2/27

16/16 [==============================] - 0s 27ms/step - loss: 1.3702 - acc: 0.7802
Epoch 3/27

16/16 [==============================] - 0s 28ms/step - loss: 0.9916 - acc: 0.7802
Epoch 4/27

16/16 [==============================] - 0s 28ms/step - loss: 0.9660 - acc: 0.7802
Epoch 5/27

16/16 [==============================] - 0s 28ms/step - loss: 0.8262 - acc: 0.7802
Epoch 6/27

16/16 [==============================] - 0s 29ms/step - loss: 0.7785 - acc: 0.7802
Epoch 7/27

16/16 [==============================] - 0s 29ms/step - loss: 0.7249 - acc: 0.7802
Epoch 8/27

16/16 [==============================] - 0s 27ms/step - loss: 0.6786 - acc: 0.7802
Epoch 9/27

16/16 [==============================] - 0s 27ms/step - loss: 0.6347 - acc: 0.7802
Epoch 10/27

16/16 [==============================] - 0s 29ms/step - loss: 0.6074 - acc: 0.7957
Epoch 11/27

16/16 [==============================] - 0s 28ms/step - loss: 0.5604 - acc: 0.8080
Epoch 12/27

16/16 [==============================] - 0s 27ms/step - loss: 0.5200 - acc: 0.8483
Epoch 13/27

16/16 [==============================] - 0s 27ms/step - loss: 0.4807 - acc: 0.8576
Epoch 14/27

16/16 [==============================] - 0s 29ms/step - loss: 0.4612 - acc: 0.8483
Epoch 15/27

16/16 [==============================] - 0s 28ms/step - loss: 0.4869 - acc: 0.9102
Epoch 16/27

16/16 [==============================] - 0s 28ms/step - loss: 0.4851 - acc: 0.8328
Epoch 17/27

16/16 [==============================] - 0s 28ms/step - loss: 0.4269 - acc: 0.9226
Epoch 18/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3633 - acc: 0.8885
Epoch 19/27

16/16 [==============================] - 0s 29ms/step - loss: 0.3296 - acc: 0.9164
Epoch 20/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3143 - acc: 0.9195
Epoch 21/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3024 - acc: 0.9102
Epoch 22/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2710 - acc: 0.9443
Epoch 23/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2588 - acc: 0.9350
Epoch 24/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2353 - acc: 0.9381
Epoch 25/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2391 - acc: 0.9381
Epoch 26/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2109 - acc: 0.9412
Epoch 27/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2088 - acc: 0.9474
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7161
False 1910
True percentage 0.789438871128
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.89      0.94      0.92      7318
      B-PER       0.53      0.21      0.30       438
      B-LOC       0.74      0.13      0.23       218
     B-MISC       0.17      0.01      0.01       141
     I-MISC       0.00      0.00      0.00       154
      B-ORG       0.36      0.38      0.37       296
      I-ORG       0.19      0.17      0.18       151
      I-LOC       0.00      0.00      0.00       141
      I-PER       0.00      0.00      0.00       214

avg / total       0.78      0.79      0.77      9071

F-1 Score (without O):
0.213784564589
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 100030 unique words.
Found 93 unique chars.
Found 9 unique labels.
26 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 324
OOV word occurences: 628
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401984     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,508,482
Trainable params: 6,508,482
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 2s 133ms/step - loss: 2.4402 - acc: 0.0265
Epoch 2/27

16/16 [==============================] - 0s 27ms/step - loss: 1.5269 - acc: 0.7692
Epoch 3/27

16/16 [==============================] - 0s 28ms/step - loss: 0.9861 - acc: 0.7692
Epoch 4/27

16/16 [==============================] - 0s 28ms/step - loss: 0.8799 - acc: 0.7692
Epoch 5/27

16/16 [==============================] - 0s 28ms/step - loss: 0.8862 - acc: 0.7692
Epoch 6/27

16/16 [==============================] - 0s 28ms/step - loss: 0.9636 - acc: 0.7878
Epoch 7/27

16/16 [==============================] - 0s 28ms/step - loss: 0.7349 - acc: 0.7692
Epoch 8/27

16/16 [==============================] - 0s 29ms/step - loss: 0.6864 - acc: 0.7798
Epoch 9/27

16/16 [==============================] - 0s 28ms/step - loss: 0.6471 - acc: 0.7745
Epoch 10/27

16/16 [==============================] - 0s 28ms/step - loss: 0.5986 - acc: 0.7825
Epoch 11/27

16/16 [==============================] - 0s 28ms/step - loss: 0.5610 - acc: 0.7798
Epoch 12/27

16/16 [==============================] - 0s 28ms/step - loss: 0.5255 - acc: 0.7984
Epoch 13/27

16/16 [==============================] - 0s 28ms/step - loss: 0.4757 - acc: 0.8276
Epoch 14/27

16/16 [==============================] - 0s 27ms/step - loss: 0.4575 - acc: 0.8382
Epoch 15/27

16/16 [==============================] - 0s 27ms/step - loss: 0.4173 - acc: 0.8568
Epoch 16/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3959 - acc: 0.8833
Epoch 17/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3666 - acc: 0.8939
Epoch 18/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3210 - acc: 0.9416
Epoch 19/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3128 - acc: 0.9125
Epoch 20/27

16/16 [==============================] - 0s 29ms/step - loss: 0.2799 - acc: 0.9708
Epoch 21/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2715 - acc: 0.9284
Epoch 22/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2523 - acc: 0.9655
Epoch 23/27

16/16 [==============================] - 0s 29ms/step - loss: 0.2321 - acc: 0.9549
Epoch 24/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1985 - acc: 0.9708
Epoch 25/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1754 - acc: 0.9735
Epoch 26/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1693 - acc: 0.9761
Epoch 27/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1591 - acc: 0.9814
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7158
False 1913
True percentage 0.789108146842
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.87      0.95      0.91      7318
      B-ORG       0.44      0.32      0.37       296
      I-ORG       0.25      0.10      0.14       151
      B-PER       0.76      0.08      0.14       438
      I-PER       0.38      0.08      0.13       214
      B-LOC       0.76      0.19      0.31       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.12      0.06      0.08       154

avg / total       0.79      0.79      0.77      9071

F-1 Score (without O):
0.188662533215
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 100028 unique words.
Found 93 unique chars.
Found 9 unique labels.
24 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 326
OOV word occurences: 637
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401856     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,508,354
Trainable params: 6,508,354
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 2s 131ms/step - loss: 2.6446 - acc: 0.0134
Epoch 2/27

16/16 [==============================] - 0s 28ms/step - loss: 1.5929 - acc: 0.7614
Epoch 3/27

16/16 [==============================] - 0s 27ms/step - loss: 1.0168 - acc: 0.7748
Epoch 4/27

16/16 [==============================] - 0s 27ms/step - loss: 0.9886 - acc: 0.7748
Epoch 5/27

16/16 [==============================] - 0s 29ms/step - loss: 0.9230 - acc: 0.7748
Epoch 6/27

16/16 [==============================] - 0s 28ms/step - loss: 0.8771 - acc: 0.7748
Epoch 7/27

16/16 [==============================] - 0s 29ms/step - loss: 0.7918 - acc: 0.7748
Epoch 8/27

16/16 [==============================] - 0s 28ms/step - loss: 0.7486 - acc: 0.7748
Epoch 9/27

16/16 [==============================] - 0s 28ms/step - loss: 0.6973 - acc: 0.7748
Epoch 10/27

16/16 [==============================] - 0s 30ms/step - loss: 0.6716 - acc: 0.7775
Epoch 11/27

16/16 [==============================] - 0s 29ms/step - loss: 0.6149 - acc: 0.7775
Epoch 12/27

16/16 [==============================] - 0s 29ms/step - loss: 0.5627 - acc: 0.7855
Epoch 13/27

16/16 [==============================] - 0s 29ms/step - loss: 0.5276 - acc: 0.8231
Epoch 14/27

16/16 [==============================] - 0s 27ms/step - loss: 0.4864 - acc: 0.8257
Epoch 15/27

16/16 [==============================] - 0s 29ms/step - loss: 0.4534 - acc: 0.8686
Epoch 16/27

16/16 [==============================] - 0s 28ms/step - loss: 0.4533 - acc: 0.8365
Epoch 17/27

16/16 [==============================] - 0s 28ms/step - loss: 0.5439 - acc: 0.9249
Epoch 18/27

16/16 [==============================] - 0s 28ms/step - loss: 0.4056 - acc: 0.8713
Epoch 19/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3652 - acc: 0.8981
Epoch 20/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3409 - acc: 0.9115
Epoch 21/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3202 - acc: 0.9196
Epoch 22/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2997 - acc: 0.9169
Epoch 23/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2833 - acc: 0.9276
Epoch 24/27

16/16 [==============================] - 0s 29ms/step - loss: 0.2727 - acc: 0.9303
Epoch 25/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2480 - acc: 0.9410
Epoch 26/27

16/16 [==============================] - 0s 29ms/step - loss: 0.2352 - acc: 0.9571
Epoch 27/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2274 - acc: 0.9598
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7190
False 1881
True percentage 0.792635872561
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.89      0.95      0.92      7318
      B-ORG       0.34      0.30      0.32       296
      I-ORG       0.10      0.01      0.01       151
      B-PER       0.53      0.24      0.33       438
      I-PER       0.70      0.07      0.12       214
     B-MISC       0.12      0.05      0.07       141
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.38      0.02      0.04       218
      I-LOC       1.00      0.08      0.14       141

avg / total       0.80      0.79      0.77      9071

F-1 Score (without O):
0.201030927835
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 100034 unique words.
Found 93 unique chars.
Found 9 unique labels.
30 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 323
OOV word occurences: 621
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6402240     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,508,738
Trainable params: 6,508,738
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 2s 133ms/step - loss: 2.4091 - acc: 0.0404
Epoch 2/27

16/16 [==============================] - 0s 28ms/step - loss: 1.3124 - acc: 0.7978
Epoch 3/27

16/16 [==============================] - 0s 28ms/step - loss: 0.9095 - acc: 0.8005
Epoch 4/27

16/16 [==============================] - 0s 28ms/step - loss: 0.8699 - acc: 0.8005
Epoch 5/27

16/16 [==============================] - 0s 29ms/step - loss: 0.7634 - acc: 0.8005
Epoch 6/27

16/16 [==============================] - 0s 28ms/step - loss: 0.7265 - acc: 0.8005
Epoch 7/27

16/16 [==============================] - 0s 28ms/step - loss: 0.7017 - acc: 0.8005
Epoch 8/27

16/16 [==============================] - 0s 28ms/step - loss: 0.6644 - acc: 0.8005
Epoch 9/27

16/16 [==============================] - 0s 28ms/step - loss: 0.6287 - acc: 0.8005
Epoch 10/27

16/16 [==============================] - 0s 27ms/step - loss: 0.5833 - acc: 0.8032
Epoch 11/27

16/16 [==============================] - 0s 28ms/step - loss: 0.5541 - acc: 0.8005
Epoch 12/27

16/16 [==============================] - 0s 29ms/step - loss: 0.5237 - acc: 0.8275
Epoch 13/27

16/16 [==============================] - 0s 29ms/step - loss: 0.4929 - acc: 0.8248
Epoch 14/27

16/16 [==============================] - 0s 29ms/step - loss: 0.4576 - acc: 0.8544
Epoch 15/27

16/16 [==============================] - 0s 29ms/step - loss: 0.4313 - acc: 0.8275
Epoch 16/27

16/16 [==============================] - 0s 28ms/step - loss: 0.4091 - acc: 0.8787
Epoch 17/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3775 - acc: 0.8679
Epoch 18/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3634 - acc: 0.9137
Epoch 19/27

16/16 [==============================] - 0s 29ms/step - loss: 0.3502 - acc: 0.8706
Epoch 20/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3704 - acc: 0.9326
Epoch 21/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3057 - acc: 0.9003
Epoch 22/27

16/16 [==============================] - 0s 29ms/step - loss: 0.2835 - acc: 0.9245
Epoch 23/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2652 - acc: 0.9353
Epoch 24/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2526 - acc: 0.9380
Epoch 25/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2357 - acc: 0.9407
Epoch 26/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2222 - acc: 0.9623
Epoch 27/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2068 - acc: 0.9596
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7137
False 1934
True percentage 0.786793076838
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.46      0.22      0.30       438
          O       0.88      0.96      0.92      7318
      B-LOC       0.62      0.02      0.04       218
      B-ORG       0.29      0.09      0.14       296
      I-PER       0.38      0.02      0.04       214
     B-MISC       0.07      0.09      0.08       141
     I-MISC       0.00      0.00      0.00       154
      I-ORG       0.04      0.01      0.01       151
      I-LOC       0.00      0.00      0.00       141

avg / total       0.77      0.79      0.76      9071

F-1 Score (without O):
0.834568193942
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 100021 unique words.
Found 92 unique chars.
Found 9 unique labels.
17 unique words not found in embedding.
8 unique chars not found in embedding.
Number of OOV: 325
OOV word occurences: 636
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401408     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,842
Trainable params: 6,507,842
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 2s 133ms/step - loss: 2.4073 - acc: 0.0246
Epoch 2/27

16/16 [==============================] - 0s 28ms/step - loss: 1.4972 - acc: 0.7430
Epoch 3/27

16/16 [==============================] - 0s 28ms/step - loss: 1.0169 - acc: 0.7430
Epoch 4/27

16/16 [==============================] - 0s 29ms/step - loss: 0.9284 - acc: 0.7430
Epoch 5/27

16/16 [==============================] - 0s 28ms/step - loss: 0.8575 - acc: 0.7430
Epoch 6/27

16/16 [==============================] - 0s 28ms/step - loss: 0.8553 - acc: 0.7430
Epoch 7/27

16/16 [==============================] - 0s 27ms/step - loss: 0.8979 - acc: 0.7958
Epoch 8/27

16/16 [==============================] - 0s 27ms/step - loss: 0.7167 - acc: 0.7430
Epoch 9/27

16/16 [==============================] - 0s 28ms/step - loss: 0.6612 - acc: 0.7817
Epoch 10/27

16/16 [==============================] - 0s 28ms/step - loss: 0.6044 - acc: 0.7852
Epoch 11/27

16/16 [==============================] - 0s 28ms/step - loss: 0.5585 - acc: 0.7887
Epoch 12/27

16/16 [==============================] - 0s 27ms/step - loss: 0.5219 - acc: 0.8028
Epoch 13/27

16/16 [==============================] - 0s 27ms/step - loss: 0.4743 - acc: 0.7958
Epoch 14/27

16/16 [==============================] - 0s 26ms/step - loss: 0.4249 - acc: 0.8556
Epoch 15/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3797 - acc: 0.8521
Epoch 16/27

16/16 [==============================] - 0s 29ms/step - loss: 0.3726 - acc: 0.9296
Epoch 17/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3483 - acc: 0.8592
Epoch 18/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3535 - acc: 0.9401
Epoch 19/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2819 - acc: 0.9366
Epoch 20/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2566 - acc: 0.9577
Epoch 21/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2371 - acc: 0.9613
Epoch 22/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2134 - acc: 0.9648
Epoch 23/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1821 - acc: 0.9789
Epoch 24/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1763 - acc: 0.9789
Epoch 25/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1558 - acc: 0.9859
Epoch 26/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1475 - acc: 0.9824
Epoch 27/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1395 - acc: 0.9824
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7194
False 1877
True percentage 0.793076838276
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.90      0.94      0.92      7318
     B-MISC       0.00      0.00      0.00       141
      B-ORG       0.28      0.40      0.33       296
     I-MISC       0.28      0.12      0.16       154
      B-LOC       0.55      0.26      0.36       218
      I-ORG       0.29      0.08      0.12       151
      B-PER       0.52      0.10      0.16       438
      I-PER       0.58      0.21      0.31       214
      I-LOC       0.00      0.00      0.00       141

avg / total       0.80      0.79      0.78      9071

F-1 Score (without O):
0.228571428571
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 100021 unique words.
Found 89 unique chars.
Found 9 unique labels.
17 unique words not found in embedding.
5 unique chars not found in embedding.
Number of OOV: 325
OOV word occurences: 635
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5760        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401408     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,650
Trainable params: 6,507,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 2s 137ms/step - loss: 2.4317 - acc: 0.0263
Epoch 2/27

16/16 [==============================] - 0s 28ms/step - loss: 1.2443 - acc: 0.8257
Epoch 3/27

16/16 [==============================] - 0s 29ms/step - loss: 0.7870 - acc: 0.8257
Epoch 4/27

16/16 [==============================] - 0s 29ms/step - loss: 0.7501 - acc: 0.8257
Epoch 5/27

16/16 [==============================] - 0s 28ms/step - loss: 0.7044 - acc: 0.8257
Epoch 6/27

16/16 [==============================] - 0s 28ms/step - loss: 0.6720 - acc: 0.8257
Epoch 7/27

16/16 [==============================] - 0s 28ms/step - loss: 0.6166 - acc: 0.8257
Epoch 8/27

16/16 [==============================] - 0s 28ms/step - loss: 0.5794 - acc: 0.8257
Epoch 9/27

16/16 [==============================] - 0s 29ms/step - loss: 0.5545 - acc: 0.8257
Epoch 10/27

16/16 [==============================] - 0s 28ms/step - loss: 0.5329 - acc: 0.8289
Epoch 11/27

16/16 [==============================] - 0s 28ms/step - loss: 0.5001 - acc: 0.8257
Epoch 12/27

16/16 [==============================] - 0s 29ms/step - loss: 0.4771 - acc: 0.8289
Epoch 13/27

16/16 [==============================] - 0s 28ms/step - loss: 0.4438 - acc: 0.8322
Epoch 14/27

16/16 [==============================] - 0s 28ms/step - loss: 0.4162 - acc: 0.8520
Epoch 15/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3934 - acc: 0.8520
Epoch 16/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3578 - acc: 0.8816
Epoch 17/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3408 - acc: 0.8816
Epoch 18/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3084 - acc: 0.9276
Epoch 19/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3004 - acc: 0.9013
Epoch 20/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2889 - acc: 0.9539
Epoch 21/27

16/16 [==============================] - 0s 29ms/step - loss: 0.2816 - acc: 0.8947
Epoch 22/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3119 - acc: 0.9605
Epoch 23/27

16/16 [==============================] - 0s 29ms/step - loss: 0.2548 - acc: 0.9243
Epoch 24/27

16/16 [==============================] - 0s 29ms/step - loss: 0.2214 - acc: 0.9605
Epoch 25/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2070 - acc: 0.9572
Epoch 26/27

16/16 [==============================] - 0s 29ms/step - loss: 0.2013 - acc: 0.9671
Epoch 27/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1929 - acc: 0.9671
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7122
False 1949
True percentage 0.785139455407
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.38      0.26      0.31       296
          O       0.87      0.95      0.91      7318
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.14      0.10      0.12       154
      B-LOC       0.45      0.02      0.04       218
      I-LOC       0.50      0.01      0.03       141
      B-PER       0.57      0.08      0.15       438
      I-PER       0.50      0.10      0.16       214
      I-ORG       0.00      0.00      0.00       151

avg / total       0.78      0.79      0.76      9071

F-1 Score (without O):
0.828531106668
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 8
Found 100004 word vectors.
Found 84 char vectors.
Found 100016 unique words.
Found 91 unique chars.
Found 7 unique labels.
12 unique words not found in embedding.
7 unique chars not found in embedding.
Number of OOV: 327
OOV word occurences: 640
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5888        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 8)        1112        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,160
Trainable params: 6,507,160
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 2s 133ms/step - loss: 1.8171 - acc: 0.6388
Epoch 2/27

16/16 [==============================] - 0s 28ms/step - loss: 1.0330 - acc: 0.7960
Epoch 3/27

16/16 [==============================] - 0s 28ms/step - loss: 0.7967 - acc: 0.7960
Epoch 4/27

16/16 [==============================] - 0s 28ms/step - loss: 0.7907 - acc: 0.7960
Epoch 5/27

16/16 [==============================] - 0s 28ms/step - loss: 0.6833 - acc: 0.7960
Epoch 6/27

16/16 [==============================] - 0s 27ms/step - loss: 0.6454 - acc: 0.8027
Epoch 7/27

16/16 [==============================] - 0s 27ms/step - loss: 0.5998 - acc: 0.7960
Epoch 8/27

16/16 [==============================] - 0s 27ms/step - loss: 0.5477 - acc: 0.8161
Epoch 9/27

16/16 [==============================] - 0s 26ms/step - loss: 0.5058 - acc: 0.8027
Epoch 10/27

16/16 [==============================] - 0s 28ms/step - loss: 0.4408 - acc: 0.8562
Epoch 11/27

16/16 [==============================] - 0s 27ms/step - loss: 0.4106 - acc: 0.8462
Epoch 12/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3701 - acc: 0.8896
Epoch 13/27

16/16 [==============================] - 0s 26ms/step - loss: 0.3453 - acc: 0.8696
Epoch 14/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3362 - acc: 0.9398
Epoch 15/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3377 - acc: 0.8729
Epoch 16/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3025 - acc: 0.9431
Epoch 17/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2469 - acc: 0.9164
Epoch 18/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2153 - acc: 0.9431
Epoch 19/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2049 - acc: 0.9532
Epoch 20/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1838 - acc: 0.9699
Epoch 21/27

16/16 [==============================] - 0s 26ms/step - loss: 0.1658 - acc: 0.9732
Epoch 22/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1504 - acc: 0.9732
Epoch 23/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1331 - acc: 0.9799
Epoch 24/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1264 - acc: 0.9732
Epoch 25/27

16/16 [==============================] - 0s 26ms/step - loss: 0.1216 - acc: 0.9866
Epoch 26/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1027 - acc: 0.9866
Epoch 27/27

16/16 [==============================] - 0s 28ms/step - loss: 0.0996 - acc: 0.9866
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7176
False 1600
True percentage 0.817684594348
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.39      0.49      0.44       296
          O       0.91      0.93      0.92      7318
      B-LOC       0.45      0.27      0.34       218
      I-LOC       0.50      0.54      0.52       141
      I-ORG       0.09      0.11      0.10       151
      B-PER       0.59      0.09      0.15       438
      I-PER       0.33      0.00      0.01       214

avg / total       0.83      0.82      0.81      8776

F-1 Score (without O):
0.850266086115
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 9
Found 100004 word vectors.
Found 84 char vectors.
Found 100038 unique words.
Found 94 unique chars.
Found 9 unique labels.
34 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 322
OOV word occurences: 624
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6402496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,509,058
Trainable params: 6,509,058
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 2s 133ms/step - loss: 2.0658 - acc: 0.5293
Epoch 2/27

16/16 [==============================] - 0s 28ms/step - loss: 1.0971 - acc: 0.7878
Epoch 3/27

16/16 [==============================] - 0s 27ms/step - loss: 0.9877 - acc: 0.7878
Epoch 4/27

16/16 [==============================] - 0s 28ms/step - loss: 0.9058 - acc: 0.7878
Epoch 5/27

16/16 [==============================] - 0s 28ms/step - loss: 0.8000 - acc: 0.7878
Epoch 6/27

16/16 [==============================] - 0s 27ms/step - loss: 0.7727 - acc: 0.7878
Epoch 7/27

16/16 [==============================] - 0s 28ms/step - loss: 0.7275 - acc: 0.7878
Epoch 8/27

16/16 [==============================] - 0s 28ms/step - loss: 0.6924 - acc: 0.7878
Epoch 9/27

16/16 [==============================] - 0s 27ms/step - loss: 0.6508 - acc: 0.7878
Epoch 10/27

16/16 [==============================] - 0s 27ms/step - loss: 0.6082 - acc: 0.7902
Epoch 11/27

16/16 [==============================] - 0s 27ms/step - loss: 0.5781 - acc: 0.8024
Epoch 12/27

16/16 [==============================] - 0s 28ms/step - loss: 0.5547 - acc: 0.8024
Epoch 13/27

16/16 [==============================] - 0s 28ms/step - loss: 0.5162 - acc: 0.8341
Epoch 14/27

16/16 [==============================] - 0s 28ms/step - loss: 0.4966 - acc: 0.8122
Epoch 15/27

16/16 [==============================] - 0s 28ms/step - loss: 0.4509 - acc: 0.8390
Epoch 16/27

16/16 [==============================] - 0s 28ms/step - loss: 0.4248 - acc: 0.8341
Epoch 17/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3983 - acc: 0.8780
Epoch 18/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3730 - acc: 0.8561
Epoch 19/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3467 - acc: 0.9049
Epoch 20/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3254 - acc: 0.8951
Epoch 21/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2981 - acc: 0.9195
Epoch 22/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2917 - acc: 0.8927
Epoch 23/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2757 - acc: 0.9390
Epoch 24/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2652 - acc: 0.9073
Epoch 25/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2377 - acc: 0.9488
Epoch 26/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2294 - acc: 0.9293
Epoch 27/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2146 - acc: 0.9610
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7187
False 1884
True percentage 0.792305148275
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.88      0.95      0.91      7318
      B-LOC       0.70      0.22      0.33       218
      I-LOC       0.00      0.00      0.00       141
      B-ORG       0.34      0.32      0.33       296
      B-PER       0.53      0.14      0.22       438
      I-PER       0.67      0.05      0.09       214
      I-ORG       0.36      0.06      0.10       151
     B-MISC       0.10      0.01      0.01       141
     I-MISC       0.23      0.06      0.10       154

avg / total       0.79      0.79      0.77      9071

F-1 Score (without O):
0.201993931513
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 10
Found 100004 word vectors.
Found 84 char vectors.
Found 100027 unique words.
Found 91 unique chars.
Found 9 unique labels.
23 unique words not found in embedding.
7 unique chars not found in embedding.
Number of OOV: 324
OOV word occurences: 634
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5888        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401792     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,508,162
Trainable params: 6,508,162
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 2s 134ms/step - loss: 2.2966 - acc: 0.0403
Epoch 2/27

16/16 [==============================] - 0s 27ms/step - loss: 1.0563 - acc: 0.7867
Epoch 3/27

16/16 [==============================] - 0s 27ms/step - loss: 1.0355 - acc: 0.7867
Epoch 4/27

16/16 [==============================] - 0s 27ms/step - loss: 0.9023 - acc: 0.7867
Epoch 5/27

16/16 [==============================] - 0s 27ms/step - loss: 0.7894 - acc: 0.7867
Epoch 6/27

16/16 [==============================] - 0s 26ms/step - loss: 0.7378 - acc: 0.7867
Epoch 7/27

16/16 [==============================] - 0s 26ms/step - loss: 0.6985 - acc: 0.7867
Epoch 8/27

16/16 [==============================] - 0s 27ms/step - loss: 0.6617 - acc: 0.7896
Epoch 9/27

16/16 [==============================] - 0s 27ms/step - loss: 0.6216 - acc: 0.7925
Epoch 10/27

16/16 [==============================] - 0s 26ms/step - loss: 0.5846 - acc: 0.8040
Epoch 11/27

16/16 [==============================] - 0s 27ms/step - loss: 0.5595 - acc: 0.8012
Epoch 12/27

16/16 [==============================] - 0s 27ms/step - loss: 0.5245 - acc: 0.8271
Epoch 13/27

16/16 [==============================] - 0s 27ms/step - loss: 0.4843 - acc: 0.8329
Epoch 14/27

16/16 [==============================] - 0s 27ms/step - loss: 0.4602 - acc: 0.8646
Epoch 15/27

16/16 [==============================] - 0s 28ms/step - loss: 0.4270 - acc: 0.8473
Epoch 16/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3934 - acc: 0.8963
Epoch 17/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3580 - acc: 0.8761
Epoch 18/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3421 - acc: 0.9366
Epoch 19/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3147 - acc: 0.9193
Epoch 20/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2882 - acc: 0.9424
Epoch 21/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2788 - acc: 0.9366
Epoch 22/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2512 - acc: 0.9568
Epoch 23/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2388 - acc: 0.9452
Epoch 24/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2377 - acc: 0.9481
Epoch 25/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2166 - acc: 0.9424
Epoch 26/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2086 - acc: 0.9654
Epoch 27/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1967 - acc: 0.9481
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7268
False 1803
True percentage 0.801234704002
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.91      0.95      0.93      7318
      B-ORG       0.47      0.49      0.48       296
      I-ORG       0.19      0.19      0.19       151
      B-LOC       0.63      0.42      0.50       218
      B-PER       0.56      0.14      0.22       438
      I-PER       0.00      0.00      0.00       214
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.11      0.06      0.08       154
      I-LOC       0.00      0.00      0.00       141

avg / total       0.79      0.80      0.79      9071

F-1 Score (without O):
0.262063554335
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 11
Found 100004 word vectors.
Found 84 char vectors.
Found 100027 unique words.
Found 94 unique chars.
Found 9 unique labels.
23 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 327
OOV word occurences: 640
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401792     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,508,354
Trainable params: 6,508,354
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 2s 133ms/step - loss: 1.9728 - acc: 0.4312
Epoch 2/27

16/16 [==============================] - 0s 29ms/step - loss: 1.1018 - acc: 0.7676
Epoch 3/27

16/16 [==============================] - 0s 28ms/step - loss: 1.0402 - acc: 0.7676
Epoch 4/27

16/16 [==============================] - 0s 29ms/step - loss: 0.9798 - acc: 0.7676
Epoch 5/27

16/16 [==============================] - 0s 29ms/step - loss: 0.8201 - acc: 0.7676
Epoch 6/27

16/16 [==============================] - 0s 28ms/step - loss: 0.7680 - acc: 0.7676
Epoch 7/27

16/16 [==============================] - 0s 29ms/step - loss: 0.7258 - acc: 0.7676
Epoch 8/27

16/16 [==============================] - 0s 29ms/step - loss: 0.6874 - acc: 0.7737
Epoch 9/27

16/16 [==============================] - 0s 29ms/step - loss: 0.6608 - acc: 0.7798
Epoch 10/27

16/16 [==============================] - 0s 29ms/step - loss: 0.6075 - acc: 0.7982
Epoch 11/27

16/16 [==============================] - 0s 29ms/step - loss: 0.5677 - acc: 0.8196
Epoch 12/27

16/16 [==============================] - 0s 28ms/step - loss: 0.5239 - acc: 0.8287
Epoch 13/27

16/16 [==============================] - 0s 28ms/step - loss: 0.4894 - acc: 0.8532
Epoch 14/27

16/16 [==============================] - 0s 29ms/step - loss: 0.4669 - acc: 0.8410
Epoch 15/27

16/16 [==============================] - 0s 28ms/step - loss: 0.4280 - acc: 0.8716
Epoch 16/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3910 - acc: 0.8685
Epoch 17/27

16/16 [==============================] - 0s 29ms/step - loss: 0.3540 - acc: 0.8991
Epoch 18/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3315 - acc: 0.8899
Epoch 19/27

16/16 [==============================] - 0s 29ms/step - loss: 0.2955 - acc: 0.9358
Epoch 20/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2621 - acc: 0.9205
Epoch 21/27

16/16 [==============================] - 0s 29ms/step - loss: 0.2521 - acc: 0.9266
Epoch 22/27

16/16 [==============================] - 0s 29ms/step - loss: 0.2274 - acc: 0.9602
Epoch 23/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2086 - acc: 0.9358
Epoch 24/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1956 - acc: 0.9694
Epoch 25/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1704 - acc: 0.9664
Epoch 26/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1554 - acc: 0.9786
Epoch 27/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1516 - acc: 0.9725
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7191
False 1880
True percentage 0.79274611399
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.89      0.95      0.92      7318
      B-ORG       0.46      0.21      0.29       296
      I-ORG       0.21      0.28      0.24       151
     B-MISC       0.12      0.02      0.04       141
      B-LOC       0.12      0.02      0.03       218
      B-PER       0.60      0.26      0.36       438
     I-MISC       0.00      0.00      0.00       154
      I-PER       0.59      0.14      0.22       214
      I-LOC       0.00      0.00      0.00       141

avg / total       0.78      0.79      0.78      9071

F-1 Score (without O):
0.212908633697
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 100018 unique words.
Found 93 unique chars.
Found 8 unique labels.
14 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 325
OOV word occurences: 636
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401216     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,564
Trainable params: 6,507,564
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 2s 134ms/step - loss: 2.0243 - acc: 0.1877
Epoch 2/27

16/16 [==============================] - 0s 28ms/step - loss: 0.9521 - acc: 0.8328
Epoch 3/27

16/16 [==============================] - 0s 28ms/step - loss: 0.6976 - acc: 0.8328
Epoch 4/27

16/16 [==============================] - 0s 28ms/step - loss: 0.6440 - acc: 0.8328
Epoch 5/27

16/16 [==============================] - 0s 28ms/step - loss: 0.5718 - acc: 0.8328
Epoch 6/27

16/16 [==============================] - 0s 28ms/step - loss: 0.5373 - acc: 0.8328
Epoch 7/27

16/16 [==============================] - 0s 28ms/step - loss: 0.5017 - acc: 0.8328
Epoch 8/27

16/16 [==============================] - 0s 28ms/step - loss: 0.4710 - acc: 0.8328
Epoch 9/27

16/16 [==============================] - 0s 27ms/step - loss: 0.4385 - acc: 0.8328
Epoch 10/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3901 - acc: 0.8669
Epoch 11/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3584 - acc: 0.8840
Epoch 12/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3304 - acc: 0.8908
Epoch 13/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2987 - acc: 0.9010
Epoch 14/27

16/16 [==============================] - 0s 27ms/step - loss: 0.3183 - acc: 0.8874
Epoch 15/27

16/16 [==============================] - 0s 28ms/step - loss: 0.4041 - acc: 0.9181
Epoch 16/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2612 - acc: 0.9113
Epoch 17/27

16/16 [==============================] - 0s 27ms/step - loss: 0.2421 - acc: 0.9249
Epoch 18/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2210 - acc: 0.9352
Epoch 19/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2056 - acc: 0.9283
Epoch 20/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1976 - acc: 0.9454
Epoch 21/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1872 - acc: 0.9420
Epoch 22/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1758 - acc: 0.9488
Epoch 23/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1690 - acc: 0.9556
Epoch 24/27

16/16 [==============================] - 0s 27ms/step - loss: 0.1497 - acc: 0.9625
Epoch 25/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1447 - acc: 0.9659
Epoch 26/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1340 - acc: 0.9693
Epoch 27/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1347 - acc: 0.9693
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7196
False 1734
True percentage 0.805823068309
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.87      0.95      0.91      7318
      B-PER       0.79      0.19      0.31       438
      B-ORG       0.37      0.34      0.35       296
     B-MISC       0.00      0.00      0.00       141
      I-PER       0.69      0.09      0.16       214
      I-ORG       0.57      0.03      0.05       151
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.00      0.00      0.00       218

avg / total       0.79      0.81      0.78      8930

F-1 Score (without O):
0.206862745098
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100010 unique words.
Found 87 unique chars.
Found 8 unique labels.
6 unique words not found in embedding.
3 unique chars not found in embedding.
Number of OOV: 327
OOV word occurences: 639
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5632        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6400704     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,506,668
Trainable params: 6,506,668
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 2s 240ms/step - loss: 2.2538 - acc: 0.0331
Epoch 2/27

8/8 [==============================] - 0s 32ms/step - loss: 1.4700 - acc: 0.8013
Epoch 3/27

8/8 [==============================] - 0s 33ms/step - loss: 0.8479 - acc: 0.8013
Epoch 4/27

8/8 [==============================] - 0s 33ms/step - loss: 0.9864 - acc: 0.8013
Epoch 5/27

8/8 [==============================] - 0s 34ms/step - loss: 0.9497 - acc: 0.8079
Epoch 6/27

8/8 [==============================] - 0s 33ms/step - loss: 0.6705 - acc: 0.8013
Epoch 7/27

8/8 [==============================] - 0s 31ms/step - loss: 0.6371 - acc: 0.8013
Epoch 8/27

8/8 [==============================] - 0s 33ms/step - loss: 0.6192 - acc: 0.8079
Epoch 9/27

8/8 [==============================] - 0s 33ms/step - loss: 0.5534 - acc: 0.8013
Epoch 10/27

8/8 [==============================] - 0s 33ms/step - loss: 0.5321 - acc: 0.8146
Epoch 11/27

8/8 [==============================] - 0s 33ms/step - loss: 0.5143 - acc: 0.8278
Epoch 12/27

8/8 [==============================] - 0s 33ms/step - loss: 0.5014 - acc: 0.8212
Epoch 13/27

8/8 [==============================] - 0s 32ms/step - loss: 0.4338 - acc: 0.8808
Epoch 14/27

8/8 [==============================] - 0s 33ms/step - loss: 0.4012 - acc: 0.8543
Epoch 15/27

8/8 [==============================] - 0s 33ms/step - loss: 0.3533 - acc: 0.8940
Epoch 16/27

8/8 [==============================] - 0s 33ms/step - loss: 0.3079 - acc: 0.9073
Epoch 17/27

8/8 [==============================] - 0s 32ms/step - loss: 0.2846 - acc: 0.9272
Epoch 18/27

8/8 [==============================] - 0s 32ms/step - loss: 0.2775 - acc: 0.9338
Epoch 19/27

8/8 [==============================] - 0s 33ms/step - loss: 0.2543 - acc: 0.9272
Epoch 20/27

8/8 [==============================] - 0s 32ms/step - loss: 0.2390 - acc: 0.9603
Epoch 21/27

8/8 [==============================] - 0s 32ms/step - loss: 0.2077 - acc: 0.9669
Epoch 22/27

8/8 [==============================] - 0s 33ms/step - loss: 0.1925 - acc: 0.9603
Epoch 23/27

8/8 [==============================] - 0s 33ms/step - loss: 0.1721 - acc: 0.9801
Epoch 24/27

8/8 [==============================] - 0s 32ms/step - loss: 0.1715 - acc: 0.9669
Epoch 25/27

8/8 [==============================] - 0s 33ms/step - loss: 0.1490 - acc: 0.9801
Epoch 26/27

8/8 [==============================] - 0s 32ms/step - loss: 0.1353 - acc: 0.9801
Epoch 27/27

8/8 [==============================] - 0s 33ms/step - loss: 0.1113 - acc: 0.9868
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7103
False 1754
True percentage 0.801964547815
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.87      0.95      0.91      7318
      B-LOC       1.00      0.01      0.02       218
      I-LOC       0.86      0.09      0.15       141
      B-PER       0.58      0.10      0.17       438
      B-ORG       0.31      0.28      0.29       296
      I-ORG       0.25      0.01      0.01       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.80      0.80      0.77      8857

F-1 Score (without O):
0.145303580695
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 100016 unique words.
Found 91 unique chars.
Found 9 unique labels.
12 unique words not found in embedding.
7 unique chars not found in embedding.
Number of OOV: 328
OOV word occurences: 641
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5888        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,458
Trainable params: 6,507,458
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 2s 242ms/step - loss: 2.4887 - acc: 0.0136
Epoch 2/27

8/8 [==============================] - 0s 33ms/step - loss: 1.4184 - acc: 0.7687
Epoch 3/27

8/8 [==============================] - 0s 32ms/step - loss: 1.0330 - acc: 0.7687
Epoch 4/27

8/8 [==============================] - 0s 31ms/step - loss: 1.0030 - acc: 0.7755
Epoch 5/27

8/8 [==============================] - 0s 33ms/step - loss: 0.8629 - acc: 0.7687
Epoch 6/27

8/8 [==============================] - 0s 32ms/step - loss: 0.8048 - acc: 0.7687
Epoch 7/27

8/8 [==============================] - 0s 32ms/step - loss: 0.7347 - acc: 0.7755
Epoch 8/27

8/8 [==============================] - 0s 32ms/step - loss: 0.7084 - acc: 0.7687
Epoch 9/27

8/8 [==============================] - 0s 33ms/step - loss: 0.6619 - acc: 0.7755
Epoch 10/27

8/8 [==============================] - 0s 32ms/step - loss: 0.6186 - acc: 0.8435
Epoch 11/27

8/8 [==============================] - 0s 31ms/step - loss: 0.5911 - acc: 0.7823
Epoch 12/27

8/8 [==============================] - 0s 31ms/step - loss: 0.5547 - acc: 0.8639
Epoch 13/27

8/8 [==============================] - 0s 31ms/step - loss: 0.5079 - acc: 0.8095
Epoch 14/27

8/8 [==============================] - 0s 33ms/step - loss: 0.4752 - acc: 0.8639
Epoch 15/27

8/8 [==============================] - 0s 31ms/step - loss: 0.4117 - acc: 0.8707
Epoch 16/27

8/8 [==============================] - 0s 32ms/step - loss: 0.3749 - acc: 0.9252
Epoch 17/27

8/8 [==============================] - 0s 32ms/step - loss: 0.3559 - acc: 0.8912
Epoch 18/27

8/8 [==============================] - 0s 32ms/step - loss: 0.3159 - acc: 0.9524
Epoch 19/27

8/8 [==============================] - 0s 33ms/step - loss: 0.2907 - acc: 0.8980
Epoch 20/27

8/8 [==============================] - 0s 32ms/step - loss: 0.2906 - acc: 0.9592
Epoch 21/27

8/8 [==============================] - 0s 32ms/step - loss: 0.2478 - acc: 0.9456
Epoch 22/27

8/8 [==============================] - 0s 32ms/step - loss: 0.2424 - acc: 0.9728
Epoch 23/27

8/8 [==============================] - 0s 31ms/step - loss: 0.2144 - acc: 0.9524
Epoch 24/27

8/8 [==============================] - 0s 33ms/step - loss: 0.1943 - acc: 0.9728
Epoch 25/27

8/8 [==============================] - 0s 32ms/step - loss: 0.1623 - acc: 0.9728
Epoch 26/27

8/8 [==============================] - 0s 32ms/step - loss: 0.1395 - acc: 0.9864
Epoch 27/27

8/8 [==============================] - 0s 32ms/step - loss: 0.1358 - acc: 0.9728
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7176
False 1895
True percentage 0.791092492559
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.56      0.18      0.27       438
      I-PER       0.47      0.10      0.16       214
          O       0.89      0.94      0.91      7318
      B-ORG       0.33      0.38      0.35       296
      I-ORG       0.32      0.13      0.19       151
      B-LOC       0.94      0.14      0.24       218
      I-LOC       1.00      0.04      0.07       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.81      0.79      0.78      9071

F-1 Score (without O):
0.838740176092
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100012 unique words.
Found 91 unique chars.
Found 9 unique labels.
8 unique words not found in embedding.
7 unique chars not found in embedding.
Number of OOV: 326
OOV word occurences: 638
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5888        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6400832     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,202
Trainable params: 6,507,202
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 2s 243ms/step - loss: 2.4853 - acc: 0.0473
Epoch 2/27

8/8 [==============================] - 0s 33ms/step - loss: 1.3885 - acc: 0.7870
Epoch 3/27

8/8 [==============================] - 0s 32ms/step - loss: 0.9304 - acc: 0.7870
Epoch 4/27

8/8 [==============================] - 0s 32ms/step - loss: 0.8606 - acc: 0.7870
Epoch 5/27

8/8 [==============================] - 0s 32ms/step - loss: 0.8232 - acc: 0.7870
Epoch 6/27

8/8 [==============================] - 0s 33ms/step - loss: 0.8105 - acc: 0.7870
Epoch 7/27

8/8 [==============================] - 0s 33ms/step - loss: 0.7103 - acc: 0.7870
Epoch 8/27

8/8 [==============================] - 0s 33ms/step - loss: 0.6612 - acc: 0.7870
Epoch 9/27

8/8 [==============================] - 0s 32ms/step - loss: 0.6174 - acc: 0.7870
Epoch 10/27

8/8 [==============================] - 0s 34ms/step - loss: 0.5766 - acc: 0.7929
Epoch 11/27

8/8 [==============================] - 0s 32ms/step - loss: 0.5217 - acc: 0.7988
Epoch 12/27

8/8 [==============================] - 0s 33ms/step - loss: 0.4952 - acc: 0.8343
Epoch 13/27

8/8 [==============================] - 0s 32ms/step - loss: 0.4586 - acc: 0.8107
Epoch 14/27

8/8 [==============================] - 0s 32ms/step - loss: 0.4115 - acc: 0.8876
Epoch 15/27

8/8 [==============================] - 0s 34ms/step - loss: 0.3666 - acc: 0.8698
Epoch 16/27

8/8 [==============================] - 0s 32ms/step - loss: 0.3499 - acc: 0.9349
Epoch 17/27

8/8 [==============================] - 0s 32ms/step - loss: 0.3218 - acc: 0.8817
Epoch 18/27

8/8 [==============================] - 0s 34ms/step - loss: 0.2694 - acc: 0.9586
Epoch 19/27

8/8 [==============================] - 0s 34ms/step - loss: 0.2571 - acc: 0.9408
Epoch 20/27

8/8 [==============================] - 0s 34ms/step - loss: 0.2397 - acc: 0.9645
Epoch 21/27

8/8 [==============================] - 0s 34ms/step - loss: 0.2056 - acc: 0.9645
Epoch 22/27

8/8 [==============================] - 0s 35ms/step - loss: 0.1819 - acc: 0.9645
Epoch 23/27

8/8 [==============================] - 0s 34ms/step - loss: 0.1603 - acc: 0.9704
Epoch 24/27

8/8 [==============================] - 0s 32ms/step - loss: 0.1680 - acc: 0.9704
Epoch 25/27

8/8 [==============================] - 0s 33ms/step - loss: 0.1328 - acc: 0.9822
Epoch 26/27

8/8 [==============================] - 0s 34ms/step - loss: 0.1241 - acc: 0.9822
Epoch 27/27

8/8 [==============================] - 0s 33ms/step - loss: 0.1131 - acc: 0.9822
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7224
False 1847
True percentage 0.796384081138
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.88      0.95      0.91      7318
      B-PER       0.44      0.20      0.27       438
      B-LOC       0.78      0.33      0.47       218
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-ORG       0.41      0.30      0.35       296
      I-ORG       0.29      0.04      0.07       151
      I-LOC       0.88      0.05      0.09       141
      I-PER       1.00      0.02      0.04       214

avg / total       0.81      0.80      0.78      9071

F-1 Score (without O):
0.231441048035
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 100017 unique words.
Found 92 unique chars.
Found 9 unique labels.
13 unique words not found in embedding.
8 unique chars not found in embedding.
Number of OOV: 325
OOV word occurences: 630
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401152     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,586
Trainable params: 6,507,586
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 2s 241ms/step - loss: 2.3230 - acc: 0.0829
Epoch 2/27

8/8 [==============================] - 0s 33ms/step - loss: 1.5379 - acc: 0.6464
Epoch 3/27

8/8 [==============================] - 0s 32ms/step - loss: 1.3429 - acc: 0.6464
Epoch 4/27

8/8 [==============================] - 0s 33ms/step - loss: 1.3443 - acc: 0.6851
Epoch 5/27

8/8 [==============================] - 0s 33ms/step - loss: 1.0706 - acc: 0.6519
Epoch 6/27

8/8 [==============================] - 0s 32ms/step - loss: 0.9971 - acc: 0.6630
Epoch 7/27

8/8 [==============================] - 0s 32ms/step - loss: 0.9477 - acc: 0.6575
Epoch 8/27

8/8 [==============================] - 0s 33ms/step - loss: 0.8577 - acc: 0.7238
Epoch 9/27

8/8 [==============================] - 0s 33ms/step - loss: 0.7988 - acc: 0.7127
Epoch 10/27

8/8 [==============================] - 0s 32ms/step - loss: 0.7367 - acc: 0.7790
Epoch 11/27

8/8 [==============================] - 0s 32ms/step - loss: 0.6884 - acc: 0.7459
Epoch 12/27

8/8 [==============================] - 0s 32ms/step - loss: 0.6404 - acc: 0.8508
Epoch 13/27

8/8 [==============================] - 0s 33ms/step - loss: 0.5783 - acc: 0.7901
Epoch 14/27

8/8 [==============================] - 0s 33ms/step - loss: 0.5322 - acc: 0.9006
Epoch 15/27

8/8 [==============================] - 0s 32ms/step - loss: 0.4917 - acc: 0.8508
Epoch 16/27

8/8 [==============================] - 0s 32ms/step - loss: 0.4602 - acc: 0.9116
Epoch 17/27

8/8 [==============================] - 0s 32ms/step - loss: 0.3952 - acc: 0.9116
Epoch 18/27

8/8 [==============================] - 0s 33ms/step - loss: 0.3747 - acc: 0.9227
Epoch 19/27

8/8 [==============================] - 0s 33ms/step - loss: 0.3146 - acc: 0.9337
Epoch 20/27

8/8 [==============================] - 0s 32ms/step - loss: 0.2905 - acc: 0.9669
Epoch 21/27

8/8 [==============================] - 0s 33ms/step - loss: 0.2968 - acc: 0.9337
Epoch 22/27

8/8 [==============================] - 0s 33ms/step - loss: 0.2936 - acc: 0.9558
Epoch 23/27

8/8 [==============================] - 0s 34ms/step - loss: 0.2339 - acc: 0.9613
Epoch 24/27

8/8 [==============================] - 0s 32ms/step - loss: 0.2000 - acc: 0.9724
Epoch 25/27

8/8 [==============================] - 0s 33ms/step - loss: 0.2019 - acc: 0.9613
Epoch 26/27

8/8 [==============================] - 0s 32ms/step - loss: 0.1903 - acc: 0.9724
Epoch 27/27

8/8 [==============================] - 0s 32ms/step - loss: 0.1602 - acc: 0.9669
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7212
False 1859
True percentage 0.795061183993
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.89      0.95      0.92      7318
      B-ORG       0.46      0.30      0.36       296
      I-ORG       0.26      0.22      0.24       151
      B-PER       0.53      0.26      0.35       438
      I-PER       0.51      0.20      0.29       214
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.36      0.03      0.05       154

avg / total       0.78      0.80      0.78      9071

F-1 Score (without O):
0.238155136268
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 100020 unique words.
Found 92 unique chars.
Found 9 unique labels.
16 unique words not found in embedding.
8 unique chars not found in embedding.
Number of OOV: 327
OOV word occurences: 638
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401344     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,778
Trainable params: 6,507,778
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 2s 260ms/step - loss: 2.1643 - acc: 0.1875
Epoch 2/27

8/8 [==============================] - 0s 32ms/step - loss: 1.1317 - acc: 0.7841
Epoch 3/27

8/8 [==============================] - 0s 33ms/step - loss: 1.0561 - acc: 0.7841
Epoch 4/27

8/8 [==============================] - 0s 32ms/step - loss: 0.9696 - acc: 0.7841
Epoch 5/27

8/8 [==============================] - 0s 34ms/step - loss: 0.8390 - acc: 0.7841
Epoch 6/27

8/8 [==============================] - 0s 33ms/step - loss: 0.7889 - acc: 0.7841
Epoch 7/27

8/8 [==============================] - 0s 33ms/step - loss: 0.7400 - acc: 0.7841
Epoch 8/27

8/8 [==============================] - 0s 33ms/step - loss: 0.6961 - acc: 0.7841
Epoch 9/27

8/8 [==============================] - 0s 32ms/step - loss: 0.6431 - acc: 0.7841
Epoch 10/27

8/8 [==============================] - 0s 31ms/step - loss: 0.6040 - acc: 0.7898
Epoch 11/27

8/8 [==============================] - 0s 32ms/step - loss: 0.5494 - acc: 0.8182
Epoch 12/27

8/8 [==============================] - 0s 33ms/step - loss: 0.5163 - acc: 0.8239
Epoch 13/27

8/8 [==============================] - 0s 32ms/step - loss: 0.5049 - acc: 0.8750
Epoch 14/27

8/8 [==============================] - 0s 31ms/step - loss: 0.4902 - acc: 0.8068
Epoch 15/27

8/8 [==============================] - 0s 31ms/step - loss: 0.4787 - acc: 0.9148
Epoch 16/27

8/8 [==============================] - 0s 32ms/step - loss: 0.3825 - acc: 0.8977
Epoch 17/27

8/8 [==============================] - 0s 33ms/step - loss: 0.3433 - acc: 0.9205
Epoch 18/27

8/8 [==============================] - 0s 31ms/step - loss: 0.3262 - acc: 0.9148
Epoch 19/27

8/8 [==============================] - 0s 32ms/step - loss: 0.3073 - acc: 0.9261
Epoch 20/27

8/8 [==============================] - 0s 32ms/step - loss: 0.2800 - acc: 0.9261
Epoch 21/27

8/8 [==============================] - 0s 31ms/step - loss: 0.2642 - acc: 0.9261
Epoch 22/27

8/8 [==============================] - 0s 32ms/step - loss: 0.2321 - acc: 0.9545
Epoch 23/27

8/8 [==============================] - 0s 32ms/step - loss: 0.2363 - acc: 0.9602
Epoch 24/27

8/8 [==============================] - 0s 32ms/step - loss: 0.2185 - acc: 0.9545
Epoch 25/27

8/8 [==============================] - 0s 32ms/step - loss: 0.1871 - acc: 0.9716
Epoch 26/27

8/8 [==============================] - 0s 33ms/step - loss: 0.1829 - acc: 0.9716
Epoch 27/27

8/8 [==============================] - 0s 32ms/step - loss: 0.1550 - acc: 0.9773
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7075
False 1996
True percentage 0.779958108257
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.89      0.94      0.91      7318
      B-ORG       0.35      0.22      0.27       296
      I-ORG       0.28      0.27      0.28       151
      B-PER       0.50      0.11      0.18       438
      I-PER       0.00      0.00      0.00       214
     B-MISC       0.06      0.09      0.07       141
     I-MISC       0.11      0.01      0.01       154
      B-LOC       0.55      0.06      0.10       218
      I-LOC       0.67      0.01      0.03       141

avg / total       0.78      0.78      0.76      9071

F-1 Score (without O):
0.150062526053
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 100019 unique words.
Found 92 unique chars.
Found 9 unique labels.
15 unique words not found in embedding.
8 unique chars not found in embedding.
Number of OOV: 324
OOV word occurences: 623
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401280     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,714
Trainable params: 6,507,714
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 2s 242ms/step - loss: 2.2521 - acc: 0.1399
Epoch 2/27

8/8 [==============================] - 0s 32ms/step - loss: 1.2768 - acc: 0.8290
Epoch 3/27

8/8 [==============================] - 0s 31ms/step - loss: 0.7239 - acc: 0.8290
Epoch 4/27

8/8 [==============================] - 0s 33ms/step - loss: 0.7253 - acc: 0.8290
Epoch 5/27

8/8 [==============================] - 0s 32ms/step - loss: 0.7895 - acc: 0.8290
Epoch 6/27

8/8 [==============================] - 0s 31ms/step - loss: 0.6089 - acc: 0.8290
Epoch 7/27

8/8 [==============================] - 0s 32ms/step - loss: 0.5689 - acc: 0.8290
Epoch 8/27

8/8 [==============================] - 0s 32ms/step - loss: 0.5367 - acc: 0.8290
Epoch 9/27

8/8 [==============================] - 0s 32ms/step - loss: 0.5022 - acc: 0.8290
Epoch 10/27

8/8 [==============================] - 0s 32ms/step - loss: 0.4629 - acc: 0.8290
Epoch 11/27

8/8 [==============================] - 0s 32ms/step - loss: 0.4244 - acc: 0.8394
Epoch 12/27

8/8 [==============================] - 0s 32ms/step - loss: 0.3934 - acc: 0.8446
Epoch 13/27

8/8 [==============================] - 0s 32ms/step - loss: 0.3569 - acc: 0.8756
Epoch 14/27

8/8 [==============================] - 0s 32ms/step - loss: 0.3210 - acc: 0.8705
Epoch 15/27

8/8 [==============================] - 0s 33ms/step - loss: 0.2986 - acc: 0.9067
Epoch 16/27

8/8 [==============================] - 0s 33ms/step - loss: 0.2858 - acc: 0.8808
Epoch 17/27

8/8 [==============================] - 0s 33ms/step - loss: 0.3089 - acc: 0.9482
Epoch 18/27

8/8 [==============================] - 0s 33ms/step - loss: 0.2254 - acc: 0.9326
Epoch 19/27

8/8 [==============================] - 0s 32ms/step - loss: 0.2224 - acc: 0.9378
Epoch 20/27

8/8 [==============================] - 0s 32ms/step - loss: 0.1945 - acc: 0.9585
Epoch 21/27

8/8 [==============================] - 0s 33ms/step - loss: 0.1846 - acc: 0.9585
Epoch 22/27

8/8 [==============================] - 0s 33ms/step - loss: 0.1706 - acc: 0.9689
Epoch 23/27

8/8 [==============================] - 0s 32ms/step - loss: 0.1629 - acc: 0.9585
Epoch 24/27

8/8 [==============================] - 0s 34ms/step - loss: 0.1415 - acc: 0.9585
Epoch 25/27

8/8 [==============================] - 0s 33ms/step - loss: 0.1299 - acc: 0.9845
Epoch 26/27

8/8 [==============================] - 0s 32ms/step - loss: 0.1285 - acc: 0.9741
Epoch 27/27

8/8 [==============================] - 0s 32ms/step - loss: 0.1092 - acc: 0.9845
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7221
False 1850
True percentage 0.796053356852
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.53      0.30      0.38       438
          O       0.88      0.95      0.92      7318
      B-LOC       0.50      0.01      0.03       218
      B-ORG       0.43      0.36      0.39       296
      I-PER       0.37      0.07      0.11       214
     B-MISC       0.07      0.01      0.02       141
     I-MISC       0.00      0.00      0.00       154
      I-ORG       0.00      0.00      0.00       151
      I-LOC       0.00      0.00      0.00       141

avg / total       0.78      0.80      0.77      9071

F-1 Score (without O):
0.842361606082
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 100010 unique words.
Found 88 unique chars.
Found 9 unique labels.
6 unique words not found in embedding.
4 unique chars not found in embedding.
Number of OOV: 328
OOV word occurences: 641
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5696        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6400704     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,506,882
Trainable params: 6,506,882
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 2s 246ms/step - loss: 2.1883 - acc: 0.1288
Epoch 2/27

8/8 [==============================] - 0s 32ms/step - loss: 1.2787 - acc: 0.7273
Epoch 3/27

8/8 [==============================] - 0s 34ms/step - loss: 1.0175 - acc: 0.7273
Epoch 4/27

8/8 [==============================] - 0s 31ms/step - loss: 0.9523 - acc: 0.7273
Epoch 5/27

8/8 [==============================] - 0s 32ms/step - loss: 0.8580 - acc: 0.7273
Epoch 6/27

8/8 [==============================] - 0s 31ms/step - loss: 0.7776 - acc: 0.7500
Epoch 7/27

8/8 [==============================] - 0s 33ms/step - loss: 0.7190 - acc: 0.7273
Epoch 8/27

8/8 [==============================] - 0s 33ms/step - loss: 0.6599 - acc: 0.8030
Epoch 9/27

8/8 [==============================] - 0s 32ms/step - loss: 0.5996 - acc: 0.7955
Epoch 10/27

8/8 [==============================] - 0s 32ms/step - loss: 0.5514 - acc: 0.8258
Epoch 11/27

8/8 [==============================] - 0s 32ms/step - loss: 0.5201 - acc: 0.8106
Epoch 12/27

8/8 [==============================] - 0s 33ms/step - loss: 0.4695 - acc: 0.8485
Epoch 13/27

8/8 [==============================] - 0s 33ms/step - loss: 0.4359 - acc: 0.8333
Epoch 14/27

8/8 [==============================] - 0s 33ms/step - loss: 0.3973 - acc: 0.8939
Epoch 15/27

8/8 [==============================] - 0s 32ms/step - loss: 0.3686 - acc: 0.8712
Epoch 16/27

8/8 [==============================] - 0s 32ms/step - loss: 0.3365 - acc: 0.9318
Epoch 17/27

8/8 [==============================] - 0s 32ms/step - loss: 0.2991 - acc: 0.9015
Epoch 18/27

8/8 [==============================] - 0s 32ms/step - loss: 0.2684 - acc: 0.9318
Epoch 19/27

8/8 [==============================] - 0s 31ms/step - loss: 0.2325 - acc: 0.9545
Epoch 20/27

8/8 [==============================] - 0s 32ms/step - loss: 0.1957 - acc: 0.9621
Epoch 21/27

8/8 [==============================] - 0s 32ms/step - loss: 0.2053 - acc: 0.9848
Epoch 22/27

8/8 [==============================] - 0s 32ms/step - loss: 0.1692 - acc: 0.9697
Epoch 23/27

8/8 [==============================] - 0s 32ms/step - loss: 0.1714 - acc: 0.9773
Epoch 24/27

8/8 [==============================] - 0s 32ms/step - loss: 0.1572 - acc: 0.9773
Epoch 25/27

8/8 [==============================] - 0s 32ms/step - loss: 0.1361 - acc: 0.9848
Epoch 26/27

8/8 [==============================] - 0s 31ms/step - loss: 0.1318 - acc: 0.9697
Epoch 27/27

8/8 [==============================] - 0s 31ms/step - loss: 0.1351 - acc: 0.9924
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7081
False 1990
True percentage 0.780619556829
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.89      0.94      0.91      7318
     B-MISC       0.00      0.00      0.00       141
      B-ORG       0.24      0.38      0.30       296
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.43      0.22      0.30       218
      I-ORG       0.29      0.03      0.05       151
      B-PER       0.62      0.02      0.04       438
      I-PER       0.46      0.12      0.19       214
      I-LOC       1.00      0.01      0.01       141

avg / total       0.80      0.78      0.76      9071

F-1 Score (without O):
0.166529266282
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 100014 unique words.
Found 87 unique chars.
Found 8 unique labels.
10 unique words not found in embedding.
3 unique chars not found in embedding.
Number of OOV: 325
OOV word occurences: 635
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5632        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6400960     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,506,924
Trainable params: 6,506,924
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 2s 242ms/step - loss: 2.0848 - acc: 0.1076
Epoch 2/27

8/8 [==============================] - 0s 34ms/step - loss: 1.1224 - acc: 0.8291
Epoch 3/27

8/8 [==============================] - 0s 33ms/step - loss: 0.7141 - acc: 0.8291
Epoch 4/27

8/8 [==============================] - 0s 32ms/step - loss: 0.6889 - acc: 0.8291
Epoch 5/27

8/8 [==============================] - 0s 33ms/step - loss: 0.6505 - acc: 0.8291
Epoch 6/27

8/8 [==============================] - 0s 33ms/step - loss: 0.6136 - acc: 0.8291
Epoch 7/27

8/8 [==============================] - 0s 32ms/step - loss: 0.5492 - acc: 0.8291
Epoch 8/27

8/8 [==============================] - 0s 32ms/step - loss: 0.5118 - acc: 0.8291
Epoch 9/27

8/8 [==============================] - 0s 33ms/step - loss: 0.4689 - acc: 0.8291
Epoch 10/27

8/8 [==============================] - 0s 33ms/step - loss: 0.4417 - acc: 0.8354
Epoch 11/27

8/8 [==============================] - 0s 33ms/step - loss: 0.4048 - acc: 0.8291
Epoch 12/27

8/8 [==============================] - 0s 33ms/step - loss: 0.3625 - acc: 0.8671
Epoch 13/27

8/8 [==============================] - 0s 34ms/step - loss: 0.3272 - acc: 0.8608
Epoch 14/27

8/8 [==============================] - 0s 33ms/step - loss: 0.3004 - acc: 0.9304
Epoch 15/27

8/8 [==============================] - 0s 32ms/step - loss: 0.2770 - acc: 0.8861
Epoch 16/27

8/8 [==============================] - 0s 33ms/step - loss: 0.2536 - acc: 0.9620
Epoch 17/27

8/8 [==============================] - 0s 33ms/step - loss: 0.2155 - acc: 0.9557
Epoch 18/27

8/8 [==============================] - 0s 32ms/step - loss: 0.1984 - acc: 0.9810
Epoch 19/27

8/8 [==============================] - 0s 33ms/step - loss: 0.1946 - acc: 0.9494
Epoch 20/27

8/8 [==============================] - 0s 34ms/step - loss: 0.1885 - acc: 0.9873
Epoch 21/27

8/8 [==============================] - 0s 32ms/step - loss: 0.1636 - acc: 0.9873
Epoch 22/27

8/8 [==============================] - 0s 34ms/step - loss: 0.1558 - acc: 0.9873
Epoch 23/27

8/8 [==============================] - 0s 33ms/step - loss: 0.1308 - acc: 0.9937
Epoch 24/27

8/8 [==============================] - 0s 32ms/step - loss: 0.1159 - acc: 0.9937
Epoch 25/27

8/8 [==============================] - 0s 34ms/step - loss: 0.1084 - acc: 1.0000
Epoch 26/27

8/8 [==============================] - 0s 32ms/step - loss: 0.1028 - acc: 1.0000
Epoch 27/27

8/8 [==============================] - 0s 33ms/step - loss: 0.0883 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7099
False 1821
True percentage 0.795852017937
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.37      0.29      0.32       296
          O       0.86      0.95      0.90      7318
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.62      0.05      0.09       218
      I-LOC       0.00      0.00      0.00       141
      B-PER       0.37      0.04      0.07       438
      I-PER       0.48      0.05      0.09       214

avg / total       0.76      0.80      0.76      8920

F-1 Score (without O):
0.833561114742
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 8
Found 100004 word vectors.
Found 84 char vectors.
Found 100012 unique words.
Found 91 unique chars.
Found 7 unique labels.
8 unique words not found in embedding.
7 unique chars not found in embedding.
Number of OOV: 327
OOV word occurences: 640
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5888        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6400832     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 8)        1112        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,506,904
Trainable params: 6,506,904
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 2s 241ms/step - loss: 2.2395 - acc: 0.0270
Epoch 2/27

8/8 [==============================] - 0s 33ms/step - loss: 1.0082 - acc: 0.8176
Epoch 3/27

8/8 [==============================] - 0s 33ms/step - loss: 0.8214 - acc: 0.8176
Epoch 4/27

8/8 [==============================] - 0s 32ms/step - loss: 0.7322 - acc: 0.8176
Epoch 5/27

8/8 [==============================] - 0s 32ms/step - loss: 0.6579 - acc: 0.8176
Epoch 6/27

8/8 [==============================] - 0s 33ms/step - loss: 0.5833 - acc: 0.8176
Epoch 7/27

8/8 [==============================] - 0s 32ms/step - loss: 0.5406 - acc: 0.8176
Epoch 8/27

8/8 [==============================] - 0s 33ms/step - loss: 0.5259 - acc: 0.8176
Epoch 9/27

8/8 [==============================] - 0s 32ms/step - loss: 0.4876 - acc: 0.8243
Epoch 10/27

8/8 [==============================] - 0s 32ms/step - loss: 0.4474 - acc: 0.8311
Epoch 11/27

8/8 [==============================] - 0s 32ms/step - loss: 0.4098 - acc: 0.8446
Epoch 12/27

8/8 [==============================] - 0s 33ms/step - loss: 0.3865 - acc: 0.8986
Epoch 13/27

8/8 [==============================] - 0s 32ms/step - loss: 0.3693 - acc: 0.8514
Epoch 14/27

8/8 [==============================] - 0s 33ms/step - loss: 0.3499 - acc: 0.9257
Epoch 15/27

8/8 [==============================] - 0s 33ms/step - loss: 0.3337 - acc: 0.8784
Epoch 16/27

8/8 [==============================] - 0s 32ms/step - loss: 0.2907 - acc: 0.9459
Epoch 17/27

8/8 [==============================] - 0s 32ms/step - loss: 0.2726 - acc: 0.8986
Epoch 18/27

8/8 [==============================] - 0s 32ms/step - loss: 0.2565 - acc: 0.9392
Epoch 19/27

8/8 [==============================] - 0s 33ms/step - loss: 0.2336 - acc: 0.9257
Epoch 20/27

8/8 [==============================] - 0s 32ms/step - loss: 0.2054 - acc: 0.9459
Epoch 21/27

8/8 [==============================] - 0s 32ms/step - loss: 0.2036 - acc: 0.9459
Epoch 22/27

8/8 [==============================] - 0s 33ms/step - loss: 0.1797 - acc: 0.9392
Epoch 23/27

8/8 [==============================] - 0s 32ms/step - loss: 0.1657 - acc: 0.9595
Epoch 24/27

8/8 [==============================] - 0s 33ms/step - loss: 0.1688 - acc: 0.9527
Epoch 25/27

8/8 [==============================] - 0s 32ms/step - loss: 0.1485 - acc: 0.9595
Epoch 26/27

8/8 [==============================] - 0s 31ms/step - loss: 0.1285 - acc: 0.9662
Epoch 27/27

8/8 [==============================] - 0s 31ms/step - loss: 0.1238 - acc: 0.9797
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7151
False 1625
True percentage 0.814835916135
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.57      0.26      0.36       296
          O       0.85      0.96      0.90      7318
      B-LOC       0.59      0.09      0.16       218
      I-LOC       0.91      0.21      0.34       141
      I-ORG       0.00      0.00      0.00       151
      B-PER       0.72      0.03      0.06       438
      I-PER       0.00      0.00      0.00       214

avg / total       0.80      0.81      0.78      8776

F-1 Score (without O):
0.843379240446
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 9
Found 100004 word vectors.
Found 84 char vectors.
Found 100023 unique words.
Found 93 unique chars.
Found 9 unique labels.
19 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 323
OOV word occurences: 625
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401536     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,508,034
Trainable params: 6,508,034
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 2s 257ms/step - loss: 2.3004 - acc: 0.0407
Epoch 2/27

8/8 [==============================] - 0s 33ms/step - loss: 1.2749 - acc: 0.8009
Epoch 3/27

8/8 [==============================] - 0s 34ms/step - loss: 0.8110 - acc: 0.8009
Epoch 4/27

8/8 [==============================] - 0s 33ms/step - loss: 0.7497 - acc: 0.8009
Epoch 5/27

8/8 [==============================] - 0s 34ms/step - loss: 0.7385 - acc: 0.8009
Epoch 6/27

8/8 [==============================] - 0s 33ms/step - loss: 0.7588 - acc: 0.8009
Epoch 7/27

8/8 [==============================] - 0s 32ms/step - loss: 0.6211 - acc: 0.8009
Epoch 8/27

8/8 [==============================] - 0s 33ms/step - loss: 0.5984 - acc: 0.8009
Epoch 9/27

8/8 [==============================] - 0s 34ms/step - loss: 0.5567 - acc: 0.8009
Epoch 10/27

8/8 [==============================] - 0s 33ms/step - loss: 0.5108 - acc: 0.8054
Epoch 11/27

8/8 [==============================] - 0s 33ms/step - loss: 0.4782 - acc: 0.8100
Epoch 12/27

8/8 [==============================] - 0s 33ms/step - loss: 0.4475 - acc: 0.8235
Epoch 13/27

8/8 [==============================] - 0s 34ms/step - loss: 0.4115 - acc: 0.8552
Epoch 14/27

8/8 [==============================] - 0s 33ms/step - loss: 0.3825 - acc: 0.8643
Epoch 15/27

8/8 [==============================] - 0s 33ms/step - loss: 0.3449 - acc: 0.8914
Epoch 16/27

8/8 [==============================] - 0s 32ms/step - loss: 0.3275 - acc: 0.9050
Epoch 17/27

8/8 [==============================] - 0s 34ms/step - loss: 0.3005 - acc: 0.9186
Epoch 18/27

8/8 [==============================] - 0s 33ms/step - loss: 0.2725 - acc: 0.9186
Epoch 19/27

8/8 [==============================] - 0s 33ms/step - loss: 0.2548 - acc: 0.9231
Epoch 20/27

8/8 [==============================] - 0s 33ms/step - loss: 0.2295 - acc: 0.9321
Epoch 21/27

8/8 [==============================] - 0s 33ms/step - loss: 0.2342 - acc: 0.9593
Epoch 22/27

8/8 [==============================] - 0s 32ms/step - loss: 0.2159 - acc: 0.9276
Epoch 23/27

8/8 [==============================] - 0s 34ms/step - loss: 0.2051 - acc: 0.9502
Epoch 24/27

8/8 [==============================] - 0s 34ms/step - loss: 0.1726 - acc: 0.9593
Epoch 25/27

8/8 [==============================] - 0s 35ms/step - loss: 0.1699 - acc: 0.9683
Epoch 26/27

8/8 [==============================] - 0s 33ms/step - loss: 0.1482 - acc: 0.9864
Epoch 27/27

8/8 [==============================] - 0s 33ms/step - loss: 0.1473 - acc: 0.9819
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7140
False 1931
True percentage 0.787123801124
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.87      0.95      0.91      7318
      B-LOC       0.36      0.11      0.16       218
      I-LOC       0.33      0.01      0.01       141
      B-ORG       0.33      0.35      0.34       296
      B-PER       0.44      0.07      0.12       438
      I-PER       0.00      0.00      0.00       214
      I-ORG       0.43      0.04      0.07       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.76      0.79      0.76      9071

F-1 Score (without O):
0.148081264108
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 10
Found 100004 word vectors.
Found 84 char vectors.
Found 100019 unique words.
Found 89 unique chars.
Found 9 unique labels.
15 unique words not found in embedding.
5 unique chars not found in embedding.
Number of OOV: 326
OOV word occurences: 638
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5760        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401280     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,522
Trainable params: 6,507,522
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 2s 241ms/step - loss: 2.1058 - acc: 0.3520
Epoch 2/27

8/8 [==============================] - 0s 33ms/step - loss: 1.1541 - acc: 0.8045
Epoch 3/27

8/8 [==============================] - 0s 33ms/step - loss: 0.8599 - acc: 0.8045
Epoch 4/27

8/8 [==============================] - 0s 33ms/step - loss: 0.8068 - acc: 0.8045
Epoch 5/27

8/8 [==============================] - 0s 32ms/step - loss: 0.7204 - acc: 0.8045
Epoch 6/27

8/8 [==============================] - 0s 33ms/step - loss: 0.6690 - acc: 0.8101
Epoch 7/27

8/8 [==============================] - 0s 33ms/step - loss: 0.6052 - acc: 0.8045
Epoch 8/27

8/8 [==============================] - 0s 33ms/step - loss: 0.5635 - acc: 0.8156
Epoch 9/27

8/8 [==============================] - 0s 33ms/step - loss: 0.5042 - acc: 0.8101
Epoch 10/27

8/8 [==============================] - 0s 31ms/step - loss: 0.4898 - acc: 0.8212
Epoch 11/27

8/8 [==============================] - 0s 32ms/step - loss: 0.4377 - acc: 0.8156
Epoch 12/27

8/8 [==============================] - 0s 32ms/step - loss: 0.4193 - acc: 0.8771
Epoch 13/27

8/8 [==============================] - 0s 33ms/step - loss: 0.3747 - acc: 0.8547
Epoch 14/27

8/8 [==============================] - 0s 32ms/step - loss: 0.3519 - acc: 0.8939
Epoch 15/27

8/8 [==============================] - 0s 32ms/step - loss: 0.3189 - acc: 0.9330
Epoch 16/27

8/8 [==============================] - 0s 33ms/step - loss: 0.2668 - acc: 0.9497
Epoch 17/27

8/8 [==============================] - 0s 33ms/step - loss: 0.2640 - acc: 0.9497
Epoch 18/27

8/8 [==============================] - 0s 33ms/step - loss: 0.2487 - acc: 0.9441
Epoch 19/27

8/8 [==============================] - 0s 32ms/step - loss: 0.2227 - acc: 0.9609
Epoch 20/27

8/8 [==============================] - 0s 33ms/step - loss: 0.2382 - acc: 0.9162
Epoch 21/27

8/8 [==============================] - 0s 33ms/step - loss: 0.3333 - acc: 0.9441
Epoch 22/27

8/8 [==============================] - 0s 33ms/step - loss: 0.2152 - acc: 0.9274
Epoch 23/27

8/8 [==============================] - 0s 33ms/step - loss: 0.1752 - acc: 0.9665
Epoch 24/27

8/8 [==============================] - 0s 33ms/step - loss: 0.1493 - acc: 0.9721
Epoch 25/27

8/8 [==============================] - 0s 33ms/step - loss: 0.1393 - acc: 0.9832
Epoch 26/27

8/8 [==============================] - 0s 33ms/step - loss: 0.1276 - acc: 0.9832
Epoch 27/27

8/8 [==============================] - 0s 32ms/step - loss: 0.1202 - acc: 0.9777
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7218
False 1853
True percentage 0.795722632565
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.89      0.95      0.92      7318
      B-ORG       0.43      0.27      0.34       296
      I-ORG       0.22      0.03      0.05       151
      B-LOC       0.39      0.46      0.43       218
      B-PER       0.50      0.12      0.20       438
      I-PER       0.00      0.00      0.00       214
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.18      0.03      0.05       154
      I-LOC       0.00      0.00      0.00       141

avg / total       0.77      0.80      0.77      9071

F-1 Score (without O):
0.208599404002
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 11
Found 100004 word vectors.
Found 84 char vectors.
Found 100011 unique words.
Found 93 unique chars.
Found 9 unique labels.
7 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 328
OOV word occurences: 641
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6400768     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,266
Trainable params: 6,507,266
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 2s 242ms/step - loss: 2.0630 - acc: 0.3427
Epoch 2/27

8/8 [==============================] - 0s 32ms/step - loss: 1.1709 - acc: 0.8090
Epoch 3/27

8/8 [==============================] - 0s 33ms/step - loss: 0.7978 - acc: 0.8090
Epoch 4/27

8/8 [==============================] - 0s 32ms/step - loss: 0.7048 - acc: 0.8090
Epoch 5/27

8/8 [==============================] - 0s 33ms/step - loss: 0.6632 - acc: 0.8090
Epoch 6/27

8/8 [==============================] - 0s 32ms/step - loss: 0.6469 - acc: 0.8371
Epoch 7/27

8/8 [==============================] - 0s 33ms/step - loss: 0.6178 - acc: 0.8090
Epoch 8/27

8/8 [==============================] - 0s 33ms/step - loss: 0.5819 - acc: 0.8539
Epoch 9/27

8/8 [==============================] - 0s 33ms/step - loss: 0.4920 - acc: 0.8371
Epoch 10/27

8/8 [==============================] - 0s 34ms/step - loss: 0.4627 - acc: 0.8539
Epoch 11/27

8/8 [==============================] - 0s 33ms/step - loss: 0.4334 - acc: 0.8596
Epoch 12/27

8/8 [==============================] - 0s 33ms/step - loss: 0.3897 - acc: 0.8596
Epoch 13/27

8/8 [==============================] - 0s 33ms/step - loss: 0.3442 - acc: 0.8708
Epoch 14/27

8/8 [==============================] - 0s 32ms/step - loss: 0.3105 - acc: 0.9157
Epoch 15/27

8/8 [==============================] - 0s 33ms/step - loss: 0.2830 - acc: 0.9157
Epoch 16/27

8/8 [==============================] - 0s 34ms/step - loss: 0.2554 - acc: 0.9494
Epoch 17/27

8/8 [==============================] - 0s 33ms/step - loss: 0.2370 - acc: 0.9494
Epoch 18/27

8/8 [==============================] - 0s 33ms/step - loss: 0.2123 - acc: 0.9494
Epoch 19/27

8/8 [==============================] - 0s 33ms/step - loss: 0.2046 - acc: 0.9382
Epoch 20/27

8/8 [==============================] - 0s 34ms/step - loss: 0.2052 - acc: 0.9663
Epoch 21/27

8/8 [==============================] - 0s 33ms/step - loss: 0.1671 - acc: 0.9663
Epoch 22/27

8/8 [==============================] - 0s 33ms/step - loss: 0.1557 - acc: 0.9663
Epoch 23/27

8/8 [==============================] - 0s 33ms/step - loss: 0.1451 - acc: 0.9719
Epoch 24/27

8/8 [==============================] - 0s 33ms/step - loss: 0.1361 - acc: 0.9719
Epoch 25/27

8/8 [==============================] - 0s 33ms/step - loss: 0.1324 - acc: 0.9775
Epoch 26/27

8/8 [==============================] - 0s 33ms/step - loss: 0.1082 - acc: 0.9775
Epoch 27/27

8/8 [==============================] - 0s 34ms/step - loss: 0.1048 - acc: 0.9888
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7053
False 2018
True percentage 0.777532796825
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.88      0.94      0.91      7318
      B-ORG       0.34      0.17      0.23       296
      I-ORG       0.15      0.40      0.22       151
     B-MISC       0.00      0.00      0.00       141
      B-LOC       1.00      0.01      0.03       218
      B-PER       0.66      0.15      0.25       438
     I-MISC       0.00      0.00      0.00       154
      I-PER       0.75      0.01      0.03       214
      I-LOC       0.00      0.00      0.00       141

avg / total       0.80      0.78      0.76      9071

F-1 Score (without O):
0.153463293239
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 100010 unique words.
Found 91 unique chars.
Found 8 unique labels.
6 unique words not found in embedding.
7 unique chars not found in embedding.
Number of OOV: 326
OOV word occurences: 639
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5888        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6400704     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,506,924
Trainable params: 6,506,924
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 2s 244ms/step - loss: 2.5052 - acc: 0.0067
Epoch 2/27

8/8 [==============================] - 0s 33ms/step - loss: 1.1960 - acc: 0.8456
Epoch 3/27

8/8 [==============================] - 0s 32ms/step - loss: 0.6469 - acc: 0.8591
Epoch 4/27

8/8 [==============================] - 0s 32ms/step - loss: 0.5991 - acc: 0.8591
Epoch 5/27

8/8 [==============================] - 0s 32ms/step - loss: 0.5637 - acc: 0.8591
Epoch 6/27

8/8 [==============================] - 0s 33ms/step - loss: 0.5024 - acc: 0.8591
Epoch 7/27

8/8 [==============================] - 0s 33ms/step - loss: 0.4928 - acc: 0.8591
Epoch 8/27

8/8 [==============================] - 0s 32ms/step - loss: 0.4675 - acc: 0.8591
Epoch 9/27

8/8 [==============================] - 0s 32ms/step - loss: 0.4441 - acc: 0.8658
Epoch 10/27

8/8 [==============================] - 0s 33ms/step - loss: 0.4437 - acc: 0.8591
Epoch 11/27

8/8 [==============================] - 0s 33ms/step - loss: 0.4014 - acc: 0.8792
Epoch 12/27

8/8 [==============================] - 0s 33ms/step - loss: 0.3701 - acc: 0.8658
Epoch 13/27

8/8 [==============================] - 0s 32ms/step - loss: 0.3384 - acc: 0.8859
Epoch 14/27

8/8 [==============================] - 0s 32ms/step - loss: 0.3182 - acc: 0.8859
Epoch 15/27

8/8 [==============================] - 0s 32ms/step - loss: 0.2948 - acc: 0.8926
Epoch 16/27

8/8 [==============================] - 0s 31ms/step - loss: 0.2656 - acc: 0.8993
Epoch 17/27

8/8 [==============================] - 0s 31ms/step - loss: 0.2537 - acc: 0.8926
Epoch 18/27

8/8 [==============================] - 0s 31ms/step - loss: 0.2413 - acc: 0.9396
Epoch 19/27

8/8 [==============================] - 0s 33ms/step - loss: 0.2218 - acc: 0.9195
Epoch 20/27

8/8 [==============================] - 0s 33ms/step - loss: 0.2252 - acc: 0.9396
Epoch 21/27

8/8 [==============================] - 0s 33ms/step - loss: 0.1976 - acc: 0.9262
Epoch 22/27

8/8 [==============================] - 0s 33ms/step - loss: 0.1756 - acc: 0.9463
Epoch 23/27

8/8 [==============================] - 0s 32ms/step - loss: 0.1731 - acc: 0.9262
Epoch 24/27

8/8 [==============================] - 0s 31ms/step - loss: 0.1545 - acc: 0.9530
Epoch 25/27

8/8 [==============================] - 0s 33ms/step - loss: 0.1490 - acc: 0.9396
Epoch 26/27

8/8 [==============================] - 0s 32ms/step - loss: 0.1399 - acc: 0.9664
Epoch 27/27

8/8 [==============================] - 0s 32ms/step - loss: 0.1246 - acc: 0.9799
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7069
False 1861
True percentage 0.791601343785
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.85      0.95      0.90      7318
      B-PER       0.83      0.08      0.14       438
      B-ORG       0.36      0.22      0.27       296
     B-MISC       0.00      0.00      0.00       141
      I-PER       1.00      0.02      0.04       214
      I-ORG       0.00      0.00      0.00       151
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.00      0.00      0.00       218

avg / total       0.77      0.79      0.75      8930

F-1 Score (without O):
0.112017400761
