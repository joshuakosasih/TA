Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105281 unique words.
5277 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738048     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,178
Trainable params: 6,850,178
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0962 - acc: 0.9674
Epoch 2/27

1674/1674 [==============================] - 48s 28ms/step - loss: 0.0483 - acc: 0.9828
Epoch 3/27

1674/1674 [==============================] - 48s 28ms/step - loss: 0.0346 - acc: 0.9881
Epoch 4/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0258 - acc: 0.9912
Epoch 5/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0195 - acc: 0.9935
Epoch 6/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0156 - acc: 0.9949
Epoch 7/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0125 - acc: 0.9961
Epoch 8/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0101 - acc: 0.9968
Epoch 9/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0083 - acc: 0.9976
Epoch 10/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0070 - acc: 0.9978
Epoch 11/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0063 - acc: 0.9980
Epoch 12/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0054 - acc: 0.9983
Epoch 13/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0046 - acc: 0.9985
Epoch 14/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0042 - acc: 0.9987
Epoch 15/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0036 - acc: 0.9989
Epoch 16/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0032 - acc: 0.9990
Epoch 17/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0028 - acc: 0.9991
Epoch 18/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0026 - acc: 0.9992
Epoch 19/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0025 - acc: 0.9992
Epoch 20/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0024 - acc: 0.9993
Epoch 21/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0019 - acc: 0.9995
Epoch 22/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0018 - acc: 0.9995
Epoch 23/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0017 - acc: 0.9995
Epoch 24/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0015 - acc: 0.9996
Epoch 25/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0014 - acc: 0.9996
Epoch 26/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0015 - acc: 0.9996
Epoch 27/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0014 - acc: 0.9996
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8238
False 833
True percentage 0.908168889869
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
      B-LOC       0.74      0.75      0.75       218
      I-LOC       0.76      0.82      0.79       141
      B-PER       0.89      0.83      0.86       438
      B-ORG       0.77      0.71      0.74       296
      I-ORG       0.65      0.60      0.63       151
     B-MISC       0.40      0.38      0.39       141
     I-MISC       0.50      0.50      0.50       154
      I-PER       0.93      0.64      0.75       214

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.716400236827
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105281 unique words.
5277 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738048     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,178
Trainable params: 6,850,178
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0895 - acc: 0.9697
Epoch 2/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0474 - acc: 0.9832
Epoch 3/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0336 - acc: 0.9883
Epoch 4/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0254 - acc: 0.9914
Epoch 5/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0198 - acc: 0.9933
Epoch 6/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0153 - acc: 0.9950
Epoch 7/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0125 - acc: 0.9960
Epoch 8/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0101 - acc: 0.9968
Epoch 9/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0084 - acc: 0.9972
Epoch 10/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0073 - acc: 0.9976
Epoch 11/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0060 - acc: 0.9981
Epoch 12/27

1674/1674 [==============================] - 48s 28ms/step - loss: 0.0050 - acc: 0.9985
Epoch 13/27

1674/1674 [==============================] - 48s 28ms/step - loss: 0.0045 - acc: 0.9985
Epoch 14/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0040 - acc: 0.9988
Epoch 15/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0036 - acc: 0.9989
Epoch 16/27

1674/1674 [==============================] - 48s 28ms/step - loss: 0.0030 - acc: 0.9991
Epoch 17/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0030 - acc: 0.9990
Epoch 18/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0026 - acc: 0.9993
Epoch 19/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0024 - acc: 0.9993
Epoch 20/27

1674/1674 [==============================] - 48s 28ms/step - loss: 0.0022 - acc: 0.9993
Epoch 21/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0021 - acc: 0.9994
Epoch 22/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0017 - acc: 0.9995
Epoch 23/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0017 - acc: 0.9995
Epoch 24/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0014 - acc: 0.9995
Epoch 25/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0015 - acc: 0.9996
Epoch 26/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0014 - acc: 0.9996
Epoch 27/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0012 - acc: 0.9996
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8251
False 820
True percentage 0.909602028442
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.90      0.85      0.87       438
      I-PER       0.92      0.65      0.76       214
          O       0.98      0.96      0.97      7318
      B-ORG       0.73      0.75      0.74       296
      I-ORG       0.64      0.58      0.61       151
      B-LOC       0.72      0.76      0.74       218
      I-LOC       0.72      0.82      0.77       141
     B-MISC       0.45      0.28      0.35       141
     I-MISC       0.55      0.44      0.49       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.928314778818
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105281 unique words.
5277 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738048     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,178
Trainable params: 6,850,178
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0886 - acc: 0.9697
Epoch 2/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0478 - acc: 0.9829
Epoch 3/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0340 - acc: 0.9883
Epoch 4/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0253 - acc: 0.9914
Epoch 5/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0194 - acc: 0.9935
Epoch 6/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0152 - acc: 0.9952
Epoch 7/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0122 - acc: 0.9961
Epoch 8/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0099 - acc: 0.9968
Epoch 9/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0081 - acc: 0.9974
Epoch 10/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0068 - acc: 0.9978
Epoch 11/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0057 - acc: 0.9982
Epoch 12/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0052 - acc: 0.9983
Epoch 13/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0044 - acc: 0.9986
Epoch 14/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0042 - acc: 0.9986
Epoch 15/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0038 - acc: 0.9989
Epoch 16/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0031 - acc: 0.9989
Epoch 17/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0030 - acc: 0.9991
Epoch 18/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0024 - acc: 0.9993
Epoch 19/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0022 - acc: 0.9994
Epoch 20/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0023 - acc: 0.9992
Epoch 21/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0019 - acc: 0.9995
Epoch 22/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0018 - acc: 0.9994
Epoch 23/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0016 - acc: 0.9996
Epoch 24/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0017 - acc: 0.9995
Epoch 25/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0012 - acc: 0.9996
Epoch 26/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0013 - acc: 0.9996
Epoch 27/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0010 - acc: 0.9997
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8211
False 860
True percentage 0.905192371293
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.89      0.84      0.86       438
      B-LOC       0.80      0.75      0.77       218
     B-MISC       0.37      0.35      0.36       141
     I-MISC       0.44      0.48      0.46       154
      B-ORG       0.74      0.70      0.72       296
      I-ORG       0.61      0.56      0.59       151
      I-LOC       0.78      0.77      0.78       141
      I-PER       0.90      0.64      0.75       214

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.70469997044
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105281 unique words.
5277 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738048     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,178
Trainable params: 6,850,178
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0909 - acc: 0.9687
Epoch 2/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0485 - acc: 0.9825
Epoch 3/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0346 - acc: 0.9877
Epoch 4/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0260 - acc: 0.9911
Epoch 5/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0199 - acc: 0.9933
Epoch 6/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0156 - acc: 0.9949
Epoch 7/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0128 - acc: 0.9958
Epoch 8/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0107 - acc: 0.9965
Epoch 9/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0087 - acc: 0.9973
Epoch 10/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0074 - acc: 0.9977
Epoch 11/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0061 - acc: 0.9981
Epoch 12/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0055 - acc: 0.9983
Epoch 13/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0045 - acc: 0.9986
Epoch 14/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0041 - acc: 0.9987
Epoch 15/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0035 - acc: 0.9989
Epoch 16/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0031 - acc: 0.9990
Epoch 17/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0029 - acc: 0.9991
Epoch 18/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0027 - acc: 0.9991
Epoch 19/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0022 - acc: 0.9993
Epoch 20/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0020 - acc: 0.9993
Epoch 21/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0019 - acc: 0.9994
Epoch 22/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0018 - acc: 0.9994
Epoch 23/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0016 - acc: 0.9996
Epoch 24/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0016 - acc: 0.9995
Epoch 25/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0013 - acc: 0.9996
Epoch 26/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0012 - acc: 0.9996
Epoch 27/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0012 - acc: 0.9996
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8242
False 829
True percentage 0.908609855584
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.76      0.72      0.74       296
      I-ORG       0.61      0.62      0.62       151
      B-PER       0.92      0.83      0.87       438
      I-PER       0.94      0.63      0.75       214
      B-LOC       0.76      0.71      0.74       218
      I-LOC       0.71      0.77      0.74       141
     B-MISC       0.42      0.33      0.37       141
     I-MISC       0.52      0.42      0.46       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.711833785005
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105281 unique words.
5277 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738048     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,178
Trainable params: 6,850,178
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0952 - acc: 0.9677
Epoch 2/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0503 - acc: 0.9819
Epoch 3/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0354 - acc: 0.9876
Epoch 4/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0265 - acc: 0.9910
Epoch 5/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0203 - acc: 0.9932
Epoch 6/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0155 - acc: 0.9949
Epoch 7/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0124 - acc: 0.9960
Epoch 8/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0103 - acc: 0.9968
Epoch 9/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0085 - acc: 0.9974
Epoch 10/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0072 - acc: 0.9976
Epoch 11/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0061 - acc: 0.9981
Epoch 12/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0051 - acc: 0.9985
Epoch 13/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0045 - acc: 0.9986
Epoch 14/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0040 - acc: 0.9988
Epoch 15/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0039 - acc: 0.9988
Epoch 16/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0031 - acc: 0.9990
Epoch 17/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0029 - acc: 0.9991
Epoch 18/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0025 - acc: 0.9993
Epoch 19/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0022 - acc: 0.9993
Epoch 20/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0021 - acc: 0.9994
Epoch 21/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0019 - acc: 0.9994
Epoch 22/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0017 - acc: 0.9995
Epoch 23/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0015 - acc: 0.9996
Epoch 24/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0016 - acc: 0.9995
Epoch 25/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0015 - acc: 0.9995
Epoch 26/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0013 - acc: 0.9997
Epoch 27/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0013 - acc: 0.9997
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8235
False 836
True percentage 0.907838165583
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
      B-ORG       0.77      0.74      0.76       296
      I-ORG       0.64      0.67      0.65       151
      B-PER       0.92      0.81      0.86       438
      I-PER       0.91      0.63      0.74       214
     B-MISC       0.37      0.39      0.38       141
     I-MISC       0.48      0.53      0.51       154
      B-LOC       0.76      0.76      0.76       218
      I-LOC       0.75      0.78      0.76       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.716295427902
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105281 unique words.
5277 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738048     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,178
Trainable params: 6,850,178
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.1021 - acc: 0.9657
Epoch 2/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0498 - acc: 0.9820
Epoch 3/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0354 - acc: 0.9877
Epoch 4/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0264 - acc: 0.9911
Epoch 5/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0203 - acc: 0.9932
Epoch 6/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0164 - acc: 0.9946
Epoch 7/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0130 - acc: 0.9959
Epoch 8/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0103 - acc: 0.9966
Epoch 9/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0087 - acc: 0.9973
Epoch 10/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0071 - acc: 0.9978
Epoch 11/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0062 - acc: 0.9981
Epoch 12/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0052 - acc: 0.9984
Epoch 13/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0044 - acc: 0.9987
Epoch 14/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0042 - acc: 0.9987
Epoch 15/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0037 - acc: 0.9989
Epoch 16/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0033 - acc: 0.9990
Epoch 17/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0030 - acc: 0.9990
Epoch 18/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0025 - acc: 0.9992
Epoch 19/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0024 - acc: 0.9993
Epoch 20/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0019 - acc: 0.9994
Epoch 21/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0021 - acc: 0.9993
Epoch 22/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0018 - acc: 0.9994
Epoch 23/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0016 - acc: 0.9995
Epoch 24/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0016 - acc: 0.9995
Epoch 25/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0014 - acc: 0.9996
Epoch 26/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0013 - acc: 0.9996
Epoch 27/27

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0013 - acc: 0.9996
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8247
False 824
True percentage 0.909161062727
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.91      0.83      0.86       438
          O       0.99      0.96      0.97      7318
      B-LOC       0.80      0.72      0.76       218
      B-ORG       0.78      0.72      0.75       296
      I-PER       0.89      0.67      0.76       214
     B-MISC       0.41      0.43      0.42       141
     I-MISC       0.50      0.51      0.50       154
      I-ORG       0.65      0.62      0.63       151
      I-LOC       0.76      0.78      0.77       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.928138426226
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105281 unique words.
5277 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738048     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,178
Trainable params: 6,850,178
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 52s 31ms/step - loss: 0.0933 - acc: 0.9681
Epoch 2/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0487 - acc: 0.9826
Epoch 3/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0352 - acc: 0.9878
Epoch 4/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0263 - acc: 0.9911
Epoch 5/27

1674/1674 [==============================] - 49s 30ms/step - loss: 0.0198 - acc: 0.9933
Epoch 6/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0159 - acc: 0.9948
Epoch 7/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0126 - acc: 0.9959
Epoch 8/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0096 - acc: 0.9970
Epoch 9/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0086 - acc: 0.9972
Epoch 10/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0071 - acc: 0.9978
Epoch 11/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0061 - acc: 0.9980
Epoch 12/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0052 - acc: 0.9984
Epoch 13/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0043 - acc: 0.9987
Epoch 14/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0039 - acc: 0.9988
Epoch 15/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0037 - acc: 0.9988
Epoch 16/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0030 - acc: 0.9991
Epoch 17/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0028 - acc: 0.9992
Epoch 18/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0025 - acc: 0.9992
Epoch 19/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0022 - acc: 0.9993
Epoch 20/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0023 - acc: 0.9993
Epoch 21/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0019 - acc: 0.9994
Epoch 22/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0019 - acc: 0.9994
Epoch 23/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0016 - acc: 0.9995
Epoch 24/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0015 - acc: 0.9996
Epoch 25/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0013 - acc: 0.9997
Epoch 26/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0011 - acc: 0.9997
Epoch 27/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0014 - acc: 0.9996
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8222
False 849
True percentage 0.906405027009
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
     B-MISC       0.41      0.31      0.35       141
      B-ORG       0.70      0.76      0.73       296
     I-MISC       0.58      0.37      0.45       154
      B-LOC       0.77      0.70      0.73       218
      I-ORG       0.56      0.66      0.60       151
      B-PER       0.89      0.83      0.86       438
      I-PER       0.89      0.65      0.75       214
      I-LOC       0.77      0.78      0.77       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.709101725164
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105281 unique words.
5277 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738048     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,178
Trainable params: 6,850,178
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 52s 31ms/step - loss: 0.1015 - acc: 0.9661
Epoch 2/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0505 - acc: 0.9819
Epoch 3/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0364 - acc: 0.9874
Epoch 4/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0270 - acc: 0.9908
Epoch 5/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0211 - acc: 0.9928
Epoch 6/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0160 - acc: 0.9948
Epoch 7/27

1674/1674 [==============================] - 51s 30ms/step - loss: 0.0130 - acc: 0.9958
Epoch 8/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0109 - acc: 0.9964
Epoch 9/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0086 - acc: 0.9973
Epoch 10/27

1674/1674 [==============================] - 51s 30ms/step - loss: 0.0073 - acc: 0.9977
Epoch 11/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0064 - acc: 0.9979
Epoch 12/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0054 - acc: 0.9982
Epoch 13/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0050 - acc: 0.9984
Epoch 14/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0040 - acc: 0.9988
Epoch 15/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0036 - acc: 0.9989
Epoch 16/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0033 - acc: 0.9989
Epoch 17/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0029 - acc: 0.9991
Epoch 18/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0028 - acc: 0.9992
Epoch 19/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0025 - acc: 0.9992
Epoch 20/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0022 - acc: 0.9994
Epoch 21/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0020 - acc: 0.9994
Epoch 22/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0019 - acc: 0.9994
Epoch 23/27

1674/1674 [==============================] - 51s 30ms/step - loss: 0.0019 - acc: 0.9995
Epoch 24/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0017 - acc: 0.9995
Epoch 25/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0015 - acc: 0.9996
Epoch 26/27

1674/1674 [==============================] - 51s 30ms/step - loss: 0.0014 - acc: 0.9996
Epoch 27/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0015 - acc: 0.9995
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8267
False 804
True percentage 0.911365891302
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.76      0.73      0.74       296
          O       0.99      0.96      0.97      7318
     B-MISC       0.43      0.35      0.39       141
     I-MISC       0.54      0.49      0.51       154
      B-LOC       0.78      0.75      0.76       218
      I-LOC       0.76      0.81      0.78       141
      B-PER       0.92      0.85      0.88       438
      I-PER       0.91      0.64      0.76       214
      I-ORG       0.60      0.67      0.64       151

avg / total       0.94      0.91      0.93      9071

F-1 Score (without O):
0.933611642605
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 8
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105281 unique words.
5277 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738048     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,178
Trainable params: 6,850,178
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 52s 31ms/step - loss: 0.1105 - acc: 0.9628
Epoch 2/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0494 - acc: 0.9825
Epoch 3/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0347 - acc: 0.9880
Epoch 4/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0261 - acc: 0.9912
Epoch 5/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0201 - acc: 0.9932
Epoch 6/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0163 - acc: 0.9947
Epoch 7/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0131 - acc: 0.9958
Epoch 8/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0108 - acc: 0.9966
Epoch 9/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0090 - acc: 0.9972
Epoch 10/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0077 - acc: 0.9975
Epoch 11/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0066 - acc: 0.9979
Epoch 12/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0057 - acc: 0.9981
Epoch 13/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0049 - acc: 0.9985
Epoch 14/27

1674/1674 [==============================] - 49s 30ms/step - loss: 0.0044 - acc: 0.9986
Epoch 15/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0038 - acc: 0.9988
Epoch 16/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0034 - acc: 0.9989
Epoch 17/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0033 - acc: 0.9989
Epoch 18/27

1674/1674 [==============================] - 49s 30ms/step - loss: 0.0029 - acc: 0.9991
Epoch 19/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0024 - acc: 0.9993
Epoch 20/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0024 - acc: 0.9993
Epoch 21/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0021 - acc: 0.9993
Epoch 22/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0020 - acc: 0.9994
Epoch 23/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0018 - acc: 0.9994
Epoch 24/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0017 - acc: 0.9995
Epoch 25/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0015 - acc: 0.9995
Epoch 26/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0014 - acc: 0.9996
Epoch 27/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0011 - acc: 0.9997
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8237
False 834
True percentage 0.90805864844
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.75      0.73      0.74       296
          O       0.98      0.96      0.97      7318
      B-LOC       0.76      0.75      0.75       218
      I-LOC       0.72      0.82      0.76       141
      I-ORG       0.67      0.54      0.60       151
      B-PER       0.90      0.82      0.86       438
      I-PER       0.89      0.64      0.75       214
     B-MISC       0.47      0.33      0.39       141
     I-MISC       0.50      0.40      0.45       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.930356625109
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 9
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105281 unique words.
5277 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738048     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,178
Trainable params: 6,850,178
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.1072 - acc: 0.9648
Epoch 2/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0501 - acc: 0.9819
Epoch 3/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0356 - acc: 0.9875
Epoch 4/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0271 - acc: 0.9908
Epoch 5/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0212 - acc: 0.9929
Epoch 6/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0167 - acc: 0.9948
Epoch 7/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0134 - acc: 0.9957
Epoch 8/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0110 - acc: 0.9965
Epoch 9/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0093 - acc: 0.9970
Epoch 10/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0079 - acc: 0.9975
Epoch 11/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0067 - acc: 0.9979
Epoch 12/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0056 - acc: 0.9981
Epoch 13/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0048 - acc: 0.9984
Epoch 14/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0044 - acc: 0.9986
Epoch 15/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0037 - acc: 0.9989
Epoch 16/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0036 - acc: 0.9989
Epoch 17/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0032 - acc: 0.9989
Epoch 18/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0026 - acc: 0.9993
Epoch 19/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0022 - acc: 0.9993
Epoch 20/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0023 - acc: 0.9993
Epoch 21/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0021 - acc: 0.9994
Epoch 22/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0019 - acc: 0.9995
Epoch 23/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0018 - acc: 0.9994
Epoch 24/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0017 - acc: 0.9995
Epoch 25/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0015 - acc: 0.9996
Epoch 26/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0014 - acc: 0.9996
Epoch 27/27

1674/1674 [==============================] - 48s 29ms/step - loss: 0.0014 - acc: 0.9996
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8235
False 836
True percentage 0.907838165583
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-LOC       0.74      0.74      0.74       218
      I-LOC       0.75      0.76      0.76       141
      B-ORG       0.78      0.72      0.75       296
      B-PER       0.91      0.82      0.86       438
      I-PER       0.91      0.65      0.76       214
      I-ORG       0.68      0.54      0.60       151
     B-MISC       0.39      0.35      0.37       141
     I-MISC       0.48      0.49      0.49       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.710005991612
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 10
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105281 unique words.
5277 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738048     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,178
Trainable params: 6,850,178
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 51s 30ms/step - loss: 0.1069 - acc: 0.9648
Epoch 2/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0546 - acc: 0.9800
Epoch 3/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0391 - acc: 0.9863
Epoch 4/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0289 - acc: 0.9901
Epoch 5/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0220 - acc: 0.9927
Epoch 6/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0170 - acc: 0.9945
Epoch 7/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0132 - acc: 0.9959
Epoch 8/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0105 - acc: 0.9967
Epoch 9/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0088 - acc: 0.9973
Epoch 10/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0074 - acc: 0.9978
Epoch 11/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0061 - acc: 0.9981
Epoch 12/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0052 - acc: 0.9984
Epoch 13/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0047 - acc: 0.9985
Epoch 14/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0043 - acc: 0.9986
Epoch 15/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0037 - acc: 0.9989
Epoch 16/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0033 - acc: 0.9990
Epoch 17/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0028 - acc: 0.9991
Epoch 18/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0024 - acc: 0.9993
Epoch 19/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0026 - acc: 0.9992
Epoch 20/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0022 - acc: 0.9994
Epoch 21/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0020 - acc: 0.9994
Epoch 22/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0017 - acc: 0.9995
Epoch 23/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0019 - acc: 0.9995
Epoch 24/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0016 - acc: 0.9995
Epoch 25/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0015 - acc: 0.9996
Epoch 26/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0014 - acc: 0.9996
Epoch 27/27

1674/1674 [==============================] - 49s 29ms/step - loss: 0.0012 - acc: 0.9996
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8263
False 808
True percentage 0.910924925587
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.97      0.97      7318
      B-ORG       0.76      0.73      0.75       296
      I-ORG       0.68      0.63      0.66       151
      B-LOC       0.78      0.71      0.74       218
      B-PER       0.89      0.83      0.86       438
      I-PER       0.90      0.64      0.75       214
     B-MISC       0.45      0.33      0.38       141
     I-MISC       0.57      0.47      0.52       154
      I-LOC       0.82      0.76      0.79       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.722913505311
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 11
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105281 unique words.
5277 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738048     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,178
Trainable params: 6,850,178
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 52s 31ms/step - loss: 0.1039 - acc: 0.9652
Epoch 2/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0514 - acc: 0.9813
Epoch 3/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0373 - acc: 0.9870
Epoch 4/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0274 - acc: 0.9904
Epoch 5/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0214 - acc: 0.9928
Epoch 6/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0166 - acc: 0.9945
Epoch 7/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0136 - acc: 0.9955
Epoch 8/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0112 - acc: 0.9964
Epoch 9/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0090 - acc: 0.9971
Epoch 10/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0081 - acc: 0.9975
Epoch 11/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0066 - acc: 0.9978
Epoch 12/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0056 - acc: 0.9983
Epoch 13/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0051 - acc: 0.9984
Epoch 14/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0042 - acc: 0.9987
Epoch 15/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0040 - acc: 0.9987
Epoch 16/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0032 - acc: 0.9990
Epoch 17/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0030 - acc: 0.9991
Epoch 18/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0027 - acc: 0.9992
Epoch 19/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0024 - acc: 0.9992
Epoch 20/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0021 - acc: 0.9994
Epoch 21/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0018 - acc: 0.9994
Epoch 22/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0017 - acc: 0.9995
Epoch 23/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0017 - acc: 0.9996
Epoch 24/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0015 - acc: 0.9996
Epoch 25/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0016 - acc: 0.9995
Epoch 26/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0014 - acc: 0.9996
Epoch 27/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0013 - acc: 0.9996
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8238
False 833
True percentage 0.908168889869
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
      B-ORG       0.74      0.74      0.74       296
      I-ORG       0.64      0.60      0.62       151
     B-MISC       0.44      0.37      0.40       141
      B-LOC       0.75      0.74      0.75       218
      B-PER       0.87      0.83      0.85       438
     I-MISC       0.56      0.45      0.50       154
      I-PER       0.86      0.67      0.76       214
      I-LOC       0.76      0.79      0.77       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.717372003551
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105281 unique words.
5277 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738048     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,178
Trainable params: 6,850,178
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

1674/1674 [==============================] - 52s 31ms/step - loss: 0.0970 - acc: 0.9672
Epoch 2/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0485 - acc: 0.9825
Epoch 3/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0345 - acc: 0.9879
Epoch 4/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0257 - acc: 0.9912
Epoch 5/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0198 - acc: 0.9934
Epoch 6/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0157 - acc: 0.9949
Epoch 7/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0127 - acc: 0.9959
Epoch 8/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0104 - acc: 0.9968
Epoch 9/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0085 - acc: 0.9974
Epoch 10/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0071 - acc: 0.9977
Epoch 11/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0059 - acc: 0.9982
Epoch 12/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0052 - acc: 0.9983
Epoch 13/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0045 - acc: 0.9986
Epoch 14/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0041 - acc: 0.9987
Epoch 15/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0035 - acc: 0.9989
Epoch 16/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0032 - acc: 0.9990
Epoch 17/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0029 - acc: 0.9992
Epoch 18/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0027 - acc: 0.9991
Epoch 19/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0022 - acc: 0.9994
Epoch 20/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0020 - acc: 0.9994
Epoch 21/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0019 - acc: 0.9994
Epoch 22/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0020 - acc: 0.9995
Epoch 23/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0017 - acc: 0.9996
Epoch 24/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0014 - acc: 0.9996
Epoch 25/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0014 - acc: 0.9996
Epoch 26/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0014 - acc: 0.9996
Epoch 27/27

1674/1674 [==============================] - 50s 30ms/step - loss: 0.0014 - acc: 0.9995
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8245
False 826
True percentage 0.90894057987
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.93      0.82      0.87       438
      B-ORG       0.73      0.74      0.73       296
     B-MISC       0.39      0.35      0.37       141
      I-PER       0.94      0.62      0.75       214
      I-ORG       0.57      0.64      0.60       151
     I-MISC       0.52      0.45      0.49       154
      B-LOC       0.80      0.74      0.77       218
      I-LOC       0.82      0.75      0.78       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.713387241689
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104747 unique words.
4743 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 246
OOV word occurences: in test 365
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6703872     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,816,002
Trainable params: 6,816,002
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 27s 32ms/step - loss: 0.1252 - acc: 0.9582
Epoch 2/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0654 - acc: 0.9767
Epoch 3/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0528 - acc: 0.9810
Epoch 4/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0422 - acc: 0.9855
Epoch 5/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0350 - acc: 0.9883
Epoch 6/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0289 - acc: 0.9905
Epoch 7/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0230 - acc: 0.9926
Epoch 8/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0195 - acc: 0.9938
Epoch 9/27

837/837 [==============================] - 25s 29ms/step - loss: 0.0162 - acc: 0.9948
Epoch 10/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0134 - acc: 0.9958
Epoch 11/27

837/837 [==============================] - 25s 29ms/step - loss: 0.0114 - acc: 0.9966
Epoch 12/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0093 - acc: 0.9971
Epoch 13/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0076 - acc: 0.9977
Epoch 14/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0066 - acc: 0.9981
Epoch 15/27

837/837 [==============================] - 25s 29ms/step - loss: 0.0059 - acc: 0.9982
Epoch 16/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0051 - acc: 0.9986
Epoch 17/27

837/837 [==============================] - 25s 29ms/step - loss: 0.0043 - acc: 0.9988
Epoch 18/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0037 - acc: 0.9990
Epoch 19/27

837/837 [==============================] - 25s 29ms/step - loss: 0.0035 - acc: 0.9990
Epoch 20/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0028 - acc: 0.9992
Epoch 21/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0029 - acc: 0.9992
Epoch 22/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0026 - acc: 0.9992
Epoch 23/27

837/837 [==============================] - 25s 29ms/step - loss: 0.0022 - acc: 0.9994
Epoch 24/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0020 - acc: 0.9995
Epoch 25/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0019 - acc: 0.9996
Epoch 26/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0019 - acc: 0.9995
Epoch 27/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0016 - acc: 0.9996
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8141
False 930
True percentage 0.897475471282
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.97      0.97      7318
      B-LOC       0.76      0.68      0.71       218
      I-LOC       0.76      0.73      0.74       141
      B-PER       0.89      0.76      0.82       438
      B-ORG       0.72      0.70      0.71       296
      I-ORG       0.65      0.54      0.59       151
     B-MISC       0.47      0.21      0.29       141
     I-MISC       0.51      0.31      0.38       154
      I-PER       0.84      0.59      0.70       214

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.677145551713
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104717 unique words.
4713 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 245
OOV word occurences: in test 381
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6701952     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,814,082
Trainable params: 6,814,082
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 26s 31ms/step - loss: 0.1309 - acc: 0.9570
Epoch 2/27

837/837 [==============================] - 24s 29ms/step - loss: 0.0654 - acc: 0.9767
Epoch 3/27

837/837 [==============================] - 24s 29ms/step - loss: 0.0525 - acc: 0.9807
Epoch 4/27

837/837 [==============================] - 24s 29ms/step - loss: 0.0432 - acc: 0.9848
Epoch 5/27

837/837 [==============================] - 25s 29ms/step - loss: 0.0359 - acc: 0.9878
Epoch 6/27

837/837 [==============================] - 25s 29ms/step - loss: 0.0291 - acc: 0.9904
Epoch 7/27

837/837 [==============================] - 24s 29ms/step - loss: 0.0245 - acc: 0.9917
Epoch 8/27

837/837 [==============================] - 25s 29ms/step - loss: 0.0202 - acc: 0.9932
Epoch 9/27

837/837 [==============================] - 25s 29ms/step - loss: 0.0162 - acc: 0.9947
Epoch 10/27

837/837 [==============================] - 25s 29ms/step - loss: 0.0140 - acc: 0.9954
Epoch 11/27

837/837 [==============================] - 25s 29ms/step - loss: 0.0114 - acc: 0.9965
Epoch 12/27

837/837 [==============================] - 25s 29ms/step - loss: 0.0098 - acc: 0.9971
Epoch 13/27

837/837 [==============================] - 25s 29ms/step - loss: 0.0080 - acc: 0.9976
Epoch 14/27

837/837 [==============================] - 25s 29ms/step - loss: 0.0067 - acc: 0.9981
Epoch 15/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0064 - acc: 0.9979
Epoch 16/27

837/837 [==============================] - 25s 29ms/step - loss: 0.0051 - acc: 0.9986
Epoch 17/27

837/837 [==============================] - 24s 29ms/step - loss: 0.0046 - acc: 0.9988
Epoch 18/27

837/837 [==============================] - 24s 29ms/step - loss: 0.0042 - acc: 0.9988
Epoch 19/27

837/837 [==============================] - 25s 29ms/step - loss: 0.0036 - acc: 0.9990
Epoch 20/27

837/837 [==============================] - 24s 29ms/step - loss: 0.0034 - acc: 0.9991
Epoch 21/27

837/837 [==============================] - 25s 29ms/step - loss: 0.0028 - acc: 0.9993
Epoch 22/27

837/837 [==============================] - 25s 29ms/step - loss: 0.0027 - acc: 0.9993
Epoch 23/27

837/837 [==============================] - 24s 29ms/step - loss: 0.0024 - acc: 0.9994
Epoch 24/27

837/837 [==============================] - 25s 29ms/step - loss: 0.0020 - acc: 0.9995
Epoch 25/27

837/837 [==============================] - 24s 29ms/step - loss: 0.0018 - acc: 0.9995
Epoch 26/27

837/837 [==============================] - 25s 29ms/step - loss: 0.0018 - acc: 0.9996
Epoch 27/27

837/837 [==============================] - 24s 29ms/step - loss: 0.0016 - acc: 0.9996
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8124
False 947
True percentage 0.895601366994
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.84      0.74      0.79       438
      I-PER       0.83      0.63      0.71       214
          O       0.98      0.96      0.97      7318
      B-ORG       0.71      0.69      0.70       296
      I-ORG       0.58      0.56      0.57       151
      B-LOC       0.71      0.76      0.73       218
      I-LOC       0.71      0.79      0.75       141
     B-MISC       0.39      0.28      0.32       141
     I-MISC       0.52      0.31      0.38       154

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.921105468289
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104716 unique words.
4712 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 247
OOV word occurences: in test 373
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6701888     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,814,018
Trainable params: 6,814,018
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 27s 32ms/step - loss: 0.1188 - acc: 0.9608
Epoch 2/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0625 - acc: 0.9779
Epoch 3/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0494 - acc: 0.9820
Epoch 4/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0406 - acc: 0.9856
Epoch 5/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0331 - acc: 0.9885
Epoch 6/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0272 - acc: 0.9907
Epoch 7/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0224 - acc: 0.9925
Epoch 8/27

837/837 [==============================] - 25s 29ms/step - loss: 0.0181 - acc: 0.9942
Epoch 9/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0157 - acc: 0.9948
Epoch 10/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0129 - acc: 0.9959
Epoch 11/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0110 - acc: 0.9964
Epoch 12/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0092 - acc: 0.9973
Epoch 13/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0078 - acc: 0.9977
Epoch 14/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0065 - acc: 0.9981
Epoch 15/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0057 - acc: 0.9983
Epoch 16/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0048 - acc: 0.9987
Epoch 17/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0039 - acc: 0.9990
Epoch 18/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0037 - acc: 0.9990
Epoch 19/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0036 - acc: 0.9989
Epoch 20/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0029 - acc: 0.9993
Epoch 21/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0025 - acc: 0.9993
Epoch 22/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0022 - acc: 0.9995
Epoch 23/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0020 - acc: 0.9996
Epoch 24/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0018 - acc: 0.9995
Epoch 25/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0018 - acc: 0.9995
Epoch 26/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0016 - acc: 0.9996
Epoch 27/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0015 - acc: 0.9996
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8103
False 968
True percentage 0.89328629699
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.86      0.73      0.79       438
      B-LOC       0.73      0.72      0.73       218
     B-MISC       0.36      0.31      0.33       141
     I-MISC       0.43      0.39      0.41       154
      B-ORG       0.71      0.72      0.72       296
      I-ORG       0.55      0.62      0.58       151
      I-LOC       0.80      0.66      0.72       141
      I-PER       0.91      0.62      0.74       214

avg / total       0.93      0.89      0.91      9071

F-1 Score (without O):
0.668065967016
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104667 unique words.
4663 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 246
OOV word occurences: in test 375
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6698752     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,810,882
Trainable params: 6,810,882
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 26s 31ms/step - loss: 0.1301 - acc: 0.9572
Epoch 2/27

837/837 [==============================] - 25s 29ms/step - loss: 0.0649 - acc: 0.9776
Epoch 3/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0515 - acc: 0.9814
Epoch 4/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0414 - acc: 0.9857
Epoch 5/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0342 - acc: 0.9882
Epoch 6/27

837/837 [==============================] - 25s 29ms/step - loss: 0.0280 - acc: 0.9905
Epoch 7/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0232 - acc: 0.9925
Epoch 8/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0189 - acc: 0.9939
Epoch 9/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0164 - acc: 0.9947
Epoch 10/27

837/837 [==============================] - 25s 29ms/step - loss: 0.0132 - acc: 0.9959
Epoch 11/27

837/837 [==============================] - 25s 29ms/step - loss: 0.0109 - acc: 0.9966
Epoch 12/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0097 - acc: 0.9970
Epoch 13/27

837/837 [==============================] - 25s 29ms/step - loss: 0.0083 - acc: 0.9976
Epoch 14/27

837/837 [==============================] - 25s 29ms/step - loss: 0.0067 - acc: 0.9979
Epoch 15/27

837/837 [==============================] - 24s 29ms/step - loss: 0.0061 - acc: 0.9982
Epoch 16/27

837/837 [==============================] - 25s 29ms/step - loss: 0.0050 - acc: 0.9986
Epoch 17/27

837/837 [==============================] - 25s 29ms/step - loss: 0.0044 - acc: 0.9987
Epoch 18/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0039 - acc: 0.9989
Epoch 19/27

837/837 [==============================] - 25s 29ms/step - loss: 0.0034 - acc: 0.9991
Epoch 20/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0034 - acc: 0.9990
Epoch 21/27

837/837 [==============================] - 25s 29ms/step - loss: 0.0028 - acc: 0.9992
Epoch 22/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0023 - acc: 0.9995
Epoch 23/27

837/837 [==============================] - 25s 29ms/step - loss: 0.0022 - acc: 0.9994
Epoch 24/27

837/837 [==============================] - 25s 29ms/step - loss: 0.0020 - acc: 0.9995
Epoch 25/27

837/837 [==============================] - 25s 29ms/step - loss: 0.0019 - acc: 0.9996
Epoch 26/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0017 - acc: 0.9996
Epoch 27/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0016 - acc: 0.9996
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8098
False 973
True percentage 0.892735089847
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.68      0.73      0.70       296
      I-ORG       0.48      0.54      0.51       151
      B-PER       0.87      0.72      0.78       438
      I-PER       0.83      0.61      0.70       214
      B-LOC       0.67      0.73      0.70       218
      I-LOC       0.70      0.76      0.73       141
     B-MISC       0.43      0.26      0.33       141
     I-MISC       0.54      0.28      0.37       154

avg / total       0.93      0.89      0.91      9071

F-1 Score (without O):
0.656419529837
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104711 unique words.
4707 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 245
OOV word occurences: in test 376
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6701568     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,813,698
Trainable params: 6,813,698
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 27s 33ms/step - loss: 0.1286 - acc: 0.9573
Epoch 2/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0630 - acc: 0.9775
Epoch 3/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0503 - acc: 0.9811
Epoch 4/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0409 - acc: 0.9851
Epoch 5/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0336 - acc: 0.9883
Epoch 6/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0274 - acc: 0.9908
Epoch 7/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0223 - acc: 0.9928
Epoch 8/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0181 - acc: 0.9943
Epoch 9/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0147 - acc: 0.9954
Epoch 10/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0122 - acc: 0.9964
Epoch 11/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0103 - acc: 0.9969
Epoch 12/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0082 - acc: 0.9976
Epoch 13/27

837/837 [==============================] - 26s 30ms/step - loss: 0.0073 - acc: 0.9978
Epoch 14/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0061 - acc: 0.9982
Epoch 15/27

837/837 [==============================] - 26s 30ms/step - loss: 0.0053 - acc: 0.9984
Epoch 16/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0046 - acc: 0.9987
Epoch 17/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0041 - acc: 0.9988
Epoch 18/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0035 - acc: 0.9990
Epoch 19/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0031 - acc: 0.9991
Epoch 20/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0029 - acc: 0.9992
Epoch 21/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0026 - acc: 0.9993
Epoch 22/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0022 - acc: 0.9994
Epoch 23/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0023 - acc: 0.9993
Epoch 24/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0017 - acc: 0.9995
Epoch 25/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0015 - acc: 0.9996
Epoch 26/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0015 - acc: 0.9996
Epoch 27/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0014 - acc: 0.9996
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8143
False 928
True percentage 0.89769595414
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.72      0.68      0.70       296
      I-ORG       0.66      0.48      0.56       151
      B-PER       0.87      0.73      0.79       438
      I-PER       0.88      0.62      0.73       214
     B-MISC       0.42      0.38      0.40       141
     I-MISC       0.51      0.44      0.47       154
      B-LOC       0.66      0.71      0.68       218
      I-LOC       0.72      0.78      0.75       141

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.672518159806
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104737 unique words.
4733 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 241
OOV word occurences: in test 342
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6703232     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,815,362
Trainable params: 6,815,362
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 26s 31ms/step - loss: 0.1210 - acc: 0.9594
Epoch 2/27

837/837 [==============================] - 24s 29ms/step - loss: 0.0599 - acc: 0.9782
Epoch 3/27

837/837 [==============================] - 24s 29ms/step - loss: 0.0476 - acc: 0.9828
Epoch 4/27

837/837 [==============================] - 24s 29ms/step - loss: 0.0389 - acc: 0.9865
Epoch 5/27

837/837 [==============================] - 24s 29ms/step - loss: 0.0315 - acc: 0.9892
Epoch 6/27

837/837 [==============================] - 24s 29ms/step - loss: 0.0257 - acc: 0.9914
Epoch 7/27

837/837 [==============================] - 24s 29ms/step - loss: 0.0219 - acc: 0.9926
Epoch 8/27

837/837 [==============================] - 24s 29ms/step - loss: 0.0175 - acc: 0.9943
Epoch 9/27

837/837 [==============================] - 24s 29ms/step - loss: 0.0147 - acc: 0.9952
Epoch 10/27

837/837 [==============================] - 24s 29ms/step - loss: 0.0119 - acc: 0.9963
Epoch 11/27

837/837 [==============================] - 24s 29ms/step - loss: 0.0101 - acc: 0.9969
Epoch 12/27

837/837 [==============================] - 24s 29ms/step - loss: 0.0084 - acc: 0.9975
Epoch 13/27

837/837 [==============================] - 24s 29ms/step - loss: 0.0071 - acc: 0.9980
Epoch 14/27

837/837 [==============================] - 24s 29ms/step - loss: 0.0059 - acc: 0.9983
Epoch 15/27

837/837 [==============================] - 24s 29ms/step - loss: 0.0054 - acc: 0.9984
Epoch 16/27

837/837 [==============================] - 24s 29ms/step - loss: 0.0049 - acc: 0.9986
Epoch 17/27

837/837 [==============================] - 24s 29ms/step - loss: 0.0042 - acc: 0.9988
Epoch 18/27

837/837 [==============================] - 24s 29ms/step - loss: 0.0035 - acc: 0.9991
Epoch 19/27

837/837 [==============================] - 24s 29ms/step - loss: 0.0035 - acc: 0.9990
Epoch 20/27

837/837 [==============================] - 24s 29ms/step - loss: 0.0027 - acc: 0.9993
Epoch 21/27

837/837 [==============================] - 24s 29ms/step - loss: 0.0026 - acc: 0.9993
Epoch 22/27

837/837 [==============================] - 24s 29ms/step - loss: 0.0024 - acc: 0.9994
Epoch 23/27

837/837 [==============================] - 24s 29ms/step - loss: 0.0021 - acc: 0.9994
Epoch 24/27

837/837 [==============================] - 24s 29ms/step - loss: 0.0020 - acc: 0.9995
Epoch 25/27

837/837 [==============================] - 24s 29ms/step - loss: 0.0020 - acc: 0.9995
Epoch 26/27

837/837 [==============================] - 24s 29ms/step - loss: 0.0020 - acc: 0.9995
Epoch 27/27

837/837 [==============================] - 25s 29ms/step - loss: 0.0015 - acc: 0.9997
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8154
False 917
True percentage 0.898908609856
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.87      0.82      0.84       438
          O       0.99      0.96      0.97      7318
      B-LOC       0.69      0.74      0.71       218
      B-ORG       0.71      0.70      0.71       296
      I-PER       0.90      0.64      0.75       214
     B-MISC       0.42      0.23      0.30       141
     I-MISC       0.60      0.32      0.42       154
      I-ORG       0.51      0.58      0.54       151
      I-LOC       0.56      0.82      0.67       141

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.919837196956
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104708 unique words.
4704 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 244
OOV word occurences: in test 354
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6701376     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,813,506
Trainable params: 6,813,506
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 28s 33ms/step - loss: 0.1416 - acc: 0.9533
Epoch 2/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0655 - acc: 0.9765
Epoch 3/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0520 - acc: 0.9814
Epoch 4/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0425 - acc: 0.9851
Epoch 5/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0349 - acc: 0.9875
Epoch 6/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0299 - acc: 0.9895
Epoch 7/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0249 - acc: 0.9914
Epoch 8/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0209 - acc: 0.9929
Epoch 9/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0176 - acc: 0.9943
Epoch 10/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0145 - acc: 0.9953
Epoch 11/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0126 - acc: 0.9960
Epoch 12/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0104 - acc: 0.9969
Epoch 13/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0090 - acc: 0.9972
Epoch 14/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0078 - acc: 0.9976
Epoch 15/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0066 - acc: 0.9981
Epoch 16/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0059 - acc: 0.9982
Epoch 17/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0051 - acc: 0.9986
Epoch 18/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0045 - acc: 0.9987
Epoch 19/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0040 - acc: 0.9989
Epoch 20/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0035 - acc: 0.9991
Epoch 21/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0032 - acc: 0.9990
Epoch 22/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0029 - acc: 0.9992
Epoch 23/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0025 - acc: 0.9994
Epoch 24/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0022 - acc: 0.9994
Epoch 25/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0019 - acc: 0.9995
Epoch 26/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0018 - acc: 0.9995
Epoch 27/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0018 - acc: 0.9996
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8162
False 909
True percentage 0.899790541285
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
     B-MISC       0.45      0.28      0.35       141
      B-ORG       0.71      0.71      0.71       296
     I-MISC       0.50      0.39      0.44       154
      B-LOC       0.74      0.74      0.74       218
      I-ORG       0.56      0.53      0.55       151
      B-PER       0.88      0.84      0.86       438
      I-PER       0.86      0.62      0.72       214
      I-LOC       0.75      0.72      0.73       141

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.693718064322
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104733 unique words.
4729 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 245
OOV word occurences: in test 354
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6702976     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,815,106
Trainable params: 6,815,106
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 28s 33ms/step - loss: 0.1553 - acc: 0.9510
Epoch 2/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0697 - acc: 0.9760
Epoch 3/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0559 - acc: 0.9792
Epoch 4/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0466 - acc: 0.9832
Epoch 5/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0375 - acc: 0.9871
Epoch 6/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0303 - acc: 0.9896
Epoch 7/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0252 - acc: 0.9917
Epoch 8/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0200 - acc: 0.9937
Epoch 9/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0170 - acc: 0.9947
Epoch 10/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0142 - acc: 0.9957
Epoch 11/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0114 - acc: 0.9966
Epoch 12/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0097 - acc: 0.9971
Epoch 13/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0086 - acc: 0.9974
Epoch 14/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0072 - acc: 0.9979
Epoch 15/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0060 - acc: 0.9983
Epoch 16/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0055 - acc: 0.9983
Epoch 17/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0048 - acc: 0.9985
Epoch 18/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0043 - acc: 0.9987
Epoch 19/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0040 - acc: 0.9988
Epoch 20/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0032 - acc: 0.9991
Epoch 21/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0031 - acc: 0.9991
Epoch 22/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0028 - acc: 0.9992
Epoch 23/27

837/837 [==============================] - 26s 32ms/step - loss: 0.0027 - acc: 0.9992
Epoch 24/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0020 - acc: 0.9995
Epoch 25/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0022 - acc: 0.9993
Epoch 26/27

837/837 [==============================] - 26s 32ms/step - loss: 0.0019 - acc: 0.9995
Epoch 27/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0017 - acc: 0.9996
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8154
False 917
True percentage 0.898908609856
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.76      0.67      0.71       296
          O       0.98      0.96      0.97      7318
     B-MISC       0.44      0.37      0.40       141
     I-MISC       0.51      0.34      0.41       154
      B-LOC       0.68      0.73      0.71       218
      I-LOC       0.70      0.77      0.73       141
      B-PER       0.89      0.77      0.83       438
      I-PER       0.90      0.64      0.75       214
      I-ORG       0.60      0.48      0.53       151

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.923443032097
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 8
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104748 unique words.
4744 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 246
OOV word occurences: in test 375
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6703936     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,816,066
Trainable params: 6,816,066
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 27s 32ms/step - loss: 0.1313 - acc: 0.9576
Epoch 2/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0646 - acc: 0.9771
Epoch 3/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0521 - acc: 0.9807
Epoch 4/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0422 - acc: 0.9852
Epoch 5/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0337 - acc: 0.9882
Epoch 6/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0281 - acc: 0.9902
Epoch 7/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0227 - acc: 0.9926
Epoch 8/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0184 - acc: 0.9942
Epoch 9/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0156 - acc: 0.9952
Epoch 10/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0124 - acc: 0.9963
Epoch 11/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0104 - acc: 0.9969
Epoch 12/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0090 - acc: 0.9974
Epoch 13/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0073 - acc: 0.9980
Epoch 14/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0066 - acc: 0.9981
Epoch 15/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0056 - acc: 0.9984
Epoch 16/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0048 - acc: 0.9987
Epoch 17/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0042 - acc: 0.9988
Epoch 18/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0036 - acc: 0.9989
Epoch 19/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0032 - acc: 0.9990
Epoch 20/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0027 - acc: 0.9994
Epoch 21/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0026 - acc: 0.9993
Epoch 22/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0022 - acc: 0.9995
Epoch 23/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0021 - acc: 0.9995
Epoch 24/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0018 - acc: 0.9996
Epoch 25/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0016 - acc: 0.9997
Epoch 26/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0014 - acc: 0.9997
Epoch 27/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0014 - acc: 0.9997
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8088
False 983
True percentage 0.891632675559
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.68      0.70      0.69       296
          O       0.98      0.96      0.97      7318
      B-LOC       0.66      0.71      0.68       218
      I-LOC       0.65      0.78      0.71       141
      I-ORG       0.55      0.52      0.53       151
      B-PER       0.87      0.71      0.78       438
      I-PER       0.92      0.63      0.74       214
     B-MISC       0.30      0.18      0.23       141
     I-MISC       0.51      0.24      0.33       154

avg / total       0.92      0.89      0.91      9071

F-1 Score (without O):
0.918273431584
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 9
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104743 unique words.
4739 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 248
OOV word occurences: in test 357
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6703616     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,815,746
Trainable params: 6,815,746
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 28s 33ms/step - loss: 0.1147 - acc: 0.9620
Epoch 2/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0632 - acc: 0.9775
Epoch 3/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0504 - acc: 0.9817
Epoch 4/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0405 - acc: 0.9854
Epoch 5/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0324 - acc: 0.9886
Epoch 6/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0263 - acc: 0.9911
Epoch 7/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0215 - acc: 0.9929
Epoch 8/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0177 - acc: 0.9942
Epoch 9/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0142 - acc: 0.9957
Epoch 10/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0120 - acc: 0.9963
Epoch 11/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0101 - acc: 0.9969
Epoch 12/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0084 - acc: 0.9975
Epoch 13/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0075 - acc: 0.9978
Epoch 14/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0061 - acc: 0.9981
Epoch 15/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0053 - acc: 0.9985
Epoch 16/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0046 - acc: 0.9986
Epoch 17/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0041 - acc: 0.9988
Epoch 18/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0038 - acc: 0.9989
Epoch 19/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0033 - acc: 0.9990
Epoch 20/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0028 - acc: 0.9992
Epoch 21/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0027 - acc: 0.9991
Epoch 22/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0024 - acc: 0.9993
Epoch 23/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0025 - acc: 0.9993
Epoch 24/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0019 - acc: 0.9995
Epoch 25/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0019 - acc: 0.9995
Epoch 26/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0015 - acc: 0.9997
Epoch 27/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0016 - acc: 0.9996
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8173
False 898
True percentage 0.901003197001
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-LOC       0.79      0.72      0.75       218
      I-LOC       0.81      0.78      0.80       141
      B-ORG       0.72      0.76      0.74       296
      B-PER       0.89      0.78      0.83       438
      I-PER       0.87      0.61      0.72       214
      I-ORG       0.59      0.53      0.56       151
     B-MISC       0.42      0.31      0.36       141
     I-MISC       0.45      0.52      0.48       154

avg / total       0.94      0.90      0.92      9071

F-1 Score (without O):
0.697674418605
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 10
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104721 unique words.
4717 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 250
OOV word occurences: in test 360
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6702208     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,814,338
Trainable params: 6,814,338
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 27s 33ms/step - loss: 0.1270 - acc: 0.9588
Epoch 2/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0643 - acc: 0.9772
Epoch 3/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0520 - acc: 0.9805
Epoch 4/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0423 - acc: 0.9846
Epoch 5/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0347 - acc: 0.9880
Epoch 6/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0287 - acc: 0.9902
Epoch 7/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0236 - acc: 0.9921
Epoch 8/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0189 - acc: 0.9939
Epoch 9/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0157 - acc: 0.9951
Epoch 10/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0129 - acc: 0.9961
Epoch 11/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0108 - acc: 0.9967
Epoch 12/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0090 - acc: 0.9974
Epoch 13/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0074 - acc: 0.9979
Epoch 14/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0063 - acc: 0.9982
Epoch 15/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0057 - acc: 0.9983
Epoch 16/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0049 - acc: 0.9985
Epoch 17/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0043 - acc: 0.9988
Epoch 18/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0035 - acc: 0.9991
Epoch 19/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0033 - acc: 0.9990
Epoch 20/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0028 - acc: 0.9993
Epoch 21/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0027 - acc: 0.9992
Epoch 22/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0025 - acc: 0.9993
Epoch 23/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0022 - acc: 0.9993
Epoch 24/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0018 - acc: 0.9995
Epoch 25/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0017 - acc: 0.9996
Epoch 26/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0016 - acc: 0.9996
Epoch 27/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0013 - acc: 0.9997
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8184
False 887
True percentage 0.902215852717
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.72      0.73      0.73       296
      I-ORG       0.69      0.58      0.63       151
      B-LOC       0.71      0.72      0.71       218
      B-PER       0.92      0.77      0.84       438
      I-PER       0.87      0.63      0.73       214
     B-MISC       0.41      0.25      0.31       141
     I-MISC       0.46      0.41      0.43       154
      I-LOC       0.72      0.74      0.73       141

avg / total       0.94      0.90      0.92      9071

F-1 Score (without O):
0.690533980583
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 11
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104746 unique words.
4742 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 253
OOV word occurences: in test 357
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6703808     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,815,938
Trainable params: 6,815,938
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 27s 32ms/step - loss: 0.1267 - acc: 0.9592
Epoch 2/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0640 - acc: 0.9769
Epoch 3/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0519 - acc: 0.9810
Epoch 4/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0421 - acc: 0.9855
Epoch 5/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0337 - acc: 0.9884
Epoch 6/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0278 - acc: 0.9907
Epoch 7/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0230 - acc: 0.9925
Epoch 8/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0186 - acc: 0.9940
Epoch 9/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0152 - acc: 0.9952
Epoch 10/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0128 - acc: 0.9959
Epoch 11/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0107 - acc: 0.9967
Epoch 12/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0090 - acc: 0.9973
Epoch 13/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0075 - acc: 0.9978
Epoch 14/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0069 - acc: 0.9979
Epoch 15/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0061 - acc: 0.9982
Epoch 16/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0050 - acc: 0.9986
Epoch 17/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0043 - acc: 0.9988
Epoch 18/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0042 - acc: 0.9986
Epoch 19/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0038 - acc: 0.9988
Epoch 20/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0029 - acc: 0.9992
Epoch 21/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0027 - acc: 0.9991
Epoch 22/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0026 - acc: 0.9993
Epoch 23/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0022 - acc: 0.9994
Epoch 24/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0018 - acc: 0.9995
Epoch 25/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0019 - acc: 0.9995
Epoch 26/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0017 - acc: 0.9996
Epoch 27/27

837/837 [==============================] - 25s 30ms/step - loss: 0.0019 - acc: 0.9994
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8159
False 912
True percentage 0.899459816999
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.69      0.73      0.71       296
      I-ORG       0.62      0.63      0.63       151
     B-MISC       0.38      0.29      0.33       141
      B-LOC       0.74      0.72      0.73       218
      B-PER       0.89      0.80      0.84       438
     I-MISC       0.47      0.39      0.43       154
      I-PER       0.89      0.59      0.71       214
      I-LOC       0.72      0.77      0.75       141

avg / total       0.93      0.90      0.92      9071

F-1 Score (without O):
0.688935281837
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104694 unique words.
4690 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 246
OOV word occurences: in test 382
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6700480     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,812,610
Trainable params: 6,812,610
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

837/837 [==============================] - 28s 33ms/step - loss: 0.1415 - acc: 0.9545
Epoch 2/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0629 - acc: 0.9777
Epoch 3/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0500 - acc: 0.9819
Epoch 4/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0405 - acc: 0.9858
Epoch 5/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0335 - acc: 0.9885
Epoch 6/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0274 - acc: 0.9907
Epoch 7/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0224 - acc: 0.9927
Epoch 8/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0186 - acc: 0.9939
Epoch 9/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0160 - acc: 0.9949
Epoch 10/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0132 - acc: 0.9959
Epoch 11/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0112 - acc: 0.9964
Epoch 12/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0095 - acc: 0.9972
Epoch 13/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0080 - acc: 0.9977
Epoch 14/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0071 - acc: 0.9980
Epoch 15/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0061 - acc: 0.9982
Epoch 16/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0052 - acc: 0.9986
Epoch 17/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0048 - acc: 0.9986
Epoch 18/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0042 - acc: 0.9988
Epoch 19/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0037 - acc: 0.9990
Epoch 20/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0035 - acc: 0.9991
Epoch 21/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0032 - acc: 0.9991
Epoch 22/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0029 - acc: 0.9992
Epoch 23/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0031 - acc: 0.9992
Epoch 24/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0024 - acc: 0.9994
Epoch 25/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0020 - acc: 0.9995
Epoch 26/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0018 - acc: 0.9995
Epoch 27/27

837/837 [==============================] - 26s 31ms/step - loss: 0.0021 - acc: 0.9994
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8092
False 979
True percentage 0.892073641274
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.95      0.97      7318
      B-PER       0.84      0.74      0.79       438
      B-ORG       0.68      0.69      0.68       296
     B-MISC       0.40      0.30      0.35       141
      I-PER       0.89      0.62      0.73       214
      I-ORG       0.51      0.52      0.51       151
     I-MISC       0.54      0.43      0.48       154
      B-LOC       0.72      0.75      0.74       218
      I-LOC       0.64      0.77      0.70       141

avg / total       0.93      0.89      0.91      9071

F-1 Score (without O):
0.665874665875
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104337 unique words.
4333 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 264
OOV word occurences: in test 412
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6677632     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,789,762
Trainable params: 6,789,762
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 12s 36ms/step - loss: 0.1972 - acc: 0.9364
Epoch 2/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0931 - acc: 0.9715
Epoch 3/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0721 - acc: 0.9756
Epoch 4/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0626 - acc: 0.9774
Epoch 5/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0568 - acc: 0.9794
Epoch 6/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0507 - acc: 0.9813
Epoch 7/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0461 - acc: 0.9832
Epoch 8/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0407 - acc: 0.9855
Epoch 9/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0364 - acc: 0.9872
Epoch 10/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0324 - acc: 0.9888
Epoch 11/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0289 - acc: 0.9901
Epoch 12/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0262 - acc: 0.9913
Epoch 13/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0224 - acc: 0.9923
Epoch 14/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0201 - acc: 0.9934
Epoch 15/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0186 - acc: 0.9941
Epoch 16/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0170 - acc: 0.9948
Epoch 17/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0143 - acc: 0.9957
Epoch 18/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0128 - acc: 0.9963
Epoch 19/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0113 - acc: 0.9969
Epoch 20/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0092 - acc: 0.9976
Epoch 21/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0089 - acc: 0.9977
Epoch 22/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0076 - acc: 0.9980
Epoch 23/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0065 - acc: 0.9986
Epoch 24/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0059 - acc: 0.9986
Epoch 25/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0053 - acc: 0.9987
Epoch 26/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0048 - acc: 0.9991
Epoch 27/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0043 - acc: 0.9991
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8003
False 1068
True percentage 0.882262154118
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.97      7318
      B-LOC       0.65      0.67      0.66       218
      I-LOC       0.69      0.73      0.71       141
      B-PER       0.89      0.73      0.80       438
      B-ORG       0.62      0.69      0.66       296
      I-ORG       0.50      0.44      0.47       151
     B-MISC       0.39      0.24      0.30       141
     I-MISC       0.38      0.39      0.39       154
      I-PER       0.86      0.54      0.66       214

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.630722891566
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104342 unique words.
4338 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 258
OOV word occurences: in test 418
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6677952     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,082
Trainable params: 6,790,082
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 12s 35ms/step - loss: 0.1861 - acc: 0.9372
Epoch 2/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0828 - acc: 0.9741
Epoch 3/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0687 - acc: 0.9764
Epoch 4/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0619 - acc: 0.9780
Epoch 5/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0564 - acc: 0.9789
Epoch 6/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0519 - acc: 0.9803
Epoch 7/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0467 - acc: 0.9830
Epoch 8/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0422 - acc: 0.9850
Epoch 9/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0380 - acc: 0.9868
Epoch 10/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0336 - acc: 0.9881
Epoch 11/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0305 - acc: 0.9896
Epoch 12/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0264 - acc: 0.9910
Epoch 13/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0239 - acc: 0.9918
Epoch 14/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0212 - acc: 0.9928
Epoch 15/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0189 - acc: 0.9939
Epoch 16/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0163 - acc: 0.9951
Epoch 17/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0142 - acc: 0.9957
Epoch 18/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0124 - acc: 0.9963
Epoch 19/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0106 - acc: 0.9970
Epoch 20/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0094 - acc: 0.9975
Epoch 21/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0085 - acc: 0.9979
Epoch 22/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0071 - acc: 0.9982
Epoch 23/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0064 - acc: 0.9986
Epoch 24/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0058 - acc: 0.9988
Epoch 25/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0050 - acc: 0.9988
Epoch 26/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0043 - acc: 0.9990
Epoch 27/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0036 - acc: 0.9995
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7958
False 1113
True percentage 0.877301289825
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.81      0.69      0.74       438
      I-PER       0.85      0.56      0.67       214
          O       0.98      0.96      0.97      7318
      B-ORG       0.70      0.53      0.60       296
      I-ORG       0.53      0.42      0.47       151
      B-LOC       0.64      0.65      0.64       218
      I-LOC       0.54      0.66      0.60       141
     B-MISC       0.29      0.27      0.28       141
     I-MISC       0.35      0.23      0.28       154

avg / total       0.91      0.88      0.89      9071

F-1 Score (without O):
0.905339088275
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104334 unique words.
4330 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 260
OOV word occurences: in test 400
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6677440     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,789,570
Trainable params: 6,789,570
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 12s 36ms/step - loss: 0.1966 - acc: 0.9326
Epoch 2/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0872 - acc: 0.9723
Epoch 3/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0672 - acc: 0.9766
Epoch 4/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0599 - acc: 0.9779
Epoch 5/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0541 - acc: 0.9797
Epoch 6/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0481 - acc: 0.9816
Epoch 7/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0432 - acc: 0.9840
Epoch 8/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0386 - acc: 0.9860
Epoch 9/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0337 - acc: 0.9879
Epoch 10/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0298 - acc: 0.9892
Epoch 11/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0267 - acc: 0.9910
Epoch 12/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0237 - acc: 0.9924
Epoch 13/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0196 - acc: 0.9937
Epoch 14/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0176 - acc: 0.9949
Epoch 15/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0152 - acc: 0.9956
Epoch 16/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0136 - acc: 0.9960
Epoch 17/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0120 - acc: 0.9966
Epoch 18/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0103 - acc: 0.9972
Epoch 19/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0092 - acc: 0.9978
Epoch 20/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0084 - acc: 0.9977
Epoch 21/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0076 - acc: 0.9978
Epoch 22/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0063 - acc: 0.9985
Epoch 23/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0056 - acc: 0.9986
Epoch 24/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0051 - acc: 0.9988
Epoch 25/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0050 - acc: 0.9988
Epoch 26/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0046 - acc: 0.9988
Epoch 27/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0037 - acc: 0.9992
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8034
False 1037
True percentage 0.885679638408
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.97      7318
      B-PER       0.83      0.71      0.77       438
      B-LOC       0.68      0.72      0.70       218
     B-MISC       0.45      0.40      0.42       141
     I-MISC       0.41      0.38      0.39       154
      B-ORG       0.67      0.65      0.66       296
      I-ORG       0.47      0.48      0.48       151
      I-LOC       0.76      0.69      0.72       141
      I-PER       0.87      0.58      0.69       214

avg / total       0.93      0.89      0.90      9071

F-1 Score (without O):
0.641871625675
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104345 unique words.
4341 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 259
OOV word occurences: in test 420
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678144     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,274
Trainable params: 6,790,274
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 12s 36ms/step - loss: 0.1736 - acc: 0.9408
Epoch 2/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0792 - acc: 0.9739
Epoch 3/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0647 - acc: 0.9772
Epoch 4/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0577 - acc: 0.9786
Epoch 5/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0508 - acc: 0.9810
Epoch 6/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0451 - acc: 0.9831
Epoch 7/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0407 - acc: 0.9853
Epoch 8/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0367 - acc: 0.9871
Epoch 9/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0316 - acc: 0.9892
Epoch 10/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0285 - acc: 0.9899
Epoch 11/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0253 - acc: 0.9914
Epoch 12/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0221 - acc: 0.9927
Epoch 13/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0193 - acc: 0.9939
Epoch 14/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0171 - acc: 0.9951
Epoch 15/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0145 - acc: 0.9958
Epoch 16/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0127 - acc: 0.9962
Epoch 17/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0114 - acc: 0.9967
Epoch 18/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0098 - acc: 0.9975
Epoch 19/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0089 - acc: 0.9977
Epoch 20/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0076 - acc: 0.9981
Epoch 21/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0065 - acc: 0.9985
Epoch 22/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0061 - acc: 0.9985
Epoch 23/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0056 - acc: 0.9987
Epoch 24/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0047 - acc: 0.9988
Epoch 25/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0044 - acc: 0.9990
Epoch 26/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0040 - acc: 0.9991
Epoch 27/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0034 - acc: 0.9992
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7962
False 1109
True percentage 0.87774225554
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-ORG       0.67      0.65      0.66       296
      I-ORG       0.47      0.52      0.50       151
      B-PER       0.83      0.66      0.73       438
      I-PER       0.78      0.58      0.67       214
      B-LOC       0.70      0.70      0.70       218
      I-LOC       0.71      0.68      0.69       141
     B-MISC       0.30      0.26      0.27       141
     I-MISC       0.38      0.28      0.32       154

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.612356147789
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104348 unique words.
4344 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 261
OOV word occurences: in test 401
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678336     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,466
Trainable params: 6,790,466
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 12s 35ms/step - loss: 0.2348 - acc: 0.9237
Epoch 2/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0899 - acc: 0.9709
Epoch 3/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0700 - acc: 0.9761
Epoch 4/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0625 - acc: 0.9780
Epoch 5/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0568 - acc: 0.9791
Epoch 6/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0516 - acc: 0.9804
Epoch 7/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0479 - acc: 0.9820
Epoch 8/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0429 - acc: 0.9844
Epoch 9/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0384 - acc: 0.9860
Epoch 10/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0359 - acc: 0.9871
Epoch 11/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0324 - acc: 0.9886
Epoch 12/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0292 - acc: 0.9898
Epoch 13/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0263 - acc: 0.9909
Epoch 14/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0240 - acc: 0.9920
Epoch 15/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0216 - acc: 0.9930
Epoch 16/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0197 - acc: 0.9938
Epoch 17/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0168 - acc: 0.9947
Epoch 18/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0153 - acc: 0.9958
Epoch 19/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0132 - acc: 0.9966
Epoch 20/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0117 - acc: 0.9969
Epoch 21/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0101 - acc: 0.9974
Epoch 22/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0096 - acc: 0.9975
Epoch 23/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0082 - acc: 0.9978
Epoch 24/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0076 - acc: 0.9979
Epoch 25/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0063 - acc: 0.9985
Epoch 26/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0058 - acc: 0.9987
Epoch 27/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0054 - acc: 0.9987
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8010
False 1061
True percentage 0.883033844119
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.67      0.68      0.67       296
      I-ORG       0.46      0.49      0.48       151
      B-PER       0.84      0.68      0.75       438
      I-PER       0.82      0.55      0.66       214
     B-MISC       0.31      0.20      0.24       141
     I-MISC       0.44      0.30      0.36       154
      B-LOC       0.66      0.67      0.66       218
      I-LOC       0.77      0.63      0.70       141

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.616476396174
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104335 unique words.
4331 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 262
OOV word occurences: in test 415
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6677504     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,789,634
Trainable params: 6,789,634
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 12s 36ms/step - loss: 0.2164 - acc: 0.9280
Epoch 2/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0894 - acc: 0.9705
Epoch 3/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0715 - acc: 0.9753
Epoch 4/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0625 - acc: 0.9777
Epoch 5/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0567 - acc: 0.9792
Epoch 6/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0504 - acc: 0.9815
Epoch 7/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0444 - acc: 0.9838
Epoch 8/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0403 - acc: 0.9856
Epoch 9/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0354 - acc: 0.9874
Epoch 10/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0325 - acc: 0.9888
Epoch 11/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0279 - acc: 0.9903
Epoch 12/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0248 - acc: 0.9918
Epoch 13/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0220 - acc: 0.9929
Epoch 14/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0202 - acc: 0.9938
Epoch 15/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0164 - acc: 0.9948
Epoch 16/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0152 - acc: 0.9954
Epoch 17/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0132 - acc: 0.9963
Epoch 18/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0114 - acc: 0.9968
Epoch 19/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0101 - acc: 0.9972
Epoch 20/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0089 - acc: 0.9977
Epoch 21/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0084 - acc: 0.9979
Epoch 22/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0072 - acc: 0.9981
Epoch 23/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0061 - acc: 0.9986
Epoch 24/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0057 - acc: 0.9986
Epoch 25/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0047 - acc: 0.9989
Epoch 26/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0048 - acc: 0.9989
Epoch 27/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0042 - acc: 0.9990
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7986
False 1085
True percentage 0.880388049829
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.83      0.68      0.75       438
          O       0.99      0.95      0.97      7318
      B-LOC       0.67      0.71      0.69       218
      B-ORG       0.65      0.70      0.67       296
      I-PER       0.84      0.55      0.66       214
     B-MISC       0.39      0.31      0.35       141
     I-MISC       0.36      0.18      0.23       154
      I-ORG       0.38      0.60      0.46       151
      I-LOC       0.72      0.72      0.72       141

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.908263925808
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104344 unique words.
4340 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 260
OOV word occurences: in test 388
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678080     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,210
Trainable params: 6,790,210
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 12s 35ms/step - loss: 0.2283 - acc: 0.9197
Epoch 2/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0912 - acc: 0.9707
Epoch 3/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0714 - acc: 0.9751
Epoch 4/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0633 - acc: 0.9770
Epoch 5/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0567 - acc: 0.9787
Epoch 6/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0523 - acc: 0.9802
Epoch 7/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0470 - acc: 0.9823
Epoch 8/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0418 - acc: 0.9850
Epoch 9/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0368 - acc: 0.9868
Epoch 10/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0323 - acc: 0.9887
Epoch 11/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0287 - acc: 0.9900
Epoch 12/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0261 - acc: 0.9908
Epoch 13/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0225 - acc: 0.9926
Epoch 14/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0202 - acc: 0.9937
Epoch 15/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0177 - acc: 0.9945
Epoch 16/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0152 - acc: 0.9953
Epoch 17/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0137 - acc: 0.9959
Epoch 18/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0121 - acc: 0.9969
Epoch 19/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0099 - acc: 0.9976
Epoch 20/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0089 - acc: 0.9977
Epoch 21/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0083 - acc: 0.9978
Epoch 22/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0076 - acc: 0.9981
Epoch 23/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0066 - acc: 0.9985
Epoch 24/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0055 - acc: 0.9988
Epoch 25/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0049 - acc: 0.9989
Epoch 26/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0046 - acc: 0.9990
Epoch 27/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0038 - acc: 0.9992
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8008
False 1063
True percentage 0.882813361261
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.97      7318
     B-MISC       0.32      0.26      0.29       141
      B-ORG       0.63      0.65      0.64       296
     I-MISC       0.41      0.41      0.41       154
      B-LOC       0.70      0.70      0.70       218
      I-ORG       0.45      0.39      0.42       151
      B-PER       0.88      0.76      0.81       438
      I-PER       0.80      0.59      0.68       214
      I-LOC       0.67      0.65      0.66       141

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.628622647147
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104316 unique words.
4312 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 265
OOV word occurences: in test 448
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6676288     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,788,418
Trainable params: 6,788,418
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 12s 35ms/step - loss: 0.2040 - acc: 0.9326
Epoch 2/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0854 - acc: 0.9728
Epoch 3/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0689 - acc: 0.9761
Epoch 4/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0606 - acc: 0.9780
Epoch 5/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0542 - acc: 0.9798
Epoch 6/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0482 - acc: 0.9818
Epoch 7/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0438 - acc: 0.9844
Epoch 8/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0386 - acc: 0.9860
Epoch 9/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0345 - acc: 0.9881
Epoch 10/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0306 - acc: 0.9895
Epoch 11/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0277 - acc: 0.9906
Epoch 12/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0235 - acc: 0.9926
Epoch 13/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0212 - acc: 0.9935
Epoch 14/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0190 - acc: 0.9943
Epoch 15/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0159 - acc: 0.9956
Epoch 16/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0146 - acc: 0.9960
Epoch 17/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0124 - acc: 0.9968
Epoch 18/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0108 - acc: 0.9971
Epoch 19/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0102 - acc: 0.9972
Epoch 20/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0090 - acc: 0.9976
Epoch 21/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0082 - acc: 0.9978
Epoch 22/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0070 - acc: 0.9982
Epoch 23/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0065 - acc: 0.9981
Epoch 24/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0057 - acc: 0.9985
Epoch 25/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0053 - acc: 0.9985
Epoch 26/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0050 - acc: 0.9986
Epoch 27/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0044 - acc: 0.9989
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7967
False 1104
True percentage 0.878293462683
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.72      0.57      0.64       296
          O       0.97      0.96      0.96      7318
     B-MISC       0.28      0.22      0.25       141
     I-MISC       0.37      0.35      0.36       154
      B-LOC       0.64      0.71      0.67       218
      I-LOC       0.77      0.67      0.72       141
      B-PER       0.84      0.66      0.74       438
      I-PER       0.85      0.59      0.70       214
      I-ORG       0.59      0.36      0.45       151

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.908709583455
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 8
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104347 unique words.
4343 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 261
OOV word occurences: in test 419
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678272     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,402
Trainable params: 6,790,402
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 12s 36ms/step - loss: 0.1865 - acc: 0.9349
Epoch 2/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0901 - acc: 0.9705
Epoch 3/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0706 - acc: 0.9754
Epoch 4/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0624 - acc: 0.9769
Epoch 5/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0558 - acc: 0.9789
Epoch 6/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0500 - acc: 0.9818
Epoch 7/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0441 - acc: 0.9844
Epoch 8/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0392 - acc: 0.9866
Epoch 9/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0342 - acc: 0.9885
Epoch 10/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0300 - acc: 0.9901
Epoch 11/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0267 - acc: 0.9913
Epoch 12/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0231 - acc: 0.9925
Epoch 13/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0202 - acc: 0.9932
Epoch 14/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0179 - acc: 0.9943
Epoch 15/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0164 - acc: 0.9948
Epoch 16/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0129 - acc: 0.9961
Epoch 17/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0116 - acc: 0.9967
Epoch 18/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0098 - acc: 0.9975
Epoch 19/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0086 - acc: 0.9978
Epoch 20/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0081 - acc: 0.9978
Epoch 21/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0065 - acc: 0.9984
Epoch 22/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0062 - acc: 0.9985
Epoch 23/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0055 - acc: 0.9986
Epoch 24/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0047 - acc: 0.9989
Epoch 25/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0042 - acc: 0.9990
Epoch 26/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0037 - acc: 0.9992
Epoch 27/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0036 - acc: 0.9993
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7939
False 1132
True percentage 0.875206702679
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.63      0.66      0.64       296
          O       0.98      0.95      0.97      7318
      B-LOC       0.62      0.67      0.64       218
      I-LOC       0.68      0.65      0.66       141
      I-ORG       0.36      0.46      0.40       151
      B-PER       0.83      0.68      0.75       438
      I-PER       0.79      0.57      0.67       214
     B-MISC       0.30      0.21      0.25       141
     I-MISC       0.38      0.24      0.29       154

avg / total       0.91      0.88      0.89      9071

F-1 Score (without O):
0.904789719626
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 9
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104373 unique words.
4369 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 260
OOV word occurences: in test 386
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6679936     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,792,066
Trainable params: 6,792,066
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 12s 35ms/step - loss: 0.2077 - acc: 0.9317
Epoch 2/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0892 - acc: 0.9712
Epoch 3/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0709 - acc: 0.9751
Epoch 4/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0627 - acc: 0.9768
Epoch 5/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0573 - acc: 0.9783
Epoch 6/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0509 - acc: 0.9805
Epoch 7/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0461 - acc: 0.9827
Epoch 8/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0417 - acc: 0.9851
Epoch 9/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0368 - acc: 0.9871
Epoch 10/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0325 - acc: 0.9886
Epoch 11/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0277 - acc: 0.9909
Epoch 12/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0248 - acc: 0.9919
Epoch 13/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0221 - acc: 0.9928
Epoch 14/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0186 - acc: 0.9944
Epoch 15/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0160 - acc: 0.9949
Epoch 16/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0143 - acc: 0.9957
Epoch 17/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0124 - acc: 0.9963
Epoch 18/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0112 - acc: 0.9970
Epoch 19/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0101 - acc: 0.9973
Epoch 20/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0086 - acc: 0.9977
Epoch 21/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0079 - acc: 0.9978
Epoch 22/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0067 - acc: 0.9984
Epoch 23/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0058 - acc: 0.9988
Epoch 24/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0051 - acc: 0.9988
Epoch 25/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0045 - acc: 0.9990
Epoch 26/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0043 - acc: 0.9990
Epoch 27/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0042 - acc: 0.9991
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8031
False 1040
True percentage 0.885348914122
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.97      7318
      B-LOC       0.71      0.72      0.72       218
      I-LOC       0.64      0.78      0.70       141
      B-ORG       0.67      0.65      0.66       296
      B-PER       0.83      0.76      0.79       438
      I-PER       0.75      0.58      0.66       214
      I-ORG       0.45      0.32      0.37       151
     B-MISC       0.43      0.29      0.35       141
     I-MISC       0.43      0.42      0.42       154

avg / total       0.92      0.89      0.90      9071

F-1 Score (without O):
0.637421665175
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 10
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104330 unique words.
4326 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 268
OOV word occurences: in test 400
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6677184     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,789,314
Trainable params: 6,789,314
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 12s 35ms/step - loss: 0.1774 - acc: 0.9414
Epoch 2/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0840 - acc: 0.9738
Epoch 3/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0672 - acc: 0.9764
Epoch 4/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0591 - acc: 0.9782
Epoch 5/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0524 - acc: 0.9807
Epoch 6/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0475 - acc: 0.9821
Epoch 7/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0429 - acc: 0.9845
Epoch 8/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0387 - acc: 0.9859
Epoch 9/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0352 - acc: 0.9877
Epoch 10/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0319 - acc: 0.9889
Epoch 11/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0283 - acc: 0.9907
Epoch 12/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0254 - acc: 0.9916
Epoch 13/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0232 - acc: 0.9921
Epoch 14/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0196 - acc: 0.9943
Epoch 15/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0174 - acc: 0.9949
Epoch 16/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0156 - acc: 0.9957
Epoch 17/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0130 - acc: 0.9965
Epoch 18/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0113 - acc: 0.9971
Epoch 19/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0100 - acc: 0.9974
Epoch 20/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0086 - acc: 0.9980
Epoch 21/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0077 - acc: 0.9982
Epoch 22/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0071 - acc: 0.9983
Epoch 23/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0057 - acc: 0.9988
Epoch 24/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0051 - acc: 0.9988
Epoch 25/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0048 - acc: 0.9990
Epoch 26/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0046 - acc: 0.9991
Epoch 27/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0039 - acc: 0.9992
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8021
False 1050
True percentage 0.884246499835
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.72      0.65      0.68       296
      I-ORG       0.54      0.41      0.47       151
      B-LOC       0.62      0.70      0.66       218
      B-PER       0.82      0.74      0.78       438
      I-PER       0.72      0.57      0.63       214
     B-MISC       0.40      0.15      0.22       141
     I-MISC       0.54      0.26      0.35       154
      I-LOC       0.57      0.74      0.64       141

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.624884792627
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 11
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104332 unique words.
4328 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 266
OOV word occurences: in test 406
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6677312     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,789,442
Trainable params: 6,789,442
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 12s 35ms/step - loss: 0.1875 - acc: 0.9363
Epoch 2/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0850 - acc: 0.9734
Epoch 3/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0684 - acc: 0.9767
Epoch 4/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0617 - acc: 0.9775
Epoch 5/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0553 - acc: 0.9795
Epoch 6/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0508 - acc: 0.9814
Epoch 7/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0460 - acc: 0.9830
Epoch 8/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0413 - acc: 0.9853
Epoch 9/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0379 - acc: 0.9864
Epoch 10/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0335 - acc: 0.9884
Epoch 11/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0299 - acc: 0.9897
Epoch 12/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0267 - acc: 0.9906
Epoch 13/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0232 - acc: 0.9923
Epoch 14/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0206 - acc: 0.9929
Epoch 15/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0185 - acc: 0.9938
Epoch 16/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0166 - acc: 0.9948
Epoch 17/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0142 - acc: 0.9958
Epoch 18/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0128 - acc: 0.9961
Epoch 19/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0117 - acc: 0.9967
Epoch 20/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0096 - acc: 0.9975
Epoch 21/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0092 - acc: 0.9973
Epoch 22/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0078 - acc: 0.9979
Epoch 23/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0072 - acc: 0.9981
Epoch 24/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0058 - acc: 0.9986
Epoch 25/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0054 - acc: 0.9988
Epoch 26/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0047 - acc: 0.9991
Epoch 27/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0043 - acc: 0.9990
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8026
False 1045
True percentage 0.884797706978
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.96      0.96      7318
      B-ORG       0.70      0.58      0.64       296
      I-ORG       0.60      0.43      0.50       151
     B-MISC       0.39      0.24      0.30       141
      B-LOC       0.72      0.73      0.73       218
      B-PER       0.85      0.71      0.77       438
     I-MISC       0.49      0.45      0.47       154
      I-PER       0.83      0.54      0.66       214
      I-LOC       0.72      0.65      0.68       141

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.63827121829
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104308 unique words.
4304 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 264
OOV word occurences: in test 444
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6675776     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,787,906
Trainable params: 6,787,906
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

334/334 [==============================] - 12s 36ms/step - loss: 0.2359 - acc: 0.9265
Epoch 2/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0927 - acc: 0.9705
Epoch 3/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0738 - acc: 0.9749
Epoch 4/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0656 - acc: 0.9768
Epoch 5/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0596 - acc: 0.9782
Epoch 6/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0540 - acc: 0.9796
Epoch 7/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0500 - acc: 0.9815
Epoch 8/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0452 - acc: 0.9831
Epoch 9/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0409 - acc: 0.9852
Epoch 10/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0376 - acc: 0.9862
Epoch 11/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0342 - acc: 0.9875
Epoch 12/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0295 - acc: 0.9896
Epoch 13/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0266 - acc: 0.9909
Epoch 14/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0234 - acc: 0.9924
Epoch 15/27

334/334 [==============================] - 10s 31ms/step - loss: 0.0220 - acc: 0.9928
Epoch 16/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0186 - acc: 0.9944
Epoch 17/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0160 - acc: 0.9956
Epoch 18/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0142 - acc: 0.9959
Epoch 19/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0127 - acc: 0.9967
Epoch 20/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0105 - acc: 0.9971
Epoch 21/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0098 - acc: 0.9974
Epoch 22/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0088 - acc: 0.9976
Epoch 23/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0081 - acc: 0.9980
Epoch 24/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0066 - acc: 0.9982
Epoch 25/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0062 - acc: 0.9985
Epoch 26/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0057 - acc: 0.9985
Epoch 27/27

334/334 [==============================] - 10s 30ms/step - loss: 0.0054 - acc: 0.9987
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7885
False 1186
True percentage 0.869253665528
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-PER       0.83      0.61      0.71       438
      B-ORG       0.58      0.58      0.58       296
     B-MISC       0.36      0.31      0.33       141
      I-PER       0.84      0.56      0.67       214
      I-ORG       0.36      0.44      0.40       151
     I-MISC       0.35      0.43      0.38       154
      B-LOC       0.73      0.64      0.68       218
      I-LOC       0.72      0.65      0.68       141

avg / total       0.92      0.87      0.89      9071

F-1 Score (without O):
0.58147925436
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104203 unique words.
4199 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 272
OOV word occurences: in test 488
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6669056     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,781,186
Trainable params: 6,781,186
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 7s 40ms/step - loss: 0.2817 - acc: 0.9012
Epoch 2/27

167/167 [==============================] - 5s 29ms/step - loss: 0.1451 - acc: 0.9534
Epoch 3/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0955 - acc: 0.9690
Epoch 4/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0829 - acc: 0.9736
Epoch 5/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0767 - acc: 0.9746
Epoch 6/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0703 - acc: 0.9757
Epoch 7/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0657 - acc: 0.9769
Epoch 8/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0622 - acc: 0.9772
Epoch 9/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0584 - acc: 0.9782
Epoch 10/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0549 - acc: 0.9792
Epoch 11/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0514 - acc: 0.9805
Epoch 12/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0483 - acc: 0.9820
Epoch 13/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0454 - acc: 0.9832
Epoch 14/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0427 - acc: 0.9838
Epoch 15/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0405 - acc: 0.9848
Epoch 16/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0366 - acc: 0.9869
Epoch 17/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0338 - acc: 0.9885
Epoch 18/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0298 - acc: 0.9896
Epoch 19/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0281 - acc: 0.9907
Epoch 20/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0264 - acc: 0.9910
Epoch 21/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0237 - acc: 0.9923
Epoch 22/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0221 - acc: 0.9928
Epoch 23/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0197 - acc: 0.9943
Epoch 24/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0194 - acc: 0.9942
Epoch 25/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0164 - acc: 0.9952
Epoch 26/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0151 - acc: 0.9959
Epoch 27/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0142 - acc: 0.9960
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7711
False 1360
True percentage 0.850071656929
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.94      0.96      7318
      B-LOC       0.64      0.60      0.62       218
      I-LOC       0.60      0.48      0.54       141
      B-PER       0.79      0.52      0.62       438
      B-ORG       0.55      0.62      0.58       296
      I-ORG       0.29      0.37      0.33       151
     B-MISC       0.23      0.13      0.17       141
     I-MISC       0.37      0.27      0.31       154
      I-PER       0.62      0.44      0.51       214

avg / total       0.89      0.85      0.87      9071

F-1 Score (without O):
0.507582791705
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104202 unique words.
4198 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 266
OOV word occurences: in test 445
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6668992     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,781,122
Trainable params: 6,781,122
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 7s 41ms/step - loss: 0.3237 - acc: 0.9000
Epoch 2/27

167/167 [==============================] - 5s 31ms/step - loss: 0.1571 - acc: 0.9441
Epoch 3/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0927 - acc: 0.9692
Epoch 4/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0786 - acc: 0.9747
Epoch 5/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0704 - acc: 0.9765
Epoch 6/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0652 - acc: 0.9773
Epoch 7/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0621 - acc: 0.9784
Epoch 8/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0574 - acc: 0.9795
Epoch 9/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0550 - acc: 0.9804
Epoch 10/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0523 - acc: 0.9812
Epoch 11/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0483 - acc: 0.9821
Epoch 12/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0465 - acc: 0.9836
Epoch 13/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0437 - acc: 0.9841
Epoch 14/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0401 - acc: 0.9859
Epoch 15/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0370 - acc: 0.9870
Epoch 16/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0354 - acc: 0.9880
Epoch 17/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0324 - acc: 0.9896
Epoch 18/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0302 - acc: 0.9901
Epoch 19/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0282 - acc: 0.9909
Epoch 20/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0254 - acc: 0.9920
Epoch 21/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0238 - acc: 0.9926
Epoch 22/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0214 - acc: 0.9932
Epoch 23/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0201 - acc: 0.9938
Epoch 24/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0190 - acc: 0.9945
Epoch 25/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0172 - acc: 0.9946
Epoch 26/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0154 - acc: 0.9955
Epoch 27/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0144 - acc: 0.9959
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7813
False 1258
True percentage 0.861316282659
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.76      0.65      0.70       438
      I-PER       0.82      0.50      0.62       214
          O       0.96      0.96      0.96      7318
      B-ORG       0.53      0.47      0.50       296
      I-ORG       0.29      0.34      0.31       151
      B-LOC       0.69      0.66      0.68       218
      I-LOC       0.70      0.23      0.35       141
     B-MISC       0.36      0.09      0.14       141
     I-MISC       0.26      0.20      0.23       154

avg / total       0.89      0.86      0.87      9071

F-1 Score (without O):
0.891837460017
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104187 unique words.
4183 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 269
OOV word occurences: in test 437
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6668032     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,780,162
Trainable params: 6,780,162
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 7s 41ms/step - loss: 0.2603 - acc: 0.9040
Epoch 2/27

167/167 [==============================] - 5s 31ms/step - loss: 0.1380 - acc: 0.9549
Epoch 3/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0920 - acc: 0.9700
Epoch 4/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0762 - acc: 0.9749
Epoch 5/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0675 - acc: 0.9766
Epoch 6/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0633 - acc: 0.9770
Epoch 7/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0575 - acc: 0.9797
Epoch 8/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0545 - acc: 0.9804
Epoch 9/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0502 - acc: 0.9819
Epoch 10/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0473 - acc: 0.9831
Epoch 11/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0438 - acc: 0.9844
Epoch 12/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0413 - acc: 0.9852
Epoch 13/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0387 - acc: 0.9864
Epoch 14/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0350 - acc: 0.9882
Epoch 15/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0316 - acc: 0.9894
Epoch 16/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0299 - acc: 0.9900
Epoch 17/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0272 - acc: 0.9910
Epoch 18/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0245 - acc: 0.9920
Epoch 19/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0233 - acc: 0.9925
Epoch 20/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0207 - acc: 0.9934
Epoch 21/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0193 - acc: 0.9942
Epoch 22/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0169 - acc: 0.9951
Epoch 23/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0158 - acc: 0.9955
Epoch 24/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0146 - acc: 0.9959
Epoch 25/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0135 - acc: 0.9962
Epoch 26/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0123 - acc: 0.9966
Epoch 27/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0111 - acc: 0.9974
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7778
False 1293
True percentage 0.857457832654
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.94      0.96      7318
      B-PER       0.80      0.61      0.69       438
      B-LOC       0.72      0.59      0.65       218
     B-MISC       0.27      0.11      0.16       141
     I-MISC       0.32      0.20      0.25       154
      B-ORG       0.55      0.72      0.62       296
      I-ORG       0.26      0.36      0.30       151
      I-LOC       0.61      0.47      0.53       141
      I-PER       0.74      0.46      0.56       214

avg / total       0.90      0.86      0.87      9071

F-1 Score (without O):
0.53546208167
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104197 unique words.
4193 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 266
OOV word occurences: in test 469
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6668672     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,780,802
Trainable params: 6,780,802
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 7s 41ms/step - loss: 0.2619 - acc: 0.9070
Epoch 2/27

167/167 [==============================] - 5s 31ms/step - loss: 0.1199 - acc: 0.9635
Epoch 3/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0857 - acc: 0.9715
Epoch 4/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0760 - acc: 0.9748
Epoch 5/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0683 - acc: 0.9752
Epoch 6/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0623 - acc: 0.9770
Epoch 7/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0588 - acc: 0.9781
Epoch 8/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0535 - acc: 0.9801
Epoch 9/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0501 - acc: 0.9810
Epoch 10/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0468 - acc: 0.9826
Epoch 11/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0426 - acc: 0.9850
Epoch 12/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0396 - acc: 0.9860
Epoch 13/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0363 - acc: 0.9879
Epoch 14/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0329 - acc: 0.9891
Epoch 15/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0317 - acc: 0.9895
Epoch 16/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0280 - acc: 0.9909
Epoch 17/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0246 - acc: 0.9922
Epoch 18/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0229 - acc: 0.9922
Epoch 19/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0206 - acc: 0.9935
Epoch 20/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0190 - acc: 0.9945
Epoch 21/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0169 - acc: 0.9951
Epoch 22/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0154 - acc: 0.9953
Epoch 23/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0141 - acc: 0.9964
Epoch 24/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0133 - acc: 0.9963
Epoch 25/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0112 - acc: 0.9972
Epoch 26/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0107 - acc: 0.9977
Epoch 27/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0100 - acc: 0.9975
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7817
False 1254
True percentage 0.861757248374
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-ORG       0.52      0.47      0.50       296
      I-ORG       0.26      0.40      0.31       151
      B-PER       0.77      0.67      0.72       438
      I-PER       0.80      0.56      0.66       214
      B-LOC       0.71      0.63      0.67       218
      I-LOC       0.68      0.41      0.51       141
     B-MISC       0.31      0.18      0.23       141
     I-MISC       0.42      0.23      0.30       154

avg / total       0.90      0.86      0.88      9071

F-1 Score (without O):
0.538866522143
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104218 unique words.
4214 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 272
OOV word occurences: in test 466
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6670016     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,782,146
Trainable params: 6,782,146
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 7s 41ms/step - loss: 0.2952 - acc: 0.9027
Epoch 2/27

167/167 [==============================] - 5s 31ms/step - loss: 0.1190 - acc: 0.9644
Epoch 3/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0859 - acc: 0.9721
Epoch 4/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0733 - acc: 0.9772
Epoch 5/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0649 - acc: 0.9779
Epoch 6/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0596 - acc: 0.9793
Epoch 7/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0577 - acc: 0.9797
Epoch 8/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0533 - acc: 0.9809
Epoch 9/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0508 - acc: 0.9811
Epoch 10/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0456 - acc: 0.9832
Epoch 11/27

167/167 [==============================] - 5s 32ms/step - loss: 0.0427 - acc: 0.9844
Epoch 12/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0411 - acc: 0.9849
Epoch 13/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0365 - acc: 0.9873
Epoch 14/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0349 - acc: 0.9875
Epoch 15/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0323 - acc: 0.9884
Epoch 16/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0283 - acc: 0.9908
Epoch 17/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0266 - acc: 0.9909
Epoch 18/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0252 - acc: 0.9915
Epoch 19/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0226 - acc: 0.9928
Epoch 20/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0211 - acc: 0.9932
Epoch 21/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0195 - acc: 0.9938
Epoch 22/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0178 - acc: 0.9946
Epoch 23/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0163 - acc: 0.9953
Epoch 24/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0153 - acc: 0.9956
Epoch 25/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0137 - acc: 0.9962
Epoch 26/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0123 - acc: 0.9965
Epoch 27/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0114 - acc: 0.9971
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7780
False 1291
True percentage 0.857678315511
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.96      0.96      7318
      B-ORG       0.56      0.39      0.46       296
      I-ORG       0.30      0.28      0.29       151
      B-PER       0.75      0.63      0.69       438
      I-PER       0.76      0.45      0.56       214
     B-MISC       0.22      0.14      0.17       141
     I-MISC       0.31      0.13      0.18       154
      B-LOC       0.62      0.64      0.63       218
      I-LOC       0.62      0.57      0.60       141

avg / total       0.89      0.86      0.87      9071

F-1 Score (without O):
0.508529127776
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104205 unique words.
4201 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 270
OOV word occurences: in test 432
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6669184     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,781,314
Trainable params: 6,781,314
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 7s 41ms/step - loss: 0.2564 - acc: 0.9120
Epoch 2/27

167/167 [==============================] - 5s 31ms/step - loss: 0.1336 - acc: 0.9552
Epoch 3/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0981 - acc: 0.9695
Epoch 4/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0816 - acc: 0.9726
Epoch 5/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0719 - acc: 0.9751
Epoch 6/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0677 - acc: 0.9757
Epoch 7/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0618 - acc: 0.9776
Epoch 8/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0584 - acc: 0.9785
Epoch 9/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0557 - acc: 0.9796
Epoch 10/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0522 - acc: 0.9802
Epoch 11/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0501 - acc: 0.9813
Epoch 12/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0469 - acc: 0.9826
Epoch 13/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0440 - acc: 0.9842
Epoch 14/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0420 - acc: 0.9849
Epoch 15/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0383 - acc: 0.9856
Epoch 16/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0358 - acc: 0.9871
Epoch 17/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0329 - acc: 0.9881
Epoch 18/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0297 - acc: 0.9904
Epoch 19/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0281 - acc: 0.9906
Epoch 20/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0257 - acc: 0.9913
Epoch 21/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0231 - acc: 0.9930
Epoch 22/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0208 - acc: 0.9937
Epoch 23/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0194 - acc: 0.9942
Epoch 24/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0179 - acc: 0.9951
Epoch 25/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0156 - acc: 0.9955
Epoch 26/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0149 - acc: 0.9958
Epoch 27/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0137 - acc: 0.9960
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7856
False 1215
True percentage 0.866056664094
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.84      0.61      0.70       438
          O       0.97      0.95      0.96      7318
      B-LOC       0.65      0.61      0.63       218
      B-ORG       0.59      0.67      0.63       296
      I-PER       0.79      0.50      0.62       214
     B-MISC       0.35      0.11      0.17       141
     I-MISC       0.35      0.15      0.21       154
      I-ORG       0.30      0.46      0.37       151
      I-LOC       0.54      0.43      0.48       141

avg / total       0.90      0.87      0.88      9071

F-1 Score (without O):
0.895311117664
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104194 unique words.
4190 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 271
OOV word occurences: in test 478
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6668480     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,780,610
Trainable params: 6,780,610
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 7s 41ms/step - loss: 0.2067 - acc: 0.9235
Epoch 2/27

167/167 [==============================] - 5s 30ms/step - loss: 0.1038 - acc: 0.9678
Epoch 3/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0805 - acc: 0.9744
Epoch 4/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0714 - acc: 0.9754
Epoch 5/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0667 - acc: 0.9764
Epoch 6/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0618 - acc: 0.9775
Epoch 7/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0574 - acc: 0.9789
Epoch 8/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0534 - acc: 0.9802
Epoch 9/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0501 - acc: 0.9809
Epoch 10/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0469 - acc: 0.9822
Epoch 11/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0434 - acc: 0.9835
Epoch 12/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0395 - acc: 0.9855
Epoch 13/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0372 - acc: 0.9864
Epoch 14/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0339 - acc: 0.9880
Epoch 15/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0310 - acc: 0.9892
Epoch 16/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0288 - acc: 0.9902
Epoch 17/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0261 - acc: 0.9910
Epoch 18/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0231 - acc: 0.9925
Epoch 19/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0217 - acc: 0.9935
Epoch 20/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0192 - acc: 0.9940
Epoch 21/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0164 - acc: 0.9954
Epoch 22/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0156 - acc: 0.9954
Epoch 23/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0141 - acc: 0.9958
Epoch 24/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0125 - acc: 0.9964
Epoch 25/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0114 - acc: 0.9975
Epoch 26/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0096 - acc: 0.9980
Epoch 27/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0086 - acc: 0.9981
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7833
False 1238
True percentage 0.863521111234
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
     B-MISC       0.33      0.24      0.28       141
      B-ORG       0.57      0.52      0.54       296
     I-MISC       0.39      0.28      0.33       154
      B-LOC       0.69      0.69      0.69       218
      I-ORG       0.35      0.33      0.34       151
      B-PER       0.81      0.62      0.70       438
      I-PER       0.80      0.57      0.66       214
      I-LOC       0.55      0.59      0.57       141

avg / total       0.90      0.86      0.88      9071

F-1 Score (without O):
0.559678416821
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104179 unique words.
4175 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 269
OOV word occurences: in test 453
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6667520     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,779,650
Trainable params: 6,779,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 7s 41ms/step - loss: 0.2673 - acc: 0.9056
Epoch 2/27

167/167 [==============================] - 5s 30ms/step - loss: 0.1299 - acc: 0.9572
Epoch 3/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0918 - acc: 0.9723
Epoch 4/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0767 - acc: 0.9757
Epoch 5/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0687 - acc: 0.9769
Epoch 6/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0622 - acc: 0.9778
Epoch 7/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0584 - acc: 0.9790
Epoch 8/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0545 - acc: 0.9798
Epoch 9/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0516 - acc: 0.9808
Epoch 10/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0472 - acc: 0.9821
Epoch 11/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0459 - acc: 0.9827
Epoch 12/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0423 - acc: 0.9840
Epoch 13/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0404 - acc: 0.9855
Epoch 14/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0371 - acc: 0.9865
Epoch 15/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0351 - acc: 0.9872
Epoch 16/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0324 - acc: 0.9886
Epoch 17/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0304 - acc: 0.9893
Epoch 18/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0287 - acc: 0.9903
Epoch 19/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0262 - acc: 0.9911
Epoch 20/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0243 - acc: 0.9921
Epoch 21/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0219 - acc: 0.9927
Epoch 22/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0204 - acc: 0.9934
Epoch 23/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0195 - acc: 0.9937
Epoch 24/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0175 - acc: 0.9945
Epoch 25/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0166 - acc: 0.9948
Epoch 26/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0147 - acc: 0.9954
Epoch 27/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0131 - acc: 0.9965
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7817
False 1254
True percentage 0.861757248374
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.58      0.61      0.60       296
          O       0.97      0.95      0.96      7318
     B-MISC       0.37      0.25      0.30       141
     I-MISC       0.24      0.31      0.27       154
      B-LOC       0.54      0.52      0.53       218
      I-LOC       0.76      0.09      0.16       141
      B-PER       0.82      0.70      0.75       438
      I-PER       0.88      0.52      0.66       214
      I-ORG       0.49      0.30      0.38       151

avg / total       0.90      0.86      0.88      9071

F-1 Score (without O):
0.894000585309
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 8
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104206 unique words.
4202 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 269
OOV word occurences: in test 429
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6669248     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,781,378
Trainable params: 6,781,378
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 7s 41ms/step - loss: 0.2860 - acc: 0.9044
Epoch 2/27

167/167 [==============================] - 5s 30ms/step - loss: 0.1404 - acc: 0.9533
Epoch 3/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0977 - acc: 0.9681
Epoch 4/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0822 - acc: 0.9721
Epoch 5/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0761 - acc: 0.9740
Epoch 6/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0692 - acc: 0.9753
Epoch 7/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0657 - acc: 0.9756
Epoch 8/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0609 - acc: 0.9774
Epoch 9/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0565 - acc: 0.9782
Epoch 10/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0537 - acc: 0.9787
Epoch 11/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0512 - acc: 0.9804
Epoch 12/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0475 - acc: 0.9819
Epoch 13/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0442 - acc: 0.9843
Epoch 14/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0409 - acc: 0.9859
Epoch 15/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0378 - acc: 0.9873
Epoch 16/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0341 - acc: 0.9891
Epoch 17/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0326 - acc: 0.9895
Epoch 18/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0294 - acc: 0.9902
Epoch 19/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0269 - acc: 0.9911
Epoch 20/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0253 - acc: 0.9919
Epoch 21/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0213 - acc: 0.9934
Epoch 22/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0201 - acc: 0.9937
Epoch 23/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0182 - acc: 0.9947
Epoch 24/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0170 - acc: 0.9950
Epoch 25/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0155 - acc: 0.9956
Epoch 26/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0140 - acc: 0.9961
Epoch 27/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0128 - acc: 0.9966
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7847
False 1224
True percentage 0.865064491236
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.56      0.68      0.61       296
          O       0.97      0.95      0.96      7318
      B-LOC       0.68      0.64      0.66       218
      I-LOC       0.68      0.51      0.58       141
      I-ORG       0.26      0.47      0.34       151
      B-PER       0.82      0.61      0.70       438
      I-PER       0.75      0.49      0.59       214
     B-MISC       0.40      0.13      0.20       141
     I-MISC       0.37      0.11      0.17       154

avg / total       0.91      0.87      0.88      9071

F-1 Score (without O):
0.896511287013
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 9
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104197 unique words.
4193 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 276
OOV word occurences: in test 445
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6668672     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,780,802
Trainable params: 6,780,802
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 7s 41ms/step - loss: 0.2628 - acc: 0.9105
Epoch 2/27

167/167 [==============================] - 5s 30ms/step - loss: 0.1269 - acc: 0.9614
Epoch 3/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0966 - acc: 0.9689
Epoch 4/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0815 - acc: 0.9740
Epoch 5/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0738 - acc: 0.9750
Epoch 6/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0675 - acc: 0.9763
Epoch 7/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0617 - acc: 0.9773
Epoch 8/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0576 - acc: 0.9786
Epoch 9/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0536 - acc: 0.9799
Epoch 10/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0498 - acc: 0.9811
Epoch 11/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0458 - acc: 0.9833
Epoch 12/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0429 - acc: 0.9847
Epoch 13/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0387 - acc: 0.9862
Epoch 14/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0355 - acc: 0.9878
Epoch 15/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0342 - acc: 0.9887
Epoch 16/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0302 - acc: 0.9900
Epoch 17/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0274 - acc: 0.9911
Epoch 18/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0249 - acc: 0.9921
Epoch 19/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0228 - acc: 0.9930
Epoch 20/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0205 - acc: 0.9937
Epoch 21/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0199 - acc: 0.9941
Epoch 22/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0175 - acc: 0.9947
Epoch 23/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0155 - acc: 0.9959
Epoch 24/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0143 - acc: 0.9963
Epoch 25/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0132 - acc: 0.9965
Epoch 26/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0116 - acc: 0.9971
Epoch 27/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0102 - acc: 0.9974
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7868
False 1203
True percentage 0.867379561239
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-LOC       0.70      0.65      0.68       218
      I-LOC       0.55      0.71      0.62       141
      B-ORG       0.60      0.56      0.58       296
      B-PER       0.82      0.65      0.73       438
      I-PER       0.71      0.54      0.61       214
      I-ORG       0.39      0.33      0.36       151
     B-MISC       0.38      0.18      0.24       141
     I-MISC       0.48      0.19      0.28       154

avg / total       0.90      0.87      0.88      9071

F-1 Score (without O):
0.57529078906
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 10
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104190 unique words.
4186 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 274
OOV word occurences: in test 414
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6668224     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,780,354
Trainable params: 6,780,354
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 7s 40ms/step - loss: 0.2288 - acc: 0.9198
Epoch 2/27

167/167 [==============================] - 5s 30ms/step - loss: 0.1172 - acc: 0.9620
Epoch 3/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0881 - acc: 0.9731
Epoch 4/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0756 - acc: 0.9748
Epoch 5/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0702 - acc: 0.9751
Epoch 6/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0662 - acc: 0.9761
Epoch 7/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0617 - acc: 0.9772
Epoch 8/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0582 - acc: 0.9780
Epoch 9/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0545 - acc: 0.9787
Epoch 10/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0522 - acc: 0.9801
Epoch 11/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0480 - acc: 0.9822
Epoch 12/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0457 - acc: 0.9833
Epoch 13/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0433 - acc: 0.9837
Epoch 14/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0397 - acc: 0.9853
Epoch 15/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0369 - acc: 0.9865
Epoch 16/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0348 - acc: 0.9878
Epoch 17/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0322 - acc: 0.9881
Epoch 18/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0297 - acc: 0.9895
Epoch 19/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0282 - acc: 0.9897
Epoch 20/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0257 - acc: 0.9914
Epoch 21/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0227 - acc: 0.9920
Epoch 22/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0211 - acc: 0.9936
Epoch 23/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0191 - acc: 0.9942
Epoch 24/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0175 - acc: 0.9952
Epoch 25/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0155 - acc: 0.9958
Epoch 26/27

167/167 [==============================] - 5s 29ms/step - loss: 0.0141 - acc: 0.9963
Epoch 27/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0124 - acc: 0.9972
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7847
False 1224
True percentage 0.865064491236
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.94      0.96      7318
      B-ORG       0.59      0.64      0.61       296
      I-ORG       0.33      0.44      0.38       151
      B-LOC       0.60      0.66      0.63       218
      B-PER       0.87      0.64      0.74       438
      I-PER       0.72      0.51      0.60       214
     B-MISC       0.24      0.14      0.18       141
     I-MISC       0.41      0.19      0.26       154
      I-LOC       0.52      0.70      0.59       141

avg / total       0.90      0.87      0.88      9071

F-1 Score (without O):
0.561129468309
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 11
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104204 unique words.
4200 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 272
OOV word occurences: in test 450
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6669120     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,781,250
Trainable params: 6,781,250
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 7s 41ms/step - loss: 0.2619 - acc: 0.9100
Epoch 2/27

167/167 [==============================] - 5s 30ms/step - loss: 0.1134 - acc: 0.9645
Epoch 3/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0852 - acc: 0.9744
Epoch 4/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0735 - acc: 0.9767
Epoch 5/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0664 - acc: 0.9770
Epoch 6/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0620 - acc: 0.9780
Epoch 7/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0584 - acc: 0.9788
Epoch 8/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0539 - acc: 0.9803
Epoch 9/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0501 - acc: 0.9814
Epoch 10/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0475 - acc: 0.9819
Epoch 11/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0439 - acc: 0.9837
Epoch 12/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0404 - acc: 0.9855
Epoch 13/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0377 - acc: 0.9863
Epoch 14/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0354 - acc: 0.9877
Epoch 15/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0328 - acc: 0.9889
Epoch 16/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0301 - acc: 0.9899
Epoch 17/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0279 - acc: 0.9905
Epoch 18/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0249 - acc: 0.9918
Epoch 19/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0230 - acc: 0.9927
Epoch 20/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0209 - acc: 0.9934
Epoch 21/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0189 - acc: 0.9941
Epoch 22/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0175 - acc: 0.9946
Epoch 23/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0157 - acc: 0.9954
Epoch 24/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0135 - acc: 0.9964
Epoch 25/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0126 - acc: 0.9964
Epoch 26/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0115 - acc: 0.9970
Epoch 27/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0104 - acc: 0.9976
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7859
False 1212
True percentage 0.866387388381
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-ORG       0.55      0.59      0.57       296
      I-ORG       0.35      0.43      0.38       151
     B-MISC       0.29      0.09      0.13       141
      B-LOC       0.62      0.70      0.66       218
      B-PER       0.82      0.64      0.72       438
     I-MISC       0.29      0.12      0.17       154
      I-PER       0.80      0.57      0.67       214
      I-LOC       0.59      0.67      0.63       141

avg / total       0.90      0.87      0.88      9071

F-1 Score (without O):
0.563630788102
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104158 unique words.
4154 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 270
OOV word occurences: in test 538
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6666176     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,778,306
Trainable params: 6,778,306
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

167/167 [==============================] - 7s 43ms/step - loss: 0.2369 - acc: 0.9128
Epoch 2/27

167/167 [==============================] - 5s 31ms/step - loss: 0.1267 - acc: 0.9589
Epoch 3/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0940 - acc: 0.9717
Epoch 4/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0788 - acc: 0.9735
Epoch 5/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0726 - acc: 0.9754
Epoch 6/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0676 - acc: 0.9762
Epoch 7/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0630 - acc: 0.9774
Epoch 8/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0594 - acc: 0.9786
Epoch 9/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0553 - acc: 0.9800
Epoch 10/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0537 - acc: 0.9805
Epoch 11/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0484 - acc: 0.9821
Epoch 12/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0458 - acc: 0.9832
Epoch 13/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0438 - acc: 0.9839
Epoch 14/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0398 - acc: 0.9849
Epoch 15/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0381 - acc: 0.9855
Epoch 16/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0349 - acc: 0.9873
Epoch 17/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0329 - acc: 0.9885
Epoch 18/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0300 - acc: 0.9895
Epoch 19/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0272 - acc: 0.9907
Epoch 20/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0259 - acc: 0.9910
Epoch 21/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0240 - acc: 0.9919
Epoch 22/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0218 - acc: 0.9935
Epoch 23/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0196 - acc: 0.9941
Epoch 24/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0181 - acc: 0.9942
Epoch 25/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0167 - acc: 0.9953
Epoch 26/27

167/167 [==============================] - 5s 30ms/step - loss: 0.0155 - acc: 0.9955
Epoch 27/27

167/167 [==============================] - 5s 31ms/step - loss: 0.0142 - acc: 0.9960
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7743
False 1328
True percentage 0.853599382648
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.94      0.96      7318
      B-PER       0.72      0.56      0.63       438
      B-ORG       0.51      0.51      0.51       296
     B-MISC       0.41      0.22      0.29       141
      I-PER       0.72      0.48      0.57       214
      I-ORG       0.26      0.52      0.35       151
     I-MISC       0.36      0.17      0.23       154
      B-LOC       0.74      0.57      0.64       218
      I-LOC       0.73      0.52      0.61       141

avg / total       0.91      0.85      0.88      9071

F-1 Score (without O):
0.512473052048
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104109 unique words.
4105 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 278
OOV word occurences: in test 539
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663040     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,170
Trainable params: 6,775,170
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 4s 53ms/step - loss: 0.2985 - acc: 0.9016
Epoch 2/27

83/83 [==============================] - 3s 32ms/step - loss: 0.1816 - acc: 0.9365
Epoch 3/27

83/83 [==============================] - 3s 32ms/step - loss: 0.1193 - acc: 0.9658
Epoch 4/27

83/83 [==============================] - 3s 32ms/step - loss: 0.1042 - acc: 0.9647
Epoch 5/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0879 - acc: 0.9728
Epoch 6/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0834 - acc: 0.9750
Epoch 7/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0771 - acc: 0.9748
Epoch 8/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0722 - acc: 0.9758
Epoch 9/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0702 - acc: 0.9762
Epoch 10/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0670 - acc: 0.9769
Epoch 11/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0639 - acc: 0.9776
Epoch 12/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0614 - acc: 0.9781
Epoch 13/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0599 - acc: 0.9783
Epoch 14/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0568 - acc: 0.9789
Epoch 15/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0542 - acc: 0.9791
Epoch 16/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0532 - acc: 0.9796
Epoch 17/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0496 - acc: 0.9812
Epoch 18/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0472 - acc: 0.9819
Epoch 19/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0456 - acc: 0.9826
Epoch 20/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0443 - acc: 0.9826
Epoch 21/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0415 - acc: 0.9841
Epoch 22/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0389 - acc: 0.9855
Epoch 23/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0376 - acc: 0.9859
Epoch 24/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0355 - acc: 0.9867
Epoch 25/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0336 - acc: 0.9878
Epoch 26/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0324 - acc: 0.9880
Epoch 27/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0305 - acc: 0.9898
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7595
False 1476
True percentage 0.837283651196
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.94      0.95      7318
      B-LOC       0.63      0.56      0.59       218
      I-LOC       0.55      0.38      0.45       141
      B-PER       0.65      0.47      0.55       438
      B-ORG       0.51      0.56      0.53       296
      I-ORG       0.23      0.40      0.30       151
     B-MISC       0.11      0.01      0.01       141
     I-MISC       0.40      0.06      0.11       154
      I-PER       0.60      0.37      0.46       214

avg / total       0.87      0.84      0.85      9071

F-1 Score (without O):
0.449358974359
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104122 unique words.
4118 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 271
OOV word occurences: in test 452
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663872     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,776,002
Trainable params: 6,776,002
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 4s 53ms/step - loss: 0.3181 - acc: 0.8984
Epoch 2/27

83/83 [==============================] - 3s 31ms/step - loss: 0.2133 - acc: 0.9166
Epoch 3/27

83/83 [==============================] - 3s 31ms/step - loss: 0.1484 - acc: 0.9535
Epoch 4/27

83/83 [==============================] - 3s 31ms/step - loss: 0.1197 - acc: 0.9614
Epoch 5/27

83/83 [==============================] - 3s 31ms/step - loss: 0.1001 - acc: 0.9676
Epoch 6/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0893 - acc: 0.9735
Epoch 7/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0800 - acc: 0.9742
Epoch 8/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0745 - acc: 0.9748
Epoch 9/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0714 - acc: 0.9754
Epoch 10/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0677 - acc: 0.9762
Epoch 11/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0643 - acc: 0.9771
Epoch 12/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0622 - acc: 0.9774
Epoch 13/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0586 - acc: 0.9784
Epoch 14/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0558 - acc: 0.9793
Epoch 15/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0543 - acc: 0.9807
Epoch 16/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0525 - acc: 0.9806
Epoch 17/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0488 - acc: 0.9830
Epoch 18/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0460 - acc: 0.9837
Epoch 19/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0461 - acc: 0.9832
Epoch 20/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0424 - acc: 0.9846
Epoch 21/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0400 - acc: 0.9861
Epoch 22/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0392 - acc: 0.9866
Epoch 23/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0371 - acc: 0.9865
Epoch 24/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0346 - acc: 0.9886
Epoch 25/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0327 - acc: 0.9893
Epoch 26/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0308 - acc: 0.9899
Epoch 27/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0301 - acc: 0.9898
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7606
False 1465
True percentage 0.838496306912
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.69      0.62      0.66       438
      I-PER       0.68      0.48      0.56       214
          O       0.96      0.95      0.96      7318
      B-ORG       0.34      0.40      0.37       296
      I-ORG       0.12      0.21      0.15       151
      B-LOC       0.67      0.42      0.52       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.21      0.05      0.08       154

avg / total       0.86      0.84      0.84      9071

F-1 Score (without O):
0.869972713252
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104105 unique words.
4101 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 277
OOV word occurences: in test 484
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6662784     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,774,914
Trainable params: 6,774,914
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 4s 52ms/step - loss: 0.2376 - acc: 0.9109
Epoch 2/27

83/83 [==============================] - 3s 31ms/step - loss: 0.1448 - acc: 0.9558
Epoch 3/27

83/83 [==============================] - 3s 31ms/step - loss: 0.1188 - acc: 0.9619
Epoch 4/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0976 - acc: 0.9688
Epoch 5/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0846 - acc: 0.9735
Epoch 6/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0791 - acc: 0.9737
Epoch 7/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0752 - acc: 0.9751
Epoch 8/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0696 - acc: 0.9764
Epoch 9/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0660 - acc: 0.9769
Epoch 10/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0638 - acc: 0.9776
Epoch 11/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0593 - acc: 0.9792
Epoch 12/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0564 - acc: 0.9800
Epoch 13/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0546 - acc: 0.9801
Epoch 14/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0531 - acc: 0.9805
Epoch 15/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0498 - acc: 0.9816
Epoch 16/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0481 - acc: 0.9820
Epoch 17/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0462 - acc: 0.9822
Epoch 18/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0445 - acc: 0.9826
Epoch 19/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0409 - acc: 0.9842
Epoch 20/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0405 - acc: 0.9848
Epoch 21/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0387 - acc: 0.9851
Epoch 22/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0364 - acc: 0.9864
Epoch 23/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0349 - acc: 0.9868
Epoch 24/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0337 - acc: 0.9880
Epoch 25/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0323 - acc: 0.9888
Epoch 26/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0310 - acc: 0.9892
Epoch 27/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0288 - acc: 0.9900
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7580
False 1491
True percentage 0.835630029765
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.95      0.95      7318
      B-PER       0.67      0.51      0.58       438
      B-LOC       0.75      0.39      0.51       218
     B-MISC       0.19      0.03      0.05       141
     I-MISC       0.26      0.21      0.23       154
      B-ORG       0.39      0.49      0.44       296
      I-ORG       0.21      0.21      0.21       151
      I-LOC       0.83      0.21      0.33       141
      I-PER       0.66      0.30      0.42       214

avg / total       0.87      0.84      0.84      9071

F-1 Score (without O):
0.410977242303
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104110 unique words.
4106 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 275
OOV word occurences: in test 481
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663104     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,234
Trainable params: 6,775,234
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 4s 53ms/step - loss: 0.3739 - acc: 0.8987
Epoch 2/27

83/83 [==============================] - 3s 33ms/step - loss: 0.2610 - acc: 0.9035
Epoch 3/27

83/83 [==============================] - 3s 33ms/step - loss: 0.1701 - acc: 0.9413
Epoch 4/27

83/83 [==============================] - 3s 32ms/step - loss: 0.1344 - acc: 0.9556
Epoch 5/27

83/83 [==============================] - 3s 32ms/step - loss: 0.1156 - acc: 0.9614
Epoch 6/27

83/83 [==============================] - 3s 33ms/step - loss: 0.1057 - acc: 0.9693
Epoch 7/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0963 - acc: 0.9681
Epoch 8/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0878 - acc: 0.9705
Epoch 9/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0861 - acc: 0.9722
Epoch 10/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0795 - acc: 0.9739
Epoch 11/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0769 - acc: 0.9733
Epoch 12/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0722 - acc: 0.9744
Epoch 13/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0700 - acc: 0.9761
Epoch 14/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0667 - acc: 0.9753
Epoch 15/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0637 - acc: 0.9758
Epoch 16/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0618 - acc: 0.9766
Epoch 17/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0590 - acc: 0.9779
Epoch 18/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0560 - acc: 0.9787
Epoch 19/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0547 - acc: 0.9788
Epoch 20/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0522 - acc: 0.9807
Epoch 21/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0504 - acc: 0.9816
Epoch 22/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0487 - acc: 0.9827
Epoch 23/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0466 - acc: 0.9829
Epoch 24/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0443 - acc: 0.9843
Epoch 25/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0429 - acc: 0.9840
Epoch 26/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0396 - acc: 0.9866
Epoch 27/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0391 - acc: 0.9874
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7560
False 1511
True percentage 0.833425201191
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.95      0.95      7318
      B-ORG       0.44      0.38      0.40       296
      I-ORG       0.19      0.34      0.24       151
      B-PER       0.58      0.56      0.57       438
      I-PER       0.49      0.47      0.48       214
      B-LOC       0.64      0.47      0.54       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.42      0.03      0.06       154

avg / total       0.85      0.83      0.84      9071

F-1 Score (without O):
0.399481193256
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104122 unique words.
4118 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 276
OOV word occurences: in test 491
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663872     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,776,002
Trainable params: 6,776,002
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 4s 52ms/step - loss: 0.3311 - acc: 0.9006
Epoch 2/27

83/83 [==============================] - 3s 32ms/step - loss: 0.2069 - acc: 0.9287
Epoch 3/27

83/83 [==============================] - 3s 32ms/step - loss: 0.1145 - acc: 0.9657
Epoch 4/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0942 - acc: 0.9681
Epoch 5/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0778 - acc: 0.9743
Epoch 6/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0725 - acc: 0.9779
Epoch 7/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0659 - acc: 0.9790
Epoch 8/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0628 - acc: 0.9792
Epoch 9/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0594 - acc: 0.9796
Epoch 10/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0573 - acc: 0.9803
Epoch 11/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0554 - acc: 0.9812
Epoch 12/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0518 - acc: 0.9819
Epoch 13/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0521 - acc: 0.9816
Epoch 14/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0476 - acc: 0.9831
Epoch 15/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0460 - acc: 0.9821
Epoch 16/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0437 - acc: 0.9837
Epoch 17/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0412 - acc: 0.9847
Epoch 18/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0415 - acc: 0.9847
Epoch 19/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0385 - acc: 0.9856
Epoch 20/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0360 - acc: 0.9858
Epoch 21/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0348 - acc: 0.9867
Epoch 22/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0332 - acc: 0.9874
Epoch 23/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0311 - acc: 0.9879
Epoch 24/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0291 - acc: 0.9889
Epoch 25/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0285 - acc: 0.9891
Epoch 26/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0267 - acc: 0.9899
Epoch 27/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0243 - acc: 0.9911
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7606
False 1465
True percentage 0.838496306912
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.95      0.95      7318
      B-ORG       0.40      0.49      0.44       296
      I-ORG       0.27      0.35      0.30       151
      B-PER       0.71      0.47      0.57       438
      I-PER       0.70      0.47      0.56       214
     B-MISC       0.07      0.01      0.02       141
     I-MISC       0.33      0.11      0.17       154
      B-LOC       0.78      0.34      0.48       218
      I-LOC       0.54      0.45      0.49       141

avg / total       0.87      0.84      0.85      9071

F-1 Score (without O):
0.435467980296
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104125 unique words.
4121 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 275
OOV word occurences: in test 448
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6664064     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,776,194
Trainable params: 6,776,194
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 4s 54ms/step - loss: 0.3318 - acc: 0.8998
Epoch 2/27

83/83 [==============================] - 3s 33ms/step - loss: 0.2226 - acc: 0.9068
Epoch 3/27

83/83 [==============================] - 3s 33ms/step - loss: 0.1457 - acc: 0.9569
Epoch 4/27

83/83 [==============================] - 3s 33ms/step - loss: 0.1168 - acc: 0.9628
Epoch 5/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0988 - acc: 0.9676
Epoch 6/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0877 - acc: 0.9757
Epoch 7/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0758 - acc: 0.9752
Epoch 8/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0691 - acc: 0.9763
Epoch 9/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0650 - acc: 0.9773
Epoch 10/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0615 - acc: 0.9781
Epoch 11/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0578 - acc: 0.9793
Epoch 12/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0570 - acc: 0.9789
Epoch 13/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0541 - acc: 0.9814
Epoch 14/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0531 - acc: 0.9807
Epoch 15/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0521 - acc: 0.9813
Epoch 16/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0494 - acc: 0.9813
Epoch 17/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0483 - acc: 0.9818
Epoch 18/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0446 - acc: 0.9836
Epoch 19/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0430 - acc: 0.9842
Epoch 20/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0415 - acc: 0.9851
Epoch 21/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0417 - acc: 0.9853
Epoch 22/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0387 - acc: 0.9869
Epoch 23/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0365 - acc: 0.9871
Epoch 24/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0362 - acc: 0.9875
Epoch 25/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0339 - acc: 0.9884
Epoch 26/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0331 - acc: 0.9892
Epoch 27/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0318 - acc: 0.9892
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7502
False 1569
True percentage 0.827031198324
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.72      0.56      0.63       438
          O       0.96      0.95      0.96      7318
      B-LOC       0.89      0.07      0.14       218
      B-ORG       0.32      0.56      0.41       296
      I-PER       0.56      0.38      0.45       214
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.25      0.01      0.01       154
      I-ORG       0.13      0.34      0.19       151
      I-LOC       0.88      0.05      0.09       141

avg / total       0.88      0.83      0.83      9071

F-1 Score (without O):
0.857886025065
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104108 unique words.
4104 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 278
OOV word occurences: in test 552
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6662976     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,106
Trainable params: 6,775,106
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 4s 53ms/step - loss: 0.3296 - acc: 0.8993
Epoch 2/27

83/83 [==============================] - 3s 32ms/step - loss: 0.2338 - acc: 0.9104
Epoch 3/27

83/83 [==============================] - 3s 32ms/step - loss: 0.1506 - acc: 0.9526
Epoch 4/27

83/83 [==============================] - 3s 32ms/step - loss: 0.1170 - acc: 0.9623
Epoch 5/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0969 - acc: 0.9672
Epoch 6/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0849 - acc: 0.9742
Epoch 7/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0774 - acc: 0.9741
Epoch 8/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0728 - acc: 0.9748
Epoch 9/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0691 - acc: 0.9757
Epoch 10/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0658 - acc: 0.9765
Epoch 11/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0628 - acc: 0.9779
Epoch 12/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0596 - acc: 0.9781
Epoch 13/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0581 - acc: 0.9790
Epoch 14/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0550 - acc: 0.9797
Epoch 15/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0533 - acc: 0.9804
Epoch 16/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0511 - acc: 0.9810
Epoch 17/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0479 - acc: 0.9817
Epoch 18/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0473 - acc: 0.9812
Epoch 19/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0447 - acc: 0.9830
Epoch 20/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0423 - acc: 0.9837
Epoch 21/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0405 - acc: 0.9839
Epoch 22/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0394 - acc: 0.9849
Epoch 23/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0372 - acc: 0.9855
Epoch 24/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0350 - acc: 0.9867
Epoch 25/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0329 - acc: 0.9884
Epoch 26/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0305 - acc: 0.9890
Epoch 27/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0301 - acc: 0.9895
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7466
False 1605
True percentage 0.82306250689
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.95      0.95      7318
     B-MISC       0.30      0.02      0.04       141
      B-ORG       0.36      0.45      0.40       296
     I-MISC       0.20      0.08      0.12       154
      B-LOC       0.78      0.37      0.50       218
      I-ORG       0.19      0.36      0.25       151
      B-PER       0.71      0.34      0.46       438
      I-PER       0.54      0.31      0.39       214
      I-LOC       0.67      0.03      0.05       141

avg / total       0.86      0.82      0.83      9071

F-1 Score (without O):
0.344827586207
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104113 unique words.
4109 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 279
OOV word occurences: in test 552
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663296     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,426
Trainable params: 6,775,426
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 4s 53ms/step - loss: 0.3128 - acc: 0.9011
Epoch 2/27

83/83 [==============================] - 3s 31ms/step - loss: 0.1923 - acc: 0.9257
Epoch 3/27

83/83 [==============================] - 3s 32ms/step - loss: 0.1330 - acc: 0.9627
Epoch 4/27

83/83 [==============================] - 3s 31ms/step - loss: 0.1121 - acc: 0.9656
Epoch 5/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0954 - acc: 0.9722
Epoch 6/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0839 - acc: 0.9736
Epoch 7/27

83/83 [==============================] - 3s 30ms/step - loss: 0.0762 - acc: 0.9733
Epoch 8/27

83/83 [==============================] - 2s 30ms/step - loss: 0.0705 - acc: 0.9757
Epoch 9/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0685 - acc: 0.9764
Epoch 10/27

83/83 [==============================] - 3s 30ms/step - loss: 0.0652 - acc: 0.9771
Epoch 11/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0615 - acc: 0.9784
Epoch 12/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0585 - acc: 0.9784
Epoch 13/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0572 - acc: 0.9790
Epoch 14/27

83/83 [==============================] - 3s 30ms/step - loss: 0.0549 - acc: 0.9800
Epoch 15/27

83/83 [==============================] - 3s 30ms/step - loss: 0.0517 - acc: 0.9811
Epoch 16/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0497 - acc: 0.9813
Epoch 17/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0481 - acc: 0.9813
Epoch 18/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0455 - acc: 0.9823
Epoch 19/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0430 - acc: 0.9837
Epoch 20/27

83/83 [==============================] - 3s 30ms/step - loss: 0.0412 - acc: 0.9845
Epoch 21/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0386 - acc: 0.9853
Epoch 22/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0383 - acc: 0.9859
Epoch 23/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0382 - acc: 0.9865
Epoch 24/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0336 - acc: 0.9875
Epoch 25/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0320 - acc: 0.9878
Epoch 26/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0310 - acc: 0.9883
Epoch 27/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0312 - acc: 0.9881
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7502
False 1569
True percentage 0.827031198324
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.46      0.50      0.48       296
          O       0.96      0.95      0.95      7318
     B-MISC       0.20      0.12      0.15       141
     I-MISC       0.18      0.38      0.24       154
      B-LOC       0.71      0.34      0.46       218
      I-LOC       0.00      0.00      0.00       141
      B-PER       0.69      0.42      0.52       438
      I-PER       0.65      0.30      0.41       214
      I-ORG       0.32      0.24      0.27       151

avg / total       0.87      0.83      0.84      9071

F-1 Score (without O):
0.866639165537
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 8
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104120 unique words.
4116 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 277
OOV word occurences: in test 465
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663744     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,874
Trainable params: 6,775,874
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 4s 53ms/step - loss: 0.3672 - acc: 0.8987
Epoch 2/27

83/83 [==============================] - 3s 32ms/step - loss: 0.2554 - acc: 0.9019
Epoch 3/27

83/83 [==============================] - 3s 32ms/step - loss: 0.1655 - acc: 0.9492
Epoch 4/27

83/83 [==============================] - 3s 31ms/step - loss: 0.1236 - acc: 0.9603
Epoch 5/27

83/83 [==============================] - 3s 31ms/step - loss: 0.1035 - acc: 0.9648
Epoch 6/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0956 - acc: 0.9701
Epoch 7/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0845 - acc: 0.9723
Epoch 8/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0774 - acc: 0.9731
Epoch 9/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0737 - acc: 0.9743
Epoch 10/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0712 - acc: 0.9746
Epoch 11/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0676 - acc: 0.9762
Epoch 12/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0663 - acc: 0.9767
Epoch 13/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0624 - acc: 0.9778
Epoch 14/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0614 - acc: 0.9780
Epoch 15/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0568 - acc: 0.9790
Epoch 16/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0550 - acc: 0.9790
Epoch 17/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0521 - acc: 0.9798
Epoch 18/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0496 - acc: 0.9809
Epoch 19/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0475 - acc: 0.9819
Epoch 20/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0463 - acc: 0.9823
Epoch 21/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0441 - acc: 0.9835
Epoch 22/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0408 - acc: 0.9847
Epoch 23/27

83/83 [==============================] - 3s 33ms/step - loss: 0.0388 - acc: 0.9860
Epoch 24/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0373 - acc: 0.9870
Epoch 25/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0348 - acc: 0.9885
Epoch 26/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0342 - acc: 0.9882
Epoch 27/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0318 - acc: 0.9893
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7612
False 1459
True percentage 0.839157755485
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.42      0.63      0.51       296
          O       0.96      0.95      0.96      7318
      B-LOC       0.67      0.50      0.57       218
      I-LOC       0.69      0.34      0.45       141
      I-ORG       0.16      0.28      0.20       151
      B-PER       0.73      0.42      0.53       438
      I-PER       0.46      0.37      0.41       214
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.87      0.84      0.85      9071

F-1 Score (without O):
0.876675128402
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 9
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104123 unique words.
4119 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 278
OOV word occurences: in test 449
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663936     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,776,066
Trainable params: 6,776,066
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 4s 53ms/step - loss: 0.3436 - acc: 0.8998
Epoch 2/27

83/83 [==============================] - 3s 32ms/step - loss: 0.2158 - acc: 0.9135
Epoch 3/27

83/83 [==============================] - 3s 31ms/step - loss: 0.1330 - acc: 0.9583
Epoch 4/27

83/83 [==============================] - 3s 32ms/step - loss: 0.1065 - acc: 0.9636
Epoch 5/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0920 - acc: 0.9708
Epoch 6/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0843 - acc: 0.9743
Epoch 7/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0766 - acc: 0.9749
Epoch 8/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0732 - acc: 0.9750
Epoch 9/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0685 - acc: 0.9765
Epoch 10/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0663 - acc: 0.9767
Epoch 11/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0640 - acc: 0.9766
Epoch 12/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0597 - acc: 0.9776
Epoch 13/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0574 - acc: 0.9787
Epoch 14/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0567 - acc: 0.9778
Epoch 15/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0544 - acc: 0.9787
Epoch 16/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0538 - acc: 0.9792
Epoch 17/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0495 - acc: 0.9802
Epoch 18/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0475 - acc: 0.9814
Epoch 19/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0464 - acc: 0.9816
Epoch 20/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0442 - acc: 0.9832
Epoch 21/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0426 - acc: 0.9843
Epoch 22/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0402 - acc: 0.9852
Epoch 23/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0388 - acc: 0.9856
Epoch 24/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0375 - acc: 0.9864
Epoch 25/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0348 - acc: 0.9874
Epoch 26/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0341 - acc: 0.9872
Epoch 27/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0326 - acc: 0.9886
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7632
False 1439
True percentage 0.841362584059
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.95      0.95      7318
      B-LOC       0.66      0.62      0.64       218
      I-LOC       0.28      0.06      0.09       141
      B-ORG       0.49      0.56      0.52       296
      B-PER       0.70      0.52      0.60       438
      I-PER       0.66      0.38      0.49       214
      I-ORG       0.20      0.44      0.28       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.67      0.01      0.03       154

avg / total       0.87      0.84      0.85      9071

F-1 Score (without O):
0.443444730077
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 10
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104117 unique words.
4113 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 279
OOV word occurences: in test 469
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663552     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,682
Trainable params: 6,775,682
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 4s 52ms/step - loss: 0.3055 - acc: 0.9029
Epoch 2/27

83/83 [==============================] - 3s 31ms/step - loss: 0.1852 - acc: 0.9394
Epoch 3/27

83/83 [==============================] - 3s 31ms/step - loss: 0.1329 - acc: 0.9581
Epoch 4/27

83/83 [==============================] - 3s 31ms/step - loss: 0.1150 - acc: 0.9622
Epoch 5/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0969 - acc: 0.9706
Epoch 6/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0900 - acc: 0.9732
Epoch 7/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0802 - acc: 0.9740
Epoch 8/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0777 - acc: 0.9733
Epoch 9/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0733 - acc: 0.9741
Epoch 10/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0702 - acc: 0.9750
Epoch 11/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0674 - acc: 0.9749
Epoch 12/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0640 - acc: 0.9766
Epoch 13/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0603 - acc: 0.9769
Epoch 14/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0590 - acc: 0.9781
Epoch 15/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0557 - acc: 0.9785
Epoch 16/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0525 - acc: 0.9807
Epoch 17/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0509 - acc: 0.9812
Epoch 18/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0496 - acc: 0.9808
Epoch 19/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0463 - acc: 0.9827
Epoch 20/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0450 - acc: 0.9829
Epoch 21/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0429 - acc: 0.9831
Epoch 22/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0399 - acc: 0.9842
Epoch 23/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0387 - acc: 0.9850
Epoch 24/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0364 - acc: 0.9859
Epoch 25/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0340 - acc: 0.9873
Epoch 26/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0321 - acc: 0.9881
Epoch 27/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0309 - acc: 0.9887
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7688
False 1383
True percentage 0.847536104068
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-ORG       0.50      0.60      0.55       296
      I-ORG       0.22      0.42      0.29       151
      B-LOC       0.58      0.56      0.57       218
      B-PER       0.69      0.60      0.64       438
      I-PER       0.84      0.29      0.43       214
     B-MISC       0.44      0.05      0.09       141
     I-MISC       0.29      0.19      0.23       154
      I-LOC       0.66      0.25      0.36       141

avg / total       0.89      0.85      0.86      9071

F-1 Score (without O):
0.469786179114
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 11
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104115 unique words.
4111 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 280
OOV word occurences: in test 495
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663424     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,554
Trainable params: 6,775,554
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 4s 52ms/step - loss: 0.3258 - acc: 0.8999
Epoch 2/27

83/83 [==============================] - 3s 31ms/step - loss: 0.2426 - acc: 0.9043
Epoch 3/27

83/83 [==============================] - 3s 31ms/step - loss: 0.1617 - acc: 0.9458
Epoch 4/27

83/83 [==============================] - 3s 31ms/step - loss: 0.1167 - acc: 0.9622
Epoch 5/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0952 - acc: 0.9680
Epoch 6/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0872 - acc: 0.9747
Epoch 7/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0753 - acc: 0.9753
Epoch 8/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0724 - acc: 0.9754
Epoch 9/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0689 - acc: 0.9755
Epoch 10/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0651 - acc: 0.9765
Epoch 11/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0616 - acc: 0.9773
Epoch 12/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0586 - acc: 0.9779
Epoch 13/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0560 - acc: 0.9781
Epoch 14/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0554 - acc: 0.9782
Epoch 15/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0535 - acc: 0.9787
Epoch 16/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0511 - acc: 0.9796
Epoch 17/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0508 - acc: 0.9796
Epoch 18/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0484 - acc: 0.9806
Epoch 19/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0466 - acc: 0.9816
Epoch 20/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0444 - acc: 0.9830
Epoch 21/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0423 - acc: 0.9841
Epoch 22/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0406 - acc: 0.9853
Epoch 23/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0388 - acc: 0.9857
Epoch 24/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0356 - acc: 0.9868
Epoch 25/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0356 - acc: 0.9872
Epoch 26/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0338 - acc: 0.9878
Epoch 27/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0308 - acc: 0.9895
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7609
False 1462
True percentage 0.838827031198
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.94      0.95      7318
      B-ORG       0.48      0.39      0.43       296
      I-ORG       0.21      0.22      0.21       151
     B-MISC       0.26      0.17      0.21       141
      B-LOC       0.70      0.46      0.56       218
      B-PER       0.65      0.55      0.60       438
     I-MISC       0.38      0.23      0.28       154
      I-PER       0.57      0.56      0.57       214
      I-LOC       0.68      0.35      0.47       141

avg / total       0.87      0.84      0.85      9071

F-1 Score (without O):
0.459476707084
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104096 unique words.
4092 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 277
OOV word occurences: in test 557
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6662208     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,774,338
Trainable params: 6,774,338
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

83/83 [==============================] - 4s 52ms/step - loss: 0.2783 - acc: 0.9002
Epoch 2/27

83/83 [==============================] - 3s 31ms/step - loss: 0.1515 - acc: 0.9529
Epoch 3/27

83/83 [==============================] - 3s 31ms/step - loss: 0.1015 - acc: 0.9693
Epoch 4/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0964 - acc: 0.9689
Epoch 5/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0791 - acc: 0.9748
Epoch 6/27

83/83 [==============================] - 3s 30ms/step - loss: 0.0762 - acc: 0.9770
Epoch 7/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0712 - acc: 0.9779
Epoch 8/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0652 - acc: 0.9794
Epoch 9/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0610 - acc: 0.9796
Epoch 10/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0606 - acc: 0.9796
Epoch 11/27

83/83 [==============================] - 3s 30ms/step - loss: 0.0556 - acc: 0.9806
Epoch 12/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0530 - acc: 0.9810
Epoch 13/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0508 - acc: 0.9818
Epoch 14/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0500 - acc: 0.9814
Epoch 15/27

83/83 [==============================] - 3s 30ms/step - loss: 0.0466 - acc: 0.9822
Epoch 16/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0443 - acc: 0.9827
Epoch 17/27

83/83 [==============================] - 3s 30ms/step - loss: 0.0432 - acc: 0.9833
Epoch 18/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0414 - acc: 0.9831
Epoch 19/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0390 - acc: 0.9847
Epoch 20/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0368 - acc: 0.9849
Epoch 21/27

83/83 [==============================] - 3s 32ms/step - loss: 0.0354 - acc: 0.9852
Epoch 22/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0329 - acc: 0.9865
Epoch 23/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0323 - acc: 0.9870
Epoch 24/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0301 - acc: 0.9881
Epoch 25/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0287 - acc: 0.9889
Epoch 26/27

83/83 [==============================] - 3s 31ms/step - loss: 0.0268 - acc: 0.9898
Epoch 27/27

83/83 [==============================] - 3s 30ms/step - loss: 0.0249 - acc: 0.9907
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7531
False 1540
True percentage 0.830228199757
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.94      0.95      7318
      B-PER       0.53      0.37      0.44       438
      B-ORG       0.46      0.45      0.46       296
     B-MISC       0.22      0.12      0.16       141
      I-PER       0.52      0.39      0.44       214
      I-ORG       0.27      0.27      0.27       151
     I-MISC       0.31      0.21      0.25       154
      B-LOC       0.77      0.40      0.53       218
      I-LOC       0.56      0.43      0.48       141

avg / total       0.87      0.83      0.85      9071

F-1 Score (without O):
0.403388725969
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104057 unique words.
4053 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 558
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659712     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,842
Trainable params: 6,771,842
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 3s 88ms/step - loss: 0.2976 - acc: 0.9000
Epoch 2/27

33/33 [==============================] - 1s 35ms/step - loss: 0.2407 - acc: 0.9039
Epoch 3/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1916 - acc: 0.9254
Epoch 4/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1568 - acc: 0.9561
Epoch 5/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1365 - acc: 0.9598
Epoch 6/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1248 - acc: 0.9604
Epoch 7/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1169 - acc: 0.9611
Epoch 8/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1083 - acc: 0.9619
Epoch 9/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1009 - acc: 0.9680
Epoch 10/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0952 - acc: 0.9707
Epoch 11/27

33/33 [==============================] - 1s 36ms/step - loss: 0.0937 - acc: 0.9714
Epoch 12/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0872 - acc: 0.9738
Epoch 13/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0856 - acc: 0.9740
Epoch 14/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0824 - acc: 0.9745
Epoch 15/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0797 - acc: 0.9728
Epoch 16/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0741 - acc: 0.9757
Epoch 17/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0733 - acc: 0.9748
Epoch 18/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0741 - acc: 0.9744
Epoch 19/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0737 - acc: 0.9730
Epoch 20/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0688 - acc: 0.9741
Epoch 21/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0690 - acc: 0.9750
Epoch 22/27

33/33 [==============================] - 1s 36ms/step - loss: 0.0678 - acc: 0.9762
Epoch 23/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0654 - acc: 0.9760
Epoch 24/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0625 - acc: 0.9769
Epoch 25/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0609 - acc: 0.9762
Epoch 26/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0617 - acc: 0.9757
Epoch 27/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0604 - acc: 0.9764
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7303
False 1768
True percentage 0.805093154007
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.94      0.95      7318
      B-LOC       0.78      0.24      0.37       218
      I-LOC       0.00      0.00      0.00       141
      B-PER       0.75      0.15      0.24       438
      B-ORG       0.28      0.57      0.38       296
      I-ORG       0.16      0.15      0.15       151
     B-MISC       0.88      0.05      0.09       141
     I-MISC       0.19      0.51      0.27       154
      I-PER       0.55      0.14      0.23       214

avg / total       0.87      0.81      0.82      9071

F-1 Score (without O):
0.271218889598
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104066 unique words.
4062 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 277
OOV word occurences: in test 468
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660288     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,418
Trainable params: 6,772,418
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 3s 87ms/step - loss: 0.3257 - acc: 0.9000
Epoch 2/27

33/33 [==============================] - 1s 34ms/step - loss: 0.2685 - acc: 0.8999
Epoch 3/27

33/33 [==============================] - 1s 35ms/step - loss: 0.2188 - acc: 0.9039
Epoch 4/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1775 - acc: 0.9347
Epoch 5/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1518 - acc: 0.9524
Epoch 6/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1390 - acc: 0.9550
Epoch 7/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1301 - acc: 0.9546
Epoch 8/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1129 - acc: 0.9618
Epoch 9/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1081 - acc: 0.9693
Epoch 10/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1009 - acc: 0.9707
Epoch 11/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0941 - acc: 0.9710
Epoch 12/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0923 - acc: 0.9709
Epoch 13/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0881 - acc: 0.9712
Epoch 14/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0842 - acc: 0.9716
Epoch 15/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0832 - acc: 0.9708
Epoch 16/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0811 - acc: 0.9726
Epoch 17/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0780 - acc: 0.9734
Epoch 18/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0768 - acc: 0.9739
Epoch 19/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0754 - acc: 0.9725
Epoch 20/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0710 - acc: 0.9751
Epoch 21/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0702 - acc: 0.9733
Epoch 22/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0670 - acc: 0.9745
Epoch 23/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0677 - acc: 0.9749
Epoch 24/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0643 - acc: 0.9754
Epoch 25/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0663 - acc: 0.9738
Epoch 26/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0618 - acc: 0.9760
Epoch 27/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0623 - acc: 0.9762
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7336
False 1735
True percentage 0.808731121155
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.57      0.31      0.40       438
      I-PER       0.40      0.31      0.35       214
          O       0.92      0.95      0.93      7318
      B-ORG       0.35      0.47      0.40       296
      I-ORG       0.17      0.28      0.21       151
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.79      0.81      0.80      9071

F-1 Score (without O):
0.847343961409
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104055 unique words.
4051 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 280
OOV word occurences: in test 496
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659584     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,714
Trainable params: 6,771,714
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 3s 88ms/step - loss: 0.3445 - acc: 0.8976
Epoch 2/27

33/33 [==============================] - 1s 34ms/step - loss: 0.2781 - acc: 0.9004
Epoch 3/27

33/33 [==============================] - 1s 34ms/step - loss: 0.2209 - acc: 0.9130
Epoch 4/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1743 - acc: 0.9414
Epoch 5/27

33/33 [==============================] - 1s 33ms/step - loss: 0.1420 - acc: 0.9578
Epoch 6/27

33/33 [==============================] - 1s 33ms/step - loss: 0.1223 - acc: 0.9600
Epoch 7/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1116 - acc: 0.9633
Epoch 8/27

33/33 [==============================] - 1s 33ms/step - loss: 0.1015 - acc: 0.9667
Epoch 9/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0915 - acc: 0.9712
Epoch 10/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0869 - acc: 0.9727
Epoch 11/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0823 - acc: 0.9741
Epoch 12/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0802 - acc: 0.9736
Epoch 13/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0753 - acc: 0.9751
Epoch 14/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0762 - acc: 0.9729
Epoch 15/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0713 - acc: 0.9752
Epoch 16/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0717 - acc: 0.9746
Epoch 17/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0699 - acc: 0.9756
Epoch 18/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0671 - acc: 0.9762
Epoch 19/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0645 - acc: 0.9774
Epoch 20/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0652 - acc: 0.9775
Epoch 21/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0616 - acc: 0.9789
Epoch 22/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0600 - acc: 0.9802
Epoch 23/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0613 - acc: 0.9781
Epoch 24/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0581 - acc: 0.9813
Epoch 25/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0556 - acc: 0.9821
Epoch 26/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0547 - acc: 0.9830
Epoch 27/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0540 - acc: 0.9824
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7240
False 1831
True percentage 0.798147943997
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.94      0.94      7318
      B-PER       0.71      0.37      0.49       438
      B-LOC       0.67      0.03      0.05       218
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-ORG       0.26      0.44      0.32       296
      I-ORG       0.13      0.53      0.21       151
      I-LOC       0.00      0.00      0.00       141
      I-PER       0.00      0.00      0.00       214

avg / total       0.83      0.80      0.80      9071

F-1 Score (without O):
0.242443729904
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104065 unique words.
4061 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 279
OOV word occurences: in test 552
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660224     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,354
Trainable params: 6,772,354
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 3s 87ms/step - loss: 0.4146 - acc: 0.9000
Epoch 2/27

33/33 [==============================] - 1s 32ms/step - loss: 0.3524 - acc: 0.9000
Epoch 3/27

33/33 [==============================] - 1s 34ms/step - loss: 0.3004 - acc: 0.9000
Epoch 4/27

33/33 [==============================] - 1s 33ms/step - loss: 0.2447 - acc: 0.9006
Epoch 5/27

33/33 [==============================] - 1s 33ms/step - loss: 0.1933 - acc: 0.9244
Epoch 6/27

33/33 [==============================] - 1s 33ms/step - loss: 0.1522 - acc: 0.9554
Epoch 7/27

33/33 [==============================] - 1s 33ms/step - loss: 0.1310 - acc: 0.9600
Epoch 8/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1255 - acc: 0.9593
Epoch 9/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1146 - acc: 0.9598
Epoch 10/27

33/33 [==============================] - 1s 33ms/step - loss: 0.1044 - acc: 0.9661
Epoch 11/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0965 - acc: 0.9696
Epoch 12/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0945 - acc: 0.9710
Epoch 13/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0893 - acc: 0.9721
Epoch 14/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0859 - acc: 0.9717
Epoch 15/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0837 - acc: 0.9723
Epoch 16/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0819 - acc: 0.9727
Epoch 17/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0802 - acc: 0.9715
Epoch 18/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0770 - acc: 0.9733
Epoch 19/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0782 - acc: 0.9733
Epoch 20/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0788 - acc: 0.9722
Epoch 21/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0746 - acc: 0.9735
Epoch 22/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0716 - acc: 0.9745
Epoch 23/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0695 - acc: 0.9745
Epoch 24/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0689 - acc: 0.9742
Epoch 25/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0671 - acc: 0.9761
Epoch 26/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0656 - acc: 0.9762
Epoch 27/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0641 - acc: 0.9767
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7166
False 1905
True percentage 0.789990078271
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.93      0.94      7318
      B-ORG       0.24      0.48      0.32       296
      I-ORG       0.13      0.32      0.19       151
      B-PER       0.52      0.25      0.34       438
      I-PER       0.50      0.01      0.03       214
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.27      0.18      0.21       154

avg / total       0.81      0.79      0.79      9071

F-1 Score (without O):
0.218277449047
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104066 unique words.
4062 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 280
OOV word occurences: in test 496
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660288     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,418
Trainable params: 6,772,418
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 3s 87ms/step - loss: 0.3752 - acc: 0.8999
Epoch 2/27

33/33 [==============================] - 1s 35ms/step - loss: 0.3018 - acc: 0.9004
Epoch 3/27

33/33 [==============================] - 1s 35ms/step - loss: 0.2358 - acc: 0.9123
Epoch 4/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1839 - acc: 0.9419
Epoch 5/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1487 - acc: 0.9508
Epoch 6/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1342 - acc: 0.9565
Epoch 7/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1249 - acc: 0.9576
Epoch 8/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1121 - acc: 0.9625
Epoch 9/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1019 - acc: 0.9681
Epoch 10/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0962 - acc: 0.9726
Epoch 11/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0938 - acc: 0.9741
Epoch 12/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0883 - acc: 0.9748
Epoch 13/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0826 - acc: 0.9749
Epoch 14/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0805 - acc: 0.9762
Epoch 15/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0769 - acc: 0.9762
Epoch 16/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0766 - acc: 0.9756
Epoch 17/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0749 - acc: 0.9758
Epoch 18/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0719 - acc: 0.9765
Epoch 19/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0697 - acc: 0.9770
Epoch 20/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0695 - acc: 0.9767
Epoch 21/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0686 - acc: 0.9768
Epoch 22/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0670 - acc: 0.9761
Epoch 23/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0662 - acc: 0.9763
Epoch 24/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0632 - acc: 0.9775
Epoch 25/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0622 - acc: 0.9775
Epoch 26/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0620 - acc: 0.9777
Epoch 27/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0597 - acc: 0.9779
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7267
False 1804
True percentage 0.801124462573
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.91      0.95      0.93      7318
      B-ORG       0.32      0.34      0.33       296
      I-ORG       0.33      0.03      0.06       151
      B-PER       0.44      0.28      0.34       438
      I-PER       1.00      0.03      0.06       214
     B-MISC       0.06      0.09      0.07       141
     I-MISC       0.14      0.02      0.03       154
      B-LOC       0.35      0.04      0.07       218
      I-LOC       0.51      0.25      0.33       141

avg / total       0.82      0.80      0.79      9071

F-1 Score (without O):
0.217439703154
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104075 unique words.
4071 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 281
OOV word occurences: in test 539
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660864     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,994
Trainable params: 6,772,994
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 3s 87ms/step - loss: 0.3595 - acc: 0.9000
Epoch 2/27

33/33 [==============================] - 1s 35ms/step - loss: 0.2982 - acc: 0.9001
Epoch 3/27

33/33 [==============================] - 1s 34ms/step - loss: 0.2390 - acc: 0.9075
Epoch 4/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1894 - acc: 0.9277
Epoch 5/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1482 - acc: 0.9555
Epoch 6/27

33/33 [==============================] - 1s 36ms/step - loss: 0.1221 - acc: 0.9644
Epoch 7/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1145 - acc: 0.9624
Epoch 8/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1049 - acc: 0.9648
Epoch 9/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0937 - acc: 0.9678
Epoch 10/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0875 - acc: 0.9729
Epoch 11/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0851 - acc: 0.9737
Epoch 12/27

33/33 [==============================] - 1s 36ms/step - loss: 0.0830 - acc: 0.9741
Epoch 13/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0775 - acc: 0.9747
Epoch 14/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0736 - acc: 0.9756
Epoch 15/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0710 - acc: 0.9761
Epoch 16/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0700 - acc: 0.9760
Epoch 17/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0690 - acc: 0.9756
Epoch 18/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0671 - acc: 0.9767
Epoch 19/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0652 - acc: 0.9768
Epoch 20/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0627 - acc: 0.9771
Epoch 21/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0623 - acc: 0.9769
Epoch 22/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0594 - acc: 0.9777
Epoch 23/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0601 - acc: 0.9773
Epoch 24/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0569 - acc: 0.9785
Epoch 25/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0548 - acc: 0.9789
Epoch 26/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0548 - acc: 0.9786
Epoch 27/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0552 - acc: 0.9803
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7254
False 1817
True percentage 0.799691324
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.30      0.38      0.34       438
          O       0.95      0.94      0.94      7318
      B-LOC       0.00      0.00      0.00       218
      B-ORG       0.32      0.40      0.36       296
      I-PER       0.41      0.32      0.36       214
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      I-ORG       0.19      0.24      0.21       151
      I-LOC       0.00      0.00      0.00       141

avg / total       0.80      0.80      0.80      9071

F-1 Score (without O):
0.852948255114
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104056 unique words.
4052 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 281
OOV word occurences: in test 556
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659648     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,778
Trainable params: 6,771,778
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 3s 87ms/step - loss: 0.3366 - acc: 0.8998
Epoch 2/27

33/33 [==============================] - 1s 34ms/step - loss: 0.2699 - acc: 0.8999
Epoch 3/27

33/33 [==============================] - 1s 34ms/step - loss: 0.2082 - acc: 0.9141
Epoch 4/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1574 - acc: 0.9536
Epoch 5/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1295 - acc: 0.9620
Epoch 6/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1172 - acc: 0.9596
Epoch 7/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1079 - acc: 0.9626
Epoch 8/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0973 - acc: 0.9696
Epoch 9/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0915 - acc: 0.9723
Epoch 10/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0885 - acc: 0.9720
Epoch 11/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0839 - acc: 0.9737
Epoch 12/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0774 - acc: 0.9765
Epoch 13/27

33/33 [==============================] - 1s 36ms/step - loss: 0.0750 - acc: 0.9759
Epoch 14/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0729 - acc: 0.9744
Epoch 15/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0691 - acc: 0.9768
Epoch 16/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0677 - acc: 0.9763
Epoch 17/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0681 - acc: 0.9759
Epoch 18/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0638 - acc: 0.9770
Epoch 19/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0655 - acc: 0.9763
Epoch 20/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0645 - acc: 0.9759
Epoch 21/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0589 - acc: 0.9791
Epoch 22/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0594 - acc: 0.9790
Epoch 23/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0598 - acc: 0.9780
Epoch 24/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0576 - acc: 0.9780
Epoch 25/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0545 - acc: 0.9791
Epoch 26/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0553 - acc: 0.9792
Epoch 27/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0514 - acc: 0.9798
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7300
False 1771
True percentage 0.804762429721
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.95      0.95      7318
     B-MISC       0.00      0.00      0.00       141
      B-ORG       0.22      0.50      0.30       296
     I-MISC       0.50      0.04      0.07       154
      B-LOC       0.70      0.18      0.29       218
      I-ORG       0.23      0.39      0.29       151
      B-PER       0.41      0.12      0.19       438
      I-PER       0.44      0.28      0.34       214
      I-LOC       0.00      0.00      0.00       141

avg / total       0.84      0.80      0.81      9071

F-1 Score (without O):
0.24238410596
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104062 unique words.
4058 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 281
OOV word occurences: in test 562
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660032     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,162
Trainable params: 6,772,162
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 3s 87ms/step - loss: 0.2890 - acc: 0.8997
Epoch 2/27

33/33 [==============================] - 1s 33ms/step - loss: 0.2271 - acc: 0.9080
Epoch 3/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1786 - acc: 0.9334
Epoch 4/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1464 - acc: 0.9510
Epoch 5/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1268 - acc: 0.9610
Epoch 6/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1186 - acc: 0.9626
Epoch 7/27

33/33 [==============================] - 1s 33ms/step - loss: 0.1075 - acc: 0.9643
Epoch 8/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0971 - acc: 0.9699
Epoch 9/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0920 - acc: 0.9730
Epoch 10/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0886 - acc: 0.9739
Epoch 11/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0813 - acc: 0.9751
Epoch 12/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0756 - acc: 0.9764
Epoch 13/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0728 - acc: 0.9765
Epoch 14/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0721 - acc: 0.9759
Epoch 15/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0686 - acc: 0.9771
Epoch 16/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0695 - acc: 0.9765
Epoch 17/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0661 - acc: 0.9769
Epoch 18/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0640 - acc: 0.9773
Epoch 19/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0625 - acc: 0.9776
Epoch 20/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0600 - acc: 0.9786
Epoch 21/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0609 - acc: 0.9781
Epoch 22/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0586 - acc: 0.9779
Epoch 23/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0565 - acc: 0.9790
Epoch 24/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0578 - acc: 0.9784
Epoch 25/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0568 - acc: 0.9796
Epoch 26/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0546 - acc: 0.9793
Epoch 27/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0495 - acc: 0.9808
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7238
False 1833
True percentage 0.79792746114
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.31      0.33      0.32       296
          O       0.92      0.95      0.94      7318
     B-MISC       0.13      0.04      0.06       141
     I-MISC       0.15      0.36      0.21       154
      B-LOC       0.45      0.02      0.04       218
      I-LOC       0.00      0.00      0.00       141
      B-PER       0.57      0.18      0.28       438
      I-PER       0.60      0.18      0.28       214
      I-ORG       0.00      0.00      0.00       151

avg / total       0.81      0.80      0.79      9071

F-1 Score (without O):
0.841354933726
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 8
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104068 unique words.
4064 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 280
OOV word occurences: in test 476
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660416     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,546
Trainable params: 6,772,546
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 3s 91ms/step - loss: 0.3642 - acc: 0.8996
Epoch 2/27

33/33 [==============================] - 1s 34ms/step - loss: 0.2925 - acc: 0.9000
Epoch 3/27

33/33 [==============================] - 1s 34ms/step - loss: 0.2315 - acc: 0.9043
Epoch 4/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1771 - acc: 0.9392
Epoch 5/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1365 - acc: 0.9606
Epoch 6/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1203 - acc: 0.9613
Epoch 7/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1111 - acc: 0.9634
Epoch 8/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1075 - acc: 0.9642
Epoch 9/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0947 - acc: 0.9668
Epoch 10/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0828 - acc: 0.9706
Epoch 11/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0825 - acc: 0.9728
Epoch 12/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0774 - acc: 0.9757
Epoch 13/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0726 - acc: 0.9754
Epoch 14/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0694 - acc: 0.9758
Epoch 15/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0697 - acc: 0.9754
Epoch 16/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0648 - acc: 0.9778
Epoch 17/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0638 - acc: 0.9786
Epoch 18/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0611 - acc: 0.9793
Epoch 19/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0584 - acc: 0.9801
Epoch 20/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0573 - acc: 0.9803
Epoch 21/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0551 - acc: 0.9803
Epoch 22/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0527 - acc: 0.9815
Epoch 23/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0515 - acc: 0.9809
Epoch 24/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0507 - acc: 0.9810
Epoch 25/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0489 - acc: 0.9818
Epoch 26/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0496 - acc: 0.9819
Epoch 27/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0455 - acc: 0.9823
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7384
False 1687
True percentage 0.814022709734
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.34      0.54      0.42       296
          O       0.92      0.96      0.94      7318
      B-LOC       1.00      0.03      0.05       218
      I-LOC       0.41      0.13      0.20       141
      I-ORG       1.00      0.01      0.01       151
      B-PER       0.47      0.29      0.36       438
      I-PER       0.45      0.36      0.40       214
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.83      0.81      0.80      9071

F-1 Score (without O):
0.854843481863
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 9
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104066 unique words.
4062 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 558
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660288     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,418
Trainable params: 6,772,418
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 3s 88ms/step - loss: 0.3103 - acc: 0.9023
Epoch 2/27

33/33 [==============================] - 1s 33ms/step - loss: 0.2387 - acc: 0.9095
Epoch 3/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1849 - acc: 0.9292
Epoch 4/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1479 - acc: 0.9547
Epoch 5/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1375 - acc: 0.9587
Epoch 6/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1333 - acc: 0.9589
Epoch 7/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1276 - acc: 0.9586
Epoch 8/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1095 - acc: 0.9607
Epoch 9/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1029 - acc: 0.9650
Epoch 10/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0962 - acc: 0.9705
Epoch 11/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0948 - acc: 0.9729
Epoch 12/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0909 - acc: 0.9728
Epoch 13/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0857 - acc: 0.9736
Epoch 14/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0828 - acc: 0.9729
Epoch 15/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0779 - acc: 0.9743
Epoch 16/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0750 - acc: 0.9750
Epoch 17/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0752 - acc: 0.9750
Epoch 18/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0708 - acc: 0.9755
Epoch 19/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0693 - acc: 0.9751
Epoch 20/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0696 - acc: 0.9751
Epoch 21/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0646 - acc: 0.9772
Epoch 22/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0655 - acc: 0.9762
Epoch 23/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0643 - acc: 0.9766
Epoch 24/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0630 - acc: 0.9773
Epoch 25/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0613 - acc: 0.9768
Epoch 26/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0587 - acc: 0.9779
Epoch 27/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0583 - acc: 0.9773
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7327
False 1744
True percentage 0.807738948297
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.91      0.96      0.93      7318
      B-LOC       0.48      0.36      0.41       218
      I-LOC       0.29      0.24      0.26       141
      B-ORG       0.31      0.32      0.32       296
      B-PER       0.54      0.25      0.34       438
      I-PER       0.00      0.00      0.00       214
      I-ORG       0.23      0.02      0.04       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.47      0.05      0.08       154

avg / total       0.80      0.81      0.80      9071

F-1 Score (without O):
0.253575570158
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 10
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104064 unique words.
4060 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660160     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,290
Trainable params: 6,772,290
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 3s 88ms/step - loss: 0.3776 - acc: 0.8995
Epoch 2/27

33/33 [==============================] - 1s 34ms/step - loss: 0.3124 - acc: 0.9001
Epoch 3/27

33/33 [==============================] - 1s 34ms/step - loss: 0.2503 - acc: 0.9061
Epoch 4/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1947 - acc: 0.9221
Epoch 5/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1499 - acc: 0.9565
Epoch 6/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1239 - acc: 0.9642
Epoch 7/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1169 - acc: 0.9630
Epoch 8/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1133 - acc: 0.9627
Epoch 9/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1017 - acc: 0.9656
Epoch 10/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0929 - acc: 0.9695
Epoch 11/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0856 - acc: 0.9757
Epoch 12/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0811 - acc: 0.9774
Epoch 13/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0800 - acc: 0.9758
Epoch 14/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0752 - acc: 0.9767
Epoch 15/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0726 - acc: 0.9768
Epoch 16/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0668 - acc: 0.9771
Epoch 17/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0671 - acc: 0.9768
Epoch 18/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0640 - acc: 0.9775
Epoch 19/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0656 - acc: 0.9768
Epoch 20/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0628 - acc: 0.9774
Epoch 21/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0613 - acc: 0.9775
Epoch 22/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0614 - acc: 0.9773
Epoch 23/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0585 - acc: 0.9781
Epoch 24/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0576 - acc: 0.9777
Epoch 25/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0566 - acc: 0.9778
Epoch 26/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0569 - acc: 0.9777
Epoch 27/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0541 - acc: 0.9787
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7271
False 1800
True percentage 0.801565428288
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.93      0.95      7318
      B-ORG       0.33      0.36      0.35       296
      I-ORG       0.16      0.48      0.24       151
      B-LOC       0.43      0.54      0.48       218
      B-PER       0.43      0.36      0.39       438
      I-PER       0.00      0.00      0.00       214
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      I-LOC       0.00      0.00      0.00       141

avg / total       0.82      0.80      0.81      9071

F-1 Score (without O):
0.286346396966
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 11
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104067 unique words.
4063 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660352     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,482
Trainable params: 6,772,482
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 3s 88ms/step - loss: 0.3106 - acc: 0.9000
Epoch 2/27

33/33 [==============================] - 1s 34ms/step - loss: 0.2501 - acc: 0.9078
Epoch 3/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1995 - acc: 0.9355
Epoch 4/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1602 - acc: 0.9489
Epoch 5/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1359 - acc: 0.9577
Epoch 6/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1282 - acc: 0.9590
Epoch 7/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1181 - acc: 0.9602
Epoch 8/27

33/33 [==============================] - 1s 35ms/step - loss: 0.1048 - acc: 0.9662
Epoch 9/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1009 - acc: 0.9691
Epoch 10/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0977 - acc: 0.9704
Epoch 11/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0946 - acc: 0.9705
Epoch 12/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0887 - acc: 0.9722
Epoch 13/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0858 - acc: 0.9728
Epoch 14/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0826 - acc: 0.9721
Epoch 15/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0817 - acc: 0.9726
Epoch 16/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0762 - acc: 0.9730
Epoch 17/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0731 - acc: 0.9748
Epoch 18/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0722 - acc: 0.9738
Epoch 19/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0701 - acc: 0.9745
Epoch 20/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0670 - acc: 0.9755
Epoch 21/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0659 - acc: 0.9737
Epoch 22/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0651 - acc: 0.9739
Epoch 23/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0627 - acc: 0.9750
Epoch 24/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0598 - acc: 0.9758
Epoch 25/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0577 - acc: 0.9772
Epoch 26/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0572 - acc: 0.9768
Epoch 27/27

33/33 [==============================] - 1s 35ms/step - loss: 0.0550 - acc: 0.9779
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7247
False 1824
True percentage 0.798919633998
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.94      0.95      7318
      B-ORG       0.23      0.52      0.32       296
      I-ORG       0.14      0.38      0.20       151
     B-MISC       1.00      0.01      0.01       141
      B-LOC       1.00      0.08      0.15       218
      B-PER       0.74      0.29      0.41       438
     I-MISC       0.00      0.00      0.00       154
      I-PER       0.56      0.04      0.08       214
      I-LOC       0.00      0.00      0.00       141

avg / total       0.87      0.80      0.80      9071

F-1 Score (without O):
0.239316239316
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104057 unique words.
4053 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 280
OOV word occurences: in test 560
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659712     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,842
Trainable params: 6,771,842
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

33/33 [==============================] - 3s 88ms/step - loss: 0.3391 - acc: 0.8995
Epoch 2/27

33/33 [==============================] - 1s 33ms/step - loss: 0.2782 - acc: 0.9000
Epoch 3/27

33/33 [==============================] - 1s 33ms/step - loss: 0.2269 - acc: 0.9063
Epoch 4/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1825 - acc: 0.9358
Epoch 5/27

33/33 [==============================] - 1s 33ms/step - loss: 0.1459 - acc: 0.9631
Epoch 6/27

33/33 [==============================] - 1s 33ms/step - loss: 0.1169 - acc: 0.9684
Epoch 7/27

33/33 [==============================] - 1s 33ms/step - loss: 0.1049 - acc: 0.9681
Epoch 8/27

33/33 [==============================] - 1s 34ms/step - loss: 0.1022 - acc: 0.9674
Epoch 9/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0919 - acc: 0.9690
Epoch 10/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0816 - acc: 0.9724
Epoch 11/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0743 - acc: 0.9788
Epoch 12/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0711 - acc: 0.9801
Epoch 13/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0682 - acc: 0.9804
Epoch 14/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0658 - acc: 0.9801
Epoch 15/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0616 - acc: 0.9804
Epoch 16/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0606 - acc: 0.9802
Epoch 17/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0585 - acc: 0.9808
Epoch 18/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0592 - acc: 0.9801
Epoch 19/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0559 - acc: 0.9812
Epoch 20/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0550 - acc: 0.9811
Epoch 21/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0545 - acc: 0.9813
Epoch 22/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0530 - acc: 0.9824
Epoch 23/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0512 - acc: 0.9837
Epoch 24/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0507 - acc: 0.9828
Epoch 25/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0484 - acc: 0.9834
Epoch 26/27

33/33 [==============================] - 1s 33ms/step - loss: 0.0500 - acc: 0.9824
Epoch 27/27

33/33 [==============================] - 1s 34ms/step - loss: 0.0468 - acc: 0.9836
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7248
False 1823
True percentage 0.799029875427
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.95      0.94      7318
      B-PER       0.34      0.27      0.30       438
      B-ORG       0.25      0.49      0.33       296
     B-MISC       1.00      0.01      0.01       141
      I-PER       0.15      0.01      0.02       214
      I-ORG       0.22      0.06      0.09       151
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141

avg / total       0.80      0.80      0.79      9071

F-1 Score (without O):
0.201454545455
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 8 unique labels.
Found 104041 unique words.
4037 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 567
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658688     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,668
Trainable params: 6,770,668
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 2s 142ms/step - loss: 0.3869 - acc: 0.8859
Epoch 2/27

16/16 [==============================] - 0s 29ms/step - loss: 0.3678 - acc: 0.8866
Epoch 3/27

16/16 [==============================] - 0s 30ms/step - loss: 0.3464 - acc: 0.8879
Epoch 4/27

16/16 [==============================] - 0s 28ms/step - loss: 0.3271 - acc: 0.8886
Epoch 5/27

16/16 [==============================] - 0s 30ms/step - loss: 0.3124 - acc: 0.8886
Epoch 6/27

16/16 [==============================] - 0s 29ms/step - loss: 0.2999 - acc: 0.8889
Epoch 7/27

16/16 [==============================] - 0s 30ms/step - loss: 0.2831 - acc: 0.8889
Epoch 8/27

16/16 [==============================] - 0s 30ms/step - loss: 0.2692 - acc: 0.8905
Epoch 9/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2555 - acc: 0.8909
Epoch 10/27

16/16 [==============================] - 0s 29ms/step - loss: 0.2367 - acc: 0.8968
Epoch 11/27

16/16 [==============================] - 0s 29ms/step - loss: 0.2154 - acc: 0.9076
Epoch 12/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1965 - acc: 0.9210
Epoch 13/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1801 - acc: 0.9358
Epoch 14/27

16/16 [==============================] - 1s 32ms/step - loss: 0.1584 - acc: 0.9528
Epoch 15/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1428 - acc: 0.9617
Epoch 16/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1213 - acc: 0.9735
Epoch 17/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1066 - acc: 0.9748
Epoch 18/27

16/16 [==============================] - 0s 28ms/step - loss: 0.0992 - acc: 0.9725
Epoch 19/27

16/16 [==============================] - 0s 31ms/step - loss: 0.0911 - acc: 0.9702
Epoch 20/27

16/16 [==============================] - 0s 29ms/step - loss: 0.0891 - acc: 0.9705
Epoch 21/27

16/16 [==============================] - 0s 31ms/step - loss: 0.0885 - acc: 0.9685
Epoch 22/27

16/16 [==============================] - 0s 29ms/step - loss: 0.0916 - acc: 0.9689
Epoch 23/27

16/16 [==============================] - 0s 29ms/step - loss: 0.0897 - acc: 0.9689
Epoch 24/27

16/16 [==============================] - 0s 29ms/step - loss: 0.0865 - acc: 0.9689
Epoch 25/27

16/16 [==============================] - 0s 29ms/step - loss: 0.0785 - acc: 0.9715
Epoch 26/27

16/16 [==============================] - 0s 29ms/step - loss: 0.0783 - acc: 0.9725
Epoch 27/27

16/16 [==============================] - 0s 29ms/step - loss: 0.0743 - acc: 0.9738
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7143
False 1714
True percentage 0.80648074969
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.87      0.96      0.91      7318
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
      B-PER       0.00      0.00      0.00       438
      B-ORG       0.24      0.29      0.26       296
      I-ORG       0.00      0.00      0.00       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.72      0.81      0.76      8857

F-1 Score (without O):
0.0900900900901
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104048 unique words.
4044 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 567
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659136     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,266
Trainable params: 6,771,266
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 2s 138ms/step - loss: 0.3248 - acc: 0.9000
Epoch 2/27

16/16 [==============================] - 1s 31ms/step - loss: 0.3012 - acc: 0.9000
Epoch 3/27

16/16 [==============================] - 0s 31ms/step - loss: 0.2820 - acc: 0.9006
Epoch 4/27

16/16 [==============================] - 0s 31ms/step - loss: 0.2554 - acc: 0.9057
Epoch 5/27

16/16 [==============================] - 0s 30ms/step - loss: 0.2344 - acc: 0.9113
Epoch 6/27

16/16 [==============================] - 0s 31ms/step - loss: 0.2098 - acc: 0.9274
Epoch 7/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1919 - acc: 0.9396
Epoch 8/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1768 - acc: 0.9450
Epoch 9/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1666 - acc: 0.9484
Epoch 10/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1576 - acc: 0.9481
Epoch 11/27

16/16 [==============================] - 0s 31ms/step - loss: 0.1520 - acc: 0.9478
Epoch 12/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1473 - acc: 0.9506
Epoch 13/27

16/16 [==============================] - 0s 31ms/step - loss: 0.1422 - acc: 0.9513
Epoch 14/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1416 - acc: 0.9531
Epoch 15/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1339 - acc: 0.9547
Epoch 16/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1236 - acc: 0.9566
Epoch 17/27

16/16 [==============================] - 1s 31ms/step - loss: 0.1209 - acc: 0.9575
Epoch 18/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1168 - acc: 0.9594
Epoch 19/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1126 - acc: 0.9660
Epoch 20/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1100 - acc: 0.9689
Epoch 21/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1054 - acc: 0.9698
Epoch 22/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1061 - acc: 0.9701
Epoch 23/27

16/16 [==============================] - 0s 31ms/step - loss: 0.1009 - acc: 0.9701
Epoch 24/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1028 - acc: 0.9701
Epoch 25/27

16/16 [==============================] - 0s 29ms/step - loss: 0.0982 - acc: 0.9704
Epoch 26/27

16/16 [==============================] - 0s 31ms/step - loss: 0.0972 - acc: 0.9698
Epoch 27/27

16/16 [==============================] - 0s 29ms/step - loss: 0.0947 - acc: 0.9723
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7109
False 1962
True percentage 0.783706316834
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.25      0.18      0.21       438
      I-PER       0.00      0.00      0.00       214
          O       0.88      0.95      0.92      7318
      B-ORG       0.11      0.05      0.07       296
      I-ORG       0.00      0.00      0.00       151
      B-LOC       0.23      0.17      0.20       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.73      0.78      0.76      9071

F-1 Score (without O):
0.835790725327
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104041 unique words.
4037 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 565
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658688     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,818
Trainable params: 6,770,818
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 2s 139ms/step - loss: 0.3431 - acc: 0.8972
Epoch 2/27

16/16 [==============================] - 0s 29ms/step - loss: 0.3243 - acc: 0.8981
Epoch 3/27

16/16 [==============================] - 0s 29ms/step - loss: 0.3025 - acc: 0.8966
Epoch 4/27

16/16 [==============================] - 0s 29ms/step - loss: 0.2876 - acc: 0.8994
Epoch 5/27

16/16 [==============================] - 0s 29ms/step - loss: 0.2697 - acc: 0.8997
Epoch 6/27

16/16 [==============================] - 0s 30ms/step - loss: 0.2529 - acc: 0.9000
Epoch 7/27

16/16 [==============================] - 0s 30ms/step - loss: 0.2359 - acc: 0.9031
Epoch 8/27

16/16 [==============================] - 0s 29ms/step - loss: 0.2220 - acc: 0.9074
Epoch 9/27

16/16 [==============================] - 0s 30ms/step - loss: 0.2050 - acc: 0.9149
Epoch 10/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1905 - acc: 0.9260
Epoch 11/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1760 - acc: 0.9412
Epoch 12/27

16/16 [==============================] - 0s 31ms/step - loss: 0.1614 - acc: 0.9557
Epoch 13/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1496 - acc: 0.9619
Epoch 14/27

16/16 [==============================] - 0s 31ms/step - loss: 0.1410 - acc: 0.9647
Epoch 15/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1314 - acc: 0.9653
Epoch 16/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1270 - acc: 0.9622
Epoch 17/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1190 - acc: 0.9628
Epoch 18/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1165 - acc: 0.9607
Epoch 19/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1136 - acc: 0.9619
Epoch 20/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1079 - acc: 0.9638
Epoch 21/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1040 - acc: 0.9638
Epoch 22/27

16/16 [==============================] - 0s 30ms/step - loss: 0.0992 - acc: 0.9644
Epoch 23/27

16/16 [==============================] - 0s 31ms/step - loss: 0.0941 - acc: 0.9690
Epoch 24/27

16/16 [==============================] - 0s 30ms/step - loss: 0.0899 - acc: 0.9721
Epoch 25/27

16/16 [==============================] - 0s 30ms/step - loss: 0.0876 - acc: 0.9734
Epoch 26/27

16/16 [==============================] - 0s 30ms/step - loss: 0.0857 - acc: 0.9724
Epoch 27/27

16/16 [==============================] - 0s 30ms/step - loss: 0.0857 - acc: 0.9724
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7179
False 1892
True percentage 0.791423216845
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.95      0.94      7318
      B-PER       0.52      0.24      0.32       438
      B-LOC       0.00      0.00      0.00       218
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-ORG       0.63      0.19      0.29       296
      I-ORG       0.10      0.48      0.16       151
      I-LOC       0.00      0.00      0.00       141
      I-PER       0.00      0.00      0.00       214

avg / total       0.80      0.79      0.78      9071

F-1 Score (without O):
0.166184971098
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104049 unique words.
4045 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 559
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659200     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,330
Trainable params: 6,771,330
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 2s 141ms/step - loss: 0.3690 - acc: 0.8992
Epoch 2/27

16/16 [==============================] - 0s 30ms/step - loss: 0.3508 - acc: 0.9000
Epoch 3/27

16/16 [==============================] - 0s 31ms/step - loss: 0.3260 - acc: 0.9013
Epoch 4/27

16/16 [==============================] - 0s 31ms/step - loss: 0.3108 - acc: 0.9013
Epoch 5/27

16/16 [==============================] - 0s 29ms/step - loss: 0.2909 - acc: 0.9058
Epoch 6/27

16/16 [==============================] - 0s 28ms/step - loss: 0.2719 - acc: 0.9077
Epoch 7/27

16/16 [==============================] - 0s 29ms/step - loss: 0.2514 - acc: 0.9109
Epoch 8/27

16/16 [==============================] - 0s 29ms/step - loss: 0.2294 - acc: 0.9146
Epoch 9/27

16/16 [==============================] - 0s 31ms/step - loss: 0.2116 - acc: 0.9202
Epoch 10/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1967 - acc: 0.9252
Epoch 11/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1791 - acc: 0.9345
Epoch 12/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1622 - acc: 0.9477
Epoch 13/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1485 - acc: 0.9578
Epoch 14/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1399 - acc: 0.9594
Epoch 15/27

16/16 [==============================] - 0s 31ms/step - loss: 0.1289 - acc: 0.9581
Epoch 16/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1214 - acc: 0.9610
Epoch 17/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1204 - acc: 0.9597
Epoch 18/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1167 - acc: 0.9584
Epoch 19/27

16/16 [==============================] - 0s 31ms/step - loss: 0.1144 - acc: 0.9584
Epoch 20/27

16/16 [==============================] - 0s 31ms/step - loss: 0.1130 - acc: 0.9597
Epoch 21/27

16/16 [==============================] - 0s 31ms/step - loss: 0.1060 - acc: 0.9621
Epoch 22/27

16/16 [==============================] - 0s 30ms/step - loss: 0.0997 - acc: 0.9650
Epoch 23/27

16/16 [==============================] - 0s 30ms/step - loss: 0.0979 - acc: 0.9679
Epoch 24/27

16/16 [==============================] - 0s 31ms/step - loss: 0.0932 - acc: 0.9716
Epoch 25/27

16/16 [==============================] - 1s 31ms/step - loss: 0.0906 - acc: 0.9711
Epoch 26/27

16/16 [==============================] - 0s 29ms/step - loss: 0.0901 - acc: 0.9729
Epoch 27/27

16/16 [==============================] - 0s 30ms/step - loss: 0.0870 - acc: 0.9732
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 6957
False 2114
True percentage 0.766949619667
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.93      0.93      7318
      B-ORG       0.15      0.53      0.23       296
      I-ORG       0.18      0.19      0.18       151
      B-PER       0.33      0.00      0.00       438
      I-PER       0.00      0.00      0.00       214
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.77      0.77      0.76      9071

F-1 Score (without O):
0.124497991968
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104050 unique words.
4046 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 567
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659264     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,394
Trainable params: 6,771,394
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 2s 142ms/step - loss: 0.3892 - acc: 0.8989
Epoch 2/27

16/16 [==============================] - 0s 29ms/step - loss: 0.3675 - acc: 0.8992
Epoch 3/27

16/16 [==============================] - 0s 30ms/step - loss: 0.3394 - acc: 0.9000
Epoch 4/27

16/16 [==============================] - 0s 30ms/step - loss: 0.3201 - acc: 0.9000
Epoch 5/27

16/16 [==============================] - 0s 31ms/step - loss: 0.2962 - acc: 0.9000
Epoch 6/27

16/16 [==============================] - 0s 31ms/step - loss: 0.2793 - acc: 0.9003
Epoch 7/27

16/16 [==============================] - 0s 30ms/step - loss: 0.2584 - acc: 0.9019
Epoch 8/27

16/16 [==============================] - 0s 31ms/step - loss: 0.2390 - acc: 0.9075
Epoch 9/27

16/16 [==============================] - 0s 30ms/step - loss: 0.2198 - acc: 0.9172
Epoch 10/27

16/16 [==============================] - 0s 30ms/step - loss: 0.2046 - acc: 0.9244
Epoch 11/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1844 - acc: 0.9343
Epoch 12/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1718 - acc: 0.9437
Epoch 13/27

16/16 [==============================] - 0s 31ms/step - loss: 0.1564 - acc: 0.9544
Epoch 14/27

16/16 [==============================] - 0s 31ms/step - loss: 0.1449 - acc: 0.9601
Epoch 15/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1359 - acc: 0.9614
Epoch 16/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1292 - acc: 0.9625
Epoch 17/27

16/16 [==============================] - 0s 31ms/step - loss: 0.1236 - acc: 0.9603
Epoch 18/27

16/16 [==============================] - 0s 31ms/step - loss: 0.1188 - acc: 0.9622
Epoch 19/27

16/16 [==============================] - 0s 31ms/step - loss: 0.1120 - acc: 0.9638
Epoch 20/27

16/16 [==============================] - 0s 31ms/step - loss: 0.1118 - acc: 0.9625
Epoch 21/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1072 - acc: 0.9635
Epoch 22/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1054 - acc: 0.9635
Epoch 23/27

16/16 [==============================] - 0s 31ms/step - loss: 0.0989 - acc: 0.9665
Epoch 24/27

16/16 [==============================] - 0s 31ms/step - loss: 0.0960 - acc: 0.9697
Epoch 25/27

16/16 [==============================] - 0s 31ms/step - loss: 0.0926 - acc: 0.9710
Epoch 26/27

16/16 [==============================] - 0s 29ms/step - loss: 0.0888 - acc: 0.9718
Epoch 27/27

16/16 [==============================] - 0s 31ms/step - loss: 0.0868 - acc: 0.9716
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7093
False 1978
True percentage 0.781942453974
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.91      0.95      0.93      7318
      B-ORG       0.12      0.24      0.16       296
      I-ORG       0.00      0.00      0.00       151
      B-PER       0.40      0.20      0.26       438
      I-PER       0.00      0.00      0.00       214
     B-MISC       0.11      0.05      0.07       141
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141

avg / total       0.76      0.78      0.77      9071

F-1 Score (without O):
0.125718666156
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104052 unique words.
4048 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 553
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659392     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,522
Trainable params: 6,771,522
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 2s 142ms/step - loss: 0.3244 - acc: 0.9000
Epoch 2/27

16/16 [==============================] - 0s 30ms/step - loss: 0.3026 - acc: 0.9000
Epoch 3/27

16/16 [==============================] - 0s 29ms/step - loss: 0.2740 - acc: 0.9000
Epoch 4/27

16/16 [==============================] - 0s 29ms/step - loss: 0.2556 - acc: 0.9005
Epoch 5/27

16/16 [==============================] - 0s 31ms/step - loss: 0.2313 - acc: 0.9092
Epoch 6/27

16/16 [==============================] - 0s 30ms/step - loss: 0.2123 - acc: 0.9191
Epoch 7/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1863 - acc: 0.9356
Epoch 8/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1699 - acc: 0.9412
Epoch 9/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1529 - acc: 0.9518
Epoch 10/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1482 - acc: 0.9520
Epoch 11/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1410 - acc: 0.9539
Epoch 12/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1390 - acc: 0.9558
Epoch 13/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1354 - acc: 0.9569
Epoch 14/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1316 - acc: 0.9593
Epoch 15/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1237 - acc: 0.9606
Epoch 16/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1208 - acc: 0.9604
Epoch 17/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1161 - acc: 0.9612
Epoch 18/27

16/16 [==============================] - 0s 31ms/step - loss: 0.1124 - acc: 0.9620
Epoch 19/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1056 - acc: 0.9658
Epoch 20/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1029 - acc: 0.9695
Epoch 21/27

16/16 [==============================] - 0s 29ms/step - loss: 0.0986 - acc: 0.9701
Epoch 22/27

16/16 [==============================] - 0s 29ms/step - loss: 0.0981 - acc: 0.9725
Epoch 23/27

16/16 [==============================] - 0s 30ms/step - loss: 0.0953 - acc: 0.9736
Epoch 24/27

16/16 [==============================] - 0s 29ms/step - loss: 0.0942 - acc: 0.9741
Epoch 25/27

16/16 [==============================] - 0s 28ms/step - loss: 0.0918 - acc: 0.9722
Epoch 26/27

16/16 [==============================] - 0s 29ms/step - loss: 0.0891 - acc: 0.9749
Epoch 27/27

16/16 [==============================] - 0s 30ms/step - loss: 0.0883 - acc: 0.9741
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7172
False 1899
True percentage 0.790651526844
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.33      0.16      0.21       438
          O       0.88      0.96      0.92      7318
      B-LOC       0.00      0.00      0.00       218
      B-ORG       0.29      0.24      0.27       296
      I-PER       0.00      0.00      0.00       214
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      I-ORG       0.19      0.11      0.14       151
      I-LOC       0.00      0.00      0.00       141

avg / total       0.74      0.79      0.76      9071

F-1 Score (without O):
0.838378474066
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104043 unique words.
4039 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 565
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658816     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,946
Trainable params: 6,770,946
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 2s 141ms/step - loss: 0.4056 - acc: 0.8982
Epoch 2/27

16/16 [==============================] - 0s 31ms/step - loss: 0.3805 - acc: 0.9000
Epoch 3/27

16/16 [==============================] - 0s 30ms/step - loss: 0.3613 - acc: 0.9000
Epoch 4/27

16/16 [==============================] - 0s 30ms/step - loss: 0.3431 - acc: 0.9000
Epoch 5/27

16/16 [==============================] - 0s 30ms/step - loss: 0.3244 - acc: 0.9000
Epoch 6/27

16/16 [==============================] - 0s 29ms/step - loss: 0.3075 - acc: 0.9000
Epoch 7/27

16/16 [==============================] - 0s 29ms/step - loss: 0.2859 - acc: 0.9018
Epoch 8/27

16/16 [==============================] - 0s 31ms/step - loss: 0.2641 - acc: 0.9049
Epoch 9/27

16/16 [==============================] - 0s 30ms/step - loss: 0.2460 - acc: 0.9088
Epoch 10/27

16/16 [==============================] - 0s 31ms/step - loss: 0.2289 - acc: 0.9120
Epoch 11/27

16/16 [==============================] - 0s 30ms/step - loss: 0.2091 - acc: 0.9151
Epoch 12/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1908 - acc: 0.9225
Epoch 13/27

16/16 [==============================] - 0s 31ms/step - loss: 0.1776 - acc: 0.9338
Epoch 14/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1691 - acc: 0.9405
Epoch 15/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1516 - acc: 0.9560
Epoch 16/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1388 - acc: 0.9634
Epoch 17/27

16/16 [==============================] - 1s 32ms/step - loss: 0.1331 - acc: 0.9630
Epoch 18/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1285 - acc: 0.9592
Epoch 19/27

16/16 [==============================] - 0s 31ms/step - loss: 0.1267 - acc: 0.9588
Epoch 20/27

16/16 [==============================] - 0s 31ms/step - loss: 0.1269 - acc: 0.9567
Epoch 21/27

16/16 [==============================] - 1s 31ms/step - loss: 0.1223 - acc: 0.9585
Epoch 22/27

16/16 [==============================] - 0s 31ms/step - loss: 0.1191 - acc: 0.9581
Epoch 23/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1121 - acc: 0.9606
Epoch 24/27

16/16 [==============================] - 1s 32ms/step - loss: 0.1081 - acc: 0.9627
Epoch 25/27

16/16 [==============================] - 0s 30ms/step - loss: 0.0987 - acc: 0.9669
Epoch 26/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1001 - acc: 0.9673
Epoch 27/27

16/16 [==============================] - 1s 31ms/step - loss: 0.0941 - acc: 0.9701
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7105
False 1966
True percentage 0.783265351119
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.88      0.95      0.92      7318
     B-MISC       0.07      0.02      0.03       141
      B-ORG       0.22      0.39      0.28       296
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.00      0.00      0.00       218
      I-ORG       0.00      0.00      0.00       151
      B-PER       0.44      0.06      0.10       438
      I-PER       0.00      0.00      0.00       214
      I-LOC       0.00      0.00      0.00       141

avg / total       0.74      0.78      0.75      9071

F-1 Score (without O):
0.12037037037
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104042 unique words.
4038 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 564
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658752     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,882
Trainable params: 6,770,882
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 2s 138ms/step - loss: 0.3114 - acc: 0.8997
Epoch 2/27

16/16 [==============================] - 0s 31ms/step - loss: 0.2887 - acc: 0.9000
Epoch 3/27

16/16 [==============================] - 0s 29ms/step - loss: 0.2624 - acc: 0.9016
Epoch 4/27

16/16 [==============================] - 0s 30ms/step - loss: 0.2359 - acc: 0.9062
Epoch 5/27

16/16 [==============================] - 0s 31ms/step - loss: 0.2122 - acc: 0.9161
Epoch 6/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1907 - acc: 0.9253
Epoch 7/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1658 - acc: 0.9441
Epoch 8/27

16/16 [==============================] - 0s 31ms/step - loss: 0.1485 - acc: 0.9579
Epoch 9/27

16/16 [==============================] - 0s 31ms/step - loss: 0.1304 - acc: 0.9655
Epoch 10/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1162 - acc: 0.9684
Epoch 11/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1098 - acc: 0.9694
Epoch 12/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1024 - acc: 0.9668
Epoch 13/27

16/16 [==============================] - 0s 29ms/step - loss: 0.0992 - acc: 0.9674
Epoch 14/27

16/16 [==============================] - 0s 30ms/step - loss: 0.0952 - acc: 0.9671
Epoch 15/27

16/16 [==============================] - 0s 29ms/step - loss: 0.0940 - acc: 0.9694
Epoch 16/27

16/16 [==============================] - 0s 31ms/step - loss: 0.0935 - acc: 0.9694
Epoch 17/27

16/16 [==============================] - 0s 31ms/step - loss: 0.0904 - acc: 0.9681
Epoch 18/27

16/16 [==============================] - 0s 30ms/step - loss: 0.0854 - acc: 0.9697
Epoch 19/27

16/16 [==============================] - 0s 31ms/step - loss: 0.0816 - acc: 0.9717
Epoch 20/27

16/16 [==============================] - 0s 29ms/step - loss: 0.0774 - acc: 0.9730
Epoch 21/27

16/16 [==============================] - 0s 30ms/step - loss: 0.0741 - acc: 0.9727
Epoch 22/27

16/16 [==============================] - 0s 30ms/step - loss: 0.0702 - acc: 0.9766
Epoch 23/27

16/16 [==============================] - 0s 31ms/step - loss: 0.0670 - acc: 0.9793
Epoch 24/27

16/16 [==============================] - 0s 31ms/step - loss: 0.0670 - acc: 0.9809
Epoch 25/27

16/16 [==============================] - 0s 31ms/step - loss: 0.0659 - acc: 0.9806
Epoch 26/27

16/16 [==============================] - 0s 30ms/step - loss: 0.0641 - acc: 0.9813
Epoch 27/27

16/16 [==============================] - 0s 31ms/step - loss: 0.0635 - acc: 0.9809
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7085
False 1986
True percentage 0.781060522544
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.15      0.51      0.23       296
          O       0.94      0.94      0.94      7318
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.26      0.09      0.13       154
      B-LOC       0.50      0.01      0.03       218
      I-LOC       0.09      0.01      0.01       141
      B-PER       0.31      0.11      0.16       438
      I-PER       0.00      0.00      0.00       214
      I-ORG       0.00      0.00      0.00       151

avg / total       0.80      0.78      0.78      9071

F-1 Score (without O):
0.852628343068
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 8
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 7 unique labels.
Found 104038 unique words.
4034 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 8)        1112        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,328
Trainable params: 6,770,328
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 2s 139ms/step - loss: 0.4244 - acc: 0.8746
Epoch 2/27

16/16 [==============================] - 0s 30ms/step - loss: 0.3939 - acc: 0.8750
Epoch 3/27

16/16 [==============================] - 0s 29ms/step - loss: 0.3584 - acc: 0.8750
Epoch 4/27

16/16 [==============================] - 0s 29ms/step - loss: 0.3302 - acc: 0.8775
Epoch 5/27

16/16 [==============================] - 0s 29ms/step - loss: 0.3014 - acc: 0.8825
Epoch 6/27

16/16 [==============================] - 0s 29ms/step - loss: 0.2713 - acc: 0.8917
Epoch 7/27

16/16 [==============================] - 0s 30ms/step - loss: 0.2450 - acc: 0.9013
Epoch 8/27

16/16 [==============================] - 0s 29ms/step - loss: 0.2179 - acc: 0.9176
Epoch 9/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1984 - acc: 0.9277
Epoch 10/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1817 - acc: 0.9369
Epoch 11/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1653 - acc: 0.9461
Epoch 12/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1546 - acc: 0.9490
Epoch 13/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1515 - acc: 0.9465
Epoch 14/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1463 - acc: 0.9490
Epoch 15/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1431 - acc: 0.9494
Epoch 16/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1367 - acc: 0.9511
Epoch 17/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1306 - acc: 0.9523
Epoch 18/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1270 - acc: 0.9536
Epoch 19/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1219 - acc: 0.9536
Epoch 20/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1148 - acc: 0.9553
Epoch 21/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1096 - acc: 0.9578
Epoch 22/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1050 - acc: 0.9620
Epoch 23/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1048 - acc: 0.9636
Epoch 24/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1005 - acc: 0.9653
Epoch 25/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1014 - acc: 0.9649
Epoch 26/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1010 - acc: 0.9632
Epoch 27/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1004 - acc: 0.9640
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 6963
False 1813
True percentage 0.793413855971
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.11      0.45      0.18       296
          O       0.94      0.93      0.94      7318
      B-LOC       1.00      0.01      0.03       218
      I-LOC       0.50      0.05      0.09       141
      I-ORG       0.09      0.06      0.07       151
      B-PER       0.00      0.00      0.00       438
      I-PER       0.00      0.00      0.00       214

avg / total       0.82      0.79      0.79      8776

F-1 Score (without O):
0.863099374566
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 9
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104053 unique words.
4049 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 558
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659456     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,586
Trainable params: 6,771,586
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 2s 147ms/step - loss: 0.3057 - acc: 0.9007
Epoch 2/27

16/16 [==============================] - 0s 29ms/step - loss: 0.2901 - acc: 0.9005
Epoch 3/27

16/16 [==============================] - 0s 30ms/step - loss: 0.2788 - acc: 0.9015
Epoch 4/27

16/16 [==============================] - 0s 31ms/step - loss: 0.2606 - acc: 0.9015
Epoch 5/27

16/16 [==============================] - 0s 30ms/step - loss: 0.2467 - acc: 0.9041
Epoch 6/27

16/16 [==============================] - 0s 30ms/step - loss: 0.2341 - acc: 0.9071
Epoch 7/27

16/16 [==============================] - 0s 31ms/step - loss: 0.2166 - acc: 0.9115
Epoch 8/27

16/16 [==============================] - 0s 30ms/step - loss: 0.2008 - acc: 0.9200
Epoch 9/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1889 - acc: 0.9273
Epoch 10/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1716 - acc: 0.9432
Epoch 11/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1573 - acc: 0.9549
Epoch 12/27

16/16 [==============================] - 0s 31ms/step - loss: 0.1495 - acc: 0.9556
Epoch 13/27

16/16 [==============================] - 0s 31ms/step - loss: 0.1349 - acc: 0.9588
Epoch 14/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1282 - acc: 0.9590
Epoch 15/27

16/16 [==============================] - 0s 31ms/step - loss: 0.1242 - acc: 0.9585
Epoch 16/27

16/16 [==============================] - 0s 31ms/step - loss: 0.1170 - acc: 0.9607
Epoch 17/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1142 - acc: 0.9593
Epoch 18/27

16/16 [==============================] - 0s 31ms/step - loss: 0.1137 - acc: 0.9588
Epoch 19/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1080 - acc: 0.9620
Epoch 20/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1047 - acc: 0.9637
Epoch 21/27

16/16 [==============================] - 1s 32ms/step - loss: 0.0987 - acc: 0.9671
Epoch 22/27

16/16 [==============================] - 0s 30ms/step - loss: 0.0970 - acc: 0.9688
Epoch 23/27

16/16 [==============================] - 0s 29ms/step - loss: 0.0944 - acc: 0.9710
Epoch 24/27

16/16 [==============================] - 0s 30ms/step - loss: 0.0918 - acc: 0.9710
Epoch 25/27

16/16 [==============================] - 0s 30ms/step - loss: 0.0893 - acc: 0.9722
Epoch 26/27

16/16 [==============================] - 0s 30ms/step - loss: 0.0858 - acc: 0.9729
Epoch 27/27

16/16 [==============================] - 0s 31ms/step - loss: 0.0847 - acc: 0.9729
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7192
False 1879
True percentage 0.792856355418
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.89      0.96      0.92      7318
      B-LOC       0.74      0.06      0.12       218
      I-LOC       0.00      0.00      0.00       141
      B-ORG       0.36      0.33      0.34       296
      B-PER       0.95      0.05      0.09       438
      I-PER       0.00      0.00      0.00       214
      I-ORG       0.13      0.23      0.16       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.79      0.79      0.77      9071

F-1 Score (without O):
0.142006802721
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 10
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104046 unique words.
4042 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659008     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,138
Trainable params: 6,771,138
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 2s 140ms/step - loss: 0.3852 - acc: 0.9000
Epoch 2/27

16/16 [==============================] - 0s 31ms/step - loss: 0.3631 - acc: 0.9000
Epoch 3/27

16/16 [==============================] - 0s 31ms/step - loss: 0.3408 - acc: 0.8997
Epoch 4/27

16/16 [==============================] - 0s 30ms/step - loss: 0.3159 - acc: 0.9000
Epoch 5/27

16/16 [==============================] - 0s 31ms/step - loss: 0.2962 - acc: 0.9000
Epoch 6/27

16/16 [==============================] - 0s 31ms/step - loss: 0.2730 - acc: 0.9000
Epoch 7/27

16/16 [==============================] - 0s 31ms/step - loss: 0.2501 - acc: 0.9003
Epoch 8/27

16/16 [==============================] - 1s 31ms/step - loss: 0.2294 - acc: 0.9043
Epoch 9/27

16/16 [==============================] - 0s 30ms/step - loss: 0.2106 - acc: 0.9101
Epoch 10/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1902 - acc: 0.9291
Epoch 11/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1761 - acc: 0.9441
Epoch 12/27

16/16 [==============================] - 1s 31ms/step - loss: 0.1589 - acc: 0.9536
Epoch 13/27

16/16 [==============================] - 1s 31ms/step - loss: 0.1463 - acc: 0.9573
Epoch 14/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1353 - acc: 0.9568
Epoch 15/27

16/16 [==============================] - 0s 31ms/step - loss: 0.1318 - acc: 0.9562
Epoch 16/27

16/16 [==============================] - 1s 31ms/step - loss: 0.1243 - acc: 0.9599
Epoch 17/27

16/16 [==============================] - 1s 31ms/step - loss: 0.1186 - acc: 0.9605
Epoch 18/27

16/16 [==============================] - 1s 31ms/step - loss: 0.1191 - acc: 0.9582
Epoch 19/27

16/16 [==============================] - 0s 31ms/step - loss: 0.1124 - acc: 0.9605
Epoch 20/27

16/16 [==============================] - 0s 31ms/step - loss: 0.1082 - acc: 0.9620
Epoch 21/27

16/16 [==============================] - 0s 31ms/step - loss: 0.1041 - acc: 0.9620
Epoch 22/27

16/16 [==============================] - 0s 30ms/step - loss: 0.0971 - acc: 0.9666
Epoch 23/27

16/16 [==============================] - 0s 31ms/step - loss: 0.0923 - acc: 0.9695
Epoch 24/27

16/16 [==============================] - 0s 30ms/step - loss: 0.0901 - acc: 0.9715
Epoch 25/27

16/16 [==============================] - 0s 31ms/step - loss: 0.0864 - acc: 0.9744
Epoch 26/27

16/16 [==============================] - 0s 31ms/step - loss: 0.0843 - acc: 0.9746
Epoch 27/27

16/16 [==============================] - 0s 30ms/step - loss: 0.0822 - acc: 0.9758
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7054
False 2017
True percentage 0.777643038254
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.92      0.95      0.93      7318
      B-ORG       0.50      0.03      0.05       296
      I-ORG       0.11      0.63      0.19       151
      B-LOC       0.39      0.12      0.19       218
      B-PER       0.00      0.00      0.00       438
      I-PER       0.00      0.00      0.00       214
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      I-LOC       0.00      0.00      0.00       141

avg / total       0.77      0.78      0.76      9071

F-1 Score (without O):
0.096011816839
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 11
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104050 unique words.
4046 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659264     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,394
Trainable params: 6,771,394
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 2s 141ms/step - loss: 0.2788 - acc: 0.9000
Epoch 2/27

16/16 [==============================] - 0s 31ms/step - loss: 0.2617 - acc: 0.9003
Epoch 3/27

16/16 [==============================] - 0s 29ms/step - loss: 0.2423 - acc: 0.9043
Epoch 4/27

16/16 [==============================] - 0s 30ms/step - loss: 0.2284 - acc: 0.9107
Epoch 5/27

16/16 [==============================] - 0s 30ms/step - loss: 0.2146 - acc: 0.9171
Epoch 6/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1946 - acc: 0.9309
Epoch 7/27

16/16 [==============================] - 1s 32ms/step - loss: 0.1806 - acc: 0.9416
Epoch 8/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1682 - acc: 0.9456
Epoch 9/27

16/16 [==============================] - 0s 31ms/step - loss: 0.1580 - acc: 0.9450
Epoch 10/27

16/16 [==============================] - 0s 31ms/step - loss: 0.1476 - acc: 0.9474
Epoch 11/27

16/16 [==============================] - 1s 31ms/step - loss: 0.1417 - acc: 0.9495
Epoch 12/27

16/16 [==============================] - 1s 31ms/step - loss: 0.1356 - acc: 0.9529
Epoch 13/27

16/16 [==============================] - 1s 32ms/step - loss: 0.1291 - acc: 0.9514
Epoch 14/27

16/16 [==============================] - 0s 31ms/step - loss: 0.1241 - acc: 0.9550
Epoch 15/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1213 - acc: 0.9560
Epoch 16/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1173 - acc: 0.9554
Epoch 17/27

16/16 [==============================] - 0s 31ms/step - loss: 0.1112 - acc: 0.9587
Epoch 18/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1068 - acc: 0.9636
Epoch 19/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1042 - acc: 0.9648
Epoch 20/27

16/16 [==============================] - 0s 31ms/step - loss: 0.0989 - acc: 0.9676
Epoch 21/27

16/16 [==============================] - 0s 30ms/step - loss: 0.0963 - acc: 0.9709
Epoch 22/27

16/16 [==============================] - 0s 30ms/step - loss: 0.0948 - acc: 0.9719
Epoch 23/27

16/16 [==============================] - 0s 29ms/step - loss: 0.0911 - acc: 0.9734
Epoch 24/27

16/16 [==============================] - 0s 29ms/step - loss: 0.0895 - acc: 0.9740
Epoch 25/27

16/16 [==============================] - 0s 30ms/step - loss: 0.0850 - acc: 0.9755
Epoch 26/27

16/16 [==============================] - 0s 29ms/step - loss: 0.0824 - acc: 0.9743
Epoch 27/27

16/16 [==============================] - 0s 30ms/step - loss: 0.0791 - acc: 0.9749
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7175
False 1896
True percentage 0.79098225113
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.88      0.96      0.92      7318
      B-ORG       0.00      0.00      0.00       296
      I-ORG       0.15      0.08      0.10       151
     B-MISC       0.00      0.00      0.00       141
      B-LOC       0.00      0.00      0.00       218
      B-PER       0.30      0.32      0.31       438
     I-MISC       0.00      0.00      0.00       154
      I-PER       0.00      0.00      0.00       214
      I-LOC       0.00      0.00      0.00       141

avg / total       0.73      0.79      0.76      9071

F-1 Score (without O):
0.130775937228
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 8 unique labels.
Found 104042 unique words.
4038 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 564
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658752     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,732
Trainable params: 6,770,732
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

16/16 [==============================] - 2s 138ms/step - loss: 0.4004 - acc: 0.8874
Epoch 2/27

16/16 [==============================] - 0s 30ms/step - loss: 0.3762 - acc: 0.8878
Epoch 3/27

16/16 [==============================] - 0s 30ms/step - loss: 0.3401 - acc: 0.8885
Epoch 4/27

16/16 [==============================] - 0s 30ms/step - loss: 0.3174 - acc: 0.8889
Epoch 5/27

16/16 [==============================] - 0s 30ms/step - loss: 0.2844 - acc: 0.8889
Epoch 6/27

16/16 [==============================] - 0s 30ms/step - loss: 0.2580 - acc: 0.8893
Epoch 7/27

16/16 [==============================] - 0s 29ms/step - loss: 0.2311 - acc: 0.8953
Epoch 8/27

16/16 [==============================] - 0s 30ms/step - loss: 0.2000 - acc: 0.9211
Epoch 9/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1821 - acc: 0.9378
Epoch 10/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1605 - acc: 0.9575
Epoch 11/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1380 - acc: 0.9662
Epoch 12/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1258 - acc: 0.9689
Epoch 13/27

16/16 [==============================] - 0s 29ms/step - loss: 0.1157 - acc: 0.9662
Epoch 14/27

16/16 [==============================] - 0s 28ms/step - loss: 0.1064 - acc: 0.9662
Epoch 15/27

16/16 [==============================] - 0s 30ms/step - loss: 0.1044 - acc: 0.9659
Epoch 16/27

16/16 [==============================] - 0s 31ms/step - loss: 0.0989 - acc: 0.9651
Epoch 17/27

16/16 [==============================] - 0s 29ms/step - loss: 0.0952 - acc: 0.9659
Epoch 18/27

16/16 [==============================] - 0s 30ms/step - loss: 0.0928 - acc: 0.9655
Epoch 19/27

16/16 [==============================] - 0s 30ms/step - loss: 0.0932 - acc: 0.9651
Epoch 20/27

16/16 [==============================] - 0s 30ms/step - loss: 0.0822 - acc: 0.9678
Epoch 21/27

16/16 [==============================] - 0s 30ms/step - loss: 0.0779 - acc: 0.9723
Epoch 22/27

16/16 [==============================] - 0s 29ms/step - loss: 0.0726 - acc: 0.9738
Epoch 23/27

16/16 [==============================] - 0s 29ms/step - loss: 0.0723 - acc: 0.9738
Epoch 24/27

16/16 [==============================] - 0s 30ms/step - loss: 0.0681 - acc: 0.9765
Epoch 25/27

16/16 [==============================] - 0s 30ms/step - loss: 0.0695 - acc: 0.9750
Epoch 26/27

16/16 [==============================] - 0s 29ms/step - loss: 0.0666 - acc: 0.9765
Epoch 27/27

16/16 [==============================] - 0s 29ms/step - loss: 0.0670 - acc: 0.9776
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7137
False 1793
True percentage 0.79921612542
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.94      0.93      7318
      B-PER       0.26      0.37      0.31       438
      B-ORG       0.18      0.27      0.22       296
     B-MISC       0.00      0.00      0.00       141
      I-PER       0.00      0.00      0.00       214
      I-ORG       0.00      0.00      0.00       151
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.00      0.00      0.00       218

avg / total       0.78      0.80      0.79      8930

F-1 Score (without O):
0.181477315336
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 8 unique labels.
Found 104034 unique words.
4030 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658240     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,220
Trainable params: 6,770,220
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 2s 255ms/step - loss: 0.3384 - acc: 0.8882
Epoch 2/27

8/8 [==============================] - 0s 37ms/step - loss: 0.3158 - acc: 0.8889
Epoch 3/27

8/8 [==============================] - 0s 37ms/step - loss: 0.2965 - acc: 0.8889
Epoch 4/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2774 - acc: 0.8889
Epoch 5/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2547 - acc: 0.8889
Epoch 6/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2311 - acc: 0.8933
Epoch 7/27

8/8 [==============================] - 0s 39ms/step - loss: 0.2136 - acc: 0.9043
Epoch 8/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1940 - acc: 0.9227
Epoch 9/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1858 - acc: 0.9404
Epoch 10/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1638 - acc: 0.9573
Epoch 11/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1589 - acc: 0.9573
Epoch 12/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1476 - acc: 0.9588
Epoch 13/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1394 - acc: 0.9558
Epoch 14/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1358 - acc: 0.9581
Epoch 15/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1307 - acc: 0.9595
Epoch 16/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1250 - acc: 0.9595
Epoch 17/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1237 - acc: 0.9595
Epoch 18/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1212 - acc: 0.9588
Epoch 19/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1188 - acc: 0.9603
Epoch 20/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1124 - acc: 0.9617
Epoch 21/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1077 - acc: 0.9632
Epoch 22/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1039 - acc: 0.9632
Epoch 23/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0994 - acc: 0.9647
Epoch 24/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0912 - acc: 0.9684
Epoch 25/27

8/8 [==============================] - 0s 39ms/step - loss: 0.0901 - acc: 0.9713
Epoch 26/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0898 - acc: 0.9691
Epoch 27/27

8/8 [==============================] - 0s 39ms/step - loss: 0.0841 - acc: 0.9735
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 6977
False 1880
True percentage 0.787738511911
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.91      0.94      0.92      7318
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
      B-PER       0.00      0.00      0.00       438
      B-ORG       0.00      0.00      0.00       296
      I-ORG       0.00      0.00      0.00       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.09      0.52      0.16       154

avg / total       0.75      0.79      0.77      8857

F-1 Score (without O):
0.0656814449918
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104039 unique words.
4035 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658560     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,690
Trainable params: 6,770,690
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 2s 259ms/step - loss: 0.2991 - acc: 0.8986
Epoch 2/27

8/8 [==============================] - 0s 39ms/step - loss: 0.2827 - acc: 0.9027
Epoch 3/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2587 - acc: 0.9007
Epoch 4/27

8/8 [==============================] - 0s 37ms/step - loss: 0.2402 - acc: 0.9068
Epoch 5/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2130 - acc: 0.9211
Epoch 6/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1975 - acc: 0.9306
Epoch 7/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1755 - acc: 0.9476
Epoch 8/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1612 - acc: 0.9537
Epoch 9/27

8/8 [==============================] - 0s 36ms/step - loss: 0.1514 - acc: 0.9558
Epoch 10/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1419 - acc: 0.9565
Epoch 11/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1328 - acc: 0.9558
Epoch 12/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1250 - acc: 0.9565
Epoch 13/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1230 - acc: 0.9592
Epoch 14/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1183 - acc: 0.9571
Epoch 15/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1165 - acc: 0.9599
Epoch 16/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1100 - acc: 0.9592
Epoch 17/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1063 - acc: 0.9605
Epoch 18/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1032 - acc: 0.9646
Epoch 19/27

8/8 [==============================] - 0s 39ms/step - loss: 0.0977 - acc: 0.9667
Epoch 20/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0930 - acc: 0.9707
Epoch 21/27

8/8 [==============================] - 0s 39ms/step - loss: 0.0946 - acc: 0.9680
Epoch 22/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0860 - acc: 0.9728
Epoch 23/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0853 - acc: 0.9707
Epoch 24/27

8/8 [==============================] - 0s 36ms/step - loss: 0.0847 - acc: 0.9721
Epoch 25/27

8/8 [==============================] - 0s 37ms/step - loss: 0.0825 - acc: 0.9728
Epoch 26/27

8/8 [==============================] - 0s 37ms/step - loss: 0.0822 - acc: 0.9707
Epoch 27/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0773 - acc: 0.9735
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7061
False 2010
True percentage 0.778414728255
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.30      0.10      0.15       438
      I-PER       0.00      0.00      0.00       214
          O       0.94      0.94      0.94      7318
      B-ORG       0.14      0.50      0.22       296
      I-ORG       0.00      0.00      0.00       151
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.78      0.78      0.77      9071

F-1 Score (without O):
0.826015303119
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104036 unique words.
4032 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 565
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658368     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,498
Trainable params: 6,770,498
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 2s 258ms/step - loss: 0.3979 - acc: 0.8947
Epoch 2/27

8/8 [==============================] - 0s 38ms/step - loss: 0.3802 - acc: 0.8947
Epoch 3/27

8/8 [==============================] - 0s 38ms/step - loss: 0.3573 - acc: 0.8982
Epoch 4/27

8/8 [==============================] - 0s 38ms/step - loss: 0.3302 - acc: 0.9000
Epoch 5/27

8/8 [==============================] - 0s 38ms/step - loss: 0.3050 - acc: 0.8988
Epoch 6/27

8/8 [==============================] - 0s 39ms/step - loss: 0.2880 - acc: 0.9000
Epoch 7/27

8/8 [==============================] - 0s 39ms/step - loss: 0.2571 - acc: 0.9041
Epoch 8/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2369 - acc: 0.9053
Epoch 9/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2070 - acc: 0.9225
Epoch 10/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1897 - acc: 0.9320
Epoch 11/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1778 - acc: 0.9396
Epoch 12/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1480 - acc: 0.9580
Epoch 13/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1323 - acc: 0.9657
Epoch 14/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1200 - acc: 0.9686
Epoch 15/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1121 - acc: 0.9704
Epoch 16/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1110 - acc: 0.9669
Epoch 17/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1119 - acc: 0.9639
Epoch 18/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1104 - acc: 0.9627
Epoch 19/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1081 - acc: 0.9633
Epoch 20/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1054 - acc: 0.9627
Epoch 21/27

8/8 [==============================] - 0s 36ms/step - loss: 0.1041 - acc: 0.9645
Epoch 22/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0995 - acc: 0.9621
Epoch 23/27

8/8 [==============================] - 0s 39ms/step - loss: 0.0920 - acc: 0.9663
Epoch 24/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0897 - acc: 0.9686
Epoch 25/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0837 - acc: 0.9704
Epoch 26/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0800 - acc: 0.9740
Epoch 27/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0798 - acc: 0.9740
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7171
False 1900
True percentage 0.790541285415
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.88      0.96      0.92      7318
      B-PER       0.33      0.34      0.33       438
      B-LOC       0.24      0.06      0.10       218
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-ORG       0.17      0.04      0.07       296
      I-ORG       0.00      0.00      0.00       151
      I-LOC       0.00      0.00      0.00       141
      I-PER       0.00      0.00      0.00       214

avg / total       0.74      0.79      0.76      9071

F-1 Score (without O):
0.150766609881
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104039 unique words.
4035 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 559
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658560     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,690
Trainable params: 6,770,690
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 2s 253ms/step - loss: 0.3406 - acc: 0.9000
Epoch 2/27

8/8 [==============================] - 0s 36ms/step - loss: 0.3221 - acc: 0.9000
Epoch 3/27

8/8 [==============================] - 0s 38ms/step - loss: 0.3009 - acc: 0.9000
Epoch 4/27

8/8 [==============================] - 0s 37ms/step - loss: 0.2875 - acc: 0.9000
Epoch 5/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2720 - acc: 0.9000
Epoch 6/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2594 - acc: 0.9006
Epoch 7/27

8/8 [==============================] - 0s 37ms/step - loss: 0.2431 - acc: 0.9028
Epoch 8/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2340 - acc: 0.9088
Epoch 9/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2182 - acc: 0.9166
Epoch 10/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2035 - acc: 0.9265
Epoch 11/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1960 - acc: 0.9271
Epoch 12/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1852 - acc: 0.9365
Epoch 13/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1830 - acc: 0.9381
Epoch 14/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1745 - acc: 0.9464
Epoch 15/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1622 - acc: 0.9492
Epoch 16/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1557 - acc: 0.9503
Epoch 17/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1522 - acc: 0.9508
Epoch 18/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1494 - acc: 0.9508
Epoch 19/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1399 - acc: 0.9530
Epoch 20/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1403 - acc: 0.9497
Epoch 21/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1356 - acc: 0.9536
Epoch 22/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1337 - acc: 0.9564
Epoch 23/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1312 - acc: 0.9530
Epoch 24/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1244 - acc: 0.9552
Epoch 25/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1248 - acc: 0.9558
Epoch 26/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1214 - acc: 0.9569
Epoch 27/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1193 - acc: 0.9580
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7109
False 1962
True percentage 0.783706316834
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.92      0.93      0.93      7318
      B-ORG       0.44      0.25      0.32       296
      I-ORG       0.16      0.35      0.22       151
      B-PER       0.31      0.33      0.32       438
      I-PER       0.02      0.01      0.01       214
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.78      0.78      0.78      9071

F-1 Score (without O):
0.191444600281
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104044 unique words.
4040 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658880     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,010
Trainable params: 6,771,010
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 2s 253ms/step - loss: 0.2990 - acc: 0.9023
Epoch 2/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2793 - acc: 0.9023
Epoch 3/27

8/8 [==============================] - 0s 37ms/step - loss: 0.2633 - acc: 0.9057
Epoch 4/27

8/8 [==============================] - 0s 37ms/step - loss: 0.2446 - acc: 0.9136
Epoch 5/27

8/8 [==============================] - 0s 37ms/step - loss: 0.2226 - acc: 0.9233
Epoch 6/27

8/8 [==============================] - 0s 37ms/step - loss: 0.2079 - acc: 0.9273
Epoch 7/27

8/8 [==============================] - 0s 36ms/step - loss: 0.1972 - acc: 0.9301
Epoch 8/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1800 - acc: 0.9330
Epoch 9/27

8/8 [==============================] - 0s 36ms/step - loss: 0.1694 - acc: 0.9398
Epoch 10/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1573 - acc: 0.9511
Epoch 11/27

8/8 [==============================] - 0s 36ms/step - loss: 0.1491 - acc: 0.9540
Epoch 12/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1393 - acc: 0.9591
Epoch 13/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1285 - acc: 0.9585
Epoch 14/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1213 - acc: 0.9591
Epoch 15/27

8/8 [==============================] - 0s 36ms/step - loss: 0.1177 - acc: 0.9597
Epoch 16/27

8/8 [==============================] - 0s 36ms/step - loss: 0.1129 - acc: 0.9591
Epoch 17/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1112 - acc: 0.9614
Epoch 18/27

8/8 [==============================] - 0s 36ms/step - loss: 0.1029 - acc: 0.9625
Epoch 19/27

8/8 [==============================] - 0s 37ms/step - loss: 0.0988 - acc: 0.9631
Epoch 20/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0946 - acc: 0.9653
Epoch 21/27

8/8 [==============================] - 0s 36ms/step - loss: 0.0914 - acc: 0.9665
Epoch 22/27

8/8 [==============================] - 0s 36ms/step - loss: 0.0841 - acc: 0.9716
Epoch 23/27

8/8 [==============================] - 0s 37ms/step - loss: 0.0842 - acc: 0.9705
Epoch 24/27

8/8 [==============================] - 0s 37ms/step - loss: 0.0785 - acc: 0.9761
Epoch 25/27

8/8 [==============================] - 0s 36ms/step - loss: 0.0777 - acc: 0.9750
Epoch 26/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0755 - acc: 0.9739
Epoch 27/27

8/8 [==============================] - 0s 36ms/step - loss: 0.0731 - acc: 0.9750
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7054
False 2017
True percentage 0.777643038254
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.88      0.96      0.92      7318
      B-ORG       1.00      0.01      0.02       296
      I-ORG       0.11      0.16      0.13       151
      B-PER       0.00      0.00      0.00       438
      I-PER       0.00      0.00      0.00       214
     B-MISC       0.08      0.18      0.11       141
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141

avg / total       0.75      0.78      0.74      9071

F-1 Score (without O):
0.0458279290964
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104039 unique words.
4035 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 553
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658560     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,690
Trainable params: 6,770,690
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 2s 257ms/step - loss: 0.3781 - acc: 0.9000
Epoch 2/27

8/8 [==============================] - 0s 37ms/step - loss: 0.3540 - acc: 0.9000
Epoch 3/27

8/8 [==============================] - 0s 37ms/step - loss: 0.3347 - acc: 0.9000
Epoch 4/27

8/8 [==============================] - 0s 37ms/step - loss: 0.3131 - acc: 0.9000
Epoch 5/27

8/8 [==============================] - 0s 37ms/step - loss: 0.2951 - acc: 0.9000
Epoch 6/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2697 - acc: 0.9000
Epoch 7/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2549 - acc: 0.9005
Epoch 8/27

8/8 [==============================] - 0s 36ms/step - loss: 0.2403 - acc: 0.9010
Epoch 9/27

8/8 [==============================] - 0s 37ms/step - loss: 0.2198 - acc: 0.9047
Epoch 10/27

8/8 [==============================] - 0s 37ms/step - loss: 0.2024 - acc: 0.9150
Epoch 11/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1862 - acc: 0.9254
Epoch 12/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1723 - acc: 0.9415
Epoch 13/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1573 - acc: 0.9497
Epoch 14/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1445 - acc: 0.9580
Epoch 15/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1353 - acc: 0.9611
Epoch 16/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1294 - acc: 0.9606
Epoch 17/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1183 - acc: 0.9617
Epoch 18/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1139 - acc: 0.9606
Epoch 19/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1112 - acc: 0.9617
Epoch 20/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1029 - acc: 0.9627
Epoch 21/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1021 - acc: 0.9642
Epoch 22/27

8/8 [==============================] - 0s 36ms/step - loss: 0.0944 - acc: 0.9653
Epoch 23/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0935 - acc: 0.9663
Epoch 24/27

8/8 [==============================] - 0s 37ms/step - loss: 0.0872 - acc: 0.9668
Epoch 25/27

8/8 [==============================] - 0s 37ms/step - loss: 0.0800 - acc: 0.9720
Epoch 26/27

8/8 [==============================] - 0s 37ms/step - loss: 0.0808 - acc: 0.9710
Epoch 27/27

8/8 [==============================] - 0s 36ms/step - loss: 0.0752 - acc: 0.9751
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7115
False 1956
True percentage 0.784367765406
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.53      0.06      0.11       438
          O       0.85      0.97      0.90      7318
      B-LOC       0.00      0.00      0.00       218
      B-ORG       0.15      0.05      0.08       296
      I-PER       0.00      0.00      0.00       214
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      I-ORG       0.00      0.00      0.00       151
      I-LOC       0.00      0.00      0.00       141

avg / total       0.71      0.78      0.74      9071

F-1 Score (without O):
0.82902584493
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104035 unique words.
4031 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658304     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,434
Trainable params: 6,770,434
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 2s 256ms/step - loss: 0.3443 - acc: 0.9000
Epoch 2/27

8/8 [==============================] - 0s 38ms/step - loss: 0.3193 - acc: 0.9000
Epoch 3/27

8/8 [==============================] - 0s 38ms/step - loss: 0.3030 - acc: 0.9000
Epoch 4/27

8/8 [==============================] - 0s 37ms/step - loss: 0.2760 - acc: 0.9000
Epoch 5/27

8/8 [==============================] - 0s 37ms/step - loss: 0.2654 - acc: 0.9000
Epoch 6/27

8/8 [==============================] - 0s 37ms/step - loss: 0.2447 - acc: 0.9000
Epoch 7/27

8/8 [==============================] - 0s 37ms/step - loss: 0.2283 - acc: 0.9038
Epoch 8/27

8/8 [==============================] - 0s 37ms/step - loss: 0.2087 - acc: 0.9152
Epoch 9/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1945 - acc: 0.9250
Epoch 10/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1745 - acc: 0.9455
Epoch 11/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1653 - acc: 0.9538
Epoch 12/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1532 - acc: 0.9598
Epoch 13/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1405 - acc: 0.9636
Epoch 14/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1329 - acc: 0.9621
Epoch 15/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1290 - acc: 0.9583
Epoch 16/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1266 - acc: 0.9576
Epoch 17/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1159 - acc: 0.9591
Epoch 18/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1150 - acc: 0.9583
Epoch 19/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1103 - acc: 0.9598
Epoch 20/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1058 - acc: 0.9621
Epoch 21/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0982 - acc: 0.9644
Epoch 22/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0952 - acc: 0.9705
Epoch 23/27

8/8 [==============================] - 0s 37ms/step - loss: 0.0915 - acc: 0.9727
Epoch 24/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0875 - acc: 0.9750
Epoch 25/27

8/8 [==============================] - 0s 37ms/step - loss: 0.0870 - acc: 0.9750
Epoch 26/27

8/8 [==============================] - 0s 37ms/step - loss: 0.0855 - acc: 0.9750
Epoch 27/27

8/8 [==============================] - 0s 37ms/step - loss: 0.0833 - acc: 0.9735
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 6957
False 2114
True percentage 0.766949619667
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.92      0.93      7318
     B-MISC       0.00      0.00      0.00       141
      B-ORG       0.14      0.63      0.23       296
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.00      0.00      0.00       218
      I-ORG       0.00      0.00      0.00       151
      B-PER       0.00      0.00      0.00       438
      I-PER       0.60      0.03      0.05       214
      I-LOC       0.00      0.00      0.00       141

avg / total       0.78      0.77      0.76      9071

F-1 Score (without O):
0.125244618395
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 8 unique labels.
Found 104036 unique words.
4032 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 564
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658368     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,348
Trainable params: 6,770,348
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 2s 252ms/step - loss: 0.3094 - acc: 0.8966
Epoch 2/27

8/8 [==============================] - 0s 37ms/step - loss: 0.2861 - acc: 0.8980
Epoch 3/27

8/8 [==============================] - 0s 36ms/step - loss: 0.2578 - acc: 0.8994
Epoch 4/27

8/8 [==============================] - 0s 36ms/step - loss: 0.2355 - acc: 0.9072
Epoch 5/27

8/8 [==============================] - 0s 37ms/step - loss: 0.2073 - acc: 0.9149
Epoch 6/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1886 - acc: 0.9332
Epoch 7/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1650 - acc: 0.9444
Epoch 8/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1529 - acc: 0.9578
Epoch 9/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1367 - acc: 0.9641
Epoch 10/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1264 - acc: 0.9648
Epoch 11/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1155 - acc: 0.9648
Epoch 12/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1095 - acc: 0.9669
Epoch 13/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1055 - acc: 0.9662
Epoch 14/27

8/8 [==============================] - 0s 37ms/step - loss: 0.0996 - acc: 0.9648
Epoch 15/27

8/8 [==============================] - 0s 37ms/step - loss: 0.0952 - acc: 0.9648
Epoch 16/27

8/8 [==============================] - 0s 37ms/step - loss: 0.0953 - acc: 0.9648
Epoch 17/27

8/8 [==============================] - 0s 37ms/step - loss: 0.0892 - acc: 0.9677
Epoch 18/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0869 - acc: 0.9677
Epoch 19/27

8/8 [==============================] - 0s 37ms/step - loss: 0.0827 - acc: 0.9691
Epoch 20/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0765 - acc: 0.9719
Epoch 21/27

8/8 [==============================] - 0s 37ms/step - loss: 0.0736 - acc: 0.9726
Epoch 22/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0690 - acc: 0.9761
Epoch 23/27

8/8 [==============================] - 0s 37ms/step - loss: 0.0683 - acc: 0.9782
Epoch 24/27

8/8 [==============================] - 0s 36ms/step - loss: 0.0648 - acc: 0.9803
Epoch 25/27

8/8 [==============================] - 0s 37ms/step - loss: 0.0616 - acc: 0.9796
Epoch 26/27

8/8 [==============================] - 0s 37ms/step - loss: 0.0598 - acc: 0.9803
Epoch 27/27

8/8 [==============================] - 0s 37ms/step - loss: 0.0617 - acc: 0.9789
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7012
False 1908
True percentage 0.786098654709
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.15      0.48      0.22       296
          O       0.92      0.94      0.93      7318
     B-MISC       0.67      0.01      0.03       141
     I-MISC       0.10      0.01      0.01       154
      B-LOC       0.11      0.01      0.02       218
      I-LOC       0.00      0.00      0.00       141
      B-PER       0.00      0.00      0.00       438
      I-PER       0.11      0.00      0.01       214

avg / total       0.78      0.79      0.77      8920

F-1 Score (without O):
0.850318668399
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 8
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 7 unique labels.
Found 104034 unique words.
4030 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658240     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 8)        1112        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,072
Trainable params: 6,770,072
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 2s 256ms/step - loss: 0.4151 - acc: 0.8750
Epoch 2/27

8/8 [==============================] - 0s 37ms/step - loss: 0.3903 - acc: 0.8742
Epoch 3/27

8/8 [==============================] - 0s 37ms/step - loss: 0.3699 - acc: 0.8767
Epoch 4/27

8/8 [==============================] - 0s 38ms/step - loss: 0.3402 - acc: 0.8784
Epoch 5/27

8/8 [==============================] - 0s 36ms/step - loss: 0.3176 - acc: 0.8801
Epoch 6/27

8/8 [==============================] - 0s 37ms/step - loss: 0.2977 - acc: 0.8834
Epoch 7/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2830 - acc: 0.8860
Epoch 8/27

8/8 [==============================] - 0s 37ms/step - loss: 0.2653 - acc: 0.8927
Epoch 9/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2430 - acc: 0.8978
Epoch 10/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2279 - acc: 0.9054
Epoch 11/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2042 - acc: 0.9181
Epoch 12/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1989 - acc: 0.9231
Epoch 13/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1734 - acc: 0.9417
Epoch 14/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1614 - acc: 0.9502
Epoch 15/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1481 - acc: 0.9611
Epoch 16/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1267 - acc: 0.9645
Epoch 17/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1235 - acc: 0.9620
Epoch 18/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1141 - acc: 0.9620
Epoch 19/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1060 - acc: 0.9628
Epoch 20/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1027 - acc: 0.9586
Epoch 21/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1041 - acc: 0.9586
Epoch 22/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1021 - acc: 0.9578
Epoch 23/27

8/8 [==============================] - 0s 36ms/step - loss: 0.1001 - acc: 0.9611
Epoch 24/27

8/8 [==============================] - 0s 37ms/step - loss: 0.0880 - acc: 0.9611
Epoch 25/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0821 - acc: 0.9662
Epoch 26/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0775 - acc: 0.9713
Epoch 27/27

8/8 [==============================] - 0s 36ms/step - loss: 0.0755 - acc: 0.9730
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7163
False 1613
True percentage 0.816203281677
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.27      0.32      0.29       296
          O       0.87      0.96      0.92      7318
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.37      0.22      0.28       141
      I-ORG       0.00      0.00      0.00       151
      B-PER       0.00      0.00      0.00       438
      I-PER       0.00      0.00      0.00       214

avg / total       0.74      0.82      0.78      8776

F-1 Score (without O):
0.85031885453
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 9
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104041 unique words.
4037 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 558
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658688     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,818
Trainable params: 6,770,818
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 2s 256ms/step - loss: 0.3722 - acc: 0.9000
Epoch 2/27

8/8 [==============================] - 0s 37ms/step - loss: 0.3444 - acc: 0.9000
Epoch 3/27

8/8 [==============================] - 0s 37ms/step - loss: 0.3218 - acc: 0.9000
Epoch 4/27

8/8 [==============================] - 0s 37ms/step - loss: 0.3010 - acc: 0.9000
Epoch 5/27

8/8 [==============================] - 0s 37ms/step - loss: 0.2877 - acc: 0.9000
Epoch 6/27

8/8 [==============================] - 0s 39ms/step - loss: 0.2581 - acc: 0.9000
Epoch 7/27

8/8 [==============================] - 0s 37ms/step - loss: 0.2472 - acc: 0.9000
Epoch 8/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2260 - acc: 0.9005
Epoch 9/27

8/8 [==============================] - 0s 36ms/step - loss: 0.2098 - acc: 0.9072
Epoch 10/27

8/8 [==============================] - 0s 36ms/step - loss: 0.1928 - acc: 0.9208
Epoch 11/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1818 - acc: 0.9357
Epoch 12/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1691 - acc: 0.9439
Epoch 13/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1641 - acc: 0.9548
Epoch 14/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1413 - acc: 0.9652
Epoch 15/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1321 - acc: 0.9665
Epoch 16/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1273 - acc: 0.9647
Epoch 17/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1211 - acc: 0.9624
Epoch 18/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1175 - acc: 0.9647
Epoch 19/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1140 - acc: 0.9652
Epoch 20/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1130 - acc: 0.9620
Epoch 21/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1084 - acc: 0.9643
Epoch 22/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1015 - acc: 0.9629
Epoch 23/27

8/8 [==============================] - 0s 37ms/step - loss: 0.0969 - acc: 0.9661
Epoch 24/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0971 - acc: 0.9656
Epoch 25/27

8/8 [==============================] - 0s 37ms/step - loss: 0.0848 - acc: 0.9719
Epoch 26/27

8/8 [==============================] - 0s 37ms/step - loss: 0.0816 - acc: 0.9738
Epoch 27/27

8/8 [==============================] - 0s 37ms/step - loss: 0.0738 - acc: 0.9769
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7186
False 1885
True percentage 0.792194906846
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.87      0.96      0.91      7318
      B-LOC       0.55      0.13      0.21       218
      I-LOC       0.00      0.00      0.00       141
      B-ORG       0.30      0.33      0.32       296
      B-PER       1.00      0.00      0.00       438
      I-PER       0.00      0.00      0.00       214
      I-ORG       0.00      0.00      0.00       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.77      0.79      0.75      9071

F-1 Score (without O):
0.120617110799
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 10
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104041 unique words.
4037 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658688     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,818
Trainable params: 6,770,818
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 2s 256ms/step - loss: 0.3215 - acc: 0.9000
Epoch 2/27

8/8 [==============================] - 0s 38ms/step - loss: 0.3017 - acc: 0.9000
Epoch 3/27

8/8 [==============================] - 0s 39ms/step - loss: 0.2626 - acc: 0.9006
Epoch 4/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2425 - acc: 0.9045
Epoch 5/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2129 - acc: 0.9173
Epoch 6/27

8/8 [==============================] - 0s 36ms/step - loss: 0.1925 - acc: 0.9346
Epoch 7/27

8/8 [==============================] - 0s 36ms/step - loss: 0.1768 - acc: 0.9402
Epoch 8/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1654 - acc: 0.9514
Epoch 9/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1349 - acc: 0.9659
Epoch 10/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1304 - acc: 0.9631
Epoch 11/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1201 - acc: 0.9631
Epoch 12/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1123 - acc: 0.9642
Epoch 13/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1133 - acc: 0.9615
Epoch 14/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1121 - acc: 0.9626
Epoch 15/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1070 - acc: 0.9631
Epoch 16/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0983 - acc: 0.9654
Epoch 17/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0983 - acc: 0.9642
Epoch 18/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0949 - acc: 0.9676
Epoch 19/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0838 - acc: 0.9704
Epoch 20/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0831 - acc: 0.9726
Epoch 21/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0789 - acc: 0.9749
Epoch 22/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0770 - acc: 0.9760
Epoch 23/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0759 - acc: 0.9793
Epoch 24/27

8/8 [==============================] - 0s 39ms/step - loss: 0.0770 - acc: 0.9777
Epoch 25/27

8/8 [==============================] - 0s 39ms/step - loss: 0.0722 - acc: 0.9793
Epoch 26/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0699 - acc: 0.9799
Epoch 27/27

8/8 [==============================] - 0s 39ms/step - loss: 0.0698 - acc: 0.9793
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 6992
False 2079
True percentage 0.770808069673
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.93      0.94      7318
      B-ORG       0.08      0.02      0.03       296
      I-ORG       0.08      0.18      0.11       151
      B-LOC       0.17      0.65      0.27       218
      B-PER       0.00      0.00      0.00       438
      I-PER       0.00      0.00      0.00       214
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      I-LOC       0.00      0.00      0.00       141

avg / total       0.77      0.77      0.76      9071

F-1 Score (without O):
0.116009280742
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 11
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104036 unique words.
4032 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658368     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,498
Trainable params: 6,770,498
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 2s 259ms/step - loss: 0.3501 - acc: 0.9000
Epoch 2/27

8/8 [==============================] - 0s 38ms/step - loss: 0.3288 - acc: 0.9000
Epoch 3/27

8/8 [==============================] - 0s 38ms/step - loss: 0.3122 - acc: 0.9000
Epoch 4/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2899 - acc: 0.9000
Epoch 5/27

8/8 [==============================] - 0s 36ms/step - loss: 0.2740 - acc: 0.9006
Epoch 6/27

8/8 [==============================] - 0s 37ms/step - loss: 0.2559 - acc: 0.9000
Epoch 7/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2411 - acc: 0.9028
Epoch 8/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2180 - acc: 0.9118
Epoch 9/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2108 - acc: 0.9169
Epoch 10/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1895 - acc: 0.9247
Epoch 11/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1762 - acc: 0.9348
Epoch 12/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1638 - acc: 0.9393
Epoch 13/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1514 - acc: 0.9511
Epoch 14/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1431 - acc: 0.9596
Epoch 15/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1329 - acc: 0.9618
Epoch 16/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1282 - acc: 0.9624
Epoch 17/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1196 - acc: 0.9635
Epoch 18/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1135 - acc: 0.9629
Epoch 19/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1078 - acc: 0.9635
Epoch 20/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1014 - acc: 0.9652
Epoch 21/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0988 - acc: 0.9663
Epoch 22/27

8/8 [==============================] - 0s 39ms/step - loss: 0.0958 - acc: 0.9669
Epoch 23/27

8/8 [==============================] - 0s 39ms/step - loss: 0.0917 - acc: 0.9691
Epoch 24/27

8/8 [==============================] - 0s 39ms/step - loss: 0.0931 - acc: 0.9680
Epoch 25/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0858 - acc: 0.9708
Epoch 26/27

8/8 [==============================] - 0s 39ms/step - loss: 0.0809 - acc: 0.9764
Epoch 27/27

8/8 [==============================] - 0s 39ms/step - loss: 0.0804 - acc: 0.9775
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7058
False 2013
True percentage 0.778084003969
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.89      0.95      0.92      7318
      B-ORG       0.00      0.00      0.00       296
      I-ORG       0.11      0.46      0.17       151
     B-MISC       0.00      0.00      0.00       141
      B-LOC       0.00      0.00      0.00       218
      B-PER       0.00      0.00      0.00       438
     I-MISC       0.00      0.00      0.00       154
      I-PER       0.00      0.00      0.00       214
      I-LOC       0.00      0.00      0.00       141

avg / total       0.72      0.78      0.75      9071

F-1 Score (without O):
0.0578990901572
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104029 unique words.
Found 181 unique chars.
Found 8 unique labels.
Found 104034 unique words.
4030 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 567
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658240     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,220
Trainable params: 6,770,220
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/27

8/8 [==============================] - 2s 258ms/step - loss: 0.3861 - acc: 0.8837
Epoch 2/27

8/8 [==============================] - 0s 38ms/step - loss: 0.3567 - acc: 0.8859
Epoch 3/27

8/8 [==============================] - 0s 38ms/step - loss: 0.3242 - acc: 0.8859
Epoch 4/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2983 - acc: 0.8881
Epoch 5/27

8/8 [==============================] - 0s 39ms/step - loss: 0.2686 - acc: 0.8896
Epoch 6/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2383 - acc: 0.8978
Epoch 7/27

8/8 [==============================] - 0s 38ms/step - loss: 0.2177 - acc: 0.9113
Epoch 8/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1836 - acc: 0.9314
Epoch 9/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1641 - acc: 0.9456
Epoch 10/27

8/8 [==============================] - 0s 37ms/step - loss: 0.1434 - acc: 0.9567
Epoch 11/27

8/8 [==============================] - 0s 39ms/step - loss: 0.1316 - acc: 0.9620
Epoch 12/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1170 - acc: 0.9664
Epoch 13/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1055 - acc: 0.9687
Epoch 14/27

8/8 [==============================] - 0s 38ms/step - loss: 0.1035 - acc: 0.9679
Epoch 15/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0935 - acc: 0.9679
Epoch 16/27

8/8 [==============================] - 0s 37ms/step - loss: 0.0958 - acc: 0.9687
Epoch 17/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0932 - acc: 0.9694
Epoch 18/27

8/8 [==============================] - 0s 39ms/step - loss: 0.0908 - acc: 0.9687
Epoch 19/27

8/8 [==============================] - 0s 39ms/step - loss: 0.0901 - acc: 0.9687
Epoch 20/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0871 - acc: 0.9679
Epoch 21/27

8/8 [==============================] - 0s 37ms/step - loss: 0.0893 - acc: 0.9679
Epoch 22/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0778 - acc: 0.9709
Epoch 23/27

8/8 [==============================] - 0s 37ms/step - loss: 0.0741 - acc: 0.9702
Epoch 24/27

8/8 [==============================] - 0s 37ms/step - loss: 0.0711 - acc: 0.9724
Epoch 25/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0724 - acc: 0.9702
Epoch 26/27

8/8 [==============================] - 0s 36ms/step - loss: 0.0656 - acc: 0.9732
Epoch 27/27

8/8 [==============================] - 0s 38ms/step - loss: 0.0609 - acc: 0.9791
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7099
False 1831
True percentage 0.794960806271
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.86      0.96      0.91      7318
      B-PER       0.00      0.00      0.00       438
      B-ORG       0.20      0.19      0.20       296
     B-MISC       0.00      0.00      0.00       141
      I-PER       0.30      0.07      0.11       214
      I-ORG       0.00      0.00      0.00       151
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.00      0.00      0.00       218

avg / total       0.72      0.79      0.75      8930

F-1 Score (without O):
0.0732336255802
