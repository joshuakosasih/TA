Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.3635 - acc: 0.8876
Epoch 2/28

1674/1674 [==============================] - 43s 25ms/step - loss: 0.2151 - acc: 0.9327
Epoch 3/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1729 - acc: 0.9477
Epoch 4/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1430 - acc: 0.9569
Epoch 5/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1257 - acc: 0.9634
Epoch 6/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1090 - acc: 0.9682
Epoch 7/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0975 - acc: 0.9714
Epoch 8/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0877 - acc: 0.9757
Epoch 9/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0815 - acc: 0.9773
Epoch 10/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0723 - acc: 0.9792
Epoch 11/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0689 - acc: 0.9804
Epoch 12/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0617 - acc: 0.9823
Epoch 13/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0577 - acc: 0.9839
Epoch 14/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0533 - acc: 0.9851
Epoch 15/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0504 - acc: 0.9856
Epoch 16/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0459 - acc: 0.9875
Epoch 17/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0448 - acc: 0.9877
Epoch 18/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0420 - acc: 0.9879
Epoch 19/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0405 - acc: 0.9888
Epoch 20/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0389 - acc: 0.9893
Epoch 21/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0370 - acc: 0.9898
Epoch 22/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0346 - acc: 0.9900
Epoch 23/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0324 - acc: 0.9912
Epoch 24/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0317 - acc: 0.9909
Epoch 25/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0310 - acc: 0.9914
Epoch 26/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0294 - acc: 0.9915
Epoch 27/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0286 - acc: 0.9917
Epoch 28/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0268 - acc: 0.9919
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8259
False 812
True percentage 0.910483959872
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
      B-PER       0.91      0.83      0.87       438
      B-ORG       0.78      0.73      0.75       296
      I-ORG       0.61      0.62      0.62       151
      I-PER       0.90      0.65      0.76       214
      B-LOC       0.76      0.77      0.76       218
     B-MISC       0.40      0.32      0.36       141
      I-LOC       0.74      0.81      0.77       141
     I-MISC       0.55      0.45      0.49       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.720930232558
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.4174 - acc: 0.8738
Epoch 2/28

1674/1674 [==============================] - 43s 25ms/step - loss: 0.2426 - acc: 0.9271
Epoch 3/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1877 - acc: 0.9440
Epoch 4/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1599 - acc: 0.9519
Epoch 5/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1347 - acc: 0.9612
Epoch 6/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1176 - acc: 0.9669
Epoch 7/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1059 - acc: 0.9699
Epoch 8/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0945 - acc: 0.9736
Epoch 9/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0826 - acc: 0.9770
Epoch 10/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0760 - acc: 0.9785
Epoch 11/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0709 - acc: 0.9800
Epoch 12/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0651 - acc: 0.9823
Epoch 13/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0594 - acc: 0.9830
Epoch 14/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0558 - acc: 0.9850
Epoch 15/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0540 - acc: 0.9846
Epoch 16/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0489 - acc: 0.9868
Epoch 17/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0456 - acc: 0.9871
Epoch 18/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0430 - acc: 0.9879
Epoch 19/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0406 - acc: 0.9887
Epoch 20/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0395 - acc: 0.9890
Epoch 21/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0371 - acc: 0.9894
Epoch 22/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0364 - acc: 0.9896
Epoch 23/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0339 - acc: 0.9906
Epoch 24/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0335 - acc: 0.9905
Epoch 25/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0317 - acc: 0.9915
Epoch 26/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0298 - acc: 0.9913
Epoch 27/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0288 - acc: 0.9921
Epoch 28/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0279 - acc: 0.9923
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8253
False 818
True percentage 0.9098225113
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.91      0.84      0.87       438
      B-ORG       0.74      0.75      0.74       296
      I-ORG       0.58      0.61      0.59       151
     B-MISC       0.44      0.33      0.38       141
     I-MISC       0.58      0.45      0.51       154
      I-PER       0.93      0.66      0.77       214
      B-LOC       0.77      0.71      0.74       218
      I-LOC       0.75      0.77      0.76       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.720359281437
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.4228 - acc: 0.8717
Epoch 2/28

1674/1674 [==============================] - 43s 26ms/step - loss: 0.2422 - acc: 0.9289
Epoch 3/28

1674/1674 [==============================] - 43s 26ms/step - loss: 0.1904 - acc: 0.9447
Epoch 4/28

1674/1674 [==============================] - 43s 26ms/step - loss: 0.1577 - acc: 0.9545
Epoch 5/28

1674/1674 [==============================] - 43s 26ms/step - loss: 0.1334 - acc: 0.9616
Epoch 6/28

1674/1674 [==============================] - 43s 26ms/step - loss: 0.1171 - acc: 0.9660
Epoch 7/28

1674/1674 [==============================] - 43s 26ms/step - loss: 0.1049 - acc: 0.9701
Epoch 8/28

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0923 - acc: 0.9734
Epoch 9/28

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0831 - acc: 0.9767
Epoch 10/28

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0767 - acc: 0.9785
Epoch 11/28

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0714 - acc: 0.9796
Epoch 12/28

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0656 - acc: 0.9813
Epoch 13/28

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0603 - acc: 0.9832
Epoch 14/28

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0561 - acc: 0.9848
Epoch 15/28

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0511 - acc: 0.9862
Epoch 16/28

1674/1674 [==============================] - 43s 25ms/step - loss: 0.0488 - acc: 0.9863
Epoch 17/28

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0471 - acc: 0.9863
Epoch 18/28

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0451 - acc: 0.9868
Epoch 19/28

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0401 - acc: 0.9887
Epoch 20/28

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0401 - acc: 0.9888
Epoch 21/28

1674/1674 [==============================] - 43s 25ms/step - loss: 0.0390 - acc: 0.9890
Epoch 22/28

1674/1674 [==============================] - 43s 25ms/step - loss: 0.0354 - acc: 0.9898
Epoch 23/28

1674/1674 [==============================] - 43s 25ms/step - loss: 0.0345 - acc: 0.9905
Epoch 24/28

1674/1674 [==============================] - 43s 25ms/step - loss: 0.0329 - acc: 0.9907
Epoch 25/28

1674/1674 [==============================] - 43s 25ms/step - loss: 0.0316 - acc: 0.9908
Epoch 26/28

1674/1674 [==============================] - 43s 25ms/step - loss: 0.0291 - acc: 0.9917
Epoch 27/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0282 - acc: 0.9924
Epoch 28/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0269 - acc: 0.9923
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8251
False 820
True percentage 0.909602028442
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.75      0.74      0.75       296
      B-PER       0.91      0.83      0.87       438
      I-PER       0.91      0.63      0.74       214
      B-LOC       0.75      0.75      0.75       218
      I-LOC       0.75      0.77      0.76       141
      I-ORG       0.64      0.62      0.63       151
     B-MISC       0.46      0.30      0.36       141
     I-MISC       0.48      0.43      0.45       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.714929408231
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.4068 - acc: 0.8765
Epoch 2/28

1674/1674 [==============================] - 43s 26ms/step - loss: 0.2354 - acc: 0.9293
Epoch 3/28

1674/1674 [==============================] - 43s 26ms/step - loss: 0.1848 - acc: 0.9462
Epoch 4/28

1674/1674 [==============================] - 43s 25ms/step - loss: 0.1565 - acc: 0.9538
Epoch 5/28

1674/1674 [==============================] - 43s 25ms/step - loss: 0.1337 - acc: 0.9621
Epoch 6/28

1674/1674 [==============================] - 43s 25ms/step - loss: 0.1150 - acc: 0.9663
Epoch 7/28

1674/1674 [==============================] - 43s 25ms/step - loss: 0.1047 - acc: 0.9696
Epoch 8/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0931 - acc: 0.9736
Epoch 9/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0838 - acc: 0.9773
Epoch 10/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0751 - acc: 0.9794
Epoch 11/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0705 - acc: 0.9806
Epoch 12/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0648 - acc: 0.9819
Epoch 13/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0603 - acc: 0.9832
Epoch 14/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0563 - acc: 0.9841
Epoch 15/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0523 - acc: 0.9854
Epoch 16/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0493 - acc: 0.9858
Epoch 17/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0473 - acc: 0.9864
Epoch 18/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0456 - acc: 0.9874
Epoch 19/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0426 - acc: 0.9882
Epoch 20/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0392 - acc: 0.9893
Epoch 21/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0364 - acc: 0.9895
Epoch 22/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0354 - acc: 0.9897
Epoch 23/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0348 - acc: 0.9897
Epoch 24/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0317 - acc: 0.9914
Epoch 25/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0309 - acc: 0.9909
Epoch 26/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0301 - acc: 0.9915
Epoch 27/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0283 - acc: 0.9917
Epoch 28/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0279 - acc: 0.9917
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8247
False 824
True percentage 0.909161062727
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
     B-MISC       0.44      0.30      0.36       141
     I-MISC       0.55      0.40      0.47       154
      B-ORG       0.73      0.75      0.74       296
      B-LOC       0.75      0.74      0.75       218
      B-PER       0.90      0.84      0.87       438
      I-PER       0.89      0.66      0.76       214
      I-ORG       0.61      0.65      0.63       151
      I-LOC       0.74      0.79      0.76       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.718070854421
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.3981 - acc: 0.8801
Epoch 2/28

1674/1674 [==============================] - 43s 26ms/step - loss: 0.2297 - acc: 0.9316
Epoch 3/28

1674/1674 [==============================] - 43s 26ms/step - loss: 0.1794 - acc: 0.9473
Epoch 4/28

1674/1674 [==============================] - 43s 26ms/step - loss: 0.1494 - acc: 0.9571
Epoch 5/28

1674/1674 [==============================] - 43s 25ms/step - loss: 0.1291 - acc: 0.9630
Epoch 6/28

1674/1674 [==============================] - 43s 25ms/step - loss: 0.1127 - acc: 0.9665
Epoch 7/28

1674/1674 [==============================] - 43s 25ms/step - loss: 0.0989 - acc: 0.9716
Epoch 8/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0900 - acc: 0.9745
Epoch 9/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0811 - acc: 0.9767
Epoch 10/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0746 - acc: 0.9794
Epoch 11/28

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0702 - acc: 0.9810
Epoch 12/28

1674/1674 [==============================] - 43s 26ms/step - loss: 0.0629 - acc: 0.9822
Epoch 13/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0574 - acc: 0.9834
Epoch 14/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0535 - acc: 0.9844
Epoch 15/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0503 - acc: 0.9862
Epoch 16/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0468 - acc: 0.9873
Epoch 17/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0445 - acc: 0.9870
Epoch 18/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0422 - acc: 0.9887
Epoch 19/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0399 - acc: 0.9887
Epoch 20/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0388 - acc: 0.9897
Epoch 21/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0368 - acc: 0.9903
Epoch 22/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0345 - acc: 0.9902
Epoch 23/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0331 - acc: 0.9909
Epoch 24/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0317 - acc: 0.9909
Epoch 25/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0297 - acc: 0.9917
Epoch 26/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0285 - acc: 0.9920
Epoch 27/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0269 - acc: 0.9926
Epoch 28/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0268 - acc: 0.9924
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8237
False 834
True percentage 0.90805864844
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.91      0.83      0.87       438
      I-PER       0.87      0.67      0.76       214
          O       0.98      0.96      0.97      7318
      B-ORG       0.75      0.75      0.75       296
      B-LOC       0.75      0.78      0.76       218
      I-ORG       0.61      0.64      0.62       151
      I-LOC       0.68      0.83      0.75       141
     B-MISC       0.44      0.28      0.35       141
     I-MISC       0.53      0.33      0.41       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.926835010889
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104767 unique words.
4763 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 244
OOV word occurences: in test 345
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6705152     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,817,282
Trainable params: 6,817,282
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 25s 30ms/step - loss: 0.4872 - acc: 0.8493
Epoch 2/28

837/837 [==============================] - 22s 26ms/step - loss: 0.2825 - acc: 0.9154
Epoch 3/28

837/837 [==============================] - 21s 26ms/step - loss: 0.2235 - acc: 0.9352
Epoch 4/28

837/837 [==============================] - 21s 26ms/step - loss: 0.1883 - acc: 0.9447
Epoch 5/28

837/837 [==============================] - 21s 26ms/step - loss: 0.1603 - acc: 0.9545
Epoch 6/28

837/837 [==============================] - 21s 26ms/step - loss: 0.1379 - acc: 0.9619
Epoch 7/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1233 - acc: 0.9657
Epoch 8/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1076 - acc: 0.9698
Epoch 9/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0986 - acc: 0.9729
Epoch 10/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0859 - acc: 0.9787
Epoch 11/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0782 - acc: 0.9800
Epoch 12/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0718 - acc: 0.9817
Epoch 13/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0658 - acc: 0.9834
Epoch 14/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0599 - acc: 0.9853
Epoch 15/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0547 - acc: 0.9872
Epoch 16/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0502 - acc: 0.9867
Epoch 17/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0475 - acc: 0.9884
Epoch 18/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0453 - acc: 0.9882
Epoch 19/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0435 - acc: 0.9890
Epoch 20/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0380 - acc: 0.9907
Epoch 21/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0350 - acc: 0.9924
Epoch 22/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0353 - acc: 0.9915
Epoch 23/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0326 - acc: 0.9920
Epoch 24/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0295 - acc: 0.9930
Epoch 25/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0268 - acc: 0.9939
Epoch 26/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0267 - acc: 0.9941
Epoch 27/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0262 - acc: 0.9937
Epoch 28/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0248 - acc: 0.9939
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8211
False 860
True percentage 0.905192371293
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.89      0.83      0.86       438
      B-ORG       0.75      0.72      0.74       296
      I-ORG       0.63      0.56      0.59       151
      I-PER       0.90      0.63      0.74       214
      B-LOC       0.70      0.78      0.74       218
     B-MISC       0.50      0.30      0.37       141
      I-LOC       0.67      0.80      0.73       141
     I-MISC       0.59      0.42      0.49       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.711111111111
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104723 unique words.
4719 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 249
OOV word occurences: in test 356
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6702336     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,814,466
Trainable params: 6,814,466
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 25s 30ms/step - loss: 0.4901 - acc: 0.8522
Epoch 2/28

837/837 [==============================] - 22s 26ms/step - loss: 0.2851 - acc: 0.9142
Epoch 3/28

837/837 [==============================] - 21s 26ms/step - loss: 0.2297 - acc: 0.9313
Epoch 4/28

837/837 [==============================] - 21s 26ms/step - loss: 0.1924 - acc: 0.9443
Epoch 5/28

837/837 [==============================] - 21s 26ms/step - loss: 0.1688 - acc: 0.9522
Epoch 6/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1450 - acc: 0.9592
Epoch 7/28

837/837 [==============================] - 21s 26ms/step - loss: 0.1309 - acc: 0.9645
Epoch 8/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1163 - acc: 0.9677
Epoch 9/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1061 - acc: 0.9705
Epoch 10/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0979 - acc: 0.9747
Epoch 11/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0903 - acc: 0.9752
Epoch 12/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0815 - acc: 0.9783
Epoch 13/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0743 - acc: 0.9797
Epoch 14/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0685 - acc: 0.9827
Epoch 15/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0654 - acc: 0.9824
Epoch 16/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0593 - acc: 0.9841
Epoch 17/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0561 - acc: 0.9855
Epoch 18/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0541 - acc: 0.9856
Epoch 19/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0499 - acc: 0.9875
Epoch 20/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0464 - acc: 0.9879
Epoch 21/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0440 - acc: 0.9889
Epoch 22/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0423 - acc: 0.9888
Epoch 23/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0405 - acc: 0.9890
Epoch 24/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0360 - acc: 0.9906
Epoch 25/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0352 - acc: 0.9915
Epoch 26/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0335 - acc: 0.9916
Epoch 27/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0301 - acc: 0.9926
Epoch 28/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0308 - acc: 0.9922
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8183
False 888
True percentage 0.902105611289
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
      B-PER       0.90      0.82      0.86       438
      B-ORG       0.72      0.72      0.72       296
      I-ORG       0.53      0.56      0.55       151
     B-MISC       0.38      0.30      0.33       141
     I-MISC       0.53      0.41      0.46       154
      I-PER       0.93      0.66      0.77       214
      B-LOC       0.72      0.73      0.73       218
      I-LOC       0.71      0.79      0.75       141

avg / total       0.94      0.90      0.92      9071

F-1 Score (without O):
0.699138699139
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104715 unique words.
4711 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 248
OOV word occurences: in test 352
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6701824     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,813,954
Trainable params: 6,813,954
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 25s 30ms/step - loss: 0.5416 - acc: 0.8337
Epoch 2/28

837/837 [==============================] - 22s 26ms/step - loss: 0.3128 - acc: 0.9101
Epoch 3/28

837/837 [==============================] - 21s 26ms/step - loss: 0.2475 - acc: 0.9289
Epoch 4/28

837/837 [==============================] - 21s 25ms/step - loss: 0.2114 - acc: 0.9400
Epoch 5/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1773 - acc: 0.9506
Epoch 6/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1556 - acc: 0.9565
Epoch 7/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1375 - acc: 0.9623
Epoch 8/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1243 - acc: 0.9651
Epoch 9/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1102 - acc: 0.9697
Epoch 10/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1001 - acc: 0.9735
Epoch 11/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0908 - acc: 0.9763
Epoch 12/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0818 - acc: 0.9790
Epoch 13/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0770 - acc: 0.9793
Epoch 14/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0721 - acc: 0.9810
Epoch 15/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0665 - acc: 0.9825
Epoch 16/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0611 - acc: 0.9838
Epoch 17/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0563 - acc: 0.9860
Epoch 18/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0530 - acc: 0.9858
Epoch 19/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0486 - acc: 0.9873
Epoch 20/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0467 - acc: 0.9881
Epoch 21/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0432 - acc: 0.9884
Epoch 22/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0412 - acc: 0.9897
Epoch 23/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0364 - acc: 0.9910
Epoch 24/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0377 - acc: 0.9903
Epoch 25/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0333 - acc: 0.9913
Epoch 26/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0335 - acc: 0.9904
Epoch 27/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0311 - acc: 0.9924
Epoch 28/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0308 - acc: 0.9919
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8193
False 878
True percentage 0.903208025576
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.72      0.72      0.72       296
      B-PER       0.90      0.81      0.85       438
      I-PER       0.89      0.65      0.75       214
      B-LOC       0.76      0.69      0.72       218
      I-LOC       0.76      0.78      0.77       141
      I-ORG       0.59      0.59      0.59       151
     B-MISC       0.49      0.33      0.39       141
     I-MISC       0.51      0.38      0.44       154

avg / total       0.94      0.90      0.92      9071

F-1 Score (without O):
0.702817328082
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104764 unique words.
4760 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 248
OOV word occurences: in test 387
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6704960     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,817,090
Trainable params: 6,817,090
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 25s 30ms/step - loss: 0.4922 - acc: 0.8468
Epoch 2/28

837/837 [==============================] - 22s 26ms/step - loss: 0.2945 - acc: 0.9107
Epoch 3/28

837/837 [==============================] - 21s 26ms/step - loss: 0.2393 - acc: 0.9278
Epoch 4/28

837/837 [==============================] - 21s 26ms/step - loss: 0.2002 - acc: 0.9398
Epoch 5/28

837/837 [==============================] - 21s 26ms/step - loss: 0.1738 - acc: 0.9492
Epoch 6/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1538 - acc: 0.9554
Epoch 7/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1365 - acc: 0.9616
Epoch 8/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1193 - acc: 0.9669
Epoch 9/28

837/837 [==============================] - 21s 26ms/step - loss: 0.1099 - acc: 0.9701
Epoch 10/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0995 - acc: 0.9732
Epoch 11/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0886 - acc: 0.9774
Epoch 12/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0814 - acc: 0.9782
Epoch 13/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0748 - acc: 0.9812
Epoch 14/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0714 - acc: 0.9816
Epoch 15/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0638 - acc: 0.9844
Epoch 16/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0621 - acc: 0.9825
Epoch 17/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0549 - acc: 0.9857
Epoch 18/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0530 - acc: 0.9864
Epoch 19/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0496 - acc: 0.9874
Epoch 20/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0476 - acc: 0.9868
Epoch 21/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0439 - acc: 0.9887
Epoch 22/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0420 - acc: 0.9882
Epoch 23/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0403 - acc: 0.9890
Epoch 24/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0389 - acc: 0.9887
Epoch 25/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0365 - acc: 0.9909
Epoch 26/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0353 - acc: 0.9914
Epoch 27/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0332 - acc: 0.9914
Epoch 28/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0306 - acc: 0.9921
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8098
False 973
True percentage 0.892735089847
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
     B-MISC       0.37      0.29      0.33       141
     I-MISC       0.44      0.44      0.44       154
      B-ORG       0.70      0.67      0.69       296
      B-LOC       0.74      0.72      0.73       218
      B-PER       0.86      0.74      0.80       438
      I-PER       0.89      0.63      0.74       214
      I-ORG       0.52      0.42      0.47       151
      I-LOC       0.68      0.75      0.72       141

avg / total       0.93      0.89      0.91      9071

F-1 Score (without O):
0.659043033404
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104723 unique words.
4719 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 245
OOV word occurences: in test 385
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6702336     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,814,466
Trainable params: 6,814,466
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 25s 30ms/step - loss: 0.5028 - acc: 0.8486
Epoch 2/28

837/837 [==============================] - 22s 26ms/step - loss: 0.2808 - acc: 0.9171
Epoch 3/28

837/837 [==============================] - 22s 26ms/step - loss: 0.2201 - acc: 0.9367
Epoch 4/28

837/837 [==============================] - 21s 26ms/step - loss: 0.1904 - acc: 0.9445
Epoch 5/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1599 - acc: 0.9552
Epoch 6/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1415 - acc: 0.9602
Epoch 7/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1264 - acc: 0.9654
Epoch 8/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1112 - acc: 0.9701
Epoch 9/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1006 - acc: 0.9732
Epoch 10/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0951 - acc: 0.9752
Epoch 11/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0839 - acc: 0.9779
Epoch 12/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0772 - acc: 0.9807
Epoch 13/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0697 - acc: 0.9821
Epoch 14/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0633 - acc: 0.9840
Epoch 15/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0611 - acc: 0.9847
Epoch 16/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0555 - acc: 0.9869
Epoch 17/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0496 - acc: 0.9881
Epoch 18/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0484 - acc: 0.9885
Epoch 19/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0437 - acc: 0.9900
Epoch 20/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0420 - acc: 0.9896
Epoch 21/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0406 - acc: 0.9898
Epoch 22/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0374 - acc: 0.9905
Epoch 23/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0369 - acc: 0.9909
Epoch 24/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0336 - acc: 0.9919
Epoch 25/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0320 - acc: 0.9919
Epoch 26/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0312 - acc: 0.9922
Epoch 27/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0299 - acc: 0.9923
Epoch 28/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0291 - acc: 0.9932
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8074
False 997
True percentage 0.890089295557
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.87      0.72      0.78       438
      I-PER       0.87      0.64      0.74       214
          O       0.99      0.95      0.97      7318
      B-ORG       0.66      0.71      0.68       296
      B-LOC       0.71      0.66      0.69       218
      I-ORG       0.48      0.58      0.52       151
      I-LOC       0.72      0.71      0.72       141
     B-MISC       0.42      0.30      0.35       141
     I-MISC       0.39      0.35      0.37       154

avg / total       0.93      0.89      0.91      9071

F-1 Score (without O):
0.915310214673
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104352 unique words.
4348 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 266
OOV word occurences: in test 428
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678592     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,722
Trainable params: 6,790,722
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 12s 36ms/step - loss: 0.7874 - acc: 0.7735
Epoch 2/28

334/334 [==============================] - 9s 26ms/step - loss: 0.4382 - acc: 0.8616
Epoch 3/28

334/334 [==============================] - 9s 26ms/step - loss: 0.3647 - acc: 0.8916
Epoch 4/28

334/334 [==============================] - 9s 26ms/step - loss: 0.3165 - acc: 0.9045
Epoch 5/28

334/334 [==============================] - 9s 26ms/step - loss: 0.2677 - acc: 0.9263
Epoch 6/28

334/334 [==============================] - 9s 26ms/step - loss: 0.2424 - acc: 0.9255
Epoch 7/28

334/334 [==============================] - 9s 26ms/step - loss: 0.2139 - acc: 0.9397
Epoch 8/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1908 - acc: 0.9487
Epoch 9/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1704 - acc: 0.9550
Epoch 10/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1575 - acc: 0.9579
Epoch 11/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1442 - acc: 0.9624
Epoch 12/28

334/334 [==============================] - 9s 26ms/step - loss: 0.1365 - acc: 0.9668
Epoch 13/28

334/334 [==============================] - 9s 25ms/step - loss: 0.1208 - acc: 0.9715
Epoch 14/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1120 - acc: 0.9753
Epoch 15/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1022 - acc: 0.9761
Epoch 16/28

334/334 [==============================] - 9s 25ms/step - loss: 0.0961 - acc: 0.9797
Epoch 17/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0913 - acc: 0.9800
Epoch 18/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0851 - acc: 0.9806
Epoch 19/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0788 - acc: 0.9838
Epoch 20/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0722 - acc: 0.9839
Epoch 21/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0687 - acc: 0.9857
Epoch 22/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0647 - acc: 0.9875
Epoch 23/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0615 - acc: 0.9873
Epoch 24/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0540 - acc: 0.9904
Epoch 25/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0526 - acc: 0.9887
Epoch 26/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0509 - acc: 0.9898
Epoch 27/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0485 - acc: 0.9902
Epoch 28/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0448 - acc: 0.9919
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8006
False 1065
True percentage 0.882592878404
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.96      0.97      7318
      B-PER       0.86      0.70      0.77       438
      B-ORG       0.66      0.64      0.65       296
      I-ORG       0.43      0.44      0.43       151
      I-PER       0.82      0.59      0.68       214
      B-LOC       0.73      0.73      0.73       218
     B-MISC       0.38      0.16      0.23       141
      I-LOC       0.60      0.74      0.66       141
     I-MISC       0.45      0.11      0.18       154

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.62034428795
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104340 unique words.
4336 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 268
OOV word occurences: in test 411
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6677824     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,789,954
Trainable params: 6,789,954
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 11s 34ms/step - loss: 0.6517 - acc: 0.8017
Epoch 2/28

334/334 [==============================] - 9s 26ms/step - loss: 0.3701 - acc: 0.8836
Epoch 3/28

334/334 [==============================] - 9s 26ms/step - loss: 0.3005 - acc: 0.9090
Epoch 4/28

334/334 [==============================] - 9s 26ms/step - loss: 0.2668 - acc: 0.9235
Epoch 5/28

334/334 [==============================] - 9s 26ms/step - loss: 0.2251 - acc: 0.9331
Epoch 6/28

334/334 [==============================] - 9s 25ms/step - loss: 0.2043 - acc: 0.9423
Epoch 7/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1823 - acc: 0.9511
Epoch 8/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1597 - acc: 0.9562
Epoch 9/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1433 - acc: 0.9640
Epoch 10/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1288 - acc: 0.9693
Epoch 11/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1144 - acc: 0.9739
Epoch 12/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1093 - acc: 0.9738
Epoch 13/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0968 - acc: 0.9763
Epoch 14/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0900 - acc: 0.9785
Epoch 15/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0803 - acc: 0.9820
Epoch 16/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0741 - acc: 0.9831
Epoch 17/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0669 - acc: 0.9859
Epoch 18/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0651 - acc: 0.9858
Epoch 19/28

334/334 [==============================] - 9s 26ms/step - loss: 0.0585 - acc: 0.9874
Epoch 20/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0552 - acc: 0.9890
Epoch 21/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0506 - acc: 0.9896
Epoch 22/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0484 - acc: 0.9896
Epoch 23/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0473 - acc: 0.9892
Epoch 24/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0393 - acc: 0.9932
Epoch 25/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0440 - acc: 0.9907
Epoch 26/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0389 - acc: 0.9905
Epoch 27/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0368 - acc: 0.9914
Epoch 28/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0321 - acc: 0.9944
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7996
False 1075
True percentage 0.881490464116
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.97      7318
      B-PER       0.85      0.70      0.77       438
      B-ORG       0.64      0.68      0.66       296
      I-ORG       0.38      0.48      0.42       151
     B-MISC       0.39      0.23      0.29       141
     I-MISC       0.40      0.36      0.38       154
      I-PER       0.89      0.58      0.70       214
      B-LOC       0.73      0.66      0.70       218
      I-LOC       0.86      0.55      0.67       141

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.620605319474
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104355 unique words.
4351 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 262
OOV word occurences: in test 406
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678784     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,914
Trainable params: 6,790,914
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 12s 35ms/step - loss: 0.7286 - acc: 0.7826
Epoch 2/28

334/334 [==============================] - 9s 26ms/step - loss: 0.4173 - acc: 0.8729
Epoch 3/28

334/334 [==============================] - 9s 26ms/step - loss: 0.3471 - acc: 0.8987
Epoch 4/28

334/334 [==============================] - 9s 26ms/step - loss: 0.2985 - acc: 0.9127
Epoch 5/28

334/334 [==============================] - 9s 26ms/step - loss: 0.2604 - acc: 0.9237
Epoch 6/28

334/334 [==============================] - 9s 26ms/step - loss: 0.2290 - acc: 0.9343
Epoch 7/28

334/334 [==============================] - 9s 26ms/step - loss: 0.2038 - acc: 0.9437
Epoch 8/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1856 - acc: 0.9479
Epoch 9/28

334/334 [==============================] - 9s 25ms/step - loss: 0.1663 - acc: 0.9561
Epoch 10/28

334/334 [==============================] - 9s 25ms/step - loss: 0.1504 - acc: 0.9597
Epoch 11/28

334/334 [==============================] - 9s 26ms/step - loss: 0.1387 - acc: 0.9618
Epoch 12/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1223 - acc: 0.9696
Epoch 13/28

334/334 [==============================] - 9s 26ms/step - loss: 0.1157 - acc: 0.9716
Epoch 14/28

334/334 [==============================] - 9s 26ms/step - loss: 0.1046 - acc: 0.9738
Epoch 15/28

334/334 [==============================] - 9s 25ms/step - loss: 0.0983 - acc: 0.9757
Epoch 16/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0871 - acc: 0.9801
Epoch 17/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0818 - acc: 0.9814
Epoch 18/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0759 - acc: 0.9819
Epoch 19/28

334/334 [==============================] - 9s 25ms/step - loss: 0.0723 - acc: 0.9845
Epoch 20/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0636 - acc: 0.9867
Epoch 21/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0625 - acc: 0.9866
Epoch 22/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0567 - acc: 0.9887
Epoch 23/28

334/334 [==============================] - 9s 25ms/step - loss: 0.0549 - acc: 0.9882
Epoch 24/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0533 - acc: 0.9869
Epoch 25/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0506 - acc: 0.9885
Epoch 26/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0459 - acc: 0.9915
Epoch 27/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0416 - acc: 0.9916
Epoch 28/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0413 - acc: 0.9909
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8078
False 993
True percentage 0.890530261272
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.66      0.75      0.70       296
      B-PER       0.86      0.68      0.76       438
      I-PER       0.83      0.60      0.70       214
      B-LOC       0.69      0.66      0.67       218
      I-LOC       0.74      0.74      0.74       141
      I-ORG       0.56      0.60      0.58       151
     B-MISC       0.52      0.25      0.34       141
     I-MISC       0.61      0.28      0.38       154

avg / total       0.93      0.89      0.91      9071

F-1 Score (without O):
0.659245516388
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104348 unique words.
4344 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 262
OOV word occurences: in test 426
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678336     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,466
Trainable params: 6,790,466
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 11s 34ms/step - loss: 0.6841 - acc: 0.7939
Epoch 2/28

334/334 [==============================] - 9s 26ms/step - loss: 0.3745 - acc: 0.8824
Epoch 3/28

334/334 [==============================] - 9s 26ms/step - loss: 0.3143 - acc: 0.9029
Epoch 4/28

334/334 [==============================] - 9s 26ms/step - loss: 0.2687 - acc: 0.9186
Epoch 5/28

334/334 [==============================] - 9s 26ms/step - loss: 0.2343 - acc: 0.9317
Epoch 6/28

334/334 [==============================] - 8s 25ms/step - loss: 0.2101 - acc: 0.9376
Epoch 7/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1896 - acc: 0.9437
Epoch 8/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1700 - acc: 0.9520
Epoch 9/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1540 - acc: 0.9582
Epoch 10/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1378 - acc: 0.9642
Epoch 11/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1302 - acc: 0.9679
Epoch 12/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1143 - acc: 0.9718
Epoch 13/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1045 - acc: 0.9751
Epoch 14/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0953 - acc: 0.9784
Epoch 15/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0903 - acc: 0.9801
Epoch 16/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0840 - acc: 0.9791
Epoch 17/28

334/334 [==============================] - 9s 25ms/step - loss: 0.0759 - acc: 0.9834
Epoch 18/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0695 - acc: 0.9851
Epoch 19/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0654 - acc: 0.9852
Epoch 20/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0586 - acc: 0.9863
Epoch 21/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0560 - acc: 0.9877
Epoch 22/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0514 - acc: 0.9894
Epoch 23/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0495 - acc: 0.9896
Epoch 24/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0454 - acc: 0.9909
Epoch 25/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0442 - acc: 0.9893
Epoch 26/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0399 - acc: 0.9917
Epoch 27/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0392 - acc: 0.9916
Epoch 28/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0355 - acc: 0.9926
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7941
False 1130
True percentage 0.875427185536
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
     B-MISC       0.36      0.22      0.27       141
     I-MISC       0.43      0.25      0.31       154
      B-ORG       0.67      0.65      0.66       296
      B-LOC       0.67      0.69      0.68       218
      B-PER       0.82      0.62      0.71       438
      I-PER       0.91      0.55      0.69       214
      I-ORG       0.37      0.40      0.39       151
      I-LOC       0.58      0.72      0.64       141

avg / total       0.91      0.88      0.89      9071

F-1 Score (without O):
0.59499536608
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104309 unique words.
4305 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 264
OOV word occurences: in test 431
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6675840     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,787,970
Trainable params: 6,787,970
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 11s 34ms/step - loss: 0.6383 - acc: 0.8040
Epoch 2/28

334/334 [==============================] - 9s 26ms/step - loss: 0.3726 - acc: 0.8866
Epoch 3/28

334/334 [==============================] - 9s 26ms/step - loss: 0.3085 - acc: 0.9105
Epoch 4/28

334/334 [==============================] - 9s 26ms/step - loss: 0.2540 - acc: 0.9268
Epoch 5/28

334/334 [==============================] - 9s 26ms/step - loss: 0.2270 - acc: 0.9383
Epoch 6/28

334/334 [==============================] - 9s 25ms/step - loss: 0.2002 - acc: 0.9435
Epoch 7/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1720 - acc: 0.9522
Epoch 8/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1531 - acc: 0.9597
Epoch 9/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1349 - acc: 0.9657
Epoch 10/28

334/334 [==============================] - 9s 26ms/step - loss: 0.1256 - acc: 0.9670
Epoch 11/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1114 - acc: 0.9727
Epoch 12/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1023 - acc: 0.9769
Epoch 13/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0931 - acc: 0.9758
Epoch 14/28

334/334 [==============================] - 9s 26ms/step - loss: 0.0852 - acc: 0.9799
Epoch 15/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0786 - acc: 0.9812
Epoch 16/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0708 - acc: 0.9840
Epoch 17/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0648 - acc: 0.9863
Epoch 18/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0609 - acc: 0.9865
Epoch 19/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0594 - acc: 0.9866
Epoch 20/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0538 - acc: 0.9880
Epoch 21/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0495 - acc: 0.9906
Epoch 22/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0469 - acc: 0.9894
Epoch 23/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0444 - acc: 0.9911
Epoch 24/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0435 - acc: 0.9904
Epoch 25/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0415 - acc: 0.9904
Epoch 26/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0366 - acc: 0.9927
Epoch 27/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0359 - acc: 0.9915
Epoch 28/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0360 - acc: 0.9926
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7985
False 1086
True percentage 0.8802778084
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.84      0.67      0.74       438
      I-PER       0.76      0.60      0.67       214
          O       0.98      0.95      0.96      7318
      B-ORG       0.68      0.71      0.69       296
      B-LOC       0.78      0.68      0.73       218
      I-ORG       0.42      0.44      0.43       151
      I-LOC       0.79      0.71      0.75       141
     B-MISC       0.31      0.20      0.24       141
     I-MISC       0.34      0.22      0.27       154

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.909058677539
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104194 unique words.
4190 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 275
OOV word occurences: in test 464
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6668480     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,780,610
Trainable params: 6,780,610
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 7s 43ms/step - loss: 0.9229 - acc: 0.7349
Epoch 2/28

167/167 [==============================] - 5s 27ms/step - loss: 0.4230 - acc: 0.8682
Epoch 3/28

167/167 [==============================] - 4s 27ms/step - loss: 0.3542 - acc: 0.8882
Epoch 4/28

167/167 [==============================] - 4s 27ms/step - loss: 0.3145 - acc: 0.9050
Epoch 5/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2756 - acc: 0.9191
Epoch 6/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2543 - acc: 0.9245
Epoch 7/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2216 - acc: 0.9352
Epoch 8/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2116 - acc: 0.9372
Epoch 9/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1884 - acc: 0.9481
Epoch 10/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1723 - acc: 0.9602
Epoch 11/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1584 - acc: 0.9578
Epoch 12/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1443 - acc: 0.9672
Epoch 13/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1384 - acc: 0.9657
Epoch 14/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1272 - acc: 0.9696
Epoch 15/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1159 - acc: 0.9728
Epoch 16/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1072 - acc: 0.9777
Epoch 17/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0987 - acc: 0.9808
Epoch 18/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0925 - acc: 0.9813
Epoch 19/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0859 - acc: 0.9843
Epoch 20/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0804 - acc: 0.9841
Epoch 21/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0728 - acc: 0.9876
Epoch 22/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0753 - acc: 0.9871
Epoch 23/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0674 - acc: 0.9902
Epoch 24/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0614 - acc: 0.9899
Epoch 25/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0584 - acc: 0.9897
Epoch 26/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0548 - acc: 0.9897
Epoch 27/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0505 - acc: 0.9934
Epoch 28/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0513 - acc: 0.9918
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7900
False 1171
True percentage 0.870907286958
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-PER       0.83      0.65      0.73       438
      B-ORG       0.51      0.66      0.57       296
      I-ORG       0.36      0.52      0.42       151
      I-PER       0.75      0.59      0.66       214
      B-LOC       0.83      0.63      0.72       218
     B-MISC       0.68      0.09      0.16       141
      I-LOC       0.54      0.50      0.52       141
     I-MISC       0.60      0.10      0.17       154

avg / total       0.92      0.87      0.89      9071

F-1 Score (without O):
0.573208722741
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104185 unique words.
4181 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 272
OOV word occurences: in test 428
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6667904     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,780,034
Trainable params: 6,780,034
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 7s 43ms/step - loss: 0.8195 - acc: 0.7543
Epoch 2/28

167/167 [==============================] - 5s 27ms/step - loss: 0.4398 - acc: 0.8636
Epoch 3/28

167/167 [==============================] - 4s 27ms/step - loss: 0.3707 - acc: 0.8867
Epoch 4/28

167/167 [==============================] - 4s 27ms/step - loss: 0.3196 - acc: 0.9064
Epoch 5/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2771 - acc: 0.9243
Epoch 6/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2442 - acc: 0.9311
Epoch 7/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2259 - acc: 0.9373
Epoch 8/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2078 - acc: 0.9410
Epoch 9/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1803 - acc: 0.9542
Epoch 10/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1663 - acc: 0.9593
Epoch 11/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1521 - acc: 0.9656
Epoch 12/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1337 - acc: 0.9684
Epoch 13/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1294 - acc: 0.9703
Epoch 14/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1174 - acc: 0.9736
Epoch 15/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1091 - acc: 0.9779
Epoch 16/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0949 - acc: 0.9821
Epoch 17/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0891 - acc: 0.9819
Epoch 18/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0837 - acc: 0.9855
Epoch 19/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0758 - acc: 0.9869
Epoch 20/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0735 - acc: 0.9867
Epoch 21/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0681 - acc: 0.9876
Epoch 22/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0623 - acc: 0.9868
Epoch 23/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0585 - acc: 0.9891
Epoch 24/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0509 - acc: 0.9943
Epoch 25/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0522 - acc: 0.9922
Epoch 26/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0473 - acc: 0.9932
Epoch 27/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0439 - acc: 0.9938
Epoch 28/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0439 - acc: 0.9931
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7851
False 1220
True percentage 0.865505456951
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-PER       0.84      0.66      0.74       438
      B-ORG       0.53      0.64      0.57       296
      I-ORG       0.30      0.50      0.38       151
     B-MISC       0.24      0.11      0.15       141
     I-MISC       0.21      0.09      0.13       154
      I-PER       0.70      0.56      0.62       214
      B-LOC       0.73      0.65      0.68       218
      I-LOC       0.73      0.36      0.48       141

avg / total       0.90      0.87      0.88      9071

F-1 Score (without O):
0.545398960563
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104214 unique words.
4210 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 271
OOV word occurences: in test 452
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6669760     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,781,890
Trainable params: 6,781,890
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 8s 45ms/step - loss: 0.8554 - acc: 0.7279
Epoch 2/28

167/167 [==============================] - 5s 28ms/step - loss: 0.4762 - acc: 0.8548
Epoch 3/28

167/167 [==============================] - 5s 27ms/step - loss: 0.4087 - acc: 0.8736
Epoch 4/28

167/167 [==============================] - 5s 27ms/step - loss: 0.3517 - acc: 0.8965
Epoch 5/28

167/167 [==============================] - 4s 26ms/step - loss: 0.3081 - acc: 0.9107
Epoch 6/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2695 - acc: 0.9239
Epoch 7/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2426 - acc: 0.9298
Epoch 8/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2259 - acc: 0.9385
Epoch 9/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1989 - acc: 0.9466
Epoch 10/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1794 - acc: 0.9507
Epoch 11/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1575 - acc: 0.9631
Epoch 12/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1483 - acc: 0.9650
Epoch 13/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1355 - acc: 0.9671
Epoch 14/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1262 - acc: 0.9706
Epoch 15/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1155 - acc: 0.9733
Epoch 16/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1116 - acc: 0.9740
Epoch 17/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0952 - acc: 0.9821
Epoch 18/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0869 - acc: 0.9817
Epoch 19/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0780 - acc: 0.9858
Epoch 20/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0793 - acc: 0.9835
Epoch 21/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0708 - acc: 0.9869
Epoch 22/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0687 - acc: 0.9884
Epoch 23/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0653 - acc: 0.9893
Epoch 24/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0577 - acc: 0.9898
Epoch 25/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0557 - acc: 0.9908
Epoch 26/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0518 - acc: 0.9905
Epoch 27/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0498 - acc: 0.9898
Epoch 28/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0458 - acc: 0.9929
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7899
False 1172
True percentage 0.87079704553
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-ORG       0.59      0.64      0.61       296
      B-PER       0.78      0.60      0.68       438
      I-PER       0.73      0.52      0.61       214
      B-LOC       0.66      0.63      0.65       218
      I-LOC       0.70      0.66      0.68       141
      I-ORG       0.43      0.57      0.49       151
     B-MISC       0.46      0.19      0.27       141
     I-MISC       0.47      0.21      0.29       154

avg / total       0.91      0.87      0.89      9071

F-1 Score (without O):
0.581840642372
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104201 unique words.
4197 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 270
OOV word occurences: in test 452
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6668928     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,781,058
Trainable params: 6,781,058
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 7s 42ms/step - loss: 0.9330 - acc: 0.7314
Epoch 2/28

167/167 [==============================] - 5s 27ms/step - loss: 0.4575 - acc: 0.8567
Epoch 3/28

167/167 [==============================] - 5s 27ms/step - loss: 0.3838 - acc: 0.8810
Epoch 4/28

167/167 [==============================] - 5s 27ms/step - loss: 0.3258 - acc: 0.9010
Epoch 5/28

167/167 [==============================] - 4s 27ms/step - loss: 0.2930 - acc: 0.9165
Epoch 6/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2646 - acc: 0.9233
Epoch 7/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2368 - acc: 0.9336
Epoch 8/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2134 - acc: 0.9430
Epoch 9/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1933 - acc: 0.9506
Epoch 10/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1748 - acc: 0.9612
Epoch 11/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1589 - acc: 0.9589
Epoch 12/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1439 - acc: 0.9651
Epoch 13/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1315 - acc: 0.9670
Epoch 14/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1222 - acc: 0.9733
Epoch 15/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1122 - acc: 0.9743
Epoch 16/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1072 - acc: 0.9756
Epoch 17/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0929 - acc: 0.9812
Epoch 18/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0848 - acc: 0.9836
Epoch 19/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0804 - acc: 0.9844
Epoch 20/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0774 - acc: 0.9846
Epoch 21/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0697 - acc: 0.9886
Epoch 22/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0621 - acc: 0.9888
Epoch 23/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0582 - acc: 0.9927
Epoch 24/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0590 - acc: 0.9899
Epoch 25/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0496 - acc: 0.9934
Epoch 26/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0493 - acc: 0.9931
Epoch 27/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0429 - acc: 0.9943
Epoch 28/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0433 - acc: 0.9929
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7824
False 1247
True percentage 0.862528938375
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.95      0.96      7318
     B-MISC       0.17      0.12      0.14       141
     I-MISC       0.32      0.20      0.25       154
      B-ORG       0.63      0.52      0.57       296
      B-LOC       0.69      0.62      0.66       218
      B-PER       0.80      0.59      0.68       438
      I-PER       0.83      0.54      0.65       214
      I-ORG       0.37      0.31      0.34       151
      I-LOC       0.67      0.70      0.69       141

avg / total       0.90      0.86      0.88      9071

F-1 Score (without O):
0.548655569782
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104181 unique words.
4177 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 273
OOV word occurences: in test 525
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6667648     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,779,778
Trainable params: 6,779,778
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 7s 42ms/step - loss: 0.7670 - acc: 0.7721
Epoch 2/28

167/167 [==============================] - 5s 28ms/step - loss: 0.4296 - acc: 0.8699
Epoch 3/28

167/167 [==============================] - 4s 27ms/step - loss: 0.3528 - acc: 0.8970
Epoch 4/28

167/167 [==============================] - 4s 27ms/step - loss: 0.3029 - acc: 0.9113
Epoch 5/28

167/167 [==============================] - 4s 27ms/step - loss: 0.2671 - acc: 0.9264
Epoch 6/28

167/167 [==============================] - 4s 27ms/step - loss: 0.2259 - acc: 0.9366
Epoch 7/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2077 - acc: 0.9409
Epoch 8/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1822 - acc: 0.9554
Epoch 9/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1647 - acc: 0.9571
Epoch 10/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1491 - acc: 0.9593
Epoch 11/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1312 - acc: 0.9670
Epoch 12/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1227 - acc: 0.9686
Epoch 13/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1148 - acc: 0.9718
Epoch 14/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1002 - acc: 0.9787
Epoch 15/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0899 - acc: 0.9836
Epoch 16/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0829 - acc: 0.9836
Epoch 17/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0761 - acc: 0.9859
Epoch 18/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0724 - acc: 0.9875
Epoch 19/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0658 - acc: 0.9898
Epoch 20/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0616 - acc: 0.9894
Epoch 21/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0558 - acc: 0.9902
Epoch 22/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0550 - acc: 0.9911
Epoch 23/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0484 - acc: 0.9928
Epoch 24/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0430 - acc: 0.9944
Epoch 25/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0417 - acc: 0.9932
Epoch 26/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0393 - acc: 0.9944
Epoch 27/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0352 - acc: 0.9965
Epoch 28/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0347 - acc: 0.9959
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7756
False 1315
True percentage 0.855032521221
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.84      0.48      0.61       438
      I-PER       0.81      0.37      0.51       214
          O       0.97      0.95      0.96      7318
      B-ORG       0.58      0.62      0.60       296
      B-LOC       0.70      0.65      0.67       218
      I-ORG       0.30      0.44      0.36       151
      I-LOC       0.71      0.58      0.64       141
     B-MISC       0.31      0.18      0.23       141
     I-MISC       0.26      0.27      0.27       154

avg / total       0.91      0.86      0.88      9071

F-1 Score (without O):
0.891409665603
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104112 unique words.
4108 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 562
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663232     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,362
Trainable params: 6,775,362
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 5s 59ms/step - loss: 1.1139 - acc: 0.6820
Epoch 2/28

83/83 [==============================] - 2s 29ms/step - loss: 0.4801 - acc: 0.8521
Epoch 3/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3883 - acc: 0.8820
Epoch 4/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3423 - acc: 0.9034
Epoch 5/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3107 - acc: 0.9190
Epoch 6/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2728 - acc: 0.9210
Epoch 7/28

83/83 [==============================] - 2s 27ms/step - loss: 0.2650 - acc: 0.9204
Epoch 8/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2272 - acc: 0.9394
Epoch 9/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2149 - acc: 0.9402
Epoch 10/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2014 - acc: 0.9448
Epoch 11/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1834 - acc: 0.9519
Epoch 12/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1700 - acc: 0.9545
Epoch 13/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1593 - acc: 0.9628
Epoch 14/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1472 - acc: 0.9664
Epoch 15/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1363 - acc: 0.9722
Epoch 16/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1314 - acc: 0.9696
Epoch 17/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1171 - acc: 0.9789
Epoch 18/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1143 - acc: 0.9720
Epoch 19/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1091 - acc: 0.9785
Epoch 20/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1066 - acc: 0.9765
Epoch 21/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0985 - acc: 0.9823
Epoch 22/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0883 - acc: 0.9834
Epoch 23/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0862 - acc: 0.9843
Epoch 24/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0768 - acc: 0.9869
Epoch 25/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0779 - acc: 0.9852
Epoch 26/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0783 - acc: 0.9862
Epoch 27/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0715 - acc: 0.9899
Epoch 28/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0662 - acc: 0.9918
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7630
False 1441
True percentage 0.841142101202
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.94      0.95      7318
      B-PER       0.74      0.49      0.59       438
      B-ORG       0.44      0.54      0.49       296
      I-ORG       0.23      0.48      0.31       151
      I-PER       0.77      0.43      0.56       214
      B-LOC       0.76      0.55      0.63       218
     B-MISC       0.32      0.09      0.13       141
      I-LOC       0.83      0.27      0.41       141
     I-MISC       0.52      0.10      0.16       154

avg / total       0.90      0.84      0.86      9071

F-1 Score (without O):
0.466131621188
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104114 unique words.
4110 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 276
OOV word occurences: in test 456
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663360     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,490
Trainable params: 6,775,490
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 5s 59ms/step - loss: 0.9384 - acc: 0.7549
Epoch 2/28

83/83 [==============================] - 2s 28ms/step - loss: 0.5078 - acc: 0.8430
Epoch 3/28

83/83 [==============================] - 2s 28ms/step - loss: 0.4054 - acc: 0.8718
Epoch 4/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3545 - acc: 0.8924
Epoch 5/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3108 - acc: 0.9064
Epoch 6/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2737 - acc: 0.9247
Epoch 7/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2545 - acc: 0.9289
Epoch 8/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2190 - acc: 0.9436
Epoch 9/28

83/83 [==============================] - 2s 27ms/step - loss: 0.2131 - acc: 0.9418
Epoch 10/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1906 - acc: 0.9529
Epoch 11/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1748 - acc: 0.9558
Epoch 12/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1588 - acc: 0.9680
Epoch 13/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1601 - acc: 0.9594
Epoch 14/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1402 - acc: 0.9728
Epoch 15/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1250 - acc: 0.9724
Epoch 16/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1205 - acc: 0.9801
Epoch 17/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1055 - acc: 0.9821
Epoch 18/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1012 - acc: 0.9800
Epoch 19/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0898 - acc: 0.9858
Epoch 20/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0873 - acc: 0.9861
Epoch 21/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0805 - acc: 0.9882
Epoch 22/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0757 - acc: 0.9868
Epoch 23/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0706 - acc: 0.9887
Epoch 24/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0693 - acc: 0.9889
Epoch 25/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0648 - acc: 0.9891
Epoch 26/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0630 - acc: 0.9903
Epoch 27/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0588 - acc: 0.9909
Epoch 28/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0533 - acc: 0.9926
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7789
False 1282
True percentage 0.85867048837
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-PER       0.83      0.64      0.72       438
      B-ORG       0.54      0.60      0.57       296
      I-ORG       0.30      0.29      0.30       151
     B-MISC       0.27      0.12      0.17       141
     I-MISC       0.30      0.26      0.28       154
      I-PER       0.71      0.52      0.60       214
      B-LOC       0.64      0.62      0.63       218
      I-LOC       0.64      0.30      0.41       141

avg / total       0.90      0.86      0.87      9071

F-1 Score (without O):
0.530663329161
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104134 unique words.
4130 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 280
OOV word occurences: in test 543
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6664640     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,776,770
Trainable params: 6,776,770
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 5s 61ms/step - loss: 1.0875 - acc: 0.6549
Epoch 2/28

83/83 [==============================] - 2s 29ms/step - loss: 0.5630 - acc: 0.8264
Epoch 3/28

83/83 [==============================] - 2s 28ms/step - loss: 0.4813 - acc: 0.8575
Epoch 4/28

83/83 [==============================] - 2s 28ms/step - loss: 0.4102 - acc: 0.8765
Epoch 5/28

83/83 [==============================] - 2s 28ms/step - loss: 0.4048 - acc: 0.8765
Epoch 6/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3357 - acc: 0.9067
Epoch 7/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3051 - acc: 0.9141
Epoch 8/28

83/83 [==============================] - 2s 27ms/step - loss: 0.2884 - acc: 0.9153
Epoch 9/28

83/83 [==============================] - 2s 27ms/step - loss: 0.2649 - acc: 0.9264
Epoch 10/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2430 - acc: 0.9290
Epoch 11/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2233 - acc: 0.9380
Epoch 12/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2078 - acc: 0.9430
Epoch 13/28

83/83 [==============================] - 2s 27ms/step - loss: 0.2019 - acc: 0.9497
Epoch 14/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1808 - acc: 0.9571
Epoch 15/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1741 - acc: 0.9532
Epoch 16/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1540 - acc: 0.9638
Epoch 17/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1517 - acc: 0.9687
Epoch 18/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1451 - acc: 0.9696
Epoch 19/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1269 - acc: 0.9726
Epoch 20/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1224 - acc: 0.9755
Epoch 21/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1143 - acc: 0.9776
Epoch 22/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1072 - acc: 0.9793
Epoch 23/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1032 - acc: 0.9799
Epoch 24/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0956 - acc: 0.9806
Epoch 25/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0917 - acc: 0.9847
Epoch 26/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0845 - acc: 0.9851
Epoch 27/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0858 - acc: 0.9859
Epoch 28/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0786 - acc: 0.9894
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7590
False 1481
True percentage 0.836732444052
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.94      0.96      7318
      B-ORG       0.54      0.54      0.54       296
      B-PER       0.72      0.43      0.54       438
      I-PER       0.52      0.41      0.46       214
      B-LOC       0.58      0.57      0.58       218
      I-LOC       0.36      0.54      0.43       141
      I-ORG       0.17      0.22      0.19       151
     B-MISC       0.22      0.13      0.16       141
     I-MISC       0.25      0.10      0.15       154

avg / total       0.88      0.84      0.86      9071

F-1 Score (without O):
0.432182490752
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104118 unique words.
4114 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 276
OOV word occurences: in test 477
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663616     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,746
Trainable params: 6,775,746
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 5s 66ms/step - loss: 1.1772 - acc: 0.6576
Epoch 2/28

83/83 [==============================] - 2s 28ms/step - loss: 0.4928 - acc: 0.8470
Epoch 3/28

83/83 [==============================] - 2s 29ms/step - loss: 0.4158 - acc: 0.8581
Epoch 4/28

83/83 [==============================] - 2s 29ms/step - loss: 0.3700 - acc: 0.8864
Epoch 5/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3360 - acc: 0.8979
Epoch 6/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2955 - acc: 0.9112
Epoch 7/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2806 - acc: 0.9194
Epoch 8/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2474 - acc: 0.9326
Epoch 9/28

83/83 [==============================] - 2s 27ms/step - loss: 0.2236 - acc: 0.9394
Epoch 10/28

83/83 [==============================] - 2s 27ms/step - loss: 0.2128 - acc: 0.9493
Epoch 11/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1880 - acc: 0.9533
Epoch 12/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1854 - acc: 0.9478
Epoch 13/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1696 - acc: 0.9624
Epoch 14/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1605 - acc: 0.9632
Epoch 15/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1448 - acc: 0.9701
Epoch 16/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1330 - acc: 0.9757
Epoch 17/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1337 - acc: 0.9702
Epoch 18/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1243 - acc: 0.9747
Epoch 19/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1093 - acc: 0.9800
Epoch 20/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1030 - acc: 0.9819
Epoch 21/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1013 - acc: 0.9808
Epoch 22/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0933 - acc: 0.9880
Epoch 23/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0853 - acc: 0.9893
Epoch 24/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0867 - acc: 0.9866
Epoch 25/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0783 - acc: 0.9865
Epoch 26/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0699 - acc: 0.9918
Epoch 27/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0715 - acc: 0.9872
Epoch 28/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0687 - acc: 0.9907
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7638
False 1433
True percentage 0.842024032631
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.95      0.95      7318
     B-MISC       0.30      0.17      0.22       141
     I-MISC       0.21      0.07      0.11       154
      B-ORG       0.39      0.40      0.40       296
      B-LOC       0.82      0.50      0.62       218
      B-PER       0.78      0.48      0.60       438
      I-PER       0.76      0.48      0.59       214
      I-ORG       0.21      0.31      0.25       151
      I-LOC       0.61      0.46      0.53       141

avg / total       0.88      0.84      0.86      9071

F-1 Score (without O):
0.451063829787
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104107 unique words.
4103 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 276
OOV word occurences: in test 528
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6662912     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,042
Trainable params: 6,775,042
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 5s 59ms/step - loss: 0.8785 - acc: 0.7787
Epoch 2/28

83/83 [==============================] - 2s 28ms/step - loss: 0.4834 - acc: 0.8503
Epoch 3/28

83/83 [==============================] - 2s 29ms/step - loss: 0.4232 - acc: 0.8584
Epoch 4/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3660 - acc: 0.8793
Epoch 5/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3223 - acc: 0.8924
Epoch 6/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2951 - acc: 0.9142
Epoch 7/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2626 - acc: 0.9165
Epoch 8/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2401 - acc: 0.9297
Epoch 9/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2212 - acc: 0.9325
Epoch 10/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2020 - acc: 0.9499
Epoch 11/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1771 - acc: 0.9509
Epoch 12/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1749 - acc: 0.9528
Epoch 13/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1545 - acc: 0.9549
Epoch 14/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1435 - acc: 0.9740
Epoch 15/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1283 - acc: 0.9716
Epoch 16/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1182 - acc: 0.9797
Epoch 17/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1146 - acc: 0.9802
Epoch 18/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1024 - acc: 0.9837
Epoch 19/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0997 - acc: 0.9818
Epoch 20/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0917 - acc: 0.9853
Epoch 21/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0877 - acc: 0.9822
Epoch 22/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0806 - acc: 0.9889
Epoch 23/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0738 - acc: 0.9876
Epoch 24/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0679 - acc: 0.9900
Epoch 25/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0616 - acc: 0.9925
Epoch 26/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0611 - acc: 0.9946
Epoch 27/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0569 - acc: 0.9936
Epoch 28/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0545 - acc: 0.9936
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7610
False 1461
True percentage 0.838937272627
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.80      0.45      0.57       438
      I-PER       0.75      0.20      0.32       214
          O       0.97      0.95      0.96      7318
      B-ORG       0.48      0.66      0.56       296
      B-LOC       0.74      0.57      0.65       218
      I-ORG       0.19      0.48      0.27       151
      I-LOC       0.40      0.16      0.23       141
     B-MISC       0.33      0.04      0.08       141
     I-MISC       0.31      0.10      0.15       154

avg / total       0.89      0.84      0.85      9071

F-1 Score (without O):
0.875804641824
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104069 unique words.
4065 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660480     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,610
Trainable params: 6,772,610
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 4s 108ms/step - loss: 1.7521 - acc: 0.4524
Epoch 2/28

33/33 [==============================] - 1s 32ms/step - loss: 0.6184 - acc: 0.8536
Epoch 3/28

33/33 [==============================] - 1s 32ms/step - loss: 0.4005 - acc: 0.8801
Epoch 4/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3370 - acc: 0.8945
Epoch 5/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3080 - acc: 0.9094
Epoch 6/28

33/33 [==============================] - 1s 33ms/step - loss: 0.2651 - acc: 0.9226
Epoch 7/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2467 - acc: 0.9296
Epoch 8/28

33/33 [==============================] - 1s 33ms/step - loss: 0.2328 - acc: 0.9339
Epoch 9/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2052 - acc: 0.9452
Epoch 10/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1893 - acc: 0.9651
Epoch 11/28

33/33 [==============================] - 1s 33ms/step - loss: 0.1923 - acc: 0.9495
Epoch 12/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1698 - acc: 0.9633
Epoch 13/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1694 - acc: 0.9694
Epoch 14/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2294 - acc: 0.9397
Epoch 15/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1622 - acc: 0.9589
Epoch 16/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1368 - acc: 0.9692
Epoch 17/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1412 - acc: 0.9617
Epoch 18/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1295 - acc: 0.9650
Epoch 19/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1236 - acc: 0.9706
Epoch 20/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1174 - acc: 0.9733
Epoch 21/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1132 - acc: 0.9754
Epoch 22/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1141 - acc: 0.9680
Epoch 23/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1007 - acc: 0.9714
Epoch 24/28

33/33 [==============================] - 1s 31ms/step - loss: 0.0986 - acc: 0.9731
Epoch 25/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1036 - acc: 0.9735
Epoch 26/28

33/33 [==============================] - 1s 32ms/step - loss: 0.0975 - acc: 0.9764
Epoch 27/28

33/33 [==============================] - 1s 31ms/step - loss: 0.0937 - acc: 0.9759
Epoch 28/28

33/33 [==============================] - 1s 32ms/step - loss: 0.0944 - acc: 0.9769
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7130
False 1941
True percentage 0.786021386837
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.93      0.94      7318
      B-PER       0.70      0.20      0.32       438
      B-ORG       0.21      0.51      0.29       296
      I-ORG       0.15      0.40      0.22       151
      I-PER       0.63      0.21      0.32       214
      B-LOC       0.00      0.00      0.00       218
     B-MISC       0.00      0.00      0.00       141
      I-LOC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.82      0.79      0.79      9071

F-1 Score (without O):
0.224894377641
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104062 unique words.
4058 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 281
OOV word occurences: in test 473
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660032     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,162
Trainable params: 6,772,162
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 4s 110ms/step - loss: 2.1718 - acc: 0.3895
Epoch 2/28

33/33 [==============================] - 1s 33ms/step - loss: 0.9292 - acc: 0.8107
Epoch 3/28

33/33 [==============================] - 1s 32ms/step - loss: 0.5830 - acc: 0.8264
Epoch 4/28

33/33 [==============================] - 1s 32ms/step - loss: 0.5041 - acc: 0.8353
Epoch 5/28

33/33 [==============================] - 1s 31ms/step - loss: 0.4554 - acc: 0.8516
Epoch 6/28

33/33 [==============================] - 1s 34ms/step - loss: 0.4193 - acc: 0.8691
Epoch 7/28

33/33 [==============================] - 1s 32ms/step - loss: 0.4020 - acc: 0.8687
Epoch 8/28

33/33 [==============================] - 1s 33ms/step - loss: 0.3649 - acc: 0.8709
Epoch 9/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3351 - acc: 0.9010
Epoch 10/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3165 - acc: 0.9229
Epoch 11/28

33/33 [==============================] - 1s 33ms/step - loss: 0.3032 - acc: 0.9156
Epoch 12/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2732 - acc: 0.9202
Epoch 13/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2748 - acc: 0.9146
Epoch 14/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2519 - acc: 0.9390
Epoch 15/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2364 - acc: 0.9392
Epoch 16/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2355 - acc: 0.9311
Epoch 17/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2092 - acc: 0.9491
Epoch 18/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2061 - acc: 0.9589
Epoch 19/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1990 - acc: 0.9457
Epoch 20/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1817 - acc: 0.9628
Epoch 21/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1735 - acc: 0.9713
Epoch 22/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1740 - acc: 0.9551
Epoch 23/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1531 - acc: 0.9803
Epoch 24/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1532 - acc: 0.9797
Epoch 25/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1471 - acc: 0.9814
Epoch 26/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1477 - acc: 0.9786
Epoch 27/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1289 - acc: 0.9797
Epoch 28/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1272 - acc: 0.9873
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7477
False 1594
True percentage 0.824275162606
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.94      0.95      7318
      B-PER       0.63      0.45      0.52       438
      B-ORG       0.39      0.43      0.41       296
      I-ORG       0.16      0.13      0.14       151
     B-MISC       0.30      0.16      0.21       141
     I-MISC       0.25      0.41      0.31       154
      I-PER       0.41      0.47      0.44       214
      B-LOC       0.56      0.41      0.48       218
      I-LOC       0.82      0.10      0.18       141

avg / total       0.87      0.82      0.84      9071

F-1 Score (without O):
0.388004895961
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104087 unique words.
4083 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 553
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6661632     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,773,762
Trainable params: 6,773,762
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 4s 109ms/step - loss: 1.7405 - acc: 0.4429
Epoch 2/28

33/33 [==============================] - 1s 32ms/step - loss: 0.9585 - acc: 0.7608
Epoch 3/28

33/33 [==============================] - 1s 33ms/step - loss: 0.6934 - acc: 0.7938
Epoch 4/28

33/33 [==============================] - 1s 32ms/step - loss: 0.6259 - acc: 0.8226
Epoch 5/28

33/33 [==============================] - 1s 32ms/step - loss: 0.5399 - acc: 0.8452
Epoch 6/28

33/33 [==============================] - 1s 33ms/step - loss: 0.4951 - acc: 0.8583
Epoch 7/28

33/33 [==============================] - 1s 33ms/step - loss: 0.4509 - acc: 0.8866
Epoch 8/28

33/33 [==============================] - 1s 33ms/step - loss: 0.4330 - acc: 0.8835
Epoch 9/28

33/33 [==============================] - 1s 31ms/step - loss: 0.4454 - acc: 0.8635
Epoch 10/28

33/33 [==============================] - 1s 33ms/step - loss: 0.3840 - acc: 0.8811
Epoch 11/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3606 - acc: 0.8956
Epoch 12/28

33/33 [==============================] - 1s 33ms/step - loss: 0.3423 - acc: 0.9024
Epoch 13/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3367 - acc: 0.9081
Epoch 14/28

33/33 [==============================] - 1s 33ms/step - loss: 0.3164 - acc: 0.9160
Epoch 15/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2983 - acc: 0.9126
Epoch 16/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2782 - acc: 0.9344
Epoch 17/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2823 - acc: 0.9199
Epoch 18/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2622 - acc: 0.9398
Epoch 19/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2372 - acc: 0.9524
Epoch 20/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2371 - acc: 0.9492
Epoch 21/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2177 - acc: 0.9603
Epoch 22/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2161 - acc: 0.9559
Epoch 23/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2145 - acc: 0.9625
Epoch 24/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1942 - acc: 0.9688
Epoch 25/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1850 - acc: 0.9636
Epoch 26/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1762 - acc: 0.9717
Epoch 27/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1819 - acc: 0.9726
Epoch 28/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1666 - acc: 0.9755
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7482
False 1589
True percentage 0.82482636975
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.94      0.95      7318
      B-ORG       0.57      0.35      0.44       296
      B-PER       0.42      0.47      0.45       438
      I-PER       0.67      0.19      0.29       214
      B-LOC       0.63      0.55      0.58       218
      I-LOC       0.48      0.45      0.46       141
      I-ORG       0.16      0.18      0.17       151
     B-MISC       0.28      0.17      0.21       141
     I-MISC       0.29      0.30      0.29       154

avg / total       0.87      0.82      0.84      9071

F-1 Score (without O):
0.392034847542
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104068 unique words.
4064 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 279
OOV word occurences: in test 482
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660416     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,546
Trainable params: 6,772,546
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 4s 113ms/step - loss: 1.5884 - acc: 0.5009
Epoch 2/28

33/33 [==============================] - 1s 34ms/step - loss: 0.7237 - acc: 0.7924
Epoch 3/28

33/33 [==============================] - 1s 34ms/step - loss: 0.5664 - acc: 0.8232
Epoch 4/28

33/33 [==============================] - 1s 33ms/step - loss: 0.5047 - acc: 0.8425
Epoch 5/28

33/33 [==============================] - 1s 33ms/step - loss: 0.4718 - acc: 0.8423
Epoch 6/28

33/33 [==============================] - 1s 32ms/step - loss: 0.4457 - acc: 0.8658
Epoch 7/28

33/33 [==============================] - 1s 33ms/step - loss: 0.3957 - acc: 0.8868
Epoch 8/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3993 - acc: 0.8707
Epoch 9/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3832 - acc: 0.8935
Epoch 10/28

33/33 [==============================] - 1s 33ms/step - loss: 0.4420 - acc: 0.8720
Epoch 11/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3262 - acc: 0.9304
Epoch 12/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3142 - acc: 0.9235
Epoch 13/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2866 - acc: 0.9324
Epoch 14/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2825 - acc: 0.9307
Epoch 15/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2847 - acc: 0.9232
Epoch 16/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2751 - acc: 0.9268
Epoch 17/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2714 - acc: 0.9182
Epoch 18/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2486 - acc: 0.9402
Epoch 19/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2436 - acc: 0.9372
Epoch 20/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2302 - acc: 0.9526
Epoch 21/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2200 - acc: 0.9468
Epoch 22/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2159 - acc: 0.9527
Epoch 23/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1959 - acc: 0.9638
Epoch 24/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1783 - acc: 0.9663
Epoch 25/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1886 - acc: 0.9626
Epoch 26/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1708 - acc: 0.9692
Epoch 27/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1650 - acc: 0.9675
Epoch 28/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1610 - acc: 0.9686
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7432
False 1639
True percentage 0.819314298313
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.95      0.95      7318
     B-MISC       0.19      0.17      0.18       141
     I-MISC       0.15      0.15      0.15       154
      B-ORG       0.40      0.31      0.35       296
      B-LOC       0.71      0.44      0.54       218
      B-PER       0.76      0.47      0.58       438
      I-PER       0.57      0.17      0.27       214
      I-ORG       0.10      0.18      0.13       151
      I-LOC       0.50      0.01      0.03       141

avg / total       0.86      0.82      0.83      9071

F-1 Score (without O):
0.335548172757
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104068 unique words.
4064 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 281
OOV word occurences: in test 534
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660416     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,546
Trainable params: 6,772,546
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 4s 109ms/step - loss: 1.8415 - acc: 0.4369
Epoch 2/28

33/33 [==============================] - 1s 33ms/step - loss: 0.8151 - acc: 0.8097
Epoch 3/28

33/33 [==============================] - 1s 32ms/step - loss: 0.5686 - acc: 0.8182
Epoch 4/28

33/33 [==============================] - 1s 32ms/step - loss: 0.4750 - acc: 0.8552
Epoch 5/28

33/33 [==============================] - 1s 32ms/step - loss: 0.4358 - acc: 0.8647
Epoch 6/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3972 - acc: 0.8650
Epoch 7/28

33/33 [==============================] - 1s 33ms/step - loss: 0.3794 - acc: 0.8966
Epoch 8/28

33/33 [==============================] - 1s 33ms/step - loss: 0.3587 - acc: 0.8826
Epoch 9/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3476 - acc: 0.9023
Epoch 10/28

33/33 [==============================] - 1s 33ms/step - loss: 0.3173 - acc: 0.9155
Epoch 11/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2917 - acc: 0.9064
Epoch 12/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3057 - acc: 0.9068
Epoch 13/28

33/33 [==============================] - 1s 33ms/step - loss: 0.2599 - acc: 0.9302
Epoch 14/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2644 - acc: 0.9250
Epoch 15/28

33/33 [==============================] - 1s 33ms/step - loss: 0.2360 - acc: 0.9398
Epoch 16/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2304 - acc: 0.9338
Epoch 17/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2206 - acc: 0.9313
Epoch 18/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2216 - acc: 0.9365
Epoch 19/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2011 - acc: 0.9326
Epoch 20/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2109 - acc: 0.9359
Epoch 21/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1840 - acc: 0.9449
Epoch 22/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1989 - acc: 0.9330
Epoch 23/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1783 - acc: 0.9460
Epoch 24/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1487 - acc: 0.9663
Epoch 25/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1667 - acc: 0.9607
Epoch 26/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1439 - acc: 0.9786
Epoch 27/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1360 - acc: 0.9604
Epoch 28/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1313 - acc: 0.9604
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7339
False 1732
True percentage 0.809061845442
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.62      0.30      0.41       438
      I-PER       0.00      0.00      0.00       214
          O       0.97      0.94      0.95      7318
      B-ORG       0.31      0.54      0.40       296
      B-LOC       0.80      0.33      0.47       218
      I-ORG       0.17      0.66      0.27       151
      I-LOC       0.33      0.06      0.11       141
     B-MISC       0.17      0.01      0.01       141
     I-MISC       0.26      0.07      0.11       154

avg / total       0.86      0.81      0.82      9071

F-1 Score (without O):
0.849964614296
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 7 unique labels.
Found 104057 unique words.
4053 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659712     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 8)        1112        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,544
Trainable params: 6,771,544
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 3s 184ms/step - loss: 3.1676 - acc: 0.0506
Epoch 2/28

16/16 [==============================] - 0s 28ms/step - loss: 1.3521 - acc: 0.6067
Epoch 3/28

16/16 [==============================] - 0s 27ms/step - loss: 0.5437 - acc: 0.8539
Epoch 4/28

16/16 [==============================] - 0s 26ms/step - loss: 0.3980 - acc: 0.8933
Epoch 5/28

16/16 [==============================] - 0s 25ms/step - loss: 0.5737 - acc: 0.8315
Epoch 6/28

16/16 [==============================] - 0s 26ms/step - loss: 0.5565 - acc: 0.8848
Epoch 7/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2753 - acc: 0.9213
Epoch 8/28

16/16 [==============================] - 0s 25ms/step - loss: 0.2603 - acc: 0.9270
Epoch 9/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2325 - acc: 0.9382
Epoch 10/28

16/16 [==============================] - 0s 25ms/step - loss: 0.2048 - acc: 0.9579
Epoch 11/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1966 - acc: 0.9551
Epoch 12/28

16/16 [==============================] - 0s 25ms/step - loss: 0.1853 - acc: 0.9579
Epoch 13/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1810 - acc: 0.9579
Epoch 14/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1536 - acc: 0.9747
Epoch 15/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1405 - acc: 0.9719
Epoch 16/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1395 - acc: 0.9663
Epoch 17/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1387 - acc: 0.9747
Epoch 18/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1240 - acc: 0.9803
Epoch 19/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1178 - acc: 0.9860
Epoch 20/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1096 - acc: 0.9860
Epoch 21/28

16/16 [==============================] - 0s 25ms/step - loss: 0.1074 - acc: 0.9831
Epoch 22/28

16/16 [==============================] - 0s 26ms/step - loss: 0.0952 - acc: 0.9860
Epoch 23/28

16/16 [==============================] - 0s 26ms/step - loss: 0.0919 - acc: 0.9860
Epoch 24/28

16/16 [==============================] - 0s 27ms/step - loss: 0.0929 - acc: 0.9860
Epoch 25/28

16/16 [==============================] - 0s 26ms/step - loss: 0.0747 - acc: 0.9944
Epoch 26/28

16/16 [==============================] - 0s 25ms/step - loss: 0.0767 - acc: 0.9888
Epoch 27/28

16/16 [==============================] - 0s 26ms/step - loss: 0.0716 - acc: 0.9944
Epoch 28/28

16/16 [==============================] - 0s 26ms/step - loss: 0.0684 - acc: 0.9860
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7186
False 1590
True percentage 0.818824065634
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.94      0.94      7318
      B-PER       0.55      0.27      0.37       438
      B-ORG       0.21      0.47      0.29       296
      I-ORG       0.14      0.29      0.19       151
      I-PER       0.47      0.14      0.22       214
      B-LOC       0.00      0.00      0.00       218
     B-MISC       0.00      0.00      0.00       141

avg / total       0.84      0.82      0.82      8776

F-1 Score (without O):
0.24584717608
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104046 unique words.
4042 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659008     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,138
Trainable params: 6,771,138
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 3s 185ms/step - loss: 2.0736 - acc: 0.2176
Epoch 2/28

16/16 [==============================] - 0s 29ms/step - loss: 0.8861 - acc: 0.8235
Epoch 3/28

16/16 [==============================] - 0s 27ms/step - loss: 0.5818 - acc: 0.8294
Epoch 4/28

16/16 [==============================] - 0s 26ms/step - loss: 0.5565 - acc: 0.9029
Epoch 5/28

16/16 [==============================] - 0s 26ms/step - loss: 0.4186 - acc: 0.8529
Epoch 6/28

16/16 [==============================] - 0s 26ms/step - loss: 0.3550 - acc: 0.9206
Epoch 7/28

16/16 [==============================] - 0s 26ms/step - loss: 0.3274 - acc: 0.9000
Epoch 8/28

16/16 [==============================] - 0s 25ms/step - loss: 0.2905 - acc: 0.9176
Epoch 9/28

16/16 [==============================] - 0s 25ms/step - loss: 0.2650 - acc: 0.9206
Epoch 10/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2356 - acc: 0.9647
Epoch 11/28

16/16 [==============================] - 0s 25ms/step - loss: 0.2356 - acc: 0.9441
Epoch 12/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2119 - acc: 0.9588
Epoch 13/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1914 - acc: 0.9706
Epoch 14/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1838 - acc: 0.9735
Epoch 15/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1706 - acc: 0.9765
Epoch 16/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1640 - acc: 0.9824
Epoch 17/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1498 - acc: 0.9765
Epoch 18/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1529 - acc: 0.9706
Epoch 19/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1337 - acc: 0.9824
Epoch 20/28

16/16 [==============================] - 0s 25ms/step - loss: 0.1256 - acc: 0.9853
Epoch 21/28

16/16 [==============================] - 0s 25ms/step - loss: 0.1139 - acc: 0.9882
Epoch 22/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1005 - acc: 0.9971
Epoch 23/28

16/16 [==============================] - 0s 27ms/step - loss: 0.0993 - acc: 0.9912
Epoch 24/28

16/16 [==============================] - 0s 27ms/step - loss: 0.0989 - acc: 0.9882
Epoch 25/28

16/16 [==============================] - 0s 26ms/step - loss: 0.0900 - acc: 0.9971
Epoch 26/28

16/16 [==============================] - 0s 25ms/step - loss: 0.0868 - acc: 1.0000
Epoch 27/28

16/16 [==============================] - 0s 26ms/step - loss: 0.0797 - acc: 0.9971
Epoch 28/28

16/16 [==============================] - 0s 27ms/step - loss: 0.0749 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7243
False 1828
True percentage 0.798478668284
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.94      0.93      7318
      B-PER       0.33      0.24      0.28       438
      B-ORG       0.40      0.40      0.40       296
      I-ORG       0.17      0.07      0.10       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      I-PER       0.20      0.29      0.24       214
      B-LOC       0.68      0.35      0.46       218
      I-LOC       0.60      0.02      0.04       141

avg / total       0.81      0.80      0.80      9071

F-1 Score (without O):
0.263176265271
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104060 unique words.
4056 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 567
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659904     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,034
Trainable params: 6,772,034
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 3s 185ms/step - loss: 3.0753 - acc: 0.0214
Epoch 2/28

16/16 [==============================] - 0s 29ms/step - loss: 1.3774 - acc: 0.7031
Epoch 3/28

16/16 [==============================] - 0s 28ms/step - loss: 0.9244 - acc: 0.7696
Epoch 4/28

16/16 [==============================] - 0s 27ms/step - loss: 0.7786 - acc: 0.8195
Epoch 5/28

16/16 [==============================] - 0s 27ms/step - loss: 0.7007 - acc: 0.7743
Epoch 6/28

16/16 [==============================] - 0s 26ms/step - loss: 0.6243 - acc: 0.8527
Epoch 7/28

16/16 [==============================] - 0s 25ms/step - loss: 0.5268 - acc: 0.8266
Epoch 8/28

16/16 [==============================] - 0s 26ms/step - loss: 0.4523 - acc: 0.8812
Epoch 9/28

16/16 [==============================] - 0s 25ms/step - loss: 0.4249 - acc: 0.8765
Epoch 10/28

16/16 [==============================] - 0s 26ms/step - loss: 0.3816 - acc: 0.8979
Epoch 11/28

16/16 [==============================] - 0s 26ms/step - loss: 0.3569 - acc: 0.9026
Epoch 12/28

16/16 [==============================] - 0s 26ms/step - loss: 0.3320 - acc: 0.9026
Epoch 13/28

16/16 [==============================] - 0s 28ms/step - loss: 0.3239 - acc: 0.9121
Epoch 14/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2858 - acc: 0.9145
Epoch 15/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2938 - acc: 0.9192
Epoch 16/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2782 - acc: 0.9026
Epoch 17/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2827 - acc: 0.9287
Epoch 18/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2330 - acc: 0.9525
Epoch 19/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2132 - acc: 0.9477
Epoch 20/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1974 - acc: 0.9596
Epoch 21/28

16/16 [==============================] - 0s 25ms/step - loss: 0.1858 - acc: 0.9620
Epoch 22/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1895 - acc: 0.9715
Epoch 23/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1760 - acc: 0.9620
Epoch 24/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1693 - acc: 0.9715
Epoch 25/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1550 - acc: 0.9762
Epoch 26/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1418 - acc: 0.9905
Epoch 27/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1362 - acc: 0.9810
Epoch 28/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1500 - acc: 0.9715
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7308
False 1763
True percentage 0.805644361151
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.95      0.94      7318
      B-ORG       0.41      0.33      0.37       296
      B-PER       0.36      0.31      0.33       438
      I-PER       0.42      0.24      0.30       214
      B-LOC       0.59      0.32      0.41       218
      I-LOC       0.44      0.03      0.05       141
      I-ORG       0.12      0.18      0.15       151
     B-MISC       0.10      0.01      0.02       141
     I-MISC       0.09      0.01      0.01       154

avg / total       0.82      0.81      0.81      9071

F-1 Score (without O):
0.270571827057
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104057 unique words.
4053 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 281
OOV word occurences: in test 492
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659712     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,842
Trainable params: 6,771,842
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 3s 183ms/step - loss: 3.4587 - acc: 0.0164
Epoch 2/28

16/16 [==============================] - 0s 29ms/step - loss: 1.7529 - acc: 0.4822
Epoch 3/28

16/16 [==============================] - 0s 26ms/step - loss: 0.9938 - acc: 0.8055
Epoch 4/28

16/16 [==============================] - 0s 26ms/step - loss: 0.7284 - acc: 0.8000
Epoch 5/28

16/16 [==============================] - 0s 25ms/step - loss: 0.6615 - acc: 0.8493
Epoch 6/28

16/16 [==============================] - 0s 26ms/step - loss: 0.5702 - acc: 0.8082
Epoch 7/28

16/16 [==============================] - 0s 26ms/step - loss: 0.5097 - acc: 0.8795
Epoch 8/28

16/16 [==============================] - 0s 26ms/step - loss: 0.4419 - acc: 0.8548
Epoch 9/28

16/16 [==============================] - 0s 27ms/step - loss: 0.4072 - acc: 0.8904
Epoch 10/28

16/16 [==============================] - 0s 26ms/step - loss: 0.3815 - acc: 0.8904
Epoch 11/28

16/16 [==============================] - 0s 26ms/step - loss: 0.3354 - acc: 0.9068
Epoch 12/28

16/16 [==============================] - 0s 25ms/step - loss: 0.3272 - acc: 0.9096
Epoch 13/28

16/16 [==============================] - 0s 26ms/step - loss: 0.3156 - acc: 0.9041
Epoch 14/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2785 - acc: 0.9260
Epoch 15/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2893 - acc: 0.9315
Epoch 16/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2551 - acc: 0.9562
Epoch 17/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2488 - acc: 0.9452
Epoch 18/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2492 - acc: 0.9507
Epoch 19/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2179 - acc: 0.9644
Epoch 20/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2109 - acc: 0.9644
Epoch 21/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2166 - acc: 0.9562
Epoch 22/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1841 - acc: 0.9699
Epoch 23/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1723 - acc: 0.9699
Epoch 24/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1687 - acc: 0.9753
Epoch 25/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1609 - acc: 0.9836
Epoch 26/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1568 - acc: 0.9808
Epoch 27/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1363 - acc: 0.9781
Epoch 28/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1249 - acc: 0.9890
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7186
False 1885
True percentage 0.792194906846
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.93      0.94      7318
     B-MISC       0.15      0.35      0.21       141
     I-MISC       0.17      0.03      0.05       154
      B-ORG       0.28      0.32      0.30       296
      B-LOC       0.75      0.07      0.13       218
      B-PER       0.68      0.32      0.44       438
      I-PER       0.68      0.13      0.22       214
      I-ORG       0.12      0.38      0.18       151
      I-LOC       0.00      0.00      0.00       141

avg / total       0.85      0.79      0.81      9071

F-1 Score (without O):
0.244236760125
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104046 unique words.
4042 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659008     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,138
Trainable params: 6,771,138
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 3s 185ms/step - loss: 2.7153 - acc: 0.0321
Epoch 2/28

16/16 [==============================] - 0s 28ms/step - loss: 0.9179 - acc: 0.7949
Epoch 3/28

16/16 [==============================] - 0s 27ms/step - loss: 0.6222 - acc: 0.8301
Epoch 4/28

16/16 [==============================] - 0s 27ms/step - loss: 0.5759 - acc: 0.8814
Epoch 5/28

16/16 [==============================] - 0s 26ms/step - loss: 0.7409 - acc: 0.8173
Epoch 6/28

16/16 [==============================] - 0s 26ms/step - loss: 0.5389 - acc: 0.8878
Epoch 7/28

16/16 [==============================] - 0s 27ms/step - loss: 0.4025 - acc: 0.8750
Epoch 8/28

16/16 [==============================] - 0s 26ms/step - loss: 0.3685 - acc: 0.8942
Epoch 9/28

16/16 [==============================] - 0s 26ms/step - loss: 0.3485 - acc: 0.9006
Epoch 10/28

16/16 [==============================] - 0s 26ms/step - loss: 0.3067 - acc: 0.9071
Epoch 11/28

16/16 [==============================] - 0s 26ms/step - loss: 0.3054 - acc: 0.9038
Epoch 12/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2742 - acc: 0.9359
Epoch 13/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2508 - acc: 0.9391
Epoch 14/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2420 - acc: 0.9455
Epoch 15/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2291 - acc: 0.9423
Epoch 16/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2027 - acc: 0.9583
Epoch 17/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2097 - acc: 0.9583
Epoch 18/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1740 - acc: 0.9808
Epoch 19/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1750 - acc: 0.9679
Epoch 20/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1655 - acc: 0.9776
Epoch 21/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1594 - acc: 0.9776
Epoch 22/28

16/16 [==============================] - 0s 25ms/step - loss: 0.1502 - acc: 0.9776
Epoch 23/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1367 - acc: 0.9776
Epoch 24/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1392 - acc: 0.9744
Epoch 25/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1235 - acc: 0.9840
Epoch 26/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1166 - acc: 0.9904
Epoch 27/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1147 - acc: 0.9840
Epoch 28/28

16/16 [==============================] - 0s 25ms/step - loss: 0.1027 - acc: 0.9872
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7194
False 1877
True percentage 0.793076838276
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.60      0.21      0.31       438
      I-PER       0.00      0.00      0.00       214
          O       0.95      0.93      0.94      7318
      B-ORG       0.26      0.41      0.32       296
      B-LOC       0.44      0.36      0.39       218
      I-ORG       0.12      0.34      0.18       151
      I-LOC       0.36      0.27      0.31       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.22      0.04      0.07       154

avg / total       0.83      0.79      0.80      9071

F-1 Score (without O):
0.836365777542
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 6 unique labels.
Found 104044 unique words.
4040 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658880     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 7)        966         bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,566
Trainable params: 6,770,566
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 3s 351ms/step - loss: 2.6114 - acc: 0.0442
Epoch 2/28

8/8 [==============================] - 0s 41ms/step - loss: 0.8588 - acc: 0.8564
Epoch 3/28

8/8 [==============================] - 0s 41ms/step - loss: 0.4450 - acc: 0.8785
Epoch 4/28

8/8 [==============================] - 0s 40ms/step - loss: 0.3432 - acc: 0.9061
Epoch 5/28

8/8 [==============================] - 0s 39ms/step - loss: 0.2595 - acc: 0.9061
Epoch 6/28

8/8 [==============================] - 0s 38ms/step - loss: 0.2240 - acc: 0.9613
Epoch 7/28

8/8 [==============================] - 0s 40ms/step - loss: 0.1733 - acc: 0.9503
Epoch 8/28

8/8 [==============================] - 0s 42ms/step - loss: 0.1451 - acc: 0.9834
Epoch 9/28

8/8 [==============================] - 0s 39ms/step - loss: 0.1149 - acc: 0.9669
Epoch 10/28

8/8 [==============================] - 0s 40ms/step - loss: 0.1082 - acc: 0.9834
Epoch 11/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0916 - acc: 0.9779
Epoch 12/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0762 - acc: 0.9834
Epoch 13/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0784 - acc: 0.9834
Epoch 14/28

8/8 [==============================] - 0s 41ms/step - loss: 0.0619 - acc: 0.9945
Epoch 15/28

8/8 [==============================] - 0s 41ms/step - loss: 0.0626 - acc: 0.9890
Epoch 16/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0717 - acc: 0.9890
Epoch 17/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0454 - acc: 0.9945
Epoch 18/28

8/8 [==============================] - 0s 37ms/step - loss: 0.0452 - acc: 1.0000
Epoch 19/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0457 - acc: 1.0000
Epoch 20/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0394 - acc: 0.9945
Epoch 21/28

8/8 [==============================] - 0s 37ms/step - loss: 0.0320 - acc: 0.9945
Epoch 22/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0325 - acc: 1.0000
Epoch 23/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0313 - acc: 1.0000
Epoch 24/28

8/8 [==============================] - 0s 41ms/step - loss: 0.0252 - acc: 1.0000
Epoch 25/28

8/8 [==============================] - 0s 37ms/step - loss: 0.0235 - acc: 1.0000
Epoch 26/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0286 - acc: 1.0000
Epoch 27/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0203 - acc: 1.0000
Epoch 28/28

8/8 [==============================] - 0s 37ms/step - loss: 0.0208 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7114
False 1521
True percentage 0.823856398379
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.92      0.93      7318
      B-PER       0.28      0.40      0.33       438
      B-ORG       0.27      0.31      0.29       296
      I-ORG       0.17      0.03      0.06       151
      I-PER       0.30      0.36      0.32       214
      B-LOC       0.00      0.00      0.00       218

avg / total       0.82      0.82      0.82      8635

F-1 Score (without O):
0.271489692727
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104041 unique words.
4037 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658688     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,818
Trainable params: 6,770,818
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 3s 347ms/step - loss: 2.2243 - acc: 0.0925
Epoch 2/28

8/8 [==============================] - 0s 40ms/step - loss: 0.8351 - acc: 0.8266
Epoch 3/28

8/8 [==============================] - 0s 41ms/step - loss: 0.6719 - acc: 0.8208
Epoch 4/28

8/8 [==============================] - 0s 39ms/step - loss: 0.5779 - acc: 0.8555
Epoch 5/28

8/8 [==============================] - 0s 38ms/step - loss: 0.4997 - acc: 0.8208
Epoch 6/28

8/8 [==============================] - 0s 40ms/step - loss: 0.4169 - acc: 0.9017
Epoch 7/28

8/8 [==============================] - 0s 38ms/step - loss: 0.3729 - acc: 0.8844
Epoch 8/28

8/8 [==============================] - 0s 40ms/step - loss: 0.3214 - acc: 0.9017
Epoch 9/28

8/8 [==============================] - 0s 39ms/step - loss: 0.3061 - acc: 0.8671
Epoch 10/28

8/8 [==============================] - 0s 38ms/step - loss: 0.3002 - acc: 0.9191
Epoch 11/28

8/8 [==============================] - 0s 37ms/step - loss: 0.2438 - acc: 0.9364
Epoch 12/28

8/8 [==============================] - 0s 36ms/step - loss: 0.2175 - acc: 0.9364
Epoch 13/28

8/8 [==============================] - 0s 38ms/step - loss: 0.1969 - acc: 0.9538
Epoch 14/28

8/8 [==============================] - 0s 38ms/step - loss: 0.1867 - acc: 0.9364
Epoch 15/28

8/8 [==============================] - 0s 38ms/step - loss: 0.1712 - acc: 0.9884
Epoch 16/28

8/8 [==============================] - 0s 38ms/step - loss: 0.1659 - acc: 0.9653
Epoch 17/28

8/8 [==============================] - 0s 38ms/step - loss: 0.1424 - acc: 0.9884
Epoch 18/28

8/8 [==============================] - 0s 39ms/step - loss: 0.1302 - acc: 0.9884
Epoch 19/28

8/8 [==============================] - 0s 39ms/step - loss: 0.1189 - acc: 0.9942
Epoch 20/28

8/8 [==============================] - 0s 37ms/step - loss: 0.1067 - acc: 1.0000
Epoch 21/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0956 - acc: 1.0000
Epoch 22/28

8/8 [==============================] - 0s 37ms/step - loss: 0.0889 - acc: 1.0000
Epoch 23/28

8/8 [==============================] - 0s 41ms/step - loss: 0.0936 - acc: 1.0000
Epoch 24/28

8/8 [==============================] - 0s 40ms/step - loss: 0.0829 - acc: 1.0000
Epoch 25/28

8/8 [==============================] - 0s 40ms/step - loss: 0.0876 - acc: 0.9884
Epoch 26/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0745 - acc: 1.0000
Epoch 27/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0680 - acc: 1.0000
Epoch 28/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0542 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7070
False 2001
True percentage 0.779406901113
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.92      0.93      0.92      7318
      B-PER       0.26      0.27      0.27       438
      B-ORG       0.26      0.29      0.27       296
      I-ORG       0.38      0.02      0.04       151
     B-MISC       0.23      0.05      0.08       141
     I-MISC       0.19      0.07      0.10       154
      I-PER       0.19      0.14      0.16       214
      B-LOC       0.64      0.06      0.12       218
      I-LOC       0.25      0.02      0.04       141

avg / total       0.80      0.78      0.78      9071

F-1 Score (without O):
0.193161790624
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104044 unique words.
4040 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 567
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658880     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,010
Trainable params: 6,771,010
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 3s 352ms/step - loss: 2.5793 - acc: 0.0331
Epoch 2/28

8/8 [==============================] - 0s 43ms/step - loss: 1.2756 - acc: 0.7459
Epoch 3/28

8/8 [==============================] - 0s 40ms/step - loss: 0.8617 - acc: 0.7403
Epoch 4/28

8/8 [==============================] - 0s 39ms/step - loss: 0.7203 - acc: 0.7845
Epoch 5/28

8/8 [==============================] - 0s 39ms/step - loss: 0.6370 - acc: 0.7680
Epoch 6/28

8/8 [==============================] - 0s 39ms/step - loss: 0.5324 - acc: 0.8343
Epoch 7/28

8/8 [==============================] - 0s 38ms/step - loss: 0.4641 - acc: 0.8840
Epoch 8/28

8/8 [==============================] - 0s 40ms/step - loss: 0.4279 - acc: 0.9116
Epoch 9/28

8/8 [==============================] - 0s 38ms/step - loss: 0.3397 - acc: 0.9116
Epoch 10/28

8/8 [==============================] - 0s 39ms/step - loss: 0.3054 - acc: 0.9392
Epoch 11/28

8/8 [==============================] - 0s 37ms/step - loss: 0.2928 - acc: 0.9503
Epoch 12/28

8/8 [==============================] - 0s 37ms/step - loss: 0.2503 - acc: 0.9503
Epoch 13/28

8/8 [==============================] - 0s 38ms/step - loss: 0.2637 - acc: 0.9448
Epoch 14/28

8/8 [==============================] - 0s 38ms/step - loss: 0.2547 - acc: 0.9392
Epoch 15/28

8/8 [==============================] - 0s 38ms/step - loss: 0.2105 - acc: 0.9558
Epoch 16/28

8/8 [==============================] - 0s 38ms/step - loss: 0.1833 - acc: 0.9724
Epoch 17/28

8/8 [==============================] - 0s 39ms/step - loss: 0.1459 - acc: 0.9945
Epoch 18/28

8/8 [==============================] - 0s 40ms/step - loss: 0.1455 - acc: 0.9890
Epoch 19/28

8/8 [==============================] - 0s 39ms/step - loss: 0.1286 - acc: 0.9890
Epoch 20/28

8/8 [==============================] - 0s 38ms/step - loss: 0.1108 - acc: 0.9945
Epoch 21/28

8/8 [==============================] - 0s 39ms/step - loss: 0.1253 - acc: 0.9890
Epoch 22/28

8/8 [==============================] - 0s 37ms/step - loss: 0.0964 - acc: 1.0000
Epoch 23/28

8/8 [==============================] - 0s 38ms/step - loss: 0.1042 - acc: 1.0000
Epoch 24/28

8/8 [==============================] - 0s 41ms/step - loss: 0.0796 - acc: 0.9890
Epoch 25/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0840 - acc: 1.0000
Epoch 26/28

8/8 [==============================] - 0s 40ms/step - loss: 0.0723 - acc: 0.9945
Epoch 27/28

8/8 [==============================] - 0s 37ms/step - loss: 0.0709 - acc: 0.9945
Epoch 28/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0740 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7261
False 1810
True percentage 0.800463014001
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.94      0.93      7318
      B-ORG       0.39      0.26      0.31       296
      B-PER       0.43      0.41      0.42       438
      I-PER       0.32      0.33      0.33       214
      B-LOC       0.31      0.30      0.30       218
      I-LOC       0.17      0.01      0.01       141
      I-ORG       0.12      0.04      0.06       151
     B-MISC       0.11      0.03      0.05       141
     I-MISC       0.28      0.05      0.08       154

avg / total       0.81      0.80      0.80      9071

F-1 Score (without O):
0.282586383852
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 8 unique labels.
Found 104049 unique words.
4045 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 500
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659200     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,180
Trainable params: 6,771,180
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 3s 357ms/step - loss: 1.5542 - acc: 0.5109
Epoch 2/28

8/8 [==============================] - 0s 41ms/step - loss: 0.7524 - acc: 0.8261
Epoch 3/28

8/8 [==============================] - 0s 39ms/step - loss: 0.5253 - acc: 0.8533
Epoch 4/28

8/8 [==============================] - 0s 40ms/step - loss: 0.4091 - acc: 0.8641
Epoch 5/28

8/8 [==============================] - 0s 39ms/step - loss: 0.3538 - acc: 0.8967
Epoch 6/28

8/8 [==============================] - 0s 39ms/step - loss: 0.3062 - acc: 0.8967
Epoch 7/28

8/8 [==============================] - 0s 39ms/step - loss: 0.2816 - acc: 0.9402
Epoch 8/28

8/8 [==============================] - 0s 38ms/step - loss: 0.2648 - acc: 0.9022
Epoch 9/28

8/8 [==============================] - 0s 39ms/step - loss: 0.2421 - acc: 0.9565
Epoch 10/28

8/8 [==============================] - 0s 38ms/step - loss: 0.1847 - acc: 0.9783
Epoch 11/28

8/8 [==============================] - 0s 38ms/step - loss: 0.1763 - acc: 0.9837
Epoch 12/28

8/8 [==============================] - 0s 37ms/step - loss: 0.1425 - acc: 0.9891
Epoch 13/28

8/8 [==============================] - 0s 39ms/step - loss: 0.1388 - acc: 0.9891
Epoch 14/28

8/8 [==============================] - 0s 39ms/step - loss: 0.1329 - acc: 0.9837
Epoch 15/28

8/8 [==============================] - 0s 38ms/step - loss: 0.1228 - acc: 0.9891
Epoch 16/28

8/8 [==============================] - 0s 37ms/step - loss: 0.1100 - acc: 0.9891
Epoch 17/28

8/8 [==============================] - 0s 40ms/step - loss: 0.0980 - acc: 0.9891
Epoch 18/28

8/8 [==============================] - 0s 40ms/step - loss: 0.0881 - acc: 1.0000
Epoch 19/28

8/8 [==============================] - 0s 40ms/step - loss: 0.0900 - acc: 0.9891
Epoch 20/28

8/8 [==============================] - 0s 37ms/step - loss: 0.0777 - acc: 1.0000
Epoch 21/28

8/8 [==============================] - 0s 40ms/step - loss: 0.0788 - acc: 0.9946
Epoch 22/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0706 - acc: 1.0000
Epoch 23/28

8/8 [==============================] - 0s 42ms/step - loss: 0.0561 - acc: 1.0000
Epoch 24/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0621 - acc: 1.0000
Epoch 25/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0522 - acc: 0.9946
Epoch 26/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0663 - acc: 1.0000
Epoch 27/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0488 - acc: 1.0000
Epoch 28/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0421 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7057
False 1873
True percentage 0.790257558791
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.93      0.94      7318
     B-MISC       0.09      0.13      0.10       141
     I-MISC       0.11      0.02      0.03       154
      B-ORG       0.19      0.33      0.24       296
      B-LOC       0.00      0.00      0.00       218
      B-PER       0.81      0.21      0.34       438
      I-PER       0.00      0.00      0.00       214
      I-ORG       0.12      0.48      0.19       151

avg / total       0.83      0.79      0.80      8930

F-1 Score (without O):
0.183166720413
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104039 unique words.
4035 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658560     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,690
Trainable params: 6,770,690
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 3s 360ms/step - loss: 2.1598 - acc: 0.2532
Epoch 2/28

8/8 [==============================] - 0s 41ms/step - loss: 0.8190 - acc: 0.8291
Epoch 3/28

8/8 [==============================] - 0s 41ms/step - loss: 0.5331 - acc: 0.8734
Epoch 4/28

8/8 [==============================] - 0s 39ms/step - loss: 0.4873 - acc: 0.8797
Epoch 5/28

8/8 [==============================] - 0s 38ms/step - loss: 0.4999 - acc: 0.8291
Epoch 6/28

8/8 [==============================] - 0s 38ms/step - loss: 0.4066 - acc: 0.9241
Epoch 7/28

8/8 [==============================] - 0s 38ms/step - loss: 0.3112 - acc: 0.9051
Epoch 8/28

8/8 [==============================] - 0s 37ms/step - loss: 0.2703 - acc: 0.9367
Epoch 9/28

8/8 [==============================] - 0s 38ms/step - loss: 0.2435 - acc: 0.9430
Epoch 10/28

8/8 [==============================] - 0s 38ms/step - loss: 0.2435 - acc: 0.9494
Epoch 11/28

8/8 [==============================] - 0s 39ms/step - loss: 0.1934 - acc: 0.9620
Epoch 12/28

8/8 [==============================] - 0s 39ms/step - loss: 0.1805 - acc: 0.9557
Epoch 13/28

8/8 [==============================] - 0s 37ms/step - loss: 0.1506 - acc: 0.9747
Epoch 14/28

8/8 [==============================] - 0s 38ms/step - loss: 0.1556 - acc: 0.9684
Epoch 15/28

8/8 [==============================] - 0s 38ms/step - loss: 0.1414 - acc: 0.9684
Epoch 16/28

8/8 [==============================] - 0s 40ms/step - loss: 0.1318 - acc: 0.9873
Epoch 17/28

8/8 [==============================] - 0s 39ms/step - loss: 0.1173 - acc: 0.9747
Epoch 18/28

8/8 [==============================] - 0s 39ms/step - loss: 0.1128 - acc: 0.9810
Epoch 19/28

8/8 [==============================] - 0s 37ms/step - loss: 0.1071 - acc: 0.9873
Epoch 20/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0910 - acc: 0.9937
Epoch 21/28

8/8 [==============================] - 0s 37ms/step - loss: 0.0814 - acc: 0.9873
Epoch 22/28

8/8 [==============================] - 0s 40ms/step - loss: 0.0782 - acc: 1.0000
Epoch 23/28

8/8 [==============================] - 0s 40ms/step - loss: 0.0697 - acc: 1.0000
Epoch 24/28

8/8 [==============================] - 0s 40ms/step - loss: 0.0674 - acc: 1.0000
Epoch 25/28

8/8 [==============================] - 0s 37ms/step - loss: 0.0631 - acc: 1.0000
Epoch 26/28

8/8 [==============================] - 0s 37ms/step - loss: 0.0606 - acc: 1.0000
Epoch 27/28

8/8 [==============================] - 0s 37ms/step - loss: 0.0519 - acc: 1.0000
Epoch 28/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0511 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7078
False 1993
True percentage 0.780288832543
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.43      0.12      0.19       438
      I-PER       0.00      0.00      0.00       214
          O       0.92      0.93      0.93      7318
      B-ORG       0.32      0.41      0.36       296
      B-LOC       0.38      0.04      0.07       218
      I-ORG       0.12      0.40      0.18       151
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.25      0.01      0.02       154

avg / total       0.79      0.78      0.77      9071

F-1 Score (without O):
0.825915691693
