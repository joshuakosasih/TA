Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.4183 - acc: 0.8729
Epoch 2/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.2470 - acc: 0.9253
Epoch 3/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.1966 - acc: 0.9423
Epoch 4/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.1636 - acc: 0.9521
Epoch 5/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.1404 - acc: 0.9604
Epoch 6/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.1252 - acc: 0.9639
Epoch 7/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.1123 - acc: 0.9673
Epoch 8/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.1001 - acc: 0.9718
Epoch 9/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0899 - acc: 0.9742
Epoch 10/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0831 - acc: 0.9772
Epoch 11/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0775 - acc: 0.9776
Epoch 12/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0701 - acc: 0.9805
Epoch 13/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0651 - acc: 0.9819
Epoch 14/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0630 - acc: 0.9819
Epoch 15/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0567 - acc: 0.9844
Epoch 16/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0530 - acc: 0.9850
Epoch 17/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0509 - acc: 0.9863
Epoch 18/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0473 - acc: 0.9865
Epoch 19/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0452 - acc: 0.9880
Epoch 20/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0439 - acc: 0.9876
Epoch 21/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0401 - acc: 0.9889
Epoch 22/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0391 - acc: 0.9888
Epoch 23/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0380 - acc: 0.9893
Epoch 24/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0365 - acc: 0.9897
Epoch 25/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0347 - acc: 0.9897
Epoch 26/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0346 - acc: 0.9899
Epoch 27/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0315 - acc: 0.9911
Epoch 28/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0299 - acc: 0.9918
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8228
False 843
True percentage 0.907066475582
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-LOC       0.75      0.72      0.74       218
      I-LOC       0.71      0.80      0.75       141
      B-PER       0.92      0.81      0.86       438
      B-ORG       0.76      0.71      0.73       296
      I-ORG       0.64      0.59      0.62       151
     B-MISC       0.45      0.38      0.41       141
     I-MISC       0.49      0.44      0.46       154
      I-PER       0.89      0.64      0.74       214

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.709194369572
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.4131 - acc: 0.8751
Epoch 2/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.2407 - acc: 0.9272
Epoch 3/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1896 - acc: 0.9436
Epoch 4/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.1594 - acc: 0.9527
Epoch 5/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.1376 - acc: 0.9595
Epoch 6/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1215 - acc: 0.9656
Epoch 7/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.1091 - acc: 0.9678
Epoch 8/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0970 - acc: 0.9722
Epoch 9/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0872 - acc: 0.9752
Epoch 10/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0800 - acc: 0.9771
Epoch 11/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0727 - acc: 0.9796
Epoch 12/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0671 - acc: 0.9806
Epoch 13/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0615 - acc: 0.9825
Epoch 14/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0587 - acc: 0.9837
Epoch 15/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0575 - acc: 0.9834
Epoch 16/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0510 - acc: 0.9852
Epoch 17/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0484 - acc: 0.9863
Epoch 18/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0448 - acc: 0.9873
Epoch 19/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0433 - acc: 0.9875
Epoch 20/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0412 - acc: 0.9884
Epoch 21/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0403 - acc: 0.9882
Epoch 22/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0382 - acc: 0.9889
Epoch 23/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0353 - acc: 0.9898
Epoch 24/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0346 - acc: 0.9900
Epoch 25/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0331 - acc: 0.9905
Epoch 26/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0310 - acc: 0.9913
Epoch 27/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0301 - acc: 0.9914
Epoch 28/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0294 - acc: 0.9913
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8216
False 855
True percentage 0.905743578437
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
      B-PER       0.91      0.83      0.87       438
      B-LOC       0.74      0.75      0.75       218
     B-MISC       0.37      0.33      0.35       141
     I-MISC       0.44      0.50      0.47       154
      B-ORG       0.76      0.71      0.73       296
      I-ORG       0.63      0.54      0.58       151
      I-LOC       0.71      0.77      0.74       141
      I-PER       0.92      0.64      0.75       214

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.702606635071
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.3826 - acc: 0.8815
Epoch 2/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.2342 - acc: 0.9289
Epoch 3/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1882 - acc: 0.9440
Epoch 4/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1582 - acc: 0.9528
Epoch 5/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1343 - acc: 0.9604
Epoch 6/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1201 - acc: 0.9635
Epoch 7/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1065 - acc: 0.9694
Epoch 8/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0959 - acc: 0.9730
Epoch 9/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0869 - acc: 0.9752
Epoch 10/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0804 - acc: 0.9768
Epoch 11/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0722 - acc: 0.9793
Epoch 12/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0677 - acc: 0.9807
Epoch 13/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0633 - acc: 0.9819
Epoch 14/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0583 - acc: 0.9832
Epoch 15/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0555 - acc: 0.9844
Epoch 16/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0505 - acc: 0.9854
Epoch 17/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0507 - acc: 0.9852
Epoch 18/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0476 - acc: 0.9862
Epoch 19/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0425 - acc: 0.9879
Epoch 20/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0406 - acc: 0.9882
Epoch 21/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0407 - acc: 0.9884
Epoch 22/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0377 - acc: 0.9894
Epoch 23/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0366 - acc: 0.9899
Epoch 24/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0337 - acc: 0.9905
Epoch 25/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0348 - acc: 0.9899
Epoch 26/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0322 - acc: 0.9909
Epoch 27/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0310 - acc: 0.9909
Epoch 28/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0304 - acc: 0.9910
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8233
False 838
True percentage 0.907617682725
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
      B-ORG       0.75      0.73      0.74       296
      I-ORG       0.62      0.59      0.60       151
      B-PER       0.90      0.83      0.87       438
      I-PER       0.90      0.65      0.76       214
      B-LOC       0.74      0.74      0.74       218
      I-LOC       0.74      0.79      0.76       141
     B-MISC       0.43      0.34      0.38       141
     I-MISC       0.48      0.47      0.47       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.712125704121
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.3952 - acc: 0.8774
Epoch 2/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.2415 - acc: 0.9253
Epoch 3/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1911 - acc: 0.9427
Epoch 4/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1600 - acc: 0.9520
Epoch 5/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1360 - acc: 0.9600
Epoch 6/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1190 - acc: 0.9648
Epoch 7/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1077 - acc: 0.9696
Epoch 8/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0940 - acc: 0.9732
Epoch 9/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0855 - acc: 0.9760
Epoch 10/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0776 - acc: 0.9793
Epoch 11/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0716 - acc: 0.9805
Epoch 12/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0679 - acc: 0.9801
Epoch 13/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0613 - acc: 0.9830
Epoch 14/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0577 - acc: 0.9840
Epoch 15/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0537 - acc: 0.9848
Epoch 16/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0499 - acc: 0.9858
Epoch 17/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0461 - acc: 0.9873
Epoch 18/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0443 - acc: 0.9879
Epoch 19/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0421 - acc: 0.9887
Epoch 20/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0394 - acc: 0.9897
Epoch 21/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0375 - acc: 0.9895
Epoch 22/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0364 - acc: 0.9897
Epoch 23/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0340 - acc: 0.9911
Epoch 24/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0331 - acc: 0.9908
Epoch 25/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0323 - acc: 0.9913
Epoch 26/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0297 - acc: 0.9913
Epoch 27/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0289 - acc: 0.9918
Epoch 28/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0289 - acc: 0.9917
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8251
False 820
True percentage 0.909602028442
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.74      0.72      0.73       296
          O       0.99      0.96      0.97      7318
     B-MISC       0.44      0.35      0.39       141
     I-MISC       0.51      0.48      0.50       154
      B-LOC       0.76      0.72      0.74       218
      I-LOC       0.72      0.79      0.76       141
      B-PER       0.91      0.83      0.87       438
      I-PER       0.91      0.66      0.77       214
      I-ORG       0.64      0.64      0.64       151

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.932158181607
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.3856 - acc: 0.8837
Epoch 2/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.2302 - acc: 0.9301
Epoch 3/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.1861 - acc: 0.9430
Epoch 4/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.1557 - acc: 0.9535
Epoch 5/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.1323 - acc: 0.9611
Epoch 6/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.1162 - acc: 0.9653
Epoch 7/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.1032 - acc: 0.9697
Epoch 8/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0928 - acc: 0.9737
Epoch 9/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0822 - acc: 0.9765
Epoch 10/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0757 - acc: 0.9781
Epoch 11/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0683 - acc: 0.9811
Epoch 12/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0651 - acc: 0.9817
Epoch 13/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0608 - acc: 0.9830
Epoch 14/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0542 - acc: 0.9851
Epoch 15/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0517 - acc: 0.9854
Epoch 16/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0489 - acc: 0.9861
Epoch 17/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0462 - acc: 0.9864
Epoch 18/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0439 - acc: 0.9875
Epoch 19/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0407 - acc: 0.9887
Epoch 20/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0396 - acc: 0.9888
Epoch 21/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0375 - acc: 0.9895
Epoch 22/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0364 - acc: 0.9895
Epoch 23/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0348 - acc: 0.9900
Epoch 24/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0342 - acc: 0.9906
Epoch 25/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0331 - acc: 0.9901
Epoch 26/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0306 - acc: 0.9913
Epoch 27/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0296 - acc: 0.9917
Epoch 28/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0283 - acc: 0.9917
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8265
False 806
True percentage 0.911145408444
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.92      0.85      0.88       438
      B-ORG       0.73      0.73      0.73       296
     B-MISC       0.44      0.30      0.36       141
      I-PER       0.96      0.67      0.79       214
      I-ORG       0.69      0.62      0.65       151
     I-MISC       0.55      0.47      0.51       154
      B-LOC       0.73      0.75      0.74       218
      I-LOC       0.75      0.79      0.77       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.727872787279
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104754 unique words.
4750 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 246
OOV word occurences: in test 365
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6704320     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,816,450
Trainable params: 6,816,450
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 25s 29ms/step - loss: 0.5136 - acc: 0.8456
Epoch 2/28

837/837 [==============================] - 23s 28ms/step - loss: 0.3040 - acc: 0.9088
Epoch 3/28

837/837 [==============================] - 23s 28ms/step - loss: 0.2393 - acc: 0.9283
Epoch 4/28

837/837 [==============================] - 23s 28ms/step - loss: 0.2054 - acc: 0.9411
Epoch 5/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1730 - acc: 0.9498
Epoch 6/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1598 - acc: 0.9529
Epoch 7/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1370 - acc: 0.9622
Epoch 8/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1226 - acc: 0.9664
Epoch 9/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1131 - acc: 0.9687
Epoch 10/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1035 - acc: 0.9715
Epoch 11/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0916 - acc: 0.9753
Epoch 12/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0872 - acc: 0.9770
Epoch 13/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0793 - acc: 0.9782
Epoch 14/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0751 - acc: 0.9795
Epoch 15/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0711 - acc: 0.9803
Epoch 16/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0630 - acc: 0.9841
Epoch 17/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0589 - acc: 0.9847
Epoch 18/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0582 - acc: 0.9844
Epoch 19/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0538 - acc: 0.9850
Epoch 20/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0479 - acc: 0.9869
Epoch 21/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0475 - acc: 0.9872
Epoch 22/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0446 - acc: 0.9890
Epoch 23/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0416 - acc: 0.9896
Epoch 24/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0405 - acc: 0.9894
Epoch 25/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0367 - acc: 0.9906
Epoch 26/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0366 - acc: 0.9910
Epoch 27/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0345 - acc: 0.9908
Epoch 28/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0338 - acc: 0.9901
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8162
False 909
True percentage 0.899790541285
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-LOC       0.73      0.74      0.73       218
      I-LOC       0.77      0.81      0.79       141
      B-PER       0.88      0.78      0.83       438
      B-ORG       0.71      0.70      0.71       296
      I-ORG       0.60      0.55      0.57       151
     B-MISC       0.55      0.29      0.38       141
     I-MISC       0.46      0.36      0.40       154
      I-PER       0.88      0.60      0.72       214

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.690033526364
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104723 unique words.
4719 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 247
OOV word occurences: in test 373
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6702336     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,814,466
Trainable params: 6,814,466
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 24s 29ms/step - loss: 0.4510 - acc: 0.8588
Epoch 2/28

837/837 [==============================] - 23s 27ms/step - loss: 0.2730 - acc: 0.9186
Epoch 3/28

837/837 [==============================] - 22s 27ms/step - loss: 0.2205 - acc: 0.9320
Epoch 4/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1859 - acc: 0.9452
Epoch 5/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1593 - acc: 0.9530
Epoch 6/28

837/837 [==============================] - 22s 27ms/step - loss: 0.1378 - acc: 0.9601
Epoch 7/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1257 - acc: 0.9643
Epoch 8/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1115 - acc: 0.9689
Epoch 9/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0990 - acc: 0.9715
Epoch 10/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0894 - acc: 0.9753
Epoch 11/28

837/837 [==============================] - 22s 27ms/step - loss: 0.0825 - acc: 0.9766
Epoch 12/28

837/837 [==============================] - 22s 27ms/step - loss: 0.0762 - acc: 0.9782
Epoch 13/28

837/837 [==============================] - 22s 27ms/step - loss: 0.0693 - acc: 0.9803
Epoch 14/28

837/837 [==============================] - 22s 27ms/step - loss: 0.0651 - acc: 0.9822
Epoch 15/28

837/837 [==============================] - 22s 27ms/step - loss: 0.0608 - acc: 0.9833
Epoch 16/28

837/837 [==============================] - 22s 27ms/step - loss: 0.0545 - acc: 0.9848
Epoch 17/28

837/837 [==============================] - 22s 27ms/step - loss: 0.0523 - acc: 0.9861
Epoch 18/28

837/837 [==============================] - 22s 27ms/step - loss: 0.0493 - acc: 0.9869
Epoch 19/28

837/837 [==============================] - 22s 27ms/step - loss: 0.0462 - acc: 0.9870
Epoch 20/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0431 - acc: 0.9879
Epoch 21/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0425 - acc: 0.9885
Epoch 22/28

837/837 [==============================] - 22s 27ms/step - loss: 0.0378 - acc: 0.9896
Epoch 23/28

837/837 [==============================] - 22s 27ms/step - loss: 0.0366 - acc: 0.9906
Epoch 24/28

837/837 [==============================] - 22s 27ms/step - loss: 0.0355 - acc: 0.9905
Epoch 25/28

837/837 [==============================] - 22s 27ms/step - loss: 0.0320 - acc: 0.9918
Epoch 26/28

837/837 [==============================] - 22s 27ms/step - loss: 0.0290 - acc: 0.9932
Epoch 27/28

837/837 [==============================] - 22s 27ms/step - loss: 0.0308 - acc: 0.9920
Epoch 28/28

837/837 [==============================] - 22s 27ms/step - loss: 0.0279 - acc: 0.9928
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8152
False 919
True percentage 0.898688126998
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.88      0.75      0.81       438
      B-LOC       0.74      0.69      0.71       218
     B-MISC       0.40      0.33      0.36       141
     I-MISC       0.47      0.49      0.48       154
      B-ORG       0.72      0.74      0.73       296
      I-ORG       0.62      0.55      0.58       151
      I-LOC       0.84      0.73      0.78       141
      I-PER       0.92      0.61      0.73       214

avg / total       0.94      0.90      0.92      9071

F-1 Score (without O):
0.686874810549
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104674 unique words.
4670 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 246
OOV word occurences: in test 375
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6699200     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,811,330
Trainable params: 6,811,330
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 24s 28ms/step - loss: 0.5142 - acc: 0.8444
Epoch 2/28

837/837 [==============================] - 22s 27ms/step - loss: 0.3037 - acc: 0.9091
Epoch 3/28

837/837 [==============================] - 22s 26ms/step - loss: 0.2483 - acc: 0.9259
Epoch 4/28

837/837 [==============================] - 22s 26ms/step - loss: 0.2096 - acc: 0.9369
Epoch 5/28

837/837 [==============================] - 22s 26ms/step - loss: 0.1813 - acc: 0.9487
Epoch 6/28

837/837 [==============================] - 22s 26ms/step - loss: 0.1567 - acc: 0.9564
Epoch 7/28

837/837 [==============================] - 22s 26ms/step - loss: 0.1416 - acc: 0.9594
Epoch 8/28

837/837 [==============================] - 22s 26ms/step - loss: 0.1276 - acc: 0.9640
Epoch 9/28

837/837 [==============================] - 22s 26ms/step - loss: 0.1157 - acc: 0.9679
Epoch 10/28

837/837 [==============================] - 22s 26ms/step - loss: 0.1031 - acc: 0.9717
Epoch 11/28

837/837 [==============================] - 22s 26ms/step - loss: 0.0945 - acc: 0.9743
Epoch 12/28

837/837 [==============================] - 22s 26ms/step - loss: 0.0890 - acc: 0.9752
Epoch 13/28

837/837 [==============================] - 22s 26ms/step - loss: 0.0790 - acc: 0.9785
Epoch 14/28

837/837 [==============================] - 22s 26ms/step - loss: 0.0745 - acc: 0.9805
Epoch 15/28

837/837 [==============================] - 22s 26ms/step - loss: 0.0703 - acc: 0.9809
Epoch 16/28

837/837 [==============================] - 22s 26ms/step - loss: 0.0646 - acc: 0.9831
Epoch 17/28

837/837 [==============================] - 22s 26ms/step - loss: 0.0614 - acc: 0.9831
Epoch 18/28

837/837 [==============================] - 22s 26ms/step - loss: 0.0554 - acc: 0.9852
Epoch 19/28

837/837 [==============================] - 22s 26ms/step - loss: 0.0529 - acc: 0.9866
Epoch 20/28

837/837 [==============================] - 22s 26ms/step - loss: 0.0482 - acc: 0.9876
Epoch 21/28

837/837 [==============================] - 22s 27ms/step - loss: 0.0476 - acc: 0.9870
Epoch 22/28

837/837 [==============================] - 22s 26ms/step - loss: 0.0471 - acc: 0.9876
Epoch 23/28

837/837 [==============================] - 22s 26ms/step - loss: 0.0453 - acc: 0.9879
Epoch 24/28

837/837 [==============================] - 22s 26ms/step - loss: 0.0388 - acc: 0.9902
Epoch 25/28

837/837 [==============================] - 22s 26ms/step - loss: 0.0391 - acc: 0.9905
Epoch 26/28

837/837 [==============================] - 22s 26ms/step - loss: 0.0363 - acc: 0.9912
Epoch 27/28

837/837 [==============================] - 22s 27ms/step - loss: 0.0358 - acc: 0.9905
Epoch 28/28

837/837 [==============================] - 22s 27ms/step - loss: 0.0324 - acc: 0.9917
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8123
False 948
True percentage 0.895491125565
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
      B-ORG       0.70      0.72      0.71       296
      I-ORG       0.53      0.52      0.52       151
      B-PER       0.86      0.75      0.80       438
      I-PER       0.89      0.64      0.74       214
      B-LOC       0.69      0.72      0.71       218
      I-LOC       0.65      0.75      0.70       141
     B-MISC       0.43      0.32      0.37       141
     I-MISC       0.51      0.37      0.43       154

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.670647954613
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104740 unique words.
4736 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 245
OOV word occurences: in test 354
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6703424     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,815,554
Trainable params: 6,815,554
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 24s 29ms/step - loss: 0.5109 - acc: 0.8454
Epoch 2/28

837/837 [==============================] - 23s 27ms/step - loss: 0.3039 - acc: 0.9088
Epoch 3/28

837/837 [==============================] - 23s 27ms/step - loss: 0.2433 - acc: 0.9285
Epoch 4/28

837/837 [==============================] - 23s 27ms/step - loss: 0.2020 - acc: 0.9422
Epoch 5/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1742 - acc: 0.9497
Epoch 6/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1517 - acc: 0.9564
Epoch 7/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1393 - acc: 0.9603
Epoch 8/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1232 - acc: 0.9673
Epoch 9/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1105 - acc: 0.9704
Epoch 10/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1011 - acc: 0.9718
Epoch 11/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0878 - acc: 0.9777
Epoch 12/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0825 - acc: 0.9795
Epoch 13/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0773 - acc: 0.9806
Epoch 14/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0704 - acc: 0.9818
Epoch 15/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0644 - acc: 0.9834
Epoch 16/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0608 - acc: 0.9845
Epoch 17/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0555 - acc: 0.9857
Epoch 18/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0556 - acc: 0.9863
Epoch 19/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0503 - acc: 0.9873
Epoch 20/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0454 - acc: 0.9890
Epoch 21/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0457 - acc: 0.9889
Epoch 22/28

837/837 [==============================] - 22s 27ms/step - loss: 0.0398 - acc: 0.9895
Epoch 23/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0396 - acc: 0.9899
Epoch 24/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0387 - acc: 0.9900
Epoch 25/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0357 - acc: 0.9897
Epoch 26/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0338 - acc: 0.9914
Epoch 27/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0324 - acc: 0.9920
Epoch 28/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0318 - acc: 0.9921
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8160
False 911
True percentage 0.899570058428
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.74      0.69      0.71       296
          O       0.98      0.96      0.97      7318
     B-MISC       0.45      0.32      0.37       141
     I-MISC       0.45      0.47      0.46       154
      B-LOC       0.68      0.72      0.70       218
      I-LOC       0.72      0.77      0.74       141
      B-PER       0.89      0.80      0.84       438
      I-PER       0.89      0.62      0.73       214
      I-ORG       0.63      0.43      0.51       151

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.924247705356
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104701 unique words.
4697 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 246
OOV word occurences: in test 382
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6700928     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,813,058
Trainable params: 6,813,058
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 25s 30ms/step - loss: 0.5269 - acc: 0.8355
Epoch 2/28

837/837 [==============================] - 24s 28ms/step - loss: 0.3232 - acc: 0.9038
Epoch 3/28

837/837 [==============================] - 23s 28ms/step - loss: 0.2615 - acc: 0.9216
Epoch 4/28

837/837 [==============================] - 23s 28ms/step - loss: 0.2230 - acc: 0.9348
Epoch 5/28

837/837 [==============================] - 24s 28ms/step - loss: 0.1929 - acc: 0.9446
Epoch 6/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1719 - acc: 0.9529
Epoch 7/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1487 - acc: 0.9595
Epoch 8/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1315 - acc: 0.9637
Epoch 9/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1223 - acc: 0.9665
Epoch 10/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1089 - acc: 0.9720
Epoch 11/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1006 - acc: 0.9724
Epoch 12/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0921 - acc: 0.9757
Epoch 13/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0842 - acc: 0.9765
Epoch 14/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0780 - acc: 0.9805
Epoch 15/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0715 - acc: 0.9816
Epoch 16/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0672 - acc: 0.9826
Epoch 17/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0637 - acc: 0.9838
Epoch 18/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0574 - acc: 0.9858
Epoch 19/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0564 - acc: 0.9847
Epoch 20/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0536 - acc: 0.9868
Epoch 21/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0500 - acc: 0.9871
Epoch 22/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0469 - acc: 0.9881
Epoch 23/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0433 - acc: 0.9891
Epoch 24/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0428 - acc: 0.9894
Epoch 25/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0403 - acc: 0.9897
Epoch 26/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0382 - acc: 0.9901
Epoch 27/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0382 - acc: 0.9899
Epoch 28/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0357 - acc: 0.9912
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8097
False 974
True percentage 0.892624848418
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.87      0.74      0.80       438
      B-ORG       0.69      0.71      0.70       296
     B-MISC       0.36      0.21      0.27       141
      I-PER       0.80      0.64      0.71       214
      I-ORG       0.51      0.58      0.54       151
     I-MISC       0.54      0.38      0.44       154
      B-LOC       0.71      0.72      0.72       218
      I-LOC       0.70      0.72      0.71       141

avg / total       0.93      0.89      0.91      9071

F-1 Score (without O):
0.664262097986
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104344 unique words.
4340 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 264
OOV word occurences: in test 412
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678080     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,210
Trainable params: 6,790,210
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 11s 32ms/step - loss: 0.7584 - acc: 0.7796
Epoch 2/28

334/334 [==============================] - 9s 27ms/step - loss: 0.4267 - acc: 0.8691
Epoch 3/28

334/334 [==============================] - 9s 27ms/step - loss: 0.3487 - acc: 0.8980
Epoch 4/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2986 - acc: 0.9136
Epoch 5/28

334/334 [==============================] - 9s 27ms/step - loss: 0.2604 - acc: 0.9258
Epoch 6/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2333 - acc: 0.9352
Epoch 7/28

334/334 [==============================] - 9s 27ms/step - loss: 0.2093 - acc: 0.9422
Epoch 8/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1859 - acc: 0.9476
Epoch 9/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1669 - acc: 0.9565
Epoch 10/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1543 - acc: 0.9585
Epoch 11/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1395 - acc: 0.9652
Epoch 12/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1254 - acc: 0.9690
Epoch 13/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1157 - acc: 0.9717
Epoch 14/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1066 - acc: 0.9753
Epoch 15/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0999 - acc: 0.9763
Epoch 16/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0949 - acc: 0.9766
Epoch 17/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0823 - acc: 0.9817
Epoch 18/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0791 - acc: 0.9816
Epoch 19/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0741 - acc: 0.9818
Epoch 20/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0653 - acc: 0.9857
Epoch 21/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0643 - acc: 0.9843
Epoch 22/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0599 - acc: 0.9867
Epoch 23/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0567 - acc: 0.9863
Epoch 24/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0492 - acc: 0.9903
Epoch 25/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0502 - acc: 0.9890
Epoch 26/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0464 - acc: 0.9902
Epoch 27/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0447 - acc: 0.9906
Epoch 28/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0429 - acc: 0.9904
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8000
False 1071
True percentage 0.881931429831
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-LOC       0.70      0.70      0.70       218
      I-LOC       0.73      0.67      0.70       141
      B-PER       0.88      0.68      0.77       438
      B-ORG       0.63      0.71      0.67       296
      I-ORG       0.48      0.52      0.50       151
     B-MISC       0.45      0.25      0.32       141
     I-MISC       0.43      0.42      0.43       154
      I-PER       0.83      0.50      0.63       214

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.632250227756
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104341 unique words.
4337 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 260
OOV word occurences: in test 400
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6677888     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,018
Trainable params: 6,790,018
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 11s 33ms/step - loss: 0.6690 - acc: 0.7976
Epoch 2/28

334/334 [==============================] - 9s 28ms/step - loss: 0.3781 - acc: 0.8824
Epoch 3/28

334/334 [==============================] - 9s 27ms/step - loss: 0.3111 - acc: 0.9087
Epoch 4/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2712 - acc: 0.9232
Epoch 5/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2285 - acc: 0.9336
Epoch 6/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2009 - acc: 0.9445
Epoch 7/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1799 - acc: 0.9508
Epoch 8/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1637 - acc: 0.9548
Epoch 9/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1523 - acc: 0.9585
Epoch 10/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1324 - acc: 0.9650
Epoch 11/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1225 - acc: 0.9695
Epoch 12/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1119 - acc: 0.9704
Epoch 13/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1011 - acc: 0.9757
Epoch 14/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0943 - acc: 0.9774
Epoch 15/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0916 - acc: 0.9770
Epoch 16/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0796 - acc: 0.9796
Epoch 17/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0737 - acc: 0.9820
Epoch 18/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0703 - acc: 0.9819
Epoch 19/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0645 - acc: 0.9849
Epoch 20/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0573 - acc: 0.9877
Epoch 21/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0564 - acc: 0.9863
Epoch 22/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0528 - acc: 0.9885
Epoch 23/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0499 - acc: 0.9896
Epoch 24/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0458 - acc: 0.9897
Epoch 25/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0462 - acc: 0.9898
Epoch 26/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0411 - acc: 0.9916
Epoch 27/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0393 - acc: 0.9919
Epoch 28/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0398 - acc: 0.9921
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8059
False 1012
True percentage 0.888435674126
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.84      0.74      0.79       438
      B-LOC       0.79      0.64      0.71       218
     B-MISC       0.39      0.37      0.38       141
     I-MISC       0.39      0.46      0.42       154
      B-ORG       0.73      0.66      0.69       296
      I-ORG       0.54      0.44      0.49       151
      I-LOC       0.78      0.62      0.69       141
      I-PER       0.91      0.61      0.73       214

avg / total       0.93      0.89      0.91      9071

F-1 Score (without O):
0.650580329872
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104352 unique words.
4348 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 259
OOV word occurences: in test 420
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678592     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,722
Trainable params: 6,790,722
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 11s 33ms/step - loss: 0.6636 - acc: 0.7984
Epoch 2/28

334/334 [==============================] - 9s 28ms/step - loss: 0.3583 - acc: 0.8916
Epoch 3/28

334/334 [==============================] - 9s 27ms/step - loss: 0.2901 - acc: 0.9142
Epoch 4/28

334/334 [==============================] - 9s 27ms/step - loss: 0.2519 - acc: 0.9265
Epoch 5/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2166 - acc: 0.9375
Epoch 6/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1940 - acc: 0.9443
Epoch 7/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1734 - acc: 0.9513
Epoch 8/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1571 - acc: 0.9563
Epoch 9/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1419 - acc: 0.9612
Epoch 10/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1244 - acc: 0.9693
Epoch 11/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1156 - acc: 0.9696
Epoch 12/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1068 - acc: 0.9748
Epoch 13/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0965 - acc: 0.9761
Epoch 14/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0905 - acc: 0.9796
Epoch 15/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0829 - acc: 0.9817
Epoch 16/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0746 - acc: 0.9836
Epoch 17/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0694 - acc: 0.9838
Epoch 18/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0623 - acc: 0.9867
Epoch 19/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0596 - acc: 0.9870
Epoch 20/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0548 - acc: 0.9865
Epoch 21/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0502 - acc: 0.9903
Epoch 22/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0460 - acc: 0.9905
Epoch 23/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0446 - acc: 0.9912
Epoch 24/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0420 - acc: 0.9907
Epoch 25/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0409 - acc: 0.9911
Epoch 26/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0358 - acc: 0.9925
Epoch 27/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0344 - acc: 0.9942
Epoch 28/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0335 - acc: 0.9917
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7960
False 1111
True percentage 0.877521772682
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.97      7318
      B-ORG       0.61      0.64      0.63       296
      I-ORG       0.37      0.48      0.42       151
      B-PER       0.86      0.68      0.76       438
      I-PER       0.88      0.57      0.69       214
      B-LOC       0.71      0.64      0.67       218
      I-LOC       0.69      0.70      0.69       141
     B-MISC       0.33      0.20      0.25       141
     I-MISC       0.35      0.21      0.26       154

avg / total       0.92      0.88      0.89      9071

F-1 Score (without O):
0.601715686275
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104323 unique words.
4319 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 265
OOV word occurences: in test 448
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6676736     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,788,866
Trainable params: 6,788,866
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 11s 33ms/step - loss: 0.6410 - acc: 0.8093
Epoch 2/28

334/334 [==============================] - 9s 27ms/step - loss: 0.3577 - acc: 0.8912
Epoch 3/28

334/334 [==============================] - 9s 27ms/step - loss: 0.2901 - acc: 0.9147
Epoch 4/28

334/334 [==============================] - 9s 27ms/step - loss: 0.2510 - acc: 0.9279
Epoch 5/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2231 - acc: 0.9367
Epoch 6/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1969 - acc: 0.9461
Epoch 7/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1727 - acc: 0.9526
Epoch 8/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1561 - acc: 0.9560
Epoch 9/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1418 - acc: 0.9616
Epoch 10/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1276 - acc: 0.9669
Epoch 11/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1208 - acc: 0.9698
Epoch 12/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1073 - acc: 0.9714
Epoch 13/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1000 - acc: 0.9776
Epoch 14/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0896 - acc: 0.9795
Epoch 15/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0845 - acc: 0.9796
Epoch 16/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0772 - acc: 0.9814
Epoch 17/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0697 - acc: 0.9836
Epoch 18/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0639 - acc: 0.9857
Epoch 19/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0606 - acc: 0.9869
Epoch 20/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0597 - acc: 0.9869
Epoch 21/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0533 - acc: 0.9883
Epoch 22/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0484 - acc: 0.9887
Epoch 23/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0467 - acc: 0.9899
Epoch 24/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0441 - acc: 0.9898
Epoch 25/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0396 - acc: 0.9913
Epoch 26/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0374 - acc: 0.9921
Epoch 27/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0358 - acc: 0.9928
Epoch 28/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0326 - acc: 0.9933
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7978
False 1093
True percentage 0.879506118399
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.69      0.58      0.63       296
          O       0.97      0.96      0.96      7318
     B-MISC       0.33      0.21      0.26       141
     I-MISC       0.45      0.32      0.37       154
      B-LOC       0.69      0.65      0.67       218
      I-LOC       0.79      0.67      0.73       141
      B-PER       0.80      0.66      0.72       438
      I-PER       0.86      0.58      0.69       214
      I-ORG       0.59      0.41      0.48       151

avg / total       0.91      0.88      0.90      9071

F-1 Score (without O):
0.910384234155
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104315 unique words.
4311 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 264
OOV word occurences: in test 444
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6676224     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,788,354
Trainable params: 6,788,354
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 11s 32ms/step - loss: 0.6404 - acc: 0.8020
Epoch 2/28

334/334 [==============================] - 9s 28ms/step - loss: 0.3626 - acc: 0.8860
Epoch 3/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2967 - acc: 0.9132
Epoch 4/28

334/334 [==============================] - 9s 27ms/step - loss: 0.2473 - acc: 0.9265
Epoch 5/28

334/334 [==============================] - 9s 27ms/step - loss: 0.2228 - acc: 0.9332
Epoch 6/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1962 - acc: 0.9404
Epoch 7/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1783 - acc: 0.9502
Epoch 8/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1609 - acc: 0.9545
Epoch 9/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1419 - acc: 0.9609
Epoch 10/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1302 - acc: 0.9664
Epoch 11/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1186 - acc: 0.9700
Epoch 12/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1100 - acc: 0.9704
Epoch 13/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1037 - acc: 0.9721
Epoch 14/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0924 - acc: 0.9770
Epoch 15/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0880 - acc: 0.9794
Epoch 16/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0814 - acc: 0.9812
Epoch 17/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0711 - acc: 0.9835
Epoch 18/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0680 - acc: 0.9838
Epoch 19/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0618 - acc: 0.9870
Epoch 20/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0585 - acc: 0.9858
Epoch 21/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0567 - acc: 0.9867
Epoch 22/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0570 - acc: 0.9850
Epoch 23/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0516 - acc: 0.9875
Epoch 24/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0484 - acc: 0.9886
Epoch 25/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0443 - acc: 0.9896
Epoch 26/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0418 - acc: 0.9898
Epoch 27/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0401 - acc: 0.9911
Epoch 28/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0382 - acc: 0.9915
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7919
False 1152
True percentage 0.873001874104
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-PER       0.85      0.64      0.73       438
      B-ORG       0.57      0.56      0.56       296
     B-MISC       0.41      0.35      0.38       141
      I-PER       0.86      0.58      0.69       214
      I-ORG       0.39      0.39      0.39       151
     I-MISC       0.41      0.52      0.46       154
      B-LOC       0.75      0.68      0.71       218
      I-LOC       0.77      0.70      0.73       141

avg / total       0.92      0.87      0.89      9071

F-1 Score (without O):
0.605676328502
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104210 unique words.
4206 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 272
OOV word occurences: in test 488
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6669504     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,781,634
Trainable params: 6,781,634
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 6s 38ms/step - loss: 0.8510 - acc: 0.7396
Epoch 2/28

167/167 [==============================] - 5s 27ms/step - loss: 0.4709 - acc: 0.8506
Epoch 3/28

167/167 [==============================] - 5s 28ms/step - loss: 0.3923 - acc: 0.8773
Epoch 4/28

167/167 [==============================] - 5s 27ms/step - loss: 0.3469 - acc: 0.8973
Epoch 5/28

167/167 [==============================] - 5s 28ms/step - loss: 0.3088 - acc: 0.9083
Epoch 6/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2772 - acc: 0.9180
Epoch 7/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2529 - acc: 0.9310
Epoch 8/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2307 - acc: 0.9370
Epoch 9/28

167/167 [==============================] - 5s 27ms/step - loss: 0.2077 - acc: 0.9441
Epoch 10/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1948 - acc: 0.9498
Epoch 11/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1763 - acc: 0.9536
Epoch 12/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1662 - acc: 0.9552
Epoch 13/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1507 - acc: 0.9629
Epoch 14/28

167/167 [==============================] - 5s 27ms/step - loss: 0.1462 - acc: 0.9663
Epoch 15/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1270 - acc: 0.9703
Epoch 16/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1209 - acc: 0.9732
Epoch 17/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1132 - acc: 0.9740
Epoch 18/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1023 - acc: 0.9766
Epoch 19/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0918 - acc: 0.9814
Epoch 20/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0868 - acc: 0.9845
Epoch 21/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0781 - acc: 0.9858
Epoch 22/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0725 - acc: 0.9863
Epoch 23/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0681 - acc: 0.9876
Epoch 24/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0648 - acc: 0.9879
Epoch 25/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0583 - acc: 0.9918
Epoch 26/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0569 - acc: 0.9903
Epoch 27/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0572 - acc: 0.9897
Epoch 28/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0516 - acc: 0.9927
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7746
False 1325
True percentage 0.853930106934
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.94      0.96      7318
      B-LOC       0.64      0.60      0.62       218
      I-LOC       0.71      0.46      0.56       141
      B-PER       0.78      0.53      0.63       438
      B-ORG       0.57      0.64      0.60       296
      I-ORG       0.34      0.39      0.36       151
     B-MISC       0.31      0.21      0.25       141
     I-MISC       0.34      0.38      0.36       154
      I-PER       0.61      0.43      0.51       214

avg / total       0.90      0.85      0.87      9071

F-1 Score (without O):
0.523284313725
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104194 unique words.
4190 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 269
OOV word occurences: in test 437
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6668480     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,780,610
Trainable params: 6,780,610
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 6s 38ms/step - loss: 0.9738 - acc: 0.7337
Epoch 2/28

167/167 [==============================] - 5s 27ms/step - loss: 0.4333 - acc: 0.8695
Epoch 3/28

167/167 [==============================] - 5s 27ms/step - loss: 0.3555 - acc: 0.8945
Epoch 4/28

167/167 [==============================] - 5s 28ms/step - loss: 0.3168 - acc: 0.9043
Epoch 5/28

167/167 [==============================] - 4s 27ms/step - loss: 0.2920 - acc: 0.9166
Epoch 6/28

167/167 [==============================] - 5s 27ms/step - loss: 0.2586 - acc: 0.9246
Epoch 7/28

167/167 [==============================] - 5s 27ms/step - loss: 0.2387 - acc: 0.9340
Epoch 8/28

167/167 [==============================] - 5s 27ms/step - loss: 0.2141 - acc: 0.9408
Epoch 9/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1913 - acc: 0.9435
Epoch 10/28

167/167 [==============================] - 4s 27ms/step - loss: 0.1714 - acc: 0.9558
Epoch 11/28

167/167 [==============================] - 4s 27ms/step - loss: 0.1609 - acc: 0.9538
Epoch 12/28

167/167 [==============================] - 5s 27ms/step - loss: 0.1524 - acc: 0.9621
Epoch 13/28

167/167 [==============================] - 5s 27ms/step - loss: 0.1355 - acc: 0.9677
Epoch 14/28

167/167 [==============================] - 4s 27ms/step - loss: 0.1250 - acc: 0.9696
Epoch 15/28

167/167 [==============================] - 5s 27ms/step - loss: 0.1181 - acc: 0.9679
Epoch 16/28

167/167 [==============================] - 5s 27ms/step - loss: 0.1105 - acc: 0.9748
Epoch 17/28

167/167 [==============================] - 5s 27ms/step - loss: 0.1003 - acc: 0.9780
Epoch 18/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0949 - acc: 0.9774
Epoch 19/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0905 - acc: 0.9784
Epoch 20/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0813 - acc: 0.9838
Epoch 21/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0816 - acc: 0.9794
Epoch 22/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0753 - acc: 0.9855
Epoch 23/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0690 - acc: 0.9848
Epoch 24/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0644 - acc: 0.9887
Epoch 25/28

167/167 [==============================] - 4s 27ms/step - loss: 0.0600 - acc: 0.9890
Epoch 26/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0584 - acc: 0.9893
Epoch 27/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0533 - acc: 0.9933
Epoch 28/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0482 - acc: 0.9925
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7745
False 1326
True percentage 0.853819865505
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.94      0.96      7318
      B-PER       0.81      0.65      0.72       438
      B-LOC       0.67      0.56      0.61       218
     B-MISC       0.19      0.16      0.18       141
     I-MISC       0.32      0.37      0.34       154
      B-ORG       0.56      0.65      0.60       296
      I-ORG       0.26      0.26      0.26       151
      I-LOC       0.64      0.38      0.48       141
      I-PER       0.70      0.43      0.54       214

avg / total       0.90      0.85      0.87      9071

F-1 Score (without O):
0.523058252427
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104204 unique words.
4200 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 266
OOV word occurences: in test 469
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6669120     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,781,250
Trainable params: 6,781,250
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 6s 37ms/step - loss: 0.9273 - acc: 0.7381
Epoch 2/28

167/167 [==============================] - 5s 28ms/step - loss: 0.4553 - acc: 0.8583
Epoch 3/28

167/167 [==============================] - 5s 28ms/step - loss: 0.3898 - acc: 0.8783
Epoch 4/28

167/167 [==============================] - 5s 28ms/step - loss: 0.3328 - acc: 0.9027
Epoch 5/28

167/167 [==============================] - 5s 28ms/step - loss: 0.3060 - acc: 0.9076
Epoch 6/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2747 - acc: 0.9206
Epoch 7/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2464 - acc: 0.9356
Epoch 8/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2259 - acc: 0.9411
Epoch 9/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2046 - acc: 0.9452
Epoch 10/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1901 - acc: 0.9487
Epoch 11/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1691 - acc: 0.9587
Epoch 12/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1654 - acc: 0.9591
Epoch 13/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1494 - acc: 0.9652
Epoch 14/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1387 - acc: 0.9608
Epoch 15/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1225 - acc: 0.9717
Epoch 16/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1144 - acc: 0.9722
Epoch 17/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1085 - acc: 0.9733
Epoch 18/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0995 - acc: 0.9788
Epoch 19/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0925 - acc: 0.9812
Epoch 20/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0910 - acc: 0.9772
Epoch 21/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0819 - acc: 0.9832
Epoch 22/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0759 - acc: 0.9836
Epoch 23/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0719 - acc: 0.9848
Epoch 24/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0679 - acc: 0.9861
Epoch 25/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0658 - acc: 0.9871
Epoch 26/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0570 - acc: 0.9866
Epoch 27/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0573 - acc: 0.9867
Epoch 28/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0551 - acc: 0.9893
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7810
False 1261
True percentage 0.860985558373
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-ORG       0.52      0.49      0.50       296
      I-ORG       0.39      0.40      0.39       151
      B-PER       0.75      0.63      0.69       438
      I-PER       0.68      0.60      0.64       214
      B-LOC       0.70      0.54      0.61       218
      I-LOC       0.66      0.52      0.58       141
     B-MISC       0.26      0.16      0.19       141
     I-MISC       0.41      0.27      0.32       154

avg / total       0.90      0.86      0.88      9071

F-1 Score (without O):
0.538533541342
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104186 unique words.
4182 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 269
OOV word occurences: in test 453
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6667968     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,780,098
Trainable params: 6,780,098
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 6s 36ms/step - loss: 0.7190 - acc: 0.7951
Epoch 2/28

167/167 [==============================] - 4s 27ms/step - loss: 0.4046 - acc: 0.8713
Epoch 3/28

167/167 [==============================] - 4s 27ms/step - loss: 0.3368 - acc: 0.8933
Epoch 4/28

167/167 [==============================] - 4s 27ms/step - loss: 0.2921 - acc: 0.9072
Epoch 5/28

167/167 [==============================] - 5s 27ms/step - loss: 0.2621 - acc: 0.9192
Epoch 6/28

167/167 [==============================] - 4s 27ms/step - loss: 0.2293 - acc: 0.9360
Epoch 7/28

167/167 [==============================] - 4s 27ms/step - loss: 0.2083 - acc: 0.9347
Epoch 8/28

167/167 [==============================] - 4s 27ms/step - loss: 0.1851 - acc: 0.9503
Epoch 9/28

167/167 [==============================] - 5s 27ms/step - loss: 0.1656 - acc: 0.9543
Epoch 10/28

167/167 [==============================] - 5s 27ms/step - loss: 0.1562 - acc: 0.9553
Epoch 11/28

167/167 [==============================] - 5s 27ms/step - loss: 0.1456 - acc: 0.9657
Epoch 12/28

167/167 [==============================] - 4s 27ms/step - loss: 0.1260 - acc: 0.9716
Epoch 13/28

167/167 [==============================] - 5s 27ms/step - loss: 0.1184 - acc: 0.9710
Epoch 14/28

167/167 [==============================] - 5s 27ms/step - loss: 0.1079 - acc: 0.9747
Epoch 15/28

167/167 [==============================] - 5s 27ms/step - loss: 0.1011 - acc: 0.9760
Epoch 16/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0993 - acc: 0.9776
Epoch 17/28

167/167 [==============================] - 4s 27ms/step - loss: 0.0827 - acc: 0.9841
Epoch 18/28

167/167 [==============================] - 4s 27ms/step - loss: 0.0798 - acc: 0.9834
Epoch 19/28

167/167 [==============================] - 4s 27ms/step - loss: 0.0753 - acc: 0.9863
Epoch 20/28

167/167 [==============================] - 4s 27ms/step - loss: 0.0684 - acc: 0.9880
Epoch 21/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0607 - acc: 0.9901
Epoch 22/28

167/167 [==============================] - 4s 27ms/step - loss: 0.0621 - acc: 0.9906
Epoch 23/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0600 - acc: 0.9900
Epoch 24/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0550 - acc: 0.9901
Epoch 25/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0507 - acc: 0.9924
Epoch 26/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0460 - acc: 0.9939
Epoch 27/28

167/167 [==============================] - 4s 27ms/step - loss: 0.0421 - acc: 0.9930
Epoch 28/28

167/167 [==============================] - 4s 27ms/step - loss: 0.0425 - acc: 0.9932
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7823
False 1248
True percentage 0.862418696946
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.58      0.53      0.55       296
          O       0.97      0.95      0.96      7318
     B-MISC       0.33      0.20      0.25       141
     I-MISC       0.35      0.29      0.32       154
      B-LOC       0.68      0.51      0.59       218
      I-LOC       0.80      0.58      0.67       141
      B-PER       0.73      0.64      0.68       438
      I-PER       0.81      0.53      0.64       214
      I-ORG       0.34      0.32      0.33       151

avg / total       0.90      0.86      0.88      9071

F-1 Score (without O):
0.895520644747
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104165 unique words.
4161 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 270
OOV word occurences: in test 538
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6666624     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,778,754
Trainable params: 6,778,754
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 6s 37ms/step - loss: 0.9204 - acc: 0.7357
Epoch 2/28

167/167 [==============================] - 5s 28ms/step - loss: 0.4623 - acc: 0.8493
Epoch 3/28

167/167 [==============================] - 5s 27ms/step - loss: 0.3918 - acc: 0.8753
Epoch 4/28

167/167 [==============================] - 5s 28ms/step - loss: 0.3319 - acc: 0.8982
Epoch 5/28

167/167 [==============================] - 5s 27ms/step - loss: 0.3095 - acc: 0.9083
Epoch 6/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2768 - acc: 0.9173
Epoch 7/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2569 - acc: 0.9241
Epoch 8/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2318 - acc: 0.9370
Epoch 9/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2091 - acc: 0.9455
Epoch 10/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1954 - acc: 0.9417
Epoch 11/28

167/167 [==============================] - 5s 27ms/step - loss: 0.1831 - acc: 0.9483
Epoch 12/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1689 - acc: 0.9574
Epoch 13/28

167/167 [==============================] - 5s 27ms/step - loss: 0.1583 - acc: 0.9596
Epoch 14/28

167/167 [==============================] - 5s 27ms/step - loss: 0.1439 - acc: 0.9662
Epoch 15/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1337 - acc: 0.9685
Epoch 16/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1278 - acc: 0.9692
Epoch 17/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1155 - acc: 0.9731
Epoch 18/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1192 - acc: 0.9686
Epoch 19/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1062 - acc: 0.9772
Epoch 20/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0966 - acc: 0.9769
Epoch 21/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0946 - acc: 0.9804
Epoch 22/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0924 - acc: 0.9751
Epoch 23/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0845 - acc: 0.9784
Epoch 24/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0761 - acc: 0.9854
Epoch 25/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0748 - acc: 0.9819
Epoch 26/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0716 - acc: 0.9847
Epoch 27/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0633 - acc: 0.9881
Epoch 28/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0616 - acc: 0.9886
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7783
False 1288
True percentage 0.858009039797
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-PER       0.75      0.55      0.64       438
      B-ORG       0.53      0.45      0.48       296
     B-MISC       0.30      0.16      0.21       141
      I-PER       0.72      0.49      0.58       214
      I-ORG       0.33      0.36      0.35       151
     I-MISC       0.42      0.31      0.35       154
      B-LOC       0.78      0.57      0.66       218
      I-LOC       0.70      0.60      0.64       141

avg / total       0.90      0.86      0.88      9071

F-1 Score (without O):
0.523364485981
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104116 unique words.
4112 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 278
OOV word occurences: in test 539
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663488     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,618
Trainable params: 6,775,618
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 4s 48ms/step - loss: 1.4294 - acc: 0.6444
Epoch 2/28

83/83 [==============================] - 2s 29ms/step - loss: 0.5308 - acc: 0.8301
Epoch 3/28

83/83 [==============================] - 2s 28ms/step - loss: 0.4764 - acc: 0.8534
Epoch 4/28

83/83 [==============================] - 2s 28ms/step - loss: 0.4136 - acc: 0.8560
Epoch 5/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3927 - acc: 0.8736
Epoch 6/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3532 - acc: 0.8896
Epoch 7/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3319 - acc: 0.9009
Epoch 8/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3073 - acc: 0.9103
Epoch 9/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2798 - acc: 0.9222
Epoch 10/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2596 - acc: 0.9397
Epoch 11/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2434 - acc: 0.9395
Epoch 12/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2259 - acc: 0.9458
Epoch 13/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2130 - acc: 0.9365
Epoch 14/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1911 - acc: 0.9546
Epoch 15/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1761 - acc: 0.9691
Epoch 16/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1790 - acc: 0.9615
Epoch 17/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1553 - acc: 0.9720
Epoch 18/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1491 - acc: 0.9714
Epoch 19/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1389 - acc: 0.9753
Epoch 20/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1331 - acc: 0.9774
Epoch 21/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1191 - acc: 0.9807
Epoch 22/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1203 - acc: 0.9773
Epoch 23/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1079 - acc: 0.9817
Epoch 24/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1013 - acc: 0.9880
Epoch 25/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0961 - acc: 0.9840
Epoch 26/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0921 - acc: 0.9874
Epoch 27/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0862 - acc: 0.9864
Epoch 28/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0782 - acc: 0.9922
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7653
False 1418
True percentage 0.843677654062
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.94      0.95      7318
      B-LOC       0.66      0.54      0.59       218
      I-LOC       0.49      0.70      0.57       141
      B-PER       0.60      0.52      0.56       438
      B-ORG       0.51      0.63      0.56       296
      I-ORG       0.35      0.31      0.33       151
     B-MISC       0.56      0.13      0.21       141
     I-MISC       0.33      0.18      0.23       154
      I-PER       0.72      0.27      0.39       214

avg / total       0.89      0.84      0.86      9071

F-1 Score (without O):
0.486132751636
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104112 unique words.
4108 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 277
OOV word occurences: in test 484
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663232     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,362
Trainable params: 6,775,362
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 4s 49ms/step - loss: 1.1633 - acc: 0.6679
Epoch 2/28

83/83 [==============================] - 2s 29ms/step - loss: 0.5070 - acc: 0.8462
Epoch 3/28

83/83 [==============================] - 2s 29ms/step - loss: 0.4070 - acc: 0.8753
Epoch 4/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3742 - acc: 0.8887
Epoch 5/28

83/83 [==============================] - 2s 29ms/step - loss: 0.3321 - acc: 0.9118
Epoch 6/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2871 - acc: 0.9198
Epoch 7/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2779 - acc: 0.9192
Epoch 8/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2544 - acc: 0.9362
Epoch 9/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2326 - acc: 0.9345
Epoch 10/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2140 - acc: 0.9508
Epoch 11/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1978 - acc: 0.9532
Epoch 12/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1814 - acc: 0.9557
Epoch 13/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1747 - acc: 0.9547
Epoch 14/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1591 - acc: 0.9602
Epoch 15/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1521 - acc: 0.9668
Epoch 16/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1387 - acc: 0.9679
Epoch 17/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1309 - acc: 0.9708
Epoch 18/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1275 - acc: 0.9731
Epoch 19/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1209 - acc: 0.9770
Epoch 20/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1138 - acc: 0.9785
Epoch 21/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1055 - acc: 0.9782
Epoch 22/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0993 - acc: 0.9844
Epoch 23/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0921 - acc: 0.9852
Epoch 24/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0877 - acc: 0.9836
Epoch 25/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0850 - acc: 0.9829
Epoch 26/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0814 - acc: 0.9851
Epoch 27/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0745 - acc: 0.9871
Epoch 28/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0692 - acc: 0.9897
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7709
False 1362
True percentage 0.849851174071
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.95      0.96      7318
      B-PER       0.70      0.58      0.63       438
      B-LOC       0.64      0.58      0.61       218
     B-MISC       0.29      0.17      0.22       141
     I-MISC       0.31      0.35      0.33       154
      B-ORG       0.51      0.49      0.50       296
      I-ORG       0.33      0.23      0.27       151
      I-LOC       0.57      0.39      0.46       141
      I-PER       0.85      0.41      0.55       214

avg / total       0.89      0.85      0.87      9071

F-1 Score (without O):
0.493662864385
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104117 unique words.
4113 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 275
OOV word occurences: in test 481
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663552     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,682
Trainable params: 6,775,682
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 4s 48ms/step - loss: 1.2216 - acc: 0.6565
Epoch 2/28

83/83 [==============================] - 2s 28ms/step - loss: 0.5399 - acc: 0.8296
Epoch 3/28

83/83 [==============================] - 2s 28ms/step - loss: 0.4375 - acc: 0.8568
Epoch 4/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3783 - acc: 0.8866
Epoch 5/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3465 - acc: 0.8991
Epoch 6/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3103 - acc: 0.9074
Epoch 7/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2796 - acc: 0.9244
Epoch 8/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2697 - acc: 0.9332
Epoch 9/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2275 - acc: 0.9508
Epoch 10/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2091 - acc: 0.9429
Epoch 11/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1893 - acc: 0.9508
Epoch 12/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1693 - acc: 0.9616
Epoch 13/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1598 - acc: 0.9656
Epoch 14/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1541 - acc: 0.9713
Epoch 15/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1222 - acc: 0.9779
Epoch 16/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1171 - acc: 0.9828
Epoch 17/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1175 - acc: 0.9782
Epoch 18/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1085 - acc: 0.9807
Epoch 19/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0970 - acc: 0.9822
Epoch 20/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0922 - acc: 0.9883
Epoch 21/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0836 - acc: 0.9902
Epoch 22/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0826 - acc: 0.9858
Epoch 23/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0731 - acc: 0.9898
Epoch 24/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0690 - acc: 0.9913
Epoch 25/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0656 - acc: 0.9906
Epoch 26/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0583 - acc: 0.9929
Epoch 27/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0584 - acc: 0.9911
Epoch 28/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0543 - acc: 0.9898
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7719
False 1352
True percentage 0.850953588359
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.94      0.96      7318
      B-ORG       0.48      0.44      0.46       296
      I-ORG       0.28      0.32      0.30       151
      B-PER       0.69      0.63      0.66       438
      I-PER       0.67      0.52      0.59       214
      B-LOC       0.69      0.55      0.61       218
      I-LOC       0.68      0.34      0.45       141
     B-MISC       0.30      0.12      0.17       141
     I-MISC       0.38      0.39      0.38       154

avg / total       0.89      0.85      0.87      9071

F-1 Score (without O):
0.502328469419
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104120 unique words.
4116 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 279
OOV word occurences: in test 552
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663744     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,874
Trainable params: 6,775,874
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 4s 46ms/step - loss: 0.9495 - acc: 0.7139
Epoch 2/28

83/83 [==============================] - 2s 27ms/step - loss: 0.4780 - acc: 0.8471
Epoch 3/28

83/83 [==============================] - 2s 27ms/step - loss: 0.3821 - acc: 0.8761
Epoch 4/28

83/83 [==============================] - 2s 27ms/step - loss: 0.3532 - acc: 0.8870
Epoch 5/28

83/83 [==============================] - 2s 27ms/step - loss: 0.3069 - acc: 0.9133
Epoch 6/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2841 - acc: 0.9239
Epoch 7/28

83/83 [==============================] - 2s 27ms/step - loss: 0.2530 - acc: 0.9211
Epoch 8/28

83/83 [==============================] - 2s 27ms/step - loss: 0.2291 - acc: 0.9405
Epoch 9/28

83/83 [==============================] - 2s 27ms/step - loss: 0.2233 - acc: 0.9386
Epoch 10/28

83/83 [==============================] - 2s 27ms/step - loss: 0.2072 - acc: 0.9385
Epoch 11/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1817 - acc: 0.9560
Epoch 12/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1635 - acc: 0.9675
Epoch 13/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1513 - acc: 0.9614
Epoch 14/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1488 - acc: 0.9636
Epoch 15/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1411 - acc: 0.9661
Epoch 16/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1269 - acc: 0.9744
Epoch 17/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1213 - acc: 0.9757
Epoch 18/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1185 - acc: 0.9727
Epoch 19/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1056 - acc: 0.9799
Epoch 20/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0999 - acc: 0.9793
Epoch 21/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0960 - acc: 0.9836
Epoch 22/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0893 - acc: 0.9818
Epoch 23/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0824 - acc: 0.9861
Epoch 24/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0786 - acc: 0.9868
Epoch 25/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0788 - acc: 0.9859
Epoch 26/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0672 - acc: 0.9883
Epoch 27/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0674 - acc: 0.9877
Epoch 28/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0623 - acc: 0.9913
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7529
False 1542
True percentage 0.8300077169
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.48      0.45      0.47       296
          O       0.96      0.95      0.95      7318
     B-MISC       0.25      0.21      0.23       141
     I-MISC       0.25      0.27      0.26       154
      B-LOC       0.76      0.43      0.55       218
      I-LOC       0.91      0.07      0.13       141
      B-PER       0.68      0.44      0.54       438
      I-PER       0.77      0.27      0.40       214
      I-ORG       0.17      0.28      0.21       151

avg / total       0.89      0.83      0.85      9071

F-1 Score (without O):
0.86923302968
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104103 unique words.
4099 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 277
OOV word occurences: in test 557
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6662656     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,774,786
Trainable params: 6,774,786
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 4s 49ms/step - loss: 1.2614 - acc: 0.6570
Epoch 2/28

83/83 [==============================] - 2s 28ms/step - loss: 0.4576 - acc: 0.8542
Epoch 3/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3752 - acc: 0.8821
Epoch 4/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3273 - acc: 0.8881
Epoch 5/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2921 - acc: 0.9156
Epoch 6/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2604 - acc: 0.9198
Epoch 7/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2450 - acc: 0.9299
Epoch 8/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2167 - acc: 0.9412
Epoch 9/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2000 - acc: 0.9444
Epoch 10/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1869 - acc: 0.9487
Epoch 11/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1726 - acc: 0.9573
Epoch 12/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1565 - acc: 0.9519
Epoch 13/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1488 - acc: 0.9624
Epoch 14/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1413 - acc: 0.9630
Epoch 15/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1367 - acc: 0.9674
Epoch 16/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1325 - acc: 0.9665
Epoch 17/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1201 - acc: 0.9770
Epoch 18/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1138 - acc: 0.9765
Epoch 19/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1083 - acc: 0.9802
Epoch 20/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0999 - acc: 0.9833
Epoch 21/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0886 - acc: 0.9885
Epoch 22/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0918 - acc: 0.9827
Epoch 23/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0848 - acc: 0.9894
Epoch 24/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0775 - acc: 0.9868
Epoch 25/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0743 - acc: 0.9894
Epoch 26/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0684 - acc: 0.9912
Epoch 27/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0737 - acc: 0.9871
Epoch 28/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0695 - acc: 0.9915
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7600
False 1471
True percentage 0.83783485834
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.95      0.95      7318
      B-PER       0.73      0.39      0.51       438
      B-ORG       0.47      0.42      0.44       296
     B-MISC       0.30      0.15      0.20       141
      I-PER       0.74      0.40      0.52       214
      I-ORG       0.27      0.36      0.31       151
     I-MISC       0.36      0.18      0.24       154
      B-LOC       0.85      0.44      0.58       218
      I-LOC       0.55      0.48      0.51       141

avg / total       0.88      0.84      0.85      9071

F-1 Score (without O):
0.438958403788
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104064 unique words.
4060 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 558
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660160     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,290
Trainable params: 6,772,290
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 3s 78ms/step - loss: 2.1501 - acc: 0.3940
Epoch 2/28

33/33 [==============================] - 1s 30ms/step - loss: 0.8280 - acc: 0.7822
Epoch 3/28

33/33 [==============================] - 1s 29ms/step - loss: 0.7111 - acc: 0.7981
Epoch 4/28

33/33 [==============================] - 1s 30ms/step - loss: 0.6224 - acc: 0.7988
Epoch 5/28

33/33 [==============================] - 1s 29ms/step - loss: 0.5439 - acc: 0.8274
Epoch 6/28

33/33 [==============================] - 1s 29ms/step - loss: 0.5205 - acc: 0.8208
Epoch 7/28

33/33 [==============================] - 1s 30ms/step - loss: 0.4765 - acc: 0.8461
Epoch 8/28

33/33 [==============================] - 1s 29ms/step - loss: 0.4422 - acc: 0.8613
Epoch 9/28

33/33 [==============================] - 1s 29ms/step - loss: 0.4112 - acc: 0.8699
Epoch 10/28

33/33 [==============================] - 1s 30ms/step - loss: 0.3746 - acc: 0.8988
Epoch 11/28

33/33 [==============================] - 1s 29ms/step - loss: 0.3719 - acc: 0.8820
Epoch 12/28

33/33 [==============================] - 1s 30ms/step - loss: 0.3435 - acc: 0.9027
Epoch 13/28

33/33 [==============================] - 1s 29ms/step - loss: 0.3273 - acc: 0.9045
Epoch 14/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2953 - acc: 0.9384
Epoch 15/28

33/33 [==============================] - 1s 29ms/step - loss: 0.2841 - acc: 0.9301
Epoch 16/28

33/33 [==============================] - 1s 29ms/step - loss: 0.2724 - acc: 0.9288
Epoch 17/28

33/33 [==============================] - 1s 29ms/step - loss: 0.2683 - acc: 0.9448
Epoch 18/28

33/33 [==============================] - 1s 29ms/step - loss: 0.2585 - acc: 0.9470
Epoch 19/28

33/33 [==============================] - 1s 29ms/step - loss: 0.2333 - acc: 0.9558
Epoch 20/28

33/33 [==============================] - 1s 29ms/step - loss: 0.2274 - acc: 0.9628
Epoch 21/28

33/33 [==============================] - 1s 29ms/step - loss: 0.2161 - acc: 0.9594
Epoch 22/28

33/33 [==============================] - 1s 29ms/step - loss: 0.1950 - acc: 0.9756
Epoch 23/28

33/33 [==============================] - 1s 29ms/step - loss: 0.1786 - acc: 0.9804
Epoch 24/28

33/33 [==============================] - 1s 29ms/step - loss: 0.1878 - acc: 0.9655
Epoch 25/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1702 - acc: 0.9775
Epoch 26/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1746 - acc: 0.9729
Epoch 27/28

33/33 [==============================] - 1s 29ms/step - loss: 0.1625 - acc: 0.9765
Epoch 28/28

33/33 [==============================] - 1s 29ms/step - loss: 0.1633 - acc: 0.9797
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7310
False 1761
True percentage 0.805864844008
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.93      0.95      7318
      B-LOC       0.59      0.37      0.46       218
      I-LOC       0.36      0.04      0.06       141
      B-PER       0.64      0.28      0.39       438
      B-ORG       0.30      0.52      0.38       296
      I-ORG       0.17      0.58      0.26       151
     B-MISC       0.75      0.02      0.04       141
     I-MISC       0.34      0.11      0.17       154
      I-PER       0.69      0.14      0.23       214

avg / total       0.88      0.81      0.82      9071

F-1 Score (without O):
0.309354739117
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104062 unique words.
4058 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 280
OOV word occurences: in test 496
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660032     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,162
Trainable params: 6,772,162
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 3s 79ms/step - loss: 1.9722 - acc: 0.3931
Epoch 2/28

33/33 [==============================] - 1s 30ms/step - loss: 0.6647 - acc: 0.7936
Epoch 3/28

33/33 [==============================] - 1s 30ms/step - loss: 0.5033 - acc: 0.8475
Epoch 4/28

33/33 [==============================] - 1s 31ms/step - loss: 0.4538 - acc: 0.8550
Epoch 5/28

33/33 [==============================] - 1s 30ms/step - loss: 0.4609 - acc: 0.8688
Epoch 6/28

33/33 [==============================] - 1s 30ms/step - loss: 0.4012 - acc: 0.9024
Epoch 7/28

33/33 [==============================] - 1s 30ms/step - loss: 0.3515 - acc: 0.9117
Epoch 8/28

33/33 [==============================] - 1s 30ms/step - loss: 0.3351 - acc: 0.9133
Epoch 9/28

33/33 [==============================] - 1s 29ms/step - loss: 0.3029 - acc: 0.9092
Epoch 10/28

33/33 [==============================] - 1s 30ms/step - loss: 0.3079 - acc: 0.9042
Epoch 11/28

33/33 [==============================] - 1s 30ms/step - loss: 0.3060 - acc: 0.9072
Epoch 12/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2732 - acc: 0.9188
Epoch 13/28

33/33 [==============================] - 1s 29ms/step - loss: 0.2595 - acc: 0.9341
Epoch 14/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2637 - acc: 0.9221
Epoch 15/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2382 - acc: 0.9356
Epoch 16/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2368 - acc: 0.9322
Epoch 17/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2259 - acc: 0.9346
Epoch 18/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1993 - acc: 0.9442
Epoch 19/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1967 - acc: 0.9443
Epoch 20/28

33/33 [==============================] - 1s 29ms/step - loss: 0.1870 - acc: 0.9566
Epoch 21/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1891 - acc: 0.9546
Epoch 22/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1994 - acc: 0.9575
Epoch 23/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1756 - acc: 0.9595
Epoch 24/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1541 - acc: 0.9633
Epoch 25/28

33/33 [==============================] - 1s 29ms/step - loss: 0.1492 - acc: 0.9696
Epoch 26/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1523 - acc: 0.9592
Epoch 27/28

33/33 [==============================] - 1s 29ms/step - loss: 0.1332 - acc: 0.9706
Epoch 28/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1429 - acc: 0.9657
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7470
False 1601
True percentage 0.823503472605
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.94      0.95      7318
      B-PER       0.59      0.52      0.55       438
      B-LOC       0.64      0.57      0.60       218
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-ORG       0.39      0.46      0.42       296
      I-ORG       0.19      0.42      0.26       151
      I-LOC       0.35      0.23      0.28       141
      I-PER       0.49      0.13      0.20       214

avg / total       0.85      0.82      0.83      9071

F-1 Score (without O):
0.384615384615
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104072 unique words.
4068 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 279
OOV word occurences: in test 552
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660672     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,802
Trainable params: 6,772,802
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 3s 80ms/step - loss: 1.7499 - acc: 0.4402
Epoch 2/28

33/33 [==============================] - 1s 30ms/step - loss: 0.9877 - acc: 0.7876
Epoch 3/28

33/33 [==============================] - 1s 30ms/step - loss: 0.6155 - acc: 0.8140
Epoch 4/28

33/33 [==============================] - 1s 30ms/step - loss: 0.5439 - acc: 0.8228
Epoch 5/28

33/33 [==============================] - 1s 30ms/step - loss: 0.5082 - acc: 0.8309
Epoch 6/28

33/33 [==============================] - 1s 31ms/step - loss: 0.4401 - acc: 0.8684
Epoch 7/28

33/33 [==============================] - 1s 32ms/step - loss: 0.4121 - acc: 0.8860
Epoch 8/28

33/33 [==============================] - 1s 30ms/step - loss: 0.4252 - acc: 0.8723
Epoch 9/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3697 - acc: 0.8958
Epoch 10/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3491 - acc: 0.9044
Epoch 11/28

33/33 [==============================] - 1s 30ms/step - loss: 0.3258 - acc: 0.8981
Epoch 12/28

33/33 [==============================] - 1s 30ms/step - loss: 0.3147 - acc: 0.9207
Epoch 13/28

33/33 [==============================] - 1s 30ms/step - loss: 0.3203 - acc: 0.8907
Epoch 14/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2787 - acc: 0.9232
Epoch 15/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2644 - acc: 0.9363
Epoch 16/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2427 - acc: 0.9447
Epoch 17/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2274 - acc: 0.9539
Epoch 18/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2172 - acc: 0.9544
Epoch 19/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2089 - acc: 0.9554
Epoch 20/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2069 - acc: 0.9514
Epoch 21/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1870 - acc: 0.9468
Epoch 22/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1835 - acc: 0.9575
Epoch 23/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1765 - acc: 0.9662
Epoch 24/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1588 - acc: 0.9652
Epoch 25/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1547 - acc: 0.9697
Epoch 26/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1489 - acc: 0.9721
Epoch 27/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1387 - acc: 0.9709
Epoch 28/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1339 - acc: 0.9768
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7334
False 1737
True percentage 0.808510638298
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.92      0.95      7318
      B-ORG       0.37      0.44      0.40       296
      I-ORG       0.17      0.52      0.26       151
      B-PER       0.60      0.45      0.51       438
      I-PER       0.47      0.21      0.30       214
      B-LOC       0.72      0.35      0.47       218
      I-LOC       1.00      0.01      0.01       141
     B-MISC       0.36      0.19      0.25       141
     I-MISC       0.22      0.37      0.27       154

avg / total       0.89      0.81      0.84      9071

F-1 Score (without O):
0.355646100116
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104069 unique words.
4065 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 281
OOV word occurences: in test 562
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660480     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,610
Trainable params: 6,772,610
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 3s 81ms/step - loss: 2.1559 - acc: 0.4139
Epoch 2/28

33/33 [==============================] - 1s 30ms/step - loss: 0.6756 - acc: 0.8190
Epoch 3/28

33/33 [==============================] - 1s 32ms/step - loss: 0.5193 - acc: 0.8262
Epoch 4/28

33/33 [==============================] - 1s 31ms/step - loss: 0.4803 - acc: 0.8346
Epoch 5/28

33/33 [==============================] - 1s 30ms/step - loss: 0.4107 - acc: 0.8657
Epoch 6/28

33/33 [==============================] - 1s 30ms/step - loss: 0.3898 - acc: 0.8680
Epoch 7/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3622 - acc: 0.8788
Epoch 8/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3248 - acc: 0.8937
Epoch 9/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2944 - acc: 0.9010
Epoch 10/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3074 - acc: 0.9006
Epoch 11/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2700 - acc: 0.9224
Epoch 12/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2531 - acc: 0.9288
Epoch 13/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2437 - acc: 0.9324
Epoch 14/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2210 - acc: 0.9448
Epoch 15/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2303 - acc: 0.9318
Epoch 16/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2127 - acc: 0.9461
Epoch 17/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2542 - acc: 0.9155
Epoch 18/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1867 - acc: 0.9579
Epoch 19/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1705 - acc: 0.9641
Epoch 20/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1829 - acc: 0.9608
Epoch 21/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1625 - acc: 0.9755
Epoch 22/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1627 - acc: 0.9709
Epoch 23/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1409 - acc: 0.9799
Epoch 24/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1494 - acc: 0.9717
Epoch 25/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1357 - acc: 0.9798
Epoch 26/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1286 - acc: 0.9773
Epoch 27/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1171 - acc: 0.9753
Epoch 28/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1288 - acc: 0.9785
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7277
False 1794
True percentage 0.80222687686
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.36      0.34      0.35       296
          O       0.98      0.92      0.95      7318
     B-MISC       0.22      0.43      0.29       141
     I-MISC       0.20      0.64      0.31       154
      B-LOC       0.55      0.35      0.43       218
      I-LOC       0.68      0.09      0.16       141
      B-PER       0.53      0.28      0.37       438
      I-PER       0.34      0.27      0.30       214
      I-ORG       0.00      0.00      0.00       151

avg / total       0.87      0.80      0.82      9071

F-1 Score (without O):
0.844203964006
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104064 unique words.
4060 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 280
OOV word occurences: in test 560
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660160     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,290
Trainable params: 6,772,290
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 3s 78ms/step - loss: 1.8132 - acc: 0.4417
Epoch 2/28

33/33 [==============================] - 1s 29ms/step - loss: 0.7479 - acc: 0.8166
Epoch 3/28

33/33 [==============================] - 1s 29ms/step - loss: 0.4948 - acc: 0.8485
Epoch 4/28

33/33 [==============================] - 1s 30ms/step - loss: 0.4299 - acc: 0.8568
Epoch 5/28

33/33 [==============================] - 1s 29ms/step - loss: 0.3961 - acc: 0.8984
Epoch 6/28

33/33 [==============================] - 1s 30ms/step - loss: 0.3635 - acc: 0.8839
Epoch 7/28

33/33 [==============================] - 1s 29ms/step - loss: 0.3392 - acc: 0.8832
Epoch 8/28

33/33 [==============================] - 1s 30ms/step - loss: 0.3040 - acc: 0.9062
Epoch 9/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2917 - acc: 0.8995
Epoch 10/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2752 - acc: 0.9174
Epoch 11/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2650 - acc: 0.9230
Epoch 12/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2538 - acc: 0.9208
Epoch 13/28

33/33 [==============================] - 1s 29ms/step - loss: 0.2330 - acc: 0.9384
Epoch 14/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2234 - acc: 0.9380
Epoch 15/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2257 - acc: 0.9274
Epoch 16/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2118 - acc: 0.9415
Epoch 17/28

33/33 [==============================] - 1s 29ms/step - loss: 0.2121 - acc: 0.9354
Epoch 18/28

33/33 [==============================] - 1s 29ms/step - loss: 0.1935 - acc: 0.9515
Epoch 19/28

33/33 [==============================] - 1s 29ms/step - loss: 0.1655 - acc: 0.9551
Epoch 20/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1677 - acc: 0.9620
Epoch 21/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1775 - acc: 0.9587
Epoch 22/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1527 - acc: 0.9582
Epoch 23/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1372 - acc: 0.9720
Epoch 24/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1432 - acc: 0.9729
Epoch 25/28

33/33 [==============================] - 1s 29ms/step - loss: 0.1601 - acc: 0.9709
Epoch 26/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1300 - acc: 0.9761
Epoch 27/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1168 - acc: 0.9789
Epoch 28/28

33/33 [==============================] - 1s 29ms/step - loss: 0.1209 - acc: 0.9829
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7324
False 1747
True percentage 0.807408224011
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.94      0.94      7318
      B-PER       0.74      0.30      0.43       438
      B-ORG       0.29      0.35      0.32       296
     B-MISC       0.20      0.29      0.23       141
      I-PER       0.52      0.38      0.44       214
      I-ORG       0.25      0.26      0.25       151
     I-MISC       0.19      0.20      0.20       154
      B-LOC       1.00      0.01      0.02       218
      I-LOC       0.00      0.00      0.00       141

avg / total       0.85      0.81      0.81      9071

F-1 Score (without O):
0.289367429341
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 8 unique labels.
Found 104048 unique words.
4044 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 567
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659136     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,116
Trainable params: 6,771,116
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 2s 127ms/step - loss: 1.9327 - acc: 0.3215
Epoch 2/28

16/16 [==============================] - 0s 28ms/step - loss: 0.6668 - acc: 0.8466
Epoch 3/28

16/16 [==============================] - 0s 26ms/step - loss: 0.5141 - acc: 0.8643
Epoch 4/28

16/16 [==============================] - 0s 26ms/step - loss: 0.4554 - acc: 0.8496
Epoch 5/28

16/16 [==============================] - 0s 26ms/step - loss: 0.4649 - acc: 0.8879
Epoch 6/28

16/16 [==============================] - 0s 26ms/step - loss: 0.4058 - acc: 0.8496
Epoch 7/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3298 - acc: 0.9086
Epoch 8/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2925 - acc: 0.8909
Epoch 9/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2616 - acc: 0.9351
Epoch 10/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2398 - acc: 0.9322
Epoch 11/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2169 - acc: 0.9528
Epoch 12/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2120 - acc: 0.9528
Epoch 13/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1966 - acc: 0.9646
Epoch 14/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1798 - acc: 0.9676
Epoch 15/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1842 - acc: 0.9735
Epoch 16/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1617 - acc: 0.9794
Epoch 17/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1426 - acc: 0.9853
Epoch 18/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1432 - acc: 0.9764
Epoch 19/28

16/16 [==============================] - 0s 25ms/step - loss: 0.1296 - acc: 0.9853
Epoch 20/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1212 - acc: 0.9882
Epoch 21/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1146 - acc: 0.9882
Epoch 22/28

16/16 [==============================] - 0s 25ms/step - loss: 0.1089 - acc: 0.9912
Epoch 23/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1091 - acc: 0.9882
Epoch 24/28

16/16 [==============================] - 0s 27ms/step - loss: 0.0882 - acc: 0.9941
Epoch 25/28

16/16 [==============================] - 0s 26ms/step - loss: 0.0953 - acc: 0.9912
Epoch 26/28

16/16 [==============================] - 0s 26ms/step - loss: 0.0871 - acc: 0.9941
Epoch 27/28

16/16 [==============================] - 0s 26ms/step - loss: 0.0810 - acc: 0.9971
Epoch 28/28

16/16 [==============================] - 0s 26ms/step - loss: 0.0798 - acc: 0.9941
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7309
False 1548
True percentage 0.825222987468
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.95      0.94      7318
      B-LOC       0.44      0.42      0.43       218
      I-LOC       0.34      0.26      0.29       141
      B-PER       0.66      0.18      0.28       438
      B-ORG       0.29      0.41      0.34       296
      I-ORG       0.29      0.27      0.28       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.15      0.07      0.10       154

avg / total       0.84      0.83      0.82      8857

F-1 Score (without O):
0.291329479769
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104048 unique words.
4044 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 565
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659136     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,266
Trainable params: 6,771,266
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 2s 129ms/step - loss: 2.7498 - acc: 0.0217
Epoch 2/28

16/16 [==============================] - 0s 27ms/step - loss: 1.1536 - acc: 0.7647
Epoch 3/28

16/16 [==============================] - 0s 27ms/step - loss: 0.6968 - acc: 0.7833
Epoch 4/28

16/16 [==============================] - 0s 28ms/step - loss: 0.6528 - acc: 0.8328
Epoch 5/28

16/16 [==============================] - 0s 28ms/step - loss: 0.5753 - acc: 0.7988
Epoch 6/28

16/16 [==============================] - 0s 27ms/step - loss: 0.5526 - acc: 0.8824
Epoch 7/28

16/16 [==============================] - 0s 27ms/step - loss: 0.4482 - acc: 0.8700
Epoch 8/28

16/16 [==============================] - 0s 27ms/step - loss: 0.4048 - acc: 0.8978
Epoch 9/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3834 - acc: 0.8916
Epoch 10/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3526 - acc: 0.9071
Epoch 11/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3472 - acc: 0.9071
Epoch 12/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3105 - acc: 0.9226
Epoch 13/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2883 - acc: 0.9412
Epoch 14/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2762 - acc: 0.9288
Epoch 15/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2743 - acc: 0.9381
Epoch 16/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2442 - acc: 0.9443
Epoch 17/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2281 - acc: 0.9721
Epoch 18/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2143 - acc: 0.9628
Epoch 19/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1884 - acc: 0.9659
Epoch 20/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1895 - acc: 0.9752
Epoch 21/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1757 - acc: 0.9567
Epoch 22/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1636 - acc: 0.9752
Epoch 23/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1712 - acc: 0.9598
Epoch 24/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1552 - acc: 0.9876
Epoch 25/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1555 - acc: 0.9783
Epoch 26/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1383 - acc: 0.9876
Epoch 27/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1401 - acc: 0.9814
Epoch 28/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1177 - acc: 0.9938
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7259
False 1812
True percentage 0.800242531143
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.94      0.94      7318
      B-PER       0.55      0.39      0.46       438
      B-LOC       0.62      0.26      0.37       218
     B-MISC       0.08      0.07      0.07       141
     I-MISC       0.11      0.02      0.03       154
      B-ORG       0.32      0.38      0.35       296
      I-ORG       0.11      0.18      0.14       151
      I-LOC       1.00      0.01      0.03       141
      I-PER       0.60      0.04      0.08       214

avg / total       0.84      0.80      0.80      9071

F-1 Score (without O):
0.268941979522
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104056 unique words.
4052 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 559
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659648     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,778
Trainable params: 6,771,778
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 2s 126ms/step - loss: 2.2823 - acc: 0.1512
Epoch 2/28

16/16 [==============================] - 0s 26ms/step - loss: 0.9930 - acc: 0.7692
Epoch 3/28

16/16 [==============================] - 0s 27ms/step - loss: 0.7170 - acc: 0.7719
Epoch 4/28

16/16 [==============================] - 0s 27ms/step - loss: 0.6663 - acc: 0.7772
Epoch 5/28

16/16 [==============================] - 0s 27ms/step - loss: 0.8648 - acc: 0.7931
Epoch 6/28

16/16 [==============================] - 0s 27ms/step - loss: 0.5421 - acc: 0.8064
Epoch 7/28

16/16 [==============================] - 0s 27ms/step - loss: 0.4812 - acc: 0.8912
Epoch 8/28

16/16 [==============================] - 0s 28ms/step - loss: 0.4378 - acc: 0.8912
Epoch 9/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3838 - acc: 0.9257
Epoch 10/28

16/16 [==============================] - 0s 26ms/step - loss: 0.3680 - acc: 0.9284
Epoch 11/28

16/16 [==============================] - 0s 28ms/step - loss: 0.3565 - acc: 0.9204
Epoch 12/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3266 - acc: 0.9337
Epoch 13/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2997 - acc: 0.9496
Epoch 14/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2841 - acc: 0.9496
Epoch 15/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2617 - acc: 0.9602
Epoch 16/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2475 - acc: 0.9523
Epoch 17/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2461 - acc: 0.9602
Epoch 18/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2186 - acc: 0.9682
Epoch 19/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2045 - acc: 0.9682
Epoch 20/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1958 - acc: 0.9655
Epoch 21/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1834 - acc: 0.9735
Epoch 22/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1634 - acc: 0.9735
Epoch 23/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1639 - acc: 0.9708
Epoch 24/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1575 - acc: 0.9682
Epoch 25/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1490 - acc: 0.9682
Epoch 26/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1409 - acc: 0.9761
Epoch 27/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1222 - acc: 0.9841
Epoch 28/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1182 - acc: 0.9761
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7174
False 1897
True percentage 0.790872009701
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.92      0.94      7318
      B-ORG       0.28      0.35      0.32       296
      I-ORG       0.12      0.42      0.19       151
      B-PER       0.53      0.19      0.28       438
      I-PER       0.48      0.17      0.25       214
      B-LOC       0.57      0.43      0.49       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.18      0.14      0.16       154

avg / total       0.83      0.79      0.80      9071

F-1 Score (without O):
0.256572695597
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104049 unique words.
4045 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 564
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659200     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,330
Trainable params: 6,771,330
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 2s 127ms/step - loss: 2.8917 - acc: 0.0230
Epoch 2/28

16/16 [==============================] - 0s 27ms/step - loss: 1.3789 - acc: 0.7303
Epoch 3/28

16/16 [==============================] - 0s 26ms/step - loss: 0.7369 - acc: 0.8257
Epoch 4/28

16/16 [==============================] - 0s 26ms/step - loss: 0.5648 - acc: 0.8322
Epoch 5/28

16/16 [==============================] - 0s 27ms/step - loss: 0.4973 - acc: 0.8618
Epoch 6/28

16/16 [==============================] - 0s 26ms/step - loss: 0.5322 - acc: 0.8289
Epoch 7/28

16/16 [==============================] - 0s 26ms/step - loss: 0.5393 - acc: 0.8553
Epoch 8/28

16/16 [==============================] - 0s 26ms/step - loss: 0.4131 - acc: 0.8454
Epoch 9/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3673 - acc: 0.9178
Epoch 10/28

16/16 [==============================] - 0s 26ms/step - loss: 0.3167 - acc: 0.9079
Epoch 11/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2998 - acc: 0.9112
Epoch 12/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2880 - acc: 0.9276
Epoch 13/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2639 - acc: 0.9375
Epoch 14/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2416 - acc: 0.9539
Epoch 15/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2374 - acc: 0.9507
Epoch 16/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2260 - acc: 0.9408
Epoch 17/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2130 - acc: 0.9605
Epoch 18/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2059 - acc: 0.9704
Epoch 19/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1815 - acc: 0.9836
Epoch 20/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1755 - acc: 0.9671
Epoch 21/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1655 - acc: 0.9803
Epoch 22/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1738 - acc: 0.9572
Epoch 23/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1559 - acc: 0.9803
Epoch 24/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1448 - acc: 0.9803
Epoch 25/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1453 - acc: 0.9836
Epoch 26/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1339 - acc: 0.9868
Epoch 27/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1266 - acc: 0.9803
Epoch 28/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1060 - acc: 0.9934
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7191
False 1880
True percentage 0.79274611399
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.22      0.35      0.27       296
          O       0.94      0.93      0.94      7318
     B-MISC       0.26      0.14      0.18       141
     I-MISC       0.20      0.41      0.27       154
      B-LOC       0.38      0.15      0.22       218
      I-LOC       0.46      0.22      0.30       141
      B-PER       0.39      0.12      0.19       438
      I-PER       0.52      0.23      0.32       214
      I-ORG       0.00      0.00      0.00       151

avg / total       0.82      0.79      0.80      9071

F-1 Score (without O):
0.843257390994
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 8 unique labels.
Found 104049 unique words.
4045 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 564
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659200     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,180
Trainable params: 6,771,180
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 2s 127ms/step - loss: 2.6866 - acc: 0.0102
Epoch 2/28

16/16 [==============================] - 0s 27ms/step - loss: 0.9700 - acc: 0.8396
Epoch 3/28

16/16 [==============================] - 0s 28ms/step - loss: 0.5914 - acc: 0.8464
Epoch 4/28

16/16 [==============================] - 0s 27ms/step - loss: 0.4887 - acc: 0.8601
Epoch 5/28

16/16 [==============================] - 0s 26ms/step - loss: 0.4147 - acc: 0.8601
Epoch 6/28

16/16 [==============================] - 0s 27ms/step - loss: 0.4237 - acc: 0.9044
Epoch 7/28

16/16 [==============================] - 0s 26ms/step - loss: 0.4163 - acc: 0.8464
Epoch 8/28

16/16 [==============================] - 0s 28ms/step - loss: 0.3285 - acc: 0.9147
Epoch 9/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2725 - acc: 0.9181
Epoch 10/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2589 - acc: 0.9147
Epoch 11/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2272 - acc: 0.9352
Epoch 12/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2097 - acc: 0.9488
Epoch 13/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1849 - acc: 0.9556
Epoch 14/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1798 - acc: 0.9488
Epoch 15/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1739 - acc: 0.9625
Epoch 16/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1707 - acc: 0.9454
Epoch 17/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1609 - acc: 0.9625
Epoch 18/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1294 - acc: 0.9727
Epoch 19/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1231 - acc: 0.9761
Epoch 20/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1182 - acc: 0.9795
Epoch 21/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1064 - acc: 0.9898
Epoch 22/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1112 - acc: 0.9795
Epoch 23/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1145 - acc: 0.9761
Epoch 24/28

16/16 [==============================] - 0s 26ms/step - loss: 0.0970 - acc: 0.9863
Epoch 25/28

16/16 [==============================] - 0s 28ms/step - loss: 0.0849 - acc: 0.9898
Epoch 26/28

16/16 [==============================] - 0s 27ms/step - loss: 0.0902 - acc: 0.9829
Epoch 27/28

16/16 [==============================] - 0s 27ms/step - loss: 0.0866 - acc: 0.9898
Epoch 28/28

16/16 [==============================] - 0s 27ms/step - loss: 0.0745 - acc: 0.9932
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7247
False 1683
True percentage 0.811534154535
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.94      0.94      7318
      B-PER       0.40      0.35      0.37       438
      B-ORG       0.26      0.37      0.31       296
     B-MISC       0.00      0.00      0.00       141
      I-PER       0.32      0.26      0.29       214
      I-ORG       0.27      0.12      0.17       151
     I-MISC       0.00      0.00      0.00       154
      B-LOC       1.00      0.03      0.05       218

avg / total       0.82      0.81      0.81      8930

F-1 Score (without O):
0.256832646949
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 8 unique labels.
Found 104041 unique words.
4037 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658688     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,668
Trainable params: 6,770,668
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 2s 235ms/step - loss: 2.4628 - acc: 0.1391
Epoch 2/28

8/8 [==============================] - 0s 32ms/step - loss: 1.0544 - acc: 0.7417
Epoch 3/28

8/8 [==============================] - 0s 32ms/step - loss: 0.6742 - acc: 0.8212
Epoch 4/28

8/8 [==============================] - 0s 32ms/step - loss: 0.5477 - acc: 0.8212
Epoch 5/28

8/8 [==============================] - 0s 31ms/step - loss: 0.4778 - acc: 0.8609
Epoch 6/28

8/8 [==============================] - 0s 32ms/step - loss: 0.7246 - acc: 0.8013
Epoch 7/28

8/8 [==============================] - 0s 32ms/step - loss: 0.6176 - acc: 0.8808
Epoch 8/28

8/8 [==============================] - 0s 32ms/step - loss: 0.3823 - acc: 0.8940
Epoch 9/28

8/8 [==============================] - 0s 34ms/step - loss: 0.3198 - acc: 0.9272
Epoch 10/28

8/8 [==============================] - 0s 31ms/step - loss: 0.2986 - acc: 0.9272
Epoch 11/28

8/8 [==============================] - 0s 32ms/step - loss: 0.2728 - acc: 0.9669
Epoch 12/28

8/8 [==============================] - 0s 31ms/step - loss: 0.2528 - acc: 0.9603
Epoch 13/28

8/8 [==============================] - 0s 31ms/step - loss: 0.2449 - acc: 0.9470
Epoch 14/28

8/8 [==============================] - 0s 31ms/step - loss: 0.2065 - acc: 0.9868
Epoch 15/28

8/8 [==============================] - 0s 32ms/step - loss: 0.2117 - acc: 0.9603
Epoch 16/28

8/8 [==============================] - 0s 31ms/step - loss: 0.1871 - acc: 0.9801
Epoch 17/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1868 - acc: 0.9868
Epoch 18/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1734 - acc: 0.9735
Epoch 19/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1435 - acc: 0.9934
Epoch 20/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1461 - acc: 0.9934
Epoch 21/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1527 - acc: 0.9868
Epoch 22/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1316 - acc: 0.9934
Epoch 23/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1134 - acc: 0.9934
Epoch 24/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1087 - acc: 0.9934
Epoch 25/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1045 - acc: 0.9934
Epoch 26/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1041 - acc: 0.9868
Epoch 27/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1014 - acc: 0.9934
Epoch 28/28

8/8 [==============================] - 0s 32ms/step - loss: 0.0961 - acc: 0.9868
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7001
False 1856
True percentage 0.790448233036
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.91      0.93      7318
      B-LOC       0.43      0.15      0.22       218
      I-LOC       0.36      0.28      0.31       141
      B-PER       0.22      0.15      0.18       438
      B-ORG       0.23      0.44      0.30       296
      I-ORG       0.20      0.36      0.25       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.16      0.23      0.19       154

avg / total       0.83      0.79      0.81      8857

F-1 Score (without O):
0.231837261866
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104043 unique words.
4039 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 565
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658816     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,946
Trainable params: 6,770,946
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 2s 235ms/step - loss: 2.4877 - acc: 0.1183
Epoch 2/28

8/8 [==============================] - 0s 33ms/step - loss: 0.9647 - acc: 0.7870
Epoch 3/28

8/8 [==============================] - 0s 32ms/step - loss: 0.6760 - acc: 0.7870
Epoch 4/28

8/8 [==============================] - 0s 34ms/step - loss: 0.6015 - acc: 0.8757
Epoch 5/28

8/8 [==============================] - 0s 33ms/step - loss: 0.6151 - acc: 0.7870
Epoch 6/28

8/8 [==============================] - 0s 33ms/step - loss: 0.5293 - acc: 0.9349
Epoch 7/28

8/8 [==============================] - 0s 33ms/step - loss: 0.4247 - acc: 0.8462
Epoch 8/28

8/8 [==============================] - 0s 32ms/step - loss: 0.3754 - acc: 0.9112
Epoch 9/28

8/8 [==============================] - 0s 33ms/step - loss: 0.3380 - acc: 0.8994
Epoch 10/28

8/8 [==============================] - 0s 32ms/step - loss: 0.3044 - acc: 0.9408
Epoch 11/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2891 - acc: 0.9527
Epoch 12/28

8/8 [==============================] - 0s 32ms/step - loss: 0.2361 - acc: 0.9763
Epoch 13/28

8/8 [==============================] - 0s 32ms/step - loss: 0.2228 - acc: 0.9645
Epoch 14/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2054 - acc: 0.9822
Epoch 15/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1928 - acc: 0.9704
Epoch 16/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1798 - acc: 0.9822
Epoch 17/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1528 - acc: 0.9882
Epoch 18/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1396 - acc: 0.9882
Epoch 19/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1271 - acc: 0.9882
Epoch 20/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1350 - acc: 0.9882
Epoch 21/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1234 - acc: 0.9882
Epoch 22/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1213 - acc: 0.9882
Epoch 23/28

8/8 [==============================] - 0s 32ms/step - loss: 0.0940 - acc: 1.0000
Epoch 24/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0983 - acc: 0.9941
Epoch 25/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0845 - acc: 1.0000
Epoch 26/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0779 - acc: 1.0000
Epoch 27/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0735 - acc: 0.9882
Epoch 28/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0670 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7340
False 1731
True percentage 0.80917208687
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.95      0.94      7318
      B-PER       0.48      0.39      0.43       438
      B-LOC       0.59      0.41      0.49       218
     B-MISC       0.00      0.00      0.00       141
     I-MISC       1.00      0.01      0.01       154
      B-ORG       0.32      0.31      0.32       296
      I-ORG       0.12      0.13      0.12       151
      I-LOC       0.49      0.24      0.32       141
      I-PER       0.67      0.05      0.09       214

avg / total       0.84      0.81      0.81      9071

F-1 Score (without O):
0.297963558414
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104046 unique words.
4042 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 559
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659008     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,138
Trainable params: 6,771,138
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 2s 236ms/step - loss: 2.4606 - acc: 0.1657
Epoch 2/28

8/8 [==============================] - 0s 33ms/step - loss: 1.2860 - acc: 0.6575
Epoch 3/28

8/8 [==============================] - 0s 33ms/step - loss: 0.9026 - acc: 0.6906
Epoch 4/28

8/8 [==============================] - 0s 33ms/step - loss: 0.8327 - acc: 0.8122
Epoch 5/28

8/8 [==============================] - 0s 33ms/step - loss: 0.7108 - acc: 0.7956
Epoch 6/28

8/8 [==============================] - 0s 33ms/step - loss: 0.6291 - acc: 0.8785
Epoch 7/28

8/8 [==============================] - 0s 33ms/step - loss: 0.5045 - acc: 0.9006
Epoch 8/28

8/8 [==============================] - 0s 33ms/step - loss: 0.4763 - acc: 0.9061
Epoch 9/28

8/8 [==============================] - 0s 33ms/step - loss: 0.3904 - acc: 0.9227
Epoch 10/28

8/8 [==============================] - 0s 32ms/step - loss: 0.3716 - acc: 0.9337
Epoch 11/28

8/8 [==============================] - 0s 32ms/step - loss: 0.3259 - acc: 0.9337
Epoch 12/28

8/8 [==============================] - 0s 32ms/step - loss: 0.3108 - acc: 0.9448
Epoch 13/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2647 - acc: 0.9337
Epoch 14/28

8/8 [==============================] - 0s 32ms/step - loss: 0.2638 - acc: 0.9448
Epoch 15/28

8/8 [==============================] - 0s 31ms/step - loss: 0.2429 - acc: 0.9558
Epoch 16/28

8/8 [==============================] - 0s 32ms/step - loss: 0.2280 - acc: 0.9669
Epoch 17/28

8/8 [==============================] - 0s 31ms/step - loss: 0.2003 - acc: 0.9613
Epoch 18/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1813 - acc: 0.9834
Epoch 19/28

8/8 [==============================] - 0s 31ms/step - loss: 0.1520 - acc: 0.9890
Epoch 20/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1336 - acc: 0.9890
Epoch 21/28

8/8 [==============================] - 0s 31ms/step - loss: 0.1505 - acc: 0.9890
Epoch 22/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1114 - acc: 0.9945
Epoch 23/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1053 - acc: 1.0000
Epoch 24/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1158 - acc: 0.9890
Epoch 25/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1025 - acc: 0.9890
Epoch 26/28

8/8 [==============================] - 0s 32ms/step - loss: 0.0994 - acc: 0.9945
Epoch 27/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0859 - acc: 1.0000
Epoch 28/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0826 - acc: 0.9945
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7080
False 1991
True percentage 0.780509315401
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.91      0.94      7318
      B-ORG       0.27      0.38      0.31       296
      I-ORG       0.14      0.47      0.22       151
      B-PER       0.38      0.24      0.29       438
      I-PER       0.32      0.36      0.34       214
      B-LOC       0.33      0.01      0.03       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.16      0.08      0.10       141
     I-MISC       0.23      0.06      0.10       154

avg / total       0.83      0.78      0.80      9071

F-1 Score (without O):
0.235329703569
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 8 unique labels.
Found 104043 unique words.
4039 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 564
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658816     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,796
Trainable params: 6,770,796
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 2s 245ms/step - loss: 2.0327 - acc: 0.2025
Epoch 2/28

8/8 [==============================] - 0s 33ms/step - loss: 0.7519 - acc: 0.8291
Epoch 3/28

8/8 [==============================] - 0s 32ms/step - loss: 0.6075 - acc: 0.8354
Epoch 4/28

8/8 [==============================] - 0s 33ms/step - loss: 0.5451 - acc: 0.8291
Epoch 5/28

8/8 [==============================] - 0s 33ms/step - loss: 0.4693 - acc: 0.8924
Epoch 6/28

8/8 [==============================] - 0s 33ms/step - loss: 0.3704 - acc: 0.8544
Epoch 7/28

8/8 [==============================] - 0s 33ms/step - loss: 0.3179 - acc: 0.9177
Epoch 8/28

8/8 [==============================] - 0s 32ms/step - loss: 0.2801 - acc: 0.9304
Epoch 9/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2528 - acc: 0.9367
Epoch 10/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2196 - acc: 0.9430
Epoch 11/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1973 - acc: 0.9873
Epoch 12/28

8/8 [==============================] - 0s 31ms/step - loss: 0.1688 - acc: 0.9684
Epoch 13/28

8/8 [==============================] - 0s 31ms/step - loss: 0.1855 - acc: 0.9873
Epoch 14/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1337 - acc: 1.0000
Epoch 15/28

8/8 [==============================] - 0s 31ms/step - loss: 0.1242 - acc: 0.9937
Epoch 16/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1039 - acc: 1.0000
Epoch 17/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1013 - acc: 1.0000
Epoch 18/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1000 - acc: 0.9937
Epoch 19/28

8/8 [==============================] - 0s 32ms/step - loss: 0.0834 - acc: 1.0000
Epoch 20/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0763 - acc: 1.0000
Epoch 21/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0617 - acc: 1.0000
Epoch 22/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0592 - acc: 1.0000
Epoch 23/28

8/8 [==============================] - 0s 32ms/step - loss: 0.0652 - acc: 1.0000
Epoch 24/28

8/8 [==============================] - 0s 32ms/step - loss: 0.0560 - acc: 1.0000
Epoch 25/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0506 - acc: 1.0000
Epoch 26/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0470 - acc: 1.0000
Epoch 27/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0411 - acc: 1.0000
Epoch 28/28

8/8 [==============================] - 0s 32ms/step - loss: 0.0415 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7102
False 1818
True percentage 0.796188340807
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.17      0.34      0.22       296
          O       0.94      0.93      0.94      7318
     B-MISC       0.10      0.01      0.02       141
     I-MISC       0.17      0.11      0.13       154
      B-LOC       0.39      0.22      0.28       218
      I-LOC       0.55      0.11      0.19       141
      B-PER       0.28      0.10      0.15       438
      I-PER       0.26      0.26      0.26       214

avg / total       0.82      0.80      0.80      8920

F-1 Score (without O):
0.847630001816
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 8 unique labels.
Found 104041 unique words.
4037 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 567
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658688     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,668
Trainable params: 6,770,668
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 2s 235ms/step - loss: 2.6200 - acc: 0.0738
Epoch 2/28

8/8 [==============================] - 0s 32ms/step - loss: 0.7002 - acc: 0.8658
Epoch 3/28

8/8 [==============================] - 0s 31ms/step - loss: 0.4778 - acc: 0.8591
Epoch 4/28

8/8 [==============================] - 0s 31ms/step - loss: 0.3891 - acc: 0.9060
Epoch 5/28

8/8 [==============================] - 0s 32ms/step - loss: 0.3407 - acc: 0.8792
Epoch 6/28

8/8 [==============================] - 0s 32ms/step - loss: 0.2914 - acc: 0.9195
Epoch 7/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2560 - acc: 0.8926
Epoch 8/28

8/8 [==============================] - 0s 31ms/step - loss: 0.2279 - acc: 0.9530
Epoch 9/28

8/8 [==============================] - 0s 31ms/step - loss: 0.2085 - acc: 0.9262
Epoch 10/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1924 - acc: 0.9597
Epoch 11/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1601 - acc: 0.9597
Epoch 12/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1473 - acc: 0.9732
Epoch 13/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1264 - acc: 0.9799
Epoch 14/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1217 - acc: 0.9866
Epoch 15/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1175 - acc: 0.9799
Epoch 16/28

8/8 [==============================] - 0s 32ms/step - loss: 0.0979 - acc: 1.0000
Epoch 17/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0808 - acc: 1.0000
Epoch 18/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1007 - acc: 0.9799
Epoch 19/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0970 - acc: 0.9866
Epoch 20/28

8/8 [==============================] - 0s 32ms/step - loss: 0.0806 - acc: 0.9933
Epoch 21/28

8/8 [==============================] - 0s 32ms/step - loss: 0.0668 - acc: 1.0000
Epoch 22/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0722 - acc: 0.9866
Epoch 23/28

8/8 [==============================] - 0s 32ms/step - loss: 0.0564 - acc: 1.0000
Epoch 24/28

8/8 [==============================] - 0s 32ms/step - loss: 0.0612 - acc: 0.9933
Epoch 25/28

8/8 [==============================] - 0s 32ms/step - loss: 0.0443 - acc: 1.0000
Epoch 26/28

8/8 [==============================] - 0s 32ms/step - loss: 0.0556 - acc: 0.9933
Epoch 27/28

8/8 [==============================] - 0s 32ms/step - loss: 0.0508 - acc: 1.0000
Epoch 28/28

8/8 [==============================] - 0s 31ms/step - loss: 0.0381 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7149
False 1781
True percentage 0.800559910414
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.89      0.94      0.92      7318
      B-PER       0.43      0.18      0.26       438
      B-ORG       0.25      0.35      0.29       296
     B-MISC       0.06      0.01      0.02       141
      I-PER       0.32      0.14      0.20       214
      I-ORG       0.00      0.00      0.00       151
     I-MISC       0.09      0.01      0.01       154
      B-LOC       0.67      0.08      0.15       218

avg / total       0.79      0.80      0.78      8930

F-1 Score (without O):
0.199327165685
