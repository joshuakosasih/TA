Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.3902 - acc: 0.8816
Epoch 2/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.2302 - acc: 0.9293
Epoch 3/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.1820 - acc: 0.9462
Epoch 4/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.1516 - acc: 0.9562
Epoch 5/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.1306 - acc: 0.9618
Epoch 6/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.1138 - acc: 0.9673
Epoch 7/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.1011 - acc: 0.9709
Epoch 8/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0922 - acc: 0.9736
Epoch 9/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0831 - acc: 0.9764
Epoch 10/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0747 - acc: 0.9786
Epoch 11/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0693 - acc: 0.9801
Epoch 12/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0632 - acc: 0.9823
Epoch 13/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0588 - acc: 0.9829
Epoch 14/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0549 - acc: 0.9848
Epoch 15/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0535 - acc: 0.9848
Epoch 16/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0482 - acc: 0.9862
Epoch 17/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0454 - acc: 0.9875
Epoch 18/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0438 - acc: 0.9882
Epoch 19/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0418 - acc: 0.9881
Epoch 20/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0395 - acc: 0.9885
Epoch 21/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0375 - acc: 0.9892
Epoch 22/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0364 - acc: 0.9892
Epoch 23/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0338 - acc: 0.9901
Epoch 24/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0335 - acc: 0.9902
Epoch 25/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0307 - acc: 0.9911
Epoch 26/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0307 - acc: 0.9909
Epoch 27/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0293 - acc: 0.9912
Epoch 28/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0278 - acc: 0.9916
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8252
False 819
True percentage 0.909712269871
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-LOC       0.75      0.75      0.75       218
      I-LOC       0.78      0.77      0.78       141
      B-PER       0.90      0.84      0.87       438
      B-ORG       0.74      0.73      0.73       296
      I-ORG       0.69      0.64      0.66       151
     B-MISC       0.42      0.33      0.37       141
     I-MISC       0.53      0.46      0.49       154
      I-PER       0.88      0.66      0.76       214

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.720833333333
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.4090 - acc: 0.8753
Epoch 2/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.2353 - acc: 0.9286
Epoch 3/28

1674/1674 [==============================] - 44s 27ms/step - loss: 0.1867 - acc: 0.9435
Epoch 4/28

1674/1674 [==============================] - 44s 27ms/step - loss: 0.1566 - acc: 0.9525
Epoch 5/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1336 - acc: 0.9606
Epoch 6/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1177 - acc: 0.9650
Epoch 7/28

1674/1674 [==============================] - 44s 27ms/step - loss: 0.1036 - acc: 0.9697
Epoch 8/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0932 - acc: 0.9726
Epoch 9/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0849 - acc: 0.9759
Epoch 10/28

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0786 - acc: 0.9777
Epoch 11/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0726 - acc: 0.9797
Epoch 12/28

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0673 - acc: 0.9811
Epoch 13/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0631 - acc: 0.9822
Epoch 14/28

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0594 - acc: 0.9835
Epoch 15/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0541 - acc: 0.9845
Epoch 16/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0520 - acc: 0.9850
Epoch 17/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0466 - acc: 0.9874
Epoch 18/28

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0449 - acc: 0.9871
Epoch 19/28

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0424 - acc: 0.9876
Epoch 20/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0397 - acc: 0.9891
Epoch 21/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0387 - acc: 0.9890
Epoch 22/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0366 - acc: 0.9894
Epoch 23/28

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0369 - acc: 0.9894
Epoch 24/28

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0341 - acc: 0.9897
Epoch 25/28

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0325 - acc: 0.9905
Epoch 26/28

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0307 - acc: 0.9920
Epoch 27/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0297 - acc: 0.9917
Epoch 28/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0287 - acc: 0.9921
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8268
False 803
True percentage 0.911476132731
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.90      0.85      0.87       438
      I-PER       0.92      0.66      0.77       214
          O       0.98      0.96      0.97      7318
      B-ORG       0.75      0.76      0.76       296
      I-ORG       0.64      0.65      0.64       151
      B-LOC       0.76      0.76      0.76       218
      I-LOC       0.75      0.79      0.77       141
     B-MISC       0.46      0.30      0.37       141
     I-MISC       0.54      0.44      0.49       154

avg / total       0.94      0.91      0.93      9071

F-1 Score (without O):
0.930372290292
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.3937 - acc: 0.8782
Epoch 2/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.2398 - acc: 0.9266
Epoch 3/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1898 - acc: 0.9428
Epoch 4/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1587 - acc: 0.9526
Epoch 5/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1331 - acc: 0.9617
Epoch 6/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1177 - acc: 0.9652
Epoch 7/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1061 - acc: 0.9696
Epoch 8/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0934 - acc: 0.9734
Epoch 9/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0846 - acc: 0.9761
Epoch 10/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0780 - acc: 0.9777
Epoch 11/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0715 - acc: 0.9793
Epoch 12/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0664 - acc: 0.9814
Epoch 13/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0641 - acc: 0.9816
Epoch 14/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0587 - acc: 0.9834
Epoch 15/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0528 - acc: 0.9856
Epoch 16/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0498 - acc: 0.9860
Epoch 17/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0482 - acc: 0.9868
Epoch 18/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0456 - acc: 0.9870
Epoch 19/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0422 - acc: 0.9886
Epoch 20/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0403 - acc: 0.9886
Epoch 21/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0401 - acc: 0.9890
Epoch 22/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0378 - acc: 0.9891
Epoch 23/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0348 - acc: 0.9899
Epoch 24/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0330 - acc: 0.9902
Epoch 25/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0318 - acc: 0.9911
Epoch 26/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0303 - acc: 0.9917
Epoch 27/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0291 - acc: 0.9920
Epoch 28/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0285 - acc: 0.9919
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8250
False 821
True percentage 0.909491787014
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
      B-PER       0.89      0.81      0.85       438
      B-LOC       0.73      0.75      0.74       218
     B-MISC       0.48      0.29      0.36       141
     I-MISC       0.55      0.41      0.47       154
      B-ORG       0.71      0.74      0.73       296
      I-ORG       0.63      0.66      0.64       151
      I-LOC       0.73      0.82      0.78       141
      I-PER       0.90      0.66      0.76       214

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.714328269288
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.3898 - acc: 0.8812
Epoch 2/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.2301 - acc: 0.9302
Epoch 3/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1808 - acc: 0.9469
Epoch 4/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1506 - acc: 0.9557
Epoch 5/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1286 - acc: 0.9621
Epoch 6/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1130 - acc: 0.9681
Epoch 7/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1005 - acc: 0.9717
Epoch 8/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0884 - acc: 0.9754
Epoch 9/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0816 - acc: 0.9768
Epoch 10/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0729 - acc: 0.9802
Epoch 11/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0674 - acc: 0.9809
Epoch 12/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0623 - acc: 0.9832
Epoch 13/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0577 - acc: 0.9843
Epoch 14/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0544 - acc: 0.9843
Epoch 15/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0509 - acc: 0.9855
Epoch 16/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0476 - acc: 0.9865
Epoch 17/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0447 - acc: 0.9878
Epoch 18/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0424 - acc: 0.9884
Epoch 19/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0404 - acc: 0.9886
Epoch 20/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0374 - acc: 0.9895
Epoch 21/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0369 - acc: 0.9893
Epoch 22/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0359 - acc: 0.9892
Epoch 23/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0342 - acc: 0.9903
Epoch 24/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0316 - acc: 0.9909
Epoch 25/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0310 - acc: 0.9912
Epoch 26/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0300 - acc: 0.9914
Epoch 27/28

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0286 - acc: 0.9919
Epoch 28/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0275 - acc: 0.9921
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8260
False 811
True percentage 0.910594201301
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.78      0.73      0.76       296
      I-ORG       0.67      0.64      0.66       151
      B-PER       0.88      0.84      0.86       438
      I-PER       0.92      0.66      0.77       214
      B-LOC       0.79      0.74      0.76       218
      I-LOC       0.74      0.77      0.76       141
     B-MISC       0.45      0.35      0.40       141
     I-MISC       0.53      0.47      0.49       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.725912627169
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.3796 - acc: 0.8828
Epoch 2/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.2240 - acc: 0.9320
Epoch 3/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1763 - acc: 0.9475
Epoch 4/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1494 - acc: 0.9548
Epoch 5/28

1674/1674 [==============================] - 44s 27ms/step - loss: 0.1269 - acc: 0.9623
Epoch 6/28

1674/1674 [==============================] - 44s 27ms/step - loss: 0.1114 - acc: 0.9668
Epoch 7/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0989 - acc: 0.9706
Epoch 8/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0884 - acc: 0.9737
Epoch 9/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0808 - acc: 0.9766
Epoch 10/28

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0740 - acc: 0.9787
Epoch 11/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0679 - acc: 0.9803
Epoch 12/28

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0622 - acc: 0.9824
Epoch 13/28

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0604 - acc: 0.9820
Epoch 14/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0551 - acc: 0.9837
Epoch 15/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0531 - acc: 0.9844
Epoch 16/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0473 - acc: 0.9864
Epoch 17/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0463 - acc: 0.9862
Epoch 18/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0424 - acc: 0.9881
Epoch 19/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0406 - acc: 0.9881
Epoch 20/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0388 - acc: 0.9893
Epoch 21/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0384 - acc: 0.9890
Epoch 22/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0370 - acc: 0.9892
Epoch 23/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0338 - acc: 0.9899
Epoch 24/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0323 - acc: 0.9908
Epoch 25/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0302 - acc: 0.9916
Epoch 26/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0287 - acc: 0.9917
Epoch 27/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0284 - acc: 0.9921
Epoch 28/28

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0274 - acc: 0.9922
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8250
False 821
True percentage 0.909491787014
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.75      0.74      0.74       296
      I-ORG       0.65      0.56      0.60       151
      B-PER       0.90      0.84      0.87       438
      I-PER       0.93      0.67      0.78       214
     B-MISC       0.40      0.28      0.33       141
     I-MISC       0.52      0.42      0.46       154
      B-LOC       0.73      0.73      0.73       218
      I-LOC       0.76      0.82      0.79       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.717286914766
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.4140 - acc: 0.8735
Epoch 2/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.2425 - acc: 0.9248
Epoch 3/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.1916 - acc: 0.9429
Epoch 4/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.1601 - acc: 0.9527
Epoch 5/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.1387 - acc: 0.9596
Epoch 6/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.1206 - acc: 0.9642
Epoch 7/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.1098 - acc: 0.9677
Epoch 8/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0975 - acc: 0.9719
Epoch 9/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0900 - acc: 0.9738
Epoch 10/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0804 - acc: 0.9770
Epoch 11/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0737 - acc: 0.9784
Epoch 12/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0684 - acc: 0.9809
Epoch 13/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0655 - acc: 0.9814
Epoch 14/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0614 - acc: 0.9831
Epoch 15/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0559 - acc: 0.9841
Epoch 16/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0537 - acc: 0.9850
Epoch 17/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0483 - acc: 0.9867
Epoch 18/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0461 - acc: 0.9876
Epoch 19/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0451 - acc: 0.9873
Epoch 20/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0419 - acc: 0.9881
Epoch 21/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0399 - acc: 0.9890
Epoch 22/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0387 - acc: 0.9891
Epoch 23/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0362 - acc: 0.9895
Epoch 24/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0365 - acc: 0.9897
Epoch 25/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0341 - acc: 0.9905
Epoch 26/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0331 - acc: 0.9909
Epoch 27/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0312 - acc: 0.9915
Epoch 28/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0305 - acc: 0.9915
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8244
False 827
True percentage 0.908830338441
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.89      0.85      0.87       438
          O       0.98      0.96      0.97      7318
      B-LOC       0.73      0.71      0.72       218
      B-ORG       0.75      0.74      0.75       296
      I-PER       0.96      0.65      0.77       214
     B-MISC       0.41      0.30      0.35       141
     I-MISC       0.59      0.47      0.53       154
      I-ORG       0.61      0.63      0.62       151
      I-LOC       0.70      0.75      0.73       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.927536231884
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 49s 29ms/step - loss: 0.4038 - acc: 0.8766
Epoch 2/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.2364 - acc: 0.9288
Epoch 3/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.1877 - acc: 0.9438
Epoch 4/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.1564 - acc: 0.9536
Epoch 5/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.1314 - acc: 0.9625
Epoch 6/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.1172 - acc: 0.9663
Epoch 7/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.1042 - acc: 0.9701
Epoch 8/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0960 - acc: 0.9721
Epoch 9/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0843 - acc: 0.9763
Epoch 10/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0802 - acc: 0.9768
Epoch 11/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0720 - acc: 0.9796
Epoch 12/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0680 - acc: 0.9805
Epoch 13/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0627 - acc: 0.9818
Epoch 14/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0566 - acc: 0.9845
Epoch 15/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0547 - acc: 0.9840
Epoch 16/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0524 - acc: 0.9849
Epoch 17/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0494 - acc: 0.9858
Epoch 18/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0455 - acc: 0.9867
Epoch 19/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0440 - acc: 0.9872
Epoch 20/28

1674/1674 [==============================] - 48s 28ms/step - loss: 0.0416 - acc: 0.9881
Epoch 21/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0401 - acc: 0.9890
Epoch 22/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0371 - acc: 0.9894
Epoch 23/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0358 - acc: 0.9898
Epoch 24/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0359 - acc: 0.9893
Epoch 25/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0335 - acc: 0.9907
Epoch 26/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0323 - acc: 0.9907
Epoch 27/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0309 - acc: 0.9912
Epoch 28/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0286 - acc: 0.9923
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8232
False 839
True percentage 0.907507441296
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
     B-MISC       0.41      0.33      0.37       141
      B-ORG       0.73      0.73      0.73       296
     I-MISC       0.51      0.42      0.46       154
      B-LOC       0.77      0.74      0.75       218
      I-ORG       0.61      0.61      0.61       151
      B-PER       0.91      0.84      0.87       438
      I-PER       0.93      0.64      0.76       214
      I-LOC       0.70      0.77      0.73       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.710674992566
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 48s 29ms/step - loss: 0.4095 - acc: 0.8747
Epoch 2/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.2383 - acc: 0.9289
Epoch 3/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.1842 - acc: 0.9458
Epoch 4/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.1541 - acc: 0.9549
Epoch 5/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.1302 - acc: 0.9614
Epoch 6/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.1159 - acc: 0.9656
Epoch 7/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.1040 - acc: 0.9699
Epoch 8/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0927 - acc: 0.9731
Epoch 9/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0836 - acc: 0.9756
Epoch 10/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0779 - acc: 0.9784
Epoch 11/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0700 - acc: 0.9815
Epoch 12/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0671 - acc: 0.9805
Epoch 13/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0618 - acc: 0.9824
Epoch 14/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0562 - acc: 0.9844
Epoch 15/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0547 - acc: 0.9849
Epoch 16/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0503 - acc: 0.9861
Epoch 17/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0464 - acc: 0.9872
Epoch 18/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0442 - acc: 0.9876
Epoch 19/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0418 - acc: 0.9880
Epoch 20/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0407 - acc: 0.9889
Epoch 21/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0377 - acc: 0.9899
Epoch 22/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0358 - acc: 0.9901
Epoch 23/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0342 - acc: 0.9906
Epoch 24/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0333 - acc: 0.9900
Epoch 25/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0307 - acc: 0.9913
Epoch 26/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0292 - acc: 0.9919
Epoch 27/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0289 - acc: 0.9919
Epoch 28/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0291 - acc: 0.9919
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8261
False 810
True percentage 0.91070444273
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.76      0.74      0.75       296
          O       0.99      0.96      0.97      7318
     B-MISC       0.47      0.33      0.38       141
     I-MISC       0.52      0.45      0.49       154
      B-LOC       0.73      0.77      0.75       218
      I-LOC       0.70      0.81      0.75       141
      B-PER       0.91      0.83      0.87       438
      I-PER       0.91      0.65      0.76       214
      I-ORG       0.68      0.64      0.66       151

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.932784318274
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.4123 - acc: 0.8730
Epoch 2/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.2423 - acc: 0.9262
Epoch 3/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1933 - acc: 0.9414
Epoch 4/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.1639 - acc: 0.9506
Epoch 5/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1429 - acc: 0.9575
Epoch 6/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1253 - acc: 0.9630
Epoch 7/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.1106 - acc: 0.9675
Epoch 8/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0991 - acc: 0.9712
Epoch 9/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0926 - acc: 0.9726
Epoch 10/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0841 - acc: 0.9753
Epoch 11/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0751 - acc: 0.9793
Epoch 12/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0721 - acc: 0.9797
Epoch 13/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0650 - acc: 0.9822
Epoch 14/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0609 - acc: 0.9839
Epoch 15/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0564 - acc: 0.9848
Epoch 16/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0540 - acc: 0.9852
Epoch 17/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0495 - acc: 0.9866
Epoch 18/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0479 - acc: 0.9868
Epoch 19/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0451 - acc: 0.9875
Epoch 20/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0422 - acc: 0.9878
Epoch 21/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0417 - acc: 0.9885
Epoch 22/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0380 - acc: 0.9896
Epoch 23/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0361 - acc: 0.9899
Epoch 24/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0364 - acc: 0.9897
Epoch 25/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0328 - acc: 0.9904
Epoch 26/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0336 - acc: 0.9902
Epoch 27/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0312 - acc: 0.9910
Epoch 28/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0295 - acc: 0.9917
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8247
False 824
True percentage 0.909161062727
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.90      0.84      0.87       438
      B-ORG       0.78      0.73      0.75       296
     B-MISC       0.43      0.35      0.39       141
      I-PER       0.93      0.64      0.76       214
      I-ORG       0.62      0.62      0.62       151
     I-MISC       0.51      0.49      0.50       154
      B-LOC       0.75      0.75      0.75       218
      I-LOC       0.75      0.77      0.76       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.719428741446
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104754 unique words.
4750 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 246
OOV word occurences: in test 365
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6704320     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,816,450
Trainable params: 6,816,450
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 26s 31ms/step - loss: 0.5020 - acc: 0.8462
Epoch 2/28

837/837 [==============================] - 24s 29ms/step - loss: 0.3046 - acc: 0.9078
Epoch 3/28

837/837 [==============================] - 24s 29ms/step - loss: 0.2464 - acc: 0.9272
Epoch 4/28

837/837 [==============================] - 24s 29ms/step - loss: 0.2135 - acc: 0.9381
Epoch 5/28

837/837 [==============================] - 24s 28ms/step - loss: 0.1828 - acc: 0.9478
Epoch 6/28

837/837 [==============================] - 24s 29ms/step - loss: 0.1614 - acc: 0.9533
Epoch 7/28

837/837 [==============================] - 24s 29ms/step - loss: 0.1450 - acc: 0.9601
Epoch 8/28

837/837 [==============================] - 24s 29ms/step - loss: 0.1298 - acc: 0.9637
Epoch 9/28

837/837 [==============================] - 24s 29ms/step - loss: 0.1164 - acc: 0.9675
Epoch 10/28

837/837 [==============================] - 24s 28ms/step - loss: 0.1069 - acc: 0.9706
Epoch 11/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0986 - acc: 0.9734
Epoch 12/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0907 - acc: 0.9737
Epoch 13/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0835 - acc: 0.9769
Epoch 14/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0742 - acc: 0.9801
Epoch 15/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0707 - acc: 0.9809
Epoch 16/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0669 - acc: 0.9816
Epoch 17/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0613 - acc: 0.9830
Epoch 18/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0579 - acc: 0.9845
Epoch 19/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0545 - acc: 0.9859
Epoch 20/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0519 - acc: 0.9861
Epoch 21/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0488 - acc: 0.9873
Epoch 22/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0450 - acc: 0.9875
Epoch 23/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0432 - acc: 0.9874
Epoch 24/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0401 - acc: 0.9892
Epoch 25/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0390 - acc: 0.9896
Epoch 26/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0367 - acc: 0.9903
Epoch 27/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0348 - acc: 0.9916
Epoch 28/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0334 - acc: 0.9912
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8124
False 947
True percentage 0.895601366994
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-LOC       0.74      0.73      0.74       218
      I-LOC       0.71      0.79      0.75       141
      B-PER       0.89      0.78      0.83       438
      B-ORG       0.70      0.69      0.69       296
      I-ORG       0.59      0.47      0.52       151
     B-MISC       0.48      0.21      0.29       141
     I-MISC       0.38      0.34      0.36       154
      I-PER       0.84      0.58      0.69       214

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.67013145827
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104724 unique words.
4720 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 245
OOV word occurences: in test 381
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6702400     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,814,530
Trainable params: 6,814,530
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 26s 31ms/step - loss: 0.4990 - acc: 0.8455
Epoch 2/28

837/837 [==============================] - 24s 28ms/step - loss: 0.2973 - acc: 0.9111
Epoch 3/28

837/837 [==============================] - 24s 28ms/step - loss: 0.2415 - acc: 0.9280
Epoch 4/28

837/837 [==============================] - 24s 28ms/step - loss: 0.1978 - acc: 0.9424
Epoch 5/28

837/837 [==============================] - 24s 28ms/step - loss: 0.1731 - acc: 0.9496
Epoch 6/28

837/837 [==============================] - 24s 28ms/step - loss: 0.1530 - acc: 0.9554
Epoch 7/28

837/837 [==============================] - 24s 28ms/step - loss: 0.1366 - acc: 0.9602
Epoch 8/28

837/837 [==============================] - 24s 28ms/step - loss: 0.1220 - acc: 0.9670
Epoch 9/28

837/837 [==============================] - 24s 28ms/step - loss: 0.1079 - acc: 0.9706
Epoch 10/28

837/837 [==============================] - 24s 29ms/step - loss: 0.1016 - acc: 0.9713
Epoch 11/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0912 - acc: 0.9749
Epoch 12/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0861 - acc: 0.9768
Epoch 13/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0758 - acc: 0.9803
Epoch 14/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0709 - acc: 0.9813
Epoch 15/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0657 - acc: 0.9822
Epoch 16/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0602 - acc: 0.9844
Epoch 17/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0584 - acc: 0.9844
Epoch 18/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0522 - acc: 0.9870
Epoch 19/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0499 - acc: 0.9863
Epoch 20/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0485 - acc: 0.9875
Epoch 21/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0441 - acc: 0.9883
Epoch 22/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0421 - acc: 0.9893
Epoch 23/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0416 - acc: 0.9890
Epoch 24/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0393 - acc: 0.9902
Epoch 25/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0365 - acc: 0.9913
Epoch 26/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0343 - acc: 0.9911
Epoch 27/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0320 - acc: 0.9916
Epoch 28/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0314 - acc: 0.9918
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8132
False 939
True percentage 0.896483298424
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.88      0.73      0.80       438
      I-PER       0.92      0.64      0.76       214
          O       0.98      0.96      0.97      7318
      B-ORG       0.66      0.71      0.69       296
      I-ORG       0.54      0.56      0.55       151
      B-LOC       0.76      0.73      0.75       218
      I-LOC       0.70      0.77      0.73       141
     B-MISC       0.40      0.26      0.31       141
     I-MISC       0.53      0.32      0.40       154

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.921280735892
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104723 unique words.
4719 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 247
OOV word occurences: in test 373
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6702336     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,814,466
Trainable params: 6,814,466
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 25s 29ms/step - loss: 0.5094 - acc: 0.8421
Epoch 2/28

837/837 [==============================] - 23s 27ms/step - loss: 0.2977 - acc: 0.9112
Epoch 3/28

837/837 [==============================] - 23s 27ms/step - loss: 0.2401 - acc: 0.9294
Epoch 4/28

837/837 [==============================] - 23s 27ms/step - loss: 0.2043 - acc: 0.9384
Epoch 5/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1763 - acc: 0.9483
Epoch 6/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1574 - acc: 0.9542
Epoch 7/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1368 - acc: 0.9597
Epoch 8/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1237 - acc: 0.9639
Epoch 9/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1102 - acc: 0.9691
Epoch 10/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1001 - acc: 0.9713
Epoch 11/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0916 - acc: 0.9738
Epoch 12/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0843 - acc: 0.9762
Epoch 13/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0771 - acc: 0.9787
Epoch 14/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0711 - acc: 0.9815
Epoch 15/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0665 - acc: 0.9825
Epoch 16/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0619 - acc: 0.9836
Epoch 17/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0589 - acc: 0.9846
Epoch 18/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0551 - acc: 0.9856
Epoch 19/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0511 - acc: 0.9863
Epoch 20/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0459 - acc: 0.9884
Epoch 21/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0446 - acc: 0.9880
Epoch 22/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0427 - acc: 0.9890
Epoch 23/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0390 - acc: 0.9900
Epoch 24/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0360 - acc: 0.9905
Epoch 25/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0367 - acc: 0.9907
Epoch 26/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0342 - acc: 0.9911
Epoch 27/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0332 - acc: 0.9912
Epoch 28/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0315 - acc: 0.9922
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8109
False 962
True percentage 0.893947745563
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.86      0.73      0.79       438
      B-LOC       0.72      0.65      0.69       218
     B-MISC       0.42      0.32      0.36       141
     I-MISC       0.46      0.44      0.45       154
      B-ORG       0.69      0.73      0.71       296
      I-ORG       0.51      0.59      0.55       151
      I-LOC       0.86      0.68      0.76       141
      I-PER       0.90      0.62      0.73       214

avg / total       0.93      0.89      0.91      9071

F-1 Score (without O):
0.667671893848
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104674 unique words.
4670 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 246
OOV word occurences: in test 375
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6699200     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,811,330
Trainable params: 6,811,330
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 25s 30ms/step - loss: 0.5068 - acc: 0.8476
Epoch 2/28

837/837 [==============================] - 24s 28ms/step - loss: 0.2927 - acc: 0.9124
Epoch 3/28

837/837 [==============================] - 24s 28ms/step - loss: 0.2319 - acc: 0.9305
Epoch 4/28

837/837 [==============================] - 24s 28ms/step - loss: 0.2024 - acc: 0.9395
Epoch 5/28

837/837 [==============================] - 24s 28ms/step - loss: 0.1734 - acc: 0.9495
Epoch 6/28

837/837 [==============================] - 24s 28ms/step - loss: 0.1527 - acc: 0.9558
Epoch 7/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1365 - acc: 0.9607
Epoch 8/28

837/837 [==============================] - 24s 28ms/step - loss: 0.1207 - acc: 0.9675
Epoch 9/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1106 - acc: 0.9687
Epoch 10/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1002 - acc: 0.9729
Epoch 11/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0903 - acc: 0.9771
Epoch 12/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0852 - acc: 0.9775
Epoch 13/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0779 - acc: 0.9793
Epoch 14/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0707 - acc: 0.9812
Epoch 15/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0667 - acc: 0.9820
Epoch 16/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0606 - acc: 0.9841
Epoch 17/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0583 - acc: 0.9842
Epoch 18/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0554 - acc: 0.9854
Epoch 19/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0519 - acc: 0.9851
Epoch 20/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0496 - acc: 0.9875
Epoch 21/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0462 - acc: 0.9878
Epoch 22/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0429 - acc: 0.9895
Epoch 23/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0392 - acc: 0.9902
Epoch 24/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0403 - acc: 0.9896
Epoch 25/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0370 - acc: 0.9906
Epoch 26/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0356 - acc: 0.9909
Epoch 27/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0348 - acc: 0.9920
Epoch 28/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0308 - acc: 0.9920
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8092
False 979
True percentage 0.892073641274
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.67      0.72      0.69       296
      I-ORG       0.48      0.55      0.51       151
      B-PER       0.85      0.71      0.78       438
      I-PER       0.90      0.63      0.74       214
      B-LOC       0.71      0.68      0.70       218
      I-LOC       0.66      0.70      0.68       141
     B-MISC       0.43      0.28      0.34       141
     I-MISC       0.49      0.33      0.39       154

avg / total       0.93      0.89      0.91      9071

F-1 Score (without O):
0.651793789569
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104718 unique words.
4714 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 245
OOV word occurences: in test 376
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6702016     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,814,146
Trainable params: 6,814,146
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 25s 30ms/step - loss: 0.4794 - acc: 0.8529
Epoch 2/28

837/837 [==============================] - 23s 28ms/step - loss: 0.2753 - acc: 0.9170
Epoch 3/28

837/837 [==============================] - 23s 28ms/step - loss: 0.2221 - acc: 0.9329
Epoch 4/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1851 - acc: 0.9458
Epoch 5/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1604 - acc: 0.9531
Epoch 6/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1444 - acc: 0.9586
Epoch 7/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1276 - acc: 0.9633
Epoch 8/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1142 - acc: 0.9685
Epoch 9/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1018 - acc: 0.9717
Epoch 10/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0937 - acc: 0.9746
Epoch 11/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0863 - acc: 0.9772
Epoch 12/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0797 - acc: 0.9776
Epoch 13/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0716 - acc: 0.9811
Epoch 14/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0641 - acc: 0.9820
Epoch 15/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0620 - acc: 0.9833
Epoch 16/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0567 - acc: 0.9855
Epoch 17/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0539 - acc: 0.9862
Epoch 18/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0507 - acc: 0.9867
Epoch 19/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0473 - acc: 0.9871
Epoch 20/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0420 - acc: 0.9882
Epoch 21/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0410 - acc: 0.9891
Epoch 22/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0385 - acc: 0.9899
Epoch 23/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0361 - acc: 0.9910
Epoch 24/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0351 - acc: 0.9905
Epoch 25/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0328 - acc: 0.9909
Epoch 26/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0318 - acc: 0.9914
Epoch 27/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0298 - acc: 0.9924
Epoch 28/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0299 - acc: 0.9918
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8128
False 943
True percentage 0.896042332709
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.68      0.73      0.70       296
      I-ORG       0.56      0.53      0.54       151
      B-PER       0.89      0.75      0.82       438
      I-PER       0.90      0.65      0.75       214
     B-MISC       0.49      0.29      0.36       141
     I-MISC       0.54      0.37      0.44       154
      B-LOC       0.65      0.70      0.67       218
      I-LOC       0.66      0.73      0.70       141

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.673088500903
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104744 unique words.
4740 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 241
OOV word occurences: in test 342
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6703680     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,815,810
Trainable params: 6,815,810
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 26s 31ms/step - loss: 0.5082 - acc: 0.8419
Epoch 2/28

837/837 [==============================] - 24s 28ms/step - loss: 0.3065 - acc: 0.9070
Epoch 3/28

837/837 [==============================] - 24s 28ms/step - loss: 0.2497 - acc: 0.9255
Epoch 4/28

837/837 [==============================] - 24s 28ms/step - loss: 0.2108 - acc: 0.9380
Epoch 5/28

837/837 [==============================] - 24s 29ms/step - loss: 0.1801 - acc: 0.9474
Epoch 6/28

837/837 [==============================] - 24s 28ms/step - loss: 0.1563 - acc: 0.9544
Epoch 7/28

837/837 [==============================] - 24s 28ms/step - loss: 0.1370 - acc: 0.9625
Epoch 8/28

837/837 [==============================] - 24s 28ms/step - loss: 0.1251 - acc: 0.9658
Epoch 9/28

837/837 [==============================] - 24s 28ms/step - loss: 0.1106 - acc: 0.9693
Epoch 10/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0989 - acc: 0.9737
Epoch 11/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0895 - acc: 0.9758
Epoch 12/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0850 - acc: 0.9777
Epoch 13/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0740 - acc: 0.9807
Epoch 14/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0694 - acc: 0.9819
Epoch 15/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0662 - acc: 0.9825
Epoch 16/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0612 - acc: 0.9846
Epoch 17/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0584 - acc: 0.9842
Epoch 18/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0533 - acc: 0.9850
Epoch 19/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0486 - acc: 0.9879
Epoch 20/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0461 - acc: 0.9885
Epoch 21/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0457 - acc: 0.9879
Epoch 22/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0431 - acc: 0.9889
Epoch 23/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0394 - acc: 0.9904
Epoch 24/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0378 - acc: 0.9905
Epoch 25/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0352 - acc: 0.9915
Epoch 26/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0328 - acc: 0.9919
Epoch 27/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0312 - acc: 0.9928
Epoch 28/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0309 - acc: 0.9927
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8152
False 919
True percentage 0.898688126998
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.90      0.79      0.84       438
          O       0.98      0.96      0.97      7318
      B-LOC       0.71      0.73      0.72       218
      B-ORG       0.68      0.73      0.70       296
      I-PER       0.84      0.62      0.71       214
     B-MISC       0.49      0.26      0.34       141
     I-MISC       0.52      0.29      0.37       154
      I-ORG       0.54      0.66      0.59       151
      I-LOC       0.61      0.78      0.69       141

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.919660737425
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104715 unique words.
4711 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 244
OOV word occurences: in test 354
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6701824     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,813,954
Trainable params: 6,813,954
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 25s 30ms/step - loss: 0.5090 - acc: 0.8471
Epoch 2/28

837/837 [==============================] - 24s 28ms/step - loss: 0.2905 - acc: 0.9138
Epoch 3/28

837/837 [==============================] - 24s 28ms/step - loss: 0.2325 - acc: 0.9304
Epoch 4/28

837/837 [==============================] - 24s 29ms/step - loss: 0.1943 - acc: 0.9437
Epoch 5/28

837/837 [==============================] - 24s 28ms/step - loss: 0.1662 - acc: 0.9526
Epoch 6/28

837/837 [==============================] - 24s 28ms/step - loss: 0.1470 - acc: 0.9575
Epoch 7/28

837/837 [==============================] - 24s 28ms/step - loss: 0.1313 - acc: 0.9631
Epoch 8/28

837/837 [==============================] - 24s 28ms/step - loss: 0.1161 - acc: 0.9666
Epoch 9/28

837/837 [==============================] - 24s 29ms/step - loss: 0.1056 - acc: 0.9711
Epoch 10/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0972 - acc: 0.9721
Epoch 11/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0902 - acc: 0.9748
Epoch 12/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0810 - acc: 0.9778
Epoch 13/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0739 - acc: 0.9807
Epoch 14/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0704 - acc: 0.9806
Epoch 15/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0661 - acc: 0.9823
Epoch 16/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0612 - acc: 0.9834
Epoch 17/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0540 - acc: 0.9863
Epoch 18/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0525 - acc: 0.9863
Epoch 19/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0513 - acc: 0.9863
Epoch 20/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0446 - acc: 0.9887
Epoch 21/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0420 - acc: 0.9898
Epoch 22/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0406 - acc: 0.9897
Epoch 23/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0380 - acc: 0.9903
Epoch 24/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0374 - acc: 0.9903
Epoch 25/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0353 - acc: 0.9910
Epoch 26/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0331 - acc: 0.9922
Epoch 27/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0317 - acc: 0.9918
Epoch 28/28

837/837 [==============================] - 24s 29ms/step - loss: 0.0312 - acc: 0.9918
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8158
False 913
True percentage 0.89934957557
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
     B-MISC       0.43      0.30      0.36       141
      B-ORG       0.68      0.68      0.68       296
     I-MISC       0.51      0.44      0.47       154
      B-LOC       0.76      0.69      0.73       218
      I-ORG       0.54      0.54      0.54       151
      B-PER       0.90      0.82      0.86       438
      I-PER       0.89      0.63      0.74       214
      I-LOC       0.78      0.74      0.76       141

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.6898008449
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104740 unique words.
4736 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 245
OOV word occurences: in test 354
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6703424     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,815,554
Trainable params: 6,815,554
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 25s 30ms/step - loss: 0.4947 - acc: 0.8469
Epoch 2/28

837/837 [==============================] - 24s 28ms/step - loss: 0.2884 - acc: 0.9148
Epoch 3/28

837/837 [==============================] - 24s 28ms/step - loss: 0.2245 - acc: 0.9344
Epoch 4/28

837/837 [==============================] - 24s 28ms/step - loss: 0.1900 - acc: 0.9441
Epoch 5/28

837/837 [==============================] - 24s 28ms/step - loss: 0.1630 - acc: 0.9547
Epoch 6/28

837/837 [==============================] - 24s 28ms/step - loss: 0.1434 - acc: 0.9597
Epoch 7/28

837/837 [==============================] - 24s 28ms/step - loss: 0.1262 - acc: 0.9660
Epoch 8/28

837/837 [==============================] - 24s 28ms/step - loss: 0.1173 - acc: 0.9673
Epoch 9/28

837/837 [==============================] - 24s 28ms/step - loss: 0.1023 - acc: 0.9720
Epoch 10/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0918 - acc: 0.9758
Epoch 11/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0830 - acc: 0.9780
Epoch 12/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0760 - acc: 0.9795
Epoch 13/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0693 - acc: 0.9815
Epoch 14/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0689 - acc: 0.9815
Epoch 15/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0608 - acc: 0.9842
Epoch 16/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0564 - acc: 0.9846
Epoch 17/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0529 - acc: 0.9867
Epoch 18/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0495 - acc: 0.9875
Epoch 19/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0455 - acc: 0.9879
Epoch 20/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0455 - acc: 0.9881
Epoch 21/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0428 - acc: 0.9891
Epoch 22/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0396 - acc: 0.9886
Epoch 23/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0369 - acc: 0.9906
Epoch 24/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0355 - acc: 0.9901
Epoch 25/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0337 - acc: 0.9912
Epoch 26/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0327 - acc: 0.9914
Epoch 27/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0328 - acc: 0.9911
Epoch 28/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0298 - acc: 0.9918
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8169
False 902
True percentage 0.900562231287
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.73      0.69      0.71       296
          O       0.98      0.96      0.97      7318
     B-MISC       0.48      0.30      0.37       141
     I-MISC       0.54      0.31      0.39       154
      B-LOC       0.66      0.73      0.69       218
      I-LOC       0.71      0.76      0.73       141
      B-PER       0.88      0.80      0.84       438
      I-PER       0.86      0.65      0.74       214
      I-ORG       0.60      0.54      0.57       151

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.925508425334
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104701 unique words.
4697 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 246
OOV word occurences: in test 382
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6700928     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,813,058
Trainable params: 6,813,058
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 25s 30ms/step - loss: 0.4789 - acc: 0.8541
Epoch 2/28

837/837 [==============================] - 23s 28ms/step - loss: 0.2830 - acc: 0.9137
Epoch 3/28

837/837 [==============================] - 23s 28ms/step - loss: 0.2256 - acc: 0.9329
Epoch 4/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1889 - acc: 0.9445
Epoch 5/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1642 - acc: 0.9518
Epoch 6/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1453 - acc: 0.9581
Epoch 7/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1291 - acc: 0.9639
Epoch 8/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1182 - acc: 0.9673
Epoch 9/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1047 - acc: 0.9724
Epoch 10/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0958 - acc: 0.9737
Epoch 11/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0882 - acc: 0.9759
Epoch 12/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0789 - acc: 0.9788
Epoch 13/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0716 - acc: 0.9808
Epoch 14/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0682 - acc: 0.9823
Epoch 15/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0621 - acc: 0.9845
Epoch 16/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0584 - acc: 0.9853
Epoch 17/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0568 - acc: 0.9854
Epoch 18/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0528 - acc: 0.9866
Epoch 19/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0505 - acc: 0.9867
Epoch 20/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0466 - acc: 0.9876
Epoch 21/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0450 - acc: 0.9879
Epoch 22/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0426 - acc: 0.9888
Epoch 23/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0406 - acc: 0.9889
Epoch 24/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0398 - acc: 0.9891
Epoch 25/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0354 - acc: 0.9906
Epoch 26/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0362 - acc: 0.9901
Epoch 27/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0338 - acc: 0.9911
Epoch 28/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0318 - acc: 0.9912
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8135
False 936
True percentage 0.89681402271
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.84      0.75      0.80       438
      B-ORG       0.72      0.69      0.71       296
     B-MISC       0.51      0.29      0.37       141
      I-PER       0.91      0.59      0.72       214
      I-ORG       0.60      0.50      0.55       151
     I-MISC       0.54      0.49      0.52       154
      B-LOC       0.71      0.75      0.73       218
      I-LOC       0.69      0.76      0.73       141

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.681804420224
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104344 unique words.
4340 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 264
OOV word occurences: in test 412
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678080     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,210
Trainable params: 6,790,210
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 11s 33ms/step - loss: 0.7373 - acc: 0.7767
Epoch 2/28

334/334 [==============================] - 9s 28ms/step - loss: 0.4202 - acc: 0.8686
Epoch 3/28

334/334 [==============================] - 9s 27ms/step - loss: 0.3442 - acc: 0.8987
Epoch 4/28

334/334 [==============================] - 9s 28ms/step - loss: 0.3011 - acc: 0.9118
Epoch 5/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2615 - acc: 0.9265
Epoch 6/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2370 - acc: 0.9343
Epoch 7/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2072 - acc: 0.9431
Epoch 8/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1889 - acc: 0.9520
Epoch 9/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1692 - acc: 0.9541
Epoch 10/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1560 - acc: 0.9558
Epoch 11/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1405 - acc: 0.9644
Epoch 12/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1254 - acc: 0.9673
Epoch 13/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1224 - acc: 0.9700
Epoch 14/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1054 - acc: 0.9750
Epoch 15/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0992 - acc: 0.9763
Epoch 16/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0933 - acc: 0.9755
Epoch 17/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0842 - acc: 0.9818
Epoch 18/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0789 - acc: 0.9811
Epoch 19/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0727 - acc: 0.9819
Epoch 20/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0712 - acc: 0.9824
Epoch 21/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0618 - acc: 0.9865
Epoch 22/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0629 - acc: 0.9859
Epoch 23/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0574 - acc: 0.9881
Epoch 24/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0544 - acc: 0.9874
Epoch 25/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0496 - acc: 0.9892
Epoch 26/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0489 - acc: 0.9899
Epoch 27/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0453 - acc: 0.9895
Epoch 28/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0442 - acc: 0.9904
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8016
False 1055
True percentage 0.883695292691
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-LOC       0.65      0.67      0.66       218
      I-LOC       0.76      0.72      0.74       141
      B-PER       0.90      0.69      0.78       438
      B-ORG       0.65      0.69      0.67       296
      I-ORG       0.49      0.46      0.47       151
     B-MISC       0.37      0.22      0.28       141
     I-MISC       0.44      0.36      0.40       154
      I-PER       0.89      0.56      0.69       214

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.634627233518
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104349 unique words.
4345 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 258
OOV word occurences: in test 418
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678400     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,530
Trainable params: 6,790,530
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 11s 34ms/step - loss: 0.6504 - acc: 0.8059
Epoch 2/28

334/334 [==============================] - 10s 29ms/step - loss: 0.3712 - acc: 0.8863
Epoch 3/28

334/334 [==============================] - 10s 29ms/step - loss: 0.3052 - acc: 0.9106
Epoch 4/28

334/334 [==============================] - 10s 29ms/step - loss: 0.2647 - acc: 0.9223
Epoch 5/28

334/334 [==============================] - 10s 29ms/step - loss: 0.2348 - acc: 0.9310
Epoch 6/28

334/334 [==============================] - 10s 29ms/step - loss: 0.2031 - acc: 0.9406
Epoch 7/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1833 - acc: 0.9479
Epoch 8/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1582 - acc: 0.9569
Epoch 9/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1444 - acc: 0.9617
Epoch 10/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1317 - acc: 0.9641
Epoch 11/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1206 - acc: 0.9673
Epoch 12/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1090 - acc: 0.9734
Epoch 13/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0983 - acc: 0.9748
Epoch 14/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0907 - acc: 0.9777
Epoch 15/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0814 - acc: 0.9797
Epoch 16/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0750 - acc: 0.9809
Epoch 17/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0715 - acc: 0.9836
Epoch 18/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0667 - acc: 0.9839
Epoch 19/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0632 - acc: 0.9841
Epoch 20/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0548 - acc: 0.9894
Epoch 21/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0545 - acc: 0.9880
Epoch 22/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0492 - acc: 0.9893
Epoch 23/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0458 - acc: 0.9908
Epoch 24/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0432 - acc: 0.9920
Epoch 25/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0415 - acc: 0.9916
Epoch 26/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0375 - acc: 0.9925
Epoch 27/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0346 - acc: 0.9937
Epoch 28/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0333 - acc: 0.9931
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7970
False 1101
True percentage 0.878624186969
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.79      0.70      0.74       438
      I-PER       0.90      0.55      0.68       214
          O       0.98      0.96      0.97      7318
      B-ORG       0.62      0.57      0.60       296
      I-ORG       0.45      0.40      0.42       151
      B-LOC       0.65      0.71      0.68       218
      I-LOC       0.61      0.69      0.65       141
     B-MISC       0.40      0.28      0.33       141
     I-MISC       0.37      0.21      0.27       154

avg / total       0.91      0.88      0.89      9071

F-1 Score (without O):
0.907013909441
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104341 unique words.
4337 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 260
OOV word occurences: in test 400
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6677888     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,018
Trainable params: 6,790,018
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 11s 33ms/step - loss: 0.6713 - acc: 0.7972
Epoch 2/28

334/334 [==============================] - 10s 29ms/step - loss: 0.3824 - acc: 0.8819
Epoch 3/28

334/334 [==============================] - 10s 29ms/step - loss: 0.3167 - acc: 0.9024
Epoch 4/28

334/334 [==============================] - 10s 29ms/step - loss: 0.2780 - acc: 0.9150
Epoch 5/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2367 - acc: 0.9300
Epoch 6/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2144 - acc: 0.9360
Epoch 7/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1917 - acc: 0.9444
Epoch 8/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1763 - acc: 0.9498
Epoch 9/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1576 - acc: 0.9553
Epoch 10/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1413 - acc: 0.9590
Epoch 11/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1267 - acc: 0.9669
Epoch 12/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1154 - acc: 0.9701
Epoch 13/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1072 - acc: 0.9717
Epoch 14/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0987 - acc: 0.9738
Epoch 15/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0884 - acc: 0.9782
Epoch 16/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0833 - acc: 0.9797
Epoch 17/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0757 - acc: 0.9830
Epoch 18/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0740 - acc: 0.9823
Epoch 19/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0696 - acc: 0.9840
Epoch 20/28

334/334 [==============================] - 10s 28ms/step - loss: 0.0652 - acc: 0.9843
Epoch 21/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0626 - acc: 0.9859
Epoch 22/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0539 - acc: 0.9877
Epoch 23/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0490 - acc: 0.9902
Epoch 24/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0461 - acc: 0.9896
Epoch 25/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0463 - acc: 0.9899
Epoch 26/28

334/334 [==============================] - 10s 28ms/step - loss: 0.0430 - acc: 0.9911
Epoch 27/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0392 - acc: 0.9913
Epoch 28/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0383 - acc: 0.9917
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8043
False 1028
True percentage 0.886671811267
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.97      7318
      B-PER       0.85      0.73      0.79       438
      B-LOC       0.72      0.63      0.67       218
     B-MISC       0.40      0.38      0.39       141
     I-MISC       0.40      0.45      0.42       154
      B-ORG       0.70      0.70      0.70       296
      I-ORG       0.51      0.50      0.50       151
      I-LOC       0.78      0.60      0.68       141
      I-PER       0.85      0.65      0.74       214

avg / total       0.93      0.89      0.91      9071

F-1 Score (without O):
0.64932735426
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104352 unique words.
4348 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 259
OOV word occurences: in test 420
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678592     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,722
Trainable params: 6,790,722
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 11s 33ms/step - loss: 0.6537 - acc: 0.8099
Epoch 2/28

334/334 [==============================] - 9s 27ms/step - loss: 0.3556 - acc: 0.8901
Epoch 3/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2922 - acc: 0.9096
Epoch 4/28

334/334 [==============================] - 9s 27ms/step - loss: 0.2470 - acc: 0.9262
Epoch 5/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2097 - acc: 0.9399
Epoch 6/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1833 - acc: 0.9476
Epoch 7/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1570 - acc: 0.9565
Epoch 8/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1480 - acc: 0.9581
Epoch 9/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1267 - acc: 0.9676
Epoch 10/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1148 - acc: 0.9707
Epoch 11/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1011 - acc: 0.9736
Epoch 12/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0943 - acc: 0.9768
Epoch 13/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0862 - acc: 0.9800
Epoch 14/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0773 - acc: 0.9815
Epoch 15/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0694 - acc: 0.9847
Epoch 16/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0645 - acc: 0.9851
Epoch 17/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0560 - acc: 0.9882
Epoch 18/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0565 - acc: 0.9877
Epoch 19/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0487 - acc: 0.9908
Epoch 20/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0499 - acc: 0.9894
Epoch 21/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0441 - acc: 0.9905
Epoch 22/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0427 - acc: 0.9915
Epoch 23/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0408 - acc: 0.9907
Epoch 24/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0379 - acc: 0.9918
Epoch 25/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0351 - acc: 0.9909
Epoch 26/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0305 - acc: 0.9941
Epoch 27/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0311 - acc: 0.9931
Epoch 28/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0293 - acc: 0.9945
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7974
False 1097
True percentage 0.879065152684
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-ORG       0.62      0.66      0.64       296
      I-ORG       0.40      0.53      0.45       151
      B-PER       0.84      0.66      0.74       438
      I-PER       0.83      0.60      0.70       214
      B-LOC       0.71      0.65      0.68       218
      I-LOC       0.75      0.71      0.73       141
     B-MISC       0.42      0.26      0.32       141
     I-MISC       0.49      0.25      0.33       154

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.617125382263
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104355 unique words.
4351 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 261
OOV word occurences: in test 401
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678784     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,914
Trainable params: 6,790,914
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 11s 34ms/step - loss: 0.6254 - acc: 0.8069
Epoch 2/28

334/334 [==============================] - 10s 28ms/step - loss: 0.3872 - acc: 0.8759
Epoch 3/28

334/334 [==============================] - 10s 29ms/step - loss: 0.3201 - acc: 0.9030
Epoch 4/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2750 - acc: 0.9167
Epoch 5/28

334/334 [==============================] - 10s 29ms/step - loss: 0.2412 - acc: 0.9274
Epoch 6/28

334/334 [==============================] - 10s 29ms/step - loss: 0.2082 - acc: 0.9400
Epoch 7/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1912 - acc: 0.9448
Epoch 8/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1711 - acc: 0.9519
Epoch 9/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1597 - acc: 0.9543
Epoch 10/28

334/334 [==============================] - 10s 28ms/step - loss: 0.1440 - acc: 0.9618
Epoch 11/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1290 - acc: 0.9678
Epoch 12/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1208 - acc: 0.9675
Epoch 13/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1088 - acc: 0.9743
Epoch 14/28

334/334 [==============================] - 10s 28ms/step - loss: 0.0990 - acc: 0.9762
Epoch 15/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0914 - acc: 0.9786
Epoch 16/28

334/334 [==============================] - 10s 28ms/step - loss: 0.0823 - acc: 0.9810
Epoch 17/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0826 - acc: 0.9802
Epoch 18/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0725 - acc: 0.9844
Epoch 19/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0660 - acc: 0.9848
Epoch 20/28

334/334 [==============================] - 10s 28ms/step - loss: 0.0623 - acc: 0.9861
Epoch 21/28

334/334 [==============================] - 10s 28ms/step - loss: 0.0610 - acc: 0.9854
Epoch 22/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0558 - acc: 0.9878
Epoch 23/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0517 - acc: 0.9891
Epoch 24/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0492 - acc: 0.9894
Epoch 25/28

334/334 [==============================] - 10s 28ms/step - loss: 0.0449 - acc: 0.9904
Epoch 26/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0439 - acc: 0.9916
Epoch 27/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0399 - acc: 0.9925
Epoch 28/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0398 - acc: 0.9911
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8010
False 1061
True percentage 0.883033844119
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.96      0.96      7318
      B-ORG       0.70      0.69      0.70       296
      I-ORG       0.51      0.42      0.46       151
      B-PER       0.83      0.70      0.76       438
      I-PER       0.88      0.46      0.61       214
     B-MISC       0.38      0.21      0.27       141
     I-MISC       0.40      0.31      0.35       154
      B-LOC       0.66      0.67      0.67       218
      I-LOC       0.75      0.66      0.70       141

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.620732853116
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104342 unique words.
4338 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 262
OOV word occurences: in test 415
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6677952     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,082
Trainable params: 6,790,082
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 11s 33ms/step - loss: 0.6942 - acc: 0.7928
Epoch 2/28

334/334 [==============================] - 9s 28ms/step - loss: 0.4093 - acc: 0.8747
Epoch 3/28

334/334 [==============================] - 9s 28ms/step - loss: 0.3359 - acc: 0.8994
Epoch 4/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2856 - acc: 0.9170
Epoch 5/28

334/334 [==============================] - 9s 27ms/step - loss: 0.2477 - acc: 0.9266
Epoch 6/28

334/334 [==============================] - 9s 27ms/step - loss: 0.2198 - acc: 0.9381
Epoch 7/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1927 - acc: 0.9455
Epoch 8/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1826 - acc: 0.9515
Epoch 9/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1573 - acc: 0.9588
Epoch 10/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1470 - acc: 0.9610
Epoch 11/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1361 - acc: 0.9647
Epoch 12/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1241 - acc: 0.9663
Epoch 13/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1140 - acc: 0.9701
Epoch 14/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1073 - acc: 0.9711
Epoch 15/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0960 - acc: 0.9772
Epoch 16/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0889 - acc: 0.9776
Epoch 17/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0851 - acc: 0.9781
Epoch 18/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0808 - acc: 0.9809
Epoch 19/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0711 - acc: 0.9831
Epoch 20/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0664 - acc: 0.9852
Epoch 21/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0616 - acc: 0.9851
Epoch 22/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0589 - acc: 0.9868
Epoch 23/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0548 - acc: 0.9885
Epoch 24/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0516 - acc: 0.9884
Epoch 25/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0509 - acc: 0.9877
Epoch 26/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0468 - acc: 0.9901
Epoch 27/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0437 - acc: 0.9913
Epoch 28/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0402 - acc: 0.9921
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7996
False 1075
True percentage 0.881490464116
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.86      0.61      0.71       438
          O       0.98      0.95      0.97      7318
      B-LOC       0.70      0.66      0.68       218
      B-ORG       0.67      0.69      0.68       296
      I-PER       0.83      0.55      0.66       214
     B-MISC       0.39      0.29      0.33       141
     I-MISC       0.43      0.42      0.42       154
      I-ORG       0.51      0.49      0.50       151
      I-LOC       0.63      0.70      0.66       141

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.910536545144
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104351 unique words.
4347 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 260
OOV word occurences: in test 388
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678528     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,658
Trainable params: 6,790,658
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 11s 34ms/step - loss: 0.7639 - acc: 0.7732
Epoch 2/28

334/334 [==============================] - 10s 29ms/step - loss: 0.3894 - acc: 0.8734
Epoch 3/28

334/334 [==============================] - 9s 28ms/step - loss: 0.3245 - acc: 0.9046
Epoch 4/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2840 - acc: 0.9122
Epoch 5/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2424 - acc: 0.9271
Epoch 6/28

334/334 [==============================] - 10s 28ms/step - loss: 0.2174 - acc: 0.9366
Epoch 7/28

334/334 [==============================] - 10s 29ms/step - loss: 0.2001 - acc: 0.9427
Epoch 8/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1770 - acc: 0.9483
Epoch 9/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1655 - acc: 0.9537
Epoch 10/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1520 - acc: 0.9583
Epoch 11/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1349 - acc: 0.9634
Epoch 12/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1216 - acc: 0.9682
Epoch 13/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1152 - acc: 0.9704
Epoch 14/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1041 - acc: 0.9749
Epoch 15/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1003 - acc: 0.9752
Epoch 16/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0864 - acc: 0.9797
Epoch 17/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0856 - acc: 0.9800
Epoch 18/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0779 - acc: 0.9804
Epoch 19/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0690 - acc: 0.9840
Epoch 20/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0648 - acc: 0.9841
Epoch 21/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0636 - acc: 0.9839
Epoch 22/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0579 - acc: 0.9872
Epoch 23/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0544 - acc: 0.9876
Epoch 24/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0547 - acc: 0.9883
Epoch 25/28

334/334 [==============================] - 10s 28ms/step - loss: 0.0465 - acc: 0.9909
Epoch 26/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0461 - acc: 0.9905
Epoch 27/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0425 - acc: 0.9911
Epoch 28/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0423 - acc: 0.9914
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8012
False 1059
True percentage 0.883254326976
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.97      7318
     B-MISC       0.42      0.26      0.32       141
      B-ORG       0.61      0.67      0.64       296
     I-MISC       0.48      0.38      0.43       154
      B-LOC       0.72      0.69      0.70       218
      I-ORG       0.40      0.38      0.39       151
      B-PER       0.86      0.73      0.79       438
      I-PER       0.79      0.58      0.67       214
      I-LOC       0.60      0.68      0.64       141

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.626426426426
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104323 unique words.
4319 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 265
OOV word occurences: in test 448
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6676736     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,788,866
Trainable params: 6,788,866
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 11s 34ms/step - loss: 0.6525 - acc: 0.8033
Epoch 2/28

334/334 [==============================] - 9s 28ms/step - loss: 0.3698 - acc: 0.8890
Epoch 3/28

334/334 [==============================] - 9s 28ms/step - loss: 0.3048 - acc: 0.9093
Epoch 4/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2647 - acc: 0.9232
Epoch 5/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2296 - acc: 0.9349
Epoch 6/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2058 - acc: 0.9428
Epoch 7/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1836 - acc: 0.9491
Epoch 8/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1619 - acc: 0.9563
Epoch 9/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1459 - acc: 0.9631
Epoch 10/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1402 - acc: 0.9630
Epoch 11/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1224 - acc: 0.9704
Epoch 12/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1111 - acc: 0.9723
Epoch 13/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1053 - acc: 0.9765
Epoch 14/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0958 - acc: 0.9772
Epoch 15/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0860 - acc: 0.9789
Epoch 16/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0812 - acc: 0.9818
Epoch 17/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0784 - acc: 0.9824
Epoch 18/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0695 - acc: 0.9847
Epoch 19/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0639 - acc: 0.9859
Epoch 20/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0636 - acc: 0.9862
Epoch 21/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0584 - acc: 0.9874
Epoch 22/28

334/334 [==============================] - 10s 28ms/step - loss: 0.0550 - acc: 0.9874
Epoch 23/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0511 - acc: 0.9889
Epoch 24/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0458 - acc: 0.9913
Epoch 25/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0455 - acc: 0.9897
Epoch 26/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0427 - acc: 0.9909
Epoch 27/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0426 - acc: 0.9893
Epoch 28/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0403 - acc: 0.9913
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7982
False 1089
True percentage 0.879947084114
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.66      0.60      0.63       296
          O       0.97      0.96      0.96      7318
     B-MISC       0.36      0.22      0.27       141
     I-MISC       0.38      0.44      0.41       154
      B-LOC       0.69      0.65      0.67       218
      I-LOC       0.79      0.67      0.72       141
      B-PER       0.85      0.67      0.75       438
      I-PER       0.92      0.56      0.69       214
      I-ORG       0.62      0.40      0.49       151

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.911319983653
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104315 unique words.
4311 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 264
OOV word occurences: in test 444
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6676224     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,788,354
Trainable params: 6,788,354
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 11s 34ms/step - loss: 0.6463 - acc: 0.7969
Epoch 2/28

334/334 [==============================] - 9s 28ms/step - loss: 0.3737 - acc: 0.8822
Epoch 3/28

334/334 [==============================] - 10s 29ms/step - loss: 0.3024 - acc: 0.9070
Epoch 4/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2641 - acc: 0.9192
Epoch 5/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2338 - acc: 0.9293
Epoch 6/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2091 - acc: 0.9374
Epoch 7/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1831 - acc: 0.9461
Epoch 8/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1681 - acc: 0.9523
Epoch 9/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1535 - acc: 0.9599
Epoch 10/28

334/334 [==============================] - 10s 28ms/step - loss: 0.1401 - acc: 0.9608
Epoch 11/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1312 - acc: 0.9644
Epoch 12/28

334/334 [==============================] - 10s 28ms/step - loss: 0.1216 - acc: 0.9681
Epoch 13/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1116 - acc: 0.9730
Epoch 14/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0981 - acc: 0.9768
Epoch 15/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0946 - acc: 0.9768
Epoch 16/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0857 - acc: 0.9806
Epoch 17/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0817 - acc: 0.9820
Epoch 18/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0741 - acc: 0.9844
Epoch 19/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0722 - acc: 0.9826
Epoch 20/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0668 - acc: 0.9848
Epoch 21/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0655 - acc: 0.9846
Epoch 22/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0568 - acc: 0.9881
Epoch 23/28

334/334 [==============================] - 10s 29ms/step - loss: 0.0568 - acc: 0.9884
Epoch 24/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0551 - acc: 0.9861
Epoch 25/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0495 - acc: 0.9889
Epoch 26/28

334/334 [==============================] - 10s 28ms/step - loss: 0.0434 - acc: 0.9905
Epoch 27/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0456 - acc: 0.9917
Epoch 28/28

334/334 [==============================] - 10s 28ms/step - loss: 0.0439 - acc: 0.9903
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7980
False 1091
True percentage 0.879726601257
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-PER       0.87      0.67      0.76       438
      B-ORG       0.57      0.61      0.59       296
     B-MISC       0.50      0.36      0.42       141
      I-PER       0.89      0.60      0.72       214
      I-ORG       0.47      0.53      0.50       151
     I-MISC       0.45      0.51      0.48       154
      B-LOC       0.72      0.67      0.70       218
      I-LOC       0.76      0.71      0.73       141

avg / total       0.93      0.88      0.90      9071

F-1 Score (without O):
0.634730538922
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104210 unique words.
4206 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 272
OOV word occurences: in test 488
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6669504     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,781,634
Trainable params: 6,781,634
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 6s 38ms/step - loss: 0.8465 - acc: 0.7383
Epoch 2/28

167/167 [==============================] - 5s 28ms/step - loss: 0.4475 - acc: 0.8566
Epoch 3/28

167/167 [==============================] - 5s 28ms/step - loss: 0.3789 - acc: 0.8805
Epoch 4/28

167/167 [==============================] - 5s 28ms/step - loss: 0.3470 - acc: 0.8942
Epoch 5/28

167/167 [==============================] - 5s 28ms/step - loss: 0.3035 - acc: 0.9047
Epoch 6/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2739 - acc: 0.9175
Epoch 7/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2423 - acc: 0.9293
Epoch 8/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2253 - acc: 0.9339
Epoch 9/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2068 - acc: 0.9428
Epoch 10/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1856 - acc: 0.9495
Epoch 11/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1723 - acc: 0.9565
Epoch 12/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1573 - acc: 0.9612
Epoch 13/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1451 - acc: 0.9672
Epoch 14/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1406 - acc: 0.9637
Epoch 15/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1233 - acc: 0.9746
Epoch 16/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1113 - acc: 0.9756
Epoch 17/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1065 - acc: 0.9784
Epoch 18/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1001 - acc: 0.9768
Epoch 19/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0860 - acc: 0.9832
Epoch 20/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0858 - acc: 0.9843
Epoch 21/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0797 - acc: 0.9854
Epoch 22/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0705 - acc: 0.9890
Epoch 23/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0687 - acc: 0.9886
Epoch 24/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0605 - acc: 0.9925
Epoch 25/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0606 - acc: 0.9898
Epoch 26/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0561 - acc: 0.9909
Epoch 27/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0557 - acc: 0.9911
Epoch 28/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0518 - acc: 0.9922
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7764
False 1307
True percentage 0.855914452651
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.94      0.96      7318
      B-LOC       0.66      0.64      0.65       218
      I-LOC       0.72      0.62      0.66       141
      B-PER       0.79      0.55      0.65       438
      B-ORG       0.53      0.60      0.56       296
      I-ORG       0.33      0.34      0.34       151
     B-MISC       0.35      0.24      0.28       141
     I-MISC       0.37      0.41      0.39       154
      I-PER       0.65      0.47      0.54       214

avg / total       0.90      0.86      0.88      9071

F-1 Score (without O):
0.541226215645
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104209 unique words.
4205 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 266
OOV word occurences: in test 445
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6669440     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,781,570
Trainable params: 6,781,570
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 6s 38ms/step - loss: 0.8195 - acc: 0.7564
Epoch 2/28

167/167 [==============================] - 5s 28ms/step - loss: 0.4051 - acc: 0.8844
Epoch 3/28

167/167 [==============================] - 5s 29ms/step - loss: 0.3509 - acc: 0.8999
Epoch 4/28

167/167 [==============================] - 5s 28ms/step - loss: 0.3062 - acc: 0.9116
Epoch 5/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2666 - acc: 0.9248
Epoch 6/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2450 - acc: 0.9356
Epoch 7/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2162 - acc: 0.9430
Epoch 8/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1993 - acc: 0.9438
Epoch 9/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1878 - acc: 0.9468
Epoch 10/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1671 - acc: 0.9554
Epoch 11/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1565 - acc: 0.9553
Epoch 12/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1442 - acc: 0.9617
Epoch 13/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1306 - acc: 0.9669
Epoch 14/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1198 - acc: 0.9712
Epoch 15/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1192 - acc: 0.9690
Epoch 16/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1012 - acc: 0.9780
Epoch 17/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1042 - acc: 0.9747
Epoch 18/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0943 - acc: 0.9770
Epoch 19/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0877 - acc: 0.9808
Epoch 20/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0834 - acc: 0.9794
Epoch 21/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0805 - acc: 0.9832
Epoch 22/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0738 - acc: 0.9830
Epoch 23/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0693 - acc: 0.9873
Epoch 24/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0638 - acc: 0.9886
Epoch 25/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0593 - acc: 0.9882
Epoch 26/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0550 - acc: 0.9895
Epoch 27/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0520 - acc: 0.9899
Epoch 28/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0507 - acc: 0.9912
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7879
False 1192
True percentage 0.868592216955
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.76      0.66      0.71       438
      I-PER       0.72      0.60      0.65       214
          O       0.97      0.96      0.96      7318
      B-ORG       0.58      0.48      0.52       296
      I-ORG       0.30      0.33      0.31       151
      B-LOC       0.66      0.68      0.67       218
      I-LOC       0.62      0.53      0.57       141
     B-MISC       0.42      0.17      0.24       141
     I-MISC       0.37      0.17      0.23       154

avg / total       0.90      0.87      0.88      9071

F-1 Score (without O):
0.899158668089
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104194 unique words.
4190 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 269
OOV word occurences: in test 437
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6668480     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,780,610
Trainable params: 6,780,610
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 6s 38ms/step - loss: 0.7907 - acc: 0.7638
Epoch 2/28

167/167 [==============================] - 5s 28ms/step - loss: 0.4154 - acc: 0.8680
Epoch 3/28

167/167 [==============================] - 5s 28ms/step - loss: 0.3615 - acc: 0.8894
Epoch 4/28

167/167 [==============================] - 5s 29ms/step - loss: 0.3189 - acc: 0.9039
Epoch 5/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2783 - acc: 0.9173
Epoch 6/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2536 - acc: 0.9217
Epoch 7/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2348 - acc: 0.9347
Epoch 8/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2135 - acc: 0.9389
Epoch 9/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1948 - acc: 0.9456
Epoch 10/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1785 - acc: 0.9527
Epoch 11/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1671 - acc: 0.9549
Epoch 12/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1470 - acc: 0.9633
Epoch 13/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1398 - acc: 0.9641
Epoch 14/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1267 - acc: 0.9681
Epoch 15/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1171 - acc: 0.9728
Epoch 16/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1140 - acc: 0.9716
Epoch 17/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1070 - acc: 0.9715
Epoch 18/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0959 - acc: 0.9765
Epoch 19/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0872 - acc: 0.9825
Epoch 20/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0820 - acc: 0.9826
Epoch 21/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0754 - acc: 0.9855
Epoch 22/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0717 - acc: 0.9844
Epoch 23/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0680 - acc: 0.9850
Epoch 24/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0591 - acc: 0.9909
Epoch 25/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0591 - acc: 0.9899
Epoch 26/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0594 - acc: 0.9883
Epoch 27/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0544 - acc: 0.9907
Epoch 28/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0477 - acc: 0.9931
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7772
False 1299
True percentage 0.856796384081
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.94      0.96      7318
      B-PER       0.82      0.64      0.72       438
      B-LOC       0.69      0.55      0.61       218
     B-MISC       0.20      0.18      0.19       141
     I-MISC       0.31      0.44      0.36       154
      B-ORG       0.56      0.62      0.59       296
      I-ORG       0.26      0.32      0.29       151
      I-LOC       0.67      0.30      0.41       141
      I-PER       0.77      0.44      0.56       214

avg / total       0.90      0.86      0.88      9071

F-1 Score (without O):
0.520374283127
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104204 unique words.
4200 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 266
OOV word occurences: in test 469
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6669120     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,781,250
Trainable params: 6,781,250
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 6s 39ms/step - loss: 0.8650 - acc: 0.7372
Epoch 2/28

167/167 [==============================] - 5s 29ms/step - loss: 0.4438 - acc: 0.8584
Epoch 3/28

167/167 [==============================] - 5s 28ms/step - loss: 0.3790 - acc: 0.8834
Epoch 4/28

167/167 [==============================] - 5s 28ms/step - loss: 0.3310 - acc: 0.8950
Epoch 5/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2938 - acc: 0.9163
Epoch 6/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2637 - acc: 0.9271
Epoch 7/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2376 - acc: 0.9321
Epoch 8/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2207 - acc: 0.9387
Epoch 9/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1920 - acc: 0.9533
Epoch 10/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1852 - acc: 0.9521
Epoch 11/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1703 - acc: 0.9592
Epoch 12/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1493 - acc: 0.9661
Epoch 13/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1403 - acc: 0.9670
Epoch 14/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1287 - acc: 0.9728
Epoch 15/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1167 - acc: 0.9713
Epoch 16/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1093 - acc: 0.9768
Epoch 17/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0981 - acc: 0.9800
Epoch 18/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0915 - acc: 0.9821
Epoch 19/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0836 - acc: 0.9842
Epoch 20/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0818 - acc: 0.9804
Epoch 21/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0780 - acc: 0.9829
Epoch 22/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0680 - acc: 0.9855
Epoch 23/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0668 - acc: 0.9868
Epoch 24/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0618 - acc: 0.9881
Epoch 25/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0580 - acc: 0.9900
Epoch 26/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0523 - acc: 0.9914
Epoch 27/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0515 - acc: 0.9897
Epoch 28/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0469 - acc: 0.9899
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7805
False 1266
True percentage 0.860434351229
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-ORG       0.55      0.49      0.52       296
      I-ORG       0.26      0.41      0.32       151
      B-PER       0.77      0.66      0.71       438
      I-PER       0.86      0.53      0.66       214
      B-LOC       0.75      0.58      0.65       218
      I-LOC       0.69      0.38      0.49       141
     B-MISC       0.28      0.20      0.23       141
     I-MISC       0.41      0.27      0.33       154

avg / total       0.90      0.86      0.88      9071

F-1 Score (without O):
0.534080298786
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104225 unique words.
4221 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 272
OOV word occurences: in test 466
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6670464     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,782,594
Trainable params: 6,782,594
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 6s 39ms/step - loss: 0.7419 - acc: 0.7792
Epoch 2/28

167/167 [==============================] - 5s 29ms/step - loss: 0.3966 - acc: 0.8717
Epoch 3/28

167/167 [==============================] - 5s 29ms/step - loss: 0.3328 - acc: 0.8956
Epoch 4/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2871 - acc: 0.9162
Epoch 5/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2652 - acc: 0.9238
Epoch 6/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2285 - acc: 0.9323
Epoch 7/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2054 - acc: 0.9421
Epoch 8/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1836 - acc: 0.9476
Epoch 9/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1759 - acc: 0.9526
Epoch 10/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1504 - acc: 0.9633
Epoch 11/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1452 - acc: 0.9634
Epoch 12/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1323 - acc: 0.9674
Epoch 13/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1227 - acc: 0.9676
Epoch 14/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1131 - acc: 0.9708
Epoch 15/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1063 - acc: 0.9731
Epoch 16/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0976 - acc: 0.9789
Epoch 17/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0864 - acc: 0.9805
Epoch 18/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0800 - acc: 0.9799
Epoch 19/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0755 - acc: 0.9846
Epoch 20/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0708 - acc: 0.9840
Epoch 21/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0717 - acc: 0.9822
Epoch 22/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0639 - acc: 0.9875
Epoch 23/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0616 - acc: 0.9875
Epoch 24/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0528 - acc: 0.9907
Epoch 25/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0520 - acc: 0.9909
Epoch 26/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0504 - acc: 0.9897
Epoch 27/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0491 - acc: 0.9916
Epoch 28/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0463 - acc: 0.9908
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7805
False 1266
True percentage 0.860434351229
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.96      0.96      7318
      B-ORG       0.47      0.38      0.42       296
      I-ORG       0.32      0.26      0.29       151
      B-PER       0.79      0.61      0.69       438
      I-PER       0.81      0.46      0.59       214
     B-MISC       0.26      0.21      0.23       141
     I-MISC       0.31      0.21      0.25       154
      B-LOC       0.71      0.61      0.66       218
      I-LOC       0.77      0.62      0.69       141

avg / total       0.89      0.86      0.88      9071

F-1 Score (without O):
0.517297122535
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104212 unique words.
4208 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 270
OOV word occurences: in test 432
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6669632     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,781,762
Trainable params: 6,781,762
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 6s 38ms/step - loss: 0.8963 - acc: 0.7389
Epoch 2/28

167/167 [==============================] - 5s 28ms/step - loss: 0.4635 - acc: 0.8474
Epoch 3/28

167/167 [==============================] - 5s 28ms/step - loss: 0.3916 - acc: 0.8730
Epoch 4/28

167/167 [==============================] - 5s 28ms/step - loss: 0.3587 - acc: 0.8829
Epoch 5/28

167/167 [==============================] - 5s 28ms/step - loss: 0.3192 - acc: 0.9045
Epoch 6/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2889 - acc: 0.9134
Epoch 7/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2645 - acc: 0.9263
Epoch 8/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2476 - acc: 0.9272
Epoch 9/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2146 - acc: 0.9433
Epoch 10/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2039 - acc: 0.9441
Epoch 11/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1863 - acc: 0.9530
Epoch 12/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1752 - acc: 0.9532
Epoch 13/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1530 - acc: 0.9629
Epoch 14/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1406 - acc: 0.9685
Epoch 15/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1290 - acc: 0.9699
Epoch 16/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1271 - acc: 0.9700
Epoch 17/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1167 - acc: 0.9748
Epoch 18/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1013 - acc: 0.9766
Epoch 19/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0952 - acc: 0.9803
Epoch 20/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0897 - acc: 0.9782
Epoch 21/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0822 - acc: 0.9860
Epoch 22/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0771 - acc: 0.9837
Epoch 23/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0727 - acc: 0.9855
Epoch 24/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0642 - acc: 0.9882
Epoch 25/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0632 - acc: 0.9899
Epoch 26/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0581 - acc: 0.9904
Epoch 27/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0545 - acc: 0.9895
Epoch 28/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0549 - acc: 0.9898
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7926
False 1145
True percentage 0.873773564105
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.83      0.64      0.73       438
          O       0.98      0.95      0.96      7318
      B-LOC       0.68      0.61      0.64       218
      B-ORG       0.61      0.69      0.65       296
      I-PER       0.79      0.50      0.61       214
     B-MISC       0.36      0.30      0.33       141
     I-MISC       0.43      0.31      0.36       154
      I-ORG       0.41      0.48      0.45       151
      I-LOC       0.78      0.51      0.62       141

avg / total       0.91      0.87      0.89      9071

F-1 Score (without O):
0.902852418355
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104201 unique words.
4197 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 271
OOV word occurences: in test 478
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6668928     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,781,058
Trainable params: 6,781,058
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 6s 38ms/step - loss: 0.9146 - acc: 0.7447
Epoch 2/28

167/167 [==============================] - 5s 28ms/step - loss: 0.4448 - acc: 0.8547
Epoch 3/28

167/167 [==============================] - 5s 29ms/step - loss: 0.3753 - acc: 0.8845
Epoch 4/28

167/167 [==============================] - 5s 28ms/step - loss: 0.3295 - acc: 0.9000
Epoch 5/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2945 - acc: 0.9143
Epoch 6/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2702 - acc: 0.9212
Epoch 7/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2481 - acc: 0.9259
Epoch 8/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2185 - acc: 0.9409
Epoch 9/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2043 - acc: 0.9476
Epoch 10/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1806 - acc: 0.9509
Epoch 11/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1670 - acc: 0.9595
Epoch 12/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1520 - acc: 0.9613
Epoch 13/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1390 - acc: 0.9680
Epoch 14/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1300 - acc: 0.9706
Epoch 15/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1198 - acc: 0.9720
Epoch 16/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1038 - acc: 0.9807
Epoch 17/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0971 - acc: 0.9810
Epoch 18/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0957 - acc: 0.9803
Epoch 19/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0834 - acc: 0.9841
Epoch 20/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0783 - acc: 0.9859
Epoch 21/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0712 - acc: 0.9882
Epoch 22/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0691 - acc: 0.9879
Epoch 23/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0629 - acc: 0.9913
Epoch 24/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0583 - acc: 0.9899
Epoch 25/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0552 - acc: 0.9898
Epoch 26/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0505 - acc: 0.9922
Epoch 27/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0482 - acc: 0.9932
Epoch 28/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0449 - acc: 0.9932
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7829
False 1242
True percentage 0.863080145519
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
     B-MISC       0.34      0.20      0.25       141
      B-ORG       0.49      0.54      0.52       296
     I-MISC       0.42      0.27      0.33       154
      B-LOC       0.72      0.67      0.70       218
      I-ORG       0.36      0.39      0.37       151
      B-PER       0.82      0.59      0.68       438
      I-PER       0.75      0.55      0.63       214
      I-LOC       0.69      0.67      0.68       141

avg / total       0.91      0.86      0.88      9071

F-1 Score (without O):
0.558614290133
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104186 unique words.
4182 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 269
OOV word occurences: in test 453
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6667968     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,780,098
Trainable params: 6,780,098
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 6s 38ms/step - loss: 0.8844 - acc: 0.7531
Epoch 2/28

167/167 [==============================] - 5s 29ms/step - loss: 0.4166 - acc: 0.8724
Epoch 3/28

167/167 [==============================] - 5s 29ms/step - loss: 0.3444 - acc: 0.8996
Epoch 4/28

167/167 [==============================] - 5s 28ms/step - loss: 0.3023 - acc: 0.9102
Epoch 5/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2654 - acc: 0.9197
Epoch 6/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2465 - acc: 0.9282
Epoch 7/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2145 - acc: 0.9376
Epoch 8/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1960 - acc: 0.9422
Epoch 9/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1785 - acc: 0.9513
Epoch 10/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1644 - acc: 0.9600
Epoch 11/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1469 - acc: 0.9649
Epoch 12/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1358 - acc: 0.9656
Epoch 13/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1236 - acc: 0.9715
Epoch 14/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1170 - acc: 0.9760
Epoch 15/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1087 - acc: 0.9762
Epoch 16/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0949 - acc: 0.9815
Epoch 17/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0847 - acc: 0.9825
Epoch 18/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0813 - acc: 0.9854
Epoch 19/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0765 - acc: 0.9844
Epoch 20/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0736 - acc: 0.9855
Epoch 21/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0696 - acc: 0.9864
Epoch 22/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0624 - acc: 0.9881
Epoch 23/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0596 - acc: 0.9911
Epoch 24/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0551 - acc: 0.9884
Epoch 25/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0492 - acc: 0.9926
Epoch 26/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0490 - acc: 0.9922
Epoch 27/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0463 - acc: 0.9916
Epoch 28/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0441 - acc: 0.9918
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7846
False 1225
True percentage 0.864954249807
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.62      0.47      0.53       296
          O       0.97      0.95      0.96      7318
     B-MISC       0.30      0.28      0.29       141
     I-MISC       0.29      0.46      0.36       154
      B-LOC       0.64      0.56      0.60       218
      I-LOC       0.78      0.48      0.59       141
      B-PER       0.79      0.67      0.72       438
      I-PER       0.91      0.54      0.68       214
      I-ORG       0.62      0.26      0.36       151

avg / total       0.91      0.86      0.88      9071

F-1 Score (without O):
0.897740507803
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104165 unique words.
4161 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 270
OOV word occurences: in test 538
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6666624     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,778,754
Trainable params: 6,778,754
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 6s 38ms/step - loss: 0.9570 - acc: 0.7386
Epoch 2/28

167/167 [==============================] - 5s 29ms/step - loss: 0.4316 - acc: 0.8671
Epoch 3/28

167/167 [==============================] - 5s 29ms/step - loss: 0.3710 - acc: 0.8861
Epoch 4/28

167/167 [==============================] - 5s 29ms/step - loss: 0.3209 - acc: 0.9079
Epoch 5/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2874 - acc: 0.9141
Epoch 6/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2581 - acc: 0.9265
Epoch 7/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2341 - acc: 0.9355
Epoch 8/28

167/167 [==============================] - 5s 29ms/step - loss: 0.2175 - acc: 0.9426
Epoch 9/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1970 - acc: 0.9476
Epoch 10/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1825 - acc: 0.9525
Epoch 11/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1663 - acc: 0.9631
Epoch 12/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1577 - acc: 0.9568
Epoch 13/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1442 - acc: 0.9675
Epoch 14/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1337 - acc: 0.9699
Epoch 15/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1259 - acc: 0.9723
Epoch 16/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1196 - acc: 0.9718
Epoch 17/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1104 - acc: 0.9742
Epoch 18/28

167/167 [==============================] - 5s 29ms/step - loss: 0.1029 - acc: 0.9766
Epoch 19/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0965 - acc: 0.9802
Epoch 20/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0875 - acc: 0.9838
Epoch 21/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0857 - acc: 0.9818
Epoch 22/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0796 - acc: 0.9823
Epoch 23/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0770 - acc: 0.9850
Epoch 24/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0681 - acc: 0.9841
Epoch 25/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0682 - acc: 0.9869
Epoch 26/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0618 - acc: 0.9876
Epoch 27/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0607 - acc: 0.9909
Epoch 28/28

167/167 [==============================] - 5s 29ms/step - loss: 0.0551 - acc: 0.9902
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7767
False 1304
True percentage 0.856245176937
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-PER       0.76      0.52      0.62       438
      B-ORG       0.46      0.49      0.47       296
     B-MISC       0.45      0.23      0.31       141
      I-PER       0.78      0.47      0.59       214
      I-ORG       0.31      0.58      0.41       151
     I-MISC       0.56      0.21      0.31       154
      B-LOC       0.80      0.58      0.67       218
      I-LOC       0.72      0.65      0.68       141

avg / total       0.91      0.86      0.88      9071

F-1 Score (without O):
0.528290090653
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104116 unique words.
4112 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 278
OOV word occurences: in test 539
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663488     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,618
Trainable params: 6,775,618
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 4s 49ms/step - loss: 1.1555 - acc: 0.6488
Epoch 2/28

83/83 [==============================] - 2s 29ms/step - loss: 0.5139 - acc: 0.8450
Epoch 3/28

83/83 [==============================] - 2s 29ms/step - loss: 0.4357 - acc: 0.8556
Epoch 4/28

83/83 [==============================] - 2s 29ms/step - loss: 0.3901 - acc: 0.8766
Epoch 5/28

83/83 [==============================] - 2s 29ms/step - loss: 0.3583 - acc: 0.8964
Epoch 6/28

83/83 [==============================] - 2s 29ms/step - loss: 0.3181 - acc: 0.9077
Epoch 7/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2877 - acc: 0.9160
Epoch 8/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2584 - acc: 0.9310
Epoch 9/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2407 - acc: 0.9353
Epoch 10/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2213 - acc: 0.9479
Epoch 11/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2039 - acc: 0.9406
Epoch 12/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1861 - acc: 0.9567
Epoch 13/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1704 - acc: 0.9578
Epoch 14/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1550 - acc: 0.9655
Epoch 15/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1453 - acc: 0.9690
Epoch 16/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1377 - acc: 0.9765
Epoch 17/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1248 - acc: 0.9736
Epoch 18/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1168 - acc: 0.9764
Epoch 19/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1078 - acc: 0.9823
Epoch 20/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0959 - acc: 0.9877
Epoch 21/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0943 - acc: 0.9858
Epoch 22/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0904 - acc: 0.9861
Epoch 23/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0837 - acc: 0.9898
Epoch 24/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0764 - acc: 0.9928
Epoch 25/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0691 - acc: 0.9904
Epoch 26/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0677 - acc: 0.9911
Epoch 27/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0623 - acc: 0.9942
Epoch 28/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0643 - acc: 0.9911
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7672
False 1399
True percentage 0.845772241208
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.94      0.95      7318
      B-LOC       0.60      0.60      0.60       218
      I-LOC       0.61      0.56      0.59       141
      B-PER       0.71      0.52      0.60       438
      B-ORG       0.52      0.56      0.54       296
      I-ORG       0.30      0.38      0.34       151
     B-MISC       0.35      0.17      0.23       141
     I-MISC       0.37      0.24      0.29       154
      I-PER       0.81      0.37      0.51       214

avg / total       0.89      0.85      0.87      9071

F-1 Score (without O):
0.500939261115
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104129 unique words.
4125 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 271
OOV word occurences: in test 452
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6664320     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,776,450
Trainable params: 6,776,450
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 4s 48ms/step - loss: 1.4183 - acc: 0.6198
Epoch 2/28

83/83 [==============================] - 2s 29ms/step - loss: 0.5386 - acc: 0.8480
Epoch 3/28

83/83 [==============================] - 2s 28ms/step - loss: 0.4274 - acc: 0.8718
Epoch 4/28

83/83 [==============================] - 2s 29ms/step - loss: 0.3749 - acc: 0.8920
Epoch 5/28

83/83 [==============================] - 2s 29ms/step - loss: 0.3379 - acc: 0.8995
Epoch 6/28

83/83 [==============================] - 2s 30ms/step - loss: 0.3021 - acc: 0.9159
Epoch 7/28

83/83 [==============================] - 2s 30ms/step - loss: 0.2879 - acc: 0.9253
Epoch 8/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2537 - acc: 0.9331
Epoch 9/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2375 - acc: 0.9354
Epoch 10/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2242 - acc: 0.9395
Epoch 11/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2069 - acc: 0.9449
Epoch 12/28

83/83 [==============================] - 2s 30ms/step - loss: 0.1877 - acc: 0.9468
Epoch 13/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1781 - acc: 0.9575
Epoch 14/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1682 - acc: 0.9605
Epoch 15/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1531 - acc: 0.9659
Epoch 16/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1468 - acc: 0.9686
Epoch 17/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1404 - acc: 0.9666
Epoch 18/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1256 - acc: 0.9713
Epoch 19/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1203 - acc: 0.9745
Epoch 20/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1144 - acc: 0.9743
Epoch 21/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1103 - acc: 0.9792
Epoch 22/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1005 - acc: 0.9756
Epoch 23/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0979 - acc: 0.9803
Epoch 24/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0891 - acc: 0.9841
Epoch 25/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0897 - acc: 0.9820
Epoch 26/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0838 - acc: 0.9852
Epoch 27/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0853 - acc: 0.9831
Epoch 28/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0769 - acc: 0.9861
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7685
False 1386
True percentage 0.847205379782
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.72      0.59      0.65       438
      I-PER       0.74      0.45      0.56       214
          O       0.97      0.95      0.96      7318
      B-ORG       0.44      0.48      0.46       296
      I-ORG       0.19      0.24      0.21       151
      B-LOC       0.64      0.46      0.54       218
      I-LOC       0.91      0.15      0.26       141
     B-MISC       0.31      0.16      0.21       141
     I-MISC       0.33      0.34      0.33       154

avg / total       0.89      0.85      0.86      9071

F-1 Score (without O):
0.879299117978
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104112 unique words.
4108 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 277
OOV word occurences: in test 484
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663232     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,362
Trainable params: 6,775,362
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 4s 48ms/step - loss: 1.2042 - acc: 0.6583
Epoch 2/28

83/83 [==============================] - 2s 28ms/step - loss: 0.5468 - acc: 0.8239
Epoch 3/28

83/83 [==============================] - 2s 29ms/step - loss: 0.4432 - acc: 0.8488
Epoch 4/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3967 - acc: 0.8691
Epoch 5/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3505 - acc: 0.8951
Epoch 6/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3144 - acc: 0.9016
Epoch 7/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3110 - acc: 0.9120
Epoch 8/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2717 - acc: 0.9265
Epoch 9/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2502 - acc: 0.9342
Epoch 10/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2329 - acc: 0.9278
Epoch 11/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2224 - acc: 0.9363
Epoch 12/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2138 - acc: 0.9516
Epoch 13/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1962 - acc: 0.9482
Epoch 14/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1849 - acc: 0.9533
Epoch 15/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1763 - acc: 0.9606
Epoch 16/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1622 - acc: 0.9642
Epoch 17/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1516 - acc: 0.9663
Epoch 18/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1401 - acc: 0.9740
Epoch 19/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1405 - acc: 0.9696
Epoch 20/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1246 - acc: 0.9775
Epoch 21/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1151 - acc: 0.9767
Epoch 22/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1134 - acc: 0.9812
Epoch 23/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1048 - acc: 0.9879
Epoch 24/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0992 - acc: 0.9835
Epoch 25/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0905 - acc: 0.9873
Epoch 26/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0900 - acc: 0.9858
Epoch 27/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0844 - acc: 0.9870
Epoch 28/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0736 - acc: 0.9918
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7616
False 1455
True percentage 0.839598721199
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.95      0.95      7318
      B-PER       0.66      0.47      0.55       438
      B-LOC       0.77      0.46      0.58       218
     B-MISC       0.25      0.13      0.18       141
     I-MISC       0.33      0.29      0.31       154
      B-ORG       0.51      0.48      0.50       296
      I-ORG       0.22      0.19      0.20       151
      I-LOC       0.71      0.32      0.44       141
      I-PER       0.77      0.28      0.41       214

avg / total       0.87      0.84      0.85      9071

F-1 Score (without O):
0.438282042611
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104117 unique words.
4113 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 275
OOV word occurences: in test 481
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663552     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,682
Trainable params: 6,775,682
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 4s 49ms/step - loss: 1.0416 - acc: 0.6623
Epoch 2/28

83/83 [==============================] - 2s 29ms/step - loss: 0.5164 - acc: 0.8336
Epoch 3/28

83/83 [==============================] - 2s 29ms/step - loss: 0.4282 - acc: 0.8740
Epoch 4/28

83/83 [==============================] - 2s 29ms/step - loss: 0.3909 - acc: 0.8904
Epoch 5/28

83/83 [==============================] - 2s 29ms/step - loss: 0.3360 - acc: 0.9047
Epoch 6/28

83/83 [==============================] - 2s 29ms/step - loss: 0.3144 - acc: 0.9208
Epoch 7/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2752 - acc: 0.9297
Epoch 8/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2682 - acc: 0.9313
Epoch 9/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2257 - acc: 0.9433
Epoch 10/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2067 - acc: 0.9525
Epoch 11/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1825 - acc: 0.9554
Epoch 12/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1726 - acc: 0.9612
Epoch 13/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1558 - acc: 0.9646
Epoch 14/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1441 - acc: 0.9700
Epoch 15/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1342 - acc: 0.9737
Epoch 16/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1262 - acc: 0.9762
Epoch 17/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1157 - acc: 0.9733
Epoch 18/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1101 - acc: 0.9756
Epoch 19/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0983 - acc: 0.9830
Epoch 20/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0927 - acc: 0.9814
Epoch 21/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0850 - acc: 0.9813
Epoch 22/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0811 - acc: 0.9849
Epoch 23/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0838 - acc: 0.9834
Epoch 24/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0722 - acc: 0.9893
Epoch 25/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0698 - acc: 0.9899
Epoch 26/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0664 - acc: 0.9908
Epoch 27/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0547 - acc: 0.9931
Epoch 28/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0583 - acc: 0.9928
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7695
False 1376
True percentage 0.848307794069
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.95      0.96      7318
      B-ORG       0.50      0.44      0.47       296
      I-ORG       0.24      0.36      0.29       151
      B-PER       0.69      0.59      0.64       438
      I-PER       0.76      0.52      0.62       214
      B-LOC       0.66      0.50      0.57       218
      I-LOC       0.71      0.26      0.37       141
     B-MISC       0.24      0.09      0.13       141
     I-MISC       0.41      0.23      0.29       154

avg / total       0.88      0.85      0.86      9071

F-1 Score (without O):
0.480565371025
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104129 unique words.
4125 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 276
OOV word occurences: in test 491
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6664320     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,776,450
Trainable params: 6,776,450
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 4s 48ms/step - loss: 1.0421 - acc: 0.7225
Epoch 2/28

83/83 [==============================] - 2s 29ms/step - loss: 0.4861 - acc: 0.8503
Epoch 3/28

83/83 [==============================] - 2s 29ms/step - loss: 0.3982 - acc: 0.8705
Epoch 4/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3411 - acc: 0.8953
Epoch 5/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3089 - acc: 0.9033
Epoch 6/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2834 - acc: 0.9198
Epoch 7/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2648 - acc: 0.9286
Epoch 8/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2445 - acc: 0.9296
Epoch 9/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2176 - acc: 0.9436
Epoch 10/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2062 - acc: 0.9536
Epoch 11/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1887 - acc: 0.9541
Epoch 12/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1679 - acc: 0.9598
Epoch 13/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1624 - acc: 0.9616
Epoch 14/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1475 - acc: 0.9683
Epoch 15/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1345 - acc: 0.9740
Epoch 16/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1310 - acc: 0.9729
Epoch 17/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1192 - acc: 0.9768
Epoch 18/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1103 - acc: 0.9825
Epoch 19/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1020 - acc: 0.9851
Epoch 20/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0938 - acc: 0.9842
Epoch 21/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0929 - acc: 0.9830
Epoch 22/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0824 - acc: 0.9879
Epoch 23/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0773 - acc: 0.9878
Epoch 24/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0761 - acc: 0.9898
Epoch 25/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0696 - acc: 0.9905
Epoch 26/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0668 - acc: 0.9894
Epoch 27/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0610 - acc: 0.9912
Epoch 28/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0577 - acc: 0.9931
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7652
False 1419
True percentage 0.843567412634
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.94      0.96      7318
      B-ORG       0.41      0.47      0.44       296
      I-ORG       0.24      0.28      0.26       151
      B-PER       0.70      0.59      0.64       438
      I-PER       0.67      0.42      0.51       214
     B-MISC       0.12      0.06      0.08       141
     I-MISC       0.24      0.07      0.11       154
      B-LOC       0.70      0.52      0.60       218
      I-LOC       0.47      0.58      0.52       141

avg / total       0.88      0.84      0.86      9071

F-1 Score (without O):
0.460681114551
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104132 unique words.
4128 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 275
OOV word occurences: in test 448
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6664512     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,776,642
Trainable params: 6,776,642
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 4s 49ms/step - loss: 0.9245 - acc: 0.7498
Epoch 2/28

83/83 [==============================] - 2s 30ms/step - loss: 0.4400 - acc: 0.8646
Epoch 3/28

83/83 [==============================] - 2s 30ms/step - loss: 0.3896 - acc: 0.8718
Epoch 4/28

83/83 [==============================] - 2s 30ms/step - loss: 0.3208 - acc: 0.9045
Epoch 5/28

83/83 [==============================] - 2s 30ms/step - loss: 0.2908 - acc: 0.9029
Epoch 6/28

83/83 [==============================] - 2s 30ms/step - loss: 0.2683 - acc: 0.9137
Epoch 7/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2455 - acc: 0.9242
Epoch 8/28

83/83 [==============================] - 2s 30ms/step - loss: 0.2228 - acc: 0.9331
Epoch 9/28

83/83 [==============================] - 2s 30ms/step - loss: 0.2027 - acc: 0.9429
Epoch 10/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1887 - acc: 0.9462
Epoch 11/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1715 - acc: 0.9514
Epoch 12/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1561 - acc: 0.9614
Epoch 13/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1438 - acc: 0.9589
Epoch 14/28

83/83 [==============================] - 2s 30ms/step - loss: 0.1330 - acc: 0.9724
Epoch 15/28

83/83 [==============================] - 2s 30ms/step - loss: 0.1271 - acc: 0.9714
Epoch 16/28

83/83 [==============================] - 2s 30ms/step - loss: 0.1183 - acc: 0.9657
Epoch 17/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1098 - acc: 0.9735
Epoch 18/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0949 - acc: 0.9867
Epoch 19/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0968 - acc: 0.9783
Epoch 20/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0848 - acc: 0.9864
Epoch 21/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0802 - acc: 0.9867
Epoch 22/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0711 - acc: 0.9910
Epoch 23/28

83/83 [==============================] - 3s 30ms/step - loss: 0.0696 - acc: 0.9906
Epoch 24/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0677 - acc: 0.9888
Epoch 25/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0617 - acc: 0.9911
Epoch 26/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0562 - acc: 0.9951
Epoch 27/28

83/83 [==============================] - 3s 30ms/step - loss: 0.0525 - acc: 0.9952
Epoch 28/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0537 - acc: 0.9923
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7720
False 1351
True percentage 0.851063829787
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.83      0.57      0.68       438
          O       0.97      0.95      0.96      7318
      B-LOC       0.78      0.51      0.62       218
      B-ORG       0.50      0.65      0.56       296
      I-PER       0.66      0.47      0.55       214
     B-MISC       0.19      0.06      0.09       141
     I-MISC       0.39      0.08      0.13       154
      I-ORG       0.16      0.33      0.21       151
      I-LOC       0.67      0.26      0.38       141

avg / total       0.89      0.85      0.87      9071

F-1 Score (without O):
0.881207974519
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104115 unique words.
4111 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 278
OOV word occurences: in test 552
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663424     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,554
Trainable params: 6,775,554
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 4s 49ms/step - loss: 1.0363 - acc: 0.6787
Epoch 2/28

83/83 [==============================] - 2s 29ms/step - loss: 0.4795 - acc: 0.8447
Epoch 3/28

83/83 [==============================] - 2s 30ms/step - loss: 0.4031 - acc: 0.8670
Epoch 4/28

83/83 [==============================] - 2s 29ms/step - loss: 0.3446 - acc: 0.8964
Epoch 5/28

83/83 [==============================] - 2s 29ms/step - loss: 0.3199 - acc: 0.9027
Epoch 6/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2926 - acc: 0.9170
Epoch 7/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2726 - acc: 0.9169
Epoch 8/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2462 - acc: 0.9329
Epoch 9/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2238 - acc: 0.9403
Epoch 10/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1995 - acc: 0.9471
Epoch 11/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1820 - acc: 0.9562
Epoch 12/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1738 - acc: 0.9505
Epoch 13/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1667 - acc: 0.9567
Epoch 14/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1506 - acc: 0.9687
Epoch 15/28

83/83 [==============================] - 2s 30ms/step - loss: 0.1351 - acc: 0.9720
Epoch 16/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1321 - acc: 0.9730
Epoch 17/28

83/83 [==============================] - 2s 30ms/step - loss: 0.1159 - acc: 0.9737
Epoch 18/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1102 - acc: 0.9799
Epoch 19/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1042 - acc: 0.9781
Epoch 20/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0973 - acc: 0.9836
Epoch 21/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0890 - acc: 0.9869
Epoch 22/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0818 - acc: 0.9869
Epoch 23/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0904 - acc: 0.9794
Epoch 24/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0745 - acc: 0.9926
Epoch 25/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0722 - acc: 0.9876
Epoch 26/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0676 - acc: 0.9931
Epoch 27/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0634 - acc: 0.9926
Epoch 28/28

83/83 [==============================] - 2s 30ms/step - loss: 0.0616 - acc: 0.9942
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7553
False 1518
True percentage 0.83265351119
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.95      0.96      7318
     B-MISC       0.21      0.04      0.06       141
      B-ORG       0.41      0.44      0.42       296
     I-MISC       0.33      0.09      0.14       154
      B-LOC       0.62      0.67      0.64       218
      I-ORG       0.20      0.36      0.26       151
      B-PER       0.63      0.37      0.47       438
      I-PER       0.63      0.29      0.40       214
      I-LOC       0.45      0.23      0.31       141

avg / total       0.87      0.83      0.85      9071

F-1 Score (without O):
0.394916911046
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104120 unique words.
4116 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 279
OOV word occurences: in test 552
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663744     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,874
Trainable params: 6,775,874
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 4s 49ms/step - loss: 0.9828 - acc: 0.6800
Epoch 2/28

83/83 [==============================] - 2s 29ms/step - loss: 0.4970 - acc: 0.8413
Epoch 3/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3888 - acc: 0.8898
Epoch 4/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3463 - acc: 0.8961
Epoch 5/28

83/83 [==============================] - 2s 29ms/step - loss: 0.3118 - acc: 0.9102
Epoch 6/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2874 - acc: 0.9116
Epoch 7/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2654 - acc: 0.9194
Epoch 8/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2374 - acc: 0.9367
Epoch 9/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2490 - acc: 0.9307
Epoch 10/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2018 - acc: 0.9464
Epoch 11/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1872 - acc: 0.9558
Epoch 12/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1766 - acc: 0.9581
Epoch 13/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1667 - acc: 0.9551
Epoch 14/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1499 - acc: 0.9670
Epoch 15/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1400 - acc: 0.9659
Epoch 16/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1430 - acc: 0.9654
Epoch 17/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1297 - acc: 0.9738
Epoch 18/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1163 - acc: 0.9765
Epoch 19/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1127 - acc: 0.9813
Epoch 20/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1071 - acc: 0.9759
Epoch 21/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0961 - acc: 0.9830
Epoch 22/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0938 - acc: 0.9825
Epoch 23/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0926 - acc: 0.9821
Epoch 24/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0855 - acc: 0.9891
Epoch 25/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0810 - acc: 0.9889
Epoch 26/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0791 - acc: 0.9893
Epoch 27/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0691 - acc: 0.9915
Epoch 28/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0687 - acc: 0.9889
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7492
False 1579
True percentage 0.825928784037
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.42      0.41      0.41       296
          O       0.96      0.95      0.95      7318
     B-MISC       0.23      0.23      0.23       141
     I-MISC       0.17      0.23      0.19       154
      B-LOC       0.78      0.37      0.50       218
      I-LOC       0.65      0.08      0.14       141
      B-PER       0.62      0.39      0.48       438
      I-PER       0.67      0.28      0.40       214
      I-ORG       0.24      0.27      0.26       151

avg / total       0.87      0.83      0.84      9071

F-1 Score (without O):
0.866937143529
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104103 unique words.
4099 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 277
OOV word occurences: in test 557
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6662656     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,774,786
Trainable params: 6,774,786
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 4s 48ms/step - loss: 1.1149 - acc: 0.6752
Epoch 2/28

83/83 [==============================] - 2s 28ms/step - loss: 0.4657 - acc: 0.8606
Epoch 3/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3706 - acc: 0.8917
Epoch 4/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3225 - acc: 0.8987
Epoch 5/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2978 - acc: 0.9078
Epoch 6/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2659 - acc: 0.9180
Epoch 7/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2450 - acc: 0.9278
Epoch 8/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2203 - acc: 0.9320
Epoch 9/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2030 - acc: 0.9420
Epoch 10/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1940 - acc: 0.9488
Epoch 11/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1765 - acc: 0.9480
Epoch 12/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1646 - acc: 0.9562
Epoch 13/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1497 - acc: 0.9675
Epoch 14/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1428 - acc: 0.9665
Epoch 15/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1341 - acc: 0.9745
Epoch 16/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1202 - acc: 0.9718
Epoch 17/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1157 - acc: 0.9735
Epoch 18/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1098 - acc: 0.9782
Epoch 19/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1036 - acc: 0.9725
Epoch 20/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0963 - acc: 0.9821
Epoch 21/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0905 - acc: 0.9835
Epoch 22/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0845 - acc: 0.9845
Epoch 23/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0798 - acc: 0.9864
Epoch 24/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0794 - acc: 0.9834
Epoch 25/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0746 - acc: 0.9862
Epoch 26/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0699 - acc: 0.9903
Epoch 27/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0688 - acc: 0.9899
Epoch 28/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0603 - acc: 0.9901
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7615
False 1456
True percentage 0.839488479771
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.94      0.96      7318
      B-PER       0.60      0.45      0.52       438
      B-ORG       0.41      0.49      0.44       296
     B-MISC       0.30      0.16      0.21       141
      I-PER       0.86      0.37      0.52       214
      I-ORG       0.26      0.38      0.31       151
     I-MISC       0.34      0.29      0.31       154
      B-LOC       0.86      0.49      0.63       218
      I-LOC       0.69      0.56      0.62       141

avg / total       0.89      0.84      0.86      9071

F-1 Score (without O):
0.457929308727
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104064 unique words.
4060 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 558
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660160     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,290
Trainable params: 6,772,290
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 3s 83ms/step - loss: 1.9310 - acc: 0.4375
Epoch 2/28

33/33 [==============================] - 1s 31ms/step - loss: 0.8761 - acc: 0.7833
Epoch 3/28

33/33 [==============================] - 1s 31ms/step - loss: 0.6975 - acc: 0.7979
Epoch 4/28

33/33 [==============================] - 1s 33ms/step - loss: 0.6088 - acc: 0.8093
Epoch 5/28

33/33 [==============================] - 1s 32ms/step - loss: 0.5242 - acc: 0.8282
Epoch 6/28

33/33 [==============================] - 1s 33ms/step - loss: 0.5153 - acc: 0.8334
Epoch 7/28

33/33 [==============================] - 1s 33ms/step - loss: 0.4764 - acc: 0.8506
Epoch 8/28

33/33 [==============================] - 1s 32ms/step - loss: 0.4386 - acc: 0.8607
Epoch 9/28

33/33 [==============================] - 1s 33ms/step - loss: 0.4529 - acc: 0.8784
Epoch 10/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3707 - acc: 0.8924
Epoch 11/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3574 - acc: 0.9100
Epoch 12/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3425 - acc: 0.8991
Epoch 13/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3182 - acc: 0.9145
Epoch 14/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3143 - acc: 0.8923
Epoch 15/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2968 - acc: 0.9456
Epoch 16/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2821 - acc: 0.9406
Epoch 17/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2637 - acc: 0.9347
Epoch 18/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2584 - acc: 0.9534
Epoch 19/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2325 - acc: 0.9597
Epoch 20/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2225 - acc: 0.9690
Epoch 21/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2204 - acc: 0.9508
Epoch 22/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2043 - acc: 0.9685
Epoch 23/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1906 - acc: 0.9728
Epoch 24/28

33/33 [==============================] - 1s 33ms/step - loss: 0.1819 - acc: 0.9769
Epoch 25/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1770 - acc: 0.9701
Epoch 26/28

33/33 [==============================] - 1s 33ms/step - loss: 0.1698 - acc: 0.9770
Epoch 27/28

33/33 [==============================] - 1s 33ms/step - loss: 0.1620 - acc: 0.9804
Epoch 28/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1549 - acc: 0.9760
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7449
False 1622
True percentage 0.821188402602
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.94      0.95      7318
      B-LOC       0.37      0.55      0.44       218
      I-LOC       0.46      0.48      0.47       141
      B-PER       0.68      0.41      0.51       438
      B-ORG       0.42      0.33      0.37       296
      I-ORG       0.25      0.24      0.24       151
     B-MISC       0.40      0.07      0.12       141
     I-MISC       0.30      0.16      0.21       154
      I-PER       0.55      0.19      0.28       214

avg / total       0.86      0.82      0.83      9071

F-1 Score (without O):
0.378040762656
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104073 unique words.
4069 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 277
OOV word occurences: in test 468
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660736     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,866
Trainable params: 6,772,866
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 3s 80ms/step - loss: 1.4810 - acc: 0.5373
Epoch 2/28

33/33 [==============================] - 1s 31ms/step - loss: 0.6870 - acc: 0.8143
Epoch 3/28

33/33 [==============================] - 1s 32ms/step - loss: 0.6194 - acc: 0.8054
Epoch 4/28

33/33 [==============================] - 1s 32ms/step - loss: 0.4859 - acc: 0.8636
Epoch 5/28

33/33 [==============================] - 1s 31ms/step - loss: 0.4721 - acc: 0.8518
Epoch 6/28

33/33 [==============================] - 1s 32ms/step - loss: 0.4269 - acc: 0.8732
Epoch 7/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3949 - acc: 0.8898
Epoch 8/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3511 - acc: 0.9055
Epoch 9/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3739 - acc: 0.8952
Epoch 10/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3210 - acc: 0.9068
Epoch 11/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2806 - acc: 0.9296
Epoch 12/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2665 - acc: 0.9265
Epoch 13/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2629 - acc: 0.9398
Epoch 14/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2543 - acc: 0.9400
Epoch 15/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2270 - acc: 0.9486
Epoch 16/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2165 - acc: 0.9518
Epoch 17/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2004 - acc: 0.9529
Epoch 18/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2009 - acc: 0.9461
Epoch 19/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1943 - acc: 0.9535
Epoch 20/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2072 - acc: 0.9440
Epoch 21/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1855 - acc: 0.9510
Epoch 22/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1673 - acc: 0.9635
Epoch 23/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1748 - acc: 0.9588
Epoch 24/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1514 - acc: 0.9687
Epoch 25/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1474 - acc: 0.9666
Epoch 26/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1467 - acc: 0.9707
Epoch 27/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1327 - acc: 0.9694
Epoch 28/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1379 - acc: 0.9641
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7472
False 1599
True percentage 0.823723955462
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.64      0.48      0.55       438
      I-PER       0.51      0.37      0.43       214
          O       0.97      0.94      0.95      7318
      B-ORG       0.33      0.43      0.37       296
      I-ORG       0.21      0.44      0.28       151
      B-LOC       0.52      0.39      0.44       218
      I-LOC       0.57      0.06      0.10       141
     B-MISC       0.16      0.04      0.07       141
     I-MISC       0.18      0.09      0.12       154

avg / total       0.86      0.82      0.84      9071

F-1 Score (without O):
0.859052463477
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104062 unique words.
4058 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 280
OOV word occurences: in test 496
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660032     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,162
Trainable params: 6,772,162
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 3s 81ms/step - loss: 1.2210 - acc: 0.6248
Epoch 2/28

33/33 [==============================] - 1s 31ms/step - loss: 0.6791 - acc: 0.8014
Epoch 3/28

33/33 [==============================] - 1s 32ms/step - loss: 0.4602 - acc: 0.8658
Epoch 4/28

33/33 [==============================] - 1s 31ms/step - loss: 0.4146 - acc: 0.8803
Epoch 5/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3959 - acc: 0.8855
Epoch 6/28

33/33 [==============================] - 1s 33ms/step - loss: 0.3552 - acc: 0.8834
Epoch 7/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3162 - acc: 0.9259
Epoch 8/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2957 - acc: 0.9151
Epoch 9/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2776 - acc: 0.9082
Epoch 10/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2494 - acc: 0.9411
Epoch 11/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2357 - acc: 0.9370
Epoch 12/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2360 - acc: 0.9370
Epoch 13/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2014 - acc: 0.9504
Epoch 14/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2254 - acc: 0.9414
Epoch 15/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1703 - acc: 0.9661
Epoch 16/28

33/33 [==============================] - 1s 33ms/step - loss: 0.1657 - acc: 0.9539
Epoch 17/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1495 - acc: 0.9654
Epoch 18/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1501 - acc: 0.9700
Epoch 19/28

33/33 [==============================] - 1s 33ms/step - loss: 0.1439 - acc: 0.9663
Epoch 20/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1366 - acc: 0.9608
Epoch 21/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1288 - acc: 0.9675
Epoch 22/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1244 - acc: 0.9707
Epoch 23/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1167 - acc: 0.9739
Epoch 24/28

33/33 [==============================] - 1s 33ms/step - loss: 0.1175 - acc: 0.9763
Epoch 25/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1175 - acc: 0.9766
Epoch 26/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1060 - acc: 0.9912
Epoch 27/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1045 - acc: 0.9880
Epoch 28/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1054 - acc: 0.9847
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7392
False 1679
True percentage 0.814904641164
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.94      0.95      7318
      B-PER       0.66      0.48      0.56       438
      B-LOC       0.62      0.40      0.49       218
     B-MISC       0.07      0.04      0.05       141
     I-MISC       0.25      0.01      0.02       154
      B-ORG       0.33      0.46      0.38       296
      I-ORG       0.15      0.34      0.21       151
      I-LOC       0.17      0.06      0.09       141
      I-PER       0.69      0.17      0.27       214

avg / total       0.85      0.81      0.83      9071

F-1 Score (without O):
0.339898348158
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104072 unique words.
4068 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 279
OOV word occurences: in test 552
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660672     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,802
Trainable params: 6,772,802
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 3s 80ms/step - loss: 1.9497 - acc: 0.3991
Epoch 2/28

33/33 [==============================] - 1s 32ms/step - loss: 0.9784 - acc: 0.7981
Epoch 3/28

33/33 [==============================] - 1s 32ms/step - loss: 0.6220 - acc: 0.8086
Epoch 4/28

33/33 [==============================] - 1s 33ms/step - loss: 0.5592 - acc: 0.8099
Epoch 5/28

33/33 [==============================] - 1s 32ms/step - loss: 0.4907 - acc: 0.8494
Epoch 6/28

33/33 [==============================] - 1s 32ms/step - loss: 0.4550 - acc: 0.8538
Epoch 7/28

33/33 [==============================] - 1s 32ms/step - loss: 0.4625 - acc: 0.8520
Epoch 8/28

33/33 [==============================] - 1s 32ms/step - loss: 0.4081 - acc: 0.8659
Epoch 9/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3928 - acc: 0.8603
Epoch 10/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3532 - acc: 0.8976
Epoch 11/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3273 - acc: 0.9049
Epoch 12/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3095 - acc: 0.9174
Epoch 13/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2841 - acc: 0.9289
Epoch 14/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2894 - acc: 0.9129
Epoch 15/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2659 - acc: 0.9313
Epoch 16/28

33/33 [==============================] - 1s 33ms/step - loss: 0.2522 - acc: 0.9321
Epoch 17/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2747 - acc: 0.9208
Epoch 18/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2297 - acc: 0.9397
Epoch 19/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2122 - acc: 0.9449
Epoch 20/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2218 - acc: 0.9374
Epoch 21/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2025 - acc: 0.9479
Epoch 22/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1932 - acc: 0.9562
Epoch 23/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1763 - acc: 0.9652
Epoch 24/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1791 - acc: 0.9570
Epoch 25/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1664 - acc: 0.9773
Epoch 26/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1598 - acc: 0.9706
Epoch 27/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1478 - acc: 0.9746
Epoch 28/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1309 - acc: 0.9836
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7334
False 1737
True percentage 0.808510638298
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.93      0.94      7318
      B-ORG       0.34      0.43      0.38       296
      I-ORG       0.20      0.23      0.21       151
      B-PER       0.68      0.37      0.48       438
      I-PER       0.43      0.32      0.37       214
      B-LOC       0.63      0.34      0.44       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.30      0.15      0.20       141
     I-MISC       0.22      0.24      0.23       154

avg / total       0.84      0.81      0.82      9071

F-1 Score (without O):
0.342295081967
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104073 unique words.
4069 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 280
OOV word occurences: in test 496
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660736     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,866
Trainable params: 6,772,866
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 3s 83ms/step - loss: 2.2055 - acc: 0.4689
Epoch 2/28

33/33 [==============================] - 1s 31ms/step - loss: 0.6737 - acc: 0.8204
Epoch 3/28

33/33 [==============================] - 1s 31ms/step - loss: 0.6579 - acc: 0.8196
Epoch 4/28

33/33 [==============================] - 1s 31ms/step - loss: 0.5167 - acc: 0.8269
Epoch 5/28

33/33 [==============================] - 1s 31ms/step - loss: 0.4791 - acc: 0.8347
Epoch 6/28

33/33 [==============================] - 1s 31ms/step - loss: 0.4343 - acc: 0.8432
Epoch 7/28

33/33 [==============================] - 1s 31ms/step - loss: 0.4140 - acc: 0.8584
Epoch 8/28

33/33 [==============================] - 1s 31ms/step - loss: 0.4163 - acc: 0.8764
Epoch 9/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3938 - acc: 0.8779
Epoch 10/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3580 - acc: 0.8987
Epoch 11/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3890 - acc: 0.8684
Epoch 12/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3252 - acc: 0.8858
Epoch 13/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3044 - acc: 0.9199
Epoch 14/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3025 - acc: 0.9040
Epoch 15/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2638 - acc: 0.9301
Epoch 16/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2680 - acc: 0.9276
Epoch 17/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2627 - acc: 0.9393
Epoch 18/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2447 - acc: 0.9480
Epoch 19/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2543 - acc: 0.9340
Epoch 20/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2355 - acc: 0.9359
Epoch 21/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2237 - acc: 0.9482
Epoch 22/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2190 - acc: 0.9418
Epoch 23/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2097 - acc: 0.9451
Epoch 24/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2084 - acc: 0.9494
Epoch 25/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1927 - acc: 0.9579
Epoch 26/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2014 - acc: 0.9579
Epoch 27/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1714 - acc: 0.9689
Epoch 28/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1750 - acc: 0.9721
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7420
False 1651
True percentage 0.817991401169
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.94      0.95      7318
      B-ORG       0.48      0.36      0.41       296
      I-ORG       0.18      0.33      0.23       151
      B-PER       0.73      0.33      0.46       438
      I-PER       0.69      0.29      0.41       214
     B-MISC       0.10      0.05      0.07       141
     I-MISC       0.07      0.02      0.03       154
      B-LOC       0.38      0.63      0.47       218
      I-LOC       0.29      0.33      0.31       141

avg / total       0.86      0.82      0.83      9071

F-1 Score (without O):
0.3510537905
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104082 unique words.
4078 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 281
OOV word occurences: in test 539
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6661312     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,773,442
Trainable params: 6,773,442
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 3s 81ms/step - loss: 1.5691 - acc: 0.5176
Epoch 2/28

33/33 [==============================] - 1s 32ms/step - loss: 0.6816 - acc: 0.8167
Epoch 3/28

33/33 [==============================] - 1s 31ms/step - loss: 0.5307 - acc: 0.8339
Epoch 4/28

33/33 [==============================] - 1s 32ms/step - loss: 0.4913 - acc: 0.8397
Epoch 5/28

33/33 [==============================] - 1s 32ms/step - loss: 0.4140 - acc: 0.8688
Epoch 6/28

33/33 [==============================] - 1s 31ms/step - loss: 0.5008 - acc: 0.8367
Epoch 7/28

33/33 [==============================] - 1s 30ms/step - loss: 0.3692 - acc: 0.8946
Epoch 8/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3568 - acc: 0.8716
Epoch 9/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3259 - acc: 0.9048
Epoch 10/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3375 - acc: 0.8930
Epoch 11/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2978 - acc: 0.9049
Epoch 12/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2777 - acc: 0.9181
Epoch 13/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2692 - acc: 0.9293
Epoch 14/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2735 - acc: 0.9070
Epoch 15/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2377 - acc: 0.9244
Epoch 16/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2245 - acc: 0.9358
Epoch 17/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2177 - acc: 0.9281
Epoch 18/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2068 - acc: 0.9374
Epoch 19/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1941 - acc: 0.9438
Epoch 20/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2064 - acc: 0.9389
Epoch 21/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1829 - acc: 0.9527
Epoch 22/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1712 - acc: 0.9526
Epoch 23/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1750 - acc: 0.9561
Epoch 24/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1476 - acc: 0.9731
Epoch 25/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1506 - acc: 0.9680
Epoch 26/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1417 - acc: 0.9706
Epoch 27/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1341 - acc: 0.9763
Epoch 28/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1337 - acc: 0.9701
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7368
False 1703
True percentage 0.812258846875
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.80      0.31      0.45       438
          O       0.97      0.94      0.95      7318
      B-LOC       0.49      0.36      0.41       218
      B-ORG       0.29      0.55      0.38       296
      I-PER       0.62      0.21      0.31       214
     B-MISC       0.07      0.01      0.02       141
     I-MISC       0.22      0.06      0.10       154
      I-ORG       0.15      0.40      0.22       151
      I-LOC       0.00      0.00      0.00       141

avg / total       0.86      0.81      0.83      9071

F-1 Score (without O):
0.851123926092
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104063 unique words.
4059 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 281
OOV word occurences: in test 556
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660096     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,226
Trainable params: 6,772,226
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 3s 84ms/step - loss: 1.7709 - acc: 0.4788
Epoch 2/28

33/33 [==============================] - 1s 33ms/step - loss: 0.8454 - acc: 0.7858
Epoch 3/28

33/33 [==============================] - 1s 32ms/step - loss: 0.5826 - acc: 0.8177
Epoch 4/28

33/33 [==============================] - 1s 31ms/step - loss: 0.5618 - acc: 0.8385
Epoch 5/28

33/33 [==============================] - 1s 31ms/step - loss: 0.4589 - acc: 0.8435
Epoch 6/28

33/33 [==============================] - 1s 31ms/step - loss: 0.4220 - acc: 0.8548
Epoch 7/28

33/33 [==============================] - 1s 31ms/step - loss: 0.4086 - acc: 0.8542
Epoch 8/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3909 - acc: 0.8515
Epoch 9/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3523 - acc: 0.8830
Epoch 10/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3428 - acc: 0.8888
Epoch 11/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3080 - acc: 0.9151
Epoch 12/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3650 - acc: 0.8874
Epoch 13/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2832 - acc: 0.9205
Epoch 14/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2579 - acc: 0.9413
Epoch 15/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2450 - acc: 0.9367
Epoch 16/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2520 - acc: 0.9223
Epoch 17/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2229 - acc: 0.9507
Epoch 18/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2190 - acc: 0.9560
Epoch 19/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2092 - acc: 0.9576
Epoch 20/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1937 - acc: 0.9605
Epoch 21/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1940 - acc: 0.9610
Epoch 22/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2478 - acc: 0.9214
Epoch 23/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1754 - acc: 0.9673
Epoch 24/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1729 - acc: 0.9646
Epoch 25/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1594 - acc: 0.9746
Epoch 26/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1603 - acc: 0.9702
Epoch 27/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1415 - acc: 0.9860
Epoch 28/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1459 - acc: 0.9770
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7360
False 1711
True percentage 0.811376915445
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.95      0.94      7318
     B-MISC       0.13      0.05      0.07       141
      B-ORG       0.25      0.42      0.31       296
     I-MISC       0.27      0.05      0.08       154
      B-LOC       0.69      0.30      0.42       218
      I-ORG       0.19      0.18      0.19       151
      B-PER       0.65      0.25      0.36       438
      I-PER       0.52      0.32      0.40       214
      I-LOC       0.00      0.00      0.00       141

avg / total       0.84      0.81      0.81      9071

F-1 Score (without O):
0.283618581907
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104069 unique words.
4065 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 281
OOV word occurences: in test 562
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660480     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,610
Trainable params: 6,772,610
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 3s 81ms/step - loss: 1.7629 - acc: 0.4501
Epoch 2/28

33/33 [==============================] - 1s 33ms/step - loss: 0.8006 - acc: 0.7938
Epoch 3/28

33/33 [==============================] - 1s 32ms/step - loss: 0.5204 - acc: 0.8256
Epoch 4/28

33/33 [==============================] - 1s 31ms/step - loss: 0.4677 - acc: 0.8355
Epoch 5/28

33/33 [==============================] - 1s 32ms/step - loss: 0.4659 - acc: 0.8351
Epoch 6/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3725 - acc: 0.8671
Epoch 7/28

33/33 [==============================] - 1s 32ms/step - loss: 0.4130 - acc: 0.8499
Epoch 8/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3644 - acc: 0.8717
Epoch 9/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3302 - acc: 0.8843
Epoch 10/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3147 - acc: 0.9237
Epoch 11/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3040 - acc: 0.9181
Epoch 12/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2926 - acc: 0.9252
Epoch 13/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2827 - acc: 0.9060
Epoch 14/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2541 - acc: 0.9310
Epoch 15/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2404 - acc: 0.9381
Epoch 16/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2322 - acc: 0.9446
Epoch 17/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2320 - acc: 0.9507
Epoch 18/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2209 - acc: 0.9510
Epoch 19/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2055 - acc: 0.9641
Epoch 20/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2109 - acc: 0.9564
Epoch 21/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1900 - acc: 0.9576
Epoch 22/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1819 - acc: 0.9654
Epoch 23/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1806 - acc: 0.9586
Epoch 24/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1747 - acc: 0.9632
Epoch 25/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1738 - acc: 0.9704
Epoch 26/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1593 - acc: 0.9741
Epoch 27/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1492 - acc: 0.9783
Epoch 28/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1406 - acc: 0.9708
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7350
False 1721
True percentage 0.810274501158
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.47      0.25      0.33       296
          O       0.97      0.92      0.95      7318
     B-MISC       0.18      0.20      0.19       141
     I-MISC       0.19      0.49      0.28       154
      B-LOC       0.43      0.58      0.49       218
      I-LOC       0.60      0.33      0.43       141
      B-PER       0.57      0.37      0.45       438
      I-PER       0.36      0.31      0.33       214
      I-ORG       0.00      0.00      0.00       151

avg / total       0.86      0.81      0.83      9071

F-1 Score (without O):
0.849585425669
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104064 unique words.
4060 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 280
OOV word occurences: in test 560
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660160     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,290
Trainable params: 6,772,290
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 3s 81ms/step - loss: 1.4334 - acc: 0.5344
Epoch 2/28

33/33 [==============================] - 1s 31ms/step - loss: 0.7315 - acc: 0.8369
Epoch 3/28

33/33 [==============================] - 1s 31ms/step - loss: 0.4759 - acc: 0.8570
Epoch 4/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3913 - acc: 0.8838
Epoch 5/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3571 - acc: 0.8899
Epoch 6/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3329 - acc: 0.8945
Epoch 7/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3199 - acc: 0.9098
Epoch 8/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3485 - acc: 0.8869
Epoch 9/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2842 - acc: 0.9091
Epoch 10/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2510 - acc: 0.9379
Epoch 11/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2438 - acc: 0.9507
Epoch 12/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2268 - acc: 0.9407
Epoch 13/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2240 - acc: 0.9387
Epoch 14/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2147 - acc: 0.9560
Epoch 15/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1952 - acc: 0.9556
Epoch 16/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2028 - acc: 0.9550
Epoch 17/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1839 - acc: 0.9593
Epoch 18/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1713 - acc: 0.9605
Epoch 19/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1620 - acc: 0.9636
Epoch 20/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1565 - acc: 0.9624
Epoch 21/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1396 - acc: 0.9698
Epoch 22/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1491 - acc: 0.9594
Epoch 23/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1475 - acc: 0.9688
Epoch 24/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1381 - acc: 0.9683
Epoch 25/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1301 - acc: 0.9690
Epoch 26/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1271 - acc: 0.9765
Epoch 27/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1153 - acc: 0.9733
Epoch 28/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1168 - acc: 0.9761
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7312
False 1759
True percentage 0.806085326866
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.94      0.95      7318
      B-PER       0.73      0.31      0.44       438
      B-ORG       0.28      0.42      0.34       296
     B-MISC       0.25      0.23      0.24       141
      I-PER       0.87      0.15      0.26       214
      I-ORG       0.16      0.44      0.24       151
     I-MISC       0.37      0.12      0.18       154
      B-LOC       1.00      0.01      0.03       218
      I-LOC       0.00      0.00      0.00       141

avg / total       0.87      0.81      0.81      9071

F-1 Score (without O):
0.275517011341
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 8 unique labels.
Found 104048 unique words.
4044 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 567
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659136     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,116
Trainable params: 6,771,116
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 2s 131ms/step - loss: 2.3707 - acc: 0.0796
Epoch 2/28

16/16 [==============================] - 0s 29ms/step - loss: 0.9635 - acc: 0.8230
Epoch 3/28

16/16 [==============================] - 0s 29ms/step - loss: 0.5052 - acc: 0.8643
Epoch 4/28

16/16 [==============================] - 0s 29ms/step - loss: 0.4205 - acc: 0.8761
Epoch 5/28

16/16 [==============================] - 0s 28ms/step - loss: 0.3872 - acc: 0.8673
Epoch 6/28

16/16 [==============================] - 0s 28ms/step - loss: 0.4576 - acc: 0.8673
Epoch 7/28

16/16 [==============================] - 0s 28ms/step - loss: 0.3337 - acc: 0.8702
Epoch 8/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2924 - acc: 0.9145
Epoch 9/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2560 - acc: 0.9115
Epoch 10/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2368 - acc: 0.9381
Epoch 11/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2124 - acc: 0.9617
Epoch 12/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2045 - acc: 0.9705
Epoch 13/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1998 - acc: 0.9617
Epoch 14/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1676 - acc: 0.9646
Epoch 15/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1784 - acc: 0.9735
Epoch 16/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1514 - acc: 0.9764
Epoch 17/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1532 - acc: 0.9764
Epoch 18/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1522 - acc: 0.9764
Epoch 19/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1351 - acc: 0.9794
Epoch 20/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1235 - acc: 0.9853
Epoch 21/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1181 - acc: 0.9882
Epoch 22/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1196 - acc: 0.9853
Epoch 23/28

16/16 [==============================] - 0s 30ms/step - loss: 0.1039 - acc: 0.9941
Epoch 24/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1010 - acc: 0.9912
Epoch 25/28

16/16 [==============================] - 0s 29ms/step - loss: 0.0937 - acc: 0.9912
Epoch 26/28

16/16 [==============================] - 0s 29ms/step - loss: 0.0907 - acc: 0.9882
Epoch 27/28

16/16 [==============================] - 0s 28ms/step - loss: 0.0823 - acc: 0.9971
Epoch 28/28

16/16 [==============================] - 0s 28ms/step - loss: 0.0789 - acc: 0.9882
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7272
False 1585
True percentage 0.821045500734
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.94      0.94      7318
      B-LOC       0.36      0.35      0.35       218
      I-LOC       0.32      0.19      0.24       141
      B-PER       0.58      0.27      0.37       438
      B-ORG       0.29      0.41      0.34       296
      I-ORG       0.23      0.32      0.27       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.11      0.02      0.03       154

avg / total       0.83      0.82      0.82      8857

F-1 Score (without O):
0.289068231842
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104055 unique words.
4051 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 567
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659584     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,714
Trainable params: 6,771,714
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 2s 130ms/step - loss: 2.3232 - acc: 0.2044
Epoch 2/28

16/16 [==============================] - 0s 28ms/step - loss: 0.9693 - acc: 0.7673
Epoch 3/28

16/16 [==============================] - 0s 28ms/step - loss: 0.7212 - acc: 0.7642
Epoch 4/28

16/16 [==============================] - 0s 29ms/step - loss: 0.6661 - acc: 0.8176
Epoch 5/28

16/16 [==============================] - 0s 29ms/step - loss: 0.7299 - acc: 0.7642
Epoch 6/28

16/16 [==============================] - 0s 28ms/step - loss: 0.6293 - acc: 0.8459
Epoch 7/28

16/16 [==============================] - 0s 29ms/step - loss: 0.4781 - acc: 0.8585
Epoch 8/28

16/16 [==============================] - 0s 29ms/step - loss: 0.4458 - acc: 0.8805
Epoch 9/28

16/16 [==============================] - 0s 29ms/step - loss: 0.4058 - acc: 0.8931
Epoch 10/28

16/16 [==============================] - 0s 30ms/step - loss: 0.3773 - acc: 0.9025
Epoch 11/28

16/16 [==============================] - 0s 29ms/step - loss: 0.3609 - acc: 0.9025
Epoch 12/28

16/16 [==============================] - 0s 29ms/step - loss: 0.3280 - acc: 0.9340
Epoch 13/28

16/16 [==============================] - 0s 30ms/step - loss: 0.3125 - acc: 0.9465
Epoch 14/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2735 - acc: 0.9340
Epoch 15/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2565 - acc: 0.9591
Epoch 16/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2467 - acc: 0.9560
Epoch 17/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2358 - acc: 0.9686
Epoch 18/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2046 - acc: 0.9780
Epoch 19/28

16/16 [==============================] - 0s 30ms/step - loss: 0.1994 - acc: 0.9654
Epoch 20/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1928 - acc: 0.9654
Epoch 21/28

16/16 [==============================] - 0s 30ms/step - loss: 0.1821 - acc: 0.9780
Epoch 22/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1623 - acc: 0.9780
Epoch 23/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1519 - acc: 0.9811
Epoch 24/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1505 - acc: 0.9843
Epoch 25/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1315 - acc: 0.9906
Epoch 26/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1268 - acc: 0.9843
Epoch 27/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1152 - acc: 0.9906
Epoch 28/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1066 - acc: 0.9937
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7247
False 1824
True percentage 0.798919633998
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.57      0.33      0.42       438
      I-PER       0.57      0.23      0.33       214
          O       0.96      0.93      0.94      7318
      B-ORG       0.23      0.37      0.28       296
      I-ORG       0.20      0.45      0.27       151
      B-LOC       0.41      0.37      0.39       218
      I-LOC       0.43      0.09      0.14       141
     B-MISC       0.06      0.01      0.02       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.84      0.80      0.81      9071

F-1 Score (without O):
0.84126984127
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104048 unique words.
4044 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 565
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659136     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,266
Trainable params: 6,771,266
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 2s 129ms/step - loss: 2.8085 - acc: 0.0341
Epoch 2/28

16/16 [==============================] - 0s 27ms/step - loss: 1.1749 - acc: 0.8019
Epoch 3/28

16/16 [==============================] - 0s 27ms/step - loss: 0.7562 - acc: 0.7895
Epoch 4/28

16/16 [==============================] - 0s 28ms/step - loss: 0.6333 - acc: 0.8328
Epoch 5/28

16/16 [==============================] - 0s 27ms/step - loss: 0.5586 - acc: 0.8111
Epoch 6/28

16/16 [==============================] - 0s 27ms/step - loss: 0.4852 - acc: 0.8793
Epoch 7/28

16/16 [==============================] - 0s 26ms/step - loss: 0.4617 - acc: 0.8421
Epoch 8/28

16/16 [==============================] - 0s 27ms/step - loss: 0.4417 - acc: 0.8793
Epoch 9/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3773 - acc: 0.8947
Epoch 10/28

16/16 [==============================] - 0s 26ms/step - loss: 0.3486 - acc: 0.9195
Epoch 11/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3362 - acc: 0.9102
Epoch 12/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3056 - acc: 0.9226
Epoch 13/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2822 - acc: 0.9133
Epoch 14/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2656 - acc: 0.9381
Epoch 15/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2388 - acc: 0.9288
Epoch 16/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2422 - acc: 0.9505
Epoch 17/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2154 - acc: 0.9598
Epoch 18/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2106 - acc: 0.9350
Epoch 19/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1953 - acc: 0.9567
Epoch 20/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2020 - acc: 0.9690
Epoch 21/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1761 - acc: 0.9752
Epoch 22/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1640 - acc: 0.9814
Epoch 23/28

16/16 [==============================] - 0s 25ms/step - loss: 0.1525 - acc: 0.9814
Epoch 24/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1485 - acc: 0.9721
Epoch 25/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1459 - acc: 0.9845
Epoch 26/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1439 - acc: 0.9783
Epoch 27/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1184 - acc: 0.9938
Epoch 28/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1187 - acc: 0.9876
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7306
False 1765
True percentage 0.805423878293
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.94      0.94      7318
      B-PER       0.50      0.46      0.48       438
      B-LOC       0.57      0.36      0.44       218
     B-MISC       0.03      0.02      0.03       141
     I-MISC       0.29      0.01      0.02       154
      B-ORG       0.31      0.37      0.34       296
      I-ORG       0.13      0.27      0.18       151
      I-LOC       1.00      0.06      0.12       141
      I-PER       0.71      0.07      0.13       214

avg / total       0.86      0.81      0.82      9071

F-1 Score (without O):
0.299416720674
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104056 unique words.
4052 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 559
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659648     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,778
Trainable params: 6,771,778
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 2s 127ms/step - loss: 2.2752 - acc: 0.1167
Epoch 2/28

16/16 [==============================] - 0s 28ms/step - loss: 0.9492 - acc: 0.7692
Epoch 3/28

16/16 [==============================] - 0s 27ms/step - loss: 0.7243 - acc: 0.7772
Epoch 4/28

16/16 [==============================] - 0s 27ms/step - loss: 0.6539 - acc: 0.7772
Epoch 5/28

16/16 [==============================] - 0s 29ms/step - loss: 0.6617 - acc: 0.8833
Epoch 6/28

16/16 [==============================] - 0s 28ms/step - loss: 0.5722 - acc: 0.7851
Epoch 7/28

16/16 [==============================] - 0s 27ms/step - loss: 0.4902 - acc: 0.9019
Epoch 8/28

16/16 [==============================] - 0s 28ms/step - loss: 0.4182 - acc: 0.8912
Epoch 9/28

16/16 [==============================] - 0s 28ms/step - loss: 0.3908 - acc: 0.9125
Epoch 10/28

16/16 [==============================] - 0s 29ms/step - loss: 0.3530 - acc: 0.9178
Epoch 11/28

16/16 [==============================] - 0s 28ms/step - loss: 0.3161 - acc: 0.9469
Epoch 12/28

16/16 [==============================] - 0s 28ms/step - loss: 0.3040 - acc: 0.9390
Epoch 13/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2738 - acc: 0.9523
Epoch 14/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2724 - acc: 0.9469
Epoch 15/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2365 - acc: 0.9602
Epoch 16/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2286 - acc: 0.9682
Epoch 17/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2160 - acc: 0.9655
Epoch 18/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2079 - acc: 0.9682
Epoch 19/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1824 - acc: 0.9735
Epoch 20/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1724 - acc: 0.9655
Epoch 21/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1480 - acc: 0.9788
Epoch 22/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1456 - acc: 0.9708
Epoch 23/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1422 - acc: 0.9761
Epoch 24/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1325 - acc: 0.9788
Epoch 25/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1391 - acc: 0.9841
Epoch 26/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1111 - acc: 0.9867
Epoch 27/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1121 - acc: 0.9841
Epoch 28/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1066 - acc: 0.9894
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7168
False 1903
True percentage 0.790210561129
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.93      0.94      7318
      B-ORG       0.27      0.33      0.30       296
      I-ORG       0.11      0.38      0.17       151
      B-PER       0.57      0.21      0.30       438
      I-PER       0.38      0.22      0.28       214
      B-LOC       0.70      0.41      0.51       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.14      0.09      0.11       154

avg / total       0.83      0.79      0.80      9071

F-1 Score (without O):
0.252315554136
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104057 unique words.
4053 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 567
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659712     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,842
Trainable params: 6,771,842
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 2s 131ms/step - loss: 2.7150 - acc: 0.0375
Epoch 2/28

16/16 [==============================] - 0s 27ms/step - loss: 1.2670 - acc: 0.7962
Epoch 3/28

16/16 [==============================] - 0s 27ms/step - loss: 0.7786 - acc: 0.7775
Epoch 4/28

16/16 [==============================] - 0s 29ms/step - loss: 0.6177 - acc: 0.8365
Epoch 5/28

16/16 [==============================] - 0s 27ms/step - loss: 0.7191 - acc: 0.7802
Epoch 6/28

16/16 [==============================] - 0s 28ms/step - loss: 0.7164 - acc: 0.8445
Epoch 7/28

16/16 [==============================] - 0s 28ms/step - loss: 0.4826 - acc: 0.8579
Epoch 8/28

16/16 [==============================] - 0s 28ms/step - loss: 0.4603 - acc: 0.8820
Epoch 9/28

16/16 [==============================] - 0s 27ms/step - loss: 0.4058 - acc: 0.8981
Epoch 10/28

16/16 [==============================] - 0s 28ms/step - loss: 0.3734 - acc: 0.9035
Epoch 11/28

16/16 [==============================] - 0s 28ms/step - loss: 0.3518 - acc: 0.9169
Epoch 12/28

16/16 [==============================] - 0s 28ms/step - loss: 0.3274 - acc: 0.9249
Epoch 13/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3225 - acc: 0.9249
Epoch 14/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2972 - acc: 0.9357
Epoch 15/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2814 - acc: 0.9223
Epoch 16/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2536 - acc: 0.9491
Epoch 17/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2479 - acc: 0.9598
Epoch 18/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2306 - acc: 0.9491
Epoch 19/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2301 - acc: 0.9517
Epoch 20/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2203 - acc: 0.9651
Epoch 21/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2054 - acc: 0.9678
Epoch 22/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1868 - acc: 0.9678
Epoch 23/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1758 - acc: 0.9705
Epoch 24/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1803 - acc: 0.9759
Epoch 25/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1628 - acc: 0.9759
Epoch 26/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1503 - acc: 0.9812
Epoch 27/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1460 - acc: 0.9759
Epoch 28/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1446 - acc: 0.9786
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7175
False 1896
True percentage 0.79098225113
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.93      0.94      7318
      B-ORG       0.27      0.38      0.31       296
      I-ORG       0.13      0.26      0.18       151
      B-PER       0.52      0.21      0.30       438
      I-PER       0.53      0.29      0.37       214
     B-MISC       0.06      0.11      0.08       141
     I-MISC       0.40      0.01      0.03       154
      B-LOC       0.47      0.17      0.24       218
      I-LOC       0.66      0.27      0.38       141

avg / total       0.85      0.79      0.81      9071

F-1 Score (without O):
0.253907496013
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104059 unique words.
4055 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 553
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659840     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,970
Trainable params: 6,771,970
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 2s 129ms/step - loss: 2.1815 - acc: 0.1482
Epoch 2/28

16/16 [==============================] - 0s 27ms/step - loss: 0.9308 - acc: 0.7951
Epoch 3/28

16/16 [==============================] - 0s 27ms/step - loss: 0.7211 - acc: 0.8113
Epoch 4/28

16/16 [==============================] - 0s 27ms/step - loss: 0.6419 - acc: 0.8032
Epoch 5/28

16/16 [==============================] - 0s 27ms/step - loss: 0.5921 - acc: 0.8760
Epoch 6/28

16/16 [==============================] - 0s 27ms/step - loss: 0.4917 - acc: 0.8248
Epoch 7/28

16/16 [==============================] - 0s 27ms/step - loss: 0.4312 - acc: 0.8895
Epoch 8/28

16/16 [==============================] - 0s 28ms/step - loss: 0.3765 - acc: 0.8814
Epoch 9/28

16/16 [==============================] - 0s 28ms/step - loss: 0.3640 - acc: 0.8949
Epoch 10/28

16/16 [==============================] - 0s 28ms/step - loss: 0.3333 - acc: 0.9084
Epoch 11/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3120 - acc: 0.9218
Epoch 12/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2807 - acc: 0.9191
Epoch 13/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2655 - acc: 0.9623
Epoch 14/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2619 - acc: 0.9299
Epoch 15/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2585 - acc: 0.9461
Epoch 16/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2354 - acc: 0.9407
Epoch 17/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2143 - acc: 0.9542
Epoch 18/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1990 - acc: 0.9569
Epoch 19/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1809 - acc: 0.9730
Epoch 20/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1639 - acc: 0.9757
Epoch 21/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1651 - acc: 0.9784
Epoch 22/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1537 - acc: 0.9838
Epoch 23/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1460 - acc: 0.9811
Epoch 24/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1330 - acc: 0.9919
Epoch 25/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1362 - acc: 0.9811
Epoch 26/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1304 - acc: 0.9946
Epoch 27/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1282 - acc: 0.9892
Epoch 28/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1185 - acc: 0.9892
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7354
False 1717
True percentage 0.810715466872
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.49      0.44      0.47       438
          O       0.95      0.94      0.95      7318
      B-LOC       0.62      0.28      0.38       218
      B-ORG       0.33      0.36      0.35       296
      I-PER       0.56      0.26      0.35       214
     B-MISC       0.14      0.04      0.06       141
     I-MISC       0.11      0.01      0.01       154
      I-ORG       0.17      0.39      0.23       151
      I-LOC       0.64      0.05      0.09       141

avg / total       0.85      0.81      0.82      9071

F-1 Score (without O):
0.854670247687
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104050 unique words.
4046 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 565
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659264     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,394
Trainable params: 6,771,394
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 2s 130ms/step - loss: 2.2473 - acc: 0.2887
Epoch 2/28

16/16 [==============================] - 0s 27ms/step - loss: 1.0914 - acc: 0.7430
Epoch 3/28

16/16 [==============================] - 0s 29ms/step - loss: 0.8236 - acc: 0.7923
Epoch 4/28

16/16 [==============================] - 0s 29ms/step - loss: 0.8445 - acc: 0.7430
Epoch 5/28

16/16 [==============================] - 0s 28ms/step - loss: 0.7145 - acc: 0.8803
Epoch 6/28

16/16 [==============================] - 0s 29ms/step - loss: 0.5480 - acc: 0.8099
Epoch 7/28

16/16 [==============================] - 0s 28ms/step - loss: 0.4764 - acc: 0.8732
Epoch 8/28

16/16 [==============================] - 0s 28ms/step - loss: 0.4215 - acc: 0.8979
Epoch 9/28

16/16 [==============================] - 0s 28ms/step - loss: 0.3855 - acc: 0.9190
Epoch 10/28

16/16 [==============================] - 0s 29ms/step - loss: 0.3529 - acc: 0.9190
Epoch 11/28

16/16 [==============================] - 0s 28ms/step - loss: 0.3176 - acc: 0.9472
Epoch 12/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2827 - acc: 0.9507
Epoch 13/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2656 - acc: 0.9648
Epoch 14/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2492 - acc: 0.9437
Epoch 15/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2430 - acc: 0.9613
Epoch 16/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2171 - acc: 0.9507
Epoch 17/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1951 - acc: 0.9754
Epoch 18/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1800 - acc: 0.9754
Epoch 19/28

16/16 [==============================] - 0s 30ms/step - loss: 0.1633 - acc: 0.9859
Epoch 20/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1613 - acc: 0.9789
Epoch 21/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1428 - acc: 0.9824
Epoch 22/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1413 - acc: 0.9859
Epoch 23/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1291 - acc: 0.9859
Epoch 24/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1207 - acc: 0.9894
Epoch 25/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1032 - acc: 0.9930
Epoch 26/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1059 - acc: 0.9930
Epoch 27/28

16/16 [==============================] - 0s 28ms/step - loss: 0.0962 - acc: 0.9965
Epoch 28/28

16/16 [==============================] - 0s 27ms/step - loss: 0.0848 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7239
False 1832
True percentage 0.798037702569
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.94      0.94      7318
     B-MISC       0.05      0.01      0.02       141
      B-ORG       0.22      0.41      0.29       296
     I-MISC       0.14      0.04      0.06       154
      B-LOC       0.70      0.32      0.44       218
      I-ORG       0.24      0.23      0.23       151
      B-PER       0.28      0.10      0.15       438
      I-PER       0.33      0.29      0.31       214
      I-LOC       1.00      0.01      0.01       141

avg / total       0.83      0.80      0.80      9071

F-1 Score (without O):
0.228879165264
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104049 unique words.
4045 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 564
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659200     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,330
Trainable params: 6,771,330
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 2s 130ms/step - loss: 2.5781 - acc: 0.0230
Epoch 2/28

16/16 [==============================] - 0s 30ms/step - loss: 0.9304 - acc: 0.8257
Epoch 3/28

16/16 [==============================] - 0s 28ms/step - loss: 0.6257 - acc: 0.8257
Epoch 4/28

16/16 [==============================] - 0s 28ms/step - loss: 0.5636 - acc: 0.8750
Epoch 5/28

16/16 [==============================] - 0s 30ms/step - loss: 0.5415 - acc: 0.8257
Epoch 6/28

16/16 [==============================] - 0s 29ms/step - loss: 0.4534 - acc: 0.8882
Epoch 7/28

16/16 [==============================] - 0s 28ms/step - loss: 0.3939 - acc: 0.8618
Epoch 8/28

16/16 [==============================] - 0s 29ms/step - loss: 0.3415 - acc: 0.9145
Epoch 9/28

16/16 [==============================] - 0s 29ms/step - loss: 0.3154 - acc: 0.9079
Epoch 10/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2851 - acc: 0.9309
Epoch 11/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2720 - acc: 0.9276
Epoch 12/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2542 - acc: 0.9342
Epoch 13/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2315 - acc: 0.9572
Epoch 14/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2089 - acc: 0.9408
Epoch 15/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2024 - acc: 0.9770
Epoch 16/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1840 - acc: 0.9737
Epoch 17/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1800 - acc: 0.9737
Epoch 18/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1704 - acc: 0.9605
Epoch 19/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1587 - acc: 0.9901
Epoch 20/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1441 - acc: 0.9803
Epoch 21/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1382 - acc: 0.9770
Epoch 22/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1240 - acc: 0.9934
Epoch 23/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1132 - acc: 0.9901
Epoch 24/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1110 - acc: 0.9934
Epoch 25/28

16/16 [==============================] - 0s 28ms/step - loss: 0.0991 - acc: 0.9967
Epoch 26/28

16/16 [==============================] - 0s 28ms/step - loss: 0.0898 - acc: 0.9934
Epoch 27/28

16/16 [==============================] - 0s 28ms/step - loss: 0.0910 - acc: 0.9934
Epoch 28/28

16/16 [==============================] - 0s 28ms/step - loss: 0.0858 - acc: 0.9934
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7218
False 1853
True percentage 0.795722632565
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.20      0.29      0.24       296
          O       0.95      0.93      0.94      7318
     B-MISC       0.17      0.08      0.11       141
     I-MISC       0.18      0.40      0.24       154
      B-LOC       0.55      0.26      0.35       218
      I-LOC       0.44      0.35      0.39       141
      B-PER       0.46      0.18      0.25       438
      I-PER       0.46      0.29      0.36       214
      I-ORG       0.00      0.00      0.00       151

avg / total       0.83      0.80      0.81      9071

F-1 Score (without O):
0.846395728271
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 8 unique labels.
Found 104049 unique words.
4045 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 564
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659200     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,180
Trainable params: 6,771,180
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 2s 131ms/step - loss: 2.7996 - acc: 0.0546
Epoch 2/28

16/16 [==============================] - 0s 28ms/step - loss: 1.0068 - acc: 0.8225
Epoch 3/28

16/16 [==============================] - 0s 29ms/step - loss: 0.5881 - acc: 0.8328
Epoch 4/28

16/16 [==============================] - 0s 28ms/step - loss: 0.5207 - acc: 0.8635
Epoch 5/28

16/16 [==============================] - 0s 28ms/step - loss: 0.4768 - acc: 0.8328
Epoch 6/28

16/16 [==============================] - 0s 30ms/step - loss: 0.3910 - acc: 0.9010
Epoch 7/28

16/16 [==============================] - 0s 29ms/step - loss: 0.3556 - acc: 0.8635
Epoch 8/28

16/16 [==============================] - 0s 28ms/step - loss: 0.3104 - acc: 0.9113
Epoch 9/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2921 - acc: 0.9147
Epoch 10/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2635 - acc: 0.9317
Epoch 11/28

16/16 [==============================] - 0s 30ms/step - loss: 0.2574 - acc: 0.9352
Epoch 12/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2298 - acc: 0.9352
Epoch 13/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2118 - acc: 0.9488
Epoch 14/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1995 - acc: 0.9454
Epoch 15/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1882 - acc: 0.9590
Epoch 16/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1735 - acc: 0.9488
Epoch 17/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1690 - acc: 0.9625
Epoch 18/28

16/16 [==============================] - 0s 30ms/step - loss: 0.1504 - acc: 0.9727
Epoch 19/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1383 - acc: 0.9727
Epoch 20/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1421 - acc: 0.9659
Epoch 21/28

16/16 [==============================] - 0s 30ms/step - loss: 0.1314 - acc: 0.9625
Epoch 22/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1095 - acc: 0.9829
Epoch 23/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1081 - acc: 0.9795
Epoch 24/28

16/16 [==============================] - 0s 29ms/step - loss: 0.0995 - acc: 0.9795
Epoch 25/28

16/16 [==============================] - 0s 27ms/step - loss: 0.0984 - acc: 0.9727
Epoch 26/28

16/16 [==============================] - 0s 29ms/step - loss: 0.0948 - acc: 0.9761
Epoch 27/28

16/16 [==============================] - 0s 29ms/step - loss: 0.0898 - acc: 0.9898
Epoch 28/28

16/16 [==============================] - 0s 28ms/step - loss: 0.0706 - acc: 0.9932
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7216
False 1714
True percentage 0.808062709966
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.92      0.95      0.93      7318
      B-PER       0.35      0.30      0.32       438
      B-ORG       0.27      0.36      0.31       296
     B-MISC       0.00      0.00      0.00       141
      I-PER       0.31      0.24      0.27       214
      I-ORG       0.14      0.04      0.06       151
     I-MISC       0.50      0.01      0.01       154
      B-LOC       0.00      0.00      0.00       218

avg / total       0.80      0.81      0.80      8930

F-1 Score (without O):
0.229885057471
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 8 unique labels.
Found 104041 unique words.
4037 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658688     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,668
Trainable params: 6,770,668
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 2s 234ms/step - loss: 1.9047 - acc: 0.3444
Epoch 2/28

8/8 [==============================] - 0s 33ms/step - loss: 0.7720 - acc: 0.8013
Epoch 3/28

8/8 [==============================] - 0s 33ms/step - loss: 0.6123 - acc: 0.8212
Epoch 4/28

8/8 [==============================] - 0s 33ms/step - loss: 0.5420 - acc: 0.8146
Epoch 5/28

8/8 [==============================] - 0s 34ms/step - loss: 0.5357 - acc: 0.8609
Epoch 6/28

8/8 [==============================] - 0s 33ms/step - loss: 0.4904 - acc: 0.8146
Epoch 7/28

8/8 [==============================] - 0s 33ms/step - loss: 0.3348 - acc: 0.9338
Epoch 8/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2885 - acc: 0.9338
Epoch 9/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2549 - acc: 0.9536
Epoch 10/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2276 - acc: 0.9735
Epoch 11/28

8/8 [==============================] - 0s 35ms/step - loss: 0.2011 - acc: 0.9603
Epoch 12/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1804 - acc: 0.9801
Epoch 13/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1383 - acc: 0.9868
Epoch 14/28

8/8 [==============================] - 0s 35ms/step - loss: 0.1532 - acc: 0.9934
Epoch 15/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1282 - acc: 0.9934
Epoch 16/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1272 - acc: 1.0000
Epoch 17/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1173 - acc: 0.9934
Epoch 18/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0977 - acc: 0.9934
Epoch 19/28

8/8 [==============================] - 0s 35ms/step - loss: 0.1191 - acc: 1.0000
Epoch 20/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0729 - acc: 1.0000
Epoch 21/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0707 - acc: 1.0000
Epoch 22/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0706 - acc: 1.0000
Epoch 23/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0702 - acc: 1.0000
Epoch 24/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0645 - acc: 1.0000
Epoch 25/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0653 - acc: 1.0000
Epoch 26/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0527 - acc: 1.0000
Epoch 27/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0480 - acc: 1.0000
Epoch 28/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0465 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7191
False 1666
True percentage 0.811900191939
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.93      0.94      7318
      B-LOC       0.50      0.29      0.37       218
      I-LOC       0.47      0.29      0.36       141
      B-PER       0.36      0.21      0.26       438
      B-ORG       0.29      0.42      0.34       296
      I-ORG       0.17      0.25      0.20       151
     B-MISC       0.08      0.01      0.01       141
     I-MISC       0.10      0.08      0.09       154

avg / total       0.83      0.81      0.82      8857

F-1 Score (without O):
0.264948084497
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104046 unique words.
4042 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659008     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,138
Trainable params: 6,771,138
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 2s 234ms/step - loss: 2.1944 - acc: 0.0884
Epoch 2/28

8/8 [==============================] - 0s 34ms/step - loss: 0.9719 - acc: 0.7687
Epoch 3/28

8/8 [==============================] - 0s 36ms/step - loss: 0.6861 - acc: 0.7687
Epoch 4/28

8/8 [==============================] - 0s 34ms/step - loss: 0.6390 - acc: 0.8571
Epoch 5/28

8/8 [==============================] - 0s 34ms/step - loss: 0.6708 - acc: 0.7687
Epoch 6/28

8/8 [==============================] - 0s 34ms/step - loss: 0.5345 - acc: 0.8980
Epoch 7/28

8/8 [==============================] - 0s 34ms/step - loss: 0.3974 - acc: 0.8776
Epoch 8/28

8/8 [==============================] - 0s 34ms/step - loss: 0.3457 - acc: 0.9320
Epoch 9/28

8/8 [==============================] - 0s 34ms/step - loss: 0.3012 - acc: 0.9184
Epoch 10/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2820 - acc: 0.9592
Epoch 11/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2267 - acc: 0.9660
Epoch 12/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2180 - acc: 0.9388
Epoch 13/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1971 - acc: 0.9660
Epoch 14/28

8/8 [==============================] - 0s 35ms/step - loss: 0.1843 - acc: 0.9592
Epoch 15/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1674 - acc: 0.9796
Epoch 16/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1542 - acc: 0.9728
Epoch 17/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1269 - acc: 1.0000
Epoch 18/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1420 - acc: 0.9864
Epoch 19/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1151 - acc: 1.0000
Epoch 20/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1073 - acc: 1.0000
Epoch 21/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0982 - acc: 1.0000
Epoch 22/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0885 - acc: 1.0000
Epoch 23/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0830 - acc: 1.0000
Epoch 24/28

8/8 [==============================] - 0s 35ms/step - loss: 0.0773 - acc: 1.0000
Epoch 25/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0654 - acc: 1.0000
Epoch 26/28

8/8 [==============================] - 0s 35ms/step - loss: 0.0557 - acc: 1.0000
Epoch 27/28

8/8 [==============================] - 0s 35ms/step - loss: 0.0697 - acc: 1.0000
Epoch 28/28

8/8 [==============================] - 0s 35ms/step - loss: 0.0577 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7124
False 1947
True percentage 0.785359938265
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.19      0.20      0.20       438
      I-PER       0.32      0.18      0.23       214
          O       0.95      0.93      0.94      7318
      B-ORG       0.25      0.41      0.31       296
      I-ORG       0.18      0.25      0.21       151
      B-LOC       0.77      0.11      0.19       218
      I-LOC       0.68      0.19      0.30       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.82      0.79      0.79      9071

F-1 Score (without O):
0.843828715365
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104043 unique words.
4039 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 565
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658816     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,946
Trainable params: 6,770,946
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 2s 234ms/step - loss: 2.7980 - acc: 0.0592
Epoch 2/28

8/8 [==============================] - 0s 34ms/step - loss: 1.1906 - acc: 0.7751
Epoch 3/28

8/8 [==============================] - 0s 34ms/step - loss: 0.8465 - acc: 0.7870
Epoch 4/28

8/8 [==============================] - 0s 34ms/step - loss: 0.7939 - acc: 0.8225
Epoch 5/28

8/8 [==============================] - 0s 32ms/step - loss: 0.8081 - acc: 0.7870
Epoch 6/28

8/8 [==============================] - 0s 33ms/step - loss: 0.6137 - acc: 0.8284
Epoch 7/28

8/8 [==============================] - 0s 32ms/step - loss: 0.5408 - acc: 0.7929
Epoch 8/28

8/8 [==============================] - 0s 33ms/step - loss: 0.4938 - acc: 0.8225
Epoch 9/28

8/8 [==============================] - 0s 32ms/step - loss: 0.4338 - acc: 0.8343
Epoch 10/28

8/8 [==============================] - 0s 33ms/step - loss: 0.3707 - acc: 0.9053
Epoch 11/28

8/8 [==============================] - 0s 33ms/step - loss: 0.3564 - acc: 0.8935
Epoch 12/28

8/8 [==============================] - 0s 33ms/step - loss: 0.3318 - acc: 0.9290
Epoch 13/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2831 - acc: 0.9527
Epoch 14/28

8/8 [==============================] - 0s 32ms/step - loss: 0.2669 - acc: 0.9704
Epoch 15/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2543 - acc: 0.9586
Epoch 16/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2369 - acc: 0.9586
Epoch 17/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2087 - acc: 0.9763
Epoch 18/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1862 - acc: 0.9882
Epoch 19/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1668 - acc: 0.9822
Epoch 20/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1618 - acc: 0.9822
Epoch 21/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1510 - acc: 0.9882
Epoch 22/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1361 - acc: 0.9882
Epoch 23/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1086 - acc: 0.9941
Epoch 24/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1050 - acc: 0.9941
Epoch 25/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1192 - acc: 0.9941
Epoch 26/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1018 - acc: 0.9882
Epoch 27/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1035 - acc: 0.9941
Epoch 28/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0909 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7325
False 1746
True percentage 0.807518465439
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.94      0.94      7318
      B-PER       0.48      0.43      0.45       438
      B-LOC       0.55      0.41      0.47       218
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-ORG       0.37      0.35      0.36       296
      I-ORG       0.08      0.13      0.10       151
      I-LOC       0.67      0.06      0.10       141
      I-PER       0.44      0.07      0.12       214

avg / total       0.82      0.81      0.81      9071

F-1 Score (without O):
0.296296296296
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104046 unique words.
4042 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 559
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659008     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,138
Trainable params: 6,771,138
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 2s 232ms/step - loss: 2.6085 - acc: 0.1215
Epoch 2/28

8/8 [==============================] - 0s 33ms/step - loss: 1.3368 - acc: 0.6243
Epoch 3/28

8/8 [==============================] - 0s 33ms/step - loss: 1.3329 - acc: 0.6409
Epoch 4/28

8/8 [==============================] - 0s 33ms/step - loss: 1.1717 - acc: 0.6464
Epoch 5/28

8/8 [==============================] - 0s 33ms/step - loss: 0.9059 - acc: 0.7735
Epoch 6/28

8/8 [==============================] - 0s 32ms/step - loss: 0.7901 - acc: 0.7624
Epoch 7/28

8/8 [==============================] - 0s 32ms/step - loss: 0.7070 - acc: 0.8343
Epoch 8/28

8/8 [==============================] - 0s 34ms/step - loss: 0.6453 - acc: 0.8287
Epoch 9/28

8/8 [==============================] - 0s 33ms/step - loss: 0.5888 - acc: 0.8950
Epoch 10/28

8/8 [==============================] - 0s 33ms/step - loss: 0.5483 - acc: 0.8729
Epoch 11/28

8/8 [==============================] - 0s 33ms/step - loss: 0.4852 - acc: 0.9116
Epoch 12/28

8/8 [==============================] - 0s 32ms/step - loss: 0.4473 - acc: 0.9116
Epoch 13/28

8/8 [==============================] - 0s 33ms/step - loss: 0.4240 - acc: 0.9116
Epoch 14/28

8/8 [==============================] - 0s 33ms/step - loss: 0.3754 - acc: 0.9282
Epoch 15/28

8/8 [==============================] - 0s 32ms/step - loss: 0.3574 - acc: 0.9337
Epoch 16/28

8/8 [==============================] - 0s 33ms/step - loss: 0.3323 - acc: 0.9282
Epoch 17/28

8/8 [==============================] - 0s 33ms/step - loss: 0.3104 - acc: 0.9392
Epoch 18/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2641 - acc: 0.9613
Epoch 19/28

8/8 [==============================] - 0s 32ms/step - loss: 0.2652 - acc: 0.9337
Epoch 20/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2581 - acc: 0.9448
Epoch 21/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1956 - acc: 0.9779
Epoch 22/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1955 - acc: 0.9724
Epoch 23/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1806 - acc: 0.9834
Epoch 24/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1614 - acc: 0.9890
Epoch 25/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1657 - acc: 0.9890
Epoch 26/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1688 - acc: 0.9779
Epoch 27/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1404 - acc: 1.0000
Epoch 28/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1350 - acc: 0.9945
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7103
False 1968
True percentage 0.783044868261
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.92      0.94      7318
      B-ORG       0.27      0.32      0.29       296
      I-ORG       0.15      0.39      0.22       151
      B-PER       0.36      0.26      0.30       438
      I-PER       0.26      0.34      0.29       214
      B-LOC       0.50      0.00      0.01       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.24      0.13      0.17       154

avg / total       0.82      0.78      0.79      9071

F-1 Score (without O):
0.225484072455
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104051 unique words.
4047 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659328     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,458
Trainable params: 6,771,458
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 2s 238ms/step - loss: 2.2998 - acc: 0.0852
Epoch 2/28

8/8 [==============================] - 0s 33ms/step - loss: 1.0317 - acc: 0.7841
Epoch 3/28

8/8 [==============================] - 0s 34ms/step - loss: 0.8740 - acc: 0.8068
Epoch 4/28

8/8 [==============================] - 0s 34ms/step - loss: 0.8595 - acc: 0.7841
Epoch 5/28

8/8 [==============================] - 0s 32ms/step - loss: 0.6195 - acc: 0.8352
Epoch 6/28

8/8 [==============================] - 0s 33ms/step - loss: 0.5323 - acc: 0.8068
Epoch 7/28

8/8 [==============================] - 0s 32ms/step - loss: 0.4534 - acc: 0.8523
Epoch 8/28

8/8 [==============================] - 0s 33ms/step - loss: 0.4170 - acc: 0.9034
Epoch 9/28

8/8 [==============================] - 0s 34ms/step - loss: 0.3779 - acc: 0.8920
Epoch 10/28

8/8 [==============================] - 0s 34ms/step - loss: 0.3239 - acc: 0.9545
Epoch 11/28

8/8 [==============================] - 0s 34ms/step - loss: 0.3256 - acc: 0.9034
Epoch 12/28

8/8 [==============================] - 0s 32ms/step - loss: 0.3148 - acc: 0.9545
Epoch 13/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2743 - acc: 0.9261
Epoch 14/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2672 - acc: 0.9375
Epoch 15/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2373 - acc: 0.9432
Epoch 16/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2054 - acc: 0.9602
Epoch 17/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1886 - acc: 0.9830
Epoch 18/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1923 - acc: 0.9773
Epoch 19/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1794 - acc: 0.9602
Epoch 20/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1493 - acc: 0.9830
Epoch 21/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1468 - acc: 0.9773
Epoch 22/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1414 - acc: 0.9886
Epoch 23/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1271 - acc: 0.9886
Epoch 24/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1184 - acc: 1.0000
Epoch 25/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1086 - acc: 1.0000
Epoch 26/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1118 - acc: 0.9943
Epoch 27/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1024 - acc: 0.9943
Epoch 28/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0956 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 6996
False 2075
True percentage 0.771249035387
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.92      0.93      7318
      B-ORG       0.17      0.13      0.15       296
      I-ORG       0.14      0.42      0.21       151
      B-PER       0.52      0.08      0.13       438
      I-PER       0.30      0.01      0.03       214
     B-MISC       0.06      0.18      0.08       141
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.70      0.29      0.41       218
      I-LOC       0.74      0.10      0.18       141

avg / total       0.83      0.77      0.78      9071

F-1 Score (without O):
0.157208088715
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104046 unique words.
4042 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 553
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659008     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,138
Trainable params: 6,771,138
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 2s 234ms/step - loss: 2.7479 - acc: 0.0207
Epoch 2/28

8/8 [==============================] - 0s 35ms/step - loss: 1.2319 - acc: 0.8083
Epoch 3/28

8/8 [==============================] - 0s 33ms/step - loss: 0.6087 - acc: 0.8290
Epoch 4/28

8/8 [==============================] - 0s 34ms/step - loss: 0.4795 - acc: 0.8446
Epoch 5/28

8/8 [==============================] - 0s 33ms/step - loss: 0.4011 - acc: 0.9223
Epoch 6/28

8/8 [==============================] - 0s 34ms/step - loss: 0.3710 - acc: 0.8549
Epoch 7/28

8/8 [==============================] - 0s 34ms/step - loss: 0.3495 - acc: 0.9326
Epoch 8/28

8/8 [==============================] - 0s 32ms/step - loss: 0.2849 - acc: 0.8964
Epoch 9/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2538 - acc: 0.9482
Epoch 10/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2381 - acc: 0.9430
Epoch 11/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1948 - acc: 0.9585
Epoch 12/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1834 - acc: 0.9637
Epoch 13/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1731 - acc: 0.9637
Epoch 14/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1623 - acc: 0.9741
Epoch 15/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1404 - acc: 0.9689
Epoch 16/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1408 - acc: 0.9793
Epoch 17/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1250 - acc: 0.9896
Epoch 18/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1223 - acc: 0.9793
Epoch 19/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1093 - acc: 0.9896
Epoch 20/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1137 - acc: 0.9896
Epoch 21/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1000 - acc: 0.9948
Epoch 22/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0886 - acc: 0.9896
Epoch 23/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0858 - acc: 0.9948
Epoch 24/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0878 - acc: 1.0000
Epoch 25/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0718 - acc: 1.0000
Epoch 26/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0673 - acc: 1.0000
Epoch 27/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0629 - acc: 1.0000
Epoch 28/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0660 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7032
False 2039
True percentage 0.775217726822
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.21      0.38      0.27       438
          O       0.94      0.91      0.93      7318
      B-LOC       0.46      0.10      0.16       218
      B-ORG       0.40      0.30      0.34       296
      I-PER       0.29      0.30      0.30       214
     B-MISC       0.03      0.01      0.01       141
     I-MISC       0.00      0.00      0.00       154
      I-ORG       0.16      0.13      0.14       151
      I-LOC       0.00      0.00      0.00       141

avg / total       0.80      0.78      0.78      9071

F-1 Score (without O):
0.838965959787
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104042 unique words.
4038 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658752     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,882
Trainable params: 6,770,882
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 2s 238ms/step - loss: 2.5133 - acc: 0.0455
Epoch 2/28

8/8 [==============================] - 0s 35ms/step - loss: 1.1684 - acc: 0.7197
Epoch 3/28

8/8 [==============================] - 0s 35ms/step - loss: 0.7561 - acc: 0.7348
Epoch 4/28

8/8 [==============================] - 0s 34ms/step - loss: 0.6321 - acc: 0.8409
Epoch 5/28

8/8 [==============================] - 0s 34ms/step - loss: 0.7032 - acc: 0.7348
Epoch 6/28

8/8 [==============================] - 0s 35ms/step - loss: 0.6512 - acc: 0.8485
Epoch 7/28

8/8 [==============================] - 0s 33ms/step - loss: 0.4230 - acc: 0.8788
Epoch 8/28

8/8 [==============================] - 0s 33ms/step - loss: 0.3855 - acc: 0.9167
Epoch 9/28

8/8 [==============================] - 0s 34ms/step - loss: 0.3269 - acc: 0.9470
Epoch 10/28

8/8 [==============================] - 0s 34ms/step - loss: 0.3161 - acc: 0.9318
Epoch 11/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2818 - acc: 0.9545
Epoch 12/28

8/8 [==============================] - 0s 35ms/step - loss: 0.2473 - acc: 0.9848
Epoch 13/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2382 - acc: 0.9697
Epoch 14/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1902 - acc: 0.9848
Epoch 15/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2065 - acc: 0.9848
Epoch 16/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1825 - acc: 1.0000
Epoch 17/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1730 - acc: 0.9621
Epoch 18/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1402 - acc: 1.0000
Epoch 19/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1404 - acc: 1.0000
Epoch 20/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1319 - acc: 0.9924
Epoch 21/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1277 - acc: 0.9924
Epoch 22/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1063 - acc: 1.0000
Epoch 23/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1022 - acc: 1.0000
Epoch 24/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0990 - acc: 1.0000
Epoch 25/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1027 - acc: 0.9848
Epoch 26/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0841 - acc: 1.0000
Epoch 27/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0702 - acc: 1.0000
Epoch 28/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0805 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7114
False 1957
True percentage 0.784257523978
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.93      0.93      7318
     B-MISC       0.04      0.01      0.01       141
      B-ORG       0.21      0.48      0.29       296
     I-MISC       0.15      0.01      0.02       154
      B-LOC       0.44      0.25      0.32       218
      I-ORG       0.16      0.11      0.13       151
      B-PER       0.25      0.07      0.11       438
      I-PER       0.29      0.30      0.29       214
      I-LOC       1.00      0.03      0.06       141

avg / total       0.82      0.78      0.79      9071

F-1 Score (without O):
0.206554121152
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 8 unique labels.
Found 104043 unique words.
4039 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 564
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658816     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,796
Trainable params: 6,770,796
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 2s 237ms/step - loss: 2.3694 - acc: 0.0633
Epoch 2/28

8/8 [==============================] - 0s 34ms/step - loss: 0.9654 - acc: 0.8165
Epoch 3/28

8/8 [==============================] - 0s 35ms/step - loss: 0.5882 - acc: 0.8291
Epoch 4/28

8/8 [==============================] - 0s 34ms/step - loss: 0.4548 - acc: 0.8797
Epoch 5/28

8/8 [==============================] - 0s 35ms/step - loss: 0.4159 - acc: 0.8291
Epoch 6/28

8/8 [==============================] - 0s 34ms/step - loss: 0.4421 - acc: 0.9051
Epoch 7/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2978 - acc: 0.8987
Epoch 8/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2707 - acc: 0.9241
Epoch 9/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2346 - acc: 0.9494
Epoch 10/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2037 - acc: 0.9684
Epoch 11/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1971 - acc: 0.9620
Epoch 12/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1732 - acc: 0.9684
Epoch 13/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1429 - acc: 0.9873
Epoch 14/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1397 - acc: 0.9937
Epoch 15/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1294 - acc: 0.9937
Epoch 16/28

8/8 [==============================] - 0s 35ms/step - loss: 0.1112 - acc: 1.0000
Epoch 17/28

8/8 [==============================] - 0s 35ms/step - loss: 0.1035 - acc: 0.9937
Epoch 18/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1028 - acc: 1.0000
Epoch 19/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0879 - acc: 0.9937
Epoch 20/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0839 - acc: 1.0000
Epoch 21/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0718 - acc: 1.0000
Epoch 22/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0708 - acc: 1.0000
Epoch 23/28

8/8 [==============================] - 0s 35ms/step - loss: 0.0599 - acc: 1.0000
Epoch 24/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0609 - acc: 0.9937
Epoch 25/28

8/8 [==============================] - 0s 35ms/step - loss: 0.0548 - acc: 1.0000
Epoch 26/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0473 - acc: 1.0000
Epoch 27/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0473 - acc: 1.0000
Epoch 28/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0474 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7107
False 1813
True percentage 0.796748878924
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.16      0.33      0.22       296
          O       0.93      0.94      0.93      7318
     B-MISC       0.06      0.03      0.04       141
     I-MISC       0.14      0.06      0.09       154
      B-LOC       0.28      0.24      0.26       218
      I-LOC       0.31      0.04      0.06       141
      B-PER       0.38      0.13      0.19       438
      I-PER       0.41      0.13      0.20       214

avg / total       0.81      0.80      0.80      8920

F-1 Score (without O):
0.847847121432
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 8 unique labels.
Found 104041 unique words.
4037 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 567
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658688     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,668
Trainable params: 6,770,668
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 2s 232ms/step - loss: 2.7144 - acc: 0.0403
Epoch 2/28

8/8 [==============================] - 0s 33ms/step - loss: 0.7881 - acc: 0.8389
Epoch 3/28

8/8 [==============================] - 0s 33ms/step - loss: 0.4972 - acc: 0.8591
Epoch 4/28

8/8 [==============================] - 0s 33ms/step - loss: 0.4429 - acc: 0.8926
Epoch 5/28

8/8 [==============================] - 0s 34ms/step - loss: 0.3414 - acc: 0.8591
Epoch 6/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2857 - acc: 0.9262
Epoch 7/28

8/8 [==============================] - 0s 34ms/step - loss: 0.2695 - acc: 0.9128
Epoch 8/28

8/8 [==============================] - 0s 35ms/step - loss: 0.2288 - acc: 0.9195
Epoch 9/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2243 - acc: 0.9463
Epoch 10/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1971 - acc: 0.9262
Epoch 11/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1715 - acc: 0.9664
Epoch 12/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1590 - acc: 0.9799
Epoch 13/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1376 - acc: 0.9799
Epoch 14/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1348 - acc: 0.9866
Epoch 15/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1219 - acc: 0.9866
Epoch 16/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1193 - acc: 0.9732
Epoch 17/28

8/8 [==============================] - 0s 32ms/step - loss: 0.0992 - acc: 0.9933
Epoch 18/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0833 - acc: 1.0000
Epoch 19/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1070 - acc: 0.9866
Epoch 20/28

8/8 [==============================] - 0s 32ms/step - loss: 0.0767 - acc: 0.9933
Epoch 21/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0841 - acc: 0.9933
Epoch 22/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0786 - acc: 0.9799
Epoch 23/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0807 - acc: 0.9933
Epoch 24/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0582 - acc: 1.0000
Epoch 25/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0697 - acc: 0.9933
Epoch 26/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0511 - acc: 1.0000
Epoch 27/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0581 - acc: 1.0000
Epoch 28/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0525 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7168
False 1762
True percentage 0.802687569989
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.90      0.95      0.92      7318
      B-PER       0.39      0.19      0.26       438
      B-ORG       0.22      0.36      0.27       296
     B-MISC       0.40      0.01      0.03       141
      I-PER       0.33      0.15      0.21       214
      I-ORG       0.00      0.00      0.00       151
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.90      0.04      0.08       218

avg / total       0.80      0.80      0.79      8930

F-1 Score (without O):
0.193284193284
