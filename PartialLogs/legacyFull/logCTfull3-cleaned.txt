Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 85s 51ms/step - loss: 0.4495 - acc: 0.8621
Epoch 2/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.2518 - acc: 0.9230
Epoch 3/28

1674/1674 [==============================] - 79s 47ms/step - loss: 0.1978 - acc: 0.9409
Epoch 4/28

1674/1674 [==============================] - 79s 47ms/step - loss: 0.1660 - acc: 0.9507
Epoch 5/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.1408 - acc: 0.9593
Epoch 6/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.1215 - acc: 0.9656
Epoch 7/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.1078 - acc: 0.9693
Epoch 8/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0984 - acc: 0.9728
Epoch 9/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.0876 - acc: 0.9750
Epoch 10/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0806 - acc: 0.9776
Epoch 11/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.0712 - acc: 0.9808
Epoch 12/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.0665 - acc: 0.9817
Epoch 13/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0613 - acc: 0.9831
Epoch 14/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.0569 - acc: 0.9838
Epoch 15/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0527 - acc: 0.9857
Epoch 16/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.0507 - acc: 0.9860
Epoch 17/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.0479 - acc: 0.9866
Epoch 18/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0466 - acc: 0.9870
Epoch 19/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.0436 - acc: 0.9874
Epoch 20/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0406 - acc: 0.9885
Epoch 21/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0395 - acc: 0.9890
Epoch 22/28

1674/1674 [==============================] - 78s 46ms/step - loss: 0.0356 - acc: 0.9902
Epoch 23/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0341 - acc: 0.9906
Epoch 24/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.0339 - acc: 0.9902
Epoch 25/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.0324 - acc: 0.9909
Epoch 26/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0315 - acc: 0.9912
Epoch 27/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.0307 - acc: 0.9913
Epoch 28/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0280 - acc: 0.9923
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8241
False 830
True percentage 0.908499614155
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
      B-PER       0.91      0.82      0.86       438
      B-ORG       0.73      0.74      0.73       296
      I-ORG       0.58      0.65      0.61       151
      I-PER       0.88      0.66      0.76       214
      B-LOC       0.76      0.74      0.75       218
     B-MISC       0.43      0.30      0.36       141
      I-LOC       0.74      0.79      0.77       141
     I-MISC       0.53      0.43      0.47       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.713988713989
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 86s 51ms/step - loss: 0.3954 - acc: 0.8805
Epoch 2/28

1674/1674 [==============================] - 75s 45ms/step - loss: 0.2296 - acc: 0.9290
Epoch 3/28

1674/1674 [==============================] - 79s 47ms/step - loss: 0.1801 - acc: 0.9480
Epoch 4/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.1493 - acc: 0.9549
Epoch 5/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.1278 - acc: 0.9631
Epoch 6/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.1133 - acc: 0.9674
Epoch 7/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0982 - acc: 0.9727
Epoch 8/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.0886 - acc: 0.9757
Epoch 9/28

1674/1674 [==============================] - 78s 46ms/step - loss: 0.0811 - acc: 0.9765
Epoch 10/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0716 - acc: 0.9796
Epoch 11/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.0682 - acc: 0.9804
Epoch 12/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0620 - acc: 0.9826
Epoch 13/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0566 - acc: 0.9843
Epoch 14/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0534 - acc: 0.9847
Epoch 15/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0510 - acc: 0.9857
Epoch 16/28

1674/1674 [==============================] - 78s 46ms/step - loss: 0.0480 - acc: 0.9865
Epoch 17/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.0446 - acc: 0.9873
Epoch 18/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0414 - acc: 0.9884
Epoch 19/28

1674/1674 [==============================] - 79s 47ms/step - loss: 0.0402 - acc: 0.9884
Epoch 20/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0369 - acc: 0.9897
Epoch 21/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.0351 - acc: 0.9900
Epoch 22/28

1674/1674 [==============================] - 79s 47ms/step - loss: 0.0333 - acc: 0.9907
Epoch 23/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0336 - acc: 0.9899
Epoch 24/28

1674/1674 [==============================] - 78s 46ms/step - loss: 0.0303 - acc: 0.9919
Epoch 25/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0297 - acc: 0.9914
Epoch 26/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0289 - acc: 0.9917
Epoch 27/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.0275 - acc: 0.9923
Epoch 28/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0272 - acc: 0.9922
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8265
False 806
True percentage 0.911145408444
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.91      0.84      0.87       438
      B-ORG       0.77      0.75      0.76       296
      I-ORG       0.66      0.64      0.65       151
     B-MISC       0.43      0.33      0.37       141
     I-MISC       0.53      0.44      0.48       154
      I-PER       0.91      0.64      0.75       214
      B-LOC       0.77      0.75      0.76       218
      I-LOC       0.74      0.81      0.77       141

avg / total       0.94      0.91      0.93      9071

F-1 Score (without O):
0.726129901227
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 85s 51ms/step - loss: 0.4114 - acc: 0.8740
Epoch 2/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.2364 - acc: 0.9295
Epoch 3/28

1674/1674 [==============================] - 79s 47ms/step - loss: 0.1870 - acc: 0.9445
Epoch 4/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.1563 - acc: 0.9543
Epoch 5/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.1334 - acc: 0.9618
Epoch 6/28

1674/1674 [==============================] - 78s 46ms/step - loss: 0.1169 - acc: 0.9661
Epoch 7/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.1024 - acc: 0.9714
Epoch 8/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.0918 - acc: 0.9744
Epoch 9/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.0851 - acc: 0.9759
Epoch 10/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0755 - acc: 0.9790
Epoch 11/28

1674/1674 [==============================] - 79s 47ms/step - loss: 0.0694 - acc: 0.9809
Epoch 12/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0643 - acc: 0.9824
Epoch 13/28

1674/1674 [==============================] - 78s 46ms/step - loss: 0.0596 - acc: 0.9835
Epoch 14/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.0556 - acc: 0.9845
Epoch 15/28

1674/1674 [==============================] - 75s 45ms/step - loss: 0.0508 - acc: 0.9863
Epoch 16/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.0489 - acc: 0.9870
Epoch 17/28

1674/1674 [==============================] - 78s 46ms/step - loss: 0.0458 - acc: 0.9874
Epoch 18/28

1674/1674 [==============================] - 74s 44ms/step - loss: 0.0430 - acc: 0.9881
Epoch 19/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0407 - acc: 0.9887
Epoch 20/28

1674/1674 [==============================] - 75s 45ms/step - loss: 0.0394 - acc: 0.9896
Epoch 21/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.0371 - acc: 0.9899
Epoch 22/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.0348 - acc: 0.9906
Epoch 23/28

1674/1674 [==============================] - 75s 45ms/step - loss: 0.0337 - acc: 0.9908
Epoch 24/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.0315 - acc: 0.9918
Epoch 25/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0306 - acc: 0.9915
Epoch 26/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0279 - acc: 0.9921
Epoch 27/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.0280 - acc: 0.9922
Epoch 28/28

1674/1674 [==============================] - 75s 45ms/step - loss: 0.0268 - acc: 0.9924
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8262
False 809
True percentage 0.910814684158
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.77      0.73      0.75       296
      B-PER       0.90      0.84      0.87       438
      I-PER       0.90      0.66      0.76       214
      B-LOC       0.76      0.77      0.76       218
      I-LOC       0.73      0.81      0.77       141
      I-ORG       0.66      0.63      0.64       151
     B-MISC       0.43      0.31      0.36       141
     I-MISC       0.54      0.41      0.47       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.723569931117
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 85s 51ms/step - loss: 0.4026 - acc: 0.8776
Epoch 2/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.2342 - acc: 0.9305
Epoch 3/28

1674/1674 [==============================] - 79s 47ms/step - loss: 0.1841 - acc: 0.9469
Epoch 4/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.1515 - acc: 0.9558
Epoch 5/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.1292 - acc: 0.9633
Epoch 6/28

1674/1674 [==============================] - 79s 47ms/step - loss: 0.1133 - acc: 0.9682
Epoch 7/28

1674/1674 [==============================] - 75s 45ms/step - loss: 0.1016 - acc: 0.9710
Epoch 8/28

1674/1674 [==============================] - 78s 46ms/step - loss: 0.0895 - acc: 0.9751
Epoch 9/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.0811 - acc: 0.9776
Epoch 10/28

1674/1674 [==============================] - 75s 45ms/step - loss: 0.0745 - acc: 0.9790
Epoch 11/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0690 - acc: 0.9808
Epoch 12/28

1674/1674 [==============================] - 75s 45ms/step - loss: 0.0639 - acc: 0.9826
Epoch 13/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.0586 - acc: 0.9832
Epoch 14/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.0542 - acc: 0.9849
Epoch 15/28

1674/1674 [==============================] - 75s 45ms/step - loss: 0.0496 - acc: 0.9867
Epoch 16/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.0467 - acc: 0.9875
Epoch 17/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.0455 - acc: 0.9868
Epoch 18/28

1674/1674 [==============================] - 75s 45ms/step - loss: 0.0417 - acc: 0.9888
Epoch 19/28

1674/1674 [==============================] - 78s 46ms/step - loss: 0.0403 - acc: 0.9887
Epoch 20/28

1674/1674 [==============================] - 75s 45ms/step - loss: 0.0383 - acc: 0.9893
Epoch 21/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0372 - acc: 0.9893
Epoch 22/28

1674/1674 [==============================] - 78s 46ms/step - loss: 0.0361 - acc: 0.9895
Epoch 23/28

1674/1674 [==============================] - 75s 45ms/step - loss: 0.0342 - acc: 0.9904
Epoch 24/28

1674/1674 [==============================] - 78s 46ms/step - loss: 0.0324 - acc: 0.9909
Epoch 25/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0302 - acc: 0.9914
Epoch 26/28

1674/1674 [==============================] - 78s 46ms/step - loss: 0.0286 - acc: 0.9921
Epoch 27/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.0293 - acc: 0.9913
Epoch 28/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0275 - acc: 0.9922
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8252
False 819
True percentage 0.909712269871
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
     B-MISC       0.44      0.29      0.35       141
     I-MISC       0.49      0.38      0.43       154
      B-ORG       0.77      0.74      0.76       296
      B-LOC       0.75      0.75      0.75       218
      B-PER       0.91      0.82      0.86       438
      I-PER       0.91      0.65      0.76       214
      I-ORG       0.65      0.65      0.65       151
      I-LOC       0.76      0.80      0.78       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.720144752714
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 86s 51ms/step - loss: 0.3873 - acc: 0.8809
Epoch 2/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.2256 - acc: 0.9308
Epoch 3/28

1674/1674 [==============================] - 78s 46ms/step - loss: 0.1792 - acc: 0.9464
Epoch 4/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.1477 - acc: 0.9571
Epoch 5/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.1273 - acc: 0.9633
Epoch 6/28

1674/1674 [==============================] - 78s 46ms/step - loss: 0.1126 - acc: 0.9684
Epoch 7/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0972 - acc: 0.9720
Epoch 8/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.0870 - acc: 0.9754
Epoch 9/28

1674/1674 [==============================] - 78s 46ms/step - loss: 0.0803 - acc: 0.9771
Epoch 10/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0739 - acc: 0.9789
Epoch 11/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.0683 - acc: 0.9810
Epoch 12/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0612 - acc: 0.9831
Epoch 13/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0584 - acc: 0.9837
Epoch 14/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.0553 - acc: 0.9841
Epoch 15/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0511 - acc: 0.9855
Epoch 16/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.0480 - acc: 0.9866
Epoch 17/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0446 - acc: 0.9882
Epoch 18/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0419 - acc: 0.9884
Epoch 19/28

1674/1674 [==============================] - 78s 46ms/step - loss: 0.0415 - acc: 0.9879
Epoch 20/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0385 - acc: 0.9893
Epoch 21/28

1674/1674 [==============================] - 78s 46ms/step - loss: 0.0365 - acc: 0.9899
Epoch 22/28

1674/1674 [==============================] - 79s 47ms/step - loss: 0.0342 - acc: 0.9902
Epoch 23/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0335 - acc: 0.9907
Epoch 24/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.0322 - acc: 0.9912
Epoch 25/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0310 - acc: 0.9914
Epoch 26/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.0298 - acc: 0.9918
Epoch 27/28

1674/1674 [==============================] - 78s 47ms/step - loss: 0.0288 - acc: 0.9915
Epoch 28/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0277 - acc: 0.9925
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8240
False 831
True percentage 0.908389372726
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.92      0.83      0.87       438
      I-PER       0.91      0.66      0.76       214
          O       0.98      0.96      0.97      7318
      B-ORG       0.77      0.73      0.75       296
      B-LOC       0.75      0.73      0.74       218
      I-ORG       0.62      0.57      0.59       151
      I-LOC       0.70      0.79      0.74       141
     B-MISC       0.40      0.33      0.36       141
     I-MISC       0.50      0.43      0.46       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.927096204766
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104767 unique words.
4763 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 244
OOV word occurences: in test 345
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6705152     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,817,282
Trainable params: 6,817,282
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 46s 55ms/step - loss: 0.5141 - acc: 0.8454
Epoch 2/28

837/837 [==============================] - 40s 47ms/step - loss: 0.2953 - acc: 0.9117
Epoch 3/28

837/837 [==============================] - 37s 44ms/step - loss: 0.2352 - acc: 0.9303
Epoch 4/28

837/837 [==============================] - 39s 47ms/step - loss: 0.1971 - acc: 0.9433
Epoch 5/28

837/837 [==============================] - 39s 47ms/step - loss: 0.1688 - acc: 0.9506
Epoch 6/28

837/837 [==============================] - 39s 47ms/step - loss: 0.1478 - acc: 0.9594
Epoch 7/28

837/837 [==============================] - 39s 47ms/step - loss: 0.1308 - acc: 0.9628
Epoch 8/28

837/837 [==============================] - 38s 45ms/step - loss: 0.1154 - acc: 0.9688
Epoch 9/28

837/837 [==============================] - 38s 45ms/step - loss: 0.1040 - acc: 0.9718
Epoch 10/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0931 - acc: 0.9766
Epoch 11/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0847 - acc: 0.9782
Epoch 12/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0791 - acc: 0.9792
Epoch 13/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0714 - acc: 0.9813
Epoch 14/28

837/837 [==============================] - 37s 44ms/step - loss: 0.0670 - acc: 0.9838
Epoch 15/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0623 - acc: 0.9845
Epoch 16/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0573 - acc: 0.9858
Epoch 17/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0529 - acc: 0.9859
Epoch 18/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0499 - acc: 0.9877
Epoch 19/28

837/837 [==============================] - 36s 43ms/step - loss: 0.0449 - acc: 0.9892
Epoch 20/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0454 - acc: 0.9886
Epoch 21/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0399 - acc: 0.9901
Epoch 22/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0389 - acc: 0.9902
Epoch 23/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0367 - acc: 0.9910
Epoch 24/28

837/837 [==============================] - 36s 43ms/step - loss: 0.0361 - acc: 0.9907
Epoch 25/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0341 - acc: 0.9916
Epoch 26/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0316 - acc: 0.9926
Epoch 27/28

837/837 [==============================] - 40s 47ms/step - loss: 0.0322 - acc: 0.9923
Epoch 28/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0288 - acc: 0.9924
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8181
False 890
True percentage 0.901885128431
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.93      0.84      0.88       438
      B-ORG       0.74      0.71      0.72       296
      I-ORG       0.57      0.51      0.54       151
      I-PER       0.88      0.61      0.72       214
      B-LOC       0.72      0.73      0.73       218
     B-MISC       0.40      0.30      0.35       141
      I-LOC       0.73      0.79      0.76       141
     I-MISC       0.44      0.36      0.40       154

avg / total       0.93      0.90      0.92      9071

F-1 Score (without O):
0.694160144491
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104723 unique words.
4719 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 249
OOV word occurences: in test 356
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6702336     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,814,466
Trainable params: 6,814,466
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 46s 55ms/step - loss: 0.5353 - acc: 0.8373
Epoch 2/28

837/837 [==============================] - 40s 48ms/step - loss: 0.3066 - acc: 0.9079
Epoch 3/28

837/837 [==============================] - 40s 47ms/step - loss: 0.2469 - acc: 0.9248
Epoch 4/28

837/837 [==============================] - 39s 47ms/step - loss: 0.2070 - acc: 0.9385
Epoch 5/28

837/837 [==============================] - 36s 44ms/step - loss: 0.1758 - acc: 0.9508
Epoch 6/28

837/837 [==============================] - 39s 47ms/step - loss: 0.1552 - acc: 0.9578
Epoch 7/28

837/837 [==============================] - 39s 47ms/step - loss: 0.1396 - acc: 0.9594
Epoch 8/28

837/837 [==============================] - 39s 47ms/step - loss: 0.1240 - acc: 0.9666
Epoch 9/28

837/837 [==============================] - 39s 47ms/step - loss: 0.1125 - acc: 0.9702
Epoch 10/28

837/837 [==============================] - 36s 43ms/step - loss: 0.1004 - acc: 0.9727
Epoch 11/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0952 - acc: 0.9754
Epoch 12/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0857 - acc: 0.9774
Epoch 13/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0797 - acc: 0.9801
Epoch 14/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0720 - acc: 0.9799
Epoch 15/28

837/837 [==============================] - 38s 45ms/step - loss: 0.0659 - acc: 0.9826
Epoch 16/28

837/837 [==============================] - 38s 46ms/step - loss: 0.0632 - acc: 0.9840
Epoch 17/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0590 - acc: 0.9854
Epoch 18/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0542 - acc: 0.9860
Epoch 19/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0545 - acc: 0.9857
Epoch 20/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0492 - acc: 0.9878
Epoch 21/28

837/837 [==============================] - 37s 44ms/step - loss: 0.0459 - acc: 0.9884
Epoch 22/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0432 - acc: 0.9885
Epoch 23/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0413 - acc: 0.9900
Epoch 24/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0407 - acc: 0.9888
Epoch 25/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0398 - acc: 0.9893
Epoch 26/28

837/837 [==============================] - 37s 44ms/step - loss: 0.0359 - acc: 0.9912
Epoch 27/28

837/837 [==============================] - 40s 47ms/step - loss: 0.0360 - acc: 0.9906
Epoch 28/28

837/837 [==============================] - 40s 47ms/step - loss: 0.0336 - acc: 0.9910
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8171
False 900
True percentage 0.900782714144
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.90      0.81      0.85       438
      B-ORG       0.73      0.75      0.74       296
      I-ORG       0.51      0.58      0.54       151
     B-MISC       0.44      0.29      0.35       141
     I-MISC       0.48      0.38      0.43       154
      I-PER       0.89      0.65      0.75       214
      B-LOC       0.73      0.68      0.70       218
      I-LOC       0.73      0.73      0.73       141

avg / total       0.93      0.90      0.92      9071

F-1 Score (without O):
0.690212511224
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104715 unique words.
4711 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 248
OOV word occurences: in test 352
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6701824     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,813,954
Trainable params: 6,813,954
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 45s 54ms/step - loss: 0.4732 - acc: 0.8542
Epoch 2/28

837/837 [==============================] - 38s 45ms/step - loss: 0.2908 - acc: 0.9143
Epoch 3/28

837/837 [==============================] - 39s 47ms/step - loss: 0.2303 - acc: 0.9338
Epoch 4/28

837/837 [==============================] - 39s 46ms/step - loss: 0.1906 - acc: 0.9443
Epoch 5/28

837/837 [==============================] - 39s 47ms/step - loss: 0.1630 - acc: 0.9560
Epoch 6/28

837/837 [==============================] - 39s 47ms/step - loss: 0.1438 - acc: 0.9610
Epoch 7/28

837/837 [==============================] - 36s 43ms/step - loss: 0.1249 - acc: 0.9662
Epoch 8/28

837/837 [==============================] - 39s 47ms/step - loss: 0.1112 - acc: 0.9709
Epoch 9/28

837/837 [==============================] - 39s 46ms/step - loss: 0.1025 - acc: 0.9736
Epoch 10/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0916 - acc: 0.9761
Epoch 11/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0814 - acc: 0.9781
Epoch 12/28

837/837 [==============================] - 37s 44ms/step - loss: 0.0745 - acc: 0.9807
Epoch 13/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0677 - acc: 0.9841
Epoch 14/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0625 - acc: 0.9851
Epoch 15/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0588 - acc: 0.9844
Epoch 16/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0530 - acc: 0.9864
Epoch 17/28

837/837 [==============================] - 37s 44ms/step - loss: 0.0497 - acc: 0.9875
Epoch 18/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0457 - acc: 0.9893
Epoch 19/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0451 - acc: 0.9889
Epoch 20/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0422 - acc: 0.9893
Epoch 21/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0386 - acc: 0.9902
Epoch 22/28

837/837 [==============================] - 38s 46ms/step - loss: 0.0367 - acc: 0.9907
Epoch 23/28

837/837 [==============================] - 38s 45ms/step - loss: 0.0348 - acc: 0.9911
Epoch 24/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0329 - acc: 0.9916
Epoch 25/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0318 - acc: 0.9914
Epoch 26/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0291 - acc: 0.9924
Epoch 27/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0294 - acc: 0.9922
Epoch 28/28

837/837 [==============================] - 37s 44ms/step - loss: 0.0274 - acc: 0.9929
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8167
False 904
True percentage 0.900341748429
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.72      0.75      0.73       296
      B-PER       0.88      0.76      0.82       438
      I-PER       0.83      0.64      0.72       214
      B-LOC       0.72      0.70      0.71       218
      I-LOC       0.74      0.79      0.77       141
      I-ORG       0.56      0.58      0.57       151
     B-MISC       0.53      0.32      0.40       141
     I-MISC       0.50      0.40      0.45       154

avg / total       0.93      0.90      0.92      9071

F-1 Score (without O):
0.691127819549
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104764 unique words.
4760 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 248
OOV word occurences: in test 387
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6704960     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,817,090
Trainable params: 6,817,090
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 46s 55ms/step - loss: 0.4955 - acc: 0.8479
Epoch 2/28

837/837 [==============================] - 39s 47ms/step - loss: 0.3022 - acc: 0.9084
Epoch 3/28

837/837 [==============================] - 38s 45ms/step - loss: 0.2378 - acc: 0.9295
Epoch 4/28

837/837 [==============================] - 38s 45ms/step - loss: 0.2020 - acc: 0.9417
Epoch 5/28

837/837 [==============================] - 39s 47ms/step - loss: 0.1731 - acc: 0.9498
Epoch 6/28

837/837 [==============================] - 39s 46ms/step - loss: 0.1531 - acc: 0.9579
Epoch 7/28

837/837 [==============================] - 39s 47ms/step - loss: 0.1325 - acc: 0.9646
Epoch 8/28

837/837 [==============================] - 39s 47ms/step - loss: 0.1192 - acc: 0.9675
Epoch 9/28

837/837 [==============================] - 37s 44ms/step - loss: 0.1084 - acc: 0.9713
Epoch 10/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0991 - acc: 0.9743
Epoch 11/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0895 - acc: 0.9768
Epoch 12/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0827 - acc: 0.9793
Epoch 13/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0743 - acc: 0.9801
Epoch 14/28

837/837 [==============================] - 36s 43ms/step - loss: 0.0683 - acc: 0.9828
Epoch 15/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0650 - acc: 0.9826
Epoch 16/28

837/837 [==============================] - 40s 48ms/step - loss: 0.0582 - acc: 0.9843
Epoch 17/28

837/837 [==============================] - 40s 47ms/step - loss: 0.0573 - acc: 0.9853
Epoch 18/28

837/837 [==============================] - 40s 47ms/step - loss: 0.0516 - acc: 0.9858
Epoch 19/28

837/837 [==============================] - 37s 44ms/step - loss: 0.0482 - acc: 0.9872
Epoch 20/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0459 - acc: 0.9885
Epoch 21/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0410 - acc: 0.9897
Epoch 22/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0407 - acc: 0.9892
Epoch 23/28

837/837 [==============================] - 40s 47ms/step - loss: 0.0397 - acc: 0.9891
Epoch 24/28

837/837 [==============================] - 37s 44ms/step - loss: 0.0369 - acc: 0.9909
Epoch 25/28

837/837 [==============================] - 40s 47ms/step - loss: 0.0342 - acc: 0.9911
Epoch 26/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0314 - acc: 0.9915
Epoch 27/28

837/837 [==============================] - 40s 48ms/step - loss: 0.0302 - acc: 0.9925
Epoch 28/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0283 - acc: 0.9928
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8061
False 1010
True percentage 0.888656156984
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
     B-MISC       0.36      0.33      0.35       141
     I-MISC       0.39      0.40      0.40       154
      B-ORG       0.70      0.66      0.68       296
      B-LOC       0.72      0.67      0.70       218
      B-PER       0.86      0.74      0.79       438
      I-PER       0.87      0.62      0.72       214
      I-ORG       0.42      0.39      0.41       151
      I-LOC       0.68      0.67      0.68       141

avg / total       0.93      0.89      0.91      9071

F-1 Score (without O):
0.636472705459
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104723 unique words.
4719 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 245
OOV word occurences: in test 385
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6702336     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,814,466
Trainable params: 6,814,466
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 46s 55ms/step - loss: 0.5710 - acc: 0.8264
Epoch 2/28

837/837 [==============================] - 40s 48ms/step - loss: 0.3277 - acc: 0.9032
Epoch 3/28

837/837 [==============================] - 40s 47ms/step - loss: 0.2631 - acc: 0.9243
Epoch 4/28

837/837 [==============================] - 39s 47ms/step - loss: 0.2196 - acc: 0.9371
Epoch 5/28

837/837 [==============================] - 36s 43ms/step - loss: 0.1884 - acc: 0.9473
Epoch 6/28

837/837 [==============================] - 39s 46ms/step - loss: 0.1601 - acc: 0.9562
Epoch 7/28

837/837 [==============================] - 39s 47ms/step - loss: 0.1421 - acc: 0.9620
Epoch 8/28

837/837 [==============================] - 39s 46ms/step - loss: 0.1259 - acc: 0.9671
Epoch 9/28

837/837 [==============================] - 39s 46ms/step - loss: 0.1143 - acc: 0.9699
Epoch 10/28

837/837 [==============================] - 38s 45ms/step - loss: 0.1052 - acc: 0.9707
Epoch 11/28

837/837 [==============================] - 37s 44ms/step - loss: 0.0935 - acc: 0.9758
Epoch 12/28

837/837 [==============================] - 38s 46ms/step - loss: 0.0850 - acc: 0.9777
Epoch 13/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0784 - acc: 0.9794
Epoch 14/28

837/837 [==============================] - 38s 45ms/step - loss: 0.0737 - acc: 0.9817
Epoch 15/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0686 - acc: 0.9831
Epoch 16/28

837/837 [==============================] - 36s 43ms/step - loss: 0.0631 - acc: 0.9839
Epoch 17/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0610 - acc: 0.9835
Epoch 18/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0551 - acc: 0.9859
Epoch 19/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0522 - acc: 0.9868
Epoch 20/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0497 - acc: 0.9870
Epoch 21/28

837/837 [==============================] - 37s 44ms/step - loss: 0.0467 - acc: 0.9877
Epoch 22/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0446 - acc: 0.9882
Epoch 23/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0419 - acc: 0.9893
Epoch 24/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0405 - acc: 0.9891
Epoch 25/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0380 - acc: 0.9901
Epoch 26/28

837/837 [==============================] - 37s 44ms/step - loss: 0.0345 - acc: 0.9915
Epoch 27/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0337 - acc: 0.9916
Epoch 28/28

837/837 [==============================] - 40s 48ms/step - loss: 0.0330 - acc: 0.9917
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8111
False 960
True percentage 0.89416822842
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.88      0.72      0.79       438
      I-PER       0.90      0.63      0.74       214
          O       0.99      0.95      0.97      7318
      B-ORG       0.70      0.73      0.71       296
      B-LOC       0.74      0.72      0.73       218
      I-ORG       0.48      0.53      0.51       151
      I-LOC       0.74      0.74      0.74       141
     B-MISC       0.46      0.32      0.38       141
     I-MISC       0.45      0.45      0.45       154

avg / total       0.93      0.89      0.91      9071

F-1 Score (without O):
0.919275900702
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104352 unique words.
4348 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 266
OOV word occurences: in test 428
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678592     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,722
Trainable params: 6,790,722
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 22s 66ms/step - loss: 0.6660 - acc: 0.8021
Epoch 2/28

334/334 [==============================] - 16s 48ms/step - loss: 0.3847 - acc: 0.8792
Epoch 3/28

334/334 [==============================] - 16s 47ms/step - loss: 0.3168 - acc: 0.9066
Epoch 4/28

334/334 [==============================] - 14s 42ms/step - loss: 0.2712 - acc: 0.9235
Epoch 5/28

334/334 [==============================] - 15s 44ms/step - loss: 0.2389 - acc: 0.9332
Epoch 6/28

334/334 [==============================] - 16s 47ms/step - loss: 0.2086 - acc: 0.9407
Epoch 7/28

334/334 [==============================] - 16s 47ms/step - loss: 0.1810 - acc: 0.9522
Epoch 8/28

334/334 [==============================] - 15s 46ms/step - loss: 0.1636 - acc: 0.9545
Epoch 9/28

334/334 [==============================] - 16s 47ms/step - loss: 0.1481 - acc: 0.9591
Epoch 10/28

334/334 [==============================] - 15s 46ms/step - loss: 0.1307 - acc: 0.9661
Epoch 11/28

334/334 [==============================] - 16s 47ms/step - loss: 0.1206 - acc: 0.9710
Epoch 12/28

334/334 [==============================] - 16s 48ms/step - loss: 0.1082 - acc: 0.9752
Epoch 13/28

334/334 [==============================] - 16s 47ms/step - loss: 0.1020 - acc: 0.9748
Epoch 14/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0917 - acc: 0.9800
Epoch 15/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0779 - acc: 0.9832
Epoch 16/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0813 - acc: 0.9821
Epoch 17/28

334/334 [==============================] - 14s 43ms/step - loss: 0.0735 - acc: 0.9846
Epoch 18/28

334/334 [==============================] - 14s 42ms/step - loss: 0.0648 - acc: 0.9885
Epoch 19/28

334/334 [==============================] - 15s 45ms/step - loss: 0.0609 - acc: 0.9875
Epoch 20/28

334/334 [==============================] - 16s 48ms/step - loss: 0.0569 - acc: 0.9883
Epoch 21/28

334/334 [==============================] - 15s 45ms/step - loss: 0.0544 - acc: 0.9897
Epoch 22/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0497 - acc: 0.9907
Epoch 23/28

334/334 [==============================] - 16s 46ms/step - loss: 0.0450 - acc: 0.9924
Epoch 24/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0410 - acc: 0.9937
Epoch 25/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0414 - acc: 0.9913
Epoch 26/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0366 - acc: 0.9926
Epoch 27/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0377 - acc: 0.9932
Epoch 28/28

334/334 [==============================] - 16s 46ms/step - loss: 0.0337 - acc: 0.9932
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8032
False 1039
True percentage 0.885459155551
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.96      0.97      7318
      B-PER       0.86      0.72      0.78       438
      B-ORG       0.65      0.64      0.65       296
      I-ORG       0.45      0.46      0.46       151
      I-PER       0.87      0.57      0.69       214
      B-LOC       0.72      0.71      0.72       218
     B-MISC       0.44      0.15      0.22       141
      I-LOC       0.64      0.75      0.69       141
     I-MISC       0.57      0.21      0.30       154

avg / total       0.92      0.89      0.90      9071

F-1 Score (without O):
0.634054562559
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104340 unique words.
4336 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 268
OOV word occurences: in test 411
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6677824     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,789,954
Trainable params: 6,789,954
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 22s 67ms/step - loss: 0.6061 - acc: 0.8061
Epoch 2/28

334/334 [==============================] - 16s 47ms/step - loss: 0.3513 - acc: 0.8969
Epoch 3/28

334/334 [==============================] - 16s 48ms/step - loss: 0.2911 - acc: 0.9125
Epoch 4/28

334/334 [==============================] - 16s 47ms/step - loss: 0.2407 - acc: 0.9275
Epoch 5/28

334/334 [==============================] - 15s 46ms/step - loss: 0.2046 - acc: 0.9444
Epoch 6/28

334/334 [==============================] - 16s 47ms/step - loss: 0.1818 - acc: 0.9474
Epoch 7/28

334/334 [==============================] - 16s 47ms/step - loss: 0.1624 - acc: 0.9546
Epoch 8/28

334/334 [==============================] - 16s 47ms/step - loss: 0.1491 - acc: 0.9591
Epoch 9/28

334/334 [==============================] - 16s 47ms/step - loss: 0.1305 - acc: 0.9661
Epoch 10/28

334/334 [==============================] - 16s 47ms/step - loss: 0.1231 - acc: 0.9678
Epoch 11/28

334/334 [==============================] - 16s 47ms/step - loss: 0.1089 - acc: 0.9747
Epoch 12/28

334/334 [==============================] - 14s 42ms/step - loss: 0.0977 - acc: 0.9765
Epoch 13/28

334/334 [==============================] - 15s 45ms/step - loss: 0.0898 - acc: 0.9803
Epoch 14/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0832 - acc: 0.9811
Epoch 15/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0758 - acc: 0.9847
Epoch 16/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0688 - acc: 0.9859
Epoch 17/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0677 - acc: 0.9845
Epoch 18/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0606 - acc: 0.9863
Epoch 19/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0597 - acc: 0.9876
Epoch 20/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0550 - acc: 0.9871
Epoch 21/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0501 - acc: 0.9901
Epoch 22/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0456 - acc: 0.9909
Epoch 23/28

334/334 [==============================] - 15s 45ms/step - loss: 0.0418 - acc: 0.9919
Epoch 24/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0407 - acc: 0.9914
Epoch 25/28

334/334 [==============================] - 14s 42ms/step - loss: 0.0387 - acc: 0.9915
Epoch 26/28

334/334 [==============================] - 14s 42ms/step - loss: 0.0365 - acc: 0.9919
Epoch 27/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0352 - acc: 0.9923
Epoch 28/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0323 - acc: 0.9938
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7989
False 1082
True percentage 0.880718774115
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.96      0.96      7318
      B-PER       0.87      0.71      0.78       438
      B-ORG       0.62      0.66      0.64       296
      I-ORG       0.42      0.40      0.41       151
     B-MISC       0.41      0.26      0.32       141
     I-MISC       0.45      0.36      0.40       154
      I-PER       0.84      0.56      0.67       214
      B-LOC       0.77      0.59      0.67       218
      I-LOC       0.77      0.58      0.66       141

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.618898623279
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104355 unique words.
4351 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 262
OOV word occurences: in test 406
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678784     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,914
Trainable params: 6,790,914
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 22s 65ms/step - loss: 0.6651 - acc: 0.7963
Epoch 2/28

334/334 [==============================] - 16s 48ms/step - loss: 0.3909 - acc: 0.8833
Epoch 3/28

334/334 [==============================] - 16s 47ms/step - loss: 0.3217 - acc: 0.9048
Epoch 4/28

334/334 [==============================] - 16s 47ms/step - loss: 0.2749 - acc: 0.9198
Epoch 5/28

334/334 [==============================] - 16s 47ms/step - loss: 0.2387 - acc: 0.9304
Epoch 6/28

334/334 [==============================] - 16s 47ms/step - loss: 0.2025 - acc: 0.9423
Epoch 7/28

334/334 [==============================] - 13s 40ms/step - loss: 0.1836 - acc: 0.9501
Epoch 8/28

334/334 [==============================] - 16s 47ms/step - loss: 0.1633 - acc: 0.9563
Epoch 9/28

334/334 [==============================] - 15s 46ms/step - loss: 0.1497 - acc: 0.9608
Epoch 10/28

334/334 [==============================] - 16s 47ms/step - loss: 0.1334 - acc: 0.9657
Epoch 11/28

334/334 [==============================] - 16s 47ms/step - loss: 0.1156 - acc: 0.9692
Epoch 12/28

334/334 [==============================] - 15s 46ms/step - loss: 0.1100 - acc: 0.9710
Epoch 13/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0985 - acc: 0.9755
Epoch 14/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0871 - acc: 0.9776
Epoch 15/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0847 - acc: 0.9781
Epoch 16/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0794 - acc: 0.9814
Epoch 17/28

334/334 [==============================] - 16s 48ms/step - loss: 0.0708 - acc: 0.9831
Epoch 18/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0645 - acc: 0.9847
Epoch 19/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0619 - acc: 0.9849
Epoch 20/28

334/334 [==============================] - 14s 41ms/step - loss: 0.0557 - acc: 0.9871
Epoch 21/28

334/334 [==============================] - 15s 45ms/step - loss: 0.0527 - acc: 0.9887
Epoch 22/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0510 - acc: 0.9873
Epoch 23/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0458 - acc: 0.9911
Epoch 24/28

334/334 [==============================] - 16s 48ms/step - loss: 0.0460 - acc: 0.9892
Epoch 25/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0414 - acc: 0.9904
Epoch 26/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0424 - acc: 0.9888
Epoch 27/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0377 - acc: 0.9923
Epoch 28/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0340 - acc: 0.9926
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8069
False 1002
True percentage 0.889538088414
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.65      0.74      0.69       296
      B-PER       0.89      0.71      0.79       438
      I-PER       0.84      0.61      0.70       214
      B-LOC       0.66      0.67      0.67       218
      I-LOC       0.71      0.74      0.72       141
      I-ORG       0.54      0.66      0.60       151
     B-MISC       0.45      0.16      0.23       141
     I-MISC       0.56      0.22      0.32       154

avg / total       0.93      0.89      0.90      9071

F-1 Score (without O):
0.65418840135
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104348 unique words.
4344 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 262
OOV word occurences: in test 426
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678336     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,466
Trainable params: 6,790,466
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 22s 65ms/step - loss: 0.6791 - acc: 0.7966
Epoch 2/28

334/334 [==============================] - 14s 41ms/step - loss: 0.3777 - acc: 0.8828
Epoch 3/28

334/334 [==============================] - 16s 47ms/step - loss: 0.3112 - acc: 0.9089
Epoch 4/28

334/334 [==============================] - 16s 47ms/step - loss: 0.2621 - acc: 0.9249
Epoch 5/28

334/334 [==============================] - 16s 47ms/step - loss: 0.2298 - acc: 0.9329
Epoch 6/28

334/334 [==============================] - 16s 47ms/step - loss: 0.2069 - acc: 0.9391
Epoch 7/28

334/334 [==============================] - 16s 47ms/step - loss: 0.1785 - acc: 0.9504
Epoch 8/28

334/334 [==============================] - 16s 47ms/step - loss: 0.1641 - acc: 0.9555
Epoch 9/28

334/334 [==============================] - 16s 48ms/step - loss: 0.1512 - acc: 0.9597
Epoch 10/28

334/334 [==============================] - 16s 47ms/step - loss: 0.1363 - acc: 0.9649
Epoch 11/28

334/334 [==============================] - 16s 47ms/step - loss: 0.1297 - acc: 0.9655
Epoch 12/28

334/334 [==============================] - 15s 46ms/step - loss: 0.1143 - acc: 0.9706
Epoch 13/28

334/334 [==============================] - 15s 46ms/step - loss: 0.1052 - acc: 0.9752
Epoch 14/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0955 - acc: 0.9765
Epoch 15/28

334/334 [==============================] - 13s 40ms/step - loss: 0.0918 - acc: 0.9776
Epoch 16/28

334/334 [==============================] - 15s 45ms/step - loss: 0.0798 - acc: 0.9824
Epoch 17/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0725 - acc: 0.9851
Epoch 18/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0732 - acc: 0.9823
Epoch 19/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0656 - acc: 0.9858
Epoch 20/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0619 - acc: 0.9867
Epoch 21/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0570 - acc: 0.9875
Epoch 22/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0514 - acc: 0.9897
Epoch 23/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0520 - acc: 0.9877
Epoch 24/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0472 - acc: 0.9899
Epoch 25/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0445 - acc: 0.9911
Epoch 26/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0409 - acc: 0.9922
Epoch 27/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0407 - acc: 0.9914
Epoch 28/28

334/334 [==============================] - 13s 40ms/step - loss: 0.0371 - acc: 0.9929
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7917
False 1154
True percentage 0.872781391247
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
     B-MISC       0.30      0.23      0.26       141
     I-MISC       0.34      0.21      0.26       154
      B-ORG       0.67      0.61      0.64       296
      B-LOC       0.67      0.63      0.65       218
      B-PER       0.83      0.64      0.72       438
      I-PER       0.86      0.56      0.68       214
      I-ORG       0.39      0.37      0.38       151
      I-LOC       0.62      0.73      0.67       141

avg / total       0.91      0.87      0.89      9071

F-1 Score (without O):
0.58600311042
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104309 unique words.
4305 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 264
OOV word occurences: in test 431
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6675840     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,787,970
Trainable params: 6,787,970
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 22s 65ms/step - loss: 0.6062 - acc: 0.8120
Epoch 2/28

334/334 [==============================] - 16s 48ms/step - loss: 0.3567 - acc: 0.8889
Epoch 3/28

334/334 [==============================] - 16s 48ms/step - loss: 0.2965 - acc: 0.9112
Epoch 4/28

334/334 [==============================] - 16s 48ms/step - loss: 0.2437 - acc: 0.9296
Epoch 5/28

334/334 [==============================] - 16s 47ms/step - loss: 0.2157 - acc: 0.9381
Epoch 6/28

334/334 [==============================] - 16s 48ms/step - loss: 0.1899 - acc: 0.9467
Epoch 7/28

334/334 [==============================] - 16s 47ms/step - loss: 0.1700 - acc: 0.9520
Epoch 8/28

334/334 [==============================] - 16s 48ms/step - loss: 0.1470 - acc: 0.9611
Epoch 9/28

334/334 [==============================] - 15s 46ms/step - loss: 0.1311 - acc: 0.9654
Epoch 10/28

334/334 [==============================] - 14s 41ms/step - loss: 0.1175 - acc: 0.9724
Epoch 11/28

334/334 [==============================] - 16s 47ms/step - loss: 0.1084 - acc: 0.9691
Epoch 12/28

334/334 [==============================] - 16s 46ms/step - loss: 0.1019 - acc: 0.9746
Epoch 13/28

334/334 [==============================] - 16s 48ms/step - loss: 0.0941 - acc: 0.9775
Epoch 14/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0852 - acc: 0.9809
Epoch 15/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0759 - acc: 0.9825
Epoch 16/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0721 - acc: 0.9837
Epoch 17/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0674 - acc: 0.9847
Epoch 18/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0620 - acc: 0.9875
Epoch 19/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0566 - acc: 0.9885
Epoch 20/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0563 - acc: 0.9875
Epoch 21/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0506 - acc: 0.9882
Epoch 22/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0447 - acc: 0.9905
Epoch 23/28

334/334 [==============================] - 13s 40ms/step - loss: 0.0418 - acc: 0.9919
Epoch 24/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0419 - acc: 0.9897
Epoch 25/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0393 - acc: 0.9928
Epoch 26/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0375 - acc: 0.9921
Epoch 27/28

334/334 [==============================] - 16s 48ms/step - loss: 0.0341 - acc: 0.9930
Epoch 28/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0312 - acc: 0.9947
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7955
False 1116
True percentage 0.876970565539
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.84      0.68      0.75       438
      I-PER       0.78      0.58      0.66       214
          O       0.97      0.95      0.96      7318
      B-ORG       0.64      0.66      0.65       296
      B-LOC       0.74      0.63      0.68       218
      I-ORG       0.37      0.40      0.38       151
      I-LOC       0.71      0.57      0.63       141
     B-MISC       0.36      0.25      0.30       141
     I-MISC       0.47      0.31      0.37       154

avg / total       0.91      0.88      0.89      9071

F-1 Score (without O):
0.905178529203
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104194 unique words.
4190 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 275
OOV word occurences: in test 464
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6668480     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,780,610
Trainable params: 6,780,610
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 14s 82ms/step - loss: 0.9462 - acc: 0.7454
Epoch 2/28

167/167 [==============================] - 8s 49ms/step - loss: 0.4640 - acc: 0.8477
Epoch 3/28

167/167 [==============================] - 8s 48ms/step - loss: 0.3905 - acc: 0.8753
Epoch 4/28

167/167 [==============================] - 8s 48ms/step - loss: 0.3570 - acc: 0.8890
Epoch 5/28

167/167 [==============================] - 8s 51ms/step - loss: 0.3086 - acc: 0.9099
Epoch 6/28

167/167 [==============================] - 8s 49ms/step - loss: 0.2744 - acc: 0.9227
Epoch 7/28

167/167 [==============================] - 8s 50ms/step - loss: 0.2586 - acc: 0.9273
Epoch 8/28

167/167 [==============================] - 7s 42ms/step - loss: 0.2349 - acc: 0.9331
Epoch 9/28

167/167 [==============================] - 7s 42ms/step - loss: 0.2139 - acc: 0.9427
Epoch 10/28

167/167 [==============================] - 7s 44ms/step - loss: 0.1963 - acc: 0.9508
Epoch 11/28

167/167 [==============================] - 8s 46ms/step - loss: 0.1800 - acc: 0.9562
Epoch 12/28

167/167 [==============================] - 8s 48ms/step - loss: 0.1647 - acc: 0.9631
Epoch 13/28

167/167 [==============================] - 8s 49ms/step - loss: 0.1508 - acc: 0.9667
Epoch 14/28

167/167 [==============================] - 8s 47ms/step - loss: 0.1381 - acc: 0.9703
Epoch 15/28

167/167 [==============================] - 8s 47ms/step - loss: 0.1280 - acc: 0.9755
Epoch 16/28

167/167 [==============================] - 8s 48ms/step - loss: 0.1128 - acc: 0.9774
Epoch 17/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1070 - acc: 0.9779
Epoch 18/28

167/167 [==============================] - 8s 47ms/step - loss: 0.1015 - acc: 0.9821
Epoch 19/28

167/167 [==============================] - 8s 47ms/step - loss: 0.0911 - acc: 0.9830
Epoch 20/28

167/167 [==============================] - 8s 47ms/step - loss: 0.0859 - acc: 0.9848
Epoch 21/28

167/167 [==============================] - 8s 47ms/step - loss: 0.0796 - acc: 0.9854
Epoch 22/28

167/167 [==============================] - 8s 49ms/step - loss: 0.0769 - acc: 0.9877
Epoch 23/28

167/167 [==============================] - 8s 47ms/step - loss: 0.0706 - acc: 0.9895
Epoch 24/28

167/167 [==============================] - 8s 47ms/step - loss: 0.0648 - acc: 0.9883
Epoch 25/28

167/167 [==============================] - 8s 47ms/step - loss: 0.0636 - acc: 0.9890
Epoch 26/28

167/167 [==============================] - 8s 48ms/step - loss: 0.0577 - acc: 0.9906
Epoch 27/28

167/167 [==============================] - 8s 47ms/step - loss: 0.0539 - acc: 0.9933
Epoch 28/28

167/167 [==============================] - 8s 48ms/step - loss: 0.0540 - acc: 0.9900
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7902
False 1169
True percentage 0.871127769816
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.96      0.96      7318
      B-PER       0.87      0.67      0.76       438
      B-ORG       0.56      0.63      0.60       296
      I-ORG       0.32      0.36      0.34       151
      I-PER       0.79      0.57      0.66       214
      B-LOC       0.77      0.62      0.69       218
     B-MISC       0.31      0.09      0.13       141
      I-LOC       0.63      0.55      0.59       141
     I-MISC       0.50      0.11      0.18       154

avg / total       0.91      0.87      0.88      9071

F-1 Score (without O):
0.576379974326
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104185 unique words.
4181 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 272
OOV word occurences: in test 428
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6667904     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,780,034
Trainable params: 6,780,034
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 12s 70ms/step - loss: 0.7915 - acc: 0.7676
Epoch 2/28

167/167 [==============================] - 8s 49ms/step - loss: 0.4285 - acc: 0.8705
Epoch 3/28

167/167 [==============================] - 8s 51ms/step - loss: 0.3602 - acc: 0.8895
Epoch 4/28

167/167 [==============================] - 8s 49ms/step - loss: 0.3020 - acc: 0.9117
Epoch 5/28

167/167 [==============================] - 8s 50ms/step - loss: 0.2674 - acc: 0.9272
Epoch 6/28

167/167 [==============================] - 8s 49ms/step - loss: 0.2408 - acc: 0.9313
Epoch 7/28

167/167 [==============================] - 8s 48ms/step - loss: 0.2157 - acc: 0.9394
Epoch 8/28

167/167 [==============================] - 8s 48ms/step - loss: 0.1955 - acc: 0.9480
Epoch 9/28

167/167 [==============================] - 8s 47ms/step - loss: 0.1848 - acc: 0.9511
Epoch 10/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1634 - acc: 0.9586
Epoch 11/28

167/167 [==============================] - 8s 47ms/step - loss: 0.1491 - acc: 0.9624
Epoch 12/28

167/167 [==============================] - 8s 48ms/step - loss: 0.1392 - acc: 0.9643
Epoch 13/28

167/167 [==============================] - 8s 47ms/step - loss: 0.1296 - acc: 0.9697
Epoch 14/28

167/167 [==============================] - 8s 47ms/step - loss: 0.1144 - acc: 0.9755
Epoch 15/28

167/167 [==============================] - 8s 48ms/step - loss: 0.1055 - acc: 0.9773
Epoch 16/28

167/167 [==============================] - 8s 48ms/step - loss: 0.1035 - acc: 0.9770
Epoch 17/28

167/167 [==============================] - 8s 47ms/step - loss: 0.0923 - acc: 0.9811
Epoch 18/28

167/167 [==============================] - 8s 47ms/step - loss: 0.0838 - acc: 0.9813
Epoch 19/28

167/167 [==============================] - 8s 48ms/step - loss: 0.0805 - acc: 0.9831
Epoch 20/28

167/167 [==============================] - 8s 47ms/step - loss: 0.0744 - acc: 0.9840
Epoch 21/28

167/167 [==============================] - 8s 49ms/step - loss: 0.0741 - acc: 0.9848
Epoch 22/28

167/167 [==============================] - 8s 48ms/step - loss: 0.0665 - acc: 0.9857
Epoch 23/28

167/167 [==============================] - 8s 48ms/step - loss: 0.0625 - acc: 0.9896
Epoch 24/28

167/167 [==============================] - 8s 45ms/step - loss: 0.0552 - acc: 0.9906
Epoch 25/28

167/167 [==============================] - 7s 44ms/step - loss: 0.0543 - acc: 0.9905
Epoch 26/28

167/167 [==============================] - 7s 40ms/step - loss: 0.0527 - acc: 0.9901
Epoch 27/28

167/167 [==============================] - 7s 40ms/step - loss: 0.0482 - acc: 0.9921
Epoch 28/28

167/167 [==============================] - 8s 46ms/step - loss: 0.0451 - acc: 0.9916
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7864
False 1207
True percentage 0.866938595524
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-PER       0.85      0.66      0.75       438
      B-ORG       0.56      0.62      0.59       296
      I-ORG       0.27      0.38      0.32       151
     B-MISC       0.29      0.16      0.21       141
     I-MISC       0.30      0.23      0.26       154
      I-PER       0.82      0.56      0.66       214
      B-LOC       0.72      0.67      0.69       218
      I-LOC       0.83      0.37      0.51       141

avg / total       0.91      0.87      0.88      9071

F-1 Score (without O):
0.560073937153
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104214 unique words.
4210 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 271
OOV word occurences: in test 452
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6669760     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,781,890
Trainable params: 6,781,890
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 14s 84ms/step - loss: 0.9963 - acc: 0.7204
Epoch 2/28

167/167 [==============================] - 8s 48ms/step - loss: 0.5038 - acc: 0.8476
Epoch 3/28

167/167 [==============================] - 8s 51ms/step - loss: 0.4301 - acc: 0.8728
Epoch 4/28

167/167 [==============================] - 8s 49ms/step - loss: 0.3763 - acc: 0.8952
Epoch 5/28

167/167 [==============================] - 8s 50ms/step - loss: 0.3303 - acc: 0.9028
Epoch 6/28

167/167 [==============================] - 8s 47ms/step - loss: 0.3025 - acc: 0.9151
Epoch 7/28

167/167 [==============================] - 8s 48ms/step - loss: 0.2720 - acc: 0.9218
Epoch 8/28

167/167 [==============================] - 9s 51ms/step - loss: 0.2398 - acc: 0.9346
Epoch 9/28

167/167 [==============================] - 8s 47ms/step - loss: 0.2248 - acc: 0.9407
Epoch 10/28

167/167 [==============================] - 8s 48ms/step - loss: 0.2121 - acc: 0.9430
Epoch 11/28

167/167 [==============================] - 8s 48ms/step - loss: 0.1923 - acc: 0.9481
Epoch 12/28

167/167 [==============================] - 8s 46ms/step - loss: 0.1752 - acc: 0.9542
Epoch 13/28

167/167 [==============================] - 8s 47ms/step - loss: 0.1580 - acc: 0.9590
Epoch 14/28

167/167 [==============================] - 8s 47ms/step - loss: 0.1485 - acc: 0.9624
Epoch 15/28

167/167 [==============================] - 8s 49ms/step - loss: 0.1381 - acc: 0.9680
Epoch 16/28

167/167 [==============================] - 8s 46ms/step - loss: 0.1250 - acc: 0.9700
Epoch 17/28

167/167 [==============================] - 7s 41ms/step - loss: 0.1171 - acc: 0.9727
Epoch 18/28

167/167 [==============================] - 7s 41ms/step - loss: 0.1133 - acc: 0.9725
Epoch 19/28

167/167 [==============================] - 8s 47ms/step - loss: 0.1066 - acc: 0.9760
Epoch 20/28

167/167 [==============================] - 8s 47ms/step - loss: 0.0983 - acc: 0.9778
Epoch 21/28

167/167 [==============================] - 8s 48ms/step - loss: 0.0948 - acc: 0.9771
Epoch 22/28

167/167 [==============================] - 8s 47ms/step - loss: 0.0828 - acc: 0.9838
Epoch 23/28

167/167 [==============================] - 8s 47ms/step - loss: 0.0830 - acc: 0.9836
Epoch 24/28

167/167 [==============================] - 8s 47ms/step - loss: 0.0805 - acc: 0.9839
Epoch 25/28

167/167 [==============================] - 8s 48ms/step - loss: 0.0744 - acc: 0.9854
Epoch 26/28

167/167 [==============================] - 8s 47ms/step - loss: 0.0679 - acc: 0.9866
Epoch 27/28

167/167 [==============================] - 8s 48ms/step - loss: 0.0649 - acc: 0.9856
Epoch 28/28

167/167 [==============================] - 8s 47ms/step - loss: 0.0581 - acc: 0.9888
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7860
False 1211
True percentage 0.866497629809
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-ORG       0.60      0.64      0.62       296
      B-PER       0.78      0.60      0.68       438
      I-PER       0.76      0.52      0.62       214
      B-LOC       0.64      0.63      0.64       218
      I-LOC       0.63      0.52      0.57       141
      I-ORG       0.40      0.55      0.46       151
     B-MISC       0.31      0.18      0.23       141
     I-MISC       0.39      0.27      0.32       154

avg / total       0.91      0.87      0.88      9071

F-1 Score (without O):
0.563680682511
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104201 unique words.
4197 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 270
OOV word occurences: in test 452
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6668928     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,781,058
Trainable params: 6,781,058
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 14s 86ms/step - loss: 0.8982 - acc: 0.7414
Epoch 2/28

167/167 [==============================] - 8s 50ms/step - loss: 0.4640 - acc: 0.8515
Epoch 3/28

167/167 [==============================] - 8s 50ms/step - loss: 0.4011 - acc: 0.8719
Epoch 4/28

167/167 [==============================] - 8s 48ms/step - loss: 0.3539 - acc: 0.8878
Epoch 5/28

167/167 [==============================] - 8s 50ms/step - loss: 0.3212 - acc: 0.8941
Epoch 6/28

167/167 [==============================] - 8s 48ms/step - loss: 0.2922 - acc: 0.9108
Epoch 7/28

167/167 [==============================] - 8s 48ms/step - loss: 0.2687 - acc: 0.9204
Epoch 8/28

167/167 [==============================] - 7s 42ms/step - loss: 0.2448 - acc: 0.9269
Epoch 9/28

167/167 [==============================] - 7s 42ms/step - loss: 0.2239 - acc: 0.9326
Epoch 10/28

167/167 [==============================] - 8s 47ms/step - loss: 0.2078 - acc: 0.9415
Epoch 11/28

167/167 [==============================] - 8s 47ms/step - loss: 0.1942 - acc: 0.9439
Epoch 12/28

167/167 [==============================] - 8s 47ms/step - loss: 0.1767 - acc: 0.9498
Epoch 13/28

167/167 [==============================] - 8s 47ms/step - loss: 0.1601 - acc: 0.9597
Epoch 14/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1540 - acc: 0.9609
Epoch 15/28

167/167 [==============================] - 8s 47ms/step - loss: 0.1415 - acc: 0.9667
Epoch 16/28

167/167 [==============================] - 8s 48ms/step - loss: 0.1329 - acc: 0.9660
Epoch 17/28

167/167 [==============================] - 8s 48ms/step - loss: 0.1259 - acc: 0.9705
Epoch 18/28

167/167 [==============================] - 8s 48ms/step - loss: 0.1134 - acc: 0.9753
Epoch 19/28

167/167 [==============================] - 8s 49ms/step - loss: 0.1056 - acc: 0.9768
Epoch 20/28

167/167 [==============================] - 8s 47ms/step - loss: 0.1043 - acc: 0.9792
Epoch 21/28

167/167 [==============================] - 8s 48ms/step - loss: 0.0957 - acc: 0.9795
Epoch 22/28

167/167 [==============================] - 8s 46ms/step - loss: 0.0890 - acc: 0.9816
Epoch 23/28

167/167 [==============================] - 8s 47ms/step - loss: 0.0831 - acc: 0.9829
Epoch 24/28

167/167 [==============================] - 8s 46ms/step - loss: 0.0772 - acc: 0.9848
Epoch 25/28

167/167 [==============================] - 8s 48ms/step - loss: 0.0725 - acc: 0.9870
Epoch 26/28

167/167 [==============================] - 8s 49ms/step - loss: 0.0700 - acc: 0.9867
Epoch 27/28

167/167 [==============================] - 8s 47ms/step - loss: 0.0672 - acc: 0.9878
Epoch 28/28

167/167 [==============================] - 8s 48ms/step - loss: 0.0639 - acc: 0.9887
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7836
False 1235
True percentage 0.86385183552
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
     B-MISC       0.25      0.21      0.23       141
     I-MISC       0.38      0.19      0.25       154
      B-ORG       0.49      0.45      0.47       296
      B-LOC       0.77      0.61      0.68       218
      B-PER       0.85      0.64      0.73       438
      I-PER       0.75      0.57      0.65       214
      I-ORG       0.37      0.48      0.41       151
      I-LOC       0.62      0.67      0.64       141

avg / total       0.90      0.86      0.88      9071

F-1 Score (without O):
0.552321981424
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104181 unique words.
4177 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 273
OOV word occurences: in test 525
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6667648     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,779,778
Trainable params: 6,779,778
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 13s 80ms/step - loss: 0.9347 - acc: 0.7346
Epoch 2/28

167/167 [==============================] - 8s 51ms/step - loss: 0.4599 - acc: 0.8471
Epoch 3/28

167/167 [==============================] - 8s 50ms/step - loss: 0.3971 - acc: 0.8729
Epoch 4/28

167/167 [==============================] - 8s 49ms/step - loss: 0.3614 - acc: 0.8840
Epoch 5/28

167/167 [==============================] - 8s 49ms/step - loss: 0.3252 - acc: 0.8972
Epoch 6/28

167/167 [==============================] - 8s 50ms/step - loss: 0.2849 - acc: 0.9140
Epoch 7/28

167/167 [==============================] - 8s 49ms/step - loss: 0.2686 - acc: 0.9213
Epoch 8/28

167/167 [==============================] - 8s 47ms/step - loss: 0.2375 - acc: 0.9349
Epoch 9/28

167/167 [==============================] - 8s 49ms/step - loss: 0.2177 - acc: 0.9398
Epoch 10/28

167/167 [==============================] - 8s 47ms/step - loss: 0.2034 - acc: 0.9422
Epoch 11/28

167/167 [==============================] - 8s 49ms/step - loss: 0.1807 - acc: 0.9548
Epoch 12/28

167/167 [==============================] - 8s 47ms/step - loss: 0.1674 - acc: 0.9574
Epoch 13/28

167/167 [==============================] - 8s 49ms/step - loss: 0.1557 - acc: 0.9609
Epoch 14/28

167/167 [==============================] - 8s 47ms/step - loss: 0.1458 - acc: 0.9664
Epoch 15/28

167/167 [==============================] - 8s 48ms/step - loss: 0.1330 - acc: 0.9675
Epoch 16/28

167/167 [==============================] - 8s 49ms/step - loss: 0.1260 - acc: 0.9731
Epoch 17/28

167/167 [==============================] - 8s 47ms/step - loss: 0.1128 - acc: 0.9767
Epoch 18/28

167/167 [==============================] - 8s 48ms/step - loss: 0.1060 - acc: 0.9766
Epoch 19/28

167/167 [==============================] - 8s 48ms/step - loss: 0.0980 - acc: 0.9821
Epoch 20/28

167/167 [==============================] - 8s 48ms/step - loss: 0.0882 - acc: 0.9822
Epoch 21/28

167/167 [==============================] - 8s 47ms/step - loss: 0.0822 - acc: 0.9857
Epoch 22/28

167/167 [==============================] - 8s 48ms/step - loss: 0.0789 - acc: 0.9844
Epoch 23/28

167/167 [==============================] - 8s 49ms/step - loss: 0.0732 - acc: 0.9868
Epoch 24/28

167/167 [==============================] - 7s 45ms/step - loss: 0.0700 - acc: 0.9858
Epoch 25/28

167/167 [==============================] - 7s 41ms/step - loss: 0.0632 - acc: 0.9897
Epoch 26/28

167/167 [==============================] - 7s 42ms/step - loss: 0.0624 - acc: 0.9910
Epoch 27/28

167/167 [==============================] - 8s 48ms/step - loss: 0.0616 - acc: 0.9900
Epoch 28/28

167/167 [==============================] - 8s 47ms/step - loss: 0.0527 - acc: 0.9928
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7765
False 1306
True percentage 0.85602469408
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.77      0.52      0.62       438
      I-PER       0.76      0.44      0.56       214
          O       0.97      0.95      0.96      7318
      B-ORG       0.57      0.61      0.59       296
      B-LOC       0.68      0.63      0.65       218
      I-ORG       0.25      0.40      0.31       151
      I-LOC       0.63      0.58      0.61       141
     B-MISC       0.38      0.09      0.14       141
     I-MISC       0.35      0.12      0.18       154

avg / total       0.90      0.86      0.87      9071

F-1 Score (without O):
0.892732334301
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104112 unique words.
4108 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 562
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663232     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,362
Trainable params: 6,775,362
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 10s 121ms/step - loss: 1.1578 - acc: 0.6763
Epoch 2/28

83/83 [==============================] - 4s 52ms/step - loss: 0.5287 - acc: 0.8376
Epoch 3/28

83/83 [==============================] - 4s 53ms/step - loss: 0.4129 - acc: 0.8860
Epoch 4/28

83/83 [==============================] - 4s 52ms/step - loss: 0.3630 - acc: 0.8915
Epoch 5/28

83/83 [==============================] - 4s 50ms/step - loss: 0.3335 - acc: 0.9089
Epoch 6/28

83/83 [==============================] - 4s 51ms/step - loss: 0.2940 - acc: 0.9126
Epoch 7/28

83/83 [==============================] - 4s 49ms/step - loss: 0.2562 - acc: 0.9326
Epoch 8/28

83/83 [==============================] - 4s 53ms/step - loss: 0.2442 - acc: 0.9347
Epoch 9/28

83/83 [==============================] - 4s 53ms/step - loss: 0.2197 - acc: 0.9434
Epoch 10/28

83/83 [==============================] - 4s 49ms/step - loss: 0.2047 - acc: 0.9481
Epoch 11/28

83/83 [==============================] - 4s 50ms/step - loss: 0.1929 - acc: 0.9458
Epoch 12/28

83/83 [==============================] - 4s 51ms/step - loss: 0.1876 - acc: 0.9526
Epoch 13/28

83/83 [==============================] - 4s 53ms/step - loss: 0.1748 - acc: 0.9557
Epoch 14/28

83/83 [==============================] - 4s 52ms/step - loss: 0.1658 - acc: 0.9565
Epoch 15/28

83/83 [==============================] - 4s 48ms/step - loss: 0.1454 - acc: 0.9654
Epoch 16/28

83/83 [==============================] - 4s 50ms/step - loss: 0.1431 - acc: 0.9666
Epoch 17/28

83/83 [==============================] - 4s 50ms/step - loss: 0.1322 - acc: 0.9692
Epoch 18/28

83/83 [==============================] - 4s 54ms/step - loss: 0.1266 - acc: 0.9733
Epoch 19/28

83/83 [==============================] - 4s 52ms/step - loss: 0.1237 - acc: 0.9692
Epoch 20/28

83/83 [==============================] - 4s 50ms/step - loss: 0.1150 - acc: 0.9753
Epoch 21/28

83/83 [==============================] - 4s 50ms/step - loss: 0.1169 - acc: 0.9670
Epoch 22/28

83/83 [==============================] - 4s 51ms/step - loss: 0.1013 - acc: 0.9775
Epoch 23/28

83/83 [==============================] - 4s 51ms/step - loss: 0.0974 - acc: 0.9791
Epoch 24/28

83/83 [==============================] - 4s 49ms/step - loss: 0.0946 - acc: 0.9812
Epoch 25/28

83/83 [==============================] - 4s 48ms/step - loss: 0.0894 - acc: 0.9833
Epoch 26/28

83/83 [==============================] - 4s 50ms/step - loss: 0.0907 - acc: 0.9813
Epoch 27/28

83/83 [==============================] - 4s 49ms/step - loss: 0.0785 - acc: 0.9843
Epoch 28/28

83/83 [==============================] - 4s 48ms/step - loss: 0.0817 - acc: 0.9821
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7602
False 1469
True percentage 0.838055341197
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.95      0.95      7318
      B-PER       0.77      0.49      0.60       438
      B-ORG       0.42      0.52      0.46       296
      I-ORG       0.19      0.40      0.26       151
      I-PER       0.75      0.39      0.52       214
      B-LOC       0.73      0.50      0.60       218
     B-MISC       0.61      0.10      0.17       141
      I-LOC       0.76      0.25      0.37       141
     I-MISC       0.73      0.05      0.10       154

avg / total       0.90      0.84      0.85      9071

F-1 Score (without O):
0.444808385195
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104114 unique words.
4110 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 276
OOV word occurences: in test 456
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663360     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,490
Trainable params: 6,775,490
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 10s 125ms/step - loss: 1.3150 - acc: 0.6317
Epoch 2/28

83/83 [==============================] - 4s 54ms/step - loss: 0.5483 - acc: 0.8279
Epoch 3/28

83/83 [==============================] - 4s 54ms/step - loss: 0.4696 - acc: 0.8479
Epoch 4/28

83/83 [==============================] - 4s 50ms/step - loss: 0.4065 - acc: 0.8772
Epoch 5/28

83/83 [==============================] - 4s 50ms/step - loss: 0.3660 - acc: 0.8935
Epoch 6/28

83/83 [==============================] - 4s 51ms/step - loss: 0.3376 - acc: 0.9067
Epoch 7/28

83/83 [==============================] - 4s 53ms/step - loss: 0.2952 - acc: 0.9163
Epoch 8/28

83/83 [==============================] - 4s 52ms/step - loss: 0.2889 - acc: 0.9249
Epoch 9/28

83/83 [==============================] - 4s 51ms/step - loss: 0.2509 - acc: 0.9293
Epoch 10/28

83/83 [==============================] - 4s 49ms/step - loss: 0.2255 - acc: 0.9463
Epoch 11/28

83/83 [==============================] - 4s 51ms/step - loss: 0.2233 - acc: 0.9471
Epoch 12/28

83/83 [==============================] - 4s 53ms/step - loss: 0.1980 - acc: 0.9536
Epoch 13/28

83/83 [==============================] - 4s 52ms/step - loss: 0.1841 - acc: 0.9552
Epoch 14/28

83/83 [==============================] - 4s 47ms/step - loss: 0.1800 - acc: 0.9500
Epoch 15/28

83/83 [==============================] - 4s 52ms/step - loss: 0.1557 - acc: 0.9666
Epoch 16/28

83/83 [==============================] - 4s 50ms/step - loss: 0.1517 - acc: 0.9715
Epoch 17/28

83/83 [==============================] - 4s 52ms/step - loss: 0.1438 - acc: 0.9700
Epoch 18/28

83/83 [==============================] - 4s 47ms/step - loss: 0.1344 - acc: 0.9725
Epoch 19/28

83/83 [==============================] - 4s 51ms/step - loss: 0.1225 - acc: 0.9787
Epoch 20/28

83/83 [==============================] - 4s 52ms/step - loss: 0.1146 - acc: 0.9812
Epoch 21/28

83/83 [==============================] - 4s 52ms/step - loss: 0.1160 - acc: 0.9767
Epoch 22/28

83/83 [==============================] - 4s 52ms/step - loss: 0.1088 - acc: 0.9749
Epoch 23/28

83/83 [==============================] - 4s 48ms/step - loss: 0.0931 - acc: 0.9874
Epoch 24/28

83/83 [==============================] - 4s 50ms/step - loss: 0.0907 - acc: 0.9886
Epoch 25/28

83/83 [==============================] - 4s 51ms/step - loss: 0.0892 - acc: 0.9882
Epoch 26/28

83/83 [==============================] - 4s 51ms/step - loss: 0.0858 - acc: 0.9869
Epoch 27/28

83/83 [==============================] - 4s 52ms/step - loss: 0.0735 - acc: 0.9885
Epoch 28/28

83/83 [==============================] - 4s 46ms/step - loss: 0.0712 - acc: 0.9909
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7785
False 1286
True percentage 0.858229522655
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-PER       0.77      0.66      0.71       438
      B-ORG       0.52      0.52      0.52       296
      I-ORG       0.26      0.28      0.27       151
     B-MISC       0.20      0.09      0.12       141
     I-MISC       0.36      0.28      0.32       154
      I-PER       0.74      0.54      0.63       214
      B-LOC       0.69      0.60      0.64       218
      I-LOC       0.70      0.38      0.50       141

avg / total       0.89      0.86      0.87      9071

F-1 Score (without O):
0.527603513174
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104134 unique words.
4130 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 280
OOV word occurences: in test 543
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6664640     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,776,770
Trainable params: 6,776,770
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 8s 100ms/step - loss: 1.2766 - acc: 0.6401
Epoch 2/28

83/83 [==============================] - 4s 53ms/step - loss: 0.5824 - acc: 0.8216
Epoch 3/28

83/83 [==============================] - 4s 51ms/step - loss: 0.5234 - acc: 0.8319
Epoch 4/28

83/83 [==============================] - 4s 54ms/step - loss: 0.4412 - acc: 0.8697
Epoch 5/28

83/83 [==============================] - 4s 54ms/step - loss: 0.3985 - acc: 0.8796
Epoch 6/28

83/83 [==============================] - 4s 53ms/step - loss: 0.3815 - acc: 0.8902
Epoch 7/28

83/83 [==============================] - 4s 52ms/step - loss: 0.3249 - acc: 0.9140
Epoch 8/28

83/83 [==============================] - 4s 53ms/step - loss: 0.3008 - acc: 0.9092
Epoch 9/28

83/83 [==============================] - 4s 50ms/step - loss: 0.2802 - acc: 0.9263
Epoch 10/28

83/83 [==============================] - 4s 50ms/step - loss: 0.2641 - acc: 0.9252
Epoch 11/28

83/83 [==============================] - 4s 52ms/step - loss: 0.2299 - acc: 0.9478
Epoch 12/28

83/83 [==============================] - 4s 52ms/step - loss: 0.2204 - acc: 0.9467
Epoch 13/28

83/83 [==============================] - 4s 53ms/step - loss: 0.2083 - acc: 0.9539
Epoch 14/28

83/83 [==============================] - 4s 52ms/step - loss: 0.1896 - acc: 0.9496
Epoch 15/28

83/83 [==============================] - 4s 48ms/step - loss: 0.1762 - acc: 0.9555
Epoch 16/28

83/83 [==============================] - 4s 51ms/step - loss: 0.1757 - acc: 0.9626
Epoch 17/28

83/83 [==============================] - 4s 50ms/step - loss: 0.1569 - acc: 0.9647
Epoch 18/28

83/83 [==============================] - 4s 51ms/step - loss: 0.1480 - acc: 0.9659
Epoch 19/28

83/83 [==============================] - 4s 48ms/step - loss: 0.1368 - acc: 0.9715
Epoch 20/28

83/83 [==============================] - 4s 52ms/step - loss: 0.1293 - acc: 0.9707
Epoch 21/28

83/83 [==============================] - 4s 51ms/step - loss: 0.1312 - acc: 0.9694
Epoch 22/28

83/83 [==============================] - 4s 51ms/step - loss: 0.1174 - acc: 0.9808
Epoch 23/28

83/83 [==============================] - 4s 48ms/step - loss: 0.1077 - acc: 0.9814
Epoch 24/28

83/83 [==============================] - 4s 52ms/step - loss: 0.1097 - acc: 0.9767
Epoch 25/28

83/83 [==============================] - 4s 49ms/step - loss: 0.1023 - acc: 0.9825
Epoch 26/28

83/83 [==============================] - 4s 53ms/step - loss: 0.0979 - acc: 0.9830
Epoch 27/28

83/83 [==============================] - 4s 51ms/step - loss: 0.0857 - acc: 0.9865
Epoch 28/28

83/83 [==============================] - 4s 48ms/step - loss: 0.0800 - acc: 0.9882
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7656
False 1415
True percentage 0.844008378349
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.95      0.96      7318
      B-ORG       0.61      0.49      0.54       296
      B-PER       0.81      0.44      0.57       438
      I-PER       0.61      0.31      0.41       214
      B-LOC       0.66      0.56      0.61       218
      I-LOC       0.50      0.52      0.51       141
      I-ORG       0.19      0.23      0.21       151
     B-MISC       0.18      0.09      0.12       141
     I-MISC       0.38      0.30      0.33       154

avg / total       0.89      0.84      0.86      9071

F-1 Score (without O):
0.456786066382
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104118 unique words.
4114 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 276
OOV word occurences: in test 477
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663616     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,746
Trainable params: 6,775,746
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 10s 123ms/step - loss: 1.0885 - acc: 0.6632
Epoch 2/28

83/83 [==============================] - 4s 51ms/step - loss: 0.4615 - acc: 0.8540
Epoch 3/28

83/83 [==============================] - 4s 52ms/step - loss: 0.3962 - acc: 0.8776
Epoch 4/28

83/83 [==============================] - 4s 52ms/step - loss: 0.3341 - acc: 0.8897
Epoch 5/28

83/83 [==============================] - 4s 54ms/step - loss: 0.2993 - acc: 0.9179
Epoch 6/28

83/83 [==============================] - 4s 44ms/step - loss: 0.2841 - acc: 0.9169
Epoch 7/28

83/83 [==============================] - 4s 44ms/step - loss: 0.2818 - acc: 0.9245
Epoch 8/28

83/83 [==============================] - 4s 43ms/step - loss: 0.2309 - acc: 0.9379
Epoch 9/28

83/83 [==============================] - 4s 44ms/step - loss: 0.2134 - acc: 0.9372
Epoch 10/28

83/83 [==============================] - 4s 49ms/step - loss: 0.1985 - acc: 0.9442
Epoch 11/28

83/83 [==============================] - 4s 53ms/step - loss: 0.1871 - acc: 0.9457
Epoch 12/28

83/83 [==============================] - 4s 51ms/step - loss: 0.1698 - acc: 0.9560
Epoch 13/28

83/83 [==============================] - 4s 50ms/step - loss: 0.1579 - acc: 0.9607
Epoch 14/28

83/83 [==============================] - 4s 52ms/step - loss: 0.1421 - acc: 0.9683
Epoch 15/28

83/83 [==============================] - 4s 52ms/step - loss: 0.1366 - acc: 0.9645
Epoch 16/28

83/83 [==============================] - 4s 52ms/step - loss: 0.1284 - acc: 0.9727
Epoch 17/28

83/83 [==============================] - 4s 53ms/step - loss: 0.1204 - acc: 0.9731
Epoch 18/28

83/83 [==============================] - 4s 45ms/step - loss: 0.1188 - acc: 0.9754
Epoch 19/28

83/83 [==============================] - 4s 50ms/step - loss: 0.1063 - acc: 0.9771
Epoch 20/28

83/83 [==============================] - 4s 51ms/step - loss: 0.0964 - acc: 0.9862
Epoch 21/28

83/83 [==============================] - 4s 47ms/step - loss: 0.0909 - acc: 0.9859
Epoch 22/28

83/83 [==============================] - 4s 50ms/step - loss: 0.0872 - acc: 0.9853
Epoch 23/28

83/83 [==============================] - 4s 51ms/step - loss: 0.0809 - acc: 0.9873
Epoch 24/28

83/83 [==============================] - 4s 53ms/step - loss: 0.0716 - acc: 0.9897
Epoch 25/28

83/83 [==============================] - 4s 50ms/step - loss: 0.0703 - acc: 0.9857
Epoch 26/28

83/83 [==============================] - 4s 46ms/step - loss: 0.0697 - acc: 0.9893
Epoch 27/28

83/83 [==============================] - 4s 51ms/step - loss: 0.0657 - acc: 0.9902
Epoch 28/28

83/83 [==============================] - 4s 51ms/step - loss: 0.0555 - acc: 0.9930
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7658
False 1413
True percentage 0.844228861206
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.95      0.95      7318
     B-MISC       0.20      0.16      0.18       141
     I-MISC       0.19      0.10      0.13       154
      B-ORG       0.49      0.40      0.44       296
      B-LOC       0.64      0.55      0.59       218
      B-PER       0.81      0.55      0.66       438
      I-PER       0.77      0.48      0.59       214
      I-ORG       0.20      0.23      0.22       151
      I-LOC       0.61      0.52      0.56       141

avg / total       0.88      0.84      0.86      9071

F-1 Score (without O):
0.469980632666
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104107 unique words.
4103 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 276
OOV word occurences: in test 528
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6662912     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,042
Trainable params: 6,775,042
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 10s 123ms/step - loss: 1.1368 - acc: 0.6699
Epoch 2/28

83/83 [==============================] - 5s 55ms/step - loss: 0.5073 - acc: 0.8508
Epoch 3/28

83/83 [==============================] - 5s 55ms/step - loss: 0.4445 - acc: 0.8648
Epoch 4/28

83/83 [==============================] - 4s 51ms/step - loss: 0.3924 - acc: 0.8829
Epoch 5/28

83/83 [==============================] - 4s 51ms/step - loss: 0.3457 - acc: 0.8885
Epoch 6/28

83/83 [==============================] - 4s 51ms/step - loss: 0.3191 - acc: 0.9011
Epoch 7/28

83/83 [==============================] - 4s 52ms/step - loss: 0.2938 - acc: 0.9117
Epoch 8/28

83/83 [==============================] - 4s 53ms/step - loss: 0.2560 - acc: 0.9218
Epoch 9/28

83/83 [==============================] - 4s 53ms/step - loss: 0.2450 - acc: 0.9326
Epoch 10/28

83/83 [==============================] - 4s 49ms/step - loss: 0.2289 - acc: 0.9275
Epoch 11/28

83/83 [==============================] - 4s 50ms/step - loss: 0.2169 - acc: 0.9371
Epoch 12/28

83/83 [==============================] - 4s 51ms/step - loss: 0.1936 - acc: 0.9425
Epoch 13/28

83/83 [==============================] - 4s 54ms/step - loss: 0.1776 - acc: 0.9578
Epoch 14/28

83/83 [==============================] - 4s 49ms/step - loss: 0.1656 - acc: 0.9562
Epoch 15/28

83/83 [==============================] - 4s 43ms/step - loss: 0.1533 - acc: 0.9620
Epoch 16/28

83/83 [==============================] - 4s 45ms/step - loss: 0.1398 - acc: 0.9684
Epoch 17/28

83/83 [==============================] - 4s 44ms/step - loss: 0.1272 - acc: 0.9767
Epoch 18/28

83/83 [==============================] - 4s 43ms/step - loss: 0.1182 - acc: 0.9787
Epoch 19/28

83/83 [==============================] - 4s 50ms/step - loss: 0.1131 - acc: 0.9789
Epoch 20/28

83/83 [==============================] - 4s 46ms/step - loss: 0.1132 - acc: 0.9770
Epoch 21/28

83/83 [==============================] - 4s 51ms/step - loss: 0.0923 - acc: 0.9856
Epoch 22/28

83/83 [==============================] - 4s 51ms/step - loss: 0.0921 - acc: 0.9884
Epoch 23/28

83/83 [==============================] - 4s 53ms/step - loss: 0.0847 - acc: 0.9889
Epoch 24/28

83/83 [==============================] - 4s 49ms/step - loss: 0.0813 - acc: 0.9895
Epoch 25/28

83/83 [==============================] - 4s 49ms/step - loss: 0.0739 - acc: 0.9913
Epoch 26/28

83/83 [==============================] - 4s 51ms/step - loss: 0.0706 - acc: 0.9915
Epoch 27/28

83/83 [==============================] - 4s 52ms/step - loss: 0.0689 - acc: 0.9901
Epoch 28/28

83/83 [==============================] - 4s 49ms/step - loss: 0.0561 - acc: 0.9976
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7620
False 1451
True percentage 0.840039686914
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.81      0.39      0.52       438
      I-PER       0.75      0.13      0.22       214
          O       0.95      0.95      0.95      7318
      B-ORG       0.50      0.65      0.57       296
      B-LOC       0.74      0.54      0.62       218
      I-ORG       0.22      0.38      0.28       151
      I-LOC       0.56      0.33      0.41       141
     B-MISC       0.44      0.06      0.10       141
     I-MISC       0.33      0.14      0.20       154

avg / total       0.88      0.84      0.85      9071

F-1 Score (without O):
0.878293157305
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104069 unique words.
4065 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660480     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,610
Trainable params: 6,772,610
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 8s 232ms/step - loss: 2.3491 - acc: 0.3277
Epoch 2/28

33/33 [==============================] - 2s 61ms/step - loss: 0.5713 - acc: 0.8631
Epoch 3/28

33/33 [==============================] - 2s 58ms/step - loss: 0.4276 - acc: 0.8686
Epoch 4/28

33/33 [==============================] - 2s 59ms/step - loss: 0.3765 - acc: 0.8871
Epoch 5/28

33/33 [==============================] - 2s 65ms/step - loss: 0.3408 - acc: 0.8848
Epoch 6/28

33/33 [==============================] - 2s 52ms/step - loss: 0.2879 - acc: 0.9075
Epoch 7/28

33/33 [==============================] - 2s 62ms/step - loss: 0.2530 - acc: 0.9263
Epoch 8/28

33/33 [==============================] - 2s 65ms/step - loss: 0.2461 - acc: 0.9296
Epoch 9/28

33/33 [==============================] - 2s 56ms/step - loss: 0.2381 - acc: 0.9270
Epoch 10/28

33/33 [==============================] - 2s 54ms/step - loss: 0.2511 - acc: 0.9260
Epoch 11/28

33/33 [==============================] - 2s 61ms/step - loss: 0.1881 - acc: 0.9520
Epoch 12/28

33/33 [==============================] - 2s 63ms/step - loss: 0.1822 - acc: 0.9501
Epoch 13/28

33/33 [==============================] - 2s 53ms/step - loss: 0.1792 - acc: 0.9496
Epoch 14/28

33/33 [==============================] - 2s 59ms/step - loss: 0.1746 - acc: 0.9660
Epoch 15/28

33/33 [==============================] - 2s 66ms/step - loss: 0.1606 - acc: 0.9549
Epoch 16/28

33/33 [==============================] - 2s 54ms/step - loss: 0.1587 - acc: 0.9610
Epoch 17/28

33/33 [==============================] - 2s 54ms/step - loss: 0.1410 - acc: 0.9649
Epoch 18/28

33/33 [==============================] - 2s 66ms/step - loss: 0.1537 - acc: 0.9599
Epoch 19/28

33/33 [==============================] - 2s 61ms/step - loss: 0.1470 - acc: 0.9616
Epoch 20/28

33/33 [==============================] - 2s 59ms/step - loss: 0.1282 - acc: 0.9662
Epoch 21/28

33/33 [==============================] - 2s 62ms/step - loss: 0.1191 - acc: 0.9737
Epoch 22/28

33/33 [==============================] - 2s 61ms/step - loss: 0.1183 - acc: 0.9780
Epoch 23/28

33/33 [==============================] - 2s 53ms/step - loss: 0.1101 - acc: 0.9738
Epoch 24/28

33/33 [==============================] - 2s 60ms/step - loss: 0.1076 - acc: 0.9760
Epoch 25/28

33/33 [==============================] - 2s 63ms/step - loss: 0.1046 - acc: 0.9759
Epoch 26/28

33/33 [==============================] - 2s 55ms/step - loss: 0.1027 - acc: 0.9758
Epoch 27/28

33/33 [==============================] - 2s 55ms/step - loss: 0.0941 - acc: 0.9806
Epoch 28/28

33/33 [==============================] - 2s 58ms/step - loss: 0.1001 - acc: 0.9789
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7197
False 1874
True percentage 0.793407562562
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.93      0.94      7318
      B-PER       0.64      0.31      0.42       438
      B-ORG       0.21      0.48      0.29       296
      I-ORG       0.16      0.30      0.20       151
      I-PER       0.65      0.21      0.31       214
      B-LOC       0.50      0.00      0.01       218
     B-MISC       0.00      0.00      0.00       141
      I-LOC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.83      0.79      0.80      9071

F-1 Score (without O):
0.244437064098
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104062 unique words.
4058 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 281
OOV word occurences: in test 473
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660032     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,162
Trainable params: 6,772,162
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 6s 190ms/step - loss: 1.8433 - acc: 0.4076
Epoch 2/28

33/33 [==============================] - 2s 52ms/step - loss: 0.7907 - acc: 0.8123
Epoch 3/28

33/33 [==============================] - 2s 55ms/step - loss: 0.6633 - acc: 0.8148
Epoch 4/28

33/33 [==============================] - 2s 50ms/step - loss: 0.4890 - acc: 0.8513
Epoch 5/28

33/33 [==============================] - 2s 57ms/step - loss: 0.4530 - acc: 0.8586
Epoch 6/28

33/33 [==============================] - 2s 56ms/step - loss: 0.4050 - acc: 0.8613
Epoch 7/28

33/33 [==============================] - 2s 60ms/step - loss: 0.4191 - acc: 0.8765
Epoch 8/28

33/33 [==============================] - 2s 65ms/step - loss: 0.3482 - acc: 0.8803
Epoch 9/28

33/33 [==============================] - 2s 56ms/step - loss: 0.3717 - acc: 0.9105
Epoch 10/28

33/33 [==============================] - 2s 58ms/step - loss: 0.2885 - acc: 0.9298
Epoch 11/28

33/33 [==============================] - 2s 62ms/step - loss: 0.3092 - acc: 0.9228
Epoch 12/28

33/33 [==============================] - 2s 57ms/step - loss: 0.2785 - acc: 0.9247
Epoch 13/28

33/33 [==============================] - 2s 57ms/step - loss: 0.2648 - acc: 0.9484
Epoch 14/28

33/33 [==============================] - 2s 62ms/step - loss: 0.2640 - acc: 0.9391
Epoch 15/28

33/33 [==============================] - 2s 56ms/step - loss: 0.2432 - acc: 0.9352
Epoch 16/28

33/33 [==============================] - 2s 58ms/step - loss: 0.2302 - acc: 0.9490
Epoch 17/28

33/33 [==============================] - 2s 60ms/step - loss: 0.2194 - acc: 0.9527
Epoch 18/28

33/33 [==============================] - 2s 58ms/step - loss: 0.2115 - acc: 0.9470
Epoch 19/28

33/33 [==============================] - 2s 55ms/step - loss: 0.2306 - acc: 0.9349
Epoch 20/28

33/33 [==============================] - 2s 58ms/step - loss: 0.1961 - acc: 0.9670
Epoch 21/28

33/33 [==============================] - 2s 58ms/step - loss: 0.1758 - acc: 0.9622
Epoch 22/28

33/33 [==============================] - 2s 59ms/step - loss: 0.1759 - acc: 0.9704
Epoch 23/28

33/33 [==============================] - 2s 57ms/step - loss: 0.1601 - acc: 0.9778
Epoch 24/28

33/33 [==============================] - 2s 61ms/step - loss: 0.1566 - acc: 0.9857
Epoch 25/28

33/33 [==============================] - 2s 60ms/step - loss: 0.1572 - acc: 0.9782
Epoch 26/28

33/33 [==============================] - 2s 55ms/step - loss: 0.1561 - acc: 0.9754
Epoch 27/28

33/33 [==============================] - 2s 55ms/step - loss: 0.1609 - acc: 0.9725
Epoch 28/28

33/33 [==============================] - 2s 60ms/step - loss: 0.1351 - acc: 0.9857
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7502
False 1569
True percentage 0.827031198324
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.94      0.95      7318
      B-PER       0.66      0.50      0.57       438
      B-ORG       0.39      0.40      0.39       296
      I-ORG       0.15      0.14      0.15       151
     B-MISC       0.21      0.06      0.10       141
     I-MISC       0.27      0.37      0.31       154
      I-PER       0.48      0.41      0.44       214
      B-LOC       0.46      0.50      0.48       218
      I-LOC       0.74      0.14      0.24       141

avg / total       0.87      0.83      0.84      9071

F-1 Score (without O):
0.396653238302
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104087 unique words.
4083 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 553
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6661632     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,773,762
Trainable params: 6,773,762
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 8s 231ms/step - loss: 2.0383 - acc: 0.3862
Epoch 2/28

33/33 [==============================] - 2s 61ms/step - loss: 0.9550 - acc: 0.7450
Epoch 3/28

33/33 [==============================] - 2s 61ms/step - loss: 0.7835 - acc: 0.7956
Epoch 4/28

33/33 [==============================] - 2s 57ms/step - loss: 0.5767 - acc: 0.8263
Epoch 5/28

33/33 [==============================] - 2s 65ms/step - loss: 0.5049 - acc: 0.8445
Epoch 6/28

33/33 [==============================] - 2s 57ms/step - loss: 0.4644 - acc: 0.8673
Epoch 7/28

33/33 [==============================] - 2s 56ms/step - loss: 0.4471 - acc: 0.8560
Epoch 8/28

33/33 [==============================] - 2s 61ms/step - loss: 0.4172 - acc: 0.8761
Epoch 9/28

33/33 [==============================] - 2s 61ms/step - loss: 0.3796 - acc: 0.8790
Epoch 10/28

33/33 [==============================] - 2s 56ms/step - loss: 0.3503 - acc: 0.9087
Epoch 11/28

33/33 [==============================] - 2s 58ms/step - loss: 0.3465 - acc: 0.9064
Epoch 12/28

33/33 [==============================] - 2s 64ms/step - loss: 0.3984 - acc: 0.8930
Epoch 13/28

33/33 [==============================] - 2s 54ms/step - loss: 0.3116 - acc: 0.9160
Epoch 14/28

33/33 [==============================] - 2s 59ms/step - loss: 0.2924 - acc: 0.9277
Epoch 15/28

33/33 [==============================] - 2s 65ms/step - loss: 0.2790 - acc: 0.9360
Epoch 16/28

33/33 [==============================] - 2s 55ms/step - loss: 0.2630 - acc: 0.9437
Epoch 17/28

33/33 [==============================] - 2s 55ms/step - loss: 0.2488 - acc: 0.9447
Epoch 18/28

33/33 [==============================] - 2s 58ms/step - loss: 0.2350 - acc: 0.9597
Epoch 19/28

33/33 [==============================] - 2s 62ms/step - loss: 0.2291 - acc: 0.9489
Epoch 20/28

33/33 [==============================] - 2s 56ms/step - loss: 0.2189 - acc: 0.9472
Epoch 21/28

33/33 [==============================] - 2s 54ms/step - loss: 0.2079 - acc: 0.9735
Epoch 22/28

33/33 [==============================] - 2s 54ms/step - loss: 0.1843 - acc: 0.9755
Epoch 23/28

33/33 [==============================] - 2s 65ms/step - loss: 0.1872 - acc: 0.9674
Epoch 24/28

33/33 [==============================] - 2s 58ms/step - loss: 0.1949 - acc: 0.9693
Epoch 25/28

33/33 [==============================] - 2s 56ms/step - loss: 0.1618 - acc: 0.9871
Epoch 26/28

33/33 [==============================] - 2s 61ms/step - loss: 0.1535 - acc: 0.9877
Epoch 27/28

33/33 [==============================] - 2s 59ms/step - loss: 0.1480 - acc: 0.9834
Epoch 28/28

33/33 [==============================] - 2s 55ms/step - loss: 0.1435 - acc: 0.9793
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7419
False 1652
True percentage 0.81788115974
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.93      0.95      7318
      B-ORG       0.35      0.55      0.43       296
      B-PER       0.65      0.22      0.33       438
      I-PER       0.58      0.23      0.33       214
      B-LOC       0.71      0.44      0.55       218
      I-LOC       0.32      0.49      0.39       141
      I-ORG       0.15      0.21      0.17       151
     B-MISC       0.33      0.23      0.27       141
     I-MISC       0.34      0.26      0.30       154

avg / total       0.88      0.82      0.84      9071

F-1 Score (without O):
0.357849196539
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104068 unique words.
4064 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 279
OOV word occurences: in test 482
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660416     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,546
Trainable params: 6,772,546
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 6s 191ms/step - loss: 1.7724 - acc: 0.4252
Epoch 2/28

33/33 [==============================] - 2s 52ms/step - loss: 0.7725 - acc: 0.8125
Epoch 3/28

33/33 [==============================] - 2s 56ms/step - loss: 0.6196 - acc: 0.8118
Epoch 4/28

33/33 [==============================] - 2s 61ms/step - loss: 0.5120 - acc: 0.8189
Epoch 5/28

33/33 [==============================] - 2s 63ms/step - loss: 0.4688 - acc: 0.8313
Epoch 6/28

33/33 [==============================] - 2s 60ms/step - loss: 0.4728 - acc: 0.8400
Epoch 7/28

33/33 [==============================] - 2s 57ms/step - loss: 0.4388 - acc: 0.8535
Epoch 8/28

33/33 [==============================] - 2s 69ms/step - loss: 0.3765 - acc: 0.8833
Epoch 9/28

33/33 [==============================] - 2s 55ms/step - loss: 0.3410 - acc: 0.8941
Epoch 10/28

33/33 [==============================] - 2s 58ms/step - loss: 0.3768 - acc: 0.8861
Epoch 11/28

33/33 [==============================] - 2s 65ms/step - loss: 0.3448 - acc: 0.8888
Epoch 12/28

33/33 [==============================] - 2s 57ms/step - loss: 0.3104 - acc: 0.9169
Epoch 13/28

33/33 [==============================] - 2s 60ms/step - loss: 0.2944 - acc: 0.9157
Epoch 14/28

33/33 [==============================] - 2s 62ms/step - loss: 0.2664 - acc: 0.9368
Epoch 15/28

33/33 [==============================] - 2s 60ms/step - loss: 0.2684 - acc: 0.9397
Epoch 16/28

33/33 [==============================] - 2s 55ms/step - loss: 0.2466 - acc: 0.9464
Epoch 17/28

33/33 [==============================] - 2s 58ms/step - loss: 0.2338 - acc: 0.9420
Epoch 18/28

33/33 [==============================] - 2s 61ms/step - loss: 0.2182 - acc: 0.9572
Epoch 19/28

33/33 [==============================] - 2s 58ms/step - loss: 0.2804 - acc: 0.9304
Epoch 20/28

33/33 [==============================] - 2s 55ms/step - loss: 0.2069 - acc: 0.9612
Epoch 21/28

33/33 [==============================] - 2s 59ms/step - loss: 0.1952 - acc: 0.9543
Epoch 22/28

33/33 [==============================] - 2s 62ms/step - loss: 0.1827 - acc: 0.9590
Epoch 23/28

33/33 [==============================] - 2s 59ms/step - loss: 0.1786 - acc: 0.9615
Epoch 24/28

33/33 [==============================] - 2s 57ms/step - loss: 0.1692 - acc: 0.9695
Epoch 25/28

33/33 [==============================] - 2s 64ms/step - loss: 0.1656 - acc: 0.9798
Epoch 26/28

33/33 [==============================] - 2s 55ms/step - loss: 0.1588 - acc: 0.9765
Epoch 27/28

33/33 [==============================] - 2s 55ms/step - loss: 0.1472 - acc: 0.9716
Epoch 28/28

33/33 [==============================] - 2s 63ms/step - loss: 0.1498 - acc: 0.9759
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7517
False 1554
True percentage 0.828684819755
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.92      0.96      0.94      7318
     B-MISC       0.16      0.07      0.10       141
     I-MISC       0.33      0.03      0.05       154
      B-ORG       0.40      0.31      0.35       296
      B-LOC       0.62      0.45      0.53       218
      B-PER       0.76      0.45      0.56       438
      I-PER       0.55      0.40      0.46       214
      I-ORG       0.17      0.12      0.14       151
      I-LOC       0.55      0.13      0.21       141

avg / total       0.84      0.83      0.83      9071

F-1 Score (without O):
0.376895306859
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104068 unique words.
4064 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 281
OOV word occurences: in test 534
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660416     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,546
Trainable params: 6,772,546
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 8s 231ms/step - loss: 1.6240 - acc: 0.5458
Epoch 2/28

33/33 [==============================] - 2s 69ms/step - loss: 0.8580 - acc: 0.7696
Epoch 3/28

33/33 [==============================] - 2s 57ms/step - loss: 0.5585 - acc: 0.8157
Epoch 4/28

33/33 [==============================] - 2s 58ms/step - loss: 0.5218 - acc: 0.8210
Epoch 5/28

33/33 [==============================] - 2s 65ms/step - loss: 0.4780 - acc: 0.8525
Epoch 6/28

33/33 [==============================] - 2s 58ms/step - loss: 0.4026 - acc: 0.8791
Epoch 7/28

33/33 [==============================] - 2s 62ms/step - loss: 0.3852 - acc: 0.8789
Epoch 8/28

33/33 [==============================] - 2s 62ms/step - loss: 0.3606 - acc: 0.8944
Epoch 9/28

33/33 [==============================] - 2s 55ms/step - loss: 0.3455 - acc: 0.8979
Epoch 10/28

33/33 [==============================] - 2s 57ms/step - loss: 0.3092 - acc: 0.9107
Epoch 11/28

33/33 [==============================] - 2s 62ms/step - loss: 0.3027 - acc: 0.9041
Epoch 12/28

33/33 [==============================] - 2s 62ms/step - loss: 0.2997 - acc: 0.9084
Epoch 13/28

33/33 [==============================] - 2s 54ms/step - loss: 0.2697 - acc: 0.9228
Epoch 14/28

33/33 [==============================] - 2s 59ms/step - loss: 0.2623 - acc: 0.9277
Epoch 15/28

33/33 [==============================] - 2s 62ms/step - loss: 0.2496 - acc: 0.9220
Epoch 16/28

33/33 [==============================] - 2s 58ms/step - loss: 0.2331 - acc: 0.9307
Epoch 17/28

33/33 [==============================] - 2s 54ms/step - loss: 0.2334 - acc: 0.9320
Epoch 18/28

33/33 [==============================] - 2s 59ms/step - loss: 0.2230 - acc: 0.9234
Epoch 19/28

33/33 [==============================] - 2s 58ms/step - loss: 0.2050 - acc: 0.9365
Epoch 20/28

33/33 [==============================] - 2s 60ms/step - loss: 0.2027 - acc: 0.9465
Epoch 21/28

33/33 [==============================] - 2s 54ms/step - loss: 0.2084 - acc: 0.9361
Epoch 22/28

33/33 [==============================] - 2s 57ms/step - loss: 0.1828 - acc: 0.9526
Epoch 23/28

33/33 [==============================] - 2s 66ms/step - loss: 0.1651 - acc: 0.9491
Epoch 24/28

33/33 [==============================] - 2s 56ms/step - loss: 0.1828 - acc: 0.9496
Epoch 25/28

33/33 [==============================] - 2s 53ms/step - loss: 0.1620 - acc: 0.9602
Epoch 26/28

33/33 [==============================] - 2s 61ms/step - loss: 0.1530 - acc: 0.9652
Epoch 27/28

33/33 [==============================] - 2s 61ms/step - loss: 0.1434 - acc: 0.9715
Epoch 28/28

33/33 [==============================] - 2s 54ms/step - loss: 0.1391 - acc: 0.9748
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7345
False 1726
True percentage 0.809723294014
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.64      0.36      0.46       438
      I-PER       1.00      0.01      0.02       214
          O       0.96      0.94      0.95      7318
      B-ORG       0.36      0.56      0.44       296
      B-LOC       0.63      0.23      0.34       218
      I-ORG       0.16      0.34      0.22       151
      I-LOC       0.50      0.07      0.12       141
     B-MISC       0.38      0.04      0.08       141
     I-MISC       0.20      0.29      0.24       154

avg / total       0.87      0.81      0.82      9071

F-1 Score (without O):
0.849462365591
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 7 unique labels.
Found 104057 unique words.
4053 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659712     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 8)        1112        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,544
Trainable params: 6,771,544
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 6s 362ms/step - loss: 2.8064 - acc: 0.0253
Epoch 2/28

16/16 [==============================] - 1s 43ms/step - loss: 0.9937 - acc: 0.8062
Epoch 3/28

16/16 [==============================] - 1s 53ms/step - loss: 0.6807 - acc: 0.8287
Epoch 4/28

16/16 [==============================] - 1s 35ms/step - loss: 0.6010 - acc: 0.8596
Epoch 5/28

16/16 [==============================] - 1s 52ms/step - loss: 0.6211 - acc: 0.8287
Epoch 6/28

16/16 [==============================] - 1s 42ms/step - loss: 0.4566 - acc: 0.8680
Epoch 7/28

16/16 [==============================] - 1s 56ms/step - loss: 0.4058 - acc: 0.8483
Epoch 8/28

16/16 [==============================] - 1s 36ms/step - loss: 0.3734 - acc: 0.8820
Epoch 9/28

16/16 [==============================] - 1s 60ms/step - loss: 0.3503 - acc: 0.8680
Epoch 10/28

16/16 [==============================] - 1s 38ms/step - loss: 0.3022 - acc: 0.8961
Epoch 11/28

16/16 [==============================] - 1s 52ms/step - loss: 0.2908 - acc: 0.9045
Epoch 12/28

16/16 [==============================] - 1s 41ms/step - loss: 0.2654 - acc: 0.9326
Epoch 13/28

16/16 [==============================] - 1s 60ms/step - loss: 0.2668 - acc: 0.9073
Epoch 14/28

16/16 [==============================] - 1s 41ms/step - loss: 0.2397 - acc: 0.9382
Epoch 15/28

16/16 [==============================] - 1s 53ms/step - loss: 0.2248 - acc: 0.9298
Epoch 16/28

16/16 [==============================] - 1s 42ms/step - loss: 0.2039 - acc: 0.9551
Epoch 17/28

16/16 [==============================] - 1s 56ms/step - loss: 0.2008 - acc: 0.9579
Epoch 18/28

16/16 [==============================] - 1s 39ms/step - loss: 0.1897 - acc: 0.9635
Epoch 19/28

16/16 [==============================] - 1s 60ms/step - loss: 0.1757 - acc: 0.9691
Epoch 20/28

16/16 [==============================] - 1s 37ms/step - loss: 0.1577 - acc: 0.9747
Epoch 21/28

16/16 [==============================] - 1s 53ms/step - loss: 0.1562 - acc: 0.9719
Epoch 22/28

16/16 [==============================] - 1s 44ms/step - loss: 0.1493 - acc: 0.9775
Epoch 23/28

16/16 [==============================] - 1s 57ms/step - loss: 0.1432 - acc: 0.9719
Epoch 24/28

16/16 [==============================] - 1s 37ms/step - loss: 0.1341 - acc: 0.9775
Epoch 25/28

16/16 [==============================] - 1s 63ms/step - loss: 0.1165 - acc: 0.9860
Epoch 26/28

16/16 [==============================] - 1s 40ms/step - loss: 0.1219 - acc: 0.9775
Epoch 27/28

16/16 [==============================] - 1s 50ms/step - loss: 0.1176 - acc: 0.9803
Epoch 28/28

16/16 [==============================] - 1s 37ms/step - loss: 0.1002 - acc: 0.9831
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7223
False 1553
True percentage 0.823040109389
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.91      0.95      0.93      7318
      B-PER       0.54      0.23      0.33       438
      B-ORG       0.26      0.34      0.30       296
      I-ORG       0.14      0.22      0.17       151
      I-PER       0.60      0.15      0.24       214
      B-LOC       0.00      0.00      0.00       218
     B-MISC       0.00      0.00      0.00       141

avg / total       0.81      0.82      0.81      8776

F-1 Score (without O):
0.232034632035
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104046 unique words.
4042 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659008     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,138
Trainable params: 6,771,138
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 7s 440ms/step - loss: 2.3452 - acc: 0.0471
Epoch 2/28

16/16 [==============================] - 1s 38ms/step - loss: 0.7749 - acc: 0.8265
Epoch 3/28

16/16 [==============================] - 1s 55ms/step - loss: 0.5773 - acc: 0.8265
Epoch 4/28

16/16 [==============================] - 1s 41ms/step - loss: 0.5375 - acc: 0.8794
Epoch 5/28

16/16 [==============================] - 1s 57ms/step - loss: 0.6670 - acc: 0.8265
Epoch 6/28

16/16 [==============================] - 1s 44ms/step - loss: 0.4678 - acc: 0.8765
Epoch 7/28

16/16 [==============================] - 1s 53ms/step - loss: 0.3936 - acc: 0.8706
Epoch 8/28

16/16 [==============================] - 1s 44ms/step - loss: 0.3594 - acc: 0.8971
Epoch 9/28

16/16 [==============================] - 1s 61ms/step - loss: 0.3454 - acc: 0.8853
Epoch 10/28

16/16 [==============================] - 1s 41ms/step - loss: 0.3144 - acc: 0.9206
Epoch 11/28

16/16 [==============================] - 1s 54ms/step - loss: 0.3019 - acc: 0.8941
Epoch 12/28

16/16 [==============================] - 1s 41ms/step - loss: 0.2737 - acc: 0.9265
Epoch 13/28

16/16 [==============================] - 1s 53ms/step - loss: 0.2479 - acc: 0.9471
Epoch 14/28

16/16 [==============================] - 1s 41ms/step - loss: 0.2409 - acc: 0.9324
Epoch 15/28

16/16 [==============================] - 1s 49ms/step - loss: 0.2345 - acc: 0.9324
Epoch 16/28

16/16 [==============================] - 1s 48ms/step - loss: 0.2228 - acc: 0.9471
Epoch 17/28

16/16 [==============================] - 1s 51ms/step - loss: 0.2010 - acc: 0.9529
Epoch 18/28

16/16 [==============================] - 1s 46ms/step - loss: 0.1840 - acc: 0.9588
Epoch 19/28

16/16 [==============================] - 1s 51ms/step - loss: 0.1859 - acc: 0.9588
Epoch 20/28

16/16 [==============================] - 1s 47ms/step - loss: 0.1631 - acc: 0.9706
Epoch 21/28

16/16 [==============================] - 1s 54ms/step - loss: 0.1590 - acc: 0.9765
Epoch 22/28

16/16 [==============================] - 1s 42ms/step - loss: 0.1463 - acc: 0.9706
Epoch 23/28

16/16 [==============================] - 1s 60ms/step - loss: 0.1372 - acc: 0.9824
Epoch 24/28

16/16 [==============================] - 1s 40ms/step - loss: 0.1394 - acc: 0.9735
Epoch 25/28

16/16 [==============================] - 1s 52ms/step - loss: 0.1322 - acc: 0.9882
Epoch 26/28

16/16 [==============================] - 1s 43ms/step - loss: 0.1185 - acc: 0.9912
Epoch 27/28

16/16 [==============================] - 1s 56ms/step - loss: 0.1167 - acc: 0.9912
Epoch 28/28

16/16 [==============================] - 1s 40ms/step - loss: 0.1158 - acc: 0.9853
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7095
False 1976
True percentage 0.782162936832
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.92      0.93      7318
      B-PER       0.35      0.24      0.29       438
      B-ORG       0.26      0.42      0.32       296
      I-ORG       0.07      0.09      0.08       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      I-PER       0.22      0.36      0.28       214
      B-LOC       0.51      0.15      0.23       218
      I-LOC       0.67      0.01      0.03       141

avg / total       0.82      0.78      0.79      9071

F-1 Score (without O):
0.226968441186
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104060 unique words.
4056 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 567
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659904     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,034
Trainable params: 6,772,034
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 7s 407ms/step - loss: 2.1536 - acc: 0.1924
Epoch 2/28

16/16 [==============================] - 1s 43ms/step - loss: 0.9129 - acc: 0.7601
Epoch 3/28

16/16 [==============================] - 1s 52ms/step - loss: 0.6318 - acc: 0.8171
Epoch 4/28

16/16 [==============================] - 1s 36ms/step - loss: 0.7710 - acc: 0.7625
Epoch 5/28

16/16 [==============================] - 1s 66ms/step - loss: 0.8218 - acc: 0.7933
Epoch 6/28

16/16 [==============================] - 1s 44ms/step - loss: 0.4682 - acc: 0.8765
Epoch 7/28

16/16 [==============================] - 1s 54ms/step - loss: 0.4272 - acc: 0.8955
Epoch 8/28

16/16 [==============================] - 1s 43ms/step - loss: 0.3833 - acc: 0.8979
Epoch 9/28

16/16 [==============================] - 1s 59ms/step - loss: 0.3421 - acc: 0.9311
Epoch 10/28

16/16 [==============================] - 1s 41ms/step - loss: 0.3290 - acc: 0.9287
Epoch 11/28

16/16 [==============================] - 1s 56ms/step - loss: 0.2942 - acc: 0.9406
Epoch 12/28

16/16 [==============================] - 1s 56ms/step - loss: 0.2826 - acc: 0.9430
Epoch 13/28

16/16 [==============================] - 1s 43ms/step - loss: 0.2521 - acc: 0.9406
Epoch 14/28

16/16 [==============================] - 1s 50ms/step - loss: 0.2386 - acc: 0.9596
Epoch 15/28

16/16 [==============================] - 1s 42ms/step - loss: 0.2251 - acc: 0.9501
Epoch 16/28

16/16 [==============================] - 1s 58ms/step - loss: 0.2165 - acc: 0.9620
Epoch 17/28

16/16 [==============================] - 1s 41ms/step - loss: 0.1976 - acc: 0.9620
Epoch 18/28

16/16 [==============================] - 1s 51ms/step - loss: 0.1682 - acc: 0.9691
Epoch 19/28

16/16 [==============================] - 1s 41ms/step - loss: 0.1671 - acc: 0.9762
Epoch 20/28

16/16 [==============================] - 1s 57ms/step - loss: 0.1801 - acc: 0.9739
Epoch 21/28

16/16 [==============================] - 1s 38ms/step - loss: 0.1493 - acc: 0.9762
Epoch 22/28

16/16 [==============================] - 1s 54ms/step - loss: 0.1389 - acc: 0.9739
Epoch 23/28

16/16 [==============================] - 1s 46ms/step - loss: 0.1229 - acc: 0.9834
Epoch 24/28

16/16 [==============================] - 1s 51ms/step - loss: 0.1228 - acc: 0.9905
Epoch 25/28

16/16 [==============================] - 1s 43ms/step - loss: 0.1115 - acc: 0.9834
Epoch 26/28

16/16 [==============================] - 1s 56ms/step - loss: 0.1068 - acc: 0.9881
Epoch 27/28

16/16 [==============================] - 1s 40ms/step - loss: 0.1069 - acc: 0.9881
Epoch 28/28

16/16 [==============================] - 1s 55ms/step - loss: 0.0941 - acc: 0.9905
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7339
False 1732
True percentage 0.809061845442
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.94      0.94      7318
      B-ORG       0.37      0.36      0.37       296
      B-PER       0.44      0.30      0.36       438
      I-PER       0.46      0.29      0.36       214
      B-LOC       0.50      0.42      0.45       218
      I-LOC       0.65      0.12      0.20       141
      I-ORG       0.14      0.21      0.17       151
     B-MISC       0.20      0.01      0.01       141
     I-MISC       0.18      0.01      0.02       154

avg / total       0.83      0.81      0.82      9071

F-1 Score (without O):
0.303133514986
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104057 unique words.
4053 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 281
OOV word occurences: in test 492
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659712     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,842
Trainable params: 6,771,842
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 7s 409ms/step - loss: 2.3169 - acc: 0.0904
Epoch 2/28

16/16 [==============================] - 1s 44ms/step - loss: 0.8922 - acc: 0.7890
Epoch 3/28

16/16 [==============================] - 1s 55ms/step - loss: 0.6697 - acc: 0.8247
Epoch 4/28

16/16 [==============================] - 1s 54ms/step - loss: 0.6605 - acc: 0.7918
Epoch 5/28

16/16 [==============================] - 1s 45ms/step - loss: 0.6048 - acc: 0.8685
Epoch 6/28

16/16 [==============================] - 1s 52ms/step - loss: 0.4726 - acc: 0.8438
Epoch 7/28

16/16 [==============================] - 1s 46ms/step - loss: 0.4105 - acc: 0.8932
Epoch 8/28

16/16 [==============================] - 1s 66ms/step - loss: 0.3719 - acc: 0.8795
Epoch 9/28

16/16 [==============================] - 1s 37ms/step - loss: 0.3496 - acc: 0.9068
Epoch 10/28

16/16 [==============================] - 1s 55ms/step - loss: 0.3130 - acc: 0.9342
Epoch 11/28

16/16 [==============================] - 1s 44ms/step - loss: 0.3075 - acc: 0.9260
Epoch 12/28

16/16 [==============================] - 1s 54ms/step - loss: 0.2797 - acc: 0.9233
Epoch 13/28

16/16 [==============================] - 1s 43ms/step - loss: 0.2600 - acc: 0.9534
Epoch 14/28

16/16 [==============================] - 1s 60ms/step - loss: 0.2513 - acc: 0.9452
Epoch 15/28

16/16 [==============================] - 1s 38ms/step - loss: 0.2261 - acc: 0.9671
Epoch 16/28

16/16 [==============================] - 1s 54ms/step - loss: 0.2136 - acc: 0.9644
Epoch 17/28

16/16 [==============================] - 1s 39ms/step - loss: 0.2027 - acc: 0.9644
Epoch 18/28

16/16 [==============================] - 1s 58ms/step - loss: 0.2019 - acc: 0.9671
Epoch 19/28

16/16 [==============================] - 1s 40ms/step - loss: 0.1805 - acc: 0.9671
Epoch 20/28

16/16 [==============================] - 1s 55ms/step - loss: 0.1740 - acc: 0.9753
Epoch 21/28

16/16 [==============================] - 1s 43ms/step - loss: 0.1599 - acc: 0.9781
Epoch 22/28

16/16 [==============================] - 1s 60ms/step - loss: 0.1457 - acc: 0.9863
Epoch 23/28

16/16 [==============================] - 1s 36ms/step - loss: 0.1366 - acc: 0.9836
Epoch 24/28

16/16 [==============================] - 1s 60ms/step - loss: 0.1313 - acc: 0.9890
Epoch 25/28

16/16 [==============================] - 1s 37ms/step - loss: 0.1284 - acc: 0.9890
Epoch 26/28

16/16 [==============================] - 1s 57ms/step - loss: 0.1193 - acc: 0.9890
Epoch 27/28

16/16 [==============================] - 1s 41ms/step - loss: 0.1135 - acc: 0.9918
Epoch 28/28

16/16 [==============================] - 1s 56ms/step - loss: 0.1108 - acc: 0.9890
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7145
False 1926
True percentage 0.787675008268
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.92      0.94      7318
     B-MISC       0.10      0.22      0.13       141
     I-MISC       0.13      0.08      0.10       154
      B-ORG       0.27      0.35      0.31       296
      B-LOC       0.68      0.15      0.24       218
      B-PER       0.74      0.25      0.37       438
      I-PER       0.65      0.17      0.27       214
      I-ORG       0.12      0.38      0.18       151
      I-LOC       0.00      0.00      0.00       141

avg / total       0.86      0.79      0.81      9071

F-1 Score (without O):
0.231744115872
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104046 unique words.
4042 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659008     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,138
Trainable params: 6,771,138
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 6s 404ms/step - loss: 3.1149 - acc: 0.1635
Epoch 2/28

16/16 [==============================] - 1s 52ms/step - loss: 1.4218 - acc: 0.6699
Epoch 3/28

16/16 [==============================] - 1s 39ms/step - loss: 0.7223 - acc: 0.8333
Epoch 4/28

16/16 [==============================] - 1s 65ms/step - loss: 0.6860 - acc: 0.8205
Epoch 5/28

16/16 [==============================] - 1s 40ms/step - loss: 0.7858 - acc: 0.8301
Epoch 6/28

16/16 [==============================] - 1s 57ms/step - loss: 0.4663 - acc: 0.8365
Epoch 7/28

16/16 [==============================] - 1s 35ms/step - loss: 0.4198 - acc: 0.8782
Epoch 8/28

16/16 [==============================] - 1s 56ms/step - loss: 0.3776 - acc: 0.8910
Epoch 9/28

16/16 [==============================] - 1s 36ms/step - loss: 0.3463 - acc: 0.8910
Epoch 10/28

16/16 [==============================] - 1s 50ms/step - loss: 0.3316 - acc: 0.8878
Epoch 11/28

16/16 [==============================] - 1s 39ms/step - loss: 0.3142 - acc: 0.8942
Epoch 12/28

16/16 [==============================] - 1s 57ms/step - loss: 0.2978 - acc: 0.9135
Epoch 13/28

16/16 [==============================] - 1s 42ms/step - loss: 0.2744 - acc: 0.9263
Epoch 14/28

16/16 [==============================] - 1s 51ms/step - loss: 0.2704 - acc: 0.9167
Epoch 15/28

16/16 [==============================] - 1s 44ms/step - loss: 0.2554 - acc: 0.9391
Epoch 16/28

16/16 [==============================] - 1s 59ms/step - loss: 0.2270 - acc: 0.9359
Epoch 17/28

16/16 [==============================] - 1s 40ms/step - loss: 0.2346 - acc: 0.9519
Epoch 18/28

16/16 [==============================] - 1s 54ms/step - loss: 0.2139 - acc: 0.9615
Epoch 19/28

16/16 [==============================] - 1s 41ms/step - loss: 0.1918 - acc: 0.9583
Epoch 20/28

16/16 [==============================] - 1s 55ms/step - loss: 0.1963 - acc: 0.9647
Epoch 21/28

16/16 [==============================] - 1s 44ms/step - loss: 0.1893 - acc: 0.9519
Epoch 22/28

16/16 [==============================] - 1s 53ms/step - loss: 0.1744 - acc: 0.9615
Epoch 23/28

16/16 [==============================] - 1s 38ms/step - loss: 0.1682 - acc: 0.9712
Epoch 24/28

16/16 [==============================] - 1s 52ms/step - loss: 0.1619 - acc: 0.9808
Epoch 25/28

16/16 [==============================] - 1s 41ms/step - loss: 0.1490 - acc: 0.9808
Epoch 26/28

16/16 [==============================] - 1s 53ms/step - loss: 0.1416 - acc: 0.9808
Epoch 27/28

16/16 [==============================] - 1s 43ms/step - loss: 0.1401 - acc: 0.9712
Epoch 28/28

16/16 [==============================] - 1s 50ms/step - loss: 0.1398 - acc: 0.9776
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7228
False 1843
True percentage 0.796825046853
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.56      0.23      0.32       438
      I-PER       0.00      0.00      0.00       214
          O       0.96      0.93      0.94      7318
      B-ORG       0.31      0.45      0.37       296
      B-LOC       0.40      0.40      0.40       218
      I-ORG       0.15      0.43      0.22       151
      I-LOC       0.34      0.36      0.35       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.33      0.03      0.05       154

avg / total       0.83      0.80      0.81      9071

F-1 Score (without O):
0.840683962264
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 6 unique labels.
Found 104044 unique words.
4040 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658880     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 7)        966         bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,566
Trainable params: 6,770,566
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 7s 888ms/step - loss: 2.2726 - acc: 0.0442
Epoch 2/28

8/8 [==============================] - 1s 91ms/step - loss: 0.7786 - acc: 0.8398
Epoch 3/28

8/8 [==============================] - 0s 50ms/step - loss: 0.4730 - acc: 0.8729
Epoch 4/28

8/8 [==============================] - 1s 77ms/step - loss: 0.3286 - acc: 0.8895
Epoch 5/28

8/8 [==============================] - 1s 81ms/step - loss: 0.2505 - acc: 0.9282
Epoch 6/28

8/8 [==============================] - 0s 56ms/step - loss: 0.2021 - acc: 0.9227
Epoch 7/28

8/8 [==============================] - 1s 78ms/step - loss: 0.1818 - acc: 0.9558
Epoch 8/28

8/8 [==============================] - 1s 65ms/step - loss: 0.2375 - acc: 0.9227
Epoch 9/28

8/8 [==============================] - 1s 63ms/step - loss: 0.1986 - acc: 0.9779
Epoch 10/28

8/8 [==============================] - 1s 96ms/step - loss: 0.1127 - acc: 0.9834
Epoch 11/28

8/8 [==============================] - 0s 52ms/step - loss: 0.1112 - acc: 0.9779
Epoch 12/28

8/8 [==============================] - 1s 71ms/step - loss: 0.0926 - acc: 0.9834
Epoch 13/28

8/8 [==============================] - 1s 88ms/step - loss: 0.0881 - acc: 0.9834
Epoch 14/28

8/8 [==============================] - 0s 59ms/step - loss: 0.0804 - acc: 0.9890
Epoch 15/28

8/8 [==============================] - 1s 76ms/step - loss: 0.0666 - acc: 0.9834
Epoch 16/28

8/8 [==============================] - 1s 68ms/step - loss: 0.0675 - acc: 0.9890
Epoch 17/28

8/8 [==============================] - 0s 55ms/step - loss: 0.0567 - acc: 0.9945
Epoch 18/28

8/8 [==============================] - 1s 94ms/step - loss: 0.0568 - acc: 0.9890
Epoch 19/28

8/8 [==============================] - 0s 55ms/step - loss: 0.0516 - acc: 0.9890
Epoch 20/28

8/8 [==============================] - 1s 65ms/step - loss: 0.0451 - acc: 0.9945
Epoch 21/28

8/8 [==============================] - 1s 87ms/step - loss: 0.0451 - acc: 0.9945
Epoch 22/28

8/8 [==============================] - 0s 54ms/step - loss: 0.0399 - acc: 0.9945
Epoch 23/28

8/8 [==============================] - 1s 84ms/step - loss: 0.0377 - acc: 0.9945
Epoch 24/28

8/8 [==============================] - 1s 73ms/step - loss: 0.0317 - acc: 1.0000
Epoch 25/28

8/8 [==============================] - 1s 65ms/step - loss: 0.0376 - acc: 1.0000
Epoch 26/28

8/8 [==============================] - 1s 85ms/step - loss: 0.0322 - acc: 1.0000
Epoch 27/28

8/8 [==============================] - 0s 56ms/step - loss: 0.0280 - acc: 1.0000
Epoch 28/28

8/8 [==============================] - 1s 86ms/step - loss: 0.0293 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7098
False 1537
True percentage 0.822003474233
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.92      0.93      7318
      B-PER       0.27      0.38      0.32       438
      B-ORG       0.30      0.30      0.30       296
      I-ORG       0.11      0.07      0.08       151
      I-PER       0.26      0.36      0.30       214
      B-LOC       0.00      0.00      0.00       218

avg / total       0.83      0.82      0.82      8635

F-1 Score (without O):
0.262106072252
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104041 unique words.
4037 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658688     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,818
Trainable params: 6,770,818
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 6s 785ms/step - loss: 2.2297 - acc: 0.0405
Epoch 2/28

8/8 [==============================] - 0s 52ms/step - loss: 0.8591 - acc: 0.8208
Epoch 3/28

8/8 [==============================] - 1s 87ms/step - loss: 0.5832 - acc: 0.8382
Epoch 4/28

8/8 [==============================] - 1s 69ms/step - loss: 0.5167 - acc: 0.8266
Epoch 5/28

8/8 [==============================] - 1s 76ms/step - loss: 0.5411 - acc: 0.8613
Epoch 6/28

8/8 [==============================] - 1s 84ms/step - loss: 0.5595 - acc: 0.8266
Epoch 7/28

8/8 [==============================] - 0s 48ms/step - loss: 0.3771 - acc: 0.8902
Epoch 8/28

8/8 [==============================] - 1s 92ms/step - loss: 0.3233 - acc: 0.9017
Epoch 9/28

8/8 [==============================] - 1s 67ms/step - loss: 0.2948 - acc: 0.9133
Epoch 10/28

8/8 [==============================] - 1s 67ms/step - loss: 0.2598 - acc: 0.9306
Epoch 11/28

8/8 [==============================] - 1s 87ms/step - loss: 0.2506 - acc: 0.9422
Epoch 12/28

8/8 [==============================] - 0s 53ms/step - loss: 0.2224 - acc: 0.9480
Epoch 13/28

8/8 [==============================] - 1s 69ms/step - loss: 0.2048 - acc: 0.9538
Epoch 14/28

8/8 [==============================] - 1s 81ms/step - loss: 0.1970 - acc: 0.9422
Epoch 15/28

8/8 [==============================] - 0s 50ms/step - loss: 0.1806 - acc: 0.9653
Epoch 16/28

8/8 [==============================] - 1s 79ms/step - loss: 0.1741 - acc: 0.9480
Epoch 17/28

8/8 [==============================] - 1s 72ms/step - loss: 0.1498 - acc: 0.9769
Epoch 18/28

8/8 [==============================] - 0s 62ms/step - loss: 0.1496 - acc: 0.9827
Epoch 19/28

8/8 [==============================] - 1s 88ms/step - loss: 0.1370 - acc: 0.9827
Epoch 20/28

8/8 [==============================] - 0s 50ms/step - loss: 0.1285 - acc: 1.0000
Epoch 21/28

8/8 [==============================] - 1s 75ms/step - loss: 0.1203 - acc: 0.9884
Epoch 22/28

8/8 [==============================] - 1s 88ms/step - loss: 0.1178 - acc: 0.9942
Epoch 23/28

8/8 [==============================] - 0s 56ms/step - loss: 0.0987 - acc: 0.9884
Epoch 24/28

8/8 [==============================] - 1s 85ms/step - loss: 0.0971 - acc: 1.0000
Epoch 25/28

8/8 [==============================] - 0s 61ms/step - loss: 0.0925 - acc: 1.0000
Epoch 26/28

8/8 [==============================] - 1s 92ms/step - loss: 0.0838 - acc: 1.0000
Epoch 27/28

8/8 [==============================] - 1s 78ms/step - loss: 0.0860 - acc: 0.9942
Epoch 28/28

8/8 [==============================] - 0s 55ms/step - loss: 0.0705 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7090
False 1981
True percentage 0.781611729688
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.92      0.93      0.92      7318
      B-PER       0.29      0.26      0.28       438
      B-ORG       0.30      0.34      0.32       296
      I-ORG       0.00      0.00      0.00       151
     B-MISC       0.14      0.09      0.11       141
     I-MISC       0.19      0.06      0.09       154
      I-PER       0.21      0.15      0.17       214
      B-LOC       0.27      0.06      0.10       218
      I-LOC       1.00      0.02      0.04       141

avg / total       0.80      0.78      0.78      9071

F-1 Score (without O):
0.202612072008
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104044 unique words.
4040 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 567
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658880     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,010
Trainable params: 6,771,010
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 6s 768ms/step - loss: 2.8863 - acc: 0.0608
Epoch 2/28

8/8 [==============================] - 1s 83ms/step - loss: 1.5212 - acc: 0.6077
Epoch 3/28

8/8 [==============================] - 0s 55ms/step - loss: 0.8821 - acc: 0.7735
Epoch 4/28

8/8 [==============================] - 1s 75ms/step - loss: 0.7323 - acc: 0.7680
Epoch 5/28

8/8 [==============================] - 1s 87ms/step - loss: 0.9050 - acc: 0.8066
Epoch 6/28

8/8 [==============================] - 0s 53ms/step - loss: 0.4865 - acc: 0.8785
Epoch 7/28

8/8 [==============================] - 1s 72ms/step - loss: 0.4618 - acc: 0.9061
Epoch 8/28

8/8 [==============================] - 1s 89ms/step - loss: 0.3964 - acc: 0.9061
Epoch 9/28

8/8 [==============================] - 0s 49ms/step - loss: 0.3398 - acc: 0.9503
Epoch 10/28

8/8 [==============================] - 1s 84ms/step - loss: 0.3209 - acc: 0.9448
Epoch 11/28

8/8 [==============================] - 1s 69ms/step - loss: 0.2969 - acc: 0.9392
Epoch 12/28

8/8 [==============================] - 0s 56ms/step - loss: 0.2543 - acc: 0.9613
Epoch 13/28

8/8 [==============================] - 1s 89ms/step - loss: 0.2197 - acc: 0.9669
Epoch 14/28

8/8 [==============================] - 0s 51ms/step - loss: 0.2054 - acc: 0.9834
Epoch 15/28

8/8 [==============================] - 0s 62ms/step - loss: 0.2027 - acc: 0.9724
Epoch 16/28

8/8 [==============================] - 1s 92ms/step - loss: 0.1875 - acc: 0.9779
Epoch 17/28

8/8 [==============================] - 0s 52ms/step - loss: 0.1582 - acc: 0.9834
Epoch 18/28

8/8 [==============================] - 1s 82ms/step - loss: 0.1548 - acc: 0.9779
Epoch 19/28

8/8 [==============================] - 1s 78ms/step - loss: 0.1479 - acc: 0.9890
Epoch 20/28

8/8 [==============================] - 0s 53ms/step - loss: 0.1289 - acc: 0.9890
Epoch 21/28

8/8 [==============================] - 1s 80ms/step - loss: 0.1148 - acc: 0.9945
Epoch 22/28

8/8 [==============================] - 1s 67ms/step - loss: 0.1100 - acc: 0.9945
Epoch 23/28

8/8 [==============================] - 0s 56ms/step - loss: 0.0976 - acc: 0.9945
Epoch 24/28

8/8 [==============================] - 1s 84ms/step - loss: 0.1023 - acc: 0.9945
Epoch 25/28

8/8 [==============================] - 1s 71ms/step - loss: 0.0909 - acc: 1.0000
Epoch 26/28

8/8 [==============================] - 1s 65ms/step - loss: 0.0927 - acc: 1.0000
Epoch 27/28

8/8 [==============================] - 1s 89ms/step - loss: 0.0787 - acc: 1.0000
Epoch 28/28

8/8 [==============================] - 0s 47ms/step - loss: 0.0728 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7292
False 1779
True percentage 0.803880498291
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.94      0.94      7318
      B-ORG       0.43      0.31      0.36       296
      B-PER       0.41      0.37      0.39       438
      I-PER       0.33      0.25      0.29       214
      B-LOC       0.33      0.36      0.34       218
      I-LOC       0.12      0.01      0.01       141
      I-ORG       0.13      0.11      0.12       151
     B-MISC       0.36      0.06      0.10       141
     I-MISC       0.27      0.03      0.05       154

avg / total       0.82      0.80      0.81      9071

F-1 Score (without O):
0.285034013605
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 8 unique labels.
Found 104049 unique words.
4045 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 500
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659200     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,180
Trainable params: 6,771,180
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 7s 834ms/step - loss: 1.7932 - acc: 0.3587
Epoch 2/28

8/8 [==============================] - 1s 81ms/step - loss: 0.6785 - acc: 0.8261
Epoch 3/28

8/8 [==============================] - 1s 69ms/step - loss: 0.4782 - acc: 0.8641
Epoch 4/28

8/8 [==============================] - 1s 71ms/step - loss: 0.4436 - acc: 0.8641
Epoch 5/28

8/8 [==============================] - 1s 101ms/step - loss: 0.5292 - acc: 0.9022
Epoch 6/28

8/8 [==============================] - 0s 54ms/step - loss: 0.3098 - acc: 0.8804
Epoch 7/28

8/8 [==============================] - 1s 85ms/step - loss: 0.2627 - acc: 0.9130
Epoch 8/28

8/8 [==============================] - 1s 72ms/step - loss: 0.2312 - acc: 0.9511
Epoch 9/28

8/8 [==============================] - 1s 64ms/step - loss: 0.2030 - acc: 0.9457
Epoch 10/28

8/8 [==============================] - 1s 89ms/step - loss: 0.1878 - acc: 0.9674
Epoch 11/28

8/8 [==============================] - 0s 47ms/step - loss: 0.1839 - acc: 0.9565
Epoch 12/28

8/8 [==============================] - 1s 65ms/step - loss: 0.1516 - acc: 0.9783
Epoch 13/28

8/8 [==============================] - 1s 97ms/step - loss: 0.1404 - acc: 0.9783
Epoch 14/28

8/8 [==============================] - 0s 52ms/step - loss: 0.1347 - acc: 0.9891
Epoch 15/28

8/8 [==============================] - 1s 90ms/step - loss: 0.1270 - acc: 0.9783
Epoch 16/28

8/8 [==============================] - 1s 67ms/step - loss: 0.1233 - acc: 0.9837
Epoch 17/28

8/8 [==============================] - 1s 64ms/step - loss: 0.1015 - acc: 0.9946
Epoch 18/28

8/8 [==============================] - 1s 84ms/step - loss: 0.0953 - acc: 0.9946
Epoch 19/28

8/8 [==============================] - 0s 53ms/step - loss: 0.0907 - acc: 0.9891
Epoch 20/28

8/8 [==============================] - 1s 76ms/step - loss: 0.0820 - acc: 0.9891
Epoch 21/28

8/8 [==============================] - 1s 83ms/step - loss: 0.0767 - acc: 0.9946
Epoch 22/28

8/8 [==============================] - 0s 51ms/step - loss: 0.0645 - acc: 0.9946
Epoch 23/28

8/8 [==============================] - 1s 79ms/step - loss: 0.0578 - acc: 0.9946
Epoch 24/28

8/8 [==============================] - 1s 66ms/step - loss: 0.0594 - acc: 1.0000
Epoch 25/28

8/8 [==============================] - 0s 61ms/step - loss: 0.0578 - acc: 0.9946
Epoch 26/28

8/8 [==============================] - 1s 77ms/step - loss: 0.0562 - acc: 1.0000
Epoch 27/28

8/8 [==============================] - 0s 50ms/step - loss: 0.0535 - acc: 1.0000
Epoch 28/28

8/8 [==============================] - 1s 69ms/step - loss: 0.0505 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7016
False 1914
True percentage 0.785666293393
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.92      0.94      7318
     B-MISC       0.13      0.16      0.14       141
     I-MISC       0.12      0.05      0.07       154
      B-ORG       0.17      0.30      0.21       296
      B-LOC       0.00      0.00      0.00       218
      B-PER       0.68      0.23      0.34       438
      I-PER       0.00      0.00      0.00       214
      I-ORG       0.10      0.37      0.15       151

avg / total       0.83      0.79      0.80      8930

F-1 Score (without O):
0.176753121998
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104039 unique words.
4035 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658560     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,690
Trainable params: 6,770,690
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 7s 819ms/step - loss: 2.4617 - acc: 0.0253
Epoch 2/28

8/8 [==============================] - 1s 89ms/step - loss: 0.9730 - acc: 0.8165
Epoch 3/28

8/8 [==============================] - 0s 61ms/step - loss: 0.6163 - acc: 0.8291
Epoch 4/28

8/8 [==============================] - 0s 55ms/step - loss: 0.5216 - acc: 0.8671
Epoch 5/28

8/8 [==============================] - 1s 83ms/step - loss: 0.4368 - acc: 0.8418
Epoch 6/28

8/8 [==============================] - 0s 54ms/step - loss: 0.4042 - acc: 0.9114
Epoch 7/28

8/8 [==============================] - 0s 62ms/step - loss: 0.3455 - acc: 0.8797
Epoch 8/28

8/8 [==============================] - 1s 85ms/step - loss: 0.2780 - acc: 0.9430
Epoch 9/28

8/8 [==============================] - 0s 49ms/step - loss: 0.2559 - acc: 0.9430
Epoch 10/28

8/8 [==============================] - 1s 71ms/step - loss: 0.2351 - acc: 0.9494
Epoch 11/28

8/8 [==============================] - 1s 81ms/step - loss: 0.2087 - acc: 0.9557
Epoch 12/28

8/8 [==============================] - 0s 54ms/step - loss: 0.2041 - acc: 0.9620
Epoch 13/28

8/8 [==============================] - 1s 88ms/step - loss: 0.1671 - acc: 0.9810
Epoch 14/28

8/8 [==============================] - 1s 67ms/step - loss: 0.1546 - acc: 0.9684
Epoch 15/28

8/8 [==============================] - 1s 65ms/step - loss: 0.1484 - acc: 0.9810
Epoch 16/28

8/8 [==============================] - 1s 91ms/step - loss: 0.1405 - acc: 0.9684
Epoch 17/28

8/8 [==============================] - 0s 51ms/step - loss: 0.1256 - acc: 0.9747
Epoch 18/28

8/8 [==============================] - 1s 70ms/step - loss: 0.1276 - acc: 0.9747
Epoch 19/28

8/8 [==============================] - 1s 85ms/step - loss: 0.0929 - acc: 0.9873
Epoch 20/28

8/8 [==============================] - 0s 45ms/step - loss: 0.1011 - acc: 0.9873
Epoch 21/28

8/8 [==============================] - 1s 94ms/step - loss: 0.0927 - acc: 0.9937
Epoch 22/28

8/8 [==============================] - 1s 67ms/step - loss: 0.0888 - acc: 0.9873
Epoch 23/28

8/8 [==============================] - 0s 52ms/step - loss: 0.0866 - acc: 0.9873
Epoch 24/28

8/8 [==============================] - 1s 80ms/step - loss: 0.0743 - acc: 0.9937
Epoch 25/28

8/8 [==============================] - 1s 65ms/step - loss: 0.0620 - acc: 1.0000
Epoch 26/28

8/8 [==============================] - 1s 64ms/step - loss: 0.0739 - acc: 0.9937
Epoch 27/28

8/8 [==============================] - 1s 93ms/step - loss: 0.0685 - acc: 1.0000
Epoch 28/28

8/8 [==============================] - 0s 46ms/step - loss: 0.0497 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7044
False 2027
True percentage 0.776540623966
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.53      0.13      0.21       438
      I-PER       0.00      0.00      0.00       214
          O       0.92      0.93      0.93      7318
      B-ORG       0.23      0.43      0.30       296
      B-LOC       0.20      0.03      0.06       218
      I-ORG       0.13      0.36      0.19       151
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.79      0.78      0.77      9071

F-1 Score (without O):
0.820579080284
