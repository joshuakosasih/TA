Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.4110 - acc: 0.8766
Epoch 2/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.2296 - acc: 0.9313
Epoch 3/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1849 - acc: 0.9454
Epoch 4/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1521 - acc: 0.9553
Epoch 5/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1298 - acc: 0.9617
Epoch 6/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1126 - acc: 0.9677
Epoch 7/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0998 - acc: 0.9708
Epoch 8/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0881 - acc: 0.9747
Epoch 9/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0811 - acc: 0.9768
Epoch 10/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0743 - acc: 0.9786
Epoch 11/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0676 - acc: 0.9806
Epoch 12/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0600 - acc: 0.9833
Epoch 13/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0577 - acc: 0.9839
Epoch 14/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0535 - acc: 0.9854
Epoch 15/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0498 - acc: 0.9864
Epoch 16/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0471 - acc: 0.9864
Epoch 17/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0441 - acc: 0.9883
Epoch 18/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0437 - acc: 0.9876
Epoch 19/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0398 - acc: 0.9885
Epoch 20/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0382 - acc: 0.9891
Epoch 21/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0360 - acc: 0.9899
Epoch 22/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0347 - acc: 0.9898
Epoch 23/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0328 - acc: 0.9910
Epoch 24/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0314 - acc: 0.9909
Epoch 25/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0289 - acc: 0.9925
Epoch 26/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0283 - acc: 0.9918
Epoch 27/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0279 - acc: 0.9923
Epoch 28/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0278 - acc: 0.9921
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8246
False 825
True percentage 0.909050821299
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.90      0.83      0.86       438
      B-ORG       0.75      0.74      0.75       296
      I-ORG       0.64      0.60      0.62       151
      I-PER       0.88      0.65      0.75       214
      B-LOC       0.74      0.75      0.75       218
     B-MISC       0.43      0.30      0.35       141
      I-LOC       0.73      0.79      0.76       141
     I-MISC       0.55      0.42      0.48       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.71655193056
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.4212 - acc: 0.8704
Epoch 2/28

1674/1674 [==============================] - 43s 25ms/step - loss: 0.2402 - acc: 0.9271
Epoch 3/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1918 - acc: 0.9427
Epoch 4/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1574 - acc: 0.9534
Epoch 5/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1353 - acc: 0.9606
Epoch 6/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1175 - acc: 0.9660
Epoch 7/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1055 - acc: 0.9694
Epoch 8/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0934 - acc: 0.9728
Epoch 9/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0847 - acc: 0.9765
Epoch 10/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0757 - acc: 0.9781
Epoch 11/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0712 - acc: 0.9797
Epoch 12/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0655 - acc: 0.9816
Epoch 13/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0636 - acc: 0.9820
Epoch 14/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0570 - acc: 0.9835
Epoch 15/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0533 - acc: 0.9855
Epoch 16/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0508 - acc: 0.9860
Epoch 17/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0464 - acc: 0.9875
Epoch 18/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0458 - acc: 0.9873
Epoch 19/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0423 - acc: 0.9882
Epoch 20/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0401 - acc: 0.9890
Epoch 21/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0403 - acc: 0.9884
Epoch 22/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0362 - acc: 0.9901
Epoch 23/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0339 - acc: 0.9908
Epoch 24/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0336 - acc: 0.9904
Epoch 25/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0333 - acc: 0.9909
Epoch 26/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0318 - acc: 0.9911
Epoch 27/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0297 - acc: 0.9916
Epoch 28/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0281 - acc: 0.9927
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8234
False 837
True percentage 0.907727924154
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.72      0.73      0.73       296
      I-ORG       0.61      0.63      0.62       151
      B-PER       0.91      0.83      0.87       438
      B-LOC       0.76      0.75      0.75       218
      I-LOC       0.76      0.72      0.74       141
      I-PER       0.90      0.65      0.76       214
     B-MISC       0.43      0.30      0.36       141
     I-MISC       0.53      0.40      0.45       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.71089762834
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.4301 - acc: 0.8687
Epoch 2/28

1674/1674 [==============================] - 43s 25ms/step - loss: 0.2461 - acc: 0.9239
Epoch 3/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1963 - acc: 0.9405
Epoch 4/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1654 - acc: 0.9504
Epoch 5/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1397 - acc: 0.9584
Epoch 6/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1223 - acc: 0.9654
Epoch 7/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1071 - acc: 0.9687
Epoch 8/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0984 - acc: 0.9725
Epoch 9/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0865 - acc: 0.9756
Epoch 10/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0812 - acc: 0.9775
Epoch 11/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0729 - acc: 0.9795
Epoch 12/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0657 - acc: 0.9822
Epoch 13/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0633 - acc: 0.9821
Epoch 14/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0571 - acc: 0.9847
Epoch 15/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0536 - acc: 0.9856
Epoch 16/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0499 - acc: 0.9861
Epoch 17/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0489 - acc: 0.9858
Epoch 18/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0463 - acc: 0.9871
Epoch 19/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0418 - acc: 0.9889
Epoch 20/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0418 - acc: 0.9881
Epoch 21/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0387 - acc: 0.9890
Epoch 22/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0361 - acc: 0.9901
Epoch 23/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0355 - acc: 0.9903
Epoch 24/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0344 - acc: 0.9901
Epoch 25/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0321 - acc: 0.9907
Epoch 26/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0305 - acc: 0.9914
Epoch 27/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0293 - acc: 0.9917
Epoch 28/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0285 - acc: 0.9922
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8244
False 827
True percentage 0.908830338441
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.91      0.83      0.87       438
      B-ORG       0.76      0.75      0.75       296
      I-ORG       0.63      0.59      0.61       151
     B-MISC       0.44      0.30      0.36       141
     I-MISC       0.55      0.40      0.47       154
      I-PER       0.87      0.65      0.75       214
      B-LOC       0.73      0.72      0.73       218
      I-LOC       0.74      0.79      0.76       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.714972940469
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.4285 - acc: 0.8701
Epoch 2/28

1674/1674 [==============================] - 43s 26ms/step - loss: 0.2471 - acc: 0.9253
Epoch 3/28

1674/1674 [==============================] - 43s 25ms/step - loss: 0.1920 - acc: 0.9425
Epoch 4/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1605 - acc: 0.9537
Epoch 5/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1380 - acc: 0.9607
Epoch 6/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1194 - acc: 0.9663
Epoch 7/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1065 - acc: 0.9701
Epoch 8/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0965 - acc: 0.9727
Epoch 9/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0858 - acc: 0.9766
Epoch 10/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0797 - acc: 0.9777
Epoch 11/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0715 - acc: 0.9808
Epoch 12/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0670 - acc: 0.9824
Epoch 13/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0632 - acc: 0.9827
Epoch 14/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0574 - acc: 0.9843
Epoch 15/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0534 - acc: 0.9854
Epoch 16/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0519 - acc: 0.9854
Epoch 17/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0484 - acc: 0.9870
Epoch 18/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0455 - acc: 0.9876
Epoch 19/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0439 - acc: 0.9885
Epoch 20/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0407 - acc: 0.9888
Epoch 21/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0400 - acc: 0.9880
Epoch 22/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0364 - acc: 0.9897
Epoch 23/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0364 - acc: 0.9894
Epoch 24/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0358 - acc: 0.9903
Epoch 25/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0328 - acc: 0.9908
Epoch 26/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0310 - acc: 0.9916
Epoch 27/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0295 - acc: 0.9917
Epoch 28/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0298 - acc: 0.9919
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8244
False 827
True percentage 0.908830338441
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.70      0.74      0.72       296
      B-PER       0.90      0.84      0.87       438
      I-PER       0.91      0.67      0.77       214
      B-LOC       0.77      0.74      0.76       218
      I-LOC       0.71      0.78      0.74       141
      I-ORG       0.60      0.66      0.62       151
     B-MISC       0.46      0.28      0.35       141
     I-MISC       0.53      0.36      0.43       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.713816771113
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.3830 - acc: 0.8824
Epoch 2/28

1674/1674 [==============================] - 43s 25ms/step - loss: 0.2272 - acc: 0.9312
Epoch 3/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1770 - acc: 0.9471
Epoch 4/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1501 - acc: 0.9547
Epoch 5/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1276 - acc: 0.9624
Epoch 6/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1128 - acc: 0.9668
Epoch 7/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0987 - acc: 0.9703
Epoch 8/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0889 - acc: 0.9744
Epoch 9/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0801 - acc: 0.9772
Epoch 10/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0732 - acc: 0.9788
Epoch 11/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0671 - acc: 0.9814
Epoch 12/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0632 - acc: 0.9821
Epoch 13/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0604 - acc: 0.9828
Epoch 14/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0570 - acc: 0.9840
Epoch 15/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0529 - acc: 0.9853
Epoch 16/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0477 - acc: 0.9869
Epoch 17/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0447 - acc: 0.9877
Epoch 18/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0431 - acc: 0.9876
Epoch 19/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0395 - acc: 0.9891
Epoch 20/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0391 - acc: 0.9889
Epoch 21/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0352 - acc: 0.9902
Epoch 22/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0357 - acc: 0.9897
Epoch 23/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0317 - acc: 0.9913
Epoch 24/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0326 - acc: 0.9904
Epoch 25/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0313 - acc: 0.9912
Epoch 26/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0306 - acc: 0.9913
Epoch 27/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0280 - acc: 0.9923
Epoch 28/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0278 - acc: 0.9921
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8235
False 836
True percentage 0.907838165583
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.90      0.82      0.86       438
          O       0.98      0.96      0.97      7318
      B-ORG       0.74      0.72      0.73       296
     B-MISC       0.44      0.32      0.37       141
      I-ORG       0.58      0.62      0.60       151
      I-PER       0.84      0.65      0.73       214
     I-MISC       0.55      0.43      0.48       154
      B-LOC       0.76      0.76      0.76       218
      I-LOC       0.76      0.79      0.77       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.927015891701
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 46s 28ms/step - loss: 0.4038 - acc: 0.8771
Epoch 2/28

1674/1674 [==============================] - 43s 25ms/step - loss: 0.2356 - acc: 0.9292
Epoch 3/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1849 - acc: 0.9454
Epoch 4/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1525 - acc: 0.9552
Epoch 5/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1290 - acc: 0.9633
Epoch 6/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1146 - acc: 0.9669
Epoch 7/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1002 - acc: 0.9718
Epoch 8/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0900 - acc: 0.9744
Epoch 9/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0835 - acc: 0.9768
Epoch 10/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0743 - acc: 0.9792
Epoch 11/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0682 - acc: 0.9797
Epoch 12/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0645 - acc: 0.9828
Epoch 13/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0591 - acc: 0.9827
Epoch 14/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0552 - acc: 0.9843
Epoch 15/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0513 - acc: 0.9859
Epoch 16/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0484 - acc: 0.9864
Epoch 17/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0444 - acc: 0.9880
Epoch 18/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0421 - acc: 0.9884
Epoch 19/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0395 - acc: 0.9889
Epoch 20/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0401 - acc: 0.9880
Epoch 21/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0378 - acc: 0.9892
Epoch 22/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0357 - acc: 0.9894
Epoch 23/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0338 - acc: 0.9904
Epoch 24/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0320 - acc: 0.9907
Epoch 25/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0308 - acc: 0.9908
Epoch 26/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0287 - acc: 0.9920
Epoch 27/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0280 - acc: 0.9921
Epoch 28/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0271 - acc: 0.9919
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8259
False 812
True percentage 0.910483959872
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.91      0.82      0.87       438
      B-ORG       0.78      0.73      0.75       296
      I-ORG       0.65      0.63      0.64       151
      B-LOC       0.76      0.76      0.76       218
      I-PER       0.89      0.65      0.75       214
     B-MISC       0.47      0.34      0.39       141
      I-LOC       0.73      0.81      0.77       141
     I-MISC       0.52      0.43      0.47       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.723072307231
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.4417 - acc: 0.8680
Epoch 2/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.2450 - acc: 0.9273
Epoch 3/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1933 - acc: 0.9433
Epoch 4/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1606 - acc: 0.9533
Epoch 5/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1358 - acc: 0.9614
Epoch 6/28

1674/1674 [==============================] - 43s 26ms/step - loss: 0.1189 - acc: 0.9657
Epoch 7/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1039 - acc: 0.9700
Epoch 8/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0962 - acc: 0.9724
Epoch 9/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0882 - acc: 0.9750
Epoch 10/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0770 - acc: 0.9788
Epoch 11/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0725 - acc: 0.9789
Epoch 12/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0664 - acc: 0.9816
Epoch 13/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0623 - acc: 0.9824
Epoch 14/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0571 - acc: 0.9842
Epoch 15/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0536 - acc: 0.9850
Epoch 16/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0518 - acc: 0.9854
Epoch 17/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0469 - acc: 0.9868
Epoch 18/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0444 - acc: 0.9877
Epoch 19/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0410 - acc: 0.9883
Epoch 20/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0407 - acc: 0.9888
Epoch 21/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0388 - acc: 0.9887
Epoch 22/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0370 - acc: 0.9896
Epoch 23/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0352 - acc: 0.9902
Epoch 24/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0330 - acc: 0.9909
Epoch 25/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0319 - acc: 0.9907
Epoch 26/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0319 - acc: 0.9905
Epoch 27/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0291 - acc: 0.9923
Epoch 28/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0284 - acc: 0.9920
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8239
False 832
True percentage 0.908279131298
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.91      0.83      0.87       438
      I-PER       0.89      0.66      0.76       214
      B-ORG       0.71      0.75      0.73       296
      I-ORG       0.58      0.66      0.62       151
      B-LOC       0.76      0.72      0.74       218
     B-MISC       0.46      0.30      0.37       141
     I-MISC       0.54      0.38      0.44       154
      I-LOC       0.78      0.80      0.79       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.716034637205
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.3882 - acc: 0.8831
Epoch 2/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.2257 - acc: 0.9310
Epoch 3/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1802 - acc: 0.9457
Epoch 4/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1503 - acc: 0.9555
Epoch 5/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1312 - acc: 0.9615
Epoch 6/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1152 - acc: 0.9666
Epoch 7/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1017 - acc: 0.9703
Epoch 8/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0896 - acc: 0.9744
Epoch 9/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0817 - acc: 0.9770
Epoch 10/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0742 - acc: 0.9794
Epoch 11/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0676 - acc: 0.9814
Epoch 12/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0631 - acc: 0.9823
Epoch 13/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0593 - acc: 0.9831
Epoch 14/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0552 - acc: 0.9845
Epoch 15/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0524 - acc: 0.9855
Epoch 16/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0485 - acc: 0.9863
Epoch 17/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0449 - acc: 0.9874
Epoch 18/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0414 - acc: 0.9887
Epoch 19/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0399 - acc: 0.9888
Epoch 20/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0390 - acc: 0.9886
Epoch 21/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0357 - acc: 0.9898
Epoch 22/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0356 - acc: 0.9900
Epoch 23/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0326 - acc: 0.9909
Epoch 24/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0317 - acc: 0.9910
Epoch 25/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0310 - acc: 0.9908
Epoch 26/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0285 - acc: 0.9920
Epoch 27/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0282 - acc: 0.9917
Epoch 28/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0277 - acc: 0.9919
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8226
False 845
True percentage 0.906845992724
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
     B-MISC       0.38      0.32      0.35       141
     I-MISC       0.47      0.44      0.45       154
      B-ORG       0.76      0.71      0.73       296
      B-LOC       0.76      0.73      0.75       218
      B-PER       0.90      0.82      0.86       438
      I-PER       0.88      0.65      0.75       214
      I-ORG       0.66      0.58      0.62       151
      I-LOC       0.75      0.78      0.77       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.707360861759
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.3863 - acc: 0.8803
Epoch 2/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.2261 - acc: 0.9314
Epoch 3/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1766 - acc: 0.9476
Epoch 4/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1479 - acc: 0.9571
Epoch 5/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1303 - acc: 0.9615
Epoch 6/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.1135 - acc: 0.9664
Epoch 7/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0996 - acc: 0.9716
Epoch 8/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0896 - acc: 0.9744
Epoch 9/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0807 - acc: 0.9772
Epoch 10/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0754 - acc: 0.9785
Epoch 11/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0685 - acc: 0.9809
Epoch 12/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0649 - acc: 0.9816
Epoch 13/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0576 - acc: 0.9838
Epoch 14/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0561 - acc: 0.9839
Epoch 15/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0513 - acc: 0.9857
Epoch 16/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0481 - acc: 0.9870
Epoch 17/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0462 - acc: 0.9868
Epoch 18/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0422 - acc: 0.9881
Epoch 19/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0426 - acc: 0.9877
Epoch 20/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0405 - acc: 0.9888
Epoch 21/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0373 - acc: 0.9892
Epoch 22/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0356 - acc: 0.9895
Epoch 23/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0350 - acc: 0.9906
Epoch 24/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0315 - acc: 0.9914
Epoch 25/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0308 - acc: 0.9909
Epoch 26/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0297 - acc: 0.9907
Epoch 27/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0268 - acc: 0.9924
Epoch 28/28

1674/1674 [==============================] - 42s 25ms/step - loss: 0.0281 - acc: 0.9917
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8236
False 835
True percentage 0.907948407011
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.90      0.83      0.87       438
      I-PER       0.90      0.65      0.76       214
          O       0.98      0.96      0.97      7318
      B-ORG       0.74      0.73      0.73       296
      B-LOC       0.73      0.71      0.72       218
      I-ORG       0.64      0.62      0.63       151
      I-LOC       0.72      0.81      0.76       141
     B-MISC       0.43      0.35      0.39       141
     I-MISC       0.50      0.43      0.46       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.926826396656
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104767 unique words.
4763 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 244
OOV word occurences: in test 345
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6705152     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,817,282
Trainable params: 6,817,282
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 25s 30ms/step - loss: 0.4754 - acc: 0.8508
Epoch 2/28

837/837 [==============================] - 22s 26ms/step - loss: 0.2846 - acc: 0.9161
Epoch 3/28

837/837 [==============================] - 21s 26ms/step - loss: 0.2231 - acc: 0.9362
Epoch 4/28

837/837 [==============================] - 21s 26ms/step - loss: 0.1880 - acc: 0.9460
Epoch 5/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1609 - acc: 0.9538
Epoch 6/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1406 - acc: 0.9604
Epoch 7/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1239 - acc: 0.9647
Epoch 8/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1123 - acc: 0.9678
Epoch 9/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0991 - acc: 0.9717
Epoch 10/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0895 - acc: 0.9757
Epoch 11/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0808 - acc: 0.9785
Epoch 12/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0735 - acc: 0.9800
Epoch 13/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0688 - acc: 0.9820
Epoch 14/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0627 - acc: 0.9835
Epoch 15/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0580 - acc: 0.9855
Epoch 16/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0525 - acc: 0.9860
Epoch 17/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0501 - acc: 0.9872
Epoch 18/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0465 - acc: 0.9878
Epoch 19/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0429 - acc: 0.9893
Epoch 20/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0425 - acc: 0.9896
Epoch 21/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0392 - acc: 0.9901
Epoch 22/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0374 - acc: 0.9911
Epoch 23/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0350 - acc: 0.9918
Epoch 24/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0336 - acc: 0.9916
Epoch 25/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0318 - acc: 0.9921
Epoch 26/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0286 - acc: 0.9937
Epoch 27/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0270 - acc: 0.9932
Epoch 28/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0259 - acc: 0.9947
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8173
False 898
True percentage 0.901003197001
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.89      0.83      0.86       438
      B-ORG       0.70      0.71      0.70       296
      I-ORG       0.56      0.46      0.51       151
      I-PER       0.92      0.62      0.74       214
      B-LOC       0.74      0.72      0.73       218
     B-MISC       0.44      0.30      0.35       141
      I-LOC       0.71      0.72      0.72       141
     I-MISC       0.46      0.42      0.44       154

avg / total       0.93      0.90      0.92      9071

F-1 Score (without O):
0.687386843693
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104743 unique words.
4739 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 244
OOV word occurences: in test 375
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6703616     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,815,746
Trainable params: 6,815,746
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 25s 30ms/step - loss: 0.4903 - acc: 0.8490
Epoch 2/28

837/837 [==============================] - 21s 26ms/step - loss: 0.2911 - acc: 0.9124
Epoch 3/28

837/837 [==============================] - 21s 25ms/step - loss: 0.2285 - acc: 0.9327
Epoch 4/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1878 - acc: 0.9459
Epoch 5/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1628 - acc: 0.9537
Epoch 6/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1401 - acc: 0.9596
Epoch 7/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1229 - acc: 0.9660
Epoch 8/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1107 - acc: 0.9693
Epoch 9/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0995 - acc: 0.9735
Epoch 10/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0887 - acc: 0.9765
Epoch 11/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0795 - acc: 0.9794
Epoch 12/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0730 - acc: 0.9814
Epoch 13/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0656 - acc: 0.9839
Epoch 14/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0593 - acc: 0.9850
Epoch 15/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0572 - acc: 0.9858
Epoch 16/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0524 - acc: 0.9860
Epoch 17/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0473 - acc: 0.9884
Epoch 18/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0447 - acc: 0.9888
Epoch 19/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0413 - acc: 0.9899
Epoch 20/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0390 - acc: 0.9901
Epoch 21/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0375 - acc: 0.9912
Epoch 22/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0352 - acc: 0.9914
Epoch 23/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0326 - acc: 0.9928
Epoch 24/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0308 - acc: 0.9929
Epoch 25/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0304 - acc: 0.9931
Epoch 26/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0287 - acc: 0.9933
Epoch 27/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0287 - acc: 0.9934
Epoch 28/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0259 - acc: 0.9939
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8133
False 938
True percentage 0.896593539852
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.78      0.71      0.74       296
      I-ORG       0.63      0.36      0.46       151
      B-PER       0.87      0.75      0.80       438
      B-LOC       0.73      0.70      0.72       218
      I-LOC       0.76      0.72      0.74       141
      I-PER       0.87      0.61      0.72       214
     B-MISC       0.38      0.31      0.34       141
     I-MISC       0.45      0.54      0.49       154

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.67438318611
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104723 unique words.
4719 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 249
OOV word occurences: in test 356
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6702336     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,814,466
Trainable params: 6,814,466
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 25s 30ms/step - loss: 0.5210 - acc: 0.8422
Epoch 2/28

837/837 [==============================] - 22s 26ms/step - loss: 0.2908 - acc: 0.9140
Epoch 3/28

837/837 [==============================] - 21s 25ms/step - loss: 0.2316 - acc: 0.9321
Epoch 4/28

837/837 [==============================] - 21s 26ms/step - loss: 0.1952 - acc: 0.9432
Epoch 5/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1704 - acc: 0.9509
Epoch 6/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1500 - acc: 0.9559
Epoch 7/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1308 - acc: 0.9642
Epoch 8/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1188 - acc: 0.9672
Epoch 9/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1069 - acc: 0.9709
Epoch 10/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0996 - acc: 0.9727
Epoch 11/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0879 - acc: 0.9769
Epoch 12/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0828 - acc: 0.9772
Epoch 13/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0740 - acc: 0.9809
Epoch 14/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0723 - acc: 0.9809
Epoch 15/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0660 - acc: 0.9828
Epoch 16/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0600 - acc: 0.9843
Epoch 17/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0590 - acc: 0.9841
Epoch 18/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0546 - acc: 0.9853
Epoch 19/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0514 - acc: 0.9870
Epoch 20/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0477 - acc: 0.9868
Epoch 21/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0462 - acc: 0.9873
Epoch 22/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0422 - acc: 0.9891
Epoch 23/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0408 - acc: 0.9898
Epoch 24/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0393 - acc: 0.9895
Epoch 25/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0379 - acc: 0.9898
Epoch 26/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0361 - acc: 0.9904
Epoch 27/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0330 - acc: 0.9920
Epoch 28/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0327 - acc: 0.9920
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8176
False 895
True percentage 0.901333921288
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.90      0.81      0.85       438
      B-ORG       0.69      0.75      0.72       296
      I-ORG       0.50      0.59      0.54       151
     B-MISC       0.50      0.26      0.34       141
     I-MISC       0.53      0.37      0.44       154
      I-PER       0.92      0.64      0.75       214
      B-LOC       0.75      0.72      0.74       218
      I-LOC       0.74      0.77      0.75       141

avg / total       0.94      0.90      0.92      9071

F-1 Score (without O):
0.696642685851
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104715 unique words.
4711 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 248
OOV word occurences: in test 352
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6701824     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,813,954
Trainable params: 6,813,954
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 25s 30ms/step - loss: 0.4852 - acc: 0.8555
Epoch 2/28

837/837 [==============================] - 21s 26ms/step - loss: 0.2811 - acc: 0.9166
Epoch 3/28

837/837 [==============================] - 21s 26ms/step - loss: 0.2241 - acc: 0.9339
Epoch 4/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1862 - acc: 0.9460
Epoch 5/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1614 - acc: 0.9539
Epoch 6/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1413 - acc: 0.9606
Epoch 7/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1268 - acc: 0.9647
Epoch 8/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1089 - acc: 0.9698
Epoch 9/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1007 - acc: 0.9713
Epoch 10/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0877 - acc: 0.9767
Epoch 11/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0824 - acc: 0.9783
Epoch 12/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0729 - acc: 0.9809
Epoch 13/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0713 - acc: 0.9798
Epoch 14/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0629 - acc: 0.9829
Epoch 15/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0579 - acc: 0.9840
Epoch 16/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0555 - acc: 0.9849
Epoch 17/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0510 - acc: 0.9856
Epoch 18/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0478 - acc: 0.9872
Epoch 19/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0451 - acc: 0.9885
Epoch 20/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0414 - acc: 0.9897
Epoch 21/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0415 - acc: 0.9893
Epoch 22/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0372 - acc: 0.9899
Epoch 23/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0365 - acc: 0.9908
Epoch 24/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0347 - acc: 0.9907
Epoch 25/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0320 - acc: 0.9914
Epoch 26/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0303 - acc: 0.9918
Epoch 27/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0284 - acc: 0.9923
Epoch 28/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0265 - acc: 0.9929
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8156
False 915
True percentage 0.899129092713
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.71      0.70      0.71       296
      B-PER       0.88      0.79      0.84       438
      I-PER       0.82      0.64      0.72       214
      B-LOC       0.73      0.71      0.72       218
      I-LOC       0.73      0.77      0.75       141
      I-ORG       0.56      0.55      0.56       151
     B-MISC       0.43      0.25      0.32       141
     I-MISC       0.45      0.38      0.41       154

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.68109407875
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104756 unique words.
4752 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 245
OOV word occurences: in test 380
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6704448     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,816,578
Trainable params: 6,816,578
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 25s 30ms/step - loss: 0.5073 - acc: 0.8448
Epoch 2/28

837/837 [==============================] - 22s 26ms/step - loss: 0.2962 - acc: 0.9116
Epoch 3/28

837/837 [==============================] - 21s 26ms/step - loss: 0.2325 - acc: 0.9316
Epoch 4/28

837/837 [==============================] - 21s 26ms/step - loss: 0.1985 - acc: 0.9416
Epoch 5/28

837/837 [==============================] - 21s 26ms/step - loss: 0.1655 - acc: 0.9527
Epoch 6/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1480 - acc: 0.9579
Epoch 7/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1282 - acc: 0.9635
Epoch 8/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1125 - acc: 0.9700
Epoch 9/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1017 - acc: 0.9736
Epoch 10/28

837/837 [==============================] - 21s 26ms/step - loss: 0.0911 - acc: 0.9759
Epoch 11/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0823 - acc: 0.9783
Epoch 12/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0780 - acc: 0.9799
Epoch 13/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0691 - acc: 0.9821
Epoch 14/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0660 - acc: 0.9829
Epoch 15/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0593 - acc: 0.9849
Epoch 16/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0549 - acc: 0.9865
Epoch 17/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0506 - acc: 0.9877
Epoch 18/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0511 - acc: 0.9866
Epoch 19/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0446 - acc: 0.9889
Epoch 20/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0411 - acc: 0.9899
Epoch 21/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0402 - acc: 0.9897
Epoch 22/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0388 - acc: 0.9900
Epoch 23/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0349 - acc: 0.9908
Epoch 24/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0342 - acc: 0.9921
Epoch 25/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0317 - acc: 0.9922
Epoch 26/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0313 - acc: 0.9914
Epoch 27/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0285 - acc: 0.9934
Epoch 28/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0281 - acc: 0.9929
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8132
False 939
True percentage 0.896483298424
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.90      0.73      0.80       438
          O       0.98      0.96      0.97      7318
      B-ORG       0.71      0.71      0.71       296
     B-MISC       0.41      0.35      0.38       141
      I-ORG       0.66      0.47      0.55       151
      I-PER       0.83      0.60      0.70       214
     I-MISC       0.47      0.50      0.49       154
      B-LOC       0.76      0.74      0.75       218
      I-LOC       0.68      0.79      0.73       141

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.920919269299
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104723 unique words.
4719 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 250
OOV word occurences: in test 355
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6702336     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,814,466
Trainable params: 6,814,466
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 25s 30ms/step - loss: 0.4904 - acc: 0.8498
Epoch 2/28

837/837 [==============================] - 22s 26ms/step - loss: 0.2903 - acc: 0.9125
Epoch 3/28

837/837 [==============================] - 22s 26ms/step - loss: 0.2261 - acc: 0.9344
Epoch 4/28

837/837 [==============================] - 21s 26ms/step - loss: 0.1878 - acc: 0.9451
Epoch 5/28

837/837 [==============================] - 21s 26ms/step - loss: 0.1560 - acc: 0.9568
Epoch 6/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1332 - acc: 0.9646
Epoch 7/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1186 - acc: 0.9680
Epoch 8/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1044 - acc: 0.9728
Epoch 9/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0947 - acc: 0.9746
Epoch 10/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0862 - acc: 0.9778
Epoch 11/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0782 - acc: 0.9797
Epoch 12/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0687 - acc: 0.9828
Epoch 13/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0658 - acc: 0.9827
Epoch 14/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0605 - acc: 0.9842
Epoch 15/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0555 - acc: 0.9866
Epoch 16/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0527 - acc: 0.9870
Epoch 17/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0481 - acc: 0.9876
Epoch 18/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0434 - acc: 0.9886
Epoch 19/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0422 - acc: 0.9892
Epoch 20/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0395 - acc: 0.9900
Epoch 21/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0396 - acc: 0.9893
Epoch 22/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0367 - acc: 0.9901
Epoch 23/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0339 - acc: 0.9912
Epoch 24/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0317 - acc: 0.9923
Epoch 25/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0313 - acc: 0.9910
Epoch 26/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0309 - acc: 0.9925
Epoch 27/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0285 - acc: 0.9931
Epoch 28/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0281 - acc: 0.9927
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8129
False 942
True percentage 0.896152574137
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.89      0.81      0.84       438
      B-ORG       0.74      0.69      0.71       296
      I-ORG       0.54      0.47      0.50       151
      B-LOC       0.69      0.68      0.69       218
      I-PER       0.87      0.63      0.73       214
     B-MISC       0.33      0.19      0.24       141
      I-LOC       0.72      0.74      0.73       141
     I-MISC       0.41      0.34      0.37       154

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.667072428484
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104749 unique words.
4745 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 245
OOV word occurences: in test 358
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6704000     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,816,130
Trainable params: 6,816,130
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 25s 30ms/step - loss: 0.4925 - acc: 0.8470
Epoch 2/28

837/837 [==============================] - 21s 26ms/step - loss: 0.2909 - acc: 0.9092
Epoch 3/28

837/837 [==============================] - 21s 26ms/step - loss: 0.2334 - acc: 0.9294
Epoch 4/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1981 - acc: 0.9419
Epoch 5/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1716 - acc: 0.9503
Epoch 6/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1504 - acc: 0.9582
Epoch 7/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1339 - acc: 0.9626
Epoch 8/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1165 - acc: 0.9699
Epoch 9/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1024 - acc: 0.9729
Epoch 10/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0953 - acc: 0.9759
Epoch 11/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0875 - acc: 0.9780
Epoch 12/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0798 - acc: 0.9793
Epoch 13/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0719 - acc: 0.9821
Epoch 14/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0674 - acc: 0.9828
Epoch 15/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0635 - acc: 0.9836
Epoch 16/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0548 - acc: 0.9864
Epoch 17/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0543 - acc: 0.9863
Epoch 18/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0507 - acc: 0.9870
Epoch 19/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0474 - acc: 0.9884
Epoch 20/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0444 - acc: 0.9892
Epoch 21/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0431 - acc: 0.9896
Epoch 22/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0405 - acc: 0.9907
Epoch 23/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0360 - acc: 0.9915
Epoch 24/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0341 - acc: 0.9912
Epoch 25/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0336 - acc: 0.9916
Epoch 26/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0306 - acc: 0.9925
Epoch 27/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0313 - acc: 0.9919
Epoch 28/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0297 - acc: 0.9921
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8154
False 917
True percentage 0.898908609856
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.87      0.75      0.80       438
      I-PER       0.86      0.63      0.73       214
      B-ORG       0.72      0.71      0.72       296
      I-ORG       0.60      0.64      0.62       151
      B-LOC       0.74      0.71      0.72       218
     B-MISC       0.48      0.32      0.38       141
     I-MISC       0.49      0.42      0.45       154
      I-LOC       0.71      0.67      0.69       141

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.683000604961
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104764 unique words.
4760 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 248
OOV word occurences: in test 387
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6704960     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,817,090
Trainable params: 6,817,090
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 25s 30ms/step - loss: 0.5113 - acc: 0.8446
Epoch 2/28

837/837 [==============================] - 21s 26ms/step - loss: 0.2914 - acc: 0.9115
Epoch 3/28

837/837 [==============================] - 21s 26ms/step - loss: 0.2371 - acc: 0.9308
Epoch 4/28

837/837 [==============================] - 21s 25ms/step - loss: 0.2016 - acc: 0.9398
Epoch 5/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1713 - acc: 0.9507
Epoch 6/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1512 - acc: 0.9560
Epoch 7/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1362 - acc: 0.9619
Epoch 8/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1195 - acc: 0.9667
Epoch 9/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1064 - acc: 0.9723
Epoch 10/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0992 - acc: 0.9732
Epoch 11/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0893 - acc: 0.9754
Epoch 12/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0815 - acc: 0.9780
Epoch 13/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0736 - acc: 0.9812
Epoch 14/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0696 - acc: 0.9823
Epoch 15/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0637 - acc: 0.9837
Epoch 16/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0599 - acc: 0.9848
Epoch 17/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0553 - acc: 0.9853
Epoch 18/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0516 - acc: 0.9867
Epoch 19/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0473 - acc: 0.9894
Epoch 20/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0451 - acc: 0.9891
Epoch 21/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0426 - acc: 0.9891
Epoch 22/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0417 - acc: 0.9895
Epoch 23/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0375 - acc: 0.9911
Epoch 24/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0365 - acc: 0.9908
Epoch 25/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0339 - acc: 0.9910
Epoch 26/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0333 - acc: 0.9915
Epoch 27/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0324 - acc: 0.9918
Epoch 28/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0295 - acc: 0.9930
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8074
False 997
True percentage 0.890089295557
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
     B-MISC       0.37      0.30      0.34       141
     I-MISC       0.43      0.44      0.43       154
      B-ORG       0.67      0.67      0.67       296
      B-LOC       0.75      0.69      0.72       218
      B-PER       0.88      0.69      0.77       438
      I-PER       0.91      0.63      0.74       214
      I-ORG       0.48      0.42      0.45       151
      I-LOC       0.74      0.79      0.76       141

avg / total       0.93      0.89      0.91      9071

F-1 Score (without O):
0.649058894961
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104723 unique words.
4719 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 245
OOV word occurences: in test 385
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6702336     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,814,466
Trainable params: 6,814,466
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 25s 30ms/step - loss: 0.4899 - acc: 0.8485
Epoch 2/28

837/837 [==============================] - 22s 26ms/step - loss: 0.2885 - acc: 0.9153
Epoch 3/28

837/837 [==============================] - 21s 26ms/step - loss: 0.2243 - acc: 0.9347
Epoch 4/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1913 - acc: 0.9439
Epoch 5/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1621 - acc: 0.9529
Epoch 6/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1444 - acc: 0.9582
Epoch 7/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1295 - acc: 0.9636
Epoch 8/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1147 - acc: 0.9691
Epoch 9/28

837/837 [==============================] - 21s 25ms/step - loss: 0.1017 - acc: 0.9733
Epoch 10/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0933 - acc: 0.9752
Epoch 11/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0866 - acc: 0.9769
Epoch 12/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0797 - acc: 0.9795
Epoch 13/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0728 - acc: 0.9817
Epoch 14/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0668 - acc: 0.9830
Epoch 15/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0598 - acc: 0.9856
Epoch 16/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0579 - acc: 0.9858
Epoch 17/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0517 - acc: 0.9882
Epoch 18/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0521 - acc: 0.9862
Epoch 19/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0473 - acc: 0.9888
Epoch 20/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0466 - acc: 0.9881
Epoch 21/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0408 - acc: 0.9897
Epoch 22/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0386 - acc: 0.9907
Epoch 23/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0388 - acc: 0.9907
Epoch 24/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0355 - acc: 0.9914
Epoch 25/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0339 - acc: 0.9917
Epoch 26/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0328 - acc: 0.9916
Epoch 27/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0288 - acc: 0.9934
Epoch 28/28

837/837 [==============================] - 21s 25ms/step - loss: 0.0277 - acc: 0.9934
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8131
False 940
True percentage 0.896373056995
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.88      0.71      0.79       438
      I-PER       0.84      0.66      0.74       214
          O       0.98      0.96      0.97      7318
      B-ORG       0.72      0.74      0.73       296
      B-LOC       0.71      0.69      0.70       218
      I-ORG       0.60      0.54      0.57       151
      I-LOC       0.69      0.82      0.75       141
     B-MISC       0.45      0.35      0.40       141
     I-MISC       0.49      0.43      0.46       154

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.921888816837
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104352 unique words.
4348 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 266
OOV word occurences: in test 428
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678592     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,722
Trainable params: 6,790,722
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 11s 34ms/step - loss: 0.6092 - acc: 0.8086
Epoch 2/28

334/334 [==============================] - 9s 26ms/step - loss: 0.3637 - acc: 0.8916
Epoch 3/28

334/334 [==============================] - 9s 26ms/step - loss: 0.3017 - acc: 0.9111
Epoch 4/28

334/334 [==============================] - 8s 25ms/step - loss: 0.2519 - acc: 0.9257
Epoch 5/28

334/334 [==============================] - 9s 25ms/step - loss: 0.2171 - acc: 0.9381
Epoch 6/28

334/334 [==============================] - 9s 25ms/step - loss: 0.1925 - acc: 0.9472
Epoch 7/28

334/334 [==============================] - 9s 25ms/step - loss: 0.1668 - acc: 0.9563
Epoch 8/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1456 - acc: 0.9619
Epoch 9/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1348 - acc: 0.9651
Epoch 10/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1220 - acc: 0.9709
Epoch 11/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1112 - acc: 0.9738
Epoch 12/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0994 - acc: 0.9768
Epoch 13/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0898 - acc: 0.9802
Epoch 14/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0856 - acc: 0.9812
Epoch 15/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0763 - acc: 0.9829
Epoch 16/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0677 - acc: 0.9873
Epoch 17/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0642 - acc: 0.9866
Epoch 18/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0602 - acc: 0.9877
Epoch 19/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0570 - acc: 0.9878
Epoch 20/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0539 - acc: 0.9885
Epoch 21/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0491 - acc: 0.9908
Epoch 22/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0459 - acc: 0.9905
Epoch 23/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0451 - acc: 0.9898
Epoch 24/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0431 - acc: 0.9908
Epoch 25/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0348 - acc: 0.9934
Epoch 26/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0358 - acc: 0.9936
Epoch 27/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0324 - acc: 0.9943
Epoch 28/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0301 - acc: 0.9948
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8040
False 1031
True percentage 0.88634108698
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.85      0.74      0.79       438
      B-ORG       0.65      0.62      0.64       296
      I-ORG       0.40      0.57      0.47       151
      I-PER       0.85      0.59      0.70       214
      B-LOC       0.71      0.71      0.71       218
     B-MISC       0.54      0.18      0.28       141
      I-LOC       0.68      0.72      0.70       141
     I-MISC       0.65      0.20      0.31       154

avg / total       0.93      0.89      0.90      9071

F-1 Score (without O):
0.637457574823
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104375 unique words.
4371 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 257
OOV word occurences: in test 410
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6680064     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,792,194
Trainable params: 6,792,194
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 12s 34ms/step - loss: 0.6718 - acc: 0.7958
Epoch 2/28

334/334 [==============================] - 9s 26ms/step - loss: 0.3877 - acc: 0.8835
Epoch 3/28

334/334 [==============================] - 9s 26ms/step - loss: 0.3153 - acc: 0.9112
Epoch 4/28

334/334 [==============================] - 9s 26ms/step - loss: 0.2717 - acc: 0.9229
Epoch 5/28

334/334 [==============================] - 8s 25ms/step - loss: 0.2376 - acc: 0.9342
Epoch 6/28

334/334 [==============================] - 8s 25ms/step - loss: 0.2097 - acc: 0.9439
Epoch 7/28

334/334 [==============================] - 9s 26ms/step - loss: 0.1832 - acc: 0.9527
Epoch 8/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1668 - acc: 0.9589
Epoch 9/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1491 - acc: 0.9621
Epoch 10/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1370 - acc: 0.9649
Epoch 11/28

334/334 [==============================] - 9s 25ms/step - loss: 0.1206 - acc: 0.9688
Epoch 12/28

334/334 [==============================] - 9s 26ms/step - loss: 0.1141 - acc: 0.9732
Epoch 13/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1015 - acc: 0.9767
Epoch 14/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0930 - acc: 0.9791
Epoch 15/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0857 - acc: 0.9797
Epoch 16/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0826 - acc: 0.9803
Epoch 17/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0733 - acc: 0.9836
Epoch 18/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0693 - acc: 0.9846
Epoch 19/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0666 - acc: 0.9853
Epoch 20/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0623 - acc: 0.9866
Epoch 21/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0562 - acc: 0.9878
Epoch 22/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0518 - acc: 0.9886
Epoch 23/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0501 - acc: 0.9880
Epoch 24/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0448 - acc: 0.9906
Epoch 25/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0435 - acc: 0.9910
Epoch 26/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0409 - acc: 0.9928
Epoch 27/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0396 - acc: 0.9915
Epoch 28/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0357 - acc: 0.9930
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8008
False 1063
True percentage 0.882813361261
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.96      0.97      7318
      B-ORG       0.70      0.69      0.69       296
      I-ORG       0.47      0.31      0.38       151
      B-PER       0.84      0.64      0.73       438
      B-LOC       0.68      0.62      0.65       218
      I-LOC       0.72      0.67      0.69       141
      I-PER       0.78      0.63      0.70       214
     B-MISC       0.34      0.22      0.27       141
     I-MISC       0.48      0.44      0.46       154

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.620174346202
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104340 unique words.
4336 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 268
OOV word occurences: in test 411
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6677824     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,789,954
Trainable params: 6,789,954
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 12s 35ms/step - loss: 0.7246 - acc: 0.7873
Epoch 2/28

334/334 [==============================] - 9s 26ms/step - loss: 0.3945 - acc: 0.8837
Epoch 3/28

334/334 [==============================] - 9s 26ms/step - loss: 0.3192 - acc: 0.9089
Epoch 4/28

334/334 [==============================] - 9s 26ms/step - loss: 0.2820 - acc: 0.9169
Epoch 5/28

334/334 [==============================] - 9s 26ms/step - loss: 0.2363 - acc: 0.9291
Epoch 6/28

334/334 [==============================] - 9s 25ms/step - loss: 0.2071 - acc: 0.9401
Epoch 7/28

334/334 [==============================] - 9s 26ms/step - loss: 0.1884 - acc: 0.9474
Epoch 8/28

334/334 [==============================] - 9s 26ms/step - loss: 0.1703 - acc: 0.9514
Epoch 9/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1552 - acc: 0.9598
Epoch 10/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1384 - acc: 0.9640
Epoch 11/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1307 - acc: 0.9667
Epoch 12/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1200 - acc: 0.9677
Epoch 13/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1080 - acc: 0.9727
Epoch 14/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0986 - acc: 0.9767
Epoch 15/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0931 - acc: 0.9780
Epoch 16/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0843 - acc: 0.9799
Epoch 17/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0787 - acc: 0.9816
Epoch 18/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0758 - acc: 0.9819
Epoch 19/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0695 - acc: 0.9846
Epoch 20/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0658 - acc: 0.9848
Epoch 21/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0629 - acc: 0.9852
Epoch 22/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0578 - acc: 0.9879
Epoch 23/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0536 - acc: 0.9880
Epoch 24/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0511 - acc: 0.9884
Epoch 25/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0472 - acc: 0.9903
Epoch 26/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0432 - acc: 0.9903
Epoch 27/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0438 - acc: 0.9907
Epoch 28/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0428 - acc: 0.9904
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7999
False 1072
True percentage 0.881821188403
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.97      7318
      B-PER       0.85      0.69      0.76       438
      B-ORG       0.67      0.67      0.67       296
      I-ORG       0.41      0.44      0.42       151
     B-MISC       0.35      0.32      0.33       141
     I-MISC       0.36      0.31      0.33       154
      I-PER       0.89      0.57      0.70       214
      B-LOC       0.73      0.67      0.70       218
      I-LOC       0.70      0.64      0.67       141

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.618844984802
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104355 unique words.
4351 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 262
OOV word occurences: in test 406
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678784     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,914
Trainable params: 6,790,914
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 12s 34ms/step - loss: 0.7443 - acc: 0.7755
Epoch 2/28

334/334 [==============================] - 9s 26ms/step - loss: 0.4253 - acc: 0.8672
Epoch 3/28

334/334 [==============================] - 9s 26ms/step - loss: 0.3555 - acc: 0.8933
Epoch 4/28

334/334 [==============================] - 9s 26ms/step - loss: 0.3041 - acc: 0.9131
Epoch 5/28

334/334 [==============================] - 9s 26ms/step - loss: 0.2668 - acc: 0.9228
Epoch 6/28

334/334 [==============================] - 8s 25ms/step - loss: 0.2359 - acc: 0.9318
Epoch 7/28

334/334 [==============================] - 9s 26ms/step - loss: 0.2120 - acc: 0.9394
Epoch 8/28

334/334 [==============================] - 9s 25ms/step - loss: 0.1866 - acc: 0.9465
Epoch 9/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1670 - acc: 0.9530
Epoch 10/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1562 - acc: 0.9588
Epoch 11/28

334/334 [==============================] - 9s 25ms/step - loss: 0.1384 - acc: 0.9639
Epoch 12/28

334/334 [==============================] - 9s 25ms/step - loss: 0.1257 - acc: 0.9691
Epoch 13/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1154 - acc: 0.9723
Epoch 14/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1060 - acc: 0.9766
Epoch 15/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0986 - acc: 0.9771
Epoch 16/28

334/334 [==============================] - 9s 26ms/step - loss: 0.0903 - acc: 0.9806
Epoch 17/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0837 - acc: 0.9807
Epoch 18/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0782 - acc: 0.9824
Epoch 19/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0686 - acc: 0.9858
Epoch 20/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0661 - acc: 0.9857
Epoch 21/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0629 - acc: 0.9850
Epoch 22/28

334/334 [==============================] - 9s 25ms/step - loss: 0.0607 - acc: 0.9868
Epoch 23/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0537 - acc: 0.9888
Epoch 24/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0520 - acc: 0.9882
Epoch 25/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0485 - acc: 0.9885
Epoch 26/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0468 - acc: 0.9898
Epoch 27/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0433 - acc: 0.9913
Epoch 28/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0430 - acc: 0.9910
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8085
False 986
True percentage 0.891301951273
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.71      0.74      0.73       296
      B-PER       0.88      0.69      0.77       438
      I-PER       0.82      0.58      0.68       214
      B-LOC       0.69      0.68      0.68       218
      I-LOC       0.68      0.76      0.72       141
      I-ORG       0.59      0.60      0.60       151
     B-MISC       0.43      0.25      0.31       141
     I-MISC       0.53      0.33      0.41       154

avg / total       0.93      0.89      0.91      9071

F-1 Score (without O):
0.660741648789
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104358 unique words.
4354 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 261
OOV word occurences: in test 412
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678976     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,791,106
Trainable params: 6,791,106
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 12s 35ms/step - loss: 0.6496 - acc: 0.8079
Epoch 2/28

334/334 [==============================] - 9s 26ms/step - loss: 0.3650 - acc: 0.8872
Epoch 3/28

334/334 [==============================] - 9s 26ms/step - loss: 0.3073 - acc: 0.9069
Epoch 4/28

334/334 [==============================] - 9s 26ms/step - loss: 0.2620 - acc: 0.9183
Epoch 5/28

334/334 [==============================] - 9s 26ms/step - loss: 0.2320 - acc: 0.9297
Epoch 6/28

334/334 [==============================] - 9s 26ms/step - loss: 0.2049 - acc: 0.9396
Epoch 7/28

334/334 [==============================] - 9s 25ms/step - loss: 0.1846 - acc: 0.9444
Epoch 8/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1633 - acc: 0.9560
Epoch 9/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1499 - acc: 0.9606
Epoch 10/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1346 - acc: 0.9646
Epoch 11/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1202 - acc: 0.9699
Epoch 12/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1123 - acc: 0.9711
Epoch 13/28

334/334 [==============================] - 9s 25ms/step - loss: 0.1031 - acc: 0.9751
Epoch 14/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0912 - acc: 0.9787
Epoch 15/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0867 - acc: 0.9782
Epoch 16/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0787 - acc: 0.9834
Epoch 17/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0714 - acc: 0.9840
Epoch 18/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0676 - acc: 0.9847
Epoch 19/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0587 - acc: 0.9881
Epoch 20/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0585 - acc: 0.9863
Epoch 21/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0530 - acc: 0.9885
Epoch 22/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0490 - acc: 0.9896
Epoch 23/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0493 - acc: 0.9887
Epoch 24/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0451 - acc: 0.9903
Epoch 25/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0402 - acc: 0.9918
Epoch 26/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0391 - acc: 0.9920
Epoch 27/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0379 - acc: 0.9931
Epoch 28/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0371 - acc: 0.9930
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7996
False 1075
True percentage 0.881490464116
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.84      0.64      0.73       438
          O       0.98      0.96      0.97      7318
      B-ORG       0.66      0.61      0.64       296
     B-MISC       0.38      0.25      0.30       141
      I-ORG       0.44      0.36      0.40       151
      I-PER       0.77      0.61      0.68       214
     I-MISC       0.39      0.40      0.40       154
      B-LOC       0.74      0.68      0.71       218
      I-LOC       0.71      0.68      0.70       141

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.909959313639
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104363 unique words.
4359 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 266
OOV word occurences: in test 431
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6679296     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,791,426
Trainable params: 6,791,426
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 12s 35ms/step - loss: 0.8183 - acc: 0.7584
Epoch 2/28

334/334 [==============================] - 9s 26ms/step - loss: 0.4592 - acc: 0.8527
Epoch 3/28

334/334 [==============================] - 9s 26ms/step - loss: 0.3818 - acc: 0.8793
Epoch 4/28

334/334 [==============================] - 9s 26ms/step - loss: 0.3265 - acc: 0.9000
Epoch 5/28

334/334 [==============================] - 8s 25ms/step - loss: 0.2859 - acc: 0.9150
Epoch 6/28

334/334 [==============================] - 9s 26ms/step - loss: 0.2578 - acc: 0.9243
Epoch 7/28

334/334 [==============================] - 9s 26ms/step - loss: 0.2274 - acc: 0.9349
Epoch 8/28

334/334 [==============================] - 9s 26ms/step - loss: 0.2091 - acc: 0.9441
Epoch 9/28

334/334 [==============================] - 9s 26ms/step - loss: 0.1836 - acc: 0.9515
Epoch 10/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1734 - acc: 0.9525
Epoch 11/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1537 - acc: 0.9594
Epoch 12/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1413 - acc: 0.9627
Epoch 13/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1268 - acc: 0.9668
Epoch 14/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1159 - acc: 0.9712
Epoch 15/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1079 - acc: 0.9728
Epoch 16/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0969 - acc: 0.9777
Epoch 17/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0921 - acc: 0.9799
Epoch 18/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0846 - acc: 0.9830
Epoch 19/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0780 - acc: 0.9838
Epoch 20/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0738 - acc: 0.9843
Epoch 21/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0677 - acc: 0.9857
Epoch 22/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0637 - acc: 0.9865
Epoch 23/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0628 - acc: 0.9862
Epoch 24/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0551 - acc: 0.9900
Epoch 25/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0534 - acc: 0.9871
Epoch 26/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0532 - acc: 0.9893
Epoch 27/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0474 - acc: 0.9906
Epoch 28/28

334/334 [==============================] - 9s 25ms/step - loss: 0.0441 - acc: 0.9929
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7942
False 1129
True percentage 0.875537426965
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.97      7318
      B-PER       0.81      0.64      0.72       438
      B-ORG       0.60      0.60      0.60       296
      I-ORG       0.45      0.38      0.41       151
      B-LOC       0.67      0.69      0.68       218
      I-PER       0.77      0.59      0.67       214
     B-MISC       0.42      0.21      0.28       141
      I-LOC       0.49      0.76      0.59       141
     I-MISC       0.55      0.21      0.31       154

avg / total       0.91      0.88      0.89      9071

F-1 Score (without O):
0.591229684146
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104353 unique words.
4349 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 264
OOV word occurences: in test 440
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678656     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,786
Trainable params: 6,790,786
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 12s 35ms/step - loss: 0.6827 - acc: 0.7957
Epoch 2/28

334/334 [==============================] - 9s 26ms/step - loss: 0.3797 - acc: 0.8838
Epoch 3/28

334/334 [==============================] - 9s 26ms/step - loss: 0.3074 - acc: 0.9109
Epoch 4/28

334/334 [==============================] - 9s 26ms/step - loss: 0.2593 - acc: 0.9256
Epoch 5/28

334/334 [==============================] - 9s 25ms/step - loss: 0.2272 - acc: 0.9364
Epoch 6/28

334/334 [==============================] - 9s 26ms/step - loss: 0.2026 - acc: 0.9434
Epoch 7/28

334/334 [==============================] - 9s 26ms/step - loss: 0.1813 - acc: 0.9531
Epoch 8/28

334/334 [==============================] - 9s 25ms/step - loss: 0.1663 - acc: 0.9557
Epoch 9/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1481 - acc: 0.9640
Epoch 10/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1307 - acc: 0.9701
Epoch 11/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1188 - acc: 0.9720
Epoch 12/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1094 - acc: 0.9746
Epoch 13/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1019 - acc: 0.9788
Epoch 14/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0920 - acc: 0.9801
Epoch 15/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0843 - acc: 0.9822
Epoch 16/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0749 - acc: 0.9831
Epoch 17/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0692 - acc: 0.9851
Epoch 18/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0631 - acc: 0.9869
Epoch 19/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0612 - acc: 0.9875
Epoch 20/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0580 - acc: 0.9881
Epoch 21/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0526 - acc: 0.9890
Epoch 22/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0507 - acc: 0.9886
Epoch 23/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0476 - acc: 0.9894
Epoch 24/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0436 - acc: 0.9917
Epoch 25/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0407 - acc: 0.9923
Epoch 26/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0393 - acc: 0.9922
Epoch 27/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0378 - acc: 0.9918
Epoch 28/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0354 - acc: 0.9923
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7959
False 1112
True percentage 0.877411531253
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-PER       0.83      0.66      0.73       438
      I-PER       0.84      0.62      0.71       214
      B-ORG       0.60      0.60      0.60       296
      I-ORG       0.45      0.56      0.50       151
      B-LOC       0.70      0.69      0.69       218
     B-MISC       0.42      0.28      0.33       141
     I-MISC       0.47      0.37      0.42       154
      I-LOC       0.68      0.71      0.70       141

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.620440156768
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104348 unique words.
4344 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 262
OOV word occurences: in test 426
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678336     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,466
Trainable params: 6,790,466
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 11s 34ms/step - loss: 0.5907 - acc: 0.8209
Epoch 2/28

334/334 [==============================] - 9s 26ms/step - loss: 0.3500 - acc: 0.8924
Epoch 3/28

334/334 [==============================] - 9s 26ms/step - loss: 0.2833 - acc: 0.9122
Epoch 4/28

334/334 [==============================] - 9s 26ms/step - loss: 0.2537 - acc: 0.9201
Epoch 5/28

334/334 [==============================] - 9s 25ms/step - loss: 0.2093 - acc: 0.9391
Epoch 6/28

334/334 [==============================] - 9s 26ms/step - loss: 0.1921 - acc: 0.9438
Epoch 7/28

334/334 [==============================] - 9s 26ms/step - loss: 0.1709 - acc: 0.9522
Epoch 8/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1456 - acc: 0.9602
Epoch 9/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1336 - acc: 0.9656
Epoch 10/28

334/334 [==============================] - 9s 25ms/step - loss: 0.1204 - acc: 0.9690
Epoch 11/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1092 - acc: 0.9716
Epoch 12/28

334/334 [==============================] - 9s 26ms/step - loss: 0.0982 - acc: 0.9762
Epoch 13/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0880 - acc: 0.9793
Epoch 14/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0834 - acc: 0.9795
Epoch 15/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0776 - acc: 0.9820
Epoch 16/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0708 - acc: 0.9847
Epoch 17/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0668 - acc: 0.9855
Epoch 18/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0611 - acc: 0.9859
Epoch 19/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0574 - acc: 0.9866
Epoch 20/28

334/334 [==============================] - 9s 25ms/step - loss: 0.0522 - acc: 0.9887
Epoch 21/28

334/334 [==============================] - 9s 26ms/step - loss: 0.0482 - acc: 0.9889
Epoch 22/28

334/334 [==============================] - 9s 25ms/step - loss: 0.0455 - acc: 0.9891
Epoch 23/28

334/334 [==============================] - 9s 25ms/step - loss: 0.0412 - acc: 0.9908
Epoch 24/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0410 - acc: 0.9908
Epoch 25/28

334/334 [==============================] - 9s 25ms/step - loss: 0.0381 - acc: 0.9920
Epoch 26/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0352 - acc: 0.9929
Epoch 27/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0355 - acc: 0.9922
Epoch 28/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0324 - acc: 0.9937
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7942
False 1129
True percentage 0.875537426965
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
     B-MISC       0.32      0.21      0.25       141
     I-MISC       0.45      0.28      0.35       154
      B-ORG       0.67      0.62      0.65       296
      B-LOC       0.67      0.70      0.68       218
      B-PER       0.84      0.63      0.72       438
      I-PER       0.91      0.56      0.69       214
      I-ORG       0.36      0.40      0.38       151
      I-LOC       0.57      0.74      0.64       141

avg / total       0.91      0.88      0.89      9071

F-1 Score (without O):
0.59680393362
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104309 unique words.
4305 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 264
OOV word occurences: in test 431
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6675840     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,787,970
Trainable params: 6,787,970
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 12s 35ms/step - loss: 0.6855 - acc: 0.7965
Epoch 2/28

334/334 [==============================] - 9s 26ms/step - loss: 0.3753 - acc: 0.8853
Epoch 3/28

334/334 [==============================] - 9s 26ms/step - loss: 0.3077 - acc: 0.9083
Epoch 4/28

334/334 [==============================] - 9s 26ms/step - loss: 0.2648 - acc: 0.9235
Epoch 5/28

334/334 [==============================] - 9s 26ms/step - loss: 0.2360 - acc: 0.9347
Epoch 6/28

334/334 [==============================] - 9s 26ms/step - loss: 0.2089 - acc: 0.9423
Epoch 7/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1838 - acc: 0.9507
Epoch 8/28

334/334 [==============================] - 9s 25ms/step - loss: 0.1683 - acc: 0.9529
Epoch 9/28

334/334 [==============================] - 9s 25ms/step - loss: 0.1495 - acc: 0.9597
Epoch 10/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1394 - acc: 0.9626
Epoch 11/28

334/334 [==============================] - 9s 25ms/step - loss: 0.1244 - acc: 0.9679
Epoch 12/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1126 - acc: 0.9709
Epoch 13/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1061 - acc: 0.9733
Epoch 14/28

334/334 [==============================] - 8s 25ms/step - loss: 0.1021 - acc: 0.9774
Epoch 15/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0900 - acc: 0.9794
Epoch 16/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0837 - acc: 0.9807
Epoch 17/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0775 - acc: 0.9815
Epoch 18/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0739 - acc: 0.9827
Epoch 19/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0686 - acc: 0.9855
Epoch 20/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0646 - acc: 0.9864
Epoch 21/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0581 - acc: 0.9881
Epoch 22/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0530 - acc: 0.9895
Epoch 23/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0519 - acc: 0.9898
Epoch 24/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0476 - acc: 0.9889
Epoch 25/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0456 - acc: 0.9903
Epoch 26/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0418 - acc: 0.9920
Epoch 27/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0403 - acc: 0.9926
Epoch 28/28

334/334 [==============================] - 8s 25ms/step - loss: 0.0400 - acc: 0.9919
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7946
False 1125
True percentage 0.87597839268
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.82      0.69      0.75       438
      I-PER       0.72      0.61      0.66       214
          O       0.97      0.96      0.96      7318
      B-ORG       0.65      0.67      0.66       296
      B-LOC       0.77      0.63      0.69       218
      I-ORG       0.33      0.41      0.37       151
      I-LOC       0.74      0.55      0.63       141
     B-MISC       0.31      0.16      0.21       141
     I-MISC       0.41      0.16      0.23       154

avg / total       0.91      0.88      0.89      9071

F-1 Score (without O):
0.904283009938
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104194 unique words.
4190 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 275
OOV word occurences: in test 464
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6668480     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,780,610
Trainable params: 6,780,610
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 7s 43ms/step - loss: 0.7846 - acc: 0.7676
Epoch 2/28

167/167 [==============================] - 5s 27ms/step - loss: 0.4358 - acc: 0.8664
Epoch 3/28

167/167 [==============================] - 5s 27ms/step - loss: 0.3570 - acc: 0.8945
Epoch 4/28

167/167 [==============================] - 4s 27ms/step - loss: 0.3075 - acc: 0.9118
Epoch 5/28

167/167 [==============================] - 4s 27ms/step - loss: 0.2715 - acc: 0.9214
Epoch 6/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2399 - acc: 0.9327
Epoch 7/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2212 - acc: 0.9401
Epoch 8/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1976 - acc: 0.9494
Epoch 9/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1870 - acc: 0.9486
Epoch 10/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1673 - acc: 0.9546
Epoch 11/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1506 - acc: 0.9628
Epoch 12/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1393 - acc: 0.9670
Epoch 13/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1288 - acc: 0.9693
Epoch 14/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1208 - acc: 0.9723
Epoch 15/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1094 - acc: 0.9762
Epoch 16/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1025 - acc: 0.9787
Epoch 17/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0950 - acc: 0.9798
Epoch 18/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0875 - acc: 0.9838
Epoch 19/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0814 - acc: 0.9847
Epoch 20/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0778 - acc: 0.9861
Epoch 21/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0737 - acc: 0.9857
Epoch 22/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0650 - acc: 0.9897
Epoch 23/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0617 - acc: 0.9904
Epoch 24/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0579 - acc: 0.9904
Epoch 25/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0556 - acc: 0.9907
Epoch 26/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0511 - acc: 0.9906
Epoch 27/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0517 - acc: 0.9901
Epoch 28/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0484 - acc: 0.9913
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7916
False 1155
True percentage 0.872671149818
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-PER       0.81      0.69      0.75       438
      B-ORG       0.58      0.66      0.61       296
      I-ORG       0.36      0.46      0.40       151
      I-PER       0.77      0.59      0.67       214
      B-LOC       0.80      0.60      0.68       218
     B-MISC       0.46      0.13      0.20       141
      I-LOC       0.77      0.52      0.62       141
     I-MISC       0.51      0.13      0.21       154

avg / total       0.91      0.87      0.89      9071

F-1 Score (without O):
0.592405063291
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104205 unique words.
4201 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 269
OOV word occurences: in test 447
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6669184     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,781,314
Trainable params: 6,781,314
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 7s 42ms/step - loss: 0.8996 - acc: 0.7419
Epoch 2/28

167/167 [==============================] - 5s 27ms/step - loss: 0.4542 - acc: 0.8528
Epoch 3/28

167/167 [==============================] - 5s 27ms/step - loss: 0.3894 - acc: 0.8802
Epoch 4/28

167/167 [==============================] - 4s 26ms/step - loss: 0.3398 - acc: 0.9006
Epoch 5/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2947 - acc: 0.9140
Epoch 6/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2647 - acc: 0.9319
Epoch 7/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2347 - acc: 0.9413
Epoch 8/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2187 - acc: 0.9438
Epoch 9/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1881 - acc: 0.9531
Epoch 10/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1779 - acc: 0.9591
Epoch 11/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1657 - acc: 0.9589
Epoch 12/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1484 - acc: 0.9645
Epoch 13/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1332 - acc: 0.9689
Epoch 14/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1178 - acc: 0.9753
Epoch 15/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1126 - acc: 0.9759
Epoch 16/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1042 - acc: 0.9763
Epoch 17/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0980 - acc: 0.9778
Epoch 18/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0849 - acc: 0.9838
Epoch 19/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0807 - acc: 0.9855
Epoch 20/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0717 - acc: 0.9868
Epoch 21/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0658 - acc: 0.9894
Epoch 22/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0642 - acc: 0.9866
Epoch 23/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0634 - acc: 0.9891
Epoch 24/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0576 - acc: 0.9909
Epoch 25/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0510 - acc: 0.9903
Epoch 26/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0530 - acc: 0.9899
Epoch 27/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0454 - acc: 0.9931
Epoch 28/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0434 - acc: 0.9934
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7816
False 1255
True percentage 0.861647006945
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-ORG       0.58      0.49      0.53       296
      I-ORG       0.32      0.21      0.25       151
      B-PER       0.77      0.61      0.68       438
      B-LOC       0.61      0.57      0.59       218
      I-LOC       0.59      0.53      0.56       141
      I-PER       0.68      0.63      0.65       214
     B-MISC       0.36      0.19      0.25       141
     I-MISC       0.38      0.30      0.33       154

avg / total       0.89      0.86      0.88      9071

F-1 Score (without O):
0.53618628068
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104185 unique words.
4181 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 272
OOV word occurences: in test 428
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6667904     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,780,034
Trainable params: 6,780,034
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 7s 43ms/step - loss: 0.8220 - acc: 0.7515
Epoch 2/28

167/167 [==============================] - 5s 27ms/step - loss: 0.4596 - acc: 0.8534
Epoch 3/28

167/167 [==============================] - 4s 27ms/step - loss: 0.3720 - acc: 0.8930
Epoch 4/28

167/167 [==============================] - 4s 27ms/step - loss: 0.3297 - acc: 0.9029
Epoch 5/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2945 - acc: 0.9170
Epoch 6/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2532 - acc: 0.9285
Epoch 7/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2362 - acc: 0.9354
Epoch 8/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2089 - acc: 0.9457
Epoch 9/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1882 - acc: 0.9503
Epoch 10/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1686 - acc: 0.9597
Epoch 11/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1623 - acc: 0.9591
Epoch 12/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1428 - acc: 0.9664
Epoch 13/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1313 - acc: 0.9692
Epoch 14/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1222 - acc: 0.9716
Epoch 15/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1149 - acc: 0.9764
Epoch 16/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1076 - acc: 0.9797
Epoch 17/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0966 - acc: 0.9792
Epoch 18/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0879 - acc: 0.9831
Epoch 19/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0820 - acc: 0.9846
Epoch 20/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0773 - acc: 0.9864
Epoch 21/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0726 - acc: 0.9882
Epoch 22/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0693 - acc: 0.9878
Epoch 23/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0634 - acc: 0.9896
Epoch 24/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0596 - acc: 0.9908
Epoch 25/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0535 - acc: 0.9920
Epoch 26/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0519 - acc: 0.9916
Epoch 27/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0477 - acc: 0.9935
Epoch 28/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0482 - acc: 0.9945
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7852
False 1219
True percentage 0.865615698379
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-PER       0.84      0.65      0.73       438
      B-ORG       0.61      0.59      0.60       296
      I-ORG       0.30      0.38      0.33       151
     B-MISC       0.26      0.17      0.21       141
     I-MISC       0.20      0.12      0.15       154
      I-PER       0.84      0.56      0.67       214
      B-LOC       0.70      0.65      0.67       218
      I-LOC       0.67      0.40      0.50       141

avg / total       0.90      0.87      0.88      9071

F-1 Score (without O):
0.550815558344
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104214 unique words.
4210 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 271
OOV word occurences: in test 452
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6669760     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,781,890
Trainable params: 6,781,890
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 7s 43ms/step - loss: 0.8328 - acc: 0.7386
Epoch 2/28

167/167 [==============================] - 5s 27ms/step - loss: 0.4719 - acc: 0.8476
Epoch 3/28

167/167 [==============================] - 5s 27ms/step - loss: 0.3883 - acc: 0.8798
Epoch 4/28

167/167 [==============================] - 4s 27ms/step - loss: 0.3434 - acc: 0.8998
Epoch 5/28

167/167 [==============================] - 4s 26ms/step - loss: 0.3044 - acc: 0.9063
Epoch 6/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2722 - acc: 0.9232
Epoch 7/28

167/167 [==============================] - 4s 27ms/step - loss: 0.2534 - acc: 0.9269
Epoch 8/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2255 - acc: 0.9417
Epoch 9/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1997 - acc: 0.9510
Epoch 10/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1848 - acc: 0.9530
Epoch 11/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1654 - acc: 0.9611
Epoch 12/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1497 - acc: 0.9649
Epoch 13/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1322 - acc: 0.9731
Epoch 14/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1292 - acc: 0.9716
Epoch 15/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1148 - acc: 0.9728
Epoch 16/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1038 - acc: 0.9763
Epoch 17/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0979 - acc: 0.9794
Epoch 18/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0889 - acc: 0.9803
Epoch 19/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0832 - acc: 0.9834
Epoch 20/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0774 - acc: 0.9837
Epoch 21/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0724 - acc: 0.9854
Epoch 22/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0697 - acc: 0.9864
Epoch 23/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0602 - acc: 0.9906
Epoch 24/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0588 - acc: 0.9901
Epoch 25/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0554 - acc: 0.9893
Epoch 26/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0520 - acc: 0.9919
Epoch 27/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0507 - acc: 0.9905
Epoch 28/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0461 - acc: 0.9922
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7910
False 1161
True percentage 0.872009701246
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-ORG       0.63      0.64      0.63       296
      B-PER       0.77      0.65      0.70       438
      I-PER       0.70      0.50      0.59       214
      B-LOC       0.68      0.60      0.64       218
      I-LOC       0.70      0.63      0.66       141
      I-ORG       0.45      0.51      0.48       151
     B-MISC       0.29      0.21      0.24       141
     I-MISC       0.45      0.34      0.39       154

avg / total       0.91      0.87      0.89      9071

F-1 Score (without O):
0.583968302347
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104203 unique words.
4199 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 272
OOV word occurences: in test 526
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6669056     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,781,186
Trainable params: 6,781,186
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 8s 45ms/step - loss: 0.7145 - acc: 0.7798
Epoch 2/28

167/167 [==============================] - 5s 27ms/step - loss: 0.3927 - acc: 0.8822
Epoch 3/28

167/167 [==============================] - 5s 27ms/step - loss: 0.3213 - acc: 0.8966
Epoch 4/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2818 - acc: 0.9159
Epoch 5/28

167/167 [==============================] - 4s 27ms/step - loss: 0.2445 - acc: 0.9321
Epoch 6/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2147 - acc: 0.9377
Epoch 7/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1982 - acc: 0.9497
Epoch 8/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1826 - acc: 0.9554
Epoch 9/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1600 - acc: 0.9563
Epoch 10/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1416 - acc: 0.9630
Epoch 11/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1326 - acc: 0.9690
Epoch 12/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1221 - acc: 0.9722
Epoch 13/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1154 - acc: 0.9706
Epoch 14/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1031 - acc: 0.9781
Epoch 15/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0923 - acc: 0.9806
Epoch 16/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0902 - acc: 0.9821
Epoch 17/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0747 - acc: 0.9865
Epoch 18/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0725 - acc: 0.9879
Epoch 19/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0705 - acc: 0.9850
Epoch 20/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0636 - acc: 0.9900
Epoch 21/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0582 - acc: 0.9902
Epoch 22/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0539 - acc: 0.9926
Epoch 23/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0528 - acc: 0.9905
Epoch 24/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0479 - acc: 0.9898
Epoch 25/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0466 - acc: 0.9929
Epoch 26/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0403 - acc: 0.9935
Epoch 27/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0381 - acc: 0.9948
Epoch 28/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0359 - acc: 0.9958
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7728
False 1343
True percentage 0.851945761217
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.74      0.48      0.58       438
          O       0.98      0.94      0.96      7318
      B-ORG       0.55      0.51      0.53       296
     B-MISC       0.40      0.38      0.39       141
      I-ORG       0.30      0.26      0.28       151
      I-PER       0.63      0.48      0.54       214
     I-MISC       0.35      0.44      0.39       154
      B-LOC       0.70      0.60      0.65       218
      I-LOC       0.56      0.46      0.51       141

avg / total       0.90      0.85      0.87      9071

F-1 Score (without O):
0.890085824208
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104206 unique words.
4202 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 276
OOV word occurences: in test 465
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6669248     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,781,378
Trainable params: 6,781,378
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 7s 42ms/step - loss: 0.9663 - acc: 0.7200
Epoch 2/28

167/167 [==============================] - 5s 27ms/step - loss: 0.5157 - acc: 0.8321
Epoch 3/28

167/167 [==============================] - 4s 27ms/step - loss: 0.4258 - acc: 0.8686
Epoch 4/28

167/167 [==============================] - 4s 26ms/step - loss: 0.3784 - acc: 0.8873
Epoch 5/28

167/167 [==============================] - 4s 26ms/step - loss: 0.3353 - acc: 0.9000
Epoch 6/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2996 - acc: 0.9106
Epoch 7/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2770 - acc: 0.9203
Epoch 8/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2447 - acc: 0.9311
Epoch 9/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2266 - acc: 0.9385
Epoch 10/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2057 - acc: 0.9405
Epoch 11/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1867 - acc: 0.9516
Epoch 12/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1716 - acc: 0.9554
Epoch 13/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1535 - acc: 0.9651
Epoch 14/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1442 - acc: 0.9663
Epoch 15/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1371 - acc: 0.9685
Epoch 16/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1222 - acc: 0.9749
Epoch 17/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1138 - acc: 0.9766
Epoch 18/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1050 - acc: 0.9780
Epoch 19/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0989 - acc: 0.9784
Epoch 20/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0935 - acc: 0.9818
Epoch 21/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0876 - acc: 0.9856
Epoch 22/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0796 - acc: 0.9868
Epoch 23/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0740 - acc: 0.9882
Epoch 24/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0709 - acc: 0.9881
Epoch 25/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0649 - acc: 0.9896
Epoch 26/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0610 - acc: 0.9908
Epoch 27/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0576 - acc: 0.9924
Epoch 28/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0530 - acc: 0.9925
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7823
False 1248
True percentage 0.862418696946
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-PER       0.81      0.62      0.70       438
      B-ORG       0.56      0.41      0.47       296
      I-ORG       0.30      0.37      0.33       151
      B-LOC       0.62      0.65      0.63       218
      I-PER       0.75      0.49      0.59       214
     B-MISC       0.27      0.23      0.25       141
      I-LOC       0.66      0.66      0.66       141
     I-MISC       0.37      0.25      0.30       154

avg / total       0.90      0.86      0.88      9071

F-1 Score (without O):
0.531849103278
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104196 unique words.
4192 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 278
OOV word occurences: in test 541
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6668608     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,780,738
Trainable params: 6,780,738
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 7s 43ms/step - loss: 0.8103 - acc: 0.7537
Epoch 2/28

167/167 [==============================] - 5s 27ms/step - loss: 0.4093 - acc: 0.8735
Epoch 3/28

167/167 [==============================] - 4s 27ms/step - loss: 0.3536 - acc: 0.8909
Epoch 4/28

167/167 [==============================] - 4s 26ms/step - loss: 0.3141 - acc: 0.8979
Epoch 5/28

167/167 [==============================] - 4s 27ms/step - loss: 0.2798 - acc: 0.9162
Epoch 6/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2460 - acc: 0.9272
Epoch 7/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2331 - acc: 0.9336
Epoch 8/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2140 - acc: 0.9425
Epoch 9/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1948 - acc: 0.9496
Epoch 10/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1731 - acc: 0.9586
Epoch 11/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1623 - acc: 0.9587
Epoch 12/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1490 - acc: 0.9642
Epoch 13/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1380 - acc: 0.9677
Epoch 14/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1267 - acc: 0.9731
Epoch 15/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1123 - acc: 0.9760
Epoch 16/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1048 - acc: 0.9800
Epoch 17/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0997 - acc: 0.9824
Epoch 18/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0903 - acc: 0.9833
Epoch 19/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0873 - acc: 0.9836
Epoch 20/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0785 - acc: 0.9880
Epoch 21/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0736 - acc: 0.9874
Epoch 22/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0696 - acc: 0.9885
Epoch 23/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0635 - acc: 0.9903
Epoch 24/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0613 - acc: 0.9892
Epoch 25/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0584 - acc: 0.9890
Epoch 26/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0548 - acc: 0.9913
Epoch 27/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0490 - acc: 0.9938
Epoch 28/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0467 - acc: 0.9923
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7605
False 1466
True percentage 0.838386065483
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.94      0.95      7318
      B-PER       0.83      0.41      0.55       438
      I-PER       0.73      0.43      0.54       214
      B-ORG       0.44      0.55      0.49       296
      I-ORG       0.23      0.44      0.30       151
      B-LOC       0.66      0.64      0.65       218
     B-MISC       0.45      0.11      0.17       141
     I-MISC       0.36      0.08      0.13       154
      I-LOC       0.50      0.45      0.48       141

avg / total       0.89      0.84      0.86      9071

F-1 Score (without O):
0.461977186312
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104201 unique words.
4197 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 270
OOV word occurences: in test 452
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6668928     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,781,058
Trainable params: 6,781,058
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 7s 43ms/step - loss: 0.8149 - acc: 0.7583
Epoch 2/28

167/167 [==============================] - 5s 27ms/step - loss: 0.4467 - acc: 0.8560
Epoch 3/28

167/167 [==============================] - 5s 27ms/step - loss: 0.3767 - acc: 0.8839
Epoch 4/28

167/167 [==============================] - 4s 27ms/step - loss: 0.3235 - acc: 0.9031
Epoch 5/28

167/167 [==============================] - 4s 27ms/step - loss: 0.2909 - acc: 0.9091
Epoch 6/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2599 - acc: 0.9199
Epoch 7/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2377 - acc: 0.9319
Epoch 8/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2122 - acc: 0.9441
Epoch 9/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1944 - acc: 0.9527
Epoch 10/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1701 - acc: 0.9543
Epoch 11/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1553 - acc: 0.9610
Epoch 12/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1442 - acc: 0.9670
Epoch 13/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1352 - acc: 0.9668
Epoch 14/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1279 - acc: 0.9717
Epoch 15/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1101 - acc: 0.9770
Epoch 16/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1070 - acc: 0.9770
Epoch 17/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0980 - acc: 0.9793
Epoch 18/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0895 - acc: 0.9818
Epoch 19/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0814 - acc: 0.9850
Epoch 20/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0769 - acc: 0.9840
Epoch 21/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0703 - acc: 0.9892
Epoch 22/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0673 - acc: 0.9885
Epoch 23/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0640 - acc: 0.9887
Epoch 24/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0570 - acc: 0.9913
Epoch 25/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0554 - acc: 0.9908
Epoch 26/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0525 - acc: 0.9919
Epoch 27/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0443 - acc: 0.9935
Epoch 28/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0468 - acc: 0.9922
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7862
False 1209
True percentage 0.866718112667
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
     B-MISC       0.32      0.33      0.33       141
     I-MISC       0.33      0.16      0.22       154
      B-ORG       0.59      0.55      0.57       296
      B-LOC       0.71      0.59      0.64       218
      B-PER       0.85      0.62      0.72       438
      I-PER       0.79      0.57      0.66       214
      I-ORG       0.40      0.44      0.42       151
      I-LOC       0.53      0.68      0.60       141

avg / total       0.91      0.87      0.89      9071

F-1 Score (without O):
0.564749307905
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104181 unique words.
4177 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 273
OOV word occurences: in test 525
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6667648     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,779,778
Trainable params: 6,779,778
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 7s 42ms/step - loss: 0.9004 - acc: 0.7335
Epoch 2/28

167/167 [==============================] - 5s 27ms/step - loss: 0.4391 - acc: 0.8591
Epoch 3/28

167/167 [==============================] - 4s 27ms/step - loss: 0.3766 - acc: 0.8850
Epoch 4/28

167/167 [==============================] - 4s 27ms/step - loss: 0.3299 - acc: 0.9015
Epoch 5/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2843 - acc: 0.9205
Epoch 6/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2537 - acc: 0.9277
Epoch 7/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2272 - acc: 0.9406
Epoch 8/28

167/167 [==============================] - 4s 26ms/step - loss: 0.2031 - acc: 0.9453
Epoch 9/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1953 - acc: 0.9464
Epoch 10/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1680 - acc: 0.9594
Epoch 11/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1505 - acc: 0.9650
Epoch 12/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1346 - acc: 0.9701
Epoch 13/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1269 - acc: 0.9720
Epoch 14/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1176 - acc: 0.9731
Epoch 15/28

167/167 [==============================] - 4s 26ms/step - loss: 0.1016 - acc: 0.9781
Epoch 16/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0958 - acc: 0.9824
Epoch 17/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0876 - acc: 0.9831
Epoch 18/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0779 - acc: 0.9868
Epoch 19/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0742 - acc: 0.9855
Epoch 20/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0732 - acc: 0.9854
Epoch 21/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0631 - acc: 0.9884
Epoch 22/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0631 - acc: 0.9875
Epoch 23/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0589 - acc: 0.9902
Epoch 24/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0512 - acc: 0.9919
Epoch 25/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0501 - acc: 0.9920
Epoch 26/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0441 - acc: 0.9929
Epoch 27/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0431 - acc: 0.9948
Epoch 28/28

167/167 [==============================] - 4s 26ms/step - loss: 0.0386 - acc: 0.9943
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7790
False 1281
True percentage 0.858780729798
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.81      0.51      0.63       438
      I-PER       0.81      0.42      0.55       214
          O       0.97      0.95      0.96      7318
      B-ORG       0.57      0.63      0.60       296
      B-LOC       0.67      0.65      0.66       218
      I-ORG       0.28      0.44      0.34       151
      I-LOC       0.71      0.55      0.62       141
     B-MISC       0.36      0.11      0.17       141
     I-MISC       0.47      0.23      0.31       154

avg / total       0.91      0.86      0.88      9071

F-1 Score (without O):
0.895278665247
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104112 unique words.
4108 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 562
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663232     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,362
Trainable params: 6,775,362
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 5s 60ms/step - loss: 1.0529 - acc: 0.6923
Epoch 2/28

83/83 [==============================] - 2s 29ms/step - loss: 0.5531 - acc: 0.8359
Epoch 3/28

83/83 [==============================] - 2s 28ms/step - loss: 0.4145 - acc: 0.8764
Epoch 4/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3708 - acc: 0.8867
Epoch 5/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3344 - acc: 0.9050
Epoch 6/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3042 - acc: 0.9056
Epoch 7/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2851 - acc: 0.9169
Epoch 8/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2577 - acc: 0.9274
Epoch 9/28

83/83 [==============================] - 2s 27ms/step - loss: 0.2475 - acc: 0.9293
Epoch 10/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2305 - acc: 0.9382
Epoch 11/28

83/83 [==============================] - 2s 27ms/step - loss: 0.2153 - acc: 0.9422
Epoch 12/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1997 - acc: 0.9485
Epoch 13/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1942 - acc: 0.9517
Epoch 14/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1803 - acc: 0.9544
Epoch 15/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1650 - acc: 0.9615
Epoch 16/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1501 - acc: 0.9612
Epoch 17/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1473 - acc: 0.9696
Epoch 18/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1431 - acc: 0.9587
Epoch 19/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1291 - acc: 0.9764
Epoch 20/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1237 - acc: 0.9760
Epoch 21/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1162 - acc: 0.9730
Epoch 22/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1123 - acc: 0.9752
Epoch 23/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1084 - acc: 0.9809
Epoch 24/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0968 - acc: 0.9836
Epoch 25/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0958 - acc: 0.9808
Epoch 26/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0911 - acc: 0.9830
Epoch 27/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0809 - acc: 0.9881
Epoch 28/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0806 - acc: 0.9837
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7641
False 1430
True percentage 0.842354756918
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.95      0.95      7318
      B-PER       0.75      0.50      0.60       438
      B-ORG       0.54      0.46      0.50       296
      I-ORG       0.24      0.31      0.27       151
      I-PER       0.69      0.40      0.51       214
      B-LOC       0.70      0.56      0.62       218
     B-MISC       0.33      0.12      0.18       141
      I-LOC       0.63      0.35      0.45       141
     I-MISC       0.50      0.19      0.28       154

avg / total       0.88      0.84      0.86      9071

F-1 Score (without O):
0.472800537273
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104135 unique words.
4131 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 274
OOV word occurences: in test 468
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6664704     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,776,834
Trainable params: 6,776,834
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 5s 60ms/step - loss: 1.1172 - acc: 0.6750
Epoch 2/28

83/83 [==============================] - 2s 28ms/step - loss: 0.5259 - acc: 0.8462
Epoch 3/28

83/83 [==============================] - 2s 29ms/step - loss: 0.4265 - acc: 0.8692
Epoch 4/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3848 - acc: 0.8761
Epoch 5/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3304 - acc: 0.8955
Epoch 6/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3034 - acc: 0.9201
Epoch 7/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2820 - acc: 0.9202
Epoch 8/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2630 - acc: 0.9287
Epoch 9/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2365 - acc: 0.9276
Epoch 10/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2199 - acc: 0.9400
Epoch 11/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2001 - acc: 0.9527
Epoch 12/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1929 - acc: 0.9514
Epoch 13/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1766 - acc: 0.9644
Epoch 14/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1630 - acc: 0.9666
Epoch 15/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1592 - acc: 0.9609
Epoch 16/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1464 - acc: 0.9652
Epoch 17/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1309 - acc: 0.9724
Epoch 18/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1250 - acc: 0.9737
Epoch 19/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1150 - acc: 0.9795
Epoch 20/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1121 - acc: 0.9809
Epoch 21/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1026 - acc: 0.9817
Epoch 22/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0955 - acc: 0.9840
Epoch 23/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0945 - acc: 0.9845
Epoch 24/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0890 - acc: 0.9879
Epoch 25/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0803 - acc: 0.9888
Epoch 26/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0788 - acc: 0.9890
Epoch 27/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0743 - acc: 0.9905
Epoch 28/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0661 - acc: 0.9925
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7643
False 1428
True percentage 0.842575239775
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.95      0.96      7318
      B-ORG       0.43      0.41      0.42       296
      I-ORG       0.21      0.35      0.26       151
      B-PER       0.79      0.50      0.61       438
      B-LOC       0.63      0.50      0.56       218
      I-LOC       0.30      0.16      0.21       141
      I-PER       0.72      0.53      0.61       214
     B-MISC       0.29      0.10      0.15       141
     I-MISC       0.30      0.14      0.19       154

avg / total       0.88      0.84      0.86      9071

F-1 Score (without O):
0.434473854099
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104114 unique words.
4110 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 276
OOV word occurences: in test 456
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663360     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,490
Trainable params: 6,775,490
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 5s 59ms/step - loss: 1.1362 - acc: 0.6796
Epoch 2/28

83/83 [==============================] - 2s 28ms/step - loss: 0.5487 - acc: 0.8301
Epoch 3/28

83/83 [==============================] - 2s 28ms/step - loss: 0.4681 - acc: 0.8515
Epoch 4/28

83/83 [==============================] - 2s 28ms/step - loss: 0.4190 - acc: 0.8674
Epoch 5/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3618 - acc: 0.8873
Epoch 6/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3457 - acc: 0.8922
Epoch 7/28

83/83 [==============================] - 2s 27ms/step - loss: 0.3051 - acc: 0.9027
Epoch 8/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2862 - acc: 0.9190
Epoch 9/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2574 - acc: 0.9292
Epoch 10/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2370 - acc: 0.9403
Epoch 11/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2253 - acc: 0.9404
Epoch 12/28

83/83 [==============================] - 2s 27ms/step - loss: 0.2072 - acc: 0.9421
Epoch 13/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1907 - acc: 0.9540
Epoch 14/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1910 - acc: 0.9487
Epoch 15/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1716 - acc: 0.9581
Epoch 16/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1628 - acc: 0.9587
Epoch 17/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1486 - acc: 0.9663
Epoch 18/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1390 - acc: 0.9712
Epoch 19/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1346 - acc: 0.9721
Epoch 20/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1259 - acc: 0.9701
Epoch 21/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1183 - acc: 0.9771
Epoch 22/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1130 - acc: 0.9783
Epoch 23/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1152 - acc: 0.9751
Epoch 24/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1017 - acc: 0.9767
Epoch 25/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0979 - acc: 0.9790
Epoch 26/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0951 - acc: 0.9803
Epoch 27/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0871 - acc: 0.9845
Epoch 28/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0892 - acc: 0.9838
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7761
False 1310
True percentage 0.855583728365
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.95      0.95      7318
      B-PER       0.79      0.63      0.70       438
      B-ORG       0.54      0.53      0.53       296
      I-ORG       0.29      0.17      0.22       151
     B-MISC       0.24      0.07      0.11       141
     I-MISC       0.27      0.17      0.21       154
      I-PER       0.65      0.50      0.57       214
      B-LOC       0.66      0.55      0.60       218
      I-LOC       0.61      0.45      0.52       141

avg / total       0.88      0.86      0.87      9071

F-1 Score (without O):
0.510901399284
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104134 unique words.
4130 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 280
OOV word occurences: in test 543
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6664640     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,776,770
Trainable params: 6,776,770
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 5s 59ms/step - loss: 1.0895 - acc: 0.6537
Epoch 2/28

83/83 [==============================] - 2s 28ms/step - loss: 0.5584 - acc: 0.8287
Epoch 3/28

83/83 [==============================] - 2s 28ms/step - loss: 0.4557 - acc: 0.8739
Epoch 4/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3941 - acc: 0.8849
Epoch 5/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3479 - acc: 0.9054
Epoch 6/28

83/83 [==============================] - 2s 29ms/step - loss: 0.3185 - acc: 0.9174
Epoch 7/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2909 - acc: 0.9278
Epoch 8/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2680 - acc: 0.9342
Epoch 9/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2297 - acc: 0.9437
Epoch 10/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2151 - acc: 0.9478
Epoch 11/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2026 - acc: 0.9453
Epoch 12/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1763 - acc: 0.9587
Epoch 13/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1654 - acc: 0.9632
Epoch 14/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1466 - acc: 0.9665
Epoch 15/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1426 - acc: 0.9676
Epoch 16/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1263 - acc: 0.9743
Epoch 17/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1215 - acc: 0.9768
Epoch 18/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1144 - acc: 0.9794
Epoch 19/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1037 - acc: 0.9851
Epoch 20/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0977 - acc: 0.9825
Epoch 21/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0871 - acc: 0.9844
Epoch 22/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0863 - acc: 0.9863
Epoch 23/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0798 - acc: 0.9874
Epoch 24/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0710 - acc: 0.9892
Epoch 25/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0646 - acc: 0.9899
Epoch 26/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0663 - acc: 0.9873
Epoch 27/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0624 - acc: 0.9917
Epoch 28/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0580 - acc: 0.9908
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7677
False 1394
True percentage 0.846323448352
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.94      0.96      7318
      B-ORG       0.49      0.57      0.52       296
      B-PER       0.78      0.48      0.59       438
      I-PER       0.62      0.38      0.47       214
      B-LOC       0.71      0.61      0.66       218
      I-LOC       0.54      0.54      0.54       141
      I-ORG       0.19      0.32      0.24       151
     B-MISC       0.21      0.15      0.17       141
     I-MISC       0.43      0.24      0.31       154

avg / total       0.90      0.85      0.87      9071

F-1 Score (without O):
0.474908200734
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104121 unique words.
4117 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 278
OOV word occurences: in test 559
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663808     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,938
Trainable params: 6,775,938
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 5s 63ms/step - loss: 1.0327 - acc: 0.7144
Epoch 2/28

83/83 [==============================] - 2s 29ms/step - loss: 0.5015 - acc: 0.8400
Epoch 3/28

83/83 [==============================] - 2s 29ms/step - loss: 0.4150 - acc: 0.8627
Epoch 4/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3569 - acc: 0.8864
Epoch 5/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3207 - acc: 0.8980
Epoch 6/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2925 - acc: 0.9180
Epoch 7/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2608 - acc: 0.9221
Epoch 8/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2364 - acc: 0.9426
Epoch 9/28

83/83 [==============================] - 2s 27ms/step - loss: 0.2192 - acc: 0.9476
Epoch 10/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2004 - acc: 0.9508
Epoch 11/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1814 - acc: 0.9600
Epoch 12/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1587 - acc: 0.9639
Epoch 13/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1598 - acc: 0.9643
Epoch 14/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1435 - acc: 0.9634
Epoch 15/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1358 - acc: 0.9701
Epoch 16/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1301 - acc: 0.9790
Epoch 17/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1221 - acc: 0.9738
Epoch 18/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1082 - acc: 0.9800
Epoch 19/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1045 - acc: 0.9793
Epoch 20/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0963 - acc: 0.9856
Epoch 21/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0883 - acc: 0.9867
Epoch 22/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0783 - acc: 0.9885
Epoch 23/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0748 - acc: 0.9908
Epoch 24/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0703 - acc: 0.9917
Epoch 25/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0721 - acc: 0.9908
Epoch 26/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0621 - acc: 0.9903
Epoch 27/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0587 - acc: 0.9939
Epoch 28/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0562 - acc: 0.9929
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7664
False 1407
True percentage 0.844890309778
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.73      0.46      0.57       438
          O       0.98      0.94      0.96      7318
      B-ORG       0.54      0.52      0.53       296
     B-MISC       0.30      0.26      0.27       141
      I-ORG       0.32      0.34      0.33       151
      I-PER       0.76      0.42      0.54       214
     I-MISC       0.44      0.16      0.23       154
      B-LOC       0.57      0.64      0.61       218
      I-LOC       0.42      0.72      0.53       141

avg / total       0.90      0.84      0.87      9071

F-1 Score (without O):
0.884699745095
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104113 unique words.
4109 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 281
OOV word occurences: in test 490
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663296     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,426
Trainable params: 6,775,426
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 5s 59ms/step - loss: 1.1246 - acc: 0.6619
Epoch 2/28

83/83 [==============================] - 2s 28ms/step - loss: 0.5555 - acc: 0.8303
Epoch 3/28

83/83 [==============================] - 2s 28ms/step - loss: 0.4594 - acc: 0.8628
Epoch 4/28

83/83 [==============================] - 2s 28ms/step - loss: 0.4231 - acc: 0.8693
Epoch 5/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3653 - acc: 0.8817
Epoch 6/28

83/83 [==============================] - 2s 27ms/step - loss: 0.3260 - acc: 0.9063
Epoch 7/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3022 - acc: 0.9097
Epoch 8/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2756 - acc: 0.9265
Epoch 9/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2553 - acc: 0.9389
Epoch 10/28

83/83 [==============================] - 2s 27ms/step - loss: 0.2322 - acc: 0.9415
Epoch 11/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2224 - acc: 0.9430
Epoch 12/28

83/83 [==============================] - 2s 27ms/step - loss: 0.2023 - acc: 0.9540
Epoch 13/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1871 - acc: 0.9559
Epoch 14/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1777 - acc: 0.9619
Epoch 15/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1621 - acc: 0.9632
Epoch 16/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1511 - acc: 0.9724
Epoch 17/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1379 - acc: 0.9779
Epoch 18/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1342 - acc: 0.9758
Epoch 19/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1222 - acc: 0.9776
Epoch 20/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1216 - acc: 0.9781
Epoch 21/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1123 - acc: 0.9807
Epoch 22/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1132 - acc: 0.9832
Epoch 23/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0978 - acc: 0.9851
Epoch 24/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0922 - acc: 0.9870
Epoch 25/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0879 - acc: 0.9887
Epoch 26/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0823 - acc: 0.9913
Epoch 27/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0861 - acc: 0.9880
Epoch 28/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0807 - acc: 0.9890
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7699
False 1372
True percentage 0.848748759784
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-PER       0.76      0.57      0.65       438
      B-ORG       0.50      0.43      0.46       296
      I-ORG       0.33      0.26      0.29       151
      B-LOC       0.53      0.65      0.58       218
      I-PER       0.65      0.50      0.57       214
     B-MISC       0.24      0.09      0.13       141
      I-LOC       0.45      0.60      0.51       141
     I-MISC       0.24      0.08      0.12       154

avg / total       0.88      0.85      0.86      9071

F-1 Score (without O):
0.486912645853
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104109 unique words.
4105 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 563
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663040     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,170
Trainable params: 6,775,170
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 5s 60ms/step - loss: 1.2341 - acc: 0.6543
Epoch 2/28

83/83 [==============================] - 2s 29ms/step - loss: 0.5811 - acc: 0.8217
Epoch 3/28

83/83 [==============================] - 2s 28ms/step - loss: 0.4508 - acc: 0.8554
Epoch 4/28

83/83 [==============================] - 2s 29ms/step - loss: 0.4113 - acc: 0.8535
Epoch 5/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3618 - acc: 0.8864
Epoch 6/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3308 - acc: 0.8947
Epoch 7/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3046 - acc: 0.9084
Epoch 8/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2865 - acc: 0.9060
Epoch 9/28

83/83 [==============================] - 2s 27ms/step - loss: 0.2569 - acc: 0.9232
Epoch 10/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2495 - acc: 0.9221
Epoch 11/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2415 - acc: 0.9282
Epoch 12/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2196 - acc: 0.9417
Epoch 13/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2049 - acc: 0.9497
Epoch 14/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1826 - acc: 0.9518
Epoch 15/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1783 - acc: 0.9598
Epoch 16/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1664 - acc: 0.9537
Epoch 17/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1605 - acc: 0.9573
Epoch 18/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1456 - acc: 0.9700
Epoch 19/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1437 - acc: 0.9648
Epoch 20/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1303 - acc: 0.9719
Epoch 21/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1252 - acc: 0.9729
Epoch 22/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1176 - acc: 0.9783
Epoch 23/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1074 - acc: 0.9819
Epoch 24/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1035 - acc: 0.9849
Epoch 25/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0947 - acc: 0.9885
Epoch 26/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0933 - acc: 0.9890
Epoch 27/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0874 - acc: 0.9899
Epoch 28/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0804 - acc: 0.9877
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7423
False 1648
True percentage 0.818322125455
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.93      0.95      7318
      B-PER       0.64      0.32      0.43       438
      I-PER       0.80      0.25      0.38       214
      B-ORG       0.35      0.45      0.39       296
      I-ORG       0.18      0.51      0.27       151
      B-LOC       0.67      0.51      0.58       218
     B-MISC       0.31      0.16      0.21       141
     I-MISC       0.35      0.10      0.16       154
      I-LOC       0.60      0.24      0.34       141

avg / total       0.88      0.82      0.84      9071

F-1 Score (without O):
0.368553459119
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104118 unique words.
4114 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 276
OOV word occurences: in test 477
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663616     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,746
Trainable params: 6,775,746
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 5s 60ms/step - loss: 1.0145 - acc: 0.6965
Epoch 2/28

83/83 [==============================] - 2s 28ms/step - loss: 0.4808 - acc: 0.8476
Epoch 3/28

83/83 [==============================] - 2s 28ms/step - loss: 0.4300 - acc: 0.8583
Epoch 4/28

83/83 [==============================] - 2s 29ms/step - loss: 0.3441 - acc: 0.9026
Epoch 5/28

83/83 [==============================] - 2s 29ms/step - loss: 0.3175 - acc: 0.9064
Epoch 6/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2821 - acc: 0.9219
Epoch 7/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2612 - acc: 0.9298
Epoch 8/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2211 - acc: 0.9470
Epoch 9/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2100 - acc: 0.9427
Epoch 10/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1882 - acc: 0.9538
Epoch 11/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1770 - acc: 0.9561
Epoch 12/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1544 - acc: 0.9647
Epoch 13/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1440 - acc: 0.9685
Epoch 14/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1333 - acc: 0.9781
Epoch 15/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1250 - acc: 0.9809
Epoch 16/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1165 - acc: 0.9767
Epoch 17/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1126 - acc: 0.9798
Epoch 18/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1033 - acc: 0.9840
Epoch 19/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0868 - acc: 0.9900
Epoch 20/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0838 - acc: 0.9858
Epoch 21/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0803 - acc: 0.9878
Epoch 22/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0768 - acc: 0.9876
Epoch 23/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0665 - acc: 0.9921
Epoch 24/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0649 - acc: 0.9949
Epoch 25/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0602 - acc: 0.9910
Epoch 26/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0566 - acc: 0.9952
Epoch 27/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0544 - acc: 0.9937
Epoch 28/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0507 - acc: 0.9971
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7684
False 1387
True percentage 0.847095138353
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.95      0.95      7318
     B-MISC       0.20      0.18      0.19       141
     I-MISC       0.26      0.18      0.21       154
      B-ORG       0.52      0.34      0.41       296
      B-LOC       0.68      0.52      0.59       218
      B-PER       0.76      0.60      0.67       438
      I-PER       0.71      0.48      0.57       214
      I-ORG       0.28      0.22      0.24       151
      I-LOC       0.58      0.46      0.51       141

avg / total       0.88      0.85      0.86      9071

F-1 Score (without O):
0.476656872347
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104107 unique words.
4103 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 276
OOV word occurences: in test 528
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6662912     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,042
Trainable params: 6,775,042
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 5s 59ms/step - loss: 0.9656 - acc: 0.7555
Epoch 2/28

83/83 [==============================] - 2s 28ms/step - loss: 0.5156 - acc: 0.8414
Epoch 3/28

83/83 [==============================] - 2s 28ms/step - loss: 0.4058 - acc: 0.8788
Epoch 4/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3548 - acc: 0.8930
Epoch 5/28

83/83 [==============================] - 2s 29ms/step - loss: 0.3081 - acc: 0.9089
Epoch 6/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2807 - acc: 0.9197
Epoch 7/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2462 - acc: 0.9288
Epoch 8/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2310 - acc: 0.9353
Epoch 9/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2077 - acc: 0.9408
Epoch 10/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1864 - acc: 0.9500
Epoch 11/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1746 - acc: 0.9529
Epoch 12/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1560 - acc: 0.9699
Epoch 13/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1531 - acc: 0.9651
Epoch 14/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1297 - acc: 0.9793
Epoch 15/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1238 - acc: 0.9756
Epoch 16/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1122 - acc: 0.9755
Epoch 17/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1064 - acc: 0.9797
Epoch 18/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0952 - acc: 0.9855
Epoch 19/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0889 - acc: 0.9868
Epoch 20/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0872 - acc: 0.9853
Epoch 21/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0787 - acc: 0.9908
Epoch 22/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0744 - acc: 0.9905
Epoch 23/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0663 - acc: 0.9907
Epoch 24/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0606 - acc: 0.9908
Epoch 25/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0562 - acc: 0.9920
Epoch 26/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0539 - acc: 0.9947
Epoch 27/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0506 - acc: 0.9952
Epoch 28/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0483 - acc: 0.9967
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7627
False 1444
True percentage 0.840811376915
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.81      0.42      0.56       438
      I-PER       0.79      0.21      0.33       214
          O       0.96      0.95      0.96      7318
      B-ORG       0.49      0.64      0.56       296
      B-LOC       0.72      0.48      0.58       218
      I-ORG       0.20      0.40      0.27       151
      I-LOC       0.79      0.31      0.45       141
     B-MISC       0.32      0.05      0.09       141
     I-MISC       0.28      0.17      0.21       154

avg / total       0.89      0.84      0.85      9071

F-1 Score (without O):
0.878253172027
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104069 unique words.
4065 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660480     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,610
Trainable params: 6,772,610
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 4s 110ms/step - loss: 1.2888 - acc: 0.5441
Epoch 2/28

33/33 [==============================] - 1s 33ms/step - loss: 0.5539 - acc: 0.8706
Epoch 3/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3583 - acc: 0.8905
Epoch 4/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3114 - acc: 0.8971
Epoch 5/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2672 - acc: 0.9116
Epoch 6/28

33/33 [==============================] - 1s 33ms/step - loss: 0.2355 - acc: 0.9298
Epoch 7/28

33/33 [==============================] - 1s 34ms/step - loss: 0.2265 - acc: 0.9356
Epoch 8/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2090 - acc: 0.9395
Epoch 9/28

33/33 [==============================] - 1s 33ms/step - loss: 0.2149 - acc: 0.9385
Epoch 10/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1823 - acc: 0.9564
Epoch 11/28

33/33 [==============================] - 1s 33ms/step - loss: 0.1627 - acc: 0.9594
Epoch 12/28

33/33 [==============================] - 1s 33ms/step - loss: 0.1577 - acc: 0.9487
Epoch 13/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1481 - acc: 0.9513
Epoch 14/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1425 - acc: 0.9546
Epoch 15/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1334 - acc: 0.9632
Epoch 16/28

33/33 [==============================] - 1s 33ms/step - loss: 0.1240 - acc: 0.9676
Epoch 17/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1145 - acc: 0.9690
Epoch 18/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1258 - acc: 0.9693
Epoch 19/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1295 - acc: 0.9570
Epoch 20/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1067 - acc: 0.9730
Epoch 21/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1003 - acc: 0.9761
Epoch 22/28

33/33 [==============================] - 1s 32ms/step - loss: 0.0959 - acc: 0.9775
Epoch 23/28

33/33 [==============================] - 1s 32ms/step - loss: 0.0973 - acc: 0.9776
Epoch 24/28

33/33 [==============================] - 1s 33ms/step - loss: 0.0803 - acc: 0.9844
Epoch 25/28

33/33 [==============================] - 1s 31ms/step - loss: 0.0925 - acc: 0.9744
Epoch 26/28

33/33 [==============================] - 1s 31ms/step - loss: 0.0822 - acc: 0.9798
Epoch 27/28

33/33 [==============================] - 1s 32ms/step - loss: 0.0763 - acc: 0.9892
Epoch 28/28

33/33 [==============================] - 1s 32ms/step - loss: 0.0761 - acc: 0.9854
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7164
False 1907
True percentage 0.789769595414
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.92      0.94      7318
      B-PER       0.36      0.41      0.38       438
      B-ORG       0.26      0.41      0.31       296
      I-ORG       0.15      0.44      0.22       151
      I-PER       0.50      0.27      0.35       214
      B-LOC       0.40      0.01      0.02       218
     B-MISC       0.14      0.01      0.03       141
      I-LOC       0.00      0.00      0.00       141
     I-MISC       1.00      0.01      0.01       154

avg / total       0.85      0.79      0.80      9071

F-1 Score (without O):
0.260103312063
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104079 unique words.
4075 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 276
OOV word occurences: in test 470
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6661120     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,773,250
Trainable params: 6,773,250
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 4s 110ms/step - loss: 1.7373 - acc: 0.4333
Epoch 2/28

33/33 [==============================] - 1s 33ms/step - loss: 0.6620 - acc: 0.8091
Epoch 3/28

33/33 [==============================] - 1s 32ms/step - loss: 0.5182 - acc: 0.8440
Epoch 4/28

33/33 [==============================] - 1s 31ms/step - loss: 0.5393 - acc: 0.8401
Epoch 5/28

33/33 [==============================] - 1s 33ms/step - loss: 0.4263 - acc: 0.8340
Epoch 6/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3914 - acc: 0.8795
Epoch 7/28

33/33 [==============================] - 1s 33ms/step - loss: 0.3430 - acc: 0.9143
Epoch 8/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3211 - acc: 0.9106
Epoch 9/28

33/33 [==============================] - 1s 33ms/step - loss: 0.2909 - acc: 0.9303
Epoch 10/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3489 - acc: 0.8726
Epoch 11/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2688 - acc: 0.9234
Epoch 12/28

33/33 [==============================] - 1s 33ms/step - loss: 0.2424 - acc: 0.9433
Epoch 13/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2396 - acc: 0.9333
Epoch 14/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2190 - acc: 0.9439
Epoch 15/28

33/33 [==============================] - 1s 33ms/step - loss: 0.2131 - acc: 0.9648
Epoch 16/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1917 - acc: 0.9591
Epoch 17/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2054 - acc: 0.9437
Epoch 18/28

33/33 [==============================] - 1s 33ms/step - loss: 0.1913 - acc: 0.9678
Epoch 19/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1794 - acc: 0.9660
Epoch 20/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1677 - acc: 0.9739
Epoch 21/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1473 - acc: 0.9775
Epoch 22/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1551 - acc: 0.9878
Epoch 23/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1437 - acc: 0.9734
Epoch 24/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1293 - acc: 0.9809
Epoch 25/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1227 - acc: 0.9848
Epoch 26/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1196 - acc: 0.9802
Epoch 27/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1086 - acc: 0.9904
Epoch 28/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1083 - acc: 0.9892
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7575
False 1496
True percentage 0.835078822622
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.95      0.94      7318
      B-ORG       0.47      0.39      0.42       296
      I-ORG       0.25      0.09      0.13       151
      B-PER       0.79      0.47      0.59       438
      B-LOC       0.56      0.44      0.49       218
      I-LOC       0.33      0.54      0.41       141
      I-PER       0.71      0.43      0.54       214
     B-MISC       0.31      0.03      0.05       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.85      0.84      0.84      9071

F-1 Score (without O):
0.420795533845
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104062 unique words.
4058 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 281
OOV word occurences: in test 473
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660032     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,162
Trainable params: 6,772,162
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 4s 124ms/step - loss: 1.6857 - acc: 0.4509
Epoch 2/28

33/33 [==============================] - 1s 32ms/step - loss: 0.8457 - acc: 0.8020
Epoch 3/28

33/33 [==============================] - 1s 32ms/step - loss: 0.5759 - acc: 0.8185
Epoch 4/28

33/33 [==============================] - 1s 32ms/step - loss: 0.4962 - acc: 0.8270
Epoch 5/28

33/33 [==============================] - 1s 33ms/step - loss: 0.4375 - acc: 0.8622
Epoch 6/28

33/33 [==============================] - 1s 33ms/step - loss: 0.4189 - acc: 0.8635
Epoch 7/28

33/33 [==============================] - 1s 33ms/step - loss: 0.3733 - acc: 0.8984
Epoch 8/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3513 - acc: 0.8997
Epoch 9/28

33/33 [==============================] - 1s 34ms/step - loss: 0.3310 - acc: 0.9057
Epoch 10/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3076 - acc: 0.9159
Epoch 11/28

33/33 [==============================] - 1s 33ms/step - loss: 0.2964 - acc: 0.9272
Epoch 12/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2794 - acc: 0.9355
Epoch 13/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2398 - acc: 0.9499
Epoch 14/28

33/33 [==============================] - 1s 33ms/step - loss: 0.2749 - acc: 0.9266
Epoch 15/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2314 - acc: 0.9523
Epoch 16/28

33/33 [==============================] - 1s 33ms/step - loss: 0.2293 - acc: 0.9502
Epoch 17/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2273 - acc: 0.9378
Epoch 18/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1955 - acc: 0.9677
Epoch 19/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1903 - acc: 0.9632
Epoch 20/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1751 - acc: 0.9732
Epoch 21/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1730 - acc: 0.9645
Epoch 22/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1654 - acc: 0.9671
Epoch 23/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1490 - acc: 0.9801
Epoch 24/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1493 - acc: 0.9749
Epoch 25/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1378 - acc: 0.9780
Epoch 26/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1367 - acc: 0.9816
Epoch 27/28

33/33 [==============================] - 1s 33ms/step - loss: 0.1281 - acc: 0.9845
Epoch 28/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1304 - acc: 0.9830
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7478
False 1593
True percentage 0.824385404035
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.94      0.95      7318
      B-PER       0.62      0.46      0.53       438
      B-ORG       0.37      0.42      0.40       296
      I-ORG       0.18      0.15      0.16       151
     B-MISC       0.06      0.01      0.02       141
     I-MISC       0.20      0.27      0.23       154
      I-PER       0.50      0.35      0.41       214
      B-LOC       0.62      0.51      0.56       218
      I-LOC       1.00      0.05      0.09       141

avg / total       0.86      0.82      0.83      9071

F-1 Score (without O):
0.377164849262
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104087 unique words.
4083 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 553
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6661632     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,773,762
Trainable params: 6,773,762
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 4s 109ms/step - loss: 2.1689 - acc: 0.3584
Epoch 2/28

33/33 [==============================] - 1s 33ms/step - loss: 1.0123 - acc: 0.7651
Epoch 3/28

33/33 [==============================] - 1s 33ms/step - loss: 0.6455 - acc: 0.8113
Epoch 4/28

33/33 [==============================] - 1s 35ms/step - loss: 0.6449 - acc: 0.7999
Epoch 5/28

33/33 [==============================] - 1s 32ms/step - loss: 0.5285 - acc: 0.8569
Epoch 6/28

33/33 [==============================] - 1s 33ms/step - loss: 0.4596 - acc: 0.8694
Epoch 7/28

33/33 [==============================] - 1s 32ms/step - loss: 0.4427 - acc: 0.8582
Epoch 8/28

33/33 [==============================] - 1s 33ms/step - loss: 0.4218 - acc: 0.8797
Epoch 9/28

33/33 [==============================] - 1s 32ms/step - loss: 0.4130 - acc: 0.8580
Epoch 10/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3559 - acc: 0.9029
Epoch 11/28

33/33 [==============================] - 1s 33ms/step - loss: 0.3496 - acc: 0.9097
Epoch 12/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3314 - acc: 0.8997
Epoch 13/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3137 - acc: 0.9043
Epoch 14/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2867 - acc: 0.9332
Epoch 15/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2796 - acc: 0.9228
Epoch 16/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2875 - acc: 0.9243
Epoch 17/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2628 - acc: 0.9453
Epoch 18/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2598 - acc: 0.9334
Epoch 19/28

33/33 [==============================] - 1s 33ms/step - loss: 0.2410 - acc: 0.9406
Epoch 20/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2345 - acc: 0.9429
Epoch 21/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2321 - acc: 0.9530
Epoch 22/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2050 - acc: 0.9531
Epoch 23/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2216 - acc: 0.9515
Epoch 24/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2009 - acc: 0.9614
Epoch 25/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1854 - acc: 0.9637
Epoch 26/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1720 - acc: 0.9727
Epoch 27/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1601 - acc: 0.9709
Epoch 28/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1601 - acc: 0.9708
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7436
False 1635
True percentage 0.819755264028
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.94      0.95      7318
      B-ORG       0.46      0.47      0.46       296
      B-PER       0.60      0.28      0.38       438
      I-PER       0.42      0.22      0.29       214
      B-LOC       0.47      0.53      0.50       218
      I-LOC       0.42      0.62      0.50       141
      I-ORG       0.16      0.21      0.18       151
     B-MISC       0.07      0.01      0.01       141
     I-MISC       0.35      0.08      0.14       154

avg / total       0.85      0.82      0.83      9071

F-1 Score (without O):
0.361445783133
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104077 unique words.
4073 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 281
OOV word occurences: in test 565
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660992     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,773,122
Trainable params: 6,773,122
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 4s 111ms/step - loss: 1.4329 - acc: 0.5781
Epoch 2/28

33/33 [==============================] - 1s 32ms/step - loss: 0.6907 - acc: 0.8376
Epoch 3/28

33/33 [==============================] - 1s 33ms/step - loss: 0.6174 - acc: 0.8268
Epoch 4/28

33/33 [==============================] - 1s 32ms/step - loss: 0.4381 - acc: 0.8747
Epoch 5/28

33/33 [==============================] - 1s 33ms/step - loss: 0.3999 - acc: 0.8789
Epoch 6/28

33/33 [==============================] - 1s 33ms/step - loss: 0.3839 - acc: 0.8931
Epoch 7/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3244 - acc: 0.9175
Epoch 8/28

33/33 [==============================] - 1s 33ms/step - loss: 0.3164 - acc: 0.9118
Epoch 9/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2987 - acc: 0.9152
Epoch 10/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2873 - acc: 0.9290
Epoch 11/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2740 - acc: 0.9140
Epoch 12/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2406 - acc: 0.9401
Epoch 13/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2214 - acc: 0.9593
Epoch 14/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2254 - acc: 0.9484
Epoch 15/28

33/33 [==============================] - 1s 33ms/step - loss: 0.2193 - acc: 0.9517
Epoch 16/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1895 - acc: 0.9588
Epoch 17/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1803 - acc: 0.9587
Epoch 18/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1734 - acc: 0.9597
Epoch 19/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1749 - acc: 0.9555
Epoch 20/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1626 - acc: 0.9620
Epoch 21/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1613 - acc: 0.9618
Epoch 22/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1528 - acc: 0.9627
Epoch 23/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1356 - acc: 0.9718
Epoch 24/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1312 - acc: 0.9865
Epoch 25/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1298 - acc: 0.9812
Epoch 26/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1333 - acc: 0.9701
Epoch 27/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1503 - acc: 0.9763
Epoch 28/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1180 - acc: 0.9867
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7478
False 1593
True percentage 0.824385404035
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.57      0.46      0.51       438
          O       0.96      0.94      0.95      7318
      B-ORG       0.34      0.39      0.36       296
     B-MISC       0.19      0.02      0.04       141
      I-ORG       0.23      0.27      0.25       151
      I-PER       0.50      0.44      0.47       214
     I-MISC       0.42      0.06      0.11       154
      B-LOC       0.77      0.35      0.48       218
      I-LOC       0.35      0.38      0.36       141

avg / total       0.86      0.82      0.84      9071

F-1 Score (without O):
0.867099541312
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104063 unique words.
4059 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660096     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,226
Trainable params: 6,772,226
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 4s 111ms/step - loss: 1.4317 - acc: 0.5542
Epoch 2/28

33/33 [==============================] - 1s 33ms/step - loss: 0.5937 - acc: 0.8316
Epoch 3/28

33/33 [==============================] - 1s 32ms/step - loss: 0.5350 - acc: 0.8366
Epoch 4/28

33/33 [==============================] - 1s 32ms/step - loss: 0.4100 - acc: 0.8738
Epoch 5/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3828 - acc: 0.8933
Epoch 6/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3404 - acc: 0.9093
Epoch 7/28

33/33 [==============================] - 1s 33ms/step - loss: 0.3194 - acc: 0.9165
Epoch 8/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2968 - acc: 0.9256
Epoch 9/28

33/33 [==============================] - 1s 33ms/step - loss: 0.2828 - acc: 0.9241
Epoch 10/28

33/33 [==============================] - 1s 33ms/step - loss: 0.2967 - acc: 0.9199
Epoch 11/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2377 - acc: 0.9453
Epoch 12/28

33/33 [==============================] - 1s 33ms/step - loss: 0.2342 - acc: 0.9474
Epoch 13/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2230 - acc: 0.9549
Epoch 14/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2080 - acc: 0.9532
Epoch 15/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2054 - acc: 0.9542
Epoch 16/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2181 - acc: 0.9523
Epoch 17/28

33/33 [==============================] - 1s 33ms/step - loss: 0.1781 - acc: 0.9675
Epoch 18/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1611 - acc: 0.9664
Epoch 19/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1602 - acc: 0.9721
Epoch 20/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1639 - acc: 0.9656
Epoch 21/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1803 - acc: 0.9504
Epoch 22/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1419 - acc: 0.9734
Epoch 23/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1337 - acc: 0.9764
Epoch 24/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1347 - acc: 0.9745
Epoch 25/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1213 - acc: 0.9797
Epoch 26/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1180 - acc: 0.9772
Epoch 27/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1107 - acc: 0.9797
Epoch 28/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1089 - acc: 0.9774
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7365
False 1706
True percentage 0.811928122588
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.94      0.95      7318
      B-PER       0.71      0.39      0.50       438
      B-ORG       0.28      0.48      0.35       296
      I-ORG       0.17      0.33      0.22       151
      B-LOC       0.74      0.26      0.39       218
      I-PER       0.48      0.28      0.35       214
     B-MISC       0.00      0.00      0.00       141
      I-LOC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.84      0.81      0.82      9071

F-1 Score (without O):
0.3192550715
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104062 unique words.
4058 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660032     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,162
Trainable params: 6,772,162
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 4s 110ms/step - loss: 2.0795 - acc: 0.3771
Epoch 2/28

33/33 [==============================] - 1s 32ms/step - loss: 0.7144 - acc: 0.8228
Epoch 3/28

33/33 [==============================] - 1s 32ms/step - loss: 0.8149 - acc: 0.7680
Epoch 4/28

33/33 [==============================] - 1s 32ms/step - loss: 0.4982 - acc: 0.8331
Epoch 5/28

33/33 [==============================] - 1s 32ms/step - loss: 0.4508 - acc: 0.8541
Epoch 6/28

33/33 [==============================] - 1s 33ms/step - loss: 0.4196 - acc: 0.8648
Epoch 7/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3869 - acc: 0.8984
Epoch 8/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3409 - acc: 0.8994
Epoch 9/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3161 - acc: 0.9098
Epoch 10/28

33/33 [==============================] - 1s 33ms/step - loss: 0.2997 - acc: 0.9182
Epoch 11/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2762 - acc: 0.9168
Epoch 12/28

33/33 [==============================] - 1s 33ms/step - loss: 0.2757 - acc: 0.9203
Epoch 13/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2375 - acc: 0.9458
Epoch 14/28

33/33 [==============================] - 1s 33ms/step - loss: 0.2420 - acc: 0.9447
Epoch 15/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2359 - acc: 0.9321
Epoch 16/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2196 - acc: 0.9522
Epoch 17/28

33/33 [==============================] - 1s 33ms/step - loss: 0.2040 - acc: 0.9535
Epoch 18/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2169 - acc: 0.9540
Epoch 19/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1834 - acc: 0.9589
Epoch 20/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1722 - acc: 0.9673
Epoch 21/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1704 - acc: 0.9668
Epoch 22/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1621 - acc: 0.9672
Epoch 23/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1565 - acc: 0.9615
Epoch 24/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1506 - acc: 0.9682
Epoch 25/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1463 - acc: 0.9699
Epoch 26/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1438 - acc: 0.9766
Epoch 27/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1349 - acc: 0.9823
Epoch 28/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1297 - acc: 0.9779
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7200
False 1871
True percentage 0.793738286848
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.92      0.94      7318
      B-PER       0.57      0.26      0.36       438
      I-PER       0.49      0.20      0.28       214
      B-ORG       0.27      0.42      0.33       296
      I-ORG       0.16      0.68      0.26       151
      B-LOC       0.50      0.50      0.50       218
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      I-LOC       0.58      0.05      0.09       141

avg / total       0.86      0.79      0.81      9071

F-1 Score (without O):
0.295857988166
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104068 unique words.
4064 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 279
OOV word occurences: in test 482
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660416     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,546
Trainable params: 6,772,546
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 4s 112ms/step - loss: 1.3148 - acc: 0.6785
Epoch 2/28

33/33 [==============================] - 1s 33ms/step - loss: 0.6847 - acc: 0.7994
Epoch 3/28

33/33 [==============================] - 1s 32ms/step - loss: 0.6358 - acc: 0.8048
Epoch 4/28

33/33 [==============================] - 1s 32ms/step - loss: 0.5895 - acc: 0.8274
Epoch 5/28

33/33 [==============================] - 1s 33ms/step - loss: 0.4468 - acc: 0.8596
Epoch 6/28

33/33 [==============================] - 1s 32ms/step - loss: 0.4303 - acc: 0.8521
Epoch 7/28

33/33 [==============================] - 1s 34ms/step - loss: 0.3772 - acc: 0.8853
Epoch 8/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3658 - acc: 0.8699
Epoch 9/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3481 - acc: 0.8929
Epoch 10/28

33/33 [==============================] - 1s 33ms/step - loss: 0.3146 - acc: 0.9159
Epoch 11/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2821 - acc: 0.9211
Epoch 12/28

33/33 [==============================] - 1s 33ms/step - loss: 0.2639 - acc: 0.9360
Epoch 13/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2589 - acc: 0.9307
Epoch 14/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2568 - acc: 0.9367
Epoch 15/28

33/33 [==============================] - 1s 33ms/step - loss: 0.2461 - acc: 0.9419
Epoch 16/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2419 - acc: 0.9193
Epoch 17/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2063 - acc: 0.9472
Epoch 18/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2014 - acc: 0.9557
Epoch 19/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1883 - acc: 0.9598
Epoch 20/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1778 - acc: 0.9614
Epoch 21/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1638 - acc: 0.9635
Epoch 22/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1538 - acc: 0.9654
Epoch 23/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1598 - acc: 0.9567
Epoch 24/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1438 - acc: 0.9740
Epoch 25/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1273 - acc: 0.9829
Epoch 26/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1204 - acc: 0.9781
Epoch 27/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1203 - acc: 0.9758
Epoch 28/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1222 - acc: 0.9781
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7458
False 1613
True percentage 0.82218057546
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.95      0.95      7318
     B-MISC       0.15      0.11      0.13       141
     I-MISC       0.11      0.03      0.04       154
      B-ORG       0.31      0.41      0.35       296
      B-LOC       0.82      0.43      0.56       218
      B-PER       0.74      0.43      0.55       438
      I-PER       0.58      0.29      0.38       214
      I-ORG       0.13      0.27      0.18       151
      I-LOC       1.00      0.04      0.08       141

avg / total       0.87      0.82      0.83      9071

F-1 Score (without O):
0.345389377647
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104068 unique words.
4064 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 281
OOV word occurences: in test 534
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660416     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,546
Trainable params: 6,772,546
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 4s 110ms/step - loss: 1.6710 - acc: 0.4516
Epoch 2/28

33/33 [==============================] - 1s 32ms/step - loss: 1.1681 - acc: 0.6348
Epoch 3/28

33/33 [==============================] - 1s 32ms/step - loss: 0.6314 - acc: 0.8220
Epoch 4/28

33/33 [==============================] - 1s 32ms/step - loss: 0.5408 - acc: 0.8471
Epoch 5/28

33/33 [==============================] - 1s 32ms/step - loss: 0.4697 - acc: 0.8482
Epoch 6/28

33/33 [==============================] - 1s 33ms/step - loss: 0.4339 - acc: 0.8586
Epoch 7/28

33/33 [==============================] - 1s 33ms/step - loss: 0.4168 - acc: 0.8673
Epoch 8/28

33/33 [==============================] - 1s 33ms/step - loss: 0.3616 - acc: 0.9066
Epoch 9/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3393 - acc: 0.8974
Epoch 10/28

33/33 [==============================] - 1s 33ms/step - loss: 0.3384 - acc: 0.9011
Epoch 11/28

33/33 [==============================] - 1s 32ms/step - loss: 0.3096 - acc: 0.9070
Epoch 12/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2859 - acc: 0.9210
Epoch 13/28

33/33 [==============================] - 1s 33ms/step - loss: 0.3011 - acc: 0.9190
Epoch 14/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2511 - acc: 0.9334
Epoch 15/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2517 - acc: 0.9284
Epoch 16/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2362 - acc: 0.9228
Epoch 17/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2237 - acc: 0.9410
Epoch 18/28

33/33 [==============================] - 1s 33ms/step - loss: 0.2185 - acc: 0.9419
Epoch 19/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2237 - acc: 0.9284
Epoch 20/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2041 - acc: 0.9490
Epoch 21/28

33/33 [==============================] - 1s 32ms/step - loss: 0.2009 - acc: 0.9452
Epoch 22/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1892 - acc: 0.9523
Epoch 23/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1955 - acc: 0.9557
Epoch 24/28

33/33 [==============================] - 1s 33ms/step - loss: 0.1724 - acc: 0.9693
Epoch 25/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1620 - acc: 0.9647
Epoch 26/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1535 - acc: 0.9732
Epoch 27/28

33/33 [==============================] - 1s 32ms/step - loss: 0.1484 - acc: 0.9664
Epoch 28/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1434 - acc: 0.9709
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7342
False 1729
True percentage 0.809392569728
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.64      0.30      0.41       438
      I-PER       0.00      0.00      0.00       214
          O       0.97      0.94      0.95      7318
      B-ORG       0.35      0.51      0.42       296
      B-LOC       0.42      0.29      0.34       218
      I-ORG       0.14      0.34      0.20       151
      I-LOC       0.27      0.22      0.24       141
     B-MISC       0.25      0.08      0.12       141
     I-MISC       0.21      0.14      0.17       154

avg / total       0.85      0.81      0.82      9071

F-1 Score (without O):
0.850067802606
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 7 unique labels.
Found 104057 unique words.
4053 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659712     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 8)        1112        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,544
Trainable params: 6,771,544
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 3s 185ms/step - loss: 2.3272 - acc: 0.1236
Epoch 2/28

16/16 [==============================] - 0s 28ms/step - loss: 0.8554 - acc: 0.8427
Epoch 3/28

16/16 [==============================] - 0s 27ms/step - loss: 0.4986 - acc: 0.8455
Epoch 4/28

16/16 [==============================] - 0s 26ms/step - loss: 0.4197 - acc: 0.8989
Epoch 5/28

16/16 [==============================] - 0s 26ms/step - loss: 0.5358 - acc: 0.8511
Epoch 6/28

16/16 [==============================] - 0s 27ms/step - loss: 0.4350 - acc: 0.8876
Epoch 7/28

16/16 [==============================] - 0s 25ms/step - loss: 0.2895 - acc: 0.9101
Epoch 8/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2498 - acc: 0.9326
Epoch 9/28

16/16 [==============================] - 0s 25ms/step - loss: 0.2307 - acc: 0.9438
Epoch 10/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2146 - acc: 0.9494
Epoch 11/28

16/16 [==============================] - 0s 25ms/step - loss: 0.1942 - acc: 0.9579
Epoch 12/28

16/16 [==============================] - 0s 25ms/step - loss: 0.1863 - acc: 0.9719
Epoch 13/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1692 - acc: 0.9635
Epoch 14/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1650 - acc: 0.9579
Epoch 15/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1508 - acc: 0.9635
Epoch 16/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1412 - acc: 0.9691
Epoch 17/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1225 - acc: 0.9747
Epoch 18/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1234 - acc: 0.9747
Epoch 19/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1211 - acc: 0.9775
Epoch 20/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1135 - acc: 0.9803
Epoch 21/28

16/16 [==============================] - 0s 26ms/step - loss: 0.0918 - acc: 0.9831
Epoch 22/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1059 - acc: 0.9775
Epoch 23/28

16/16 [==============================] - 0s 27ms/step - loss: 0.0980 - acc: 0.9860
Epoch 24/28

16/16 [==============================] - 0s 26ms/step - loss: 0.0887 - acc: 0.9775
Epoch 25/28

16/16 [==============================] - 0s 26ms/step - loss: 0.0872 - acc: 0.9860
Epoch 26/28

16/16 [==============================] - 0s 26ms/step - loss: 0.0748 - acc: 0.9888
Epoch 27/28

16/16 [==============================] - 0s 25ms/step - loss: 0.0728 - acc: 0.9888
Epoch 28/28

16/16 [==============================] - 0s 25ms/step - loss: 0.0687 - acc: 0.9860
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7163
False 1613
True percentage 0.816203281677
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.93      0.94      7318
      B-PER       0.58      0.28      0.38       438
      B-ORG       0.23      0.45      0.30       296
      I-ORG       0.13      0.40      0.20       151
      I-PER       0.48      0.14      0.22       214
      B-LOC       0.00      0.00      0.00       218
     B-MISC       0.00      0.00      0.00       141

avg / total       0.84      0.82      0.82      8776

F-1 Score (without O):
0.250269687163
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 8 unique labels.
Found 104063 unique words.
4059 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 281
OOV word occurences: in test 556
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660096     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,076
Trainable params: 6,772,076
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 3s 187ms/step - loss: 2.6145 - acc: 0.0648
Epoch 2/28

16/16 [==============================] - 0s 29ms/step - loss: 1.1003 - acc: 0.7809
Epoch 3/28

16/16 [==============================] - 0s 27ms/step - loss: 0.7493 - acc: 0.7901
Epoch 4/28

16/16 [==============================] - 0s 27ms/step - loss: 0.7044 - acc: 0.8210
Epoch 5/28

16/16 [==============================] - 0s 27ms/step - loss: 0.8296 - acc: 0.7901
Epoch 6/28

16/16 [==============================] - 0s 26ms/step - loss: 0.5916 - acc: 0.8488
Epoch 7/28

16/16 [==============================] - 0s 26ms/step - loss: 0.4866 - acc: 0.8148
Epoch 8/28

16/16 [==============================] - 0s 26ms/step - loss: 0.4403 - acc: 0.8796
Epoch 9/28

16/16 [==============================] - 0s 26ms/step - loss: 0.4068 - acc: 0.8735
Epoch 10/28

16/16 [==============================] - 0s 26ms/step - loss: 0.3957 - acc: 0.8642
Epoch 11/28

16/16 [==============================] - 0s 26ms/step - loss: 0.3567 - acc: 0.9136
Epoch 12/28

16/16 [==============================] - 0s 26ms/step - loss: 0.3389 - acc: 0.8920
Epoch 13/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3258 - acc: 0.9259
Epoch 14/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2901 - acc: 0.9228
Epoch 15/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2895 - acc: 0.9506
Epoch 16/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2457 - acc: 0.9537
Epoch 17/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2486 - acc: 0.9599
Epoch 18/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2437 - acc: 0.9414
Epoch 19/28

16/16 [==============================] - 0s 25ms/step - loss: 0.2420 - acc: 0.9630
Epoch 20/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2101 - acc: 0.9599
Epoch 21/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1985 - acc: 0.9568
Epoch 22/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1953 - acc: 0.9722
Epoch 23/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1746 - acc: 0.9722
Epoch 24/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1629 - acc: 0.9877
Epoch 25/28

16/16 [==============================] - 0s 25ms/step - loss: 0.1554 - acc: 0.9938
Epoch 26/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1479 - acc: 0.9907
Epoch 27/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1549 - acc: 0.9815
Epoch 28/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1443 - acc: 0.9846
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7309
False 1608
True percentage 0.819670292699
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.94      0.94      7318
      B-ORG       0.41      0.25      0.31       296
      I-ORG       0.00      0.00      0.00       151
      B-PER       0.42      0.44      0.43       438
      B-LOC       0.42      0.44      0.43       218
      I-LOC       0.28      0.43      0.34       141
      I-PER       0.33      0.12      0.18       214
     B-MISC       0.00      0.00      0.00       141

avg / total       0.82      0.82      0.82      8917

F-1 Score (without O):
0.324441240087
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104046 unique words.
4042 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659008     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,138
Trainable params: 6,771,138
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 3s 216ms/step - loss: 2.4641 - acc: 0.2147
Epoch 2/28

16/16 [==============================] - 0s 28ms/step - loss: 0.9673 - acc: 0.8294
Epoch 3/28

16/16 [==============================] - 0s 28ms/step - loss: 0.6513 - acc: 0.8265
Epoch 4/28

16/16 [==============================] - 0s 28ms/step - loss: 0.6186 - acc: 0.8706
Epoch 5/28

16/16 [==============================] - 0s 27ms/step - loss: 0.5509 - acc: 0.8265
Epoch 6/28

16/16 [==============================] - 0s 26ms/step - loss: 0.4364 - acc: 0.9059
Epoch 7/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3700 - acc: 0.8706
Epoch 8/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3283 - acc: 0.9265
Epoch 9/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2920 - acc: 0.9118
Epoch 10/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2731 - acc: 0.9206
Epoch 11/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2569 - acc: 0.9265
Epoch 12/28

16/16 [==============================] - 0s 25ms/step - loss: 0.2333 - acc: 0.9500
Epoch 13/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2214 - acc: 0.9618
Epoch 14/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2078 - acc: 0.9471
Epoch 15/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2146 - acc: 0.9647
Epoch 16/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1838 - acc: 0.9559
Epoch 17/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1641 - acc: 0.9765
Epoch 18/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1605 - acc: 0.9676
Epoch 19/28

16/16 [==============================] - 0s 25ms/step - loss: 0.1430 - acc: 0.9824
Epoch 20/28

16/16 [==============================] - 0s 25ms/step - loss: 0.1387 - acc: 0.9794
Epoch 21/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1248 - acc: 0.9853
Epoch 22/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1297 - acc: 0.9824
Epoch 23/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1079 - acc: 0.9882
Epoch 24/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1054 - acc: 0.9853
Epoch 25/28

16/16 [==============================] - 0s 25ms/step - loss: 0.1036 - acc: 0.9912
Epoch 26/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1051 - acc: 0.9853
Epoch 27/28

16/16 [==============================] - 0s 26ms/step - loss: 0.0880 - acc: 0.9971
Epoch 28/28

16/16 [==============================] - 0s 27ms/step - loss: 0.0853 - acc: 0.9882
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7165
False 1906
True percentage 0.789879836843
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.92      0.94      7318
      B-PER       0.34      0.31      0.32       438
      B-ORG       0.29      0.41      0.34       296
      I-ORG       0.12      0.09      0.10       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      I-PER       0.25      0.46      0.32       214
      B-LOC       0.65      0.23      0.34       218
      I-LOC       0.50      0.01      0.01       141

avg / total       0.82      0.79      0.80      9071

F-1 Score (without O):
0.266412940057
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104060 unique words.
4056 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 567
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659904     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,034
Trainable params: 6,772,034
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 3s 185ms/step - loss: 2.5860 - acc: 0.0143
Epoch 2/28

16/16 [==============================] - 0s 28ms/step - loss: 1.0367 - acc: 0.7743
Epoch 3/28

16/16 [==============================] - 0s 27ms/step - loss: 0.7931 - acc: 0.7625
Epoch 4/28

16/16 [==============================] - 0s 26ms/step - loss: 0.8002 - acc: 0.8337
Epoch 5/28

16/16 [==============================] - 0s 26ms/step - loss: 0.5497 - acc: 0.8290
Epoch 6/28

16/16 [==============================] - 0s 26ms/step - loss: 0.4837 - acc: 0.8860
Epoch 7/28

16/16 [==============================] - 0s 26ms/step - loss: 0.4402 - acc: 0.8955
Epoch 8/28

16/16 [==============================] - 0s 26ms/step - loss: 0.3909 - acc: 0.9026
Epoch 9/28

16/16 [==============================] - 0s 26ms/step - loss: 0.3701 - acc: 0.9192
Epoch 10/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3398 - acc: 0.9216
Epoch 11/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3067 - acc: 0.9382
Epoch 12/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2924 - acc: 0.9287
Epoch 13/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2643 - acc: 0.9335
Epoch 14/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2652 - acc: 0.9406
Epoch 15/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2483 - acc: 0.9454
Epoch 16/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2238 - acc: 0.9596
Epoch 17/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2024 - acc: 0.9477
Epoch 18/28

16/16 [==============================] - 0s 25ms/step - loss: 0.1915 - acc: 0.9620
Epoch 19/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1761 - acc: 0.9644
Epoch 20/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1761 - acc: 0.9691
Epoch 21/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1555 - acc: 0.9667
Epoch 22/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1462 - acc: 0.9762
Epoch 23/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1343 - acc: 0.9739
Epoch 24/28

16/16 [==============================] - 0s 25ms/step - loss: 0.1196 - acc: 0.9857
Epoch 25/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1309 - acc: 0.9834
Epoch 26/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1224 - acc: 0.9810
Epoch 27/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1123 - acc: 0.9857
Epoch 28/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1061 - acc: 0.9834
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7327
False 1744
True percentage 0.807738948297
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.94      0.95      7318
      B-ORG       0.34      0.32      0.33       296
      B-PER       0.43      0.33      0.38       438
      I-PER       0.45      0.25      0.32       214
      B-LOC       0.66      0.40      0.50       218
      I-LOC       0.09      0.01      0.01       141
      I-ORG       0.15      0.34      0.21       151
     B-MISC       0.31      0.08      0.12       141
     I-MISC       0.20      0.02      0.04       154

avg / total       0.84      0.81      0.82      9071

F-1 Score (without O):
0.296150049358
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104056 unique words.
4052 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 567
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659648     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,778
Trainable params: 6,771,778
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 3s 188ms/step - loss: 2.4432 - acc: 0.1293
Epoch 2/28

16/16 [==============================] - 0s 28ms/step - loss: 0.8128 - acc: 0.8448
Epoch 3/28

16/16 [==============================] - 0s 27ms/step - loss: 0.5805 - acc: 0.8534
Epoch 4/28

16/16 [==============================] - 0s 26ms/step - loss: 0.5334 - acc: 0.8534
Epoch 5/28

16/16 [==============================] - 0s 26ms/step - loss: 0.6455 - acc: 0.8649
Epoch 6/28

16/16 [==============================] - 0s 26ms/step - loss: 0.5173 - acc: 0.8534
Epoch 7/28

16/16 [==============================] - 0s 26ms/step - loss: 0.3733 - acc: 0.8736
Epoch 8/28

16/16 [==============================] - 0s 26ms/step - loss: 0.3335 - acc: 0.8879
Epoch 9/28

16/16 [==============================] - 0s 26ms/step - loss: 0.3325 - acc: 0.9052
Epoch 10/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3003 - acc: 0.9080
Epoch 11/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2698 - acc: 0.9224
Epoch 12/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2541 - acc: 0.9368
Epoch 13/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2449 - acc: 0.9339
Epoch 14/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2318 - acc: 0.9483
Epoch 15/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2177 - acc: 0.9598
Epoch 16/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2066 - acc: 0.9655
Epoch 17/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1945 - acc: 0.9540
Epoch 18/28

16/16 [==============================] - 0s 25ms/step - loss: 0.1838 - acc: 0.9741
Epoch 19/28

16/16 [==============================] - 0s 25ms/step - loss: 0.1762 - acc: 0.9626
Epoch 20/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1648 - acc: 0.9741
Epoch 21/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1655 - acc: 0.9569
Epoch 22/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1522 - acc: 0.9885
Epoch 23/28

16/16 [==============================] - 0s 25ms/step - loss: 0.1352 - acc: 0.9799
Epoch 24/28

16/16 [==============================] - 0s 25ms/step - loss: 0.1354 - acc: 0.9799
Epoch 25/28

16/16 [==============================] - 0s 25ms/step - loss: 0.1337 - acc: 0.9713
Epoch 26/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1151 - acc: 0.9828
Epoch 27/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1161 - acc: 0.9856
Epoch 28/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1117 - acc: 0.9914
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7214
False 1857
True percentage 0.79528166685
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.39      0.19      0.26       438
          O       0.91      0.95      0.93      7318
      B-ORG       0.36      0.28      0.32       296
     B-MISC       0.17      0.12      0.14       141
      I-ORG       0.00      0.00      0.00       151
      I-PER       0.36      0.20      0.25       214
     I-MISC       0.21      0.16      0.18       154
      B-LOC       0.13      0.03      0.05       218
      I-LOC       0.38      0.06      0.10       141

avg / total       0.79      0.80      0.79      9071

F-1 Score (without O):
0.842689989363
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104047 unique words.
4043 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659072     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,202
Trainable params: 6,771,202
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 3s 185ms/step - loss: 2.5587 - acc: 0.0723
Epoch 2/28

16/16 [==============================] - 0s 29ms/step - loss: 1.1616 - acc: 0.7327
Epoch 3/28

16/16 [==============================] - 0s 27ms/step - loss: 0.6645 - acc: 0.7987
Epoch 4/28

16/16 [==============================] - 0s 26ms/step - loss: 0.6321 - acc: 0.8365
Epoch 5/28

16/16 [==============================] - 0s 25ms/step - loss: 0.6888 - acc: 0.7987
Epoch 6/28

16/16 [==============================] - 0s 26ms/step - loss: 0.5448 - acc: 0.8868
Epoch 7/28

16/16 [==============================] - 0s 26ms/step - loss: 0.4152 - acc: 0.8805
Epoch 8/28

16/16 [==============================] - 0s 25ms/step - loss: 0.3800 - acc: 0.9025
Epoch 9/28

16/16 [==============================] - 0s 25ms/step - loss: 0.3495 - acc: 0.9088
Epoch 10/28

16/16 [==============================] - 0s 26ms/step - loss: 0.3107 - acc: 0.9340
Epoch 11/28

16/16 [==============================] - 0s 26ms/step - loss: 0.3032 - acc: 0.9308
Epoch 12/28

16/16 [==============================] - 0s 25ms/step - loss: 0.2631 - acc: 0.9340
Epoch 13/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2553 - acc: 0.9434
Epoch 14/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2461 - acc: 0.9528
Epoch 15/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2284 - acc: 0.9434
Epoch 16/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2152 - acc: 0.9591
Epoch 17/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2054 - acc: 0.9528
Epoch 18/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1991 - acc: 0.9591
Epoch 19/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1882 - acc: 0.9560
Epoch 20/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1813 - acc: 0.9717
Epoch 21/28

16/16 [==============================] - 0s 25ms/step - loss: 0.1684 - acc: 0.9717
Epoch 22/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1616 - acc: 0.9686
Epoch 23/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1425 - acc: 0.9780
Epoch 24/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1574 - acc: 0.9748
Epoch 25/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1363 - acc: 0.9811
Epoch 26/28

16/16 [==============================] - 0s 25ms/step - loss: 0.1307 - acc: 0.9717
Epoch 27/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1129 - acc: 0.9843
Epoch 28/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1290 - acc: 0.9717
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7120
False 1951
True percentage 0.78491897255
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.92      0.93      7318
      B-PER       0.59      0.15      0.23       438
      B-ORG       0.27      0.45      0.33       296
      I-ORG       0.13      0.39      0.19       151
      B-LOC       0.34      0.30      0.32       218
      I-PER       0.56      0.14      0.23       214
     B-MISC       0.00      0.00      0.00       141
      I-LOC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.82      0.78      0.79      9071

F-1 Score (without O):
0.22844126261
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104048 unique words.
4044 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659136     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,266
Trainable params: 6,771,266
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 3s 186ms/step - loss: 2.1705 - acc: 0.2587
Epoch 2/28

16/16 [==============================] - 0s 28ms/step - loss: 0.9472 - acc: 0.7855
Epoch 3/28

16/16 [==============================] - 0s 26ms/step - loss: 0.7143 - acc: 0.7886
Epoch 4/28

16/16 [==============================] - 0s 26ms/step - loss: 0.6674 - acc: 0.7855
Epoch 5/28

16/16 [==============================] - 0s 27ms/step - loss: 0.7817 - acc: 0.8612
Epoch 6/28

16/16 [==============================] - 0s 26ms/step - loss: 0.5716 - acc: 0.7855
Epoch 7/28

16/16 [==============================] - 0s 26ms/step - loss: 0.4424 - acc: 0.8959
Epoch 8/28

16/16 [==============================] - 0s 25ms/step - loss: 0.3937 - acc: 0.9085
Epoch 9/28

16/16 [==============================] - 0s 26ms/step - loss: 0.3718 - acc: 0.9117
Epoch 10/28

16/16 [==============================] - 0s 26ms/step - loss: 0.3548 - acc: 0.9117
Epoch 11/28

16/16 [==============================] - 0s 25ms/step - loss: 0.3126 - acc: 0.9495
Epoch 12/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2867 - acc: 0.9401
Epoch 13/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2861 - acc: 0.9590
Epoch 14/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2684 - acc: 0.9464
Epoch 15/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2433 - acc: 0.9653
Epoch 16/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2337 - acc: 0.9590
Epoch 17/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2121 - acc: 0.9653
Epoch 18/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2069 - acc: 0.9716
Epoch 19/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1869 - acc: 0.9653
Epoch 20/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1854 - acc: 0.9685
Epoch 21/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1657 - acc: 0.9811
Epoch 22/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1634 - acc: 0.9716
Epoch 23/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1572 - acc: 0.9779
Epoch 24/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1445 - acc: 0.9779
Epoch 25/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1415 - acc: 0.9842
Epoch 26/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1370 - acc: 0.9685
Epoch 27/28

16/16 [==============================] - 0s 25ms/step - loss: 0.1258 - acc: 0.9842
Epoch 28/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1200 - acc: 0.9905
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7222
False 1849
True percentage 0.79616359828
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.93      0.93      7318
      B-PER       0.49      0.28      0.36       438
      I-PER       0.50      0.12      0.20       214
      B-ORG       0.26      0.37      0.30       296
      I-ORG       0.14      0.28      0.19       151
      B-LOC       0.50      0.47      0.48       218
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      I-LOC       0.49      0.33      0.40       141

avg / total       0.83      0.80      0.81      9071

F-1 Score (without O):
0.292492687683
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104057 unique words.
4053 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 281
OOV word occurences: in test 492
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659712     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,842
Trainable params: 6,771,842
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 3s 183ms/step - loss: 2.2621 - acc: 0.1233
Epoch 2/28

16/16 [==============================] - 0s 28ms/step - loss: 0.8926 - acc: 0.7863
Epoch 3/28

16/16 [==============================] - 0s 27ms/step - loss: 0.6941 - acc: 0.7918
Epoch 4/28

16/16 [==============================] - 0s 26ms/step - loss: 0.8842 - acc: 0.7836
Epoch 5/28

16/16 [==============================] - 0s 27ms/step - loss: 0.8831 - acc: 0.7890
Epoch 6/28

16/16 [==============================] - 0s 26ms/step - loss: 0.5284 - acc: 0.8247
Epoch 7/28

16/16 [==============================] - 0s 26ms/step - loss: 0.4823 - acc: 0.8493
Epoch 8/28

16/16 [==============================] - 0s 26ms/step - loss: 0.4282 - acc: 0.8603
Epoch 9/28

16/16 [==============================] - 0s 26ms/step - loss: 0.4156 - acc: 0.8658
Epoch 10/28

16/16 [==============================] - 0s 26ms/step - loss: 0.3918 - acc: 0.8877
Epoch 11/28

16/16 [==============================] - 0s 26ms/step - loss: 0.3750 - acc: 0.8849
Epoch 12/28

16/16 [==============================] - 0s 26ms/step - loss: 0.3451 - acc: 0.8986
Epoch 13/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3200 - acc: 0.9068
Epoch 14/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3116 - acc: 0.9315
Epoch 15/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2862 - acc: 0.9288
Epoch 16/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2661 - acc: 0.9425
Epoch 17/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2551 - acc: 0.9479
Epoch 18/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2511 - acc: 0.9562
Epoch 19/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2310 - acc: 0.9507
Epoch 20/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2161 - acc: 0.9589
Epoch 21/28

16/16 [==============================] - 0s 25ms/step - loss: 0.2069 - acc: 0.9616
Epoch 22/28

16/16 [==============================] - 0s 25ms/step - loss: 0.1913 - acc: 0.9671
Epoch 23/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1856 - acc: 0.9753
Epoch 24/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1657 - acc: 0.9836
Epoch 25/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1620 - acc: 0.9699
Epoch 26/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1502 - acc: 0.9836
Epoch 27/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1468 - acc: 0.9781
Epoch 28/28

16/16 [==============================] - 0s 25ms/step - loss: 0.1457 - acc: 0.9836
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7136
False 1935
True percentage 0.78668283541
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.92      0.94      7318
     B-MISC       0.14      0.26      0.18       141
     I-MISC       0.05      0.01      0.02       154
      B-ORG       0.21      0.30      0.25       296
      B-LOC       0.74      0.25      0.38       218
      B-PER       0.75      0.29      0.42       438
      I-PER       0.56      0.05      0.09       214
      I-ORG       0.12      0.36      0.17       151
      I-LOC       0.00      0.00      0.00       141

avg / total       0.85      0.79      0.80      9071

F-1 Score (without O):
0.23265940902
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104046 unique words.
4042 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659008     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,138
Trainable params: 6,771,138
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 3s 183ms/step - loss: 2.1125 - acc: 0.2981
Epoch 2/28

16/16 [==============================] - 0s 29ms/step - loss: 0.8426 - acc: 0.8173
Epoch 3/28

16/16 [==============================] - 0s 26ms/step - loss: 0.6561 - acc: 0.8590
Epoch 4/28

16/16 [==============================] - 0s 26ms/step - loss: 0.7118 - acc: 0.8173
Epoch 5/28

16/16 [==============================] - 0s 27ms/step - loss: 0.5398 - acc: 0.8910
Epoch 6/28

16/16 [==============================] - 0s 27ms/step - loss: 0.4388 - acc: 0.8526
Epoch 7/28

16/16 [==============================] - 0s 26ms/step - loss: 0.3938 - acc: 0.8910
Epoch 8/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3628 - acc: 0.8878
Epoch 9/28

16/16 [==============================] - 0s 29ms/step - loss: 0.3404 - acc: 0.9199
Epoch 10/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3006 - acc: 0.9071
Epoch 11/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2832 - acc: 0.9327
Epoch 12/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2691 - acc: 0.9359
Epoch 13/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2486 - acc: 0.9487
Epoch 14/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2248 - acc: 0.9455
Epoch 15/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2111 - acc: 0.9583
Epoch 16/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2047 - acc: 0.9551
Epoch 17/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1846 - acc: 0.9744
Epoch 18/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1829 - acc: 0.9744
Epoch 19/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1717 - acc: 0.9647
Epoch 20/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1564 - acc: 0.9808
Epoch 21/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1428 - acc: 0.9872
Epoch 22/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1360 - acc: 0.9744
Epoch 23/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1345 - acc: 0.9840
Epoch 24/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1235 - acc: 0.9840
Epoch 25/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1118 - acc: 0.9904
Epoch 26/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1077 - acc: 0.9872
Epoch 27/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1068 - acc: 0.9936
Epoch 28/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1076 - acc: 0.9872
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7214
False 1857
True percentage 0.79528166685
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.68      0.25      0.36       438
      I-PER       0.00      0.00      0.00       214
          O       0.97      0.92      0.94      7318
      B-ORG       0.27      0.45      0.34       296
      B-LOC       0.45      0.46      0.46       218
      I-ORG       0.14      0.54      0.23       151
      I-LOC       0.52      0.34      0.41       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.10      0.01      0.01       154

avg / total       0.85      0.80      0.81      9071

F-1 Score (without O):
0.837181903864
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 6 unique labels.
Found 104044 unique words.
4040 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658880     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 7)        966         bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,566
Trainable params: 6,770,566
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 3s 345ms/step - loss: 1.8306 - acc: 0.2707
Epoch 2/28

8/8 [==============================] - 0s 42ms/step - loss: 0.6690 - acc: 0.8729
Epoch 3/28

8/8 [==============================] - 0s 40ms/step - loss: 0.4292 - acc: 0.8785
Epoch 4/28

8/8 [==============================] - 0s 39ms/step - loss: 0.3343 - acc: 0.9006
Epoch 5/28

8/8 [==============================] - 0s 40ms/step - loss: 0.2523 - acc: 0.9282
Epoch 6/28

8/8 [==============================] - 0s 38ms/step - loss: 0.2303 - acc: 0.9171
Epoch 7/28

8/8 [==============================] - 0s 40ms/step - loss: 0.2011 - acc: 0.9613
Epoch 8/28

8/8 [==============================] - 0s 39ms/step - loss: 0.1711 - acc: 0.9337
Epoch 9/28

8/8 [==============================] - 0s 39ms/step - loss: 0.1424 - acc: 0.9724
Epoch 10/28

8/8 [==============================] - 0s 38ms/step - loss: 0.1286 - acc: 0.9724
Epoch 11/28

8/8 [==============================] - 0s 39ms/step - loss: 0.1061 - acc: 0.9834
Epoch 12/28

8/8 [==============================] - 0s 37ms/step - loss: 0.0989 - acc: 0.9834
Epoch 13/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0901 - acc: 0.9834
Epoch 14/28

8/8 [==============================] - 0s 41ms/step - loss: 0.0748 - acc: 0.9834
Epoch 15/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0750 - acc: 0.9890
Epoch 16/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0666 - acc: 0.9834
Epoch 17/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0690 - acc: 0.9834
Epoch 18/28

8/8 [==============================] - 0s 40ms/step - loss: 0.0485 - acc: 0.9945
Epoch 19/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0586 - acc: 0.9890
Epoch 20/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0448 - acc: 0.9945
Epoch 21/28

8/8 [==============================] - 0s 37ms/step - loss: 0.0429 - acc: 1.0000
Epoch 22/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0459 - acc: 0.9945
Epoch 23/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0364 - acc: 0.9945
Epoch 24/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0293 - acc: 1.0000
Epoch 25/28

8/8 [==============================] - 0s 42ms/step - loss: 0.0303 - acc: 1.0000
Epoch 26/28

8/8 [==============================] - 0s 40ms/step - loss: 0.0330 - acc: 0.9945
Epoch 27/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0285 - acc: 1.0000
Epoch 28/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0283 - acc: 0.9945
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7201
False 1434
True percentage 0.833931673422
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.93      0.93      7318
      B-PER       0.31      0.44      0.36       438
      B-ORG       0.45      0.31      0.37       296
      I-ORG       0.22      0.05      0.09       151
      I-PER       0.28      0.41      0.34       214
      B-LOC       0.00      0.00      0.00       218

avg / total       0.83      0.83      0.83      8635

F-1 Score (without O):
0.306393244873
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 8 unique labels.
Found 104042 unique words.
4038 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658752     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,732
Trainable params: 6,770,732
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 3s 351ms/step - loss: 2.0841 - acc: 0.1408
Epoch 2/28

8/8 [==============================] - 0s 41ms/step - loss: 0.7147 - acc: 0.8592
Epoch 3/28

8/8 [==============================] - 0s 41ms/step - loss: 0.4689 - acc: 0.8592
Epoch 4/28

8/8 [==============================] - 0s 41ms/step - loss: 0.3604 - acc: 0.9225
Epoch 5/28

8/8 [==============================] - 0s 38ms/step - loss: 0.3645 - acc: 0.8662
Epoch 6/28

8/8 [==============================] - 0s 39ms/step - loss: 0.3383 - acc: 0.9507
Epoch 7/28

8/8 [==============================] - 0s 39ms/step - loss: 0.2281 - acc: 0.9366
Epoch 8/28

8/8 [==============================] - 0s 38ms/step - loss: 0.2007 - acc: 0.9577
Epoch 9/28

8/8 [==============================] - 0s 38ms/step - loss: 0.1742 - acc: 0.9789
Epoch 10/28

8/8 [==============================] - 0s 38ms/step - loss: 0.1556 - acc: 0.9789
Epoch 11/28

8/8 [==============================] - 0s 38ms/step - loss: 0.1351 - acc: 0.9859
Epoch 12/28

8/8 [==============================] - 0s 37ms/step - loss: 0.1293 - acc: 0.9789
Epoch 13/28

8/8 [==============================] - 0s 38ms/step - loss: 0.1066 - acc: 0.9859
Epoch 14/28

8/8 [==============================] - 0s 36ms/step - loss: 0.1022 - acc: 0.9859
Epoch 15/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0894 - acc: 1.0000
Epoch 16/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0733 - acc: 0.9930
Epoch 17/28

8/8 [==============================] - 0s 40ms/step - loss: 0.0774 - acc: 0.9930
Epoch 18/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0769 - acc: 1.0000
Epoch 19/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0612 - acc: 0.9930
Epoch 20/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0603 - acc: 0.9930
Epoch 21/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0612 - acc: 1.0000
Epoch 22/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0547 - acc: 1.0000
Epoch 23/28

8/8 [==============================] - 0s 42ms/step - loss: 0.0491 - acc: 0.9930
Epoch 24/28

8/8 [==============================] - 0s 41ms/step - loss: 0.0520 - acc: 1.0000
Epoch 25/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0428 - acc: 1.0000
Epoch 26/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0397 - acc: 1.0000
Epoch 27/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0420 - acc: 1.0000
Epoch 28/28

8/8 [==============================] - 0s 37ms/step - loss: 0.0356 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7013
False 1904
True percentage 0.786475271952
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.92      0.93      0.92      7318
      B-ORG       0.16      0.25      0.19       296
      I-ORG       0.16      0.16      0.16       151
      B-PER       0.26      0.26      0.26       438
      B-LOC       0.29      0.06      0.09       218
      I-LOC       0.38      0.04      0.08       141
      I-PER       0.38      0.01      0.03       214
     B-MISC       0.00      0.00      0.00       141

avg / total       0.80      0.79      0.78      8917

F-1 Score (without O):
0.171532846715
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104041 unique words.
4037 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658688     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,818
Trainable params: 6,770,818
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 3s 353ms/step - loss: 2.3892 - acc: 0.0751
Epoch 2/28

8/8 [==============================] - 0s 41ms/step - loss: 0.8629 - acc: 0.8208
Epoch 3/28

8/8 [==============================] - 0s 41ms/step - loss: 0.6155 - acc: 0.8208
Epoch 4/28

8/8 [==============================] - 0s 40ms/step - loss: 0.5583 - acc: 0.8960
Epoch 5/28

8/8 [==============================] - 0s 39ms/step - loss: 0.6354 - acc: 0.8208
Epoch 6/28

8/8 [==============================] - 0s 38ms/step - loss: 0.4602 - acc: 0.8844
Epoch 7/28

8/8 [==============================] - 0s 39ms/step - loss: 0.3666 - acc: 0.8844
Epoch 8/28

8/8 [==============================] - 0s 37ms/step - loss: 0.3357 - acc: 0.8786
Epoch 9/28

8/8 [==============================] - 0s 37ms/step - loss: 0.2861 - acc: 0.9133
Epoch 10/28

8/8 [==============================] - 0s 39ms/step - loss: 0.2735 - acc: 0.9133
Epoch 11/28

8/8 [==============================] - 0s 38ms/step - loss: 0.2405 - acc: 0.9306
Epoch 12/28

8/8 [==============================] - 0s 38ms/step - loss: 0.2440 - acc: 0.9191
Epoch 13/28

8/8 [==============================] - 0s 38ms/step - loss: 0.2180 - acc: 0.9480
Epoch 14/28

8/8 [==============================] - 0s 37ms/step - loss: 0.1954 - acc: 0.9595
Epoch 15/28

8/8 [==============================] - 0s 37ms/step - loss: 0.1788 - acc: 0.9769
Epoch 16/28

8/8 [==============================] - 0s 38ms/step - loss: 0.1637 - acc: 0.9769
Epoch 17/28

8/8 [==============================] - 0s 39ms/step - loss: 0.1506 - acc: 0.9827
Epoch 18/28

8/8 [==============================] - 0s 40ms/step - loss: 0.1288 - acc: 0.9769
Epoch 19/28

8/8 [==============================] - 0s 39ms/step - loss: 0.1454 - acc: 0.9711
Epoch 20/28

8/8 [==============================] - 0s 37ms/step - loss: 0.1286 - acc: 0.9942
Epoch 21/28

8/8 [==============================] - 0s 37ms/step - loss: 0.1171 - acc: 0.9884
Epoch 22/28

8/8 [==============================] - 0s 37ms/step - loss: 0.1018 - acc: 1.0000
Epoch 23/28

8/8 [==============================] - 0s 39ms/step - loss: 0.1019 - acc: 1.0000
Epoch 24/28

8/8 [==============================] - 0s 41ms/step - loss: 0.0989 - acc: 1.0000
Epoch 25/28

8/8 [==============================] - 0s 41ms/step - loss: 0.0942 - acc: 1.0000
Epoch 26/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0814 - acc: 1.0000
Epoch 27/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0768 - acc: 1.0000
Epoch 28/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0709 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7119
False 1952
True percentage 0.784808731121
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.91      0.93      0.92      7318
      B-PER       0.33      0.28      0.30       438
      B-ORG       0.29      0.42      0.34       296
      I-ORG       0.00      0.00      0.00       151
     B-MISC       0.11      0.02      0.04       141
     I-MISC       0.31      0.03      0.06       154
      I-PER       0.27      0.17      0.21       214
      B-LOC       0.33      0.06      0.10       218
      I-LOC       0.75      0.02      0.04       141

avg / total       0.79      0.78      0.78      9071

F-1 Score (without O):
0.221264367816
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104044 unique words.
4040 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 567
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658880     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,010
Trainable params: 6,771,010
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 3s 348ms/step - loss: 2.5562 - acc: 0.0608
Epoch 2/28

8/8 [==============================] - 0s 42ms/step - loss: 1.1842 - acc: 0.7403
Epoch 3/28

8/8 [==============================] - 0s 39ms/step - loss: 0.7546 - acc: 0.7569
Epoch 4/28

8/8 [==============================] - 0s 38ms/step - loss: 0.5877 - acc: 0.8508
Epoch 5/28

8/8 [==============================] - 0s 38ms/step - loss: 0.4722 - acc: 0.8895
Epoch 6/28

8/8 [==============================] - 0s 39ms/step - loss: 0.4329 - acc: 0.9116
Epoch 7/28

8/8 [==============================] - 0s 39ms/step - loss: 0.6777 - acc: 0.8011
Epoch 8/28

8/8 [==============================] - 0s 39ms/step - loss: 0.5793 - acc: 0.8950
Epoch 9/28

8/8 [==============================] - 0s 38ms/step - loss: 0.3239 - acc: 0.9669
Epoch 10/28

8/8 [==============================] - 0s 37ms/step - loss: 0.2939 - acc: 0.9558
Epoch 11/28

8/8 [==============================] - 0s 37ms/step - loss: 0.2886 - acc: 0.9613
Epoch 12/28

8/8 [==============================] - 0s 38ms/step - loss: 0.2410 - acc: 0.9669
Epoch 13/28

8/8 [==============================] - 0s 39ms/step - loss: 0.2164 - acc: 0.9669
Epoch 14/28

8/8 [==============================] - 0s 37ms/step - loss: 0.1933 - acc: 0.9779
Epoch 15/28

8/8 [==============================] - 0s 37ms/step - loss: 0.1809 - acc: 0.9890
Epoch 16/28

8/8 [==============================] - 0s 39ms/step - loss: 0.1732 - acc: 0.9779
Epoch 17/28

8/8 [==============================] - 0s 38ms/step - loss: 0.1427 - acc: 0.9890
Epoch 18/28

8/8 [==============================] - 0s 39ms/step - loss: 0.1322 - acc: 0.9945
Epoch 19/28

8/8 [==============================] - 0s 39ms/step - loss: 0.1355 - acc: 0.9945
Epoch 20/28

8/8 [==============================] - 0s 38ms/step - loss: 0.1113 - acc: 0.9945
Epoch 21/28

8/8 [==============================] - 0s 38ms/step - loss: 0.1112 - acc: 0.9945
Epoch 22/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0964 - acc: 1.0000
Epoch 23/28

8/8 [==============================] - 0s 38ms/step - loss: 0.1072 - acc: 0.9945
Epoch 24/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0908 - acc: 0.9945
Epoch 25/28

8/8 [==============================] - 0s 42ms/step - loss: 0.0812 - acc: 1.0000
Epoch 26/28

8/8 [==============================] - 0s 41ms/step - loss: 0.0671 - acc: 1.0000
Epoch 27/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0773 - acc: 1.0000
Epoch 28/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0745 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7288
False 1783
True percentage 0.803439532576
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.93      0.94      7318
      B-ORG       0.38      0.26      0.31       296
      B-PER       0.47      0.43      0.45       438
      I-PER       0.34      0.33      0.33       214
      B-LOC       0.39      0.42      0.40       218
      I-LOC       0.20      0.01      0.01       141
      I-ORG       0.10      0.12      0.11       151
     B-MISC       0.25      0.05      0.08       141
     I-MISC       0.25      0.03      0.06       154

avg / total       0.83      0.80      0.81      9071

F-1 Score (without O):
0.301687065829
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 6 unique labels.
Found 104044 unique words.
4040 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658880     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 7)        966         bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,566
Trainable params: 6,770,566
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 3s 362ms/step - loss: 2.4036 - acc: 0.1039
Epoch 2/28

8/8 [==============================] - 0s 40ms/step - loss: 0.8674 - acc: 0.8896
Epoch 3/28

8/8 [==============================] - 0s 41ms/step - loss: 0.4547 - acc: 0.9026
Epoch 4/28

8/8 [==============================] - 0s 40ms/step - loss: 0.3490 - acc: 0.9026
Epoch 5/28

8/8 [==============================] - 0s 39ms/step - loss: 0.2766 - acc: 0.9026
Epoch 6/28

8/8 [==============================] - 0s 39ms/step - loss: 0.2730 - acc: 0.9805
Epoch 7/28

8/8 [==============================] - 0s 39ms/step - loss: 0.2264 - acc: 0.9026
Epoch 8/28

8/8 [==============================] - 0s 38ms/step - loss: 0.1800 - acc: 0.9740
Epoch 9/28

8/8 [==============================] - 0s 39ms/step - loss: 0.1523 - acc: 0.9740
Epoch 10/28

8/8 [==============================] - 0s 37ms/step - loss: 0.1327 - acc: 0.9740
Epoch 11/28

8/8 [==============================] - 0s 39ms/step - loss: 0.1124 - acc: 0.9805
Epoch 12/28

8/8 [==============================] - 0s 37ms/step - loss: 0.1089 - acc: 0.9805
Epoch 13/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0925 - acc: 0.9935
Epoch 14/28

8/8 [==============================] - 0s 40ms/step - loss: 0.0848 - acc: 0.9935
Epoch 15/28

8/8 [==============================] - 0s 40ms/step - loss: 0.0789 - acc: 0.9805
Epoch 16/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0746 - acc: 0.9935
Epoch 17/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0654 - acc: 0.9935
Epoch 18/28

8/8 [==============================] - 0s 40ms/step - loss: 0.0533 - acc: 0.9935
Epoch 19/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0523 - acc: 0.9935
Epoch 20/28

8/8 [==============================] - 0s 37ms/step - loss: 0.0547 - acc: 0.9935
Epoch 21/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0505 - acc: 0.9935
Epoch 22/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0472 - acc: 1.0000
Epoch 23/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0398 - acc: 1.0000
Epoch 24/28

8/8 [==============================] - 0s 41ms/step - loss: 0.0374 - acc: 1.0000
Epoch 25/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0331 - acc: 1.0000
Epoch 26/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0360 - acc: 1.0000
Epoch 27/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0286 - acc: 1.0000
Epoch 28/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0348 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7039
False 1519
True percentage 0.822505258238
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.21      0.16      0.18       438
          O       0.89      0.94      0.92      7318
      B-ORG       0.15      0.16      0.15       296
     B-MISC       0.00      0.00      0.00       141
      I-ORG       0.08      0.01      0.01       151
      I-PER       0.16      0.07      0.09       214

avg / total       0.79      0.82      0.80      8558

F-1 Score (without O):
0.855546687949
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 5
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 6 unique labels.
Found 104039 unique words.
4035 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658560     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 7)        966         bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,246
Trainable params: 6,770,246
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 3s 349ms/step - loss: 1.6682 - acc: 0.3019
Epoch 2/28

8/8 [==============================] - 0s 41ms/step - loss: 0.6470 - acc: 0.8365
Epoch 3/28

8/8 [==============================] - 0s 40ms/step - loss: 0.4689 - acc: 0.8742
Epoch 4/28

8/8 [==============================] - 0s 42ms/step - loss: 0.3699 - acc: 0.8679
Epoch 5/28

8/8 [==============================] - 0s 40ms/step - loss: 0.3396 - acc: 0.9497
Epoch 6/28

8/8 [==============================] - 0s 39ms/step - loss: 0.3078 - acc: 0.8868
Epoch 7/28

8/8 [==============================] - 0s 38ms/step - loss: 0.2497 - acc: 0.9434
Epoch 8/28

8/8 [==============================] - 0s 39ms/step - loss: 0.2063 - acc: 0.9560
Epoch 9/28

8/8 [==============================] - 0s 38ms/step - loss: 0.1977 - acc: 0.9623
Epoch 10/28

8/8 [==============================] - 0s 37ms/step - loss: 0.1603 - acc: 0.9811
Epoch 11/28

8/8 [==============================] - 0s 39ms/step - loss: 0.1608 - acc: 0.9748
Epoch 12/28

8/8 [==============================] - 0s 38ms/step - loss: 0.1347 - acc: 0.9748
Epoch 13/28

8/8 [==============================] - 0s 41ms/step - loss: 0.1281 - acc: 0.9811
Epoch 14/28

8/8 [==============================] - 0s 40ms/step - loss: 0.1089 - acc: 0.9874
Epoch 15/28

8/8 [==============================] - 0s 40ms/step - loss: 0.0930 - acc: 0.9874
Epoch 16/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0877 - acc: 1.0000
Epoch 17/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0749 - acc: 1.0000
Epoch 18/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0729 - acc: 0.9874
Epoch 19/28

8/8 [==============================] - 0s 37ms/step - loss: 0.0685 - acc: 1.0000
Epoch 20/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0562 - acc: 1.0000
Epoch 21/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0645 - acc: 1.0000
Epoch 22/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0475 - acc: 1.0000
Epoch 23/28

8/8 [==============================] - 0s 41ms/step - loss: 0.0440 - acc: 1.0000
Epoch 24/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0476 - acc: 1.0000
Epoch 25/28

8/8 [==============================] - 0s 37ms/step - loss: 0.0461 - acc: 1.0000
Epoch 26/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0466 - acc: 1.0000
Epoch 27/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0383 - acc: 1.0000
Epoch 28/28

8/8 [==============================] - 0s 37ms/step - loss: 0.0331 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7039
False 1596
True percentage 0.815170816445
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.92      0.93      7318
      B-PER       0.24      0.24      0.24       438
      B-ORG       0.18      0.21      0.19       296
      I-ORG       0.26      0.12      0.16       151
      B-LOC       0.30      0.16      0.21       218
      I-PER       0.17      0.23      0.20       214

avg / total       0.83      0.82      0.82      8635

F-1 Score (without O):
0.210690596957
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 6
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 8 unique labels.
Found 104043 unique words.
4039 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658816     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,796
Trainable params: 6,770,796
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 3s 356ms/step - loss: 2.1508 - acc: 0.1813
Epoch 2/28

8/8 [==============================] - 0s 41ms/step - loss: 0.8874 - acc: 0.7857
Epoch 3/28

8/8 [==============================] - 0s 41ms/step - loss: 0.6493 - acc: 0.7857
Epoch 4/28

8/8 [==============================] - 0s 40ms/step - loss: 0.5467 - acc: 0.8626
Epoch 5/28

8/8 [==============================] - 0s 41ms/step - loss: 0.9234 - acc: 0.7802
Epoch 6/28

8/8 [==============================] - 0s 39ms/step - loss: 0.5085 - acc: 0.8956
Epoch 7/28

8/8 [==============================] - 0s 38ms/step - loss: 0.4001 - acc: 0.9066
Epoch 8/28

8/8 [==============================] - 0s 39ms/step - loss: 0.3548 - acc: 0.9396
Epoch 9/28

8/8 [==============================] - 0s 37ms/step - loss: 0.3208 - acc: 0.9396
Epoch 10/28

8/8 [==============================] - 0s 39ms/step - loss: 0.2868 - acc: 0.9451
Epoch 11/28

8/8 [==============================] - 0s 38ms/step - loss: 0.2507 - acc: 0.9670
Epoch 12/28

8/8 [==============================] - 0s 40ms/step - loss: 0.2405 - acc: 0.9451
Epoch 13/28

8/8 [==============================] - 0s 39ms/step - loss: 0.2149 - acc: 0.9725
Epoch 14/28

8/8 [==============================] - 0s 39ms/step - loss: 0.2011 - acc: 0.9615
Epoch 15/28

8/8 [==============================] - 0s 37ms/step - loss: 0.1824 - acc: 0.9725
Epoch 16/28

8/8 [==============================] - 0s 38ms/step - loss: 0.1677 - acc: 0.9670
Epoch 17/28

8/8 [==============================] - 0s 38ms/step - loss: 0.1505 - acc: 0.9670
Epoch 18/28

8/8 [==============================] - 0s 41ms/step - loss: 0.1516 - acc: 0.9725
Epoch 19/28

8/8 [==============================] - 0s 40ms/step - loss: 0.1411 - acc: 0.9780
Epoch 20/28

8/8 [==============================] - 0s 39ms/step - loss: 0.1342 - acc: 0.9780
Epoch 21/28

8/8 [==============================] - 0s 37ms/step - loss: 0.1065 - acc: 0.9945
Epoch 22/28

8/8 [==============================] - 0s 37ms/step - loss: 0.1161 - acc: 0.9835
Epoch 23/28

8/8 [==============================] - 0s 38ms/step - loss: 0.1130 - acc: 0.9890
Epoch 24/28

8/8 [==============================] - 0s 37ms/step - loss: 0.0901 - acc: 0.9945
Epoch 25/28

8/8 [==============================] - 0s 37ms/step - loss: 0.0943 - acc: 0.9890
Epoch 26/28

8/8 [==============================] - 0s 41ms/step - loss: 0.0736 - acc: 1.0000
Epoch 27/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0787 - acc: 0.9945
Epoch 28/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0781 - acc: 0.9945
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7006
False 1924
True percentage 0.784546472564
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.92      0.93      7318
      B-PER       0.37      0.22      0.27       438
      I-PER       0.32      0.16      0.22       214
      B-ORG       0.19      0.38      0.25       296
      I-ORG       0.12      0.37      0.18       151
      B-LOC       0.00      0.00      0.00       218
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.81      0.78      0.79      8930

F-1 Score (without O):
0.196775255018
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 8 unique labels.
Found 104049 unique words.
4045 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 500
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659200     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,180
Trainable params: 6,771,180
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 4s 448ms/step - loss: 1.8235 - acc: 0.3804
Epoch 2/28

8/8 [==============================] - 0s 40ms/step - loss: 0.7281 - acc: 0.8370
Epoch 3/28

8/8 [==============================] - 0s 41ms/step - loss: 0.4681 - acc: 0.8587
Epoch 4/28

8/8 [==============================] - 0s 37ms/step - loss: 0.4422 - acc: 0.9022
Epoch 5/28

8/8 [==============================] - 0s 39ms/step - loss: 0.3410 - acc: 0.8750
Epoch 6/28

8/8 [==============================] - 0s 39ms/step - loss: 0.2933 - acc: 0.9348
Epoch 7/28

8/8 [==============================] - 0s 38ms/step - loss: 0.2554 - acc: 0.9076
Epoch 8/28

8/8 [==============================] - 0s 39ms/step - loss: 0.2114 - acc: 0.9457
Epoch 9/28

8/8 [==============================] - 0s 41ms/step - loss: 0.1896 - acc: 0.9457
Epoch 10/28

8/8 [==============================] - 0s 39ms/step - loss: 0.1656 - acc: 0.9728
Epoch 11/28

8/8 [==============================] - 0s 38ms/step - loss: 0.1661 - acc: 0.9728
Epoch 12/28

8/8 [==============================] - 0s 38ms/step - loss: 0.1323 - acc: 0.9783
Epoch 13/28

8/8 [==============================] - 0s 39ms/step - loss: 0.1341 - acc: 0.9891
Epoch 14/28

8/8 [==============================] - 0s 41ms/step - loss: 0.1177 - acc: 0.9837
Epoch 15/28

8/8 [==============================] - 0s 41ms/step - loss: 0.1045 - acc: 0.9837
Epoch 16/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0961 - acc: 0.9891
Epoch 17/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0882 - acc: 0.9837
Epoch 18/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0899 - acc: 0.9946
Epoch 19/28

8/8 [==============================] - 0s 36ms/step - loss: 0.0787 - acc: 0.9946
Epoch 20/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0724 - acc: 0.9946
Epoch 21/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0755 - acc: 1.0000
Epoch 22/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0682 - acc: 1.0000
Epoch 23/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0624 - acc: 0.9946
Epoch 24/28

8/8 [==============================] - 0s 37ms/step - loss: 0.0579 - acc: 1.0000
Epoch 25/28

8/8 [==============================] - 0s 40ms/step - loss: 0.0579 - acc: 1.0000
Epoch 26/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0473 - acc: 1.0000
Epoch 27/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0469 - acc: 1.0000
Epoch 28/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0450 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7008
False 1922
True percentage 0.78477043673
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.92      0.94      7318
     B-MISC       0.06      0.09      0.08       141
     I-MISC       0.05      0.03      0.03       154
      B-ORG       0.17      0.35      0.23       296
      B-LOC       0.00      0.00      0.00       218
      B-PER       0.71      0.19      0.31       438
      I-PER       0.00      0.00      0.00       214
      I-ORG       0.08      0.23      0.12       151

avg / total       0.82      0.78      0.79      8930

F-1 Score (without O):
0.156965336821
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104039 unique words.
4035 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658560     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,690
Trainable params: 6,770,690
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 3s 348ms/step - loss: 2.2853 - acc: 0.1456
Epoch 2/28

8/8 [==============================] - 0s 42ms/step - loss: 0.7241 - acc: 0.8291
Epoch 3/28

8/8 [==============================] - 0s 39ms/step - loss: 0.5430 - acc: 0.8481
Epoch 4/28

8/8 [==============================] - 0s 39ms/step - loss: 0.4755 - acc: 0.8418
Epoch 5/28

8/8 [==============================] - 0s 38ms/step - loss: 0.6183 - acc: 0.8671
Epoch 6/28

8/8 [==============================] - 0s 38ms/step - loss: 0.3892 - acc: 0.8418
Epoch 7/28

8/8 [==============================] - 0s 39ms/step - loss: 0.3047 - acc: 0.9114
Epoch 8/28

8/8 [==============================] - 0s 37ms/step - loss: 0.2656 - acc: 0.9241
Epoch 9/28

8/8 [==============================] - 0s 37ms/step - loss: 0.2406 - acc: 0.9494
Epoch 10/28

8/8 [==============================] - 0s 41ms/step - loss: 0.2265 - acc: 0.9557
Epoch 11/28

8/8 [==============================] - 0s 40ms/step - loss: 0.1870 - acc: 0.9620
Epoch 12/28

8/8 [==============================] - 0s 39ms/step - loss: 0.1840 - acc: 0.9557
Epoch 13/28

8/8 [==============================] - 0s 38ms/step - loss: 0.1680 - acc: 0.9684
Epoch 14/28

8/8 [==============================] - 0s 38ms/step - loss: 0.1497 - acc: 0.9810
Epoch 15/28

8/8 [==============================] - 0s 42ms/step - loss: 0.1431 - acc: 0.9873
Epoch 16/28

8/8 [==============================] - 0s 41ms/step - loss: 0.1229 - acc: 0.9937
Epoch 17/28

8/8 [==============================] - 0s 40ms/step - loss: 0.1173 - acc: 0.9810
Epoch 18/28

8/8 [==============================] - 0s 39ms/step - loss: 0.1077 - acc: 0.9873
Epoch 19/28

8/8 [==============================] - 0s 36ms/step - loss: 0.1057 - acc: 0.9873
Epoch 20/28

8/8 [==============================] - 0s 38ms/step - loss: 0.1010 - acc: 0.9873
Epoch 21/28

8/8 [==============================] - 0s 37ms/step - loss: 0.0890 - acc: 0.9937
Epoch 22/28

8/8 [==============================] - 0s 37ms/step - loss: 0.0863 - acc: 1.0000
Epoch 23/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0691 - acc: 0.9937
Epoch 24/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0816 - acc: 0.9937
Epoch 25/28

8/8 [==============================] - 0s 38ms/step - loss: 0.0603 - acc: 1.0000
Epoch 26/28

8/8 [==============================] - 0s 39ms/step - loss: 0.0569 - acc: 1.0000
Epoch 27/28

8/8 [==============================] - 0s 36ms/step - loss: 0.0587 - acc: 1.0000
Epoch 28/28

8/8 [==============================] - 0s 37ms/step - loss: 0.0584 - acc: 0.9937
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7091
False 1980
True percentage 0.781721971117
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.41      0.13      0.20       438
      I-PER       0.00      0.00      0.00       214
          O       0.92      0.94      0.93      7318
      B-ORG       0.24      0.38      0.29       296
      B-LOC       0.21      0.05      0.08       218
      I-ORG       0.12      0.30      0.18       151
      I-LOC       0.10      0.01      0.01       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.78      0.78      0.77      9071

F-1 Score (without O):
0.827683615819
