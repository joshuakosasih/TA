Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

1674/1674 [==============================] - 35s 21ms/step - loss: 0.4530 - acc: 0.8663
Epoch 2/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.2224 - acc: 0.9323
Epoch 3/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.1715 - acc: 0.9488
Epoch 4/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.1405 - acc: 0.9590
Epoch 5/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.1201 - acc: 0.9655
Epoch 6/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.1055 - acc: 0.9689
Epoch 7/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0925 - acc: 0.9737
Epoch 8/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0846 - acc: 0.9765
Epoch 9/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0753 - acc: 0.9786
Epoch 10/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0694 - acc: 0.9807
Epoch 11/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0620 - acc: 0.9825
Epoch 12/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0581 - acc: 0.9830
Epoch 13/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0518 - acc: 0.9866
Epoch 14/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0496 - acc: 0.9855
Epoch 15/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0470 - acc: 0.9867
Epoch 16/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0441 - acc: 0.9868
Epoch 17/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0415 - acc: 0.9882
Epoch 18/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0393 - acc: 0.9890
Epoch 19/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0370 - acc: 0.9890
Epoch 20/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0335 - acc: 0.9911
Epoch 21/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0344 - acc: 0.9901
Epoch 22/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0326 - acc: 0.9905
Epoch 23/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0302 - acc: 0.9912
Epoch 24/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0299 - acc: 0.9914
Epoch 25/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0277 - acc: 0.9921
Epoch 26/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0248 - acc: 0.9933
Epoch 27/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0249 - acc: 0.9933
Epoch 28/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0245 - acc: 0.9932
Epoch 29/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0233 - acc: 0.9932
Epoch 30/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0223 - acc: 0.9940
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8234
False 837
True percentage 0.907727924154
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
      B-PER       0.90      0.84      0.87       438
      B-ORG       0.76      0.75      0.76       296
      I-ORG       0.61      0.58      0.60       151
      I-PER       0.91      0.64      0.75       214
      B-LOC       0.77      0.73      0.75       218
     B-MISC       0.38      0.32      0.35       141
      I-LOC       0.74      0.78      0.76       141
     I-MISC       0.51      0.46      0.48       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.71543264942
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

1674/1674 [==============================] - 36s 21ms/step - loss: 0.4408 - acc: 0.8720
Epoch 2/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.2142 - acc: 0.9360
Epoch 3/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.1648 - acc: 0.9515
Epoch 4/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.1359 - acc: 0.9609
Epoch 5/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.1176 - acc: 0.9661
Epoch 6/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.1038 - acc: 0.9699
Epoch 7/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0908 - acc: 0.9741
Epoch 8/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0820 - acc: 0.9764
Epoch 9/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0724 - acc: 0.9793
Epoch 10/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0667 - acc: 0.9810
Epoch 11/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0608 - acc: 0.9825
Epoch 12/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0566 - acc: 0.9834
Epoch 13/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0529 - acc: 0.9848
Epoch 14/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0485 - acc: 0.9863
Epoch 15/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0467 - acc: 0.9861
Epoch 16/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0418 - acc: 0.9882
Epoch 17/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0410 - acc: 0.9887
Epoch 18/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0389 - acc: 0.9885
Epoch 19/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0361 - acc: 0.9897
Epoch 20/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0342 - acc: 0.9894
Epoch 21/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0336 - acc: 0.9904
Epoch 22/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0303 - acc: 0.9915
Epoch 23/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0300 - acc: 0.9910
Epoch 24/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0287 - acc: 0.9912
Epoch 25/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0270 - acc: 0.9917
Epoch 26/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0269 - acc: 0.9923
Epoch 27/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0249 - acc: 0.9926
Epoch 28/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0248 - acc: 0.9929
Epoch 29/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0228 - acc: 0.9931
Epoch 30/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0220 - acc: 0.9937
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8238
False 833
True percentage 0.908168889869
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.91      0.83      0.87       438
          O       0.98      0.96      0.97      7318
      B-ORG       0.79      0.75      0.77       296
     B-MISC       0.40      0.31      0.35       141
      I-ORG       0.65      0.62      0.63       151
      I-PER       0.93      0.64      0.76       214
     I-MISC       0.47      0.44      0.46       154
      B-LOC       0.76      0.72      0.74       218
      I-LOC       0.75      0.79      0.77       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.927507213945
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100836 unique words.
Found 94 unique chars.
Found 9 unique labels.
832 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 256
OOV word occurences: 362
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6453568     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,560,130
Trainable params: 6,560,130
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

837/837 [==============================] - 18s 22ms/step - loss: 0.5947 - acc: 0.8253
Epoch 2/30

837/837 [==============================] - 17s 20ms/step - loss: 0.3034 - acc: 0.9087
Epoch 3/30

837/837 [==============================] - 17s 20ms/step - loss: 0.2209 - acc: 0.9336
Epoch 4/30

837/837 [==============================] - 17s 20ms/step - loss: 0.1779 - acc: 0.9466
Epoch 5/30

837/837 [==============================] - 17s 20ms/step - loss: 0.1534 - acc: 0.9552
Epoch 6/30

837/837 [==============================] - 17s 20ms/step - loss: 0.1312 - acc: 0.9634
Epoch 7/30

837/837 [==============================] - 17s 20ms/step - loss: 0.1164 - acc: 0.9671
Epoch 8/30

837/837 [==============================] - 17s 20ms/step - loss: 0.1002 - acc: 0.9720
Epoch 9/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0929 - acc: 0.9753
Epoch 10/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0802 - acc: 0.9776
Epoch 11/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0750 - acc: 0.9798
Epoch 12/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0679 - acc: 0.9819
Epoch 13/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0595 - acc: 0.9843
Epoch 14/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0571 - acc: 0.9849
Epoch 15/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0513 - acc: 0.9875
Epoch 16/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0475 - acc: 0.9881
Epoch 17/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0439 - acc: 0.9889
Epoch 18/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0414 - acc: 0.9892
Epoch 19/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0395 - acc: 0.9893
Epoch 20/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0354 - acc: 0.9914
Epoch 21/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0355 - acc: 0.9915
Epoch 22/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0298 - acc: 0.9925
Epoch 23/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0295 - acc: 0.9930
Epoch 24/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0275 - acc: 0.9932
Epoch 25/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0265 - acc: 0.9936
Epoch 26/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0241 - acc: 0.9946
Epoch 27/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0230 - acc: 0.9949
Epoch 28/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0215 - acc: 0.9950
Epoch 29/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0214 - acc: 0.9942
Epoch 30/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0217 - acc: 0.9948
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8188
False 883
True percentage 0.902656818432
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.90      0.83      0.86       438
      B-ORG       0.78      0.71      0.74       296
      I-ORG       0.60      0.57      0.58       151
      I-PER       0.89      0.62      0.73       214
      B-LOC       0.75      0.75      0.75       218
     B-MISC       0.43      0.33      0.37       141
      I-LOC       0.74      0.74      0.74       141
     I-MISC       0.52      0.42      0.46       154

avg / total       0.94      0.90      0.92      9071

F-1 Score (without O):
0.707339172455
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 100817 unique words.
Found 94 unique chars.
Found 9 unique labels.
813 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 255
OOV word occurences: 395
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6452352     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,558,914
Trainable params: 6,558,914
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

837/837 [==============================] - 18s 22ms/step - loss: 0.6125 - acc: 0.8237
Epoch 2/30

837/837 [==============================] - 17s 20ms/step - loss: 0.3007 - acc: 0.9118
Epoch 3/30

837/837 [==============================] - 17s 20ms/step - loss: 0.2219 - acc: 0.9342
Epoch 4/30

837/837 [==============================] - 17s 20ms/step - loss: 0.1857 - acc: 0.9446
Epoch 5/30

837/837 [==============================] - 17s 21ms/step - loss: 0.1574 - acc: 0.9532
Epoch 6/30

837/837 [==============================] - 17s 20ms/step - loss: 0.1355 - acc: 0.9606
Epoch 7/30

837/837 [==============================] - 17s 20ms/step - loss: 0.1185 - acc: 0.9663
Epoch 8/30

837/837 [==============================] - 17s 20ms/step - loss: 0.1086 - acc: 0.9700
Epoch 9/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0988 - acc: 0.9738
Epoch 10/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0880 - acc: 0.9761
Epoch 11/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0821 - acc: 0.9768
Epoch 12/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0714 - acc: 0.9819
Epoch 13/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0675 - acc: 0.9822
Epoch 14/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0618 - acc: 0.9837
Epoch 15/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0563 - acc: 0.9859
Epoch 16/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0520 - acc: 0.9860
Epoch 17/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0481 - acc: 0.9889
Epoch 18/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0439 - acc: 0.9886
Epoch 19/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0440 - acc: 0.9892
Epoch 20/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0384 - acc: 0.9902
Epoch 21/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0362 - acc: 0.9914
Epoch 22/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0357 - acc: 0.9905
Epoch 23/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0342 - acc: 0.9914
Epoch 24/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0322 - acc: 0.9916
Epoch 25/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0286 - acc: 0.9925
Epoch 26/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0280 - acc: 0.9930
Epoch 27/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0271 - acc: 0.9936
Epoch 28/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0259 - acc: 0.9936
Epoch 29/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0242 - acc: 0.9939
Epoch 30/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0237 - acc: 0.9944
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8133
False 938
True percentage 0.896593539852
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.88      0.73      0.80       438
          O       0.98      0.95      0.97      7318
      B-ORG       0.74      0.72      0.73       296
     B-MISC       0.41      0.32      0.36       141
      I-ORG       0.61      0.53      0.57       151
      I-PER       0.88      0.62      0.73       214
     I-MISC       0.52      0.51      0.51       154
      B-LOC       0.75      0.76      0.75       218
      I-LOC       0.73      0.81      0.77       141

avg / total       0.94      0.90      0.91      9071

F-1 Score (without O):
0.9221147038
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100788 unique words.
Found 94 unique chars.
Found 9 unique labels.
784 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 261
OOV word occurences: 373
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6450496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,557,058
Trainable params: 6,557,058
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

837/837 [==============================] - 18s 22ms/step - loss: 0.5736 - acc: 0.8355
Epoch 2/30

837/837 [==============================] - 17s 20ms/step - loss: 0.2807 - acc: 0.9193
Epoch 3/30

837/837 [==============================] - 17s 20ms/step - loss: 0.2122 - acc: 0.9380
Epoch 4/30

837/837 [==============================] - 17s 21ms/step - loss: 0.1708 - acc: 0.9498
Epoch 5/30

837/837 [==============================] - 17s 20ms/step - loss: 0.1432 - acc: 0.9599
Epoch 6/30

837/837 [==============================] - 17s 20ms/step - loss: 0.1234 - acc: 0.9642
Epoch 7/30

837/837 [==============================] - 17s 20ms/step - loss: 0.1115 - acc: 0.9692
Epoch 8/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0973 - acc: 0.9726
Epoch 9/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0900 - acc: 0.9753
Epoch 10/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0798 - acc: 0.9780
Epoch 11/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0740 - acc: 0.9803
Epoch 12/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0660 - acc: 0.9831
Epoch 13/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0636 - acc: 0.9824
Epoch 14/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0568 - acc: 0.9856
Epoch 15/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0509 - acc: 0.9867
Epoch 16/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0485 - acc: 0.9882
Epoch 17/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0453 - acc: 0.9879
Epoch 18/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0450 - acc: 0.9873
Epoch 19/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0402 - acc: 0.9903
Epoch 20/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0382 - acc: 0.9907
Epoch 21/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0347 - acc: 0.9905
Epoch 22/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0340 - acc: 0.9908
Epoch 23/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0315 - acc: 0.9918
Epoch 24/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0314 - acc: 0.9916
Epoch 25/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0291 - acc: 0.9919
Epoch 26/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0277 - acc: 0.9930
Epoch 27/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0249 - acc: 0.9936
Epoch 28/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0249 - acc: 0.9938
Epoch 29/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0241 - acc: 0.9934
Epoch 30/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0227 - acc: 0.9945
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8137
False 934
True percentage 0.897034505567
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.90      0.80      0.85       438
      B-ORG       0.73      0.72      0.73       296
      I-ORG       0.55      0.55      0.55       151
     B-MISC       0.40      0.29      0.34       141
     I-MISC       0.45      0.36      0.40       154
      I-PER       0.92      0.65      0.76       214
      B-LOC       0.75      0.70      0.72       218
      I-LOC       0.72      0.75      0.73       141

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.688237072876
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100383 unique words.
Found 94 unique chars.
Found 9 unique labels.
379 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 289
OOV word occurences: 465
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6424576     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,531,138
Trainable params: 6,531,138
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

334/334 [==============================] - 8s 24ms/step - loss: 0.8145 - acc: 0.7937
Epoch 2/30

334/334 [==============================] - 7s 20ms/step - loss: 0.4481 - acc: 0.8637
Epoch 3/30

334/334 [==============================] - 7s 20ms/step - loss: 0.3455 - acc: 0.8949
Epoch 4/30

334/334 [==============================] - 7s 20ms/step - loss: 0.2773 - acc: 0.9187
Epoch 5/30

334/334 [==============================] - 7s 20ms/step - loss: 0.2262 - acc: 0.9362
Epoch 6/30

334/334 [==============================] - 7s 20ms/step - loss: 0.1921 - acc: 0.9473
Epoch 7/30

334/334 [==============================] - 7s 20ms/step - loss: 0.1638 - acc: 0.9564
Epoch 8/30

334/334 [==============================] - 7s 20ms/step - loss: 0.1410 - acc: 0.9673
Epoch 9/30

334/334 [==============================] - 7s 20ms/step - loss: 0.1219 - acc: 0.9708
Epoch 10/30

334/334 [==============================] - 7s 21ms/step - loss: 0.1130 - acc: 0.9708
Epoch 11/30

334/334 [==============================] - 7s 20ms/step - loss: 0.1004 - acc: 0.9780
Epoch 12/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0891 - acc: 0.9806
Epoch 13/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0781 - acc: 0.9836
Epoch 14/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0759 - acc: 0.9846
Epoch 15/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0716 - acc: 0.9858
Epoch 16/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0642 - acc: 0.9869
Epoch 17/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0557 - acc: 0.9873
Epoch 18/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0550 - acc: 0.9878
Epoch 19/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0482 - acc: 0.9901
Epoch 20/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0456 - acc: 0.9898
Epoch 21/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0414 - acc: 0.9925
Epoch 22/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0399 - acc: 0.9910
Epoch 23/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0428 - acc: 0.9907
Epoch 24/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0360 - acc: 0.9926
Epoch 25/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0336 - acc: 0.9933
Epoch 26/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0297 - acc: 0.9954
Epoch 27/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0286 - acc: 0.9949
Epoch 28/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0260 - acc: 0.9950
Epoch 29/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0267 - acc: 0.9951
Epoch 30/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0246 - acc: 0.9952
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7993
False 1078
True percentage 0.88115973983
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.96      0.96      7318
      B-PER       0.90      0.72      0.80       438
      B-ORG       0.74      0.61      0.67       296
      I-ORG       0.52      0.49      0.51       151
      I-PER       0.84      0.57      0.68       214
      B-LOC       0.70      0.69      0.70       218
     B-MISC       0.33      0.13      0.18       141
      I-LOC       0.68      0.77      0.72       141
     I-MISC       0.42      0.19      0.27       154

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.6373486297
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 100382 unique words.
Found 94 unique chars.
Found 9 unique labels.
378 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 282
OOV word occurences: 446
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6424512     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,531,074
Trainable params: 6,531,074
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

334/334 [==============================] - 8s 24ms/step - loss: 0.8247 - acc: 0.7710
Epoch 2/30

334/334 [==============================] - 7s 20ms/step - loss: 0.4608 - acc: 0.8599
Epoch 3/30

334/334 [==============================] - 7s 20ms/step - loss: 0.3498 - acc: 0.8931
Epoch 4/30

334/334 [==============================] - 7s 20ms/step - loss: 0.2742 - acc: 0.9177
Epoch 5/30

334/334 [==============================] - 7s 20ms/step - loss: 0.2289 - acc: 0.9325
Epoch 6/30

334/334 [==============================] - 7s 20ms/step - loss: 0.1969 - acc: 0.9401
Epoch 7/30

334/334 [==============================] - 7s 20ms/step - loss: 0.1709 - acc: 0.9533
Epoch 8/30

334/334 [==============================] - 7s 20ms/step - loss: 0.1516 - acc: 0.9590
Epoch 9/30

334/334 [==============================] - 7s 20ms/step - loss: 0.1370 - acc: 0.9626
Epoch 10/30

334/334 [==============================] - 7s 20ms/step - loss: 0.1202 - acc: 0.9705
Epoch 11/30

334/334 [==============================] - 7s 20ms/step - loss: 0.1074 - acc: 0.9743
Epoch 12/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0953 - acc: 0.9759
Epoch 13/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0917 - acc: 0.9777
Epoch 14/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0816 - acc: 0.9809
Epoch 15/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0694 - acc: 0.9848
Epoch 16/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0651 - acc: 0.9854
Epoch 17/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0618 - acc: 0.9866
Epoch 18/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0584 - acc: 0.9869
Epoch 19/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0527 - acc: 0.9897
Epoch 20/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0508 - acc: 0.9902
Epoch 21/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0454 - acc: 0.9914
Epoch 22/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0425 - acc: 0.9906
Epoch 23/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0389 - acc: 0.9937
Epoch 24/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0354 - acc: 0.9923
Epoch 25/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0372 - acc: 0.9922
Epoch 26/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0336 - acc: 0.9932
Epoch 27/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0275 - acc: 0.9959
Epoch 28/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0289 - acc: 0.9949
Epoch 29/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0265 - acc: 0.9948
Epoch 30/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0247 - acc: 0.9954
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7926
False 1145
True percentage 0.873773564105
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.87      0.59      0.70       438
          O       0.98      0.95      0.96      7318
      B-ORG       0.74      0.60      0.67       296
     B-MISC       0.26      0.28      0.27       141
      I-ORG       0.53      0.40      0.46       151
      I-PER       0.68      0.57      0.62       214
     I-MISC       0.39      0.44      0.41       154
      B-LOC       0.70      0.68      0.69       218
      I-LOC       0.70      0.74      0.72       141

avg / total       0.92      0.87      0.89      9071

F-1 Score (without O):
0.904245283019
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100367 unique words.
Found 94 unique chars.
Found 9 unique labels.
363 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 292
OOV word occurences: 453
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6423552     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,530,114
Trainable params: 6,530,114
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

334/334 [==============================] - 8s 24ms/step - loss: 0.7968 - acc: 0.7783
Epoch 2/30

334/334 [==============================] - 7s 20ms/step - loss: 0.4435 - acc: 0.8682
Epoch 3/30

334/334 [==============================] - 7s 20ms/step - loss: 0.3280 - acc: 0.9015
Epoch 4/30

334/334 [==============================] - 7s 20ms/step - loss: 0.2526 - acc: 0.9263
Epoch 5/30

334/334 [==============================] - 7s 20ms/step - loss: 0.2106 - acc: 0.9394
Epoch 6/30

334/334 [==============================] - 7s 20ms/step - loss: 0.1750 - acc: 0.9483
Epoch 7/30

334/334 [==============================] - 7s 20ms/step - loss: 0.1584 - acc: 0.9554
Epoch 8/30

334/334 [==============================] - 7s 20ms/step - loss: 0.1413 - acc: 0.9625
Epoch 9/30

334/334 [==============================] - 7s 20ms/step - loss: 0.1195 - acc: 0.9685
Epoch 10/30

334/334 [==============================] - 7s 20ms/step - loss: 0.1087 - acc: 0.9724
Epoch 11/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0988 - acc: 0.9768
Epoch 12/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0899 - acc: 0.9776
Epoch 13/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0819 - acc: 0.9801
Epoch 14/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0713 - acc: 0.9832
Epoch 15/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0660 - acc: 0.9856
Epoch 16/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0639 - acc: 0.9847
Epoch 17/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0567 - acc: 0.9873
Epoch 18/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0534 - acc: 0.9888
Epoch 19/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0519 - acc: 0.9881
Epoch 20/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0465 - acc: 0.9894
Epoch 21/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0403 - acc: 0.9914
Epoch 22/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0413 - acc: 0.9900
Epoch 23/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0379 - acc: 0.9914
Epoch 24/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0340 - acc: 0.9928
Epoch 25/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0338 - acc: 0.9936
Epoch 26/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0326 - acc: 0.9930
Epoch 27/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0300 - acc: 0.9940
Epoch 28/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0301 - acc: 0.9938
Epoch 29/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0275 - acc: 0.9939
Epoch 30/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0246 - acc: 0.9955
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7970
False 1101
True percentage 0.878624186969
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-PER       0.85      0.74      0.79       438
      B-ORG       0.66      0.68      0.67       296
      I-ORG       0.42      0.41      0.42       151
     B-MISC       0.31      0.19      0.24       141
     I-MISC       0.42      0.34      0.38       154
      I-PER       0.93      0.59      0.72       214
      B-LOC       0.70      0.67      0.68       218
      I-LOC       0.73      0.72      0.72       141

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.633119853614
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100202 unique words.
Found 94 unique chars.
Found 9 unique labels.
198 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 306
OOV word occurences: 516
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6412992     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,519,554
Trainable params: 6,519,554
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

167/167 [==============================] - 5s 29ms/step - loss: 0.9919 - acc: 0.7382
Epoch 2/30

167/167 [==============================] - 3s 20ms/step - loss: 0.5788 - acc: 0.8307
Epoch 3/30

167/167 [==============================] - 3s 20ms/step - loss: 0.4296 - acc: 0.8676
Epoch 4/30

167/167 [==============================] - 3s 21ms/step - loss: 0.3542 - acc: 0.9003
Epoch 5/30

167/167 [==============================] - 3s 21ms/step - loss: 0.2959 - acc: 0.9130
Epoch 6/30

167/167 [==============================] - 3s 21ms/step - loss: 0.2593 - acc: 0.9325
Epoch 7/30

167/167 [==============================] - 3s 21ms/step - loss: 0.2224 - acc: 0.9416
Epoch 8/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1954 - acc: 0.9462
Epoch 9/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1776 - acc: 0.9550
Epoch 10/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1591 - acc: 0.9632
Epoch 11/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1378 - acc: 0.9668
Epoch 12/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1226 - acc: 0.9721
Epoch 13/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1138 - acc: 0.9744
Epoch 14/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1032 - acc: 0.9796
Epoch 15/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0965 - acc: 0.9807
Epoch 16/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0923 - acc: 0.9812
Epoch 17/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0835 - acc: 0.9854
Epoch 18/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0764 - acc: 0.9854
Epoch 19/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0714 - acc: 0.9874
Epoch 20/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0621 - acc: 0.9905
Epoch 21/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0598 - acc: 0.9885
Epoch 22/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0577 - acc: 0.9891
Epoch 23/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0519 - acc: 0.9915
Epoch 24/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0453 - acc: 0.9940
Epoch 25/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0485 - acc: 0.9906
Epoch 26/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0430 - acc: 0.9927
Epoch 27/30

167/167 [==============================] - 3s 20ms/step - loss: 0.0387 - acc: 0.9936
Epoch 28/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0390 - acc: 0.9942
Epoch 29/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0373 - acc: 0.9946
Epoch 30/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0334 - acc: 0.9949
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7867
False 1204
True percentage 0.86726931981
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.95      0.95      7318
      B-PER       0.86      0.60      0.71       438
      B-ORG       0.65      0.61      0.63       296
      I-ORG       0.41      0.40      0.40       151
      I-PER       0.77      0.54      0.64       214
      B-LOC       0.79      0.60      0.68       218
     B-MISC       0.48      0.11      0.17       141
      I-LOC       0.82      0.72      0.77       141
     I-MISC       0.55      0.11      0.18       154

avg / total       0.91      0.87      0.88      9071

F-1 Score (without O):
0.593509534962
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 100204 unique words.
Found 94 unique chars.
Found 9 unique labels.
200 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 303
OOV word occurences: 577
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6413120     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,519,682
Trainable params: 6,519,682
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

167/167 [==============================] - 5s 28ms/step - loss: 0.9720 - acc: 0.7373
Epoch 2/30

167/167 [==============================] - 3s 21ms/step - loss: 0.5861 - acc: 0.8222
Epoch 3/30

167/167 [==============================] - 3s 20ms/step - loss: 0.4546 - acc: 0.8532
Epoch 4/30

167/167 [==============================] - 3s 21ms/step - loss: 0.3624 - acc: 0.8888
Epoch 5/30

167/167 [==============================] - 3s 21ms/step - loss: 0.3045 - acc: 0.9136
Epoch 6/30

167/167 [==============================] - 3s 21ms/step - loss: 0.2581 - acc: 0.9282
Epoch 7/30

167/167 [==============================] - 3s 21ms/step - loss: 0.2287 - acc: 0.9361
Epoch 8/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1982 - acc: 0.9460
Epoch 9/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1751 - acc: 0.9492
Epoch 10/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1533 - acc: 0.9576
Epoch 11/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1394 - acc: 0.9646
Epoch 12/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1272 - acc: 0.9693
Epoch 13/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1116 - acc: 0.9744
Epoch 14/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1090 - acc: 0.9750
Epoch 15/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0999 - acc: 0.9803
Epoch 16/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0916 - acc: 0.9816
Epoch 17/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0828 - acc: 0.9832
Epoch 18/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0790 - acc: 0.9825
Epoch 19/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0686 - acc: 0.9881
Epoch 20/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0623 - acc: 0.9900
Epoch 21/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0569 - acc: 0.9900
Epoch 22/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0561 - acc: 0.9920
Epoch 23/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0486 - acc: 0.9926
Epoch 24/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0488 - acc: 0.9931
Epoch 25/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0461 - acc: 0.9931
Epoch 26/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0417 - acc: 0.9948
Epoch 27/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0410 - acc: 0.9914
Epoch 28/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0375 - acc: 0.9947
Epoch 29/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0372 - acc: 0.9952
Epoch 30/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0335 - acc: 0.9957
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7789
False 1282
True percentage 0.85867048837
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.82      0.52      0.63       438
          O       0.97      0.94      0.96      7318
      B-ORG       0.60      0.60      0.60       296
     B-MISC       0.30      0.25      0.27       141
      I-ORG       0.47      0.35      0.40       151
      I-PER       0.74      0.44      0.55       214
     I-MISC       0.36      0.38      0.37       154
      B-LOC       0.79      0.66      0.71       218
      I-LOC       0.77      0.70      0.74       141

avg / total       0.91      0.86      0.88      9071

F-1 Score (without O):
0.897620036797
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100187 unique words.
Found 94 unique chars.
Found 9 unique labels.
183 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 304
OOV word occurences: 482
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6412032     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,518,594
Trainable params: 6,518,594
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

167/167 [==============================] - 5s 29ms/step - loss: 0.9335 - acc: 0.7742
Epoch 2/30

167/167 [==============================] - 3s 21ms/step - loss: 0.5885 - acc: 0.8210
Epoch 3/30

167/167 [==============================] - 3s 21ms/step - loss: 0.4500 - acc: 0.8576
Epoch 4/30

167/167 [==============================] - 3s 20ms/step - loss: 0.3575 - acc: 0.8953
Epoch 5/30

167/167 [==============================] - 3s 21ms/step - loss: 0.2939 - acc: 0.9179
Epoch 6/30

167/167 [==============================] - 3s 21ms/step - loss: 0.2547 - acc: 0.9303
Epoch 7/30

167/167 [==============================] - 3s 21ms/step - loss: 0.2149 - acc: 0.9448
Epoch 8/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1847 - acc: 0.9522
Epoch 9/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1578 - acc: 0.9580
Epoch 10/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1427 - acc: 0.9659
Epoch 11/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1279 - acc: 0.9689
Epoch 12/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1166 - acc: 0.9717
Epoch 13/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0998 - acc: 0.9786
Epoch 14/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0885 - acc: 0.9840
Epoch 15/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0820 - acc: 0.9806
Epoch 16/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0723 - acc: 0.9846
Epoch 17/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0692 - acc: 0.9880
Epoch 18/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0625 - acc: 0.9871
Epoch 19/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0581 - acc: 0.9892
Epoch 20/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0535 - acc: 0.9930
Epoch 21/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0481 - acc: 0.9924
Epoch 22/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0476 - acc: 0.9924
Epoch 23/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0400 - acc: 0.9946
Epoch 24/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0363 - acc: 0.9951
Epoch 25/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0350 - acc: 0.9945
Epoch 26/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0356 - acc: 0.9933
Epoch 27/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0333 - acc: 0.9951
Epoch 28/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0302 - acc: 0.9940
Epoch 29/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0277 - acc: 0.9958
Epoch 30/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0269 - acc: 0.9959
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7811
False 1260
True percentage 0.861095799802
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.94      0.96      7318
      B-PER       0.80      0.67      0.73       438
      B-ORG       0.63      0.55      0.59       296
      I-ORG       0.40      0.38      0.39       151
     B-MISC       0.13      0.08      0.10       141
     I-MISC       0.26      0.25      0.25       154
      I-PER       0.75      0.53      0.62       214
      B-LOC       0.63      0.67      0.65       218
      I-LOC       0.72      0.57      0.64       141

avg / total       0.90      0.86      0.88      9071

F-1 Score (without O):
0.556580565806
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100102 unique words.
Found 94 unique chars.
Found 9 unique labels.
98 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 317
OOV word occurences: 620
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6406592     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,513,154
Trainable params: 6,513,154
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

83/83 [==============================] - 3s 37ms/step - loss: 1.2882 - acc: 0.6538
Epoch 2/30

83/83 [==============================] - 2s 21ms/step - loss: 0.7041 - acc: 0.8154
Epoch 3/30

83/83 [==============================] - 2s 21ms/step - loss: 0.6044 - acc: 0.8240
Epoch 4/30

83/83 [==============================] - 2s 21ms/step - loss: 0.4915 - acc: 0.8501
Epoch 5/30

83/83 [==============================] - 2s 21ms/step - loss: 0.4204 - acc: 0.8749
Epoch 6/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3608 - acc: 0.8923
Epoch 7/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3193 - acc: 0.9111
Epoch 8/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2816 - acc: 0.9225
Epoch 9/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2595 - acc: 0.9326
Epoch 10/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2337 - acc: 0.9383
Epoch 11/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2072 - acc: 0.9477
Epoch 12/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1928 - acc: 0.9492
Epoch 13/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1784 - acc: 0.9533
Epoch 14/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1651 - acc: 0.9647
Epoch 15/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1475 - acc: 0.9651
Epoch 16/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1438 - acc: 0.9644
Epoch 17/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1326 - acc: 0.9716
Epoch 18/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1276 - acc: 0.9708
Epoch 19/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1201 - acc: 0.9755
Epoch 20/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1091 - acc: 0.9774
Epoch 21/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1051 - acc: 0.9795
Epoch 22/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0996 - acc: 0.9748
Epoch 23/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0976 - acc: 0.9794
Epoch 24/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0899 - acc: 0.9849
Epoch 25/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0806 - acc: 0.9843
Epoch 26/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0801 - acc: 0.9835
Epoch 27/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0733 - acc: 0.9888
Epoch 28/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0719 - acc: 0.9842
Epoch 29/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0723 - acc: 0.9839
Epoch 30/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0652 - acc: 0.9901
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7650
False 1421
True percentage 0.843346929776
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.95      0.95      7318
      B-PER       0.84      0.45      0.58       438
      B-ORG       0.57      0.47      0.52       296
      I-ORG       0.26      0.34      0.30       151
      I-PER       0.87      0.37      0.52       214
      B-LOC       0.68      0.68      0.68       218
     B-MISC       0.52      0.10      0.17       141
      I-LOC       0.57      0.64      0.60       141
     I-MISC       0.44      0.08      0.13       154

avg / total       0.89      0.84      0.86      9071

F-1 Score (without O):
0.495089739248
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 100106 unique words.
Found 94 unique chars.
Found 9 unique labels.
102 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 315
OOV word occurences: 620
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6406848     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,513,410
Trainable params: 6,513,410
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

83/83 [==============================] - 3s 37ms/step - loss: 1.1656 - acc: 0.6724
Epoch 2/30

83/83 [==============================] - 2s 21ms/step - loss: 0.7327 - acc: 0.8099
Epoch 3/30

83/83 [==============================] - 2s 21ms/step - loss: 0.6135 - acc: 0.8139
Epoch 4/30

83/83 [==============================] - 2s 21ms/step - loss: 0.5033 - acc: 0.8277
Epoch 5/30

83/83 [==============================] - 2s 21ms/step - loss: 0.4313 - acc: 0.8611
Epoch 6/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3828 - acc: 0.8745
Epoch 7/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3294 - acc: 0.9045
Epoch 8/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3035 - acc: 0.9089
Epoch 9/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2997 - acc: 0.9086
Epoch 10/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2441 - acc: 0.9427
Epoch 11/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2220 - acc: 0.9402
Epoch 12/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2042 - acc: 0.9449
Epoch 13/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1771 - acc: 0.9566
Epoch 14/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1599 - acc: 0.9615
Epoch 15/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1570 - acc: 0.9626
Epoch 16/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1442 - acc: 0.9638
Epoch 17/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1308 - acc: 0.9706
Epoch 18/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1243 - acc: 0.9688
Epoch 19/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1142 - acc: 0.9748
Epoch 20/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1065 - acc: 0.9776
Epoch 21/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1035 - acc: 0.9769
Epoch 22/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0962 - acc: 0.9766
Epoch 23/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0929 - acc: 0.9817
Epoch 24/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0859 - acc: 0.9827
Epoch 25/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0802 - acc: 0.9855
Epoch 26/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0800 - acc: 0.9859
Epoch 27/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0733 - acc: 0.9862
Epoch 28/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0649 - acc: 0.9913
Epoch 29/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0658 - acc: 0.9888
Epoch 30/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0618 - acc: 0.9935
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7647
False 1424
True percentage 0.84301620549
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.71      0.47      0.57       438
          O       0.96      0.94      0.95      7318
      B-ORG       0.59      0.45      0.51       296
     B-MISC       0.20      0.15      0.17       141
      I-ORG       0.42      0.48      0.45       151
      I-PER       0.69      0.46      0.55       214
     I-MISC       0.48      0.13      0.20       154
      B-LOC       0.71      0.54      0.61       218
      I-LOC       0.63      0.65      0.64       141

avg / total       0.89      0.84      0.86      9071

F-1 Score (without O):
0.88614981541
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100100 unique words.
Found 94 unique chars.
Found 9 unique labels.
96 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 312
OOV word occurences: 517
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6406464     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,513,026
Trainable params: 6,513,026
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

83/83 [==============================] - 3s 37ms/step - loss: 1.2255 - acc: 0.6632
Epoch 2/30

83/83 [==============================] - 2s 21ms/step - loss: 0.7133 - acc: 0.7980
Epoch 3/30

83/83 [==============================] - 2s 21ms/step - loss: 0.5662 - acc: 0.8279
Epoch 4/30

83/83 [==============================] - 2s 21ms/step - loss: 0.5387 - acc: 0.8584
Epoch 5/30

83/83 [==============================] - 2s 21ms/step - loss: 0.4201 - acc: 0.8676
Epoch 6/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3705 - acc: 0.8846
Epoch 7/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3422 - acc: 0.8883
Epoch 8/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3024 - acc: 0.9242
Epoch 9/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2697 - acc: 0.9285
Epoch 10/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2385 - acc: 0.9375
Epoch 11/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2153 - acc: 0.9541
Epoch 12/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2056 - acc: 0.9549
Epoch 13/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1904 - acc: 0.9527
Epoch 14/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1666 - acc: 0.9581
Epoch 15/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1564 - acc: 0.9649
Epoch 16/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1457 - acc: 0.9672
Epoch 17/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1319 - acc: 0.9784
Epoch 18/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1273 - acc: 0.9799
Epoch 19/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1190 - acc: 0.9786
Epoch 20/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1094 - acc: 0.9832
Epoch 21/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1019 - acc: 0.9814
Epoch 22/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0960 - acc: 0.9829
Epoch 23/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0904 - acc: 0.9859
Epoch 24/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0896 - acc: 0.9855
Epoch 25/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0760 - acc: 0.9885
Epoch 26/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0717 - acc: 0.9889
Epoch 27/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0698 - acc: 0.9878
Epoch 28/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0637 - acc: 0.9901
Epoch 29/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0592 - acc: 0.9915
Epoch 30/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0561 - acc: 0.9931
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7720
False 1351
True percentage 0.851063829787
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.94      0.95      7318
      B-PER       0.80      0.63      0.71       438
      B-ORG       0.56      0.51      0.53       296
      I-ORG       0.66      0.23      0.34       151
     B-MISC       0.11      0.02      0.04       141
     I-MISC       0.22      0.13      0.16       154
      I-PER       0.83      0.49      0.61       214
      B-LOC       0.63      0.62      0.62       218
      I-LOC       0.61      0.60      0.60       141

avg / total       0.88      0.85      0.86      9071

F-1 Score (without O):
0.535891498511
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 100124 unique words.
Found 94 unique chars.
Found 9 unique labels.
120 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 318
OOV word occurences: 605
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6408000     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,514,562
Trainable params: 6,514,562
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

83/83 [==============================] - 3s 38ms/step - loss: 1.3772 - acc: 0.6299
Epoch 2/30

83/83 [==============================] - 2s 21ms/step - loss: 0.8471 - acc: 0.7667
Epoch 3/30

83/83 [==============================] - 2s 21ms/step - loss: 0.6867 - acc: 0.7864
Epoch 4/30

83/83 [==============================] - 2s 21ms/step - loss: 0.5582 - acc: 0.8209
Epoch 5/30

83/83 [==============================] - 2s 21ms/step - loss: 0.4796 - acc: 0.8539
Epoch 6/30

83/83 [==============================] - 2s 21ms/step - loss: 0.4168 - acc: 0.8740
Epoch 7/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3591 - acc: 0.8999
Epoch 8/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3214 - acc: 0.9085
Epoch 9/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2888 - acc: 0.9232
Epoch 10/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2728 - acc: 0.9284
Epoch 11/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2294 - acc: 0.9368
Epoch 12/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2035 - acc: 0.9465
Epoch 13/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1916 - acc: 0.9472
Epoch 14/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1691 - acc: 0.9575
Epoch 15/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1565 - acc: 0.9633
Epoch 16/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1415 - acc: 0.9651
Epoch 17/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1350 - acc: 0.9637
Epoch 18/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1229 - acc: 0.9747
Epoch 19/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1112 - acc: 0.9760
Epoch 20/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1119 - acc: 0.9743
Epoch 21/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0980 - acc: 0.9775
Epoch 22/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1010 - acc: 0.9828
Epoch 23/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0908 - acc: 0.9789
Epoch 24/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0883 - acc: 0.9857
Epoch 25/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0741 - acc: 0.9858
Epoch 26/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0680 - acc: 0.9879
Epoch 27/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0730 - acc: 0.9859
Epoch 28/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0651 - acc: 0.9858
Epoch 29/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0633 - acc: 0.9880
Epoch 30/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0598 - acc: 0.9920
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7600
False 1471
True percentage 0.83783485834
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.94      0.95      7318
      B-ORG       0.59      0.51      0.55       296
      B-PER       0.83      0.40      0.54       438
      I-PER       0.53      0.36      0.43       214
      B-LOC       0.61      0.58      0.59       218
      I-LOC       0.64      0.62      0.63       141
      I-ORG       0.30      0.33      0.32       151
     B-MISC       0.15      0.09      0.12       141
     I-MISC       0.29      0.14      0.19       154

avg / total       0.88      0.84      0.86      9071

F-1 Score (without O):
0.464073829927
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100047 unique words.
Found 92 unique chars.
Found 9 unique labels.
43 unique words not found in embedding.
8 unique chars not found in embedding.
Number of OOV: 326
OOV word occurences: 637
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6403072     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,509,506
Trainable params: 6,509,506
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

33/33 [==============================] - 2s 66ms/step - loss: 1.6908 - acc: 0.4767
Epoch 2/30

33/33 [==============================] - 1s 23ms/step - loss: 0.6961 - acc: 0.8477
Epoch 3/30

33/33 [==============================] - 1s 23ms/step - loss: 0.6160 - acc: 0.8473
Epoch 4/30

33/33 [==============================] - 1s 23ms/step - loss: 0.5084 - acc: 0.8463
Epoch 5/30

33/33 [==============================] - 1s 23ms/step - loss: 0.4572 - acc: 0.8485
Epoch 6/30

33/33 [==============================] - 1s 23ms/step - loss: 0.4339 - acc: 0.8597
Epoch 7/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3810 - acc: 0.8788
Epoch 8/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3424 - acc: 0.8845
Epoch 9/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3227 - acc: 0.9104
Epoch 10/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2941 - acc: 0.8980
Epoch 11/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2700 - acc: 0.9110
Epoch 12/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2462 - acc: 0.9320
Epoch 13/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2360 - acc: 0.9452
Epoch 14/30

33/33 [==============================] - 1s 23ms/step - loss: 0.9556 - acc: 0.9017
Epoch 15/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2264 - acc: 0.9359
Epoch 16/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2173 - acc: 0.9552
Epoch 17/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1928 - acc: 0.9621
Epoch 18/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1861 - acc: 0.9644
Epoch 19/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1718 - acc: 0.9627
Epoch 20/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1716 - acc: 0.9634
Epoch 21/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1532 - acc: 0.9735
Epoch 22/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1457 - acc: 0.9738
Epoch 23/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1426 - acc: 0.9636
Epoch 24/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1355 - acc: 0.9732
Epoch 25/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1363 - acc: 0.9634
Epoch 26/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1253 - acc: 0.9708
Epoch 27/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1193 - acc: 0.9729
Epoch 28/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1081 - acc: 0.9774
Epoch 29/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1113 - acc: 0.9739
Epoch 30/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1052 - acc: 0.9775
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7339
False 1732
True percentage 0.809061845442
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.89      0.95      0.92      7318
      B-PER       0.71      0.44      0.54       438
      B-ORG       0.45      0.35      0.40       296
      I-ORG       0.65      0.15      0.24       151
      I-PER       0.61      0.19      0.29       214
      B-LOC       0.86      0.03      0.05       218
     B-MISC       0.00      0.00      0.00       141
      I-LOC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.81      0.81      0.79      9071

F-1 Score (without O):
0.309906858594
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 100055 unique words.
Found 94 unique chars.
Found 9 unique labels.
51 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 322
OOV word occurences: 633
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6403584     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,510,146
Trainable params: 6,510,146
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

33/33 [==============================] - 2s 66ms/step - loss: 1.6092 - acc: 0.4884
Epoch 2/30

33/33 [==============================] - 1s 23ms/step - loss: 0.7966 - acc: 0.8271
Epoch 3/30

33/33 [==============================] - 1s 23ms/step - loss: 0.7028 - acc: 0.8265
Epoch 4/30

33/33 [==============================] - 1s 23ms/step - loss: 0.7115 - acc: 0.8238
Epoch 5/30

33/33 [==============================] - 1s 22ms/step - loss: 0.6143 - acc: 0.8256
Epoch 6/30

33/33 [==============================] - 1s 23ms/step - loss: 0.5709 - acc: 0.8289
Epoch 7/30

33/33 [==============================] - 1s 23ms/step - loss: 0.5348 - acc: 0.8342
Epoch 8/30

33/33 [==============================] - 1s 23ms/step - loss: 0.5051 - acc: 0.8337
Epoch 9/30

33/33 [==============================] - 1s 22ms/step - loss: 0.4582 - acc: 0.8407
Epoch 10/30

33/33 [==============================] - 1s 23ms/step - loss: 0.4248 - acc: 0.8634
Epoch 11/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3912 - acc: 0.8710
Epoch 12/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3753 - acc: 0.8694
Epoch 13/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3530 - acc: 0.8788
Epoch 14/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3307 - acc: 0.8842
Epoch 15/30

33/33 [==============================] - 1s 22ms/step - loss: 0.3078 - acc: 0.8880
Epoch 16/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2949 - acc: 0.9097
Epoch 17/30

33/33 [==============================] - 1s 22ms/step - loss: 0.2854 - acc: 0.9229
Epoch 18/30

33/33 [==============================] - 1s 22ms/step - loss: 0.2672 - acc: 0.9108
Epoch 19/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2477 - acc: 0.9264
Epoch 20/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2404 - acc: 0.9209
Epoch 21/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2273 - acc: 0.9462
Epoch 22/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2008 - acc: 0.9521
Epoch 23/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2102 - acc: 0.9560
Epoch 24/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1887 - acc: 0.9557
Epoch 25/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1822 - acc: 0.9699
Epoch 26/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1661 - acc: 0.9731
Epoch 27/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1716 - acc: 0.9514
Epoch 28/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1514 - acc: 0.9686
Epoch 29/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1444 - acc: 0.9702
Epoch 30/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1421 - acc: 0.9730
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7370
False 1701
True percentage 0.812479329732
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.60      0.25      0.36       438
          O       0.91      0.95      0.93      7318
      B-ORG       0.52      0.40      0.45       296
     B-MISC       0.15      0.06      0.09       141
      I-ORG       0.50      0.10      0.17       151
      I-PER       0.50      0.26      0.34       214
     I-MISC       0.33      0.04      0.07       154
      B-LOC       0.94      0.20      0.33       218
      I-LOC       0.49      0.35      0.40       141

avg / total       0.84      0.81      0.81      9071

F-1 Score (without O):
0.85971457334
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100038 unique words.
Found 93 unique chars.
Found 9 unique labels.
34 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 322
OOV word occurences: 540
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6402496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,508,994
Trainable params: 6,508,994
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

33/33 [==============================] - 2s 66ms/step - loss: 1.7995 - acc: 0.4304
Epoch 2/30

33/33 [==============================] - 1s 23ms/step - loss: 0.8674 - acc: 0.8006
Epoch 3/30

33/33 [==============================] - 1s 23ms/step - loss: 0.8177 - acc: 0.7980
Epoch 4/30

33/33 [==============================] - 1s 23ms/step - loss: 0.7045 - acc: 0.7986
Epoch 5/30

33/33 [==============================] - 1s 23ms/step - loss: 0.6446 - acc: 0.8021
Epoch 6/30

33/33 [==============================] - 1s 23ms/step - loss: 0.5850 - acc: 0.8051
Epoch 7/30

33/33 [==============================] - 1s 23ms/step - loss: 0.5496 - acc: 0.8139
Epoch 8/30

33/33 [==============================] - 1s 23ms/step - loss: 0.6454 - acc: 0.8440
Epoch 9/30

33/33 [==============================] - 1s 23ms/step - loss: 0.4649 - acc: 0.8324
Epoch 10/30

33/33 [==============================] - 1s 23ms/step - loss: 0.4387 - acc: 0.8549
Epoch 11/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3888 - acc: 0.8823
Epoch 12/30

33/33 [==============================] - 1s 22ms/step - loss: 0.3891 - acc: 0.9113
Epoch 13/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3486 - acc: 0.9271
Epoch 14/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3228 - acc: 0.9097
Epoch 15/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3301 - acc: 0.9161
Epoch 16/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3014 - acc: 0.9312
Epoch 17/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2832 - acc: 0.9219
Epoch 18/30

33/33 [==============================] - 1s 22ms/step - loss: 0.2718 - acc: 0.9245
Epoch 19/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2689 - acc: 0.9244
Epoch 20/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2429 - acc: 0.9481
Epoch 21/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2323 - acc: 0.9686
Epoch 22/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2152 - acc: 0.9601
Epoch 23/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1988 - acc: 0.9628
Epoch 24/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1955 - acc: 0.9631
Epoch 25/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1758 - acc: 0.9652
Epoch 26/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1657 - acc: 0.9757
Epoch 27/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1780 - acc: 0.9717
Epoch 28/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1720 - acc: 0.9765
Epoch 29/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1467 - acc: 0.9761
Epoch 30/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1426 - acc: 0.9875
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7298
False 1773
True percentage 0.804541946864
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.92      0.94      0.93      7318
      B-PER       0.83      0.42      0.56       438
      B-ORG       0.39      0.49      0.43       296
      I-ORG       0.20      0.08      0.11       151
     B-MISC       0.08      0.04      0.05       141
     I-MISC       0.14      0.20      0.16       154
      I-PER       0.54      0.15      0.24       214
      B-LOC       0.34      0.11      0.17       218
      I-LOC       0.00      0.00      0.00       141

avg / total       0.82      0.80      0.81      9071

F-1 Score (without O):
0.306713780919
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 100068 unique words.
Found 94 unique chars.
Found 9 unique labels.
64 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 322
OOV word occurences: 621
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6404416     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,510,978
Trainable params: 6,510,978
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

33/33 [==============================] - 2s 66ms/step - loss: 1.7894 - acc: 0.4040
Epoch 2/30

33/33 [==============================] - 1s 23ms/step - loss: 1.2619 - acc: 0.7540
Epoch 3/30

33/33 [==============================] - 1s 22ms/step - loss: 0.9021 - acc: 0.7548
Epoch 4/30

33/33 [==============================] - 1s 23ms/step - loss: 0.8678 - acc: 0.7552
Epoch 5/30

33/33 [==============================] - 1s 23ms/step - loss: 0.7706 - acc: 0.7608
Epoch 6/30

33/33 [==============================] - 1s 23ms/step - loss: 0.7465 - acc: 0.7826
Epoch 7/30

33/33 [==============================] - 1s 23ms/step - loss: 0.6469 - acc: 0.8047
Epoch 8/30

33/33 [==============================] - 1s 23ms/step - loss: 0.6075 - acc: 0.8035
Epoch 9/30

33/33 [==============================] - 1s 23ms/step - loss: 0.5564 - acc: 0.8200
Epoch 10/30

33/33 [==============================] - 1s 23ms/step - loss: 0.5094 - acc: 0.8278
Epoch 11/30

33/33 [==============================] - 1s 23ms/step - loss: 0.4923 - acc: 0.8527
Epoch 12/30

33/33 [==============================] - 1s 22ms/step - loss: 0.4700 - acc: 0.8662
Epoch 13/30

33/33 [==============================] - 1s 23ms/step - loss: 0.4150 - acc: 0.8895
Epoch 14/30

33/33 [==============================] - 1s 22ms/step - loss: 0.3964 - acc: 0.8755
Epoch 15/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3671 - acc: 0.9079
Epoch 16/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3455 - acc: 0.8983
Epoch 17/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3244 - acc: 0.9048
Epoch 18/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2882 - acc: 0.9269
Epoch 19/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2795 - acc: 0.9318
Epoch 20/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2624 - acc: 0.9253
Epoch 21/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2376 - acc: 0.9520
Epoch 22/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2235 - acc: 0.9473
Epoch 23/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2017 - acc: 0.9480
Epoch 24/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1993 - acc: 0.9464
Epoch 25/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1856 - acc: 0.9540
Epoch 26/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1723 - acc: 0.9572
Epoch 27/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1649 - acc: 0.9607
Epoch 28/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1633 - acc: 0.9645
Epoch 29/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1589 - acc: 0.9643
Epoch 30/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1318 - acc: 0.9725
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7446
False 1625
True percentage 0.820857678316
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.94      0.94      7318
      B-ORG       0.55      0.48      0.52       296
      B-PER       0.63      0.25      0.36       438
      I-PER       0.73      0.20      0.32       214
      B-LOC       0.51      0.67      0.58       218
      I-LOC       0.54      0.66      0.59       141
      I-ORG       0.29      0.15      0.20       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.08      0.02      0.03       154

avg / total       0.85      0.82      0.83      9071

F-1 Score (without O):
0.395226395226
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100027 unique words.
Found 87 unique chars.
Found 7 unique labels.
23 unique words not found in embedding.
3 unique chars not found in embedding.
Number of OOV: 327
OOV word occurences: 638
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5632        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401792     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 8)        1112        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,608
Trainable params: 6,507,608
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

16/16 [==============================] - 2s 109ms/step - loss: 2.0448 - acc: 0.0646
Epoch 2/30

16/16 [==============================] - 0s 20ms/step - loss: 1.0999 - acc: 0.8287
Epoch 3/30

16/16 [==============================] - 0s 20ms/step - loss: 0.7018 - acc: 0.8287
Epoch 4/30

16/16 [==============================] - 0s 20ms/step - loss: 0.6439 - acc: 0.8287
Epoch 5/30

16/16 [==============================] - 0s 20ms/step - loss: 0.5822 - acc: 0.8287
Epoch 6/30

16/16 [==============================] - 0s 20ms/step - loss: 0.5434 - acc: 0.8315
Epoch 7/30

16/16 [==============================] - 0s 20ms/step - loss: 0.5035 - acc: 0.8315
Epoch 8/30

16/16 [==============================] - 0s 20ms/step - loss: 0.4768 - acc: 0.8567
Epoch 9/30

16/16 [==============================] - 0s 20ms/step - loss: 0.4277 - acc: 0.8371
Epoch 10/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3984 - acc: 0.8792
Epoch 11/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3619 - acc: 0.8680
Epoch 12/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3232 - acc: 0.8904
Epoch 13/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2971 - acc: 0.8933
Epoch 14/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2651 - acc: 0.9073
Epoch 15/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2520 - acc: 0.9129
Epoch 16/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2238 - acc: 0.9382
Epoch 17/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2587 - acc: 0.9073
Epoch 18/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3813 - acc: 0.9270
Epoch 19/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2144 - acc: 0.9242
Epoch 20/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1878 - acc: 0.9635
Epoch 21/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1817 - acc: 0.9579
Epoch 22/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1735 - acc: 0.9663
Epoch 23/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1578 - acc: 0.9663
Epoch 24/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1473 - acc: 0.9775
Epoch 25/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1480 - acc: 0.9719
Epoch 26/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1301 - acc: 0.9803
Epoch 27/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1300 - acc: 0.9803
Epoch 28/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1189 - acc: 0.9831
Epoch 29/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1131 - acc: 0.9803
Epoch 30/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1058 - acc: 0.9831
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7165
False 1611
True percentage 0.816431175934
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.87      0.95      0.91      7318
      B-PER       0.63      0.17      0.27       438
      B-ORG       0.44      0.32      0.37       296
      I-ORG       0.17      0.07      0.10       151
      I-PER       0.33      0.02      0.04       214
      B-LOC       0.00      0.00      0.00       218
     B-MISC       0.00      0.00      0.00       141

avg / total       0.78      0.82      0.79      8776

F-1 Score (without O):
0.196668457818
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 100030 unique words.
Found 94 unique chars.
Found 9 unique labels.
26 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 324
OOV word occurences: 635
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401984     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,508,546
Trainable params: 6,508,546
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

16/16 [==============================] - 2s 109ms/step - loss: 1.9871 - acc: 0.4253
Epoch 2/30

16/16 [==============================] - 0s 20ms/step - loss: 0.9708 - acc: 0.8506
Epoch 3/30

16/16 [==============================] - 0s 20ms/step - loss: 0.7430 - acc: 0.8534
Epoch 4/30

16/16 [==============================] - 0s 20ms/step - loss: 0.6927 - acc: 0.8534
Epoch 5/30

16/16 [==============================] - 0s 20ms/step - loss: 0.6353 - acc: 0.8534
Epoch 6/30

16/16 [==============================] - 0s 20ms/step - loss: 0.6087 - acc: 0.8534
Epoch 7/30

16/16 [==============================] - 0s 21ms/step - loss: 0.5692 - acc: 0.8534
Epoch 8/30

16/16 [==============================] - 0s 20ms/step - loss: 0.5412 - acc: 0.8534
Epoch 9/30

16/16 [==============================] - 0s 20ms/step - loss: 0.5068 - acc: 0.8534
Epoch 10/30

16/16 [==============================] - 0s 20ms/step - loss: 0.4876 - acc: 0.8534
Epoch 11/30

16/16 [==============================] - 0s 20ms/step - loss: 0.4539 - acc: 0.8534
Epoch 12/30

16/16 [==============================] - 0s 20ms/step - loss: 0.4189 - acc: 0.8534
Epoch 13/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3886 - acc: 0.8563
Epoch 14/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3760 - acc: 0.8851
Epoch 15/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3841 - acc: 0.8563
Epoch 16/30

16/16 [==============================] - 0s 20ms/step - loss: 0.4141 - acc: 0.9282
Epoch 17/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3199 - acc: 0.8678
Epoch 18/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2911 - acc: 0.8966
Epoch 19/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2841 - acc: 0.8937
Epoch 20/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2632 - acc: 0.9138
Epoch 21/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2527 - acc: 0.9138
Epoch 22/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2357 - acc: 0.9167
Epoch 23/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2318 - acc: 0.9253
Epoch 24/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1993 - acc: 0.9511
Epoch 25/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2022 - acc: 0.9483
Epoch 26/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2040 - acc: 0.9454
Epoch 27/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1775 - acc: 0.9598
Epoch 28/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1747 - acc: 0.9569
Epoch 29/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1658 - acc: 0.9655
Epoch 30/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1582 - acc: 0.9655
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7179
False 1892
True percentage 0.791423216845
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.38      0.16      0.22       438
          O       0.88      0.95      0.91      7318
      B-ORG       0.43      0.36      0.39       296
     B-MISC       0.54      0.05      0.09       141
      I-ORG       0.00      0.00      0.00       151
      I-PER       1.00      0.07      0.12       214
     I-MISC       0.17      0.04      0.06       154
      B-LOC       0.18      0.02      0.03       218
      I-LOC       0.79      0.08      0.14       141

avg / total       0.79      0.79      0.77      9071

F-1 Score (without O):
0.841986856906
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100017 unique words.
Found 90 unique chars.
Found 9 unique labels.
13 unique words not found in embedding.
6 unique chars not found in embedding.
Number of OOV: 326
OOV word occurences: 636
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5824        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401152     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,458
Trainable params: 6,507,458
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

16/16 [==============================] - 2s 110ms/step - loss: 2.6250 - acc: 0.0441
Epoch 2/30

16/16 [==============================] - 0s 20ms/step - loss: 1.3899 - acc: 0.8176
Epoch 3/30

16/16 [==============================] - 0s 20ms/step - loss: 0.7637 - acc: 0.8265
Epoch 4/30

16/16 [==============================] - 0s 20ms/step - loss: 0.7292 - acc: 0.8265
Epoch 5/30

16/16 [==============================] - 0s 20ms/step - loss: 0.7105 - acc: 0.8265
Epoch 6/30

16/16 [==============================] - 0s 20ms/step - loss: 0.6920 - acc: 0.8265
Epoch 7/30

16/16 [==============================] - 0s 20ms/step - loss: 0.6210 - acc: 0.8265
Epoch 8/30

16/16 [==============================] - 0s 20ms/step - loss: 0.5691 - acc: 0.8265
Epoch 9/30

16/16 [==============================] - 0s 20ms/step - loss: 0.5370 - acc: 0.8265
Epoch 10/30

16/16 [==============================] - 0s 20ms/step - loss: 0.5001 - acc: 0.8294
Epoch 11/30

16/16 [==============================] - 0s 20ms/step - loss: 0.4711 - acc: 0.8353
Epoch 12/30

16/16 [==============================] - 0s 20ms/step - loss: 0.4472 - acc: 0.8441
Epoch 13/30

16/16 [==============================] - 0s 20ms/step - loss: 0.4191 - acc: 0.8353
Epoch 14/30

16/16 [==============================] - 0s 20ms/step - loss: 0.4004 - acc: 0.8735
Epoch 15/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3653 - acc: 0.8676
Epoch 16/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3456 - acc: 0.8794
Epoch 17/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3242 - acc: 0.9029
Epoch 18/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3039 - acc: 0.9088
Epoch 19/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2871 - acc: 0.9206
Epoch 20/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2543 - acc: 0.9353
Epoch 21/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2586 - acc: 0.9559
Epoch 22/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2630 - acc: 0.9088
Epoch 23/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2744 - acc: 0.9618
Epoch 24/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2133 - acc: 0.9441
Epoch 25/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1950 - acc: 0.9676
Epoch 26/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1808 - acc: 0.9647
Epoch 27/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1747 - acc: 0.9676
Epoch 28/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1573 - acc: 0.9735
Epoch 29/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1515 - acc: 0.9794
Epoch 30/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1389 - acc: 0.9706
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7141
False 1930
True percentage 0.787234042553
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.87      0.95      0.91      7318
      B-PER       0.62      0.14      0.23       438
      B-ORG       0.36      0.36      0.36       296
      I-ORG       0.17      0.01      0.01       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      I-PER       0.45      0.07      0.11       214
      B-LOC       0.50      0.03      0.05       218
      I-LOC       0.00      0.00      0.00       141

avg / total       0.77      0.79      0.76      9071

F-1 Score (without O):
0.171376481313
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 100036 unique words.
Found 94 unique chars.
Found 9 unique labels.
32 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 327
OOV word occurences: 640
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6402368     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,508,930
Trainable params: 6,508,930
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

16/16 [==============================] - 2s 110ms/step - loss: 2.5840 - acc: 0.0570
Epoch 2/30

16/16 [==============================] - 0s 20ms/step - loss: 1.7123 - acc: 0.7696
Epoch 3/30

16/16 [==============================] - 0s 20ms/step - loss: 0.9849 - acc: 0.7625
Epoch 4/30

16/16 [==============================] - 0s 20ms/step - loss: 1.0885 - acc: 0.7625
Epoch 5/30

16/16 [==============================] - 0s 20ms/step - loss: 1.1763 - acc: 0.8124
Epoch 6/30

16/16 [==============================] - 0s 20ms/step - loss: 0.7759 - acc: 0.7648
Epoch 7/30

16/16 [==============================] - 0s 20ms/step - loss: 0.7600 - acc: 0.7625
Epoch 8/30

16/16 [==============================] - 0s 20ms/step - loss: 0.6986 - acc: 0.7648
Epoch 9/30

16/16 [==============================] - 0s 20ms/step - loss: 0.6675 - acc: 0.7672
Epoch 10/30

16/16 [==============================] - 0s 20ms/step - loss: 0.6217 - acc: 0.7838
Epoch 11/30

16/16 [==============================] - 0s 20ms/step - loss: 0.5798 - acc: 0.7981
Epoch 12/30

16/16 [==============================] - 0s 20ms/step - loss: 0.5535 - acc: 0.8005
Epoch 13/30

16/16 [==============================] - 0s 20ms/step - loss: 0.5331 - acc: 0.8409
Epoch 14/30

16/16 [==============================] - 0s 20ms/step - loss: 0.4975 - acc: 0.8337
Epoch 15/30

16/16 [==============================] - 0s 20ms/step - loss: 0.4546 - acc: 0.8694
Epoch 16/30

16/16 [==============================] - 0s 20ms/step - loss: 0.4256 - acc: 0.8694
Epoch 17/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3856 - acc: 0.9002
Epoch 18/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3652 - acc: 0.9050
Epoch 19/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3545 - acc: 0.8955
Epoch 20/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3186 - acc: 0.9264
Epoch 21/30

16/16 [==============================] - 0s 21ms/step - loss: 0.3184 - acc: 0.9002
Epoch 22/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3058 - acc: 0.9359
Epoch 23/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2727 - acc: 0.9192
Epoch 24/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2639 - acc: 0.9454
Epoch 25/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2446 - acc: 0.9359
Epoch 26/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2310 - acc: 0.9549
Epoch 27/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2046 - acc: 0.9477
Epoch 28/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1953 - acc: 0.9596
Epoch 29/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1930 - acc: 0.9525
Epoch 30/30

16/16 [==============================] - 0s 21ms/step - loss: 0.1894 - acc: 0.9644
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7209
False 1862
True percentage 0.794730459707
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.89      0.95      0.92      7318
      B-ORG       0.39      0.28      0.33       296
      B-PER       0.40      0.19      0.26       438
      I-PER       0.46      0.06      0.10       214
      B-LOC       0.51      0.27      0.35       218
      I-LOC       0.00      0.00      0.00       141
      I-ORG       0.18      0.01      0.02       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.77      0.79      0.78      9071

F-1 Score (without O):
0.206008583691
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100013 unique words.
Found 85 unique chars.
Found 6 unique labels.
9 unique words not found in embedding.
1 unique chars not found in embedding.
Number of OOV: 328
OOV word occurences: 641
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5504        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6400896     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 7)        966         bidirectional_2[0][0]            
==================================================================================================
Total params: 6,506,438
Trainable params: 6,506,438
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

8/8 [==============================] - 2s 202ms/step - loss: 1.8646 - acc: 0.0939
Epoch 2/30

8/8 [==============================] - 0s 24ms/step - loss: 0.8165 - acc: 0.8729
Epoch 3/30

8/8 [==============================] - 0s 24ms/step - loss: 0.5997 - acc: 0.8729
Epoch 4/30

8/8 [==============================] - 0s 24ms/step - loss: 0.5509 - acc: 0.8729
Epoch 5/30

8/8 [==============================] - 0s 24ms/step - loss: 0.4855 - acc: 0.8729
Epoch 6/30

8/8 [==============================] - 0s 23ms/step - loss: 0.4463 - acc: 0.8729
Epoch 7/30

8/8 [==============================] - 0s 23ms/step - loss: 0.3996 - acc: 0.8729
Epoch 8/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3631 - acc: 0.8785
Epoch 9/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3467 - acc: 0.8785
Epoch 10/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3197 - acc: 0.8895
Epoch 11/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2899 - acc: 0.8840
Epoch 12/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2725 - acc: 0.9392
Epoch 13/30

8/8 [==============================] - 0s 23ms/step - loss: 0.2676 - acc: 0.8840
Epoch 14/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2376 - acc: 0.9503
Epoch 15/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1988 - acc: 0.9171
Epoch 16/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1763 - acc: 0.9669
Epoch 17/30

8/8 [==============================] - 0s 23ms/step - loss: 0.1575 - acc: 0.9503
Epoch 18/30

8/8 [==============================] - 0s 23ms/step - loss: 0.1537 - acc: 0.9669
Epoch 19/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1145 - acc: 0.9779
Epoch 20/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1118 - acc: 0.9613
Epoch 21/30

8/8 [==============================] - 0s 23ms/step - loss: 0.0929 - acc: 0.9834
Epoch 22/30

8/8 [==============================] - 0s 23ms/step - loss: 0.4910 - acc: 0.9061
Epoch 23/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3152 - acc: 0.9558
Epoch 24/30

8/8 [==============================] - 0s 23ms/step - loss: 0.1096 - acc: 0.9945
Epoch 25/30

8/8 [==============================] - 0s 23ms/step - loss: 0.0994 - acc: 0.9779
Epoch 26/30

8/8 [==============================] - 0s 23ms/step - loss: 0.0837 - acc: 0.9890
Epoch 27/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0824 - acc: 0.9834
Epoch 28/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0669 - acc: 0.9945
Epoch 29/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0740 - acc: 0.9834
Epoch 30/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0630 - acc: 0.9945
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7217
False 1418
True percentage 0.835784597568
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.87      0.96      0.91      7318
      B-PER       0.66      0.29      0.40       438
      B-ORG       0.50      0.29      0.37       296
      I-ORG       0.50      0.01      0.03       151
      I-PER       0.60      0.04      0.08       214
      B-LOC       0.00      0.00      0.00       218

avg / total       0.81      0.84      0.81      8635

F-1 Score (without O):
0.264394829612
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 100015 unique words.
Found 92 unique chars.
Found 6 unique labels.
11 unique words not found in embedding.
8 unique chars not found in embedding.
Number of OOV: 327
OOV word occurences: 639
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401024     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 7)        966         bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,014
Trainable params: 6,507,014
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

8/8 [==============================] - 2s 202ms/step - loss: 2.1529 - acc: 0.0325
Epoch 2/30

8/8 [==============================] - 0s 24ms/step - loss: 0.8864 - acc: 0.9026
Epoch 3/30

8/8 [==============================] - 0s 24ms/step - loss: 0.4634 - acc: 0.9026
Epoch 4/30

8/8 [==============================] - 0s 24ms/step - loss: 0.4350 - acc: 0.9026
Epoch 5/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3981 - acc: 0.9026
Epoch 6/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3623 - acc: 0.9026
Epoch 7/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3450 - acc: 0.9026
Epoch 8/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3273 - acc: 0.9026
Epoch 9/30

8/8 [==============================] - 0s 23ms/step - loss: 0.3106 - acc: 0.9091
Epoch 10/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2686 - acc: 0.9026
Epoch 11/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2563 - acc: 0.9026
Epoch 12/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2174 - acc: 0.9091
Epoch 13/30

8/8 [==============================] - 0s 23ms/step - loss: 0.2152 - acc: 0.9351
Epoch 14/30

8/8 [==============================] - 0s 23ms/step - loss: 0.1898 - acc: 0.9156
Epoch 15/30

8/8 [==============================] - 0s 23ms/step - loss: 0.1940 - acc: 0.9481
Epoch 16/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1636 - acc: 0.9286
Epoch 17/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1446 - acc: 0.9610
Epoch 18/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1315 - acc: 0.9481
Epoch 19/30

8/8 [==============================] - 0s 23ms/step - loss: 0.1198 - acc: 0.9740
Epoch 20/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1099 - acc: 0.9740
Epoch 21/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0967 - acc: 0.9740
Epoch 22/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0873 - acc: 0.9870
Epoch 23/30

8/8 [==============================] - 0s 23ms/step - loss: 0.0869 - acc: 0.9740
Epoch 24/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1061 - acc: 0.9935
Epoch 25/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0722 - acc: 0.9870
Epoch 26/30

8/8 [==============================] - 0s 23ms/step - loss: 0.0671 - acc: 0.9935
Epoch 27/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0668 - acc: 0.9870
Epoch 28/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0596 - acc: 0.9935
Epoch 29/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0561 - acc: 1.0000
Epoch 30/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0479 - acc: 0.9935
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7053
False 1505
True percentage 0.824141154475
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.34      0.06      0.10       438
          O       0.85      0.96      0.90      7318
      B-ORG       0.30      0.07      0.11       296
     B-MISC       0.00      0.00      0.00       141
      I-ORG       0.00      0.00      0.00       151
      I-PER       1.00      0.01      0.02       214

avg / total       0.78      0.82      0.78      8558

F-1 Score (without O):
0.853016142736
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100010 unique words.
Found 89 unique chars.
Found 9 unique labels.
6 unique words not found in embedding.
5 unique chars not found in embedding.
Number of OOV: 328
OOV word occurences: 641
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5760        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6400704     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,506,946
Trainable params: 6,506,946
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

8/8 [==============================] - 2s 203ms/step - loss: 2.5786 - acc: 0.0520
Epoch 2/30

8/8 [==============================] - 0s 24ms/step - loss: 1.4829 - acc: 0.8208
Epoch 3/30

8/8 [==============================] - 0s 24ms/step - loss: 0.8135 - acc: 0.8208
Epoch 4/30

8/8 [==============================] - 0s 24ms/step - loss: 0.7648 - acc: 0.8208
Epoch 5/30

8/8 [==============================] - 0s 24ms/step - loss: 0.7535 - acc: 0.8208
Epoch 6/30

8/8 [==============================] - 0s 24ms/step - loss: 0.7319 - acc: 0.8208
Epoch 7/30

8/8 [==============================] - 0s 24ms/step - loss: 0.6444 - acc: 0.8208
Epoch 8/30

8/8 [==============================] - 0s 24ms/step - loss: 0.6028 - acc: 0.8208
Epoch 9/30

8/8 [==============================] - 0s 24ms/step - loss: 0.5665 - acc: 0.8208
Epoch 10/30

8/8 [==============================] - 0s 24ms/step - loss: 0.5186 - acc: 0.8208
Epoch 11/30

8/8 [==============================] - 0s 24ms/step - loss: 0.4914 - acc: 0.8208
Epoch 12/30

8/8 [==============================] - 0s 24ms/step - loss: 0.4483 - acc: 0.8439
Epoch 13/30

8/8 [==============================] - 0s 24ms/step - loss: 0.4161 - acc: 0.8497
Epoch 14/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3930 - acc: 0.8671
Epoch 15/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3625 - acc: 0.8728
Epoch 16/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3508 - acc: 0.9191
Epoch 17/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3014 - acc: 0.8902
Epoch 18/30

8/8 [==============================] - 0s 23ms/step - loss: 0.2857 - acc: 0.9538
Epoch 19/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2682 - acc: 0.9191
Epoch 20/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2536 - acc: 0.9249
Epoch 21/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2320 - acc: 0.9422
Epoch 22/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2472 - acc: 0.9480
Epoch 23/30

8/8 [==============================] - 0s 25ms/step - loss: 0.2298 - acc: 0.9191
Epoch 24/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2348 - acc: 0.9653
Epoch 25/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1949 - acc: 0.9653
Epoch 26/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1670 - acc: 0.9769
Epoch 27/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1799 - acc: 0.9653
Epoch 28/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1489 - acc: 0.9827
Epoch 29/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1486 - acc: 0.9769
Epoch 30/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1400 - acc: 0.9711
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7053
False 2018
True percentage 0.777532796825
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.87      0.94      0.90      7318
      B-PER       0.69      0.11      0.19       438
      B-ORG       0.25      0.31      0.28       296
      I-ORG       0.00      0.00      0.00       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      I-PER       0.45      0.02      0.04       214
      B-LOC       0.38      0.01      0.03       218
      I-LOC       0.00      0.00      0.00       141

avg / total       0.76      0.78      0.75      9071

F-1 Score (without O):
0.134118713185
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 100013 unique words.
Found 93 unique chars.
Found 9 unique labels.
9 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 327
OOV word occurences: 640
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6400896     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,394
Trainable params: 6,507,394
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

8/8 [==============================] - 2s 203ms/step - loss: 2.5093 - acc: 0.0110
Epoch 2/30

8/8 [==============================] - 0s 24ms/step - loss: 1.3731 - acc: 0.7238
Epoch 3/30

8/8 [==============================] - 0s 24ms/step - loss: 1.2563 - acc: 0.7238
Epoch 4/30

8/8 [==============================] - 0s 24ms/step - loss: 1.1216 - acc: 0.7293
Epoch 5/30

8/8 [==============================] - 0s 24ms/step - loss: 0.9436 - acc: 0.7238
Epoch 6/30

8/8 [==============================] - 0s 24ms/step - loss: 0.9103 - acc: 0.7348
Epoch 7/30

8/8 [==============================] - 0s 24ms/step - loss: 0.8404 - acc: 0.7293
Epoch 8/30

8/8 [==============================] - 0s 24ms/step - loss: 0.7742 - acc: 0.7569
Epoch 9/30

8/8 [==============================] - 0s 24ms/step - loss: 0.7306 - acc: 0.7459
Epoch 10/30

8/8 [==============================] - 0s 24ms/step - loss: 0.6880 - acc: 0.7845
Epoch 11/30

8/8 [==============================] - 0s 24ms/step - loss: 0.6289 - acc: 0.7680
Epoch 12/30

8/8 [==============================] - 0s 24ms/step - loss: 0.6028 - acc: 0.8177
Epoch 13/30

8/8 [==============================] - 0s 24ms/step - loss: 0.5491 - acc: 0.8232
Epoch 14/30

8/8 [==============================] - 0s 24ms/step - loss: 0.4991 - acc: 0.8619
Epoch 15/30

8/8 [==============================] - 0s 24ms/step - loss: 0.4661 - acc: 0.8674
Epoch 16/30

8/8 [==============================] - 0s 24ms/step - loss: 0.4185 - acc: 0.8895
Epoch 17/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3723 - acc: 0.8950
Epoch 18/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3364 - acc: 0.9227
Epoch 19/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3289 - acc: 0.9227
Epoch 20/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2978 - acc: 0.9116
Epoch 21/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2940 - acc: 0.9613
Epoch 22/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2566 - acc: 0.9337
Epoch 23/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2489 - acc: 0.9503
Epoch 24/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2224 - acc: 0.9503
Epoch 25/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2030 - acc: 0.9503
Epoch 26/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1996 - acc: 0.9613
Epoch 27/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1612 - acc: 0.9558
Epoch 28/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1573 - acc: 0.9834
Epoch 29/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1499 - acc: 0.9724
Epoch 30/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1483 - acc: 0.9890
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7261
False 1810
True percentage 0.800463014001
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.89      0.95      0.92      7318
      B-ORG       0.49      0.30      0.37       296
      B-PER       0.47      0.24      0.31       438
      I-PER       0.42      0.07      0.13       214
      B-LOC       0.40      0.31      0.35       218
      I-LOC       0.00      0.00      0.00       141
      I-ORG       0.25      0.01      0.01       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.78      0.80      0.78      9071

F-1 Score (without O):
0.233601354211
