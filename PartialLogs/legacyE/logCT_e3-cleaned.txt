Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

1674/1674 [==============================] - 37s 22ms/step - loss: 0.3912 - acc: 0.8817
Epoch 2/30

1674/1674 [==============================] - 35s 21ms/step - loss: 0.2254 - acc: 0.9336
Epoch 3/30

1674/1674 [==============================] - 35s 21ms/step - loss: 0.1761 - acc: 0.9477
Epoch 4/30

1674/1674 [==============================] - 35s 21ms/step - loss: 0.1497 - acc: 0.9567
Epoch 5/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.1288 - acc: 0.9617
Epoch 6/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.1132 - acc: 0.9667
Epoch 7/30

1674/1674 [==============================] - 35s 21ms/step - loss: 0.1008 - acc: 0.9703
Epoch 8/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0906 - acc: 0.9736
Epoch 9/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0848 - acc: 0.9755
Epoch 10/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0767 - acc: 0.9782
Epoch 11/30

1674/1674 [==============================] - 35s 21ms/step - loss: 0.0708 - acc: 0.9792
Epoch 12/30

1674/1674 [==============================] - 35s 21ms/step - loss: 0.0646 - acc: 0.9826
Epoch 13/30

1674/1674 [==============================] - 35s 21ms/step - loss: 0.0619 - acc: 0.9824
Epoch 14/30

1674/1674 [==============================] - 35s 21ms/step - loss: 0.0559 - acc: 0.9838
Epoch 15/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0523 - acc: 0.9851
Epoch 16/30

1674/1674 [==============================] - 35s 21ms/step - loss: 0.0496 - acc: 0.9866
Epoch 17/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0466 - acc: 0.9873
Epoch 18/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0439 - acc: 0.9880
Epoch 19/30

1674/1674 [==============================] - 35s 21ms/step - loss: 0.0415 - acc: 0.9879
Epoch 20/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0387 - acc: 0.9889
Epoch 21/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0394 - acc: 0.9888
Epoch 22/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0359 - acc: 0.9896
Epoch 23/30

1674/1674 [==============================] - 35s 21ms/step - loss: 0.0351 - acc: 0.9904
Epoch 24/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0344 - acc: 0.9904
Epoch 25/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0320 - acc: 0.9910
Epoch 26/30

1674/1674 [==============================] - 35s 21ms/step - loss: 0.0323 - acc: 0.9908
Epoch 27/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0290 - acc: 0.9921
Epoch 28/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0280 - acc: 0.9917
Epoch 29/30

1674/1674 [==============================] - 35s 21ms/step - loss: 0.0272 - acc: 0.9928
Epoch 30/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0277 - acc: 0.9920
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8253
False 818
True percentage 0.9098225113
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
      B-PER       0.91      0.84      0.88       438
      B-ORG       0.76      0.73      0.74       296
      I-ORG       0.62      0.62      0.62       151
      I-PER       0.91      0.64      0.75       214
      B-LOC       0.75      0.72      0.73       218
     B-MISC       0.42      0.32      0.36       141
      I-LOC       0.74      0.82      0.77       141
     I-MISC       0.52      0.45      0.48       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.717948717949
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

1674/1674 [==============================] - 36s 21ms/step - loss: 0.4259 - acc: 0.8693
Epoch 2/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.2502 - acc: 0.9240
Epoch 3/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.1972 - acc: 0.9412
Epoch 4/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.1647 - acc: 0.9514
Epoch 5/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.1396 - acc: 0.9586
Epoch 6/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.1209 - acc: 0.9654
Epoch 7/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.1067 - acc: 0.9700
Epoch 8/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0982 - acc: 0.9728
Epoch 9/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0889 - acc: 0.9744
Epoch 10/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0798 - acc: 0.9765
Epoch 11/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0727 - acc: 0.9791
Epoch 12/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0676 - acc: 0.9814
Epoch 13/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0632 - acc: 0.9830
Epoch 14/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0585 - acc: 0.9838
Epoch 15/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0561 - acc: 0.9841
Epoch 16/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0520 - acc: 0.9856
Epoch 17/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0478 - acc: 0.9869
Epoch 18/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0455 - acc: 0.9876
Epoch 19/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0444 - acc: 0.9871
Epoch 20/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0410 - acc: 0.9883
Epoch 21/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0399 - acc: 0.9884
Epoch 22/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0367 - acc: 0.9897
Epoch 23/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0354 - acc: 0.9895
Epoch 24/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0344 - acc: 0.9905
Epoch 25/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0332 - acc: 0.9906
Epoch 26/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0315 - acc: 0.9908
Epoch 27/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0307 - acc: 0.9909
Epoch 28/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0285 - acc: 0.9921
Epoch 29/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0276 - acc: 0.9920
Epoch 30/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0269 - acc: 0.9924
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8234
False 837
True percentage 0.907727924154
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.90      0.82      0.86       438
          O       0.98      0.96      0.97      7318
      B-ORG       0.78      0.74      0.76       296
     B-MISC       0.41      0.29      0.34       141
      I-ORG       0.59      0.62      0.60       151
      I-PER       0.82      0.65      0.73       214
     I-MISC       0.52      0.41      0.46       154
      B-LOC       0.77      0.78      0.77       218
      I-LOC       0.73      0.77      0.75       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.927015891701
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104767 unique words.
4763 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 244
OOV word occurences: in test 345
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6705152     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,817,282
Trainable params: 6,817,282
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

837/837 [==============================] - 18s 22ms/step - loss: 0.5238 - acc: 0.8398
Epoch 2/30

837/837 [==============================] - 17s 21ms/step - loss: 0.3114 - acc: 0.9035
Epoch 3/30

837/837 [==============================] - 17s 21ms/step - loss: 0.2503 - acc: 0.9225
Epoch 4/30

837/837 [==============================] - 17s 21ms/step - loss: 0.2108 - acc: 0.9350
Epoch 5/30

837/837 [==============================] - 17s 21ms/step - loss: 0.1826 - acc: 0.9441
Epoch 6/30

837/837 [==============================] - 17s 21ms/step - loss: 0.1611 - acc: 0.9539
Epoch 7/30

837/837 [==============================] - 17s 21ms/step - loss: 0.1426 - acc: 0.9597
Epoch 8/30

837/837 [==============================] - 17s 21ms/step - loss: 0.1302 - acc: 0.9643
Epoch 9/30

837/837 [==============================] - 17s 21ms/step - loss: 0.1173 - acc: 0.9663
Epoch 10/30

837/837 [==============================] - 17s 21ms/step - loss: 0.1076 - acc: 0.9703
Epoch 11/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0968 - acc: 0.9732
Epoch 12/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0888 - acc: 0.9760
Epoch 13/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0808 - acc: 0.9783
Epoch 14/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0763 - acc: 0.9802
Epoch 15/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0699 - acc: 0.9826
Epoch 16/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0665 - acc: 0.9822
Epoch 17/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0607 - acc: 0.9848
Epoch 18/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0568 - acc: 0.9854
Epoch 19/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0533 - acc: 0.9859
Epoch 20/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0518 - acc: 0.9865
Epoch 21/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0480 - acc: 0.9870
Epoch 22/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0457 - acc: 0.9891
Epoch 23/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0428 - acc: 0.9887
Epoch 24/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0417 - acc: 0.9901
Epoch 25/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0395 - acc: 0.9904
Epoch 26/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0357 - acc: 0.9914
Epoch 27/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0339 - acc: 0.9917
Epoch 28/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0344 - acc: 0.9910
Epoch 29/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0316 - acc: 0.9920
Epoch 30/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0303 - acc: 0.9931
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8192
False 879
True percentage 0.903097784147
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.89      0.82      0.85       438
      B-ORG       0.78      0.71      0.74       296
      I-ORG       0.58      0.50      0.54       151
      I-PER       0.86      0.62      0.72       214
      B-LOC       0.66      0.77      0.71       218
     B-MISC       0.47      0.32      0.38       141
      I-LOC       0.72      0.79      0.76       141
     I-MISC       0.54      0.41      0.46       154

avg / total       0.94      0.90      0.92      9071

F-1 Score (without O):
0.700059988002
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104756 unique words.
4752 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 245
OOV word occurences: in test 380
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6704448     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,816,578
Trainable params: 6,816,578
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

837/837 [==============================] - 18s 22ms/step - loss: 0.5157 - acc: 0.8397
Epoch 2/30

837/837 [==============================] - 17s 21ms/step - loss: 0.3078 - acc: 0.9067
Epoch 3/30

837/837 [==============================] - 17s 21ms/step - loss: 0.2513 - acc: 0.9243
Epoch 4/30

837/837 [==============================] - 17s 21ms/step - loss: 0.2078 - acc: 0.9380
Epoch 5/30

837/837 [==============================] - 17s 21ms/step - loss: 0.1821 - acc: 0.9469
Epoch 6/30

837/837 [==============================] - 17s 21ms/step - loss: 0.1570 - acc: 0.9529
Epoch 7/30

837/837 [==============================] - 17s 21ms/step - loss: 0.1414 - acc: 0.9594
Epoch 8/30

837/837 [==============================] - 17s 21ms/step - loss: 0.1257 - acc: 0.9640
Epoch 9/30

837/837 [==============================] - 17s 21ms/step - loss: 0.1131 - acc: 0.9680
Epoch 10/30

837/837 [==============================] - 17s 21ms/step - loss: 0.1026 - acc: 0.9704
Epoch 11/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0942 - acc: 0.9750
Epoch 12/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0868 - acc: 0.9778
Epoch 13/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0801 - acc: 0.9780
Epoch 14/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0728 - acc: 0.9802
Epoch 15/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0679 - acc: 0.9806
Epoch 16/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0607 - acc: 0.9851
Epoch 17/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0578 - acc: 0.9854
Epoch 18/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0542 - acc: 0.9853
Epoch 19/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0491 - acc: 0.9874
Epoch 20/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0484 - acc: 0.9876
Epoch 21/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0456 - acc: 0.9884
Epoch 22/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0441 - acc: 0.9887
Epoch 23/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0409 - acc: 0.9890
Epoch 24/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0383 - acc: 0.9906
Epoch 25/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0392 - acc: 0.9899
Epoch 26/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0354 - acc: 0.9912
Epoch 27/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0347 - acc: 0.9912
Epoch 28/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0309 - acc: 0.9926
Epoch 29/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0304 - acc: 0.9922
Epoch 30/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0289 - acc: 0.9922
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8099
False 972
True percentage 0.892845331275
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.89      0.75      0.82       438
          O       0.99      0.95      0.97      7318
      B-ORG       0.70      0.72      0.71       296
     B-MISC       0.35      0.40      0.37       141
      I-ORG       0.52      0.50      0.51       151
      I-PER       0.94      0.60      0.74       214
     I-MISC       0.41      0.47      0.44       154
      B-LOC       0.74      0.74      0.74       218
      I-LOC       0.69      0.80      0.74       141

avg / total       0.94      0.89      0.91      9071

F-1 Score (without O):
0.916489738146
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104723 unique words.
4719 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 249
OOV word occurences: in test 356
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6702336     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,814,466
Trainable params: 6,814,466
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

837/837 [==============================] - 18s 22ms/step - loss: 0.4890 - acc: 0.8505
Epoch 2/30

837/837 [==============================] - 17s 21ms/step - loss: 0.2914 - acc: 0.9128
Epoch 3/30

837/837 [==============================] - 17s 21ms/step - loss: 0.2338 - acc: 0.9307
Epoch 4/30

837/837 [==============================] - 17s 21ms/step - loss: 0.1975 - acc: 0.9402
Epoch 5/30

837/837 [==============================] - 17s 21ms/step - loss: 0.1714 - acc: 0.9504
Epoch 6/30

837/837 [==============================] - 17s 21ms/step - loss: 0.1495 - acc: 0.9574
Epoch 7/30

837/837 [==============================] - 17s 21ms/step - loss: 0.1334 - acc: 0.9622
Epoch 8/30

837/837 [==============================] - 17s 21ms/step - loss: 0.1208 - acc: 0.9646
Epoch 9/30

837/837 [==============================] - 17s 21ms/step - loss: 0.1078 - acc: 0.9702
Epoch 10/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0993 - acc: 0.9725
Epoch 11/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0893 - acc: 0.9761
Epoch 12/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0827 - acc: 0.9764
Epoch 13/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0746 - acc: 0.9800
Epoch 14/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0712 - acc: 0.9807
Epoch 15/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0641 - acc: 0.9823
Epoch 16/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0631 - acc: 0.9830
Epoch 17/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0577 - acc: 0.9842
Epoch 18/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0530 - acc: 0.9858
Epoch 19/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0498 - acc: 0.9871
Epoch 20/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0497 - acc: 0.9867
Epoch 21/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0437 - acc: 0.9883
Epoch 22/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0419 - acc: 0.9888
Epoch 23/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0403 - acc: 0.9900
Epoch 24/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0383 - acc: 0.9900
Epoch 25/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0350 - acc: 0.9905
Epoch 26/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0352 - acc: 0.9905
Epoch 27/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0338 - acc: 0.9905
Epoch 28/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0306 - acc: 0.9926
Epoch 29/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0304 - acc: 0.9922
Epoch 30/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0281 - acc: 0.9928
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8179
False 892
True percentage 0.901664645574
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
      B-PER       0.88      0.83      0.86       438
      B-ORG       0.68      0.77      0.72       296
      I-ORG       0.49      0.59      0.54       151
     B-MISC       0.48      0.30      0.37       141
     I-MISC       0.51      0.40      0.45       154
      I-PER       0.89      0.65      0.75       214
      B-LOC       0.75      0.68      0.71       218
      I-LOC       0.75      0.77      0.76       141

avg / total       0.94      0.90      0.92      9071

F-1 Score (without O):
0.698113207547
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104352 unique words.
4348 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 266
OOV word occurences: in test 428
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678592     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,722
Trainable params: 6,790,722
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

334/334 [==============================] - 8s 24ms/step - loss: 0.6740 - acc: 0.7967
Epoch 2/30

334/334 [==============================] - 7s 20ms/step - loss: 0.3799 - acc: 0.8835
Epoch 3/30

334/334 [==============================] - 7s 20ms/step - loss: 0.3149 - acc: 0.9061
Epoch 4/30

334/334 [==============================] - 7s 21ms/step - loss: 0.2679 - acc: 0.9237
Epoch 5/30

334/334 [==============================] - 7s 20ms/step - loss: 0.2254 - acc: 0.9399
Epoch 6/30

334/334 [==============================] - 7s 21ms/step - loss: 0.2020 - acc: 0.9443
Epoch 7/30

334/334 [==============================] - 7s 21ms/step - loss: 0.1789 - acc: 0.9521
Epoch 8/30

334/334 [==============================] - 7s 21ms/step - loss: 0.1610 - acc: 0.9575
Epoch 9/30

334/334 [==============================] - 7s 21ms/step - loss: 0.1422 - acc: 0.9622
Epoch 10/30

334/334 [==============================] - 7s 21ms/step - loss: 0.1331 - acc: 0.9634
Epoch 11/30

334/334 [==============================] - 7s 21ms/step - loss: 0.1214 - acc: 0.9708
Epoch 12/30

334/334 [==============================] - 7s 21ms/step - loss: 0.1075 - acc: 0.9752
Epoch 13/30

334/334 [==============================] - 7s 21ms/step - loss: 0.1017 - acc: 0.9765
Epoch 14/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0900 - acc: 0.9807
Epoch 15/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0847 - acc: 0.9817
Epoch 16/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0791 - acc: 0.9819
Epoch 17/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0770 - acc: 0.9823
Epoch 18/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0680 - acc: 0.9852
Epoch 19/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0647 - acc: 0.9860
Epoch 20/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0596 - acc: 0.9876
Epoch 21/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0543 - acc: 0.9890
Epoch 22/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0534 - acc: 0.9888
Epoch 23/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0479 - acc: 0.9899
Epoch 24/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0458 - acc: 0.9906
Epoch 25/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0430 - acc: 0.9908
Epoch 26/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0425 - acc: 0.9916
Epoch 27/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0419 - acc: 0.9909
Epoch 28/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0398 - acc: 0.9918
Epoch 29/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0339 - acc: 0.9945
Epoch 30/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0330 - acc: 0.9933
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8028
False 1043
True percentage 0.885018189836
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.88      0.72      0.80       438
      B-ORG       0.65      0.61      0.63       296
      I-ORG       0.40      0.54      0.46       151
      I-PER       0.85      0.60      0.70       214
      B-LOC       0.72      0.71      0.71       218
     B-MISC       0.41      0.17      0.24       141
      I-LOC       0.68      0.75      0.72       141
     I-MISC       0.55      0.12      0.19       154

avg / total       0.92      0.89      0.90      9071

F-1 Score (without O):
0.62960649594
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104358 unique words.
4354 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 261
OOV word occurences: in test 412
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678976     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,791,106
Trainable params: 6,791,106
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

334/334 [==============================] - 8s 24ms/step - loss: 0.6772 - acc: 0.7934
Epoch 2/30

334/334 [==============================] - 7s 20ms/step - loss: 0.3838 - acc: 0.8795
Epoch 3/30

334/334 [==============================] - 7s 21ms/step - loss: 0.3118 - acc: 0.9067
Epoch 4/30

334/334 [==============================] - 7s 21ms/step - loss: 0.2700 - acc: 0.9228
Epoch 5/30

334/334 [==============================] - 7s 20ms/step - loss: 0.2360 - acc: 0.9337
Epoch 6/30

334/334 [==============================] - 7s 21ms/step - loss: 0.2053 - acc: 0.9389
Epoch 7/30

334/334 [==============================] - 7s 21ms/step - loss: 0.1841 - acc: 0.9469
Epoch 8/30

334/334 [==============================] - 7s 21ms/step - loss: 0.1623 - acc: 0.9546
Epoch 9/30

334/334 [==============================] - 7s 21ms/step - loss: 0.1481 - acc: 0.9583
Epoch 10/30

334/334 [==============================] - 7s 21ms/step - loss: 0.1377 - acc: 0.9633
Epoch 11/30

334/334 [==============================] - 7s 21ms/step - loss: 0.1219 - acc: 0.9671
Epoch 12/30

334/334 [==============================] - 7s 21ms/step - loss: 0.1101 - acc: 0.9741
Epoch 13/30

334/334 [==============================] - 7s 21ms/step - loss: 0.1002 - acc: 0.9748
Epoch 14/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0948 - acc: 0.9768
Epoch 15/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0830 - acc: 0.9813
Epoch 16/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0812 - acc: 0.9823
Epoch 17/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0749 - acc: 0.9829
Epoch 18/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0693 - acc: 0.9840
Epoch 19/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0659 - acc: 0.9835
Epoch 20/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0608 - acc: 0.9862
Epoch 21/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0580 - acc: 0.9873
Epoch 22/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0512 - acc: 0.9894
Epoch 23/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0485 - acc: 0.9898
Epoch 24/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0456 - acc: 0.9900
Epoch 25/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0445 - acc: 0.9910
Epoch 26/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0399 - acc: 0.9919
Epoch 27/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0395 - acc: 0.9914
Epoch 28/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0381 - acc: 0.9928
Epoch 29/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0349 - acc: 0.9934
Epoch 30/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0305 - acc: 0.9937
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7965
False 1106
True percentage 0.878072979826
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.83      0.63      0.72       438
          O       0.98      0.95      0.97      7318
      B-ORG       0.69      0.60      0.64       296
     B-MISC       0.36      0.31      0.33       141
      I-ORG       0.44      0.30      0.36       151
      I-PER       0.73      0.60      0.66       214
     I-MISC       0.34      0.41      0.37       154
      B-LOC       0.70      0.69      0.69       218
      I-LOC       0.69      0.74      0.71       141

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.906710697016
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104340 unique words.
4336 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 268
OOV word occurences: in test 411
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6677824     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,789,954
Trainable params: 6,789,954
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

334/334 [==============================] - 8s 24ms/step - loss: 0.6666 - acc: 0.7983
Epoch 2/30

334/334 [==============================] - 7s 20ms/step - loss: 0.3760 - acc: 0.8871
Epoch 3/30

334/334 [==============================] - 7s 21ms/step - loss: 0.2966 - acc: 0.9122
Epoch 4/30

334/334 [==============================] - 7s 21ms/step - loss: 0.2551 - acc: 0.9273
Epoch 5/30

334/334 [==============================] - 7s 21ms/step - loss: 0.2220 - acc: 0.9372
Epoch 6/30

334/334 [==============================] - 7s 21ms/step - loss: 0.1923 - acc: 0.9484
Epoch 7/30

334/334 [==============================] - 7s 21ms/step - loss: 0.1695 - acc: 0.9546
Epoch 8/30

334/334 [==============================] - 7s 21ms/step - loss: 0.1524 - acc: 0.9610
Epoch 9/30

334/334 [==============================] - 7s 21ms/step - loss: 0.1350 - acc: 0.9648
Epoch 10/30

334/334 [==============================] - 7s 21ms/step - loss: 0.1230 - acc: 0.9707
Epoch 11/30

334/334 [==============================] - 7s 21ms/step - loss: 0.1151 - acc: 0.9715
Epoch 12/30

334/334 [==============================] - 7s 21ms/step - loss: 0.1048 - acc: 0.9762
Epoch 13/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0950 - acc: 0.9766
Epoch 14/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0885 - acc: 0.9769
Epoch 15/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0786 - acc: 0.9825
Epoch 16/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0731 - acc: 0.9823
Epoch 17/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0718 - acc: 0.9823
Epoch 18/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0639 - acc: 0.9870
Epoch 19/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0649 - acc: 0.9855
Epoch 20/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0563 - acc: 0.9880
Epoch 21/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0509 - acc: 0.9887
Epoch 22/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0501 - acc: 0.9889
Epoch 23/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0479 - acc: 0.9896
Epoch 24/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0416 - acc: 0.9924
Epoch 25/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0404 - acc: 0.9919
Epoch 26/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0398 - acc: 0.9916
Epoch 27/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0364 - acc: 0.9929
Epoch 28/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0360 - acc: 0.9925
Epoch 29/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0339 - acc: 0.9937
Epoch 30/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0322 - acc: 0.9935
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7976
False 1095
True percentage 0.879285635542
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.97      7318
      B-PER       0.86      0.67      0.75       438
      B-ORG       0.63      0.65      0.64       296
      I-ORG       0.39      0.46      0.42       151
     B-MISC       0.37      0.30      0.33       141
     I-MISC       0.37      0.40      0.38       154
      I-PER       0.83      0.58      0.68       214
      B-LOC       0.69      0.70      0.70       218
      I-LOC       0.76      0.62      0.68       141

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.612025127131
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104194 unique words.
4190 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 275
OOV word occurences: in test 464
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6668480     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,780,610
Trainable params: 6,780,610
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

167/167 [==============================] - 5s 28ms/step - loss: 0.8747 - acc: 0.7434
Epoch 2/30

167/167 [==============================] - 3s 21ms/step - loss: 0.4602 - acc: 0.8575
Epoch 3/30

167/167 [==============================] - 3s 21ms/step - loss: 0.3768 - acc: 0.8867
Epoch 4/30

167/167 [==============================] - 3s 21ms/step - loss: 0.3385 - acc: 0.8975
Epoch 5/30

167/167 [==============================] - 3s 21ms/step - loss: 0.2904 - acc: 0.9139
Epoch 6/30

167/167 [==============================] - 3s 21ms/step - loss: 0.2640 - acc: 0.9249
Epoch 7/30

167/167 [==============================] - 3s 21ms/step - loss: 0.2389 - acc: 0.9316
Epoch 8/30

167/167 [==============================] - 3s 21ms/step - loss: 0.2233 - acc: 0.9389
Epoch 9/30

167/167 [==============================] - 3s 21ms/step - loss: 0.2076 - acc: 0.9403
Epoch 10/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1868 - acc: 0.9477
Epoch 11/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1719 - acc: 0.9536
Epoch 12/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1564 - acc: 0.9595
Epoch 13/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1502 - acc: 0.9605
Epoch 14/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1385 - acc: 0.9679
Epoch 15/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1305 - acc: 0.9736
Epoch 16/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1161 - acc: 0.9759
Epoch 17/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1098 - acc: 0.9759
Epoch 18/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1036 - acc: 0.9772
Epoch 19/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0977 - acc: 0.9816
Epoch 20/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0900 - acc: 0.9821
Epoch 21/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0837 - acc: 0.9836
Epoch 22/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0844 - acc: 0.9830
Epoch 23/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0723 - acc: 0.9871
Epoch 24/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0726 - acc: 0.9870
Epoch 25/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0691 - acc: 0.9877
Epoch 26/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0640 - acc: 0.9885
Epoch 27/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0588 - acc: 0.9903
Epoch 28/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0552 - acc: 0.9900
Epoch 29/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0562 - acc: 0.9889
Epoch 30/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0517 - acc: 0.9921
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7941
False 1130
True percentage 0.875427185536
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.96      0.96      7318
      B-PER       0.87      0.71      0.78       438
      B-ORG       0.54      0.66      0.60       296
      I-ORG       0.36      0.45      0.40       151
      I-PER       0.86      0.59      0.70       214
      B-LOC       0.80      0.61      0.69       218
     B-MISC       0.73      0.11      0.20       141
      I-LOC       0.67      0.55      0.60       141
     I-MISC       0.39      0.10      0.16       154

avg / total       0.92      0.88      0.89      9071

F-1 Score (without O):
0.599236641221
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104203 unique words.
4199 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 272
OOV word occurences: in test 526
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6669056     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,781,186
Trainable params: 6,781,186
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

167/167 [==============================] - 5s 28ms/step - loss: 1.0010 - acc: 0.7325
Epoch 2/30

167/167 [==============================] - 3s 21ms/step - loss: 0.4466 - acc: 0.8688
Epoch 3/30

167/167 [==============================] - 3s 21ms/step - loss: 0.3872 - acc: 0.8783
Epoch 4/30

167/167 [==============================] - 3s 21ms/step - loss: 0.3470 - acc: 0.8891
Epoch 5/30

167/167 [==============================] - 3s 21ms/step - loss: 0.3200 - acc: 0.8993
Epoch 6/30

167/167 [==============================] - 3s 21ms/step - loss: 0.2840 - acc: 0.9124
Epoch 7/30

167/167 [==============================] - 3s 21ms/step - loss: 0.2593 - acc: 0.9227
Epoch 8/30

167/167 [==============================] - 3s 21ms/step - loss: 0.2442 - acc: 0.9280
Epoch 9/30

167/167 [==============================] - 3s 21ms/step - loss: 0.2210 - acc: 0.9362
Epoch 10/30

167/167 [==============================] - 3s 21ms/step - loss: 0.2066 - acc: 0.9380
Epoch 11/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1926 - acc: 0.9497
Epoch 12/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1802 - acc: 0.9504
Epoch 13/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1681 - acc: 0.9557
Epoch 14/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1522 - acc: 0.9586
Epoch 15/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1447 - acc: 0.9643
Epoch 16/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1370 - acc: 0.9678
Epoch 17/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1239 - acc: 0.9715
Epoch 18/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1195 - acc: 0.9704
Epoch 19/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1100 - acc: 0.9762
Epoch 20/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0995 - acc: 0.9793
Epoch 21/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0942 - acc: 0.9810
Epoch 22/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0908 - acc: 0.9814
Epoch 23/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0819 - acc: 0.9827
Epoch 24/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0798 - acc: 0.9850
Epoch 25/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0770 - acc: 0.9847
Epoch 26/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0695 - acc: 0.9862
Epoch 27/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0644 - acc: 0.9891
Epoch 28/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0644 - acc: 0.9882
Epoch 29/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0607 - acc: 0.9897
Epoch 30/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0580 - acc: 0.9886
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7688
False 1383
True percentage 0.847536104068
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.75      0.45      0.56       438
          O       0.98      0.95      0.96      7318
      B-ORG       0.50      0.51      0.50       296
     B-MISC       0.35      0.27      0.30       141
      I-ORG       0.24      0.33      0.28       151
      I-PER       0.66      0.40      0.50       214
     I-MISC       0.33      0.29      0.31       154
      B-LOC       0.76      0.61      0.68       218
      I-LOC       0.52      0.45      0.48       141

avg / total       0.90      0.85      0.87      9071

F-1 Score (without O):
0.885749748803
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104185 unique words.
4181 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 272
OOV word occurences: in test 428
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6667904     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,780,034
Trainable params: 6,780,034
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

167/167 [==============================] - 5s 28ms/step - loss: 0.8512 - acc: 0.7437
Epoch 2/30

167/167 [==============================] - 3s 21ms/step - loss: 0.4442 - acc: 0.8608
Epoch 3/30

167/167 [==============================] - 3s 21ms/step - loss: 0.3716 - acc: 0.8917
Epoch 4/30

167/167 [==============================] - 3s 21ms/step - loss: 0.3266 - acc: 0.9005
Epoch 5/30

167/167 [==============================] - 3s 21ms/step - loss: 0.2862 - acc: 0.9171
Epoch 6/30

167/167 [==============================] - 3s 21ms/step - loss: 0.2588 - acc: 0.9266
Epoch 7/30

167/167 [==============================] - 3s 21ms/step - loss: 0.2299 - acc: 0.9375
Epoch 8/30

167/167 [==============================] - 3s 21ms/step - loss: 0.2101 - acc: 0.9420
Epoch 9/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1876 - acc: 0.9540
Epoch 10/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1745 - acc: 0.9522
Epoch 11/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1579 - acc: 0.9631
Epoch 12/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1453 - acc: 0.9668
Epoch 13/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1346 - acc: 0.9688
Epoch 14/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1265 - acc: 0.9686
Epoch 15/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1141 - acc: 0.9738
Epoch 16/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1101 - acc: 0.9753
Epoch 17/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0977 - acc: 0.9791
Epoch 18/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0950 - acc: 0.9810
Epoch 19/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0851 - acc: 0.9850
Epoch 20/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0804 - acc: 0.9822
Epoch 21/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0810 - acc: 0.9864
Epoch 22/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0728 - acc: 0.9877
Epoch 23/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0670 - acc: 0.9891
Epoch 24/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0596 - acc: 0.9909
Epoch 25/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0590 - acc: 0.9893
Epoch 26/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0571 - acc: 0.9922
Epoch 27/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0519 - acc: 0.9921
Epoch 28/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0484 - acc: 0.9918
Epoch 29/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0469 - acc: 0.9930
Epoch 30/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0480 - acc: 0.9919
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7845
False 1226
True percentage 0.864844008378
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-PER       0.79      0.68      0.73       438
      B-ORG       0.55      0.55      0.55       296
      I-ORG       0.29      0.46      0.36       151
     B-MISC       0.16      0.07      0.10       141
     I-MISC       0.37      0.25      0.29       154
      I-PER       0.78      0.52      0.63       214
      B-LOC       0.69      0.68      0.68       218
      I-LOC       0.63      0.35      0.45       141

avg / total       0.90      0.86      0.88      9071

F-1 Score (without O):
0.544122137405
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104112 unique words.
4108 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 562
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663232     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,362
Trainable params: 6,775,362
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

83/83 [==============================] - 3s 37ms/step - loss: 1.2183 - acc: 0.6633
Epoch 2/30

83/83 [==============================] - 2s 21ms/step - loss: 0.5200 - acc: 0.8457
Epoch 3/30

83/83 [==============================] - 2s 21ms/step - loss: 0.4119 - acc: 0.8823
Epoch 4/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3723 - acc: 0.8823
Epoch 5/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3385 - acc: 0.9052
Epoch 6/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3132 - acc: 0.9104
Epoch 7/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2919 - acc: 0.9152
Epoch 8/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2683 - acc: 0.9275
Epoch 9/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2467 - acc: 0.9320
Epoch 10/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2300 - acc: 0.9347
Epoch 11/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2163 - acc: 0.9460
Epoch 12/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1967 - acc: 0.9486
Epoch 13/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1873 - acc: 0.9530
Epoch 14/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1779 - acc: 0.9570
Epoch 15/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1646 - acc: 0.9591
Epoch 16/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1523 - acc: 0.9668
Epoch 17/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1420 - acc: 0.9681
Epoch 18/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1366 - acc: 0.9658
Epoch 19/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1261 - acc: 0.9702
Epoch 20/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1251 - acc: 0.9710
Epoch 21/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1175 - acc: 0.9736
Epoch 22/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1114 - acc: 0.9773
Epoch 23/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1015 - acc: 0.9825
Epoch 24/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0986 - acc: 0.9796
Epoch 25/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0971 - acc: 0.9835
Epoch 26/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0929 - acc: 0.9859
Epoch 27/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0888 - acc: 0.9835
Epoch 28/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0823 - acc: 0.9846
Epoch 29/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0805 - acc: 0.9881
Epoch 30/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0667 - acc: 0.9906
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7659
False 1412
True percentage 0.844339102635
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-PER       0.83      0.48      0.61       438
      B-ORG       0.45      0.54      0.49       296
      I-ORG       0.22      0.38      0.28       151
      I-PER       0.73      0.45      0.55       214
      B-LOC       0.79      0.59      0.67       218
     B-MISC       0.38      0.11      0.17       141
      I-LOC       0.51      0.35      0.42       141
     I-MISC       0.56      0.13      0.21       154

avg / total       0.90      0.84      0.86      9071

F-1 Score (without O):
0.477390180879
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104121 unique words.
4117 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 278
OOV word occurences: in test 559
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663808     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,938
Trainable params: 6,775,938
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

83/83 [==============================] - 3s 37ms/step - loss: 1.2708 - acc: 0.6459
Epoch 2/30

83/83 [==============================] - 2s 21ms/step - loss: 0.4972 - acc: 0.8384
Epoch 3/30

83/83 [==============================] - 2s 21ms/step - loss: 0.4197 - acc: 0.8696
Epoch 4/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3835 - acc: 0.8824
Epoch 5/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3385 - acc: 0.8979
Epoch 6/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3138 - acc: 0.9020
Epoch 7/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2873 - acc: 0.9140
Epoch 8/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2707 - acc: 0.9245
Epoch 9/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2536 - acc: 0.9248
Epoch 10/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2256 - acc: 0.9427
Epoch 11/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2136 - acc: 0.9432
Epoch 12/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1942 - acc: 0.9472
Epoch 13/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1918 - acc: 0.9470
Epoch 14/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1703 - acc: 0.9608
Epoch 15/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1647 - acc: 0.9597
Epoch 16/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1587 - acc: 0.9644
Epoch 17/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1488 - acc: 0.9590
Epoch 18/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1442 - acc: 0.9676
Epoch 19/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1274 - acc: 0.9752
Epoch 20/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1197 - acc: 0.9710
Epoch 21/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1138 - acc: 0.9730
Epoch 22/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1077 - acc: 0.9768
Epoch 23/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1007 - acc: 0.9790
Epoch 24/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1020 - acc: 0.9841
Epoch 25/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0918 - acc: 0.9825
Epoch 26/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0840 - acc: 0.9863
Epoch 27/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0797 - acc: 0.9881
Epoch 28/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0774 - acc: 0.9896
Epoch 29/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0817 - acc: 0.9876
Epoch 30/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0721 - acc: 0.9891
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7622
False 1449
True percentage 0.840260169772
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.80      0.43      0.56       438
          O       0.98      0.94      0.96      7318
      B-ORG       0.47      0.49      0.48       296
     B-MISC       0.29      0.18      0.23       141
      I-ORG       0.31      0.30      0.31       151
      I-PER       0.79      0.40      0.53       214
     I-MISC       0.39      0.16      0.23       154
      B-LOC       0.53      0.59      0.56       218
      I-LOC       0.34      0.68      0.45       141

avg / total       0.90      0.84      0.86      9071

F-1 Score (without O):
0.879228767447
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104114 unique words.
4110 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 276
OOV word occurences: in test 456
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663360     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,490
Trainable params: 6,775,490
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

83/83 [==============================] - 3s 37ms/step - loss: 1.3287 - acc: 0.6405
Epoch 2/30

83/83 [==============================] - 2s 21ms/step - loss: 0.5665 - acc: 0.8218
Epoch 3/30

83/83 [==============================] - 2s 21ms/step - loss: 0.4911 - acc: 0.8505
Epoch 4/30

83/83 [==============================] - 2s 21ms/step - loss: 0.4440 - acc: 0.8642
Epoch 5/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3976 - acc: 0.8826
Epoch 6/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3586 - acc: 0.9053
Epoch 7/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3350 - acc: 0.9051
Epoch 8/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3107 - acc: 0.9161
Epoch 9/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2857 - acc: 0.9226
Epoch 10/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2713 - acc: 0.9251
Epoch 11/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2534 - acc: 0.9265
Epoch 12/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2274 - acc: 0.9480
Epoch 13/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2164 - acc: 0.9509
Epoch 14/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2004 - acc: 0.9542
Epoch 15/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1853 - acc: 0.9603
Epoch 16/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1790 - acc: 0.9592
Epoch 17/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1688 - acc: 0.9649
Epoch 18/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1567 - acc: 0.9675
Epoch 19/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1479 - acc: 0.9680
Epoch 20/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1451 - acc: 0.9708
Epoch 21/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1318 - acc: 0.9735
Epoch 22/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1281 - acc: 0.9752
Epoch 23/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1152 - acc: 0.9787
Epoch 24/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1093 - acc: 0.9827
Epoch 25/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1049 - acc: 0.9795
Epoch 26/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0991 - acc: 0.9828
Epoch 27/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0980 - acc: 0.9850
Epoch 28/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0842 - acc: 0.9851
Epoch 29/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0819 - acc: 0.9901
Epoch 30/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0817 - acc: 0.9861
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7803
False 1268
True percentage 0.860213868372
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-PER       0.77      0.66      0.71       438
      B-ORG       0.53      0.52      0.52       296
      I-ORG       0.27      0.28      0.27       151
     B-MISC       0.34      0.07      0.12       141
     I-MISC       0.37      0.32      0.34       154
      I-PER       0.67      0.59      0.63       214
      B-LOC       0.58      0.64      0.61       218
      I-LOC       0.72      0.45      0.56       141

avg / total       0.90      0.86      0.88      9071

F-1 Score (without O):
0.537396121884
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104134 unique words.
4130 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 280
OOV word occurences: in test 543
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6664640     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,776,770
Trainable params: 6,776,770
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

83/83 [==============================] - 3s 37ms/step - loss: 1.1313 - acc: 0.6588
Epoch 2/30

83/83 [==============================] - 2s 21ms/step - loss: 0.5510 - acc: 0.8231
Epoch 3/30

83/83 [==============================] - 2s 21ms/step - loss: 0.4606 - acc: 0.8549
Epoch 4/30

83/83 [==============================] - 2s 21ms/step - loss: 0.4200 - acc: 0.8769
Epoch 5/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3720 - acc: 0.8854
Epoch 6/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3492 - acc: 0.8880
Epoch 7/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3102 - acc: 0.9069
Epoch 8/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2823 - acc: 0.9292
Epoch 9/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2662 - acc: 0.9252
Epoch 10/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2413 - acc: 0.9444
Epoch 11/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2194 - acc: 0.9447
Epoch 12/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2025 - acc: 0.9522
Epoch 13/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1878 - acc: 0.9529
Epoch 14/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1793 - acc: 0.9565
Epoch 15/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1643 - acc: 0.9613
Epoch 16/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1530 - acc: 0.9652
Epoch 17/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1386 - acc: 0.9727
Epoch 18/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1290 - acc: 0.9733
Epoch 19/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1167 - acc: 0.9794
Epoch 20/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1114 - acc: 0.9812
Epoch 21/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1051 - acc: 0.9813
Epoch 22/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1015 - acc: 0.9774
Epoch 23/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0986 - acc: 0.9776
Epoch 24/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0861 - acc: 0.9848
Epoch 25/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0821 - acc: 0.9865
Epoch 26/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0732 - acc: 0.9895
Epoch 27/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0769 - acc: 0.9862
Epoch 28/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0693 - acc: 0.9874
Epoch 29/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0656 - acc: 0.9896
Epoch 30/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0580 - acc: 0.9923
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7687
False 1384
True percentage 0.847425862639
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-ORG       0.56      0.46      0.50       296
      B-PER       0.71      0.46      0.56       438
      I-PER       0.62      0.39      0.48       214
      B-LOC       0.67      0.68      0.67       218
      I-LOC       0.50      0.76      0.60       141
      I-ORG       0.20      0.24      0.22       151
     B-MISC       0.25      0.13      0.18       141
     I-MISC       0.31      0.15      0.20       154

avg / total       0.89      0.85      0.87      9071

F-1 Score (without O):
0.474363007235
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104069 unique words.
4065 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660480     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,610
Trainable params: 6,772,610
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

33/33 [==============================] - 2s 63ms/step - loss: 1.6395 - acc: 0.4844
Epoch 2/30

33/33 [==============================] - 1s 23ms/step - loss: 0.6012 - acc: 0.8481
Epoch 3/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3889 - acc: 0.8841
Epoch 4/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3465 - acc: 0.8767
Epoch 5/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3266 - acc: 0.8974
Epoch 6/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2599 - acc: 0.9237
Epoch 7/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2681 - acc: 0.9172
Epoch 8/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2577 - acc: 0.9314
Epoch 9/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2259 - acc: 0.9315
Epoch 10/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2074 - acc: 0.9490
Epoch 11/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2027 - acc: 0.9386
Epoch 12/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1961 - acc: 0.9421
Epoch 13/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1814 - acc: 0.9536
Epoch 14/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1720 - acc: 0.9493
Epoch 15/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1719 - acc: 0.9562
Epoch 16/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1610 - acc: 0.9504
Epoch 17/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1637 - acc: 0.9564
Epoch 18/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1534 - acc: 0.9560
Epoch 19/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1398 - acc: 0.9627
Epoch 20/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1392 - acc: 0.9610
Epoch 21/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1356 - acc: 0.9666
Epoch 22/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1503 - acc: 0.9574
Epoch 23/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1342 - acc: 0.9575
Epoch 24/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1304 - acc: 0.9621
Epoch 25/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1221 - acc: 0.9692
Epoch 26/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1251 - acc: 0.9691
Epoch 27/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1321 - acc: 0.9602
Epoch 28/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1201 - acc: 0.9647
Epoch 29/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1057 - acc: 0.9742
Epoch 30/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1140 - acc: 0.9707
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7237
False 1834
True percentage 0.797817219711
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.92      0.94      0.93      7318
      B-PER       0.52      0.28      0.36       438
      B-ORG       0.28      0.43      0.34       296
      I-ORG       0.12      0.14      0.13       151
      I-PER       0.34      0.27      0.30       214
      B-LOC       0.63      0.09      0.15       218
     B-MISC       0.00      0.00      0.00       141
      I-LOC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.81      0.80      0.79      9071

F-1 Score (without O):
0.24607703281
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104077 unique words.
4073 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 281
OOV word occurences: in test 565
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660992     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,773,122
Trainable params: 6,773,122
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

33/33 [==============================] - 2s 62ms/step - loss: 1.6204 - acc: 0.4671
Epoch 2/30

33/33 [==============================] - 1s 23ms/step - loss: 0.6986 - acc: 0.8234
Epoch 3/30

33/33 [==============================] - 1s 23ms/step - loss: 0.6509 - acc: 0.8309
Epoch 4/30

33/33 [==============================] - 1s 23ms/step - loss: 0.5154 - acc: 0.8444
Epoch 5/30

33/33 [==============================] - 1s 23ms/step - loss: 0.4751 - acc: 0.8561
Epoch 6/30

33/33 [==============================] - 1s 23ms/step - loss: 0.4817 - acc: 0.8631
Epoch 7/30

33/33 [==============================] - 1s 23ms/step - loss: 0.4062 - acc: 0.8672
Epoch 8/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3617 - acc: 0.8875
Epoch 9/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3491 - acc: 0.8944
Epoch 10/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3199 - acc: 0.9110
Epoch 11/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3078 - acc: 0.9253
Epoch 12/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3020 - acc: 0.9177
Epoch 13/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2788 - acc: 0.9236
Epoch 14/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2857 - acc: 0.9243
Epoch 15/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2710 - acc: 0.9299
Epoch 16/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2604 - acc: 0.9242
Epoch 17/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2453 - acc: 0.9246
Epoch 18/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2287 - acc: 0.9371
Epoch 19/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2289 - acc: 0.9295
Epoch 20/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2206 - acc: 0.9316
Epoch 21/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2025 - acc: 0.9450
Epoch 22/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2167 - acc: 0.9391
Epoch 23/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1860 - acc: 0.9601
Epoch 24/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1870 - acc: 0.9534
Epoch 25/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1814 - acc: 0.9556
Epoch 26/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1801 - acc: 0.9632
Epoch 27/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1615 - acc: 0.9670
Epoch 28/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1665 - acc: 0.9548
Epoch 29/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2071 - acc: 0.9426
Epoch 30/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1670 - acc: 0.9620
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7351
False 1720
True percentage 0.810384742586
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.63      0.26      0.37       438
          O       0.95      0.95      0.95      7318
      B-ORG       0.30      0.42      0.35       296
     B-MISC       0.26      0.13      0.17       141
      I-ORG       0.18      0.38      0.24       151
      I-PER       0.44      0.24      0.31       214
     I-MISC       0.55      0.08      0.14       154
      B-LOC       0.75      0.19      0.31       218
      I-LOC       0.19      0.09      0.12       141

avg / total       0.86      0.81      0.82      9071

F-1 Score (without O):
0.853588065334
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104062 unique words.
4058 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 281
OOV word occurences: in test 473
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660032     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,162
Trainable params: 6,772,162
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

33/33 [==============================] - 2s 62ms/step - loss: 1.8065 - acc: 0.4387
Epoch 2/30

33/33 [==============================] - 1s 23ms/step - loss: 0.9699 - acc: 0.7611
Epoch 3/30

33/33 [==============================] - 1s 23ms/step - loss: 0.6293 - acc: 0.8053
Epoch 4/30

33/33 [==============================] - 1s 23ms/step - loss: 0.5322 - acc: 0.8299
Epoch 5/30

33/33 [==============================] - 1s 23ms/step - loss: 0.4939 - acc: 0.8432
Epoch 6/30

33/33 [==============================] - 1s 23ms/step - loss: 0.4548 - acc: 0.8367
Epoch 7/30

33/33 [==============================] - 1s 23ms/step - loss: 0.4289 - acc: 0.8460
Epoch 8/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3858 - acc: 0.8763
Epoch 9/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3808 - acc: 0.8759
Epoch 10/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3633 - acc: 0.8670
Epoch 11/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3354 - acc: 0.8932
Epoch 12/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3076 - acc: 0.9157
Epoch 13/30

33/33 [==============================] - 1s 23ms/step - loss: 0.5055 - acc: 0.8597
Epoch 14/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2988 - acc: 0.9062
Epoch 15/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2667 - acc: 0.9250
Epoch 16/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2615 - acc: 0.9306
Epoch 17/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2473 - acc: 0.9371
Epoch 18/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2285 - acc: 0.9470
Epoch 19/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2156 - acc: 0.9554
Epoch 20/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2145 - acc: 0.9513
Epoch 21/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2066 - acc: 0.9609
Epoch 22/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1921 - acc: 0.9530
Epoch 23/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1843 - acc: 0.9665
Epoch 24/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1834 - acc: 0.9647
Epoch 25/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1753 - acc: 0.9699
Epoch 26/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1837 - acc: 0.9592
Epoch 27/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1536 - acc: 0.9845
Epoch 28/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1475 - acc: 0.9773
Epoch 29/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1508 - acc: 0.9730
Epoch 30/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1350 - acc: 0.9805
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7445
False 1626
True percentage 0.820747436887
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.94      0.95      7318
      B-PER       0.74      0.42      0.53       438
      B-ORG       0.36      0.53      0.43       296
      I-ORG       0.16      0.24      0.19       151
     B-MISC       0.21      0.06      0.09       141
     I-MISC       0.21      0.37      0.27       154
      I-PER       0.69      0.34      0.45       214
      B-LOC       0.52      0.39      0.44       218
      I-LOC       0.00      0.00      0.00       141

avg / total       0.86      0.82      0.84      9071

F-1 Score (without O):
0.368355995056
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104087 unique words.
4083 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 553
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6661632     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,773,762
Trainable params: 6,773,762
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

33/33 [==============================] - 2s 62ms/step - loss: 1.8738 - acc: 0.4590
Epoch 2/30

33/33 [==============================] - 1s 23ms/step - loss: 1.5487 - acc: 0.4782
Epoch 3/30

33/33 [==============================] - 1s 23ms/step - loss: 0.8147 - acc: 0.7772
Epoch 4/30

33/33 [==============================] - 1s 23ms/step - loss: 0.7718 - acc: 0.7974
Epoch 5/30

33/33 [==============================] - 1s 23ms/step - loss: 0.6791 - acc: 0.8091
Epoch 6/30

33/33 [==============================] - 1s 23ms/step - loss: 0.6164 - acc: 0.8218
Epoch 7/30

33/33 [==============================] - 1s 23ms/step - loss: 0.5687 - acc: 0.8369
Epoch 8/30

33/33 [==============================] - 1s 23ms/step - loss: 0.5060 - acc: 0.8505
Epoch 9/30

33/33 [==============================] - 1s 23ms/step - loss: 0.4768 - acc: 0.8577
Epoch 10/30

33/33 [==============================] - 1s 23ms/step - loss: 0.4586 - acc: 0.8678
Epoch 11/30

33/33 [==============================] - 1s 23ms/step - loss: 0.4416 - acc: 0.8766
Epoch 12/30

33/33 [==============================] - 1s 23ms/step - loss: 0.4138 - acc: 0.8823
Epoch 13/30

33/33 [==============================] - 1s 23ms/step - loss: 0.4062 - acc: 0.8876
Epoch 14/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3739 - acc: 0.8893
Epoch 15/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3559 - acc: 0.9052
Epoch 16/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3340 - acc: 0.9087
Epoch 17/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3194 - acc: 0.9240
Epoch 18/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3184 - acc: 0.9353
Epoch 19/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3157 - acc: 0.9282
Epoch 20/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3012 - acc: 0.9195
Epoch 21/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2830 - acc: 0.9063
Epoch 22/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2786 - acc: 0.9155
Epoch 23/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2613 - acc: 0.9300
Epoch 24/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2595 - acc: 0.9207
Epoch 25/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2438 - acc: 0.9371
Epoch 26/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2369 - acc: 0.9451
Epoch 27/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2356 - acc: 0.9381
Epoch 28/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2187 - acc: 0.9487
Epoch 29/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2218 - acc: 0.9494
Epoch 30/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2182 - acc: 0.9561
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7399
False 1672
True percentage 0.815676331165
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.92      0.95      7318
      B-ORG       0.50      0.40      0.45       296
      B-PER       0.52      0.38      0.44       438
      I-PER       0.38      0.38      0.38       214
      B-LOC       0.48      0.53      0.50       218
      I-LOC       0.38      0.50      0.43       141
      I-ORG       0.13      0.15      0.14       151
     B-MISC       0.40      0.20      0.27       141
     I-MISC       0.22      0.20      0.21       154

avg / total       0.87      0.82      0.84      9071

F-1 Score (without O):
0.381665668065
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 7 unique labels.
Found 104057 unique words.
4053 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659712     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 8)        1112        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,544
Trainable params: 6,771,544
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

16/16 [==============================] - 2s 101ms/step - loss: 2.9813 - acc: 0.0028
Epoch 2/30

16/16 [==============================] - 0s 20ms/step - loss: 1.1867 - acc: 0.7612
Epoch 3/30

16/16 [==============================] - 0s 20ms/step - loss: 0.6244 - acc: 0.8287
Epoch 4/30

16/16 [==============================] - 0s 20ms/step - loss: 0.5025 - acc: 0.8567
Epoch 5/30

16/16 [==============================] - 0s 20ms/step - loss: 0.5726 - acc: 0.8287
Epoch 6/30

16/16 [==============================] - 0s 20ms/step - loss: 0.6175 - acc: 0.8567
Epoch 7/30

16/16 [==============================] - 0s 20ms/step - loss: 0.4083 - acc: 0.8483
Epoch 8/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3208 - acc: 0.8933
Epoch 9/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3032 - acc: 0.9101
Epoch 10/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2748 - acc: 0.9213
Epoch 11/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2520 - acc: 0.9326
Epoch 12/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2388 - acc: 0.9354
Epoch 13/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2068 - acc: 0.9438
Epoch 14/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2056 - acc: 0.9522
Epoch 15/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1943 - acc: 0.9410
Epoch 16/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1831 - acc: 0.9579
Epoch 17/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1855 - acc: 0.9494
Epoch 18/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1679 - acc: 0.9635
Epoch 19/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1482 - acc: 0.9635
Epoch 20/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1414 - acc: 0.9719
Epoch 21/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1403 - acc: 0.9691
Epoch 22/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1261 - acc: 0.9831
Epoch 23/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1207 - acc: 0.9719
Epoch 24/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1248 - acc: 0.9719
Epoch 25/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1137 - acc: 0.9747
Epoch 26/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1166 - acc: 0.9803
Epoch 27/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1001 - acc: 0.9775
Epoch 28/30

16/16 [==============================] - 0s 20ms/step - loss: 0.0996 - acc: 0.9831
Epoch 29/30

16/16 [==============================] - 0s 20ms/step - loss: 0.0949 - acc: 0.9860
Epoch 30/30

16/16 [==============================] - 0s 20ms/step - loss: 0.0969 - acc: 0.9803
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7154
False 1622
True percentage 0.815177757521
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.93      0.94      7318
      B-PER       0.51      0.34      0.41       438
      B-ORG       0.22      0.46      0.30       296
      I-ORG       0.12      0.28      0.16       151
      I-PER       0.46      0.23      0.31       214
      B-LOC       0.00      0.00      0.00       218
     B-MISC       0.00      0.00      0.00       141

avg / total       0.84      0.82      0.82      8776

F-1 Score (without O):
0.265586474111
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104056 unique words.
4052 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 567
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659648     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,778
Trainable params: 6,771,778
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

16/16 [==============================] - 2s 101ms/step - loss: 2.5212 - acc: 0.0632
Epoch 2/30

16/16 [==============================] - 0s 20ms/step - loss: 0.9217 - acc: 0.8333
Epoch 3/30

16/16 [==============================] - 0s 20ms/step - loss: 0.5814 - acc: 0.8534
Epoch 4/30

16/16 [==============================] - 0s 20ms/step - loss: 0.6459 - acc: 0.8621
Epoch 5/30

16/16 [==============================] - 0s 21ms/step - loss: 0.6800 - acc: 0.8534
Epoch 6/30

16/16 [==============================] - 0s 20ms/step - loss: 0.4385 - acc: 0.8851
Epoch 7/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3975 - acc: 0.8822
Epoch 8/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3843 - acc: 0.8937
Epoch 9/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3257 - acc: 0.9052
Epoch 10/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3196 - acc: 0.8966
Epoch 11/30

16/16 [==============================] - 0s 21ms/step - loss: 0.3074 - acc: 0.9052
Epoch 12/30

16/16 [==============================] - 0s 21ms/step - loss: 0.2923 - acc: 0.9138
Epoch 13/30

16/16 [==============================] - 0s 21ms/step - loss: 0.2664 - acc: 0.9195
Epoch 14/30

16/16 [==============================] - 0s 21ms/step - loss: 0.2450 - acc: 0.9310
Epoch 15/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2385 - acc: 0.9167
Epoch 16/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2221 - acc: 0.9454
Epoch 17/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2052 - acc: 0.9425
Epoch 18/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2074 - acc: 0.9425
Epoch 19/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1842 - acc: 0.9569
Epoch 20/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1847 - acc: 0.9598
Epoch 21/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1727 - acc: 0.9684
Epoch 22/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1571 - acc: 0.9713
Epoch 23/30

16/16 [==============================] - 0s 21ms/step - loss: 0.1641 - acc: 0.9770
Epoch 24/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1501 - acc: 0.9828
Epoch 25/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1392 - acc: 0.9741
Epoch 26/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1307 - acc: 0.9856
Epoch 27/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1256 - acc: 0.9828
Epoch 28/30

16/16 [==============================] - 0s 21ms/step - loss: 0.1220 - acc: 0.9856
Epoch 29/30

16/16 [==============================] - 0s 21ms/step - loss: 0.1252 - acc: 0.9914
Epoch 30/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1100 - acc: 0.9885
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7286
False 1785
True percentage 0.803219049719
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.50      0.28      0.36       438
          O       0.91      0.95      0.93      7318
      B-ORG       0.33      0.27      0.30       296
     B-MISC       0.18      0.22      0.20       141
      I-ORG       0.00      0.00      0.00       151
      I-PER       0.57      0.15      0.24       214
     I-MISC       0.33      0.21      0.26       154
      B-LOC       0.65      0.06      0.11       218
      I-LOC       0.58      0.05      0.09       141

avg / total       0.82      0.80      0.80      9071

F-1 Score (without O):
0.848143982002
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104046 unique words.
4042 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659008     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,138
Trainable params: 6,771,138
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

16/16 [==============================] - 2s 102ms/step - loss: 2.8062 - acc: 0.0647
Epoch 2/30

16/16 [==============================] - 0s 20ms/step - loss: 1.0382 - acc: 0.8000
Epoch 3/30

16/16 [==============================] - 0s 20ms/step - loss: 0.7442 - acc: 0.8265
Epoch 4/30

16/16 [==============================] - 0s 20ms/step - loss: 0.6912 - acc: 0.8294
Epoch 5/30

16/16 [==============================] - 0s 20ms/step - loss: 0.6574 - acc: 0.8265
Epoch 6/30

16/16 [==============================] - 0s 20ms/step - loss: 0.5229 - acc: 0.8500
Epoch 7/30

16/16 [==============================] - 0s 20ms/step - loss: 0.4425 - acc: 0.8382
Epoch 8/30

16/16 [==============================] - 0s 20ms/step - loss: 0.4020 - acc: 0.8794
Epoch 9/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3759 - acc: 0.8765
Epoch 10/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3431 - acc: 0.9059
Epoch 11/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3288 - acc: 0.8824
Epoch 12/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3098 - acc: 0.9176
Epoch 13/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2878 - acc: 0.9000
Epoch 14/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3077 - acc: 0.9294
Epoch 15/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2650 - acc: 0.9147
Epoch 16/30

16/16 [==============================] - 0s 21ms/step - loss: 0.2397 - acc: 0.9412
Epoch 17/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2152 - acc: 0.9471
Epoch 18/30

16/16 [==============================] - 0s 21ms/step - loss: 0.2177 - acc: 0.9441
Epoch 19/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2064 - acc: 0.9441
Epoch 20/30

16/16 [==============================] - 0s 21ms/step - loss: 0.1947 - acc: 0.9618
Epoch 21/30

16/16 [==============================] - 0s 21ms/step - loss: 0.1834 - acc: 0.9500
Epoch 22/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1759 - acc: 0.9647
Epoch 23/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1609 - acc: 0.9735
Epoch 24/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1699 - acc: 0.9618
Epoch 25/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1506 - acc: 0.9735
Epoch 26/30

16/16 [==============================] - 0s 21ms/step - loss: 0.1582 - acc: 0.9794
Epoch 27/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1411 - acc: 0.9794
Epoch 28/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1274 - acc: 0.9853
Epoch 29/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1308 - acc: 0.9824
Epoch 30/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1158 - acc: 0.9853
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7116
False 1955
True percentage 0.784478006835
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.93      0.93      7318
      B-PER       0.24      0.16      0.19       438
      B-ORG       0.24      0.34      0.28       296
      I-ORG       0.13      0.07      0.09       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.13      0.01      0.02       154
      I-PER       0.23      0.36      0.28       214
      B-LOC       0.57      0.28      0.37       218
      I-LOC       0.43      0.02      0.04       141

avg / total       0.81      0.78      0.79      9071

F-1 Score (without O):
0.216412971542
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104060 unique words.
4056 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 567
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659904     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,034
Trainable params: 6,772,034
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

16/16 [==============================] - 2s 101ms/step - loss: 2.7246 - acc: 0.0380
Epoch 2/30

16/16 [==============================] - 0s 20ms/step - loss: 1.0919 - acc: 0.7601
Epoch 3/30

16/16 [==============================] - 0s 20ms/step - loss: 0.6922 - acc: 0.7625
Epoch 4/30

16/16 [==============================] - 0s 20ms/step - loss: 0.7714 - acc: 0.7933
Epoch 5/30

16/16 [==============================] - 0s 20ms/step - loss: 0.7811 - acc: 0.7625
Epoch 6/30

16/16 [==============================] - 0s 20ms/step - loss: 0.5786 - acc: 0.8741
Epoch 7/30

16/16 [==============================] - 0s 20ms/step - loss: 0.4414 - acc: 0.8812
Epoch 8/30

16/16 [==============================] - 0s 20ms/step - loss: 0.4116 - acc: 0.8931
Epoch 9/30

16/16 [==============================] - 0s 21ms/step - loss: 0.3916 - acc: 0.9050
Epoch 10/30

16/16 [==============================] - 0s 21ms/step - loss: 0.3527 - acc: 0.9169
Epoch 11/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3553 - acc: 0.9240
Epoch 12/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2991 - acc: 0.9311
Epoch 13/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2818 - acc: 0.9192
Epoch 14/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2755 - acc: 0.9335
Epoch 15/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2571 - acc: 0.9359
Epoch 16/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2499 - acc: 0.9477
Epoch 17/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2209 - acc: 0.9477
Epoch 18/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2104 - acc: 0.9430
Epoch 19/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2021 - acc: 0.9477
Epoch 20/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1931 - acc: 0.9549
Epoch 21/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1842 - acc: 0.9596
Epoch 22/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1789 - acc: 0.9572
Epoch 23/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1728 - acc: 0.9596
Epoch 24/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1744 - acc: 0.9620
Epoch 25/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1531 - acc: 0.9762
Epoch 26/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1378 - acc: 0.9762
Epoch 27/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1443 - acc: 0.9739
Epoch 28/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1205 - acc: 0.9762
Epoch 29/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1274 - acc: 0.9810
Epoch 30/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1224 - acc: 0.9834
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7283
False 1788
True percentage 0.802888325433
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.94      0.94      7318
      B-ORG       0.32      0.34      0.33       296
      B-PER       0.37      0.23      0.28       438
      I-PER       0.38      0.33      0.35       214
      B-LOC       0.65      0.38      0.48       218
      I-LOC       0.60      0.04      0.08       141
      I-ORG       0.11      0.23      0.15       151
     B-MISC       0.18      0.05      0.08       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.83      0.80      0.81      9071

F-1 Score (without O):
0.267418712674
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 6 unique labels.
Found 104044 unique words.
4040 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658880     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 7)        966         bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,566
Trainable params: 6,770,566
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

8/8 [==============================] - 1s 185ms/step - loss: 1.9860 - acc: 0.1326
Epoch 2/30

8/8 [==============================] - 0s 24ms/step - loss: 0.9229 - acc: 0.8453
Epoch 3/30

8/8 [==============================] - 0s 24ms/step - loss: 0.4504 - acc: 0.8729
Epoch 4/30

8/8 [==============================] - 0s 24ms/step - loss: 0.4378 - acc: 0.9282
Epoch 5/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2911 - acc: 0.8840
Epoch 6/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2064 - acc: 0.9558
Epoch 7/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1757 - acc: 0.9613
Epoch 8/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1689 - acc: 0.9558
Epoch 9/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1452 - acc: 0.9669
Epoch 10/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1253 - acc: 0.9613
Epoch 11/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1012 - acc: 0.9834
Epoch 12/30

8/8 [==============================] - 0s 23ms/step - loss: 0.1037 - acc: 0.9724
Epoch 13/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1034 - acc: 0.9669
Epoch 14/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0877 - acc: 0.9890
Epoch 15/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0729 - acc: 0.9945
Epoch 16/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0749 - acc: 0.9945
Epoch 17/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0611 - acc: 0.9945
Epoch 18/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0642 - acc: 0.9890
Epoch 19/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0509 - acc: 0.9945
Epoch 20/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0508 - acc: 0.9945
Epoch 21/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0417 - acc: 1.0000
Epoch 22/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0409 - acc: 1.0000
Epoch 23/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0397 - acc: 0.9945
Epoch 24/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0431 - acc: 1.0000
Epoch 25/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0344 - acc: 0.9945
Epoch 26/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0336 - acc: 1.0000
Epoch 27/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0275 - acc: 1.0000
Epoch 28/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0284 - acc: 1.0000
Epoch 29/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0340 - acc: 1.0000
Epoch 30/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0237 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7163
False 1472
True percentage 0.829530978576
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.93      0.93      7318
      B-PER       0.30      0.45      0.36       438
      B-ORG       0.32      0.30      0.31       296
      I-ORG       0.20      0.03      0.06       151
      I-PER       0.26      0.36      0.30       214
      B-LOC       0.00      0.00      0.00       218

avg / total       0.83      0.83      0.83      8635

F-1 Score (without O):
0.285936285936
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 6 unique labels.
Found 104044 unique words.
4040 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658880     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 7)        966         bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,566
Trainable params: 6,770,566
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

8/8 [==============================] - 1s 186ms/step - loss: 2.0861 - acc: 0.1104
Epoch 2/30

8/8 [==============================] - 0s 24ms/step - loss: 0.7722 - acc: 0.8831
Epoch 3/30

8/8 [==============================] - 0s 24ms/step - loss: 0.4290 - acc: 0.9026
Epoch 4/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3068 - acc: 0.9026
Epoch 5/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2862 - acc: 0.9416
Epoch 6/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2477 - acc: 0.9091
Epoch 7/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2207 - acc: 0.9610
Epoch 8/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1711 - acc: 0.9416
Epoch 9/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1385 - acc: 0.9675
Epoch 10/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1194 - acc: 0.9740
Epoch 11/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1114 - acc: 0.9675
Epoch 12/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1043 - acc: 0.9740
Epoch 13/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0959 - acc: 0.9870
Epoch 14/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0791 - acc: 0.9870
Epoch 15/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0738 - acc: 0.9805
Epoch 16/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0600 - acc: 0.9935
Epoch 17/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0602 - acc: 0.9935
Epoch 18/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0572 - acc: 0.9935
Epoch 19/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0489 - acc: 0.9935
Epoch 20/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0485 - acc: 1.0000
Epoch 21/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0422 - acc: 0.9935
Epoch 22/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0355 - acc: 1.0000
Epoch 23/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0391 - acc: 0.9935
Epoch 24/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0393 - acc: 0.9935
Epoch 25/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0353 - acc: 1.0000
Epoch 26/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0327 - acc: 1.0000
Epoch 27/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0292 - acc: 1.0000
Epoch 28/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0317 - acc: 1.0000
Epoch 29/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0278 - acc: 1.0000
Epoch 30/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0254 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7059
False 1499
True percentage 0.824842252863
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.20      0.18      0.19       438
          O       0.90      0.94      0.92      7318
      B-ORG       0.18      0.17      0.17       296
     B-MISC       0.00      0.00      0.00       141
      I-ORG       0.21      0.02      0.04       151
      I-PER       0.28      0.12      0.17       214

avg / total       0.79      0.82      0.81      8558

F-1 Score (without O):
0.860082558068
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104041 unique words.
4037 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658688     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,818
Trainable params: 6,770,818
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

8/8 [==============================] - 1s 187ms/step - loss: 1.8289 - acc: 0.4277
Epoch 2/30

8/8 [==============================] - 0s 24ms/step - loss: 0.7872 - acc: 0.8208
Epoch 3/30

8/8 [==============================] - 0s 24ms/step - loss: 0.7691 - acc: 0.8497
Epoch 4/30

8/8 [==============================] - 0s 24ms/step - loss: 0.6972 - acc: 0.8208
Epoch 5/30

8/8 [==============================] - 0s 24ms/step - loss: 0.4697 - acc: 0.8671
Epoch 6/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3935 - acc: 0.8902
Epoch 7/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3631 - acc: 0.9017
Epoch 8/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3294 - acc: 0.8844
Epoch 9/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2777 - acc: 0.9364
Epoch 10/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2809 - acc: 0.9133
Epoch 11/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2297 - acc: 0.9364
Epoch 12/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2106 - acc: 0.9422
Epoch 13/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2097 - acc: 0.9249
Epoch 14/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1854 - acc: 0.9769
Epoch 15/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1814 - acc: 0.9595
Epoch 16/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1649 - acc: 0.9653
Epoch 17/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1527 - acc: 0.9711
Epoch 18/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1495 - acc: 0.9827
Epoch 19/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1304 - acc: 0.9827
Epoch 20/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1307 - acc: 0.9884
Epoch 21/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1178 - acc: 0.9827
Epoch 22/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1136 - acc: 0.9827
Epoch 23/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0937 - acc: 0.9942
Epoch 24/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0959 - acc: 1.0000
Epoch 25/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0977 - acc: 1.0000
Epoch 26/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0896 - acc: 1.0000
Epoch 27/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0724 - acc: 1.0000
Epoch 28/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0617 - acc: 1.0000
Epoch 29/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0708 - acc: 1.0000
Epoch 30/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0659 - acc: 0.9942
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7092
False 1979
True percentage 0.781832212545
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.91      0.93      0.92      7318
      B-PER       0.32      0.26      0.28       438
      B-ORG       0.27      0.36      0.31       296
      I-ORG       0.00      0.00      0.00       151
     B-MISC       0.07      0.03      0.04       141
     I-MISC       0.21      0.05      0.07       154
      I-PER       0.25      0.11      0.15       214
      B-LOC       0.33      0.05      0.09       218
      I-LOC       0.75      0.02      0.04       141

avg / total       0.79      0.78      0.77      9071

F-1 Score (without O):
0.196625091709
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104044 unique words.
4040 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 567
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658880     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,010
Trainable params: 6,771,010
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

8/8 [==============================] - 1s 186ms/step - loss: 2.4615 - acc: 0.1326
Epoch 2/30

8/8 [==============================] - 0s 24ms/step - loss: 1.1507 - acc: 0.7403
Epoch 3/30

8/8 [==============================] - 0s 24ms/step - loss: 0.8343 - acc: 0.7348
Epoch 4/30

8/8 [==============================] - 0s 25ms/step - loss: 0.7417 - acc: 0.7845
Epoch 5/30

8/8 [==============================] - 0s 24ms/step - loss: 0.8279 - acc: 0.7238
Epoch 6/30

8/8 [==============================] - 0s 24ms/step - loss: 0.7060 - acc: 0.8508
Epoch 7/30

8/8 [==============================] - 0s 24ms/step - loss: 0.5452 - acc: 0.7956
Epoch 8/30

8/8 [==============================] - 0s 24ms/step - loss: 0.4450 - acc: 0.8895
Epoch 9/30

8/8 [==============================] - 0s 24ms/step - loss: 0.4175 - acc: 0.9006
Epoch 10/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3659 - acc: 0.9337
Epoch 11/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3328 - acc: 0.9282
Epoch 12/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2959 - acc: 0.9613
Epoch 13/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2745 - acc: 0.9337
Epoch 14/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2465 - acc: 0.9613
Epoch 15/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2315 - acc: 0.9558
Epoch 16/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2198 - acc: 0.9613
Epoch 17/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1913 - acc: 0.9724
Epoch 18/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1634 - acc: 0.9945
Epoch 19/30

8/8 [==============================] - 0s 25ms/step - loss: 0.1850 - acc: 0.9669
Epoch 20/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1543 - acc: 0.9724
Epoch 21/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1298 - acc: 0.9945
Epoch 22/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1281 - acc: 0.9779
Epoch 23/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1162 - acc: 1.0000
Epoch 24/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1110 - acc: 0.9890
Epoch 25/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0973 - acc: 0.9945
Epoch 26/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1040 - acc: 1.0000
Epoch 27/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0853 - acc: 1.0000
Epoch 28/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0921 - acc: 1.0000
Epoch 29/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0780 - acc: 1.0000
Epoch 30/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0737 - acc: 0.9834
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7314
False 1757
True percentage 0.806305809723
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.94      0.94      7318
      B-ORG       0.44      0.27      0.34       296
      B-PER       0.43      0.42      0.42       438
      I-PER       0.43      0.28      0.34       214
      B-LOC       0.45      0.44      0.45       218
      I-LOC       0.50      0.01      0.01       141
      I-ORG       0.09      0.13      0.11       151
     B-MISC       0.16      0.02      0.04       141
     I-MISC       0.26      0.05      0.08       154

avg / total       0.83      0.81      0.81      9071

F-1 Score (without O):
0.303050620181
