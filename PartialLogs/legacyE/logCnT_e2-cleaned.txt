Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

1674/1674 [==============================] - 46s 27ms/step - loss: 0.4659 - acc: 0.8650
Epoch 2/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.2259 - acc: 0.9328
Epoch 3/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.1740 - acc: 0.9486
Epoch 4/30

1674/1674 [==============================] - 44s 27ms/step - loss: 0.1446 - acc: 0.9576
Epoch 5/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.1246 - acc: 0.9637
Epoch 6/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.1094 - acc: 0.9687
Epoch 7/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0954 - acc: 0.9730
Epoch 8/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0847 - acc: 0.9766
Epoch 9/30

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0776 - acc: 0.9787
Epoch 10/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0697 - acc: 0.9805
Epoch 11/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0661 - acc: 0.9811
Epoch 12/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0616 - acc: 0.9822
Epoch 13/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0569 - acc: 0.9844
Epoch 14/30

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0526 - acc: 0.9855
Epoch 15/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0481 - acc: 0.9857
Epoch 16/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0468 - acc: 0.9868
Epoch 17/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0441 - acc: 0.9875
Epoch 18/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0401 - acc: 0.9891
Epoch 19/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0395 - acc: 0.9888
Epoch 20/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0364 - acc: 0.9896
Epoch 21/30

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0354 - acc: 0.9895
Epoch 22/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0330 - acc: 0.9907
Epoch 23/30

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0313 - acc: 0.9915
Epoch 24/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0299 - acc: 0.9912
Epoch 25/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0273 - acc: 0.9929
Epoch 26/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0269 - acc: 0.9927
Epoch 27/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0259 - acc: 0.9933
Epoch 28/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0252 - acc: 0.9927
Epoch 29/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0241 - acc: 0.9935
Epoch 30/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0245 - acc: 0.9930
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8235
False 836
True percentage 0.907838165583
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
      B-LOC       0.78      0.74      0.76       218
      I-LOC       0.78      0.80      0.79       141
      B-PER       0.89      0.83      0.86       438
      B-ORG       0.76      0.76      0.76       296
      I-ORG       0.59      0.67      0.63       151
     B-MISC       0.38      0.32      0.35       141
     I-MISC       0.50      0.42      0.45       154
      I-PER       0.91      0.64      0.75       214

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.71661237785
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

1674/1674 [==============================] - 46s 27ms/step - loss: 0.4608 - acc: 0.8664
Epoch 2/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.2253 - acc: 0.9332
Epoch 3/30

1674/1674 [==============================] - 44s 27ms/step - loss: 0.1745 - acc: 0.9487
Epoch 4/30

1674/1674 [==============================] - 44s 27ms/step - loss: 0.1421 - acc: 0.9577
Epoch 5/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.1238 - acc: 0.9633
Epoch 6/30

1674/1674 [==============================] - 44s 27ms/step - loss: 0.1088 - acc: 0.9680
Epoch 7/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0968 - acc: 0.9719
Epoch 8/30

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0865 - acc: 0.9756
Epoch 9/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0765 - acc: 0.9783
Epoch 10/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0723 - acc: 0.9795
Epoch 11/30

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0652 - acc: 0.9810
Epoch 12/30

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0593 - acc: 0.9841
Epoch 13/30

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0557 - acc: 0.9836
Epoch 14/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0511 - acc: 0.9846
Epoch 15/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0479 - acc: 0.9859
Epoch 16/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0451 - acc: 0.9878
Epoch 17/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0439 - acc: 0.9869
Epoch 18/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0412 - acc: 0.9883
Epoch 19/30

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0380 - acc: 0.9887
Epoch 20/30

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0354 - acc: 0.9902
Epoch 21/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0344 - acc: 0.9900
Epoch 22/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0344 - acc: 0.9901
Epoch 23/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0316 - acc: 0.9914
Epoch 24/30

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0301 - acc: 0.9915
Epoch 25/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0278 - acc: 0.9920
Epoch 26/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0270 - acc: 0.9919
Epoch 27/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0256 - acc: 0.9928
Epoch 28/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0245 - acc: 0.9927
Epoch 29/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0256 - acc: 0.9926
Epoch 30/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0229 - acc: 0.9937
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8267
False 804
True percentage 0.911365891302
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.79      0.77      0.78       296
      I-ORG       0.69      0.69      0.69       151
      B-PER       0.90      0.82      0.86       438
      I-PER       0.87      0.67      0.76       214
     B-MISC       0.41      0.33      0.37       141
     I-MISC       0.57      0.45      0.51       154
      B-LOC       0.77      0.73      0.75       218
      I-LOC       0.80      0.78      0.79       141

avg / total       0.94      0.91      0.93      9071

F-1 Score (without O):
0.73125374925
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100819 unique words.
Found 94 unique chars.
Found 9 unique labels.
815 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 256
OOV word occurences: 380
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6452480     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,559,042
Trainable params: 6,559,042
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

837/837 [==============================] - 24s 29ms/step - loss: 0.6010 - acc: 0.8260
Epoch 2/30

837/837 [==============================] - 22s 27ms/step - loss: 0.2986 - acc: 0.9141
Epoch 3/30

837/837 [==============================] - 23s 27ms/step - loss: 0.2254 - acc: 0.9340
Epoch 4/30

837/837 [==============================] - 23s 27ms/step - loss: 0.1859 - acc: 0.9460
Epoch 5/30

837/837 [==============================] - 22s 27ms/step - loss: 0.1570 - acc: 0.9539
Epoch 6/30

837/837 [==============================] - 23s 27ms/step - loss: 0.1407 - acc: 0.9600
Epoch 7/30

837/837 [==============================] - 23s 27ms/step - loss: 0.1230 - acc: 0.9632
Epoch 8/30

837/837 [==============================] - 22s 27ms/step - loss: 0.1130 - acc: 0.9671
Epoch 9/30

837/837 [==============================] - 22s 27ms/step - loss: 0.1009 - acc: 0.9716
Epoch 10/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0911 - acc: 0.9741
Epoch 11/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0839 - acc: 0.9756
Epoch 12/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0743 - acc: 0.9791
Epoch 13/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0715 - acc: 0.9809
Epoch 14/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0655 - acc: 0.9809
Epoch 15/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0589 - acc: 0.9840
Epoch 16/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0546 - acc: 0.9851
Epoch 17/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0498 - acc: 0.9867
Epoch 18/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0464 - acc: 0.9871
Epoch 19/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0451 - acc: 0.9880
Epoch 20/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0402 - acc: 0.9889
Epoch 21/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0390 - acc: 0.9900
Epoch 22/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0357 - acc: 0.9906
Epoch 23/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0345 - acc: 0.9913
Epoch 24/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0347 - acc: 0.9904
Epoch 25/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0312 - acc: 0.9922
Epoch 26/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0300 - acc: 0.9915
Epoch 27/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0288 - acc: 0.9921
Epoch 28/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0266 - acc: 0.9930
Epoch 29/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0258 - acc: 0.9932
Epoch 30/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0254 - acc: 0.9932
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8154
False 917
True percentage 0.898908609856
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-LOC       0.71      0.74      0.73       218
      I-LOC       0.72      0.82      0.77       141
      B-PER       0.88      0.80      0.83       438
      B-ORG       0.68      0.72      0.70       296
      I-ORG       0.60      0.62      0.61       151
     B-MISC       0.43      0.16      0.24       141
     I-MISC       0.56      0.34      0.42       154
      I-PER       0.88      0.62      0.73       214

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.690447400242
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 100791 unique words.
Found 94 unique chars.
Found 9 unique labels.
787 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 254
OOV word occurences: 388
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6450688     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,557,250
Trainable params: 6,557,250
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

837/837 [==============================] - 24s 29ms/step - loss: 0.5929 - acc: 0.8313
Epoch 2/30

837/837 [==============================] - 23s 27ms/step - loss: 0.2899 - acc: 0.9131
Epoch 3/30

837/837 [==============================] - 23s 27ms/step - loss: 0.2183 - acc: 0.9358
Epoch 4/30

837/837 [==============================] - 23s 27ms/step - loss: 0.1761 - acc: 0.9474
Epoch 5/30

837/837 [==============================] - 23s 28ms/step - loss: 0.1494 - acc: 0.9578
Epoch 6/30

837/837 [==============================] - 23s 27ms/step - loss: 0.1289 - acc: 0.9629
Epoch 7/30

837/837 [==============================] - 23s 28ms/step - loss: 0.1126 - acc: 0.9688
Epoch 8/30

837/837 [==============================] - 23s 28ms/step - loss: 0.1024 - acc: 0.9718
Epoch 9/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0907 - acc: 0.9758
Epoch 10/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0797 - acc: 0.9784
Epoch 11/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0751 - acc: 0.9797
Epoch 12/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0673 - acc: 0.9827
Epoch 13/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0625 - acc: 0.9827
Epoch 14/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0577 - acc: 0.9842
Epoch 15/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0540 - acc: 0.9859
Epoch 16/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0484 - acc: 0.9870
Epoch 17/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0457 - acc: 0.9874
Epoch 18/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0403 - acc: 0.9892
Epoch 19/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0389 - acc: 0.9898
Epoch 20/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0364 - acc: 0.9902
Epoch 21/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0369 - acc: 0.9903
Epoch 22/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0336 - acc: 0.9908
Epoch 23/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0303 - acc: 0.9919
Epoch 24/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0302 - acc: 0.9915
Epoch 25/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0280 - acc: 0.9926
Epoch 26/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0277 - acc: 0.9929
Epoch 27/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0258 - acc: 0.9931
Epoch 28/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0248 - acc: 0.9930
Epoch 29/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0232 - acc: 0.9942
Epoch 30/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0238 - acc: 0.9930
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8122
False 949
True percentage 0.895380884136
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.75      0.71      0.73       296
      I-ORG       0.62      0.52      0.57       151
      B-PER       0.88      0.77      0.82       438
      I-PER       0.91      0.59      0.72       214
     B-MISC       0.32      0.25      0.28       141
     I-MISC       0.48      0.47      0.47       154
      B-LOC       0.67      0.67      0.67       218
      I-LOC       0.72      0.74      0.73       141

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.6723095526
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100794 unique words.
Found 94 unique chars.
Found 9 unique labels.
790 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 260
OOV word occurences: 391
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6450880     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,557,442
Trainable params: 6,557,442
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

837/837 [==============================] - 24s 29ms/step - loss: 0.5976 - acc: 0.8281
Epoch 2/30

837/837 [==============================] - 22s 26ms/step - loss: 0.3000 - acc: 0.9114
Epoch 3/30

837/837 [==============================] - 22s 26ms/step - loss: 0.2180 - acc: 0.9355
Epoch 4/30

837/837 [==============================] - 22s 27ms/step - loss: 0.1774 - acc: 0.9494
Epoch 5/30

837/837 [==============================] - 22s 27ms/step - loss: 0.1481 - acc: 0.9577
Epoch 6/30

837/837 [==============================] - 22s 27ms/step - loss: 0.1292 - acc: 0.9624
Epoch 7/30

837/837 [==============================] - 22s 27ms/step - loss: 0.1118 - acc: 0.9687
Epoch 8/30

837/837 [==============================] - 22s 26ms/step - loss: 0.0979 - acc: 0.9722
Epoch 9/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0908 - acc: 0.9738
Epoch 10/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0816 - acc: 0.9772
Epoch 11/30

837/837 [==============================] - 22s 26ms/step - loss: 0.0748 - acc: 0.9788
Epoch 12/30

837/837 [==============================] - 22s 26ms/step - loss: 0.0676 - acc: 0.9809
Epoch 13/30

837/837 [==============================] - 22s 26ms/step - loss: 0.0628 - acc: 0.9822
Epoch 14/30

837/837 [==============================] - 22s 26ms/step - loss: 0.0591 - acc: 0.9839
Epoch 15/30

837/837 [==============================] - 22s 26ms/step - loss: 0.0538 - acc: 0.9854
Epoch 16/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0517 - acc: 0.9864
Epoch 17/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0480 - acc: 0.9869
Epoch 18/30

837/837 [==============================] - 22s 26ms/step - loss: 0.0434 - acc: 0.9890
Epoch 19/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0423 - acc: 0.9891
Epoch 20/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0386 - acc: 0.9903
Epoch 21/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0362 - acc: 0.9912
Epoch 22/30

837/837 [==============================] - 22s 26ms/step - loss: 0.0345 - acc: 0.9912
Epoch 23/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0318 - acc: 0.9915
Epoch 24/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0304 - acc: 0.9928
Epoch 25/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0282 - acc: 0.9936
Epoch 26/30

837/837 [==============================] - 22s 26ms/step - loss: 0.0273 - acc: 0.9932
Epoch 27/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0266 - acc: 0.9931
Epoch 28/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0261 - acc: 0.9938
Epoch 29/30

837/837 [==============================] - 22s 26ms/step - loss: 0.0234 - acc: 0.9944
Epoch 30/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0224 - acc: 0.9947
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8095
False 976
True percentage 0.892404365561
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.89      0.71      0.79       438
      B-LOC       0.75      0.68      0.71       218
     B-MISC       0.38      0.30      0.33       141
     I-MISC       0.44      0.47      0.46       154
      B-ORG       0.74      0.73      0.73       296
      I-ORG       0.55      0.57      0.56       151
      I-LOC       0.77      0.70      0.74       141
      I-PER       0.87      0.61      0.72       214

avg / total       0.93      0.89      0.91      9071

F-1 Score (without O):
0.669288956127
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100357 unique words.
Found 94 unique chars.
Found 9 unique labels.
353 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 289
OOV word occurences: 446
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6422912     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,529,474
Trainable params: 6,529,474
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

334/334 [==============================] - 10s 31ms/step - loss: 0.8613 - acc: 0.7698
Epoch 2/30

334/334 [==============================] - 9s 26ms/step - loss: 0.4717 - acc: 0.8519
Epoch 3/30

334/334 [==============================] - 9s 26ms/step - loss: 0.3374 - acc: 0.8946
Epoch 4/30

334/334 [==============================] - 9s 26ms/step - loss: 0.2756 - acc: 0.9201
Epoch 5/30

334/334 [==============================] - 9s 26ms/step - loss: 0.2227 - acc: 0.9345
Epoch 6/30

334/334 [==============================] - 9s 26ms/step - loss: 0.1919 - acc: 0.9432
Epoch 7/30

334/334 [==============================] - 9s 26ms/step - loss: 0.1699 - acc: 0.9518
Epoch 8/30

334/334 [==============================] - 9s 26ms/step - loss: 0.1471 - acc: 0.9590
Epoch 9/30

334/334 [==============================] - 9s 26ms/step - loss: 0.1333 - acc: 0.9644
Epoch 10/30

334/334 [==============================] - 9s 26ms/step - loss: 0.1193 - acc: 0.9690
Epoch 11/30

334/334 [==============================] - 9s 26ms/step - loss: 0.1108 - acc: 0.9690
Epoch 12/30

334/334 [==============================] - 9s 26ms/step - loss: 0.1008 - acc: 0.9745
Epoch 13/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0856 - acc: 0.9813
Epoch 14/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0831 - acc: 0.9814
Epoch 15/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0745 - acc: 0.9821
Epoch 16/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0673 - acc: 0.9846
Epoch 17/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0641 - acc: 0.9856
Epoch 18/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0585 - acc: 0.9857
Epoch 19/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0529 - acc: 0.9883
Epoch 20/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0504 - acc: 0.9890
Epoch 21/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0450 - acc: 0.9909
Epoch 22/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0427 - acc: 0.9911
Epoch 23/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0441 - acc: 0.9908
Epoch 24/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0370 - acc: 0.9918
Epoch 25/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0365 - acc: 0.9926
Epoch 26/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0339 - acc: 0.9932
Epoch 27/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0304 - acc: 0.9929
Epoch 28/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0323 - acc: 0.9937
Epoch 29/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0294 - acc: 0.9938
Epoch 30/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0283 - acc: 0.9938
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8013
False 1058
True percentage 0.883364568405
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-LOC       0.68      0.67      0.67       218
      I-LOC       0.79      0.74      0.76       141
      B-PER       0.88      0.70      0.78       438
      B-ORG       0.68      0.69      0.69       296
      I-ORG       0.59      0.56      0.58       151
     B-MISC       0.42      0.30      0.35       141
     I-MISC       0.47      0.45      0.46       154
      I-PER       0.85      0.54      0.66       214

avg / total       0.93      0.88      0.90      9071

F-1 Score (without O):
0.655477570949
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 100389 unique words.
Found 94 unique chars.
Found 9 unique labels.
385 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 280
OOV word occurences: 436
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6424960     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,531,522
Trainable params: 6,531,522
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

334/334 [==============================] - 11s 32ms/step - loss: 0.8016 - acc: 0.7824
Epoch 2/30

334/334 [==============================] - 9s 27ms/step - loss: 0.4384 - acc: 0.8620
Epoch 3/30

334/334 [==============================] - 9s 27ms/step - loss: 0.3307 - acc: 0.8969
Epoch 4/30

334/334 [==============================] - 9s 27ms/step - loss: 0.2686 - acc: 0.9204
Epoch 5/30

334/334 [==============================] - 9s 27ms/step - loss: 0.2230 - acc: 0.9359
Epoch 6/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1928 - acc: 0.9443
Epoch 7/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1693 - acc: 0.9545
Epoch 8/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1514 - acc: 0.9586
Epoch 9/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1332 - acc: 0.9665
Epoch 10/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1198 - acc: 0.9714
Epoch 11/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1071 - acc: 0.9739
Epoch 12/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1013 - acc: 0.9763
Epoch 13/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0885 - acc: 0.9777
Epoch 14/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0830 - acc: 0.9798
Epoch 15/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0752 - acc: 0.9825
Epoch 16/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0672 - acc: 0.9850
Epoch 17/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0626 - acc: 0.9853
Epoch 18/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0620 - acc: 0.9853
Epoch 19/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0554 - acc: 0.9879
Epoch 20/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0492 - acc: 0.9886
Epoch 21/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0496 - acc: 0.9893
Epoch 22/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0465 - acc: 0.9895
Epoch 23/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0429 - acc: 0.9906
Epoch 24/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0394 - acc: 0.9919
Epoch 25/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0385 - acc: 0.9928
Epoch 26/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0334 - acc: 0.9926
Epoch 27/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0358 - acc: 0.9906
Epoch 28/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0303 - acc: 0.9930
Epoch 29/30

334/334 [==============================] - 9s 28ms/step - loss: 0.0295 - acc: 0.9943
Epoch 30/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0279 - acc: 0.9949
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7953
False 1118
True percentage 0.876750082681
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.96      0.96      7318
      B-ORG       0.71      0.66      0.68       296
      I-ORG       0.61      0.39      0.48       151
      B-PER       0.88      0.63      0.73       438
      I-PER       0.83      0.49      0.62       214
     B-MISC       0.23      0.16      0.19       141
     I-MISC       0.43      0.35      0.38       154
      B-LOC       0.70      0.67      0.68       218
      I-LOC       0.79      0.60      0.68       141

avg / total       0.91      0.88      0.89      9071

F-1 Score (without O):
0.60578778135
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100372 unique words.
Found 94 unique chars.
Found 9 unique labels.
368 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 283
OOV word occurences: 438
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6423872     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,530,434
Trainable params: 6,530,434
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

334/334 [==============================] - 11s 32ms/step - loss: 0.8219 - acc: 0.7751
Epoch 2/30

334/334 [==============================] - 9s 27ms/step - loss: 0.4361 - acc: 0.8698
Epoch 3/30

334/334 [==============================] - 9s 27ms/step - loss: 0.3299 - acc: 0.9063
Epoch 4/30

334/334 [==============================] - 9s 27ms/step - loss: 0.2596 - acc: 0.9222
Epoch 5/30

334/334 [==============================] - 9s 27ms/step - loss: 0.2061 - acc: 0.9391
Epoch 6/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1800 - acc: 0.9477
Epoch 7/30

334/334 [==============================] - 9s 28ms/step - loss: 0.1543 - acc: 0.9576
Epoch 8/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1347 - acc: 0.9628
Epoch 9/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1208 - acc: 0.9685
Epoch 10/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1074 - acc: 0.9736
Epoch 11/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1000 - acc: 0.9770
Epoch 12/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0863 - acc: 0.9800
Epoch 13/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0802 - acc: 0.9818
Epoch 14/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0701 - acc: 0.9870
Epoch 15/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0659 - acc: 0.9854
Epoch 16/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0627 - acc: 0.9867
Epoch 17/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0569 - acc: 0.9893
Epoch 18/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0520 - acc: 0.9890
Epoch 19/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0473 - acc: 0.9903
Epoch 20/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0448 - acc: 0.9908
Epoch 21/30

334/334 [==============================] - 9s 28ms/step - loss: 0.0405 - acc: 0.9915
Epoch 22/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0393 - acc: 0.9918
Epoch 23/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0380 - acc: 0.9918
Epoch 24/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0356 - acc: 0.9926
Epoch 25/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0325 - acc: 0.9941
Epoch 26/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0334 - acc: 0.9932
Epoch 27/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0291 - acc: 0.9953
Epoch 28/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0272 - acc: 0.9948
Epoch 29/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0268 - acc: 0.9950
Epoch 30/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0260 - acc: 0.9951
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8002
False 1069
True percentage 0.882151912689
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-PER       0.89      0.70      0.78       438
      B-LOC       0.69      0.68      0.69       218
     B-MISC       0.33      0.26      0.29       141
     I-MISC       0.39      0.44      0.41       154
      B-ORG       0.73      0.66      0.69       296
      I-ORG       0.61      0.43      0.51       151
      I-LOC       0.80      0.67      0.73       141
      I-PER       0.90      0.61      0.72       214

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.644822256569
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100207 unique words.
Found 94 unique chars.
Found 9 unique labels.
203 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 299
OOV word occurences: 525
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6413312     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,519,874
Trainable params: 6,519,874
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

167/167 [==============================] - 6s 38ms/step - loss: 1.0314 - acc: 0.7272
Epoch 2/30

167/167 [==============================] - 5s 27ms/step - loss: 0.6043 - acc: 0.8118
Epoch 3/30

167/167 [==============================] - 5s 28ms/step - loss: 0.4723 - acc: 0.8531
Epoch 4/30

167/167 [==============================] - 5s 28ms/step - loss: 0.3798 - acc: 0.8847
Epoch 5/30

167/167 [==============================] - 5s 27ms/step - loss: 0.3157 - acc: 0.9095
Epoch 6/30

167/167 [==============================] - 5s 27ms/step - loss: 0.2659 - acc: 0.9247
Epoch 7/30

167/167 [==============================] - 5s 27ms/step - loss: 0.2450 - acc: 0.9314
Epoch 8/30

167/167 [==============================] - 5s 27ms/step - loss: 0.2042 - acc: 0.9423
Epoch 9/30

167/167 [==============================] - 5s 28ms/step - loss: 0.1893 - acc: 0.9466
Epoch 10/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1774 - acc: 0.9516
Epoch 11/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1550 - acc: 0.9604
Epoch 12/30

167/167 [==============================] - 5s 28ms/step - loss: 0.1437 - acc: 0.9627
Epoch 13/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1259 - acc: 0.9697
Epoch 14/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1175 - acc: 0.9722
Epoch 15/30

167/167 [==============================] - 4s 27ms/step - loss: 0.1048 - acc: 0.9782
Epoch 16/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0977 - acc: 0.9790
Epoch 17/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0872 - acc: 0.9842
Epoch 18/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0827 - acc: 0.9849
Epoch 19/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0737 - acc: 0.9876
Epoch 20/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0658 - acc: 0.9891
Epoch 21/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0636 - acc: 0.9891
Epoch 22/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0602 - acc: 0.9901
Epoch 23/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0531 - acc: 0.9913
Epoch 24/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0509 - acc: 0.9907
Epoch 25/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0467 - acc: 0.9940
Epoch 26/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0470 - acc: 0.9929
Epoch 27/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0392 - acc: 0.9955
Epoch 28/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0385 - acc: 0.9949
Epoch 29/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0339 - acc: 0.9959
Epoch 30/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0344 - acc: 0.9956
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7668
False 1403
True percentage 0.845331275493
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.94      0.95      7318
      B-LOC       0.73      0.56      0.63       218
      I-LOC       0.81      0.49      0.61       141
      B-PER       0.83      0.47      0.60       438
      B-ORG       0.67      0.58      0.62       296
      I-ORG       0.54      0.25      0.34       151
     B-MISC       0.21      0.22      0.21       141
     I-MISC       0.28      0.45      0.34       154
      I-PER       0.62      0.37      0.47       214

avg / total       0.90      0.85      0.87      9071

F-1 Score (without O):
0.505946640951
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 100238 unique words.
Found 94 unique chars.
Found 9 unique labels.
234 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 300
OOV word occurences: 517
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6415296     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,521,858
Trainable params: 6,521,858
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

167/167 [==============================] - 6s 37ms/step - loss: 0.9538 - acc: 0.7450
Epoch 2/30

167/167 [==============================] - 4s 27ms/step - loss: 0.5204 - acc: 0.8364
Epoch 3/30

167/167 [==============================] - 5s 27ms/step - loss: 0.4223 - acc: 0.8694
Epoch 4/30

167/167 [==============================] - 4s 27ms/step - loss: 0.3443 - acc: 0.8908
Epoch 5/30

167/167 [==============================] - 4s 27ms/step - loss: 0.2905 - acc: 0.9120
Epoch 6/30

167/167 [==============================] - 4s 27ms/step - loss: 0.2525 - acc: 0.9292
Epoch 7/30

167/167 [==============================] - 4s 27ms/step - loss: 0.2192 - acc: 0.9389
Epoch 8/30

167/167 [==============================] - 4s 27ms/step - loss: 0.1955 - acc: 0.9455
Epoch 9/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1726 - acc: 0.9555
Epoch 10/30

167/167 [==============================] - 4s 27ms/step - loss: 0.1526 - acc: 0.9571
Epoch 11/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1409 - acc: 0.9628
Epoch 12/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1268 - acc: 0.9671
Epoch 13/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1196 - acc: 0.9665
Epoch 14/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1065 - acc: 0.9746
Epoch 15/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0991 - acc: 0.9780
Epoch 16/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0939 - acc: 0.9794
Epoch 17/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0847 - acc: 0.9804
Epoch 18/30

167/167 [==============================] - 4s 27ms/step - loss: 0.0781 - acc: 0.9815
Epoch 19/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0724 - acc: 0.9875
Epoch 20/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0692 - acc: 0.9865
Epoch 21/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0633 - acc: 0.9860
Epoch 22/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0562 - acc: 0.9897
Epoch 23/30

167/167 [==============================] - 4s 27ms/step - loss: 0.0564 - acc: 0.9899
Epoch 24/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0517 - acc: 0.9904
Epoch 25/30

167/167 [==============================] - 4s 27ms/step - loss: 0.0516 - acc: 0.9902
Epoch 26/30

167/167 [==============================] - 4s 27ms/step - loss: 0.0444 - acc: 0.9923
Epoch 27/30

167/167 [==============================] - 4s 27ms/step - loss: 0.0417 - acc: 0.9933
Epoch 28/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0405 - acc: 0.9927
Epoch 29/30

167/167 [==============================] - 4s 26ms/step - loss: 0.0378 - acc: 0.9928
Epoch 30/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0361 - acc: 0.9950
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7799
False 1272
True percentage 0.859772902657
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-ORG       0.55      0.46      0.50       296
      I-ORG       0.44      0.37      0.40       151
      B-PER       0.80      0.63      0.71       438
      I-PER       0.76      0.43      0.55       214
     B-MISC       0.15      0.05      0.07       141
     I-MISC       0.38      0.28      0.32       154
      B-LOC       0.65      0.65      0.65       218
      I-LOC       0.65      0.62      0.64       141

avg / total       0.90      0.86      0.88      9071

F-1 Score (without O):
0.541062801932
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100196 unique words.
Found 94 unique chars.
Found 9 unique labels.
192 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 300
OOV word occurences: 485
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6412608     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,519,170
Trainable params: 6,519,170
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

167/167 [==============================] - 6s 38ms/step - loss: 0.9741 - acc: 0.7347
Epoch 2/30

167/167 [==============================] - 5s 27ms/step - loss: 0.5852 - acc: 0.8220
Epoch 3/30

167/167 [==============================] - 5s 27ms/step - loss: 0.4579 - acc: 0.8637
Epoch 4/30

167/167 [==============================] - 5s 27ms/step - loss: 0.3669 - acc: 0.8861
Epoch 5/30

167/167 [==============================] - 5s 28ms/step - loss: 0.3045 - acc: 0.9079
Epoch 6/30

167/167 [==============================] - 5s 28ms/step - loss: 0.2679 - acc: 0.9225
Epoch 7/30

167/167 [==============================] - 5s 27ms/step - loss: 0.2284 - acc: 0.9360
Epoch 8/30

167/167 [==============================] - 5s 28ms/step - loss: 0.2098 - acc: 0.9375
Epoch 9/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1794 - acc: 0.9564
Epoch 10/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1662 - acc: 0.9549
Epoch 11/30

167/167 [==============================] - 5s 28ms/step - loss: 0.1503 - acc: 0.9657
Epoch 12/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1354 - acc: 0.9649
Epoch 13/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1227 - acc: 0.9704
Epoch 14/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1134 - acc: 0.9711
Epoch 15/30

167/167 [==============================] - 4s 27ms/step - loss: 0.1031 - acc: 0.9731
Epoch 16/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0916 - acc: 0.9798
Epoch 17/30

167/167 [==============================] - 4s 27ms/step - loss: 0.0888 - acc: 0.9797
Epoch 18/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0802 - acc: 0.9836
Epoch 19/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0748 - acc: 0.9827
Epoch 20/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0704 - acc: 0.9843
Epoch 21/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0622 - acc: 0.9881
Epoch 22/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0588 - acc: 0.9884
Epoch 23/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0560 - acc: 0.9875
Epoch 24/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0544 - acc: 0.9903
Epoch 25/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0481 - acc: 0.9896
Epoch 26/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0461 - acc: 0.9929
Epoch 27/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0441 - acc: 0.9902
Epoch 28/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0435 - acc: 0.9912
Epoch 29/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0383 - acc: 0.9942
Epoch 30/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0351 - acc: 0.9940
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7773
False 1298
True percentage 0.85690662551
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.94      0.95      7318
      B-PER       0.82      0.65      0.72       438
      B-LOC       0.69      0.56      0.62       218
     B-MISC       0.21      0.20      0.20       141
     I-MISC       0.25      0.27      0.26       154
      B-ORG       0.64      0.63      0.64       296
      I-ORG       0.41      0.30      0.35       151
      I-LOC       0.77      0.59      0.67       141
      I-PER       0.81      0.43      0.56       214

avg / total       0.90      0.86      0.88      9071

F-1 Score (without O):
0.552886115445
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100098 unique words.
Found 94 unique chars.
Found 9 unique labels.
94 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 315
OOV word occurences: 594
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6406336     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,512,898
Trainable params: 6,512,898
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

83/83 [==============================] - 4s 50ms/step - loss: 1.3112 - acc: 0.6491
Epoch 2/30

83/83 [==============================] - 2s 28ms/step - loss: 0.7610 - acc: 0.7981
Epoch 3/30

83/83 [==============================] - 2s 29ms/step - loss: 0.6355 - acc: 0.8058
Epoch 4/30

83/83 [==============================] - 2s 29ms/step - loss: 0.5325 - acc: 0.8220
Epoch 5/30

83/83 [==============================] - 2s 29ms/step - loss: 0.4739 - acc: 0.8425
Epoch 6/30

83/83 [==============================] - 2s 28ms/step - loss: 0.4172 - acc: 0.8649
Epoch 7/30

83/83 [==============================] - 2s 29ms/step - loss: 0.3660 - acc: 0.8846
Epoch 8/30

83/83 [==============================] - 2s 29ms/step - loss: 0.3271 - acc: 0.8956
Epoch 9/30

83/83 [==============================] - 2s 29ms/step - loss: 0.2917 - acc: 0.9209
Epoch 10/30

83/83 [==============================] - 2s 29ms/step - loss: 0.2615 - acc: 0.9164
Epoch 11/30

83/83 [==============================] - 2s 29ms/step - loss: 0.2326 - acc: 0.9303
Epoch 12/30

83/83 [==============================] - 2s 28ms/step - loss: 0.2067 - acc: 0.9427
Epoch 13/30

83/83 [==============================] - 2s 29ms/step - loss: 0.1964 - acc: 0.9551
Epoch 14/30

83/83 [==============================] - 2s 29ms/step - loss: 0.1702 - acc: 0.9625
Epoch 15/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1604 - acc: 0.9596
Epoch 16/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1527 - acc: 0.9676
Epoch 17/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1347 - acc: 0.9684
Epoch 18/30

83/83 [==============================] - 2s 29ms/step - loss: 0.1244 - acc: 0.9776
Epoch 19/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1153 - acc: 0.9799
Epoch 20/30

83/83 [==============================] - 2s 29ms/step - loss: 0.1071 - acc: 0.9807
Epoch 21/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1002 - acc: 0.9806
Epoch 22/30

83/83 [==============================] - 2s 29ms/step - loss: 0.0900 - acc: 0.9853
Epoch 23/30

83/83 [==============================] - 2s 29ms/step - loss: 0.0897 - acc: 0.9846
Epoch 24/30

83/83 [==============================] - 2s 29ms/step - loss: 0.0829 - acc: 0.9856
Epoch 25/30

83/83 [==============================] - 2s 29ms/step - loss: 0.0755 - acc: 0.9848
Epoch 26/30

83/83 [==============================] - 2s 29ms/step - loss: 0.0701 - acc: 0.9882
Epoch 27/30

83/83 [==============================] - 2s 29ms/step - loss: 0.0674 - acc: 0.9903
Epoch 28/30

83/83 [==============================] - 2s 29ms/step - loss: 0.0618 - acc: 0.9921
Epoch 29/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0609 - acc: 0.9919
Epoch 30/30

83/83 [==============================] - 2s 29ms/step - loss: 0.0526 - acc: 0.9945
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7551
False 1520
True percentage 0.832433028332
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.94      0.95      7318
      B-LOC       0.68      0.56      0.61       218
      I-LOC       0.77      0.41      0.54       141
      B-PER       0.70      0.37      0.49       438
      B-ORG       0.52      0.56      0.54       296
      I-ORG       0.30      0.37      0.33       151
     B-MISC       0.17      0.03      0.05       141
     I-MISC       0.27      0.14      0.18       154
      I-PER       0.55      0.35      0.43       214

avg / total       0.87      0.83      0.85      9071

F-1 Score (without O):
0.44578313253
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 100119 unique words.
Found 94 unique chars.
Found 9 unique labels.
115 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 311
OOV word occurences: 550
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6407680     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,514,242
Trainable params: 6,514,242
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

83/83 [==============================] - 4s 48ms/step - loss: 1.1509 - acc: 0.7076
Epoch 2/30

83/83 [==============================] - 2s 27ms/step - loss: 0.6827 - acc: 0.8249
Epoch 3/30

83/83 [==============================] - 2s 27ms/step - loss: 0.5525 - acc: 0.8288
Epoch 4/30

83/83 [==============================] - 2s 28ms/step - loss: 0.4686 - acc: 0.8536
Epoch 5/30

83/83 [==============================] - 2s 28ms/step - loss: 0.3975 - acc: 0.8740
Epoch 6/30

83/83 [==============================] - 2s 28ms/step - loss: 0.3397 - acc: 0.8921
Epoch 7/30

83/83 [==============================] - 2s 27ms/step - loss: 0.3132 - acc: 0.9084
Epoch 8/30

83/83 [==============================] - 2s 28ms/step - loss: 0.2868 - acc: 0.9220
Epoch 9/30

83/83 [==============================] - 2s 27ms/step - loss: 0.2427 - acc: 0.9308
Epoch 10/30

83/83 [==============================] - 2s 27ms/step - loss: 0.2161 - acc: 0.9476
Epoch 11/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1983 - acc: 0.9442
Epoch 12/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1762 - acc: 0.9577
Epoch 13/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1574 - acc: 0.9638
Epoch 14/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1576 - acc: 0.9597
Epoch 15/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1346 - acc: 0.9696
Epoch 16/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1331 - acc: 0.9727
Epoch 17/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1136 - acc: 0.9776
Epoch 18/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1088 - acc: 0.9770
Epoch 19/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1015 - acc: 0.9822
Epoch 20/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0939 - acc: 0.9811
Epoch 21/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0883 - acc: 0.9852
Epoch 22/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0844 - acc: 0.9822
Epoch 23/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0767 - acc: 0.9837
Epoch 24/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0724 - acc: 0.9893
Epoch 25/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0671 - acc: 0.9840
Epoch 26/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0670 - acc: 0.9888
Epoch 27/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0593 - acc: 0.9892
Epoch 28/30

83/83 [==============================] - 2s 29ms/step - loss: 0.0612 - acc: 0.9878
Epoch 29/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0589 - acc: 0.9892
Epoch 30/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0529 - acc: 0.9936
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7671
False 1400
True percentage 0.84566199978
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.95      0.95      7318
      B-ORG       0.53      0.39      0.45       296
      I-ORG       0.57      0.30      0.39       151
      B-PER       0.79      0.58      0.67       438
      I-PER       0.71      0.45      0.55       214
     B-MISC       0.09      0.02      0.03       141
     I-MISC       0.17      0.03      0.05       154
      B-LOC       0.68      0.46      0.55       218
      I-LOC       0.50      0.67      0.57       141

avg / total       0.87      0.85      0.85      9071

F-1 Score (without O):
0.489500860585
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100100 unique words.
Found 94 unique chars.
Found 9 unique labels.
96 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 313
OOV word occurences: 541
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6406464     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,513,026
Trainable params: 6,513,026
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

83/83 [==============================] - 4s 49ms/step - loss: 1.1875 - acc: 0.6748
Epoch 2/30

83/83 [==============================] - 2s 27ms/step - loss: 0.6913 - acc: 0.8119
Epoch 3/30

83/83 [==============================] - 2s 28ms/step - loss: 0.5753 - acc: 0.8330
Epoch 4/30

83/83 [==============================] - 2s 28ms/step - loss: 0.4721 - acc: 0.8492
Epoch 5/30

83/83 [==============================] - 2s 27ms/step - loss: 0.5997 - acc: 0.8701
Epoch 6/30

83/83 [==============================] - 2s 28ms/step - loss: 0.3933 - acc: 0.8804
Epoch 7/30

83/83 [==============================] - 2s 28ms/step - loss: 0.3514 - acc: 0.8981
Epoch 8/30

83/83 [==============================] - 2s 28ms/step - loss: 0.3141 - acc: 0.9067
Epoch 9/30

83/83 [==============================] - 2s 27ms/step - loss: 0.2810 - acc: 0.9255
Epoch 10/30

83/83 [==============================] - 2s 27ms/step - loss: 0.2602 - acc: 0.9222
Epoch 11/30

83/83 [==============================] - 2s 27ms/step - loss: 0.2405 - acc: 0.9323
Epoch 12/30

83/83 [==============================] - 2s 28ms/step - loss: 0.2178 - acc: 0.9437
Epoch 13/30

83/83 [==============================] - 2s 28ms/step - loss: 0.2006 - acc: 0.9500
Epoch 14/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1886 - acc: 0.9518
Epoch 15/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1707 - acc: 0.9532
Epoch 16/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1552 - acc: 0.9692
Epoch 17/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1470 - acc: 0.9686
Epoch 18/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1395 - acc: 0.9684
Epoch 19/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1295 - acc: 0.9729
Epoch 20/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1229 - acc: 0.9735
Epoch 21/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1109 - acc: 0.9805
Epoch 22/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0999 - acc: 0.9797
Epoch 23/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0992 - acc: 0.9809
Epoch 24/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0915 - acc: 0.9785
Epoch 25/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0859 - acc: 0.9835
Epoch 26/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0802 - acc: 0.9875
Epoch 27/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0750 - acc: 0.9877
Epoch 28/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0697 - acc: 0.9895
Epoch 29/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0680 - acc: 0.9899
Epoch 30/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0661 - acc: 0.9851
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7574
False 1497
True percentage 0.834968581193
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.95      0.94      7318
      B-PER       0.75      0.49      0.59       438
      B-LOC       0.64      0.58      0.61       218
     B-MISC       0.18      0.06      0.09       141
     I-MISC       0.24      0.16      0.19       154
      B-ORG       0.53      0.42      0.47       296
      I-ORG       0.31      0.13      0.19       151
      I-LOC       0.85      0.44      0.58       141
      I-PER       0.70      0.29      0.41       214

avg / total       0.86      0.83      0.84      9071

F-1 Score (without O):
0.450684450684
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 100101 unique words.
Found 94 unique chars.
Found 9 unique labels.
97 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 311
OOV word occurences: 542
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6406528     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,513,090
Trainable params: 6,513,090
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

83/83 [==============================] - 4s 49ms/step - loss: 1.2541 - acc: 0.6653
Epoch 2/30

83/83 [==============================] - 2s 29ms/step - loss: 0.7655 - acc: 0.7853
Epoch 3/30

83/83 [==============================] - 2s 29ms/step - loss: 0.6329 - acc: 0.7926
Epoch 4/30

83/83 [==============================] - 2s 29ms/step - loss: 0.5319 - acc: 0.8415
Epoch 5/30

83/83 [==============================] - 2s 28ms/step - loss: 0.4720 - acc: 0.8521
Epoch 6/30

83/83 [==============================] - 2s 29ms/step - loss: 0.3949 - acc: 0.8919
Epoch 7/30

83/83 [==============================] - 2s 29ms/step - loss: 0.3507 - acc: 0.9038
Epoch 8/30

83/83 [==============================] - 2s 29ms/step - loss: 0.3139 - acc: 0.9116
Epoch 9/30

83/83 [==============================] - 2s 29ms/step - loss: 0.2781 - acc: 0.9331
Epoch 10/30

83/83 [==============================] - 2s 29ms/step - loss: 0.2569 - acc: 0.9289
Epoch 11/30

83/83 [==============================] - 2s 29ms/step - loss: 0.2269 - acc: 0.9400
Epoch 12/30

83/83 [==============================] - 2s 29ms/step - loss: 0.2103 - acc: 0.9486
Epoch 13/30

83/83 [==============================] - 2s 29ms/step - loss: 0.1905 - acc: 0.9520
Epoch 14/30

83/83 [==============================] - 2s 29ms/step - loss: 0.1757 - acc: 0.9573
Epoch 15/30

83/83 [==============================] - 2s 29ms/step - loss: 0.1601 - acc: 0.9629
Epoch 16/30

83/83 [==============================] - 2s 29ms/step - loss: 0.1523 - acc: 0.9609
Epoch 17/30

83/83 [==============================] - 2s 29ms/step - loss: 0.1371 - acc: 0.9721
Epoch 18/30

83/83 [==============================] - 2s 29ms/step - loss: 0.1265 - acc: 0.9762
Epoch 19/30

83/83 [==============================] - 2s 29ms/step - loss: 0.1174 - acc: 0.9737
Epoch 20/30

83/83 [==============================] - 2s 29ms/step - loss: 0.1085 - acc: 0.9814
Epoch 21/30

83/83 [==============================] - 2s 29ms/step - loss: 0.0965 - acc: 0.9795
Epoch 22/30

83/83 [==============================] - 2s 29ms/step - loss: 0.0903 - acc: 0.9842
Epoch 23/30

83/83 [==============================] - 2s 29ms/step - loss: 0.0866 - acc: 0.9829
Epoch 24/30

83/83 [==============================] - 2s 29ms/step - loss: 0.0767 - acc: 0.9895
Epoch 25/30

83/83 [==============================] - 2s 29ms/step - loss: 0.0698 - acc: 0.9901
Epoch 26/30

83/83 [==============================] - 2s 29ms/step - loss: 0.0691 - acc: 0.9873
Epoch 27/30

83/83 [==============================] - 2s 29ms/step - loss: 0.0697 - acc: 0.9880
Epoch 28/30

83/83 [==============================] - 2s 29ms/step - loss: 0.0564 - acc: 0.9933
Epoch 29/30

83/83 [==============================] - 2s 29ms/step - loss: 0.0569 - acc: 0.9908
Epoch 30/30

83/83 [==============================] - 2s 29ms/step - loss: 0.0545 - acc: 0.9899
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7682
False 1389
True percentage 0.846874655496
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.95      0.95      7318
      B-ORG       0.54      0.50      0.52       296
      I-ORG       0.44      0.25      0.32       151
      B-PER       0.79      0.61      0.69       438
      I-PER       0.73      0.44      0.55       214
      B-LOC       0.82      0.49      0.61       218
      I-LOC       0.82      0.16      0.27       141
     B-MISC       0.21      0.15      0.17       141
     I-MISC       0.32      0.44      0.37       154

avg / total       0.89      0.85      0.86      9071

F-1 Score (without O):
0.501474926254
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100039 unique words.
Found 93 unique chars.
Found 9 unique labels.
35 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 322
OOV word occurences: 617
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6402560     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,509,058
Trainable params: 6,509,058
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

33/33 [==============================] - 3s 86ms/step - loss: 1.8089 - acc: 0.3905
Epoch 2/30

33/33 [==============================] - 1s 31ms/step - loss: 0.9271 - acc: 0.7826
Epoch 3/30

33/33 [==============================] - 1s 31ms/step - loss: 0.8244 - acc: 0.7830
Epoch 4/30

33/33 [==============================] - 1s 30ms/step - loss: 0.7447 - acc: 0.7808
Epoch 5/30

33/33 [==============================] - 1s 30ms/step - loss: 0.7095 - acc: 0.7889
Epoch 6/30

33/33 [==============================] - 1s 30ms/step - loss: 0.6362 - acc: 0.7946
Epoch 7/30

33/33 [==============================] - 1s 30ms/step - loss: 0.6081 - acc: 0.8007
Epoch 8/30

33/33 [==============================] - 1s 30ms/step - loss: 0.5492 - acc: 0.8254
Epoch 9/30

33/33 [==============================] - 1s 30ms/step - loss: 0.5245 - acc: 0.8218
Epoch 10/30

33/33 [==============================] - 1s 30ms/step - loss: 0.4632 - acc: 0.8481
Epoch 11/30

33/33 [==============================] - 1s 30ms/step - loss: 0.4593 - acc: 0.8864
Epoch 12/30

33/33 [==============================] - 1s 30ms/step - loss: 0.4313 - acc: 0.8602
Epoch 13/30

33/33 [==============================] - 1s 30ms/step - loss: 0.3946 - acc: 0.8658
Epoch 14/30

33/33 [==============================] - 1s 30ms/step - loss: 0.3802 - acc: 0.8977
Epoch 15/30

33/33 [==============================] - 1s 29ms/step - loss: 0.3558 - acc: 0.8910
Epoch 16/30

33/33 [==============================] - 1s 30ms/step - loss: 0.3388 - acc: 0.9103
Epoch 17/30

33/33 [==============================] - 1s 31ms/step - loss: 0.3263 - acc: 0.9051
Epoch 18/30

33/33 [==============================] - 1s 30ms/step - loss: 0.3071 - acc: 0.9179
Epoch 19/30

33/33 [==============================] - 1s 31ms/step - loss: 0.3163 - acc: 0.9302
Epoch 20/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2788 - acc: 0.9274
Epoch 21/30

33/33 [==============================] - 1s 31ms/step - loss: 0.2509 - acc: 0.9443
Epoch 22/30

33/33 [==============================] - 1s 31ms/step - loss: 0.2343 - acc: 0.9647
Epoch 23/30

33/33 [==============================] - 1s 31ms/step - loss: 0.2923 - acc: 0.9273
Epoch 24/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2198 - acc: 0.9754
Epoch 25/30

33/33 [==============================] - 1s 31ms/step - loss: 0.2083 - acc: 0.9623
Epoch 26/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1923 - acc: 0.9709
Epoch 27/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1881 - acc: 0.9635
Epoch 28/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1784 - acc: 0.9732
Epoch 29/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1749 - acc: 0.9892
Epoch 30/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1656 - acc: 0.9832
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7374
False 1697
True percentage 0.812920295447
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.92      0.94      0.93      7318
      B-LOC       0.67      0.39      0.49       218
      I-LOC       0.36      0.19      0.25       141
      B-PER       0.51      0.39      0.44       438
      B-ORG       0.52      0.32      0.40       296
      I-ORG       0.37      0.19      0.25       151
     B-MISC       0.12      0.06      0.08       141
     I-MISC       0.40      0.14      0.20       154
      I-PER       0.95      0.09      0.17       214

avg / total       0.84      0.81      0.82      9071

F-1 Score (without O):
0.339874120696
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 100046 unique words.
Found 93 unique chars.
Found 9 unique labels.
42 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 321
OOV word occurences: 563
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6403008     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,509,506
Trainable params: 6,509,506
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

33/33 [==============================] - 3s 83ms/step - loss: 1.7182 - acc: 0.4319
Epoch 2/30

33/33 [==============================] - 1s 30ms/step - loss: 0.8692 - acc: 0.8022
Epoch 3/30

33/33 [==============================] - 1s 31ms/step - loss: 0.7555 - acc: 0.8066
Epoch 4/30

33/33 [==============================] - 1s 29ms/step - loss: 0.7097 - acc: 0.8038
Epoch 5/30

33/33 [==============================] - 1s 30ms/step - loss: 0.6289 - acc: 0.8083
Epoch 6/30

33/33 [==============================] - 1s 30ms/step - loss: 0.5765 - acc: 0.8143
Epoch 7/30

33/33 [==============================] - 1s 30ms/step - loss: 0.5101 - acc: 0.8359
Epoch 8/30

33/33 [==============================] - 1s 30ms/step - loss: 0.4950 - acc: 0.8379
Epoch 9/30

33/33 [==============================] - 1s 31ms/step - loss: 0.4454 - acc: 0.8415
Epoch 10/30

33/33 [==============================] - 1s 30ms/step - loss: 0.4336 - acc: 0.8538
Epoch 11/30

33/33 [==============================] - 1s 29ms/step - loss: 0.4032 - acc: 0.8597
Epoch 12/30

33/33 [==============================] - 1s 30ms/step - loss: 0.3666 - acc: 0.8652
Epoch 13/30

33/33 [==============================] - 1s 30ms/step - loss: 0.3453 - acc: 0.8912
Epoch 14/30

33/33 [==============================] - 1s 30ms/step - loss: 0.3366 - acc: 0.8947
Epoch 15/30

33/33 [==============================] - 1s 30ms/step - loss: 0.3258 - acc: 0.8950
Epoch 16/30

33/33 [==============================] - 1s 31ms/step - loss: 0.3169 - acc: 0.8847
Epoch 17/30

33/33 [==============================] - 1s 29ms/step - loss: 0.2843 - acc: 0.9182
Epoch 18/30

33/33 [==============================] - 1s 29ms/step - loss: 0.2867 - acc: 0.9090
Epoch 19/30

33/33 [==============================] - 1s 29ms/step - loss: 0.2585 - acc: 0.9218
Epoch 20/30

33/33 [==============================] - 1s 29ms/step - loss: 0.2426 - acc: 0.9359
Epoch 21/30

33/33 [==============================] - 1s 31ms/step - loss: 0.2366 - acc: 0.9369
Epoch 22/30

33/33 [==============================] - 1s 29ms/step - loss: 0.2317 - acc: 0.9395
Epoch 23/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2189 - acc: 0.9371
Epoch 24/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2083 - acc: 0.9500
Epoch 25/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2477 - acc: 0.9432
Epoch 26/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1901 - acc: 0.9626
Epoch 27/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1788 - acc: 0.9680
Epoch 28/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1717 - acc: 0.9716
Epoch 29/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1614 - acc: 0.9774
Epoch 30/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1545 - acc: 0.9766
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7438
False 1633
True percentage 0.819975746886
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.94      0.94      7318
      B-ORG       0.39      0.32      0.35       296
      I-ORG       0.39      0.11      0.17       151
      B-PER       0.63      0.51      0.56       438
      I-PER       0.42      0.40      0.41       214
     B-MISC       0.11      0.05      0.07       141
     I-MISC       0.14      0.01      0.01       154
      B-LOC       0.64      0.32      0.42       218
      I-LOC       0.55      0.43      0.48       141

avg / total       0.84      0.82      0.83      9071

F-1 Score (without O):
0.386269070735
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100037 unique words.
Found 92 unique chars.
Found 9 unique labels.
33 unique words not found in embedding.
8 unique chars not found in embedding.
Number of OOV: 322
OOV word occurences: 564
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6402432     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,508,866
Trainable params: 6,508,866
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

33/33 [==============================] - 3s 82ms/step - loss: 1.9095 - acc: 0.4250
Epoch 2/30

33/33 [==============================] - 1s 29ms/step - loss: 0.9129 - acc: 0.7917
Epoch 3/30

33/33 [==============================] - 1s 31ms/step - loss: 0.7914 - acc: 0.7941
Epoch 4/30

33/33 [==============================] - 1s 30ms/step - loss: 0.7497 - acc: 0.7976
Epoch 5/30

33/33 [==============================] - 1s 31ms/step - loss: 0.6349 - acc: 0.8134
Epoch 6/30

33/33 [==============================] - 1s 31ms/step - loss: 0.6117 - acc: 0.8273
Epoch 7/30

33/33 [==============================] - 1s 30ms/step - loss: 0.5187 - acc: 0.8499
Epoch 8/30

33/33 [==============================] - 1s 30ms/step - loss: 0.4828 - acc: 0.8626
Epoch 9/30

33/33 [==============================] - 1s 30ms/step - loss: 0.4212 - acc: 0.8774
Epoch 10/30

33/33 [==============================] - 1s 31ms/step - loss: 0.4561 - acc: 0.8811
Epoch 11/30

33/33 [==============================] - 1s 30ms/step - loss: 0.3659 - acc: 0.9164
Epoch 12/30

33/33 [==============================] - 1s 31ms/step - loss: 0.3487 - acc: 0.9014
Epoch 13/30

33/33 [==============================] - 1s 30ms/step - loss: 0.3175 - acc: 0.9206
Epoch 14/30

33/33 [==============================] - 1s 30ms/step - loss: 0.3070 - acc: 0.9221
Epoch 15/30

33/33 [==============================] - 1s 29ms/step - loss: 0.2987 - acc: 0.9188
Epoch 16/30

33/33 [==============================] - 1s 31ms/step - loss: 0.2853 - acc: 0.9291
Epoch 17/30

33/33 [==============================] - 1s 31ms/step - loss: 0.2709 - acc: 0.9490
Epoch 18/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2471 - acc: 0.9436
Epoch 19/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2350 - acc: 0.9480
Epoch 20/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2167 - acc: 0.9549
Epoch 21/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2034 - acc: 0.9621
Epoch 22/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2069 - acc: 0.9551
Epoch 23/30

33/33 [==============================] - 1s 31ms/step - loss: 0.1953 - acc: 0.9558
Epoch 24/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1877 - acc: 0.9543
Epoch 25/30

33/33 [==============================] - 1s 31ms/step - loss: 0.1793 - acc: 0.9566
Epoch 26/30

33/33 [==============================] - 1s 31ms/step - loss: 0.1728 - acc: 0.9579
Epoch 27/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1690 - acc: 0.9559
Epoch 28/30

33/33 [==============================] - 1s 31ms/step - loss: 0.1636 - acc: 0.9583
Epoch 29/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1472 - acc: 0.9656
Epoch 30/30

33/33 [==============================] - 1s 31ms/step - loss: 0.1414 - acc: 0.9634
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7376
False 1695
True percentage 0.813140778304
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.92      0.94      0.93      7318
      B-PER       0.62      0.52      0.56       438
      B-LOC       0.56      0.32      0.41       218
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-ORG       0.43      0.47      0.45       296
      I-ORG       0.21      0.28      0.24       151
      I-LOC       0.00      0.00      0.00       141
      I-PER       0.51      0.19      0.27       214

avg / total       0.82      0.81      0.81      9071

F-1 Score (without O):
0.36299683433
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 100050 unique words.
Found 94 unique chars.
Found 9 unique labels.
46 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 319
OOV word occurences: 620
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6403264     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,509,826
Trainable params: 6,509,826
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

33/33 [==============================] - 3s 84ms/step - loss: 1.8477 - acc: 0.4286
Epoch 2/30

33/33 [==============================] - 1s 30ms/step - loss: 0.9229 - acc: 0.7859
Epoch 3/30

33/33 [==============================] - 1s 30ms/step - loss: 0.7939 - acc: 0.7853
Epoch 4/30

33/33 [==============================] - 1s 30ms/step - loss: 0.7478 - acc: 0.7854
Epoch 5/30

33/33 [==============================] - 1s 31ms/step - loss: 0.6730 - acc: 0.7904
Epoch 6/30

33/33 [==============================] - 1s 30ms/step - loss: 0.6430 - acc: 0.8015
Epoch 7/30

33/33 [==============================] - 1s 30ms/step - loss: 0.5894 - acc: 0.8043
Epoch 8/30

33/33 [==============================] - 1s 30ms/step - loss: 0.5348 - acc: 0.8143
Epoch 9/30

33/33 [==============================] - 1s 31ms/step - loss: 0.4979 - acc: 0.8421
Epoch 10/30

33/33 [==============================] - 1s 30ms/step - loss: 0.5559 - acc: 0.8682
Epoch 11/30

33/33 [==============================] - 1s 30ms/step - loss: 0.4358 - acc: 0.8648
Epoch 12/30

33/33 [==============================] - 1s 30ms/step - loss: 0.4210 - acc: 0.8768
Epoch 13/30

33/33 [==============================] - 1s 30ms/step - loss: 0.3864 - acc: 0.8895
Epoch 14/30

33/33 [==============================] - 1s 29ms/step - loss: 0.3618 - acc: 0.8876
Epoch 15/30

33/33 [==============================] - 1s 30ms/step - loss: 0.3425 - acc: 0.9012
Epoch 16/30

33/33 [==============================] - 1s 31ms/step - loss: 0.3243 - acc: 0.9009
Epoch 17/30

33/33 [==============================] - 1s 30ms/step - loss: 0.3204 - acc: 0.9162
Epoch 18/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2951 - acc: 0.9207
Epoch 19/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2760 - acc: 0.9233
Epoch 20/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2508 - acc: 0.9374
Epoch 21/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2434 - acc: 0.9358
Epoch 22/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2383 - acc: 0.9386
Epoch 23/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2246 - acc: 0.9497
Epoch 24/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1973 - acc: 0.9542
Epoch 25/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2055 - acc: 0.9500
Epoch 26/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1835 - acc: 0.9618
Epoch 27/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1736 - acc: 0.9689
Epoch 28/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1656 - acc: 0.9597
Epoch 29/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1527 - acc: 0.9640
Epoch 30/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1535 - acc: 0.9635
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7275
False 1796
True percentage 0.802006394003
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.93      0.93      7318
      B-ORG       0.39      0.49      0.43       296
      I-ORG       0.28      0.42      0.33       151
      B-PER       0.65      0.33      0.44       438
      I-PER       0.65      0.29      0.41       214
      B-LOC       0.93      0.11      0.20       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.20      0.30      0.24       154

avg / total       0.84      0.80      0.81      9071

F-1 Score (without O):
0.331972789116
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100022 unique words.
Found 92 unique chars.
Found 8 unique labels.
18 unique words not found in embedding.
8 unique chars not found in embedding.
Number of OOV: 324
OOV word occurences: 632
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401472     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,756
Trainable params: 6,507,756
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

16/16 [==============================] - 2s 134ms/step - loss: 2.6686 - acc: 0.0000e+00
Epoch 2/30

16/16 [==============================] - 0s 27ms/step - loss: 1.3568 - acc: 0.8407
Epoch 3/30

16/16 [==============================] - 0s 27ms/step - loss: 0.7162 - acc: 0.8466
Epoch 4/30

16/16 [==============================] - 0s 28ms/step - loss: 0.6596 - acc: 0.8466
Epoch 5/30

16/16 [==============================] - 0s 27ms/step - loss: 0.6294 - acc: 0.8466
Epoch 6/30

16/16 [==============================] - 0s 27ms/step - loss: 0.6112 - acc: 0.8466
Epoch 7/30

16/16 [==============================] - 0s 27ms/step - loss: 0.5712 - acc: 0.8466
Epoch 8/30

16/16 [==============================] - 0s 27ms/step - loss: 0.5625 - acc: 0.8466
Epoch 9/30

16/16 [==============================] - 0s 26ms/step - loss: 0.5177 - acc: 0.8466
Epoch 10/30

16/16 [==============================] - 0s 26ms/step - loss: 0.5062 - acc: 0.8466
Epoch 11/30

16/16 [==============================] - 0s 27ms/step - loss: 0.4804 - acc: 0.8466
Epoch 12/30

16/16 [==============================] - 0s 27ms/step - loss: 0.4593 - acc: 0.8614
Epoch 13/30

16/16 [==============================] - 0s 26ms/step - loss: 0.4347 - acc: 0.8466
Epoch 14/30

16/16 [==============================] - 0s 27ms/step - loss: 0.4127 - acc: 0.8820
Epoch 15/30

16/16 [==============================] - 0s 26ms/step - loss: 0.3859 - acc: 0.8496
Epoch 16/30

16/16 [==============================] - 0s 26ms/step - loss: 0.3540 - acc: 0.8968
Epoch 17/30

16/16 [==============================] - 0s 28ms/step - loss: 0.3243 - acc: 0.8820
Epoch 18/30

16/16 [==============================] - 0s 28ms/step - loss: 0.3058 - acc: 0.8968
Epoch 19/30

16/16 [==============================] - 0s 28ms/step - loss: 0.2973 - acc: 0.8938
Epoch 20/30

16/16 [==============================] - 0s 28ms/step - loss: 0.2530 - acc: 0.9204
Epoch 21/30

16/16 [==============================] - 0s 29ms/step - loss: 0.2481 - acc: 0.9027
Epoch 22/30

16/16 [==============================] - 0s 28ms/step - loss: 0.2701 - acc: 0.9528
Epoch 23/30

16/16 [==============================] - 0s 27ms/step - loss: 0.2238 - acc: 0.9086
Epoch 24/30

16/16 [==============================] - 0s 27ms/step - loss: 0.2071 - acc: 0.9558
Epoch 25/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1886 - acc: 0.9528
Epoch 26/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1737 - acc: 0.9528
Epoch 27/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1591 - acc: 0.9735
Epoch 28/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1482 - acc: 0.9617
Epoch 29/30

16/16 [==============================] - 0s 28ms/step - loss: 0.1406 - acc: 0.9853
Epoch 30/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1292 - acc: 0.9794
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7175
False 1682
True percentage 0.810093711189
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.88      0.95      0.92      7318
      B-LOC       0.72      0.11      0.18       218
      I-LOC       0.92      0.09      0.16       141
      B-PER       0.62      0.09      0.16       438
      B-ORG       0.31      0.41      0.35       296
      I-ORG       0.45      0.09      0.14       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.19      0.03      0.06       154

avg / total       0.81      0.81      0.79      8857

F-1 Score (without O):
0.203147353362
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 100028 unique words.
Found 93 unique chars.
Found 9 unique labels.
24 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 326
OOV word occurences: 637
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401856     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,508,354
Trainable params: 6,508,354
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

16/16 [==============================] - 2s 137ms/step - loss: 2.1762 - acc: 0.1984
Epoch 2/30

16/16 [==============================] - 0s 26ms/step - loss: 1.1568 - acc: 0.7748
Epoch 3/30

16/16 [==============================] - 0s 26ms/step - loss: 1.0718 - acc: 0.7748
Epoch 4/30

16/16 [==============================] - 0s 26ms/step - loss: 0.9622 - acc: 0.7748
Epoch 5/30

16/16 [==============================] - 0s 26ms/step - loss: 0.8467 - acc: 0.7748
Epoch 6/30

16/16 [==============================] - 0s 26ms/step - loss: 0.8058 - acc: 0.7748
Epoch 7/30

16/16 [==============================] - 0s 26ms/step - loss: 0.7568 - acc: 0.7748
Epoch 8/30

16/16 [==============================] - 0s 27ms/step - loss: 0.7152 - acc: 0.7748
Epoch 9/30

16/16 [==============================] - 0s 25ms/step - loss: 0.6646 - acc: 0.7775
Epoch 10/30

16/16 [==============================] - 0s 26ms/step - loss: 0.6281 - acc: 0.7775
Epoch 11/30

16/16 [==============================] - 0s 27ms/step - loss: 0.5748 - acc: 0.7989
Epoch 12/30

16/16 [==============================] - 0s 26ms/step - loss: 0.5318 - acc: 0.8284
Epoch 13/30

16/16 [==============================] - 0s 28ms/step - loss: 0.4838 - acc: 0.8418
Epoch 14/30

16/16 [==============================] - 0s 27ms/step - loss: 0.4465 - acc: 0.8686
Epoch 15/30

16/16 [==============================] - 0s 26ms/step - loss: 0.4549 - acc: 0.8257
Epoch 16/30

16/16 [==============================] - 0s 26ms/step - loss: 0.5476 - acc: 0.9008
Epoch 17/30

16/16 [==============================] - 0s 27ms/step - loss: 0.3841 - acc: 0.8794
Epoch 18/30

16/16 [==============================] - 0s 26ms/step - loss: 0.3717 - acc: 0.8981
Epoch 19/30

16/16 [==============================] - 0s 28ms/step - loss: 0.3450 - acc: 0.9008
Epoch 20/30

16/16 [==============================] - 0s 27ms/step - loss: 0.3108 - acc: 0.9142
Epoch 21/30

16/16 [==============================] - 0s 26ms/step - loss: 0.3070 - acc: 0.9142
Epoch 22/30

16/16 [==============================] - 0s 26ms/step - loss: 0.2780 - acc: 0.9303
Epoch 23/30

16/16 [==============================] - 0s 26ms/step - loss: 0.2660 - acc: 0.9544
Epoch 24/30

16/16 [==============================] - 0s 26ms/step - loss: 0.2514 - acc: 0.9491
Epoch 25/30

16/16 [==============================] - 0s 25ms/step - loss: 0.2382 - acc: 0.9544
Epoch 26/30

16/16 [==============================] - 0s 27ms/step - loss: 0.2156 - acc: 0.9571
Epoch 27/30

16/16 [==============================] - 0s 27ms/step - loss: 0.2132 - acc: 0.9598
Epoch 28/30

16/16 [==============================] - 0s 28ms/step - loss: 0.1956 - acc: 0.9759
Epoch 29/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1832 - acc: 0.9732
Epoch 30/30

16/16 [==============================] - 0s 26ms/step - loss: 0.1775 - acc: 0.9786
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7163
False 1908
True percentage 0.789659353985
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.90      0.94      0.92      7318
      B-ORG       0.26      0.35      0.30       296
      I-ORG       0.40      0.15      0.22       151
      B-PER       0.64      0.26      0.37       438
      I-PER       0.78      0.12      0.20       214
     B-MISC       0.10      0.04      0.06       141
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.44      0.04      0.07       218
      I-LOC       0.76      0.11      0.20       141

avg / total       0.81      0.79      0.78      9071

F-1 Score (without O):
0.234084618426
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100018 unique words.
Found 91 unique chars.
Found 9 unique labels.
14 unique words not found in embedding.
7 unique chars not found in embedding.
Number of OOV: 326
OOV word occurences: 638
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5888        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401216     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,586
Trainable params: 6,507,586
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

16/16 [==============================] - 2s 134ms/step - loss: 2.1607 - acc: 0.3003
Epoch 2/30

16/16 [==============================] - 0s 29ms/step - loss: 1.2360 - acc: 0.7802
Epoch 3/30

16/16 [==============================] - 0s 29ms/step - loss: 0.9475 - acc: 0.7802
Epoch 4/30

16/16 [==============================] - 0s 29ms/step - loss: 0.8743 - acc: 0.7802
Epoch 5/30

16/16 [==============================] - 0s 28ms/step - loss: 0.8310 - acc: 0.7802
Epoch 6/30

16/16 [==============================] - 0s 28ms/step - loss: 0.8144 - acc: 0.7802
Epoch 7/30

16/16 [==============================] - 0s 27ms/step - loss: 0.7307 - acc: 0.7802
Epoch 8/30

16/16 [==============================] - 0s 28ms/step - loss: 0.6982 - acc: 0.7802
Epoch 9/30

16/16 [==============================] - 0s 28ms/step - loss: 0.6561 - acc: 0.7802
Epoch 10/30

16/16 [==============================] - 0s 30ms/step - loss: 0.6096 - acc: 0.7957
Epoch 11/30

16/16 [==============================] - 0s 29ms/step - loss: 0.5539 - acc: 0.7895
Epoch 12/30

16/16 [==============================] - 0s 30ms/step - loss: 0.5265 - acc: 0.8266
Epoch 13/30

16/16 [==============================] - 0s 28ms/step - loss: 0.4767 - acc: 0.8297
Epoch 14/30

16/16 [==============================] - 0s 29ms/step - loss: 0.4271 - acc: 0.8576
Epoch 15/30

16/16 [==============================] - 0s 27ms/step - loss: 0.4182 - acc: 0.8607
Epoch 16/30

16/16 [==============================] - 0s 28ms/step - loss: 0.4788 - acc: 0.9071
Epoch 17/30

16/16 [==============================] - 0s 29ms/step - loss: 0.3826 - acc: 0.8545
Epoch 18/30

16/16 [==============================] - 0s 29ms/step - loss: 0.3422 - acc: 0.9102
Epoch 19/30

16/16 [==============================] - 0s 29ms/step - loss: 0.3131 - acc: 0.9009
Epoch 20/30

16/16 [==============================] - 0s 29ms/step - loss: 0.2907 - acc: 0.9133
Epoch 21/30

16/16 [==============================] - 0s 29ms/step - loss: 0.2669 - acc: 0.9164
Epoch 22/30

16/16 [==============================] - 0s 30ms/step - loss: 0.2482 - acc: 0.9257
Epoch 23/30

16/16 [==============================] - 0s 29ms/step - loss: 0.2380 - acc: 0.9257
Epoch 24/30

16/16 [==============================] - 0s 29ms/step - loss: 0.2107 - acc: 0.9536
Epoch 25/30

16/16 [==============================] - 0s 28ms/step - loss: 0.2023 - acc: 0.9381
Epoch 26/30

16/16 [==============================] - 0s 28ms/step - loss: 0.1914 - acc: 0.9567
Epoch 27/30

16/16 [==============================] - 0s 30ms/step - loss: 0.1760 - acc: 0.9628
Epoch 28/30

16/16 [==============================] - 0s 29ms/step - loss: 0.1704 - acc: 0.9628
Epoch 29/30

16/16 [==============================] - 0s 29ms/step - loss: 0.1477 - acc: 0.9690
Epoch 30/30

16/16 [==============================] - 0s 29ms/step - loss: 0.1313 - acc: 0.9721
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7155
False 1916
True percentage 0.788777422555
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.89      0.94      0.92      7318
      B-PER       0.51      0.19      0.28       438
      B-LOC       0.86      0.14      0.24       218
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-ORG       0.30      0.37      0.33       296
      I-ORG       0.16      0.10      0.12       151
      I-LOC       0.00      0.00      0.00       141
      I-PER       0.75      0.01      0.03       214

avg / total       0.79      0.79      0.77      9071

F-1 Score (without O):
0.201736254651
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 100030 unique words.
Found 93 unique chars.
Found 9 unique labels.
26 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 324
OOV word occurences: 628
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401984     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,508,482
Trainable params: 6,508,482
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

16/16 [==============================] - 2s 137ms/step - loss: 2.2242 - acc: 0.1565
Epoch 2/30

16/16 [==============================] - 0s 28ms/step - loss: 1.2612 - acc: 0.7666
Epoch 3/30

16/16 [==============================] - 0s 27ms/step - loss: 1.0259 - acc: 0.7692
Epoch 4/30

16/16 [==============================] - 0s 27ms/step - loss: 0.9698 - acc: 0.7692
Epoch 5/30

16/16 [==============================] - 0s 27ms/step - loss: 0.8488 - acc: 0.7692
Epoch 6/30

16/16 [==============================] - 0s 26ms/step - loss: 0.8067 - acc: 0.7692
Epoch 7/30

16/16 [==============================] - 0s 28ms/step - loss: 0.7601 - acc: 0.7692
Epoch 8/30

16/16 [==============================] - 0s 27ms/step - loss: 0.7115 - acc: 0.7692
Epoch 9/30

16/16 [==============================] - 0s 28ms/step - loss: 0.6812 - acc: 0.7719
Epoch 10/30

16/16 [==============================] - 0s 28ms/step - loss: 0.6340 - acc: 0.7772
Epoch 11/30

16/16 [==============================] - 0s 27ms/step - loss: 0.5963 - acc: 0.7798
Epoch 12/30

16/16 [==============================] - 0s 27ms/step - loss: 0.5567 - acc: 0.7984
Epoch 13/30

16/16 [==============================] - 0s 27ms/step - loss: 0.5216 - acc: 0.8196
Epoch 14/30

16/16 [==============================] - 0s 27ms/step - loss: 0.4893 - acc: 0.8382
Epoch 15/30

16/16 [==============================] - 0s 27ms/step - loss: 0.4467 - acc: 0.8568
Epoch 16/30

16/16 [==============================] - 0s 27ms/step - loss: 0.4107 - acc: 0.8886
Epoch 17/30

16/16 [==============================] - 0s 29ms/step - loss: 0.3790 - acc: 0.9045
Epoch 18/30

16/16 [==============================] - 0s 27ms/step - loss: 0.3520 - acc: 0.9363
Epoch 19/30

16/16 [==============================] - 0s 29ms/step - loss: 0.3656 - acc: 0.8806
Epoch 20/30

16/16 [==============================] - 0s 27ms/step - loss: 0.3871 - acc: 0.9602
Epoch 21/30

16/16 [==============================] - 0s 27ms/step - loss: 0.3032 - acc: 0.9072
Epoch 22/30

16/16 [==============================] - 0s 28ms/step - loss: 0.2618 - acc: 0.9708
Epoch 23/30

16/16 [==============================] - 0s 28ms/step - loss: 0.2411 - acc: 0.9735
Epoch 24/30

16/16 [==============================] - 0s 27ms/step - loss: 0.2123 - acc: 0.9708
Epoch 25/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1993 - acc: 0.9655
Epoch 26/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1848 - acc: 0.9761
Epoch 27/30

16/16 [==============================] - 0s 26ms/step - loss: 0.1723 - acc: 0.9735
Epoch 28/30

16/16 [==============================] - 0s 28ms/step - loss: 0.1611 - acc: 0.9761
Epoch 29/30

16/16 [==============================] - 0s 29ms/step - loss: 0.1420 - acc: 0.9814
Epoch 30/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1279 - acc: 0.9841
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7084
False 1987
True percentage 0.780950281116
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.88      0.94      0.91      7318
      B-ORG       0.31      0.34      0.33       296
      I-ORG       0.10      0.09      0.10       151
      B-PER       0.59      0.08      0.14       438
      I-PER       0.29      0.06      0.09       214
      B-LOC       0.79      0.25      0.38       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.78      0.78      0.76      9071

F-1 Score (without O):
0.180090871541
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100010 unique words.
Found 87 unique chars.
Found 8 unique labels.
6 unique words not found in embedding.
3 unique chars not found in embedding.
Number of OOV: 327
OOV word occurences: 639
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5632        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6400704     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,506,668
Trainable params: 6,506,668
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

8/8 [==============================] - 2s 244ms/step - loss: 2.1602 - acc: 0.0728
Epoch 2/30

8/8 [==============================] - 0s 33ms/step - loss: 1.1095 - acc: 0.8013
Epoch 3/30

8/8 [==============================] - 0s 33ms/step - loss: 0.7728 - acc: 0.8013
Epoch 4/30

8/8 [==============================] - 0s 33ms/step - loss: 0.7342 - acc: 0.8013
Epoch 5/30

8/8 [==============================] - 0s 32ms/step - loss: 0.6567 - acc: 0.8013
Epoch 6/30

8/8 [==============================] - 0s 33ms/step - loss: 0.6143 - acc: 0.8013
Epoch 7/30

8/8 [==============================] - 0s 33ms/step - loss: 0.5657 - acc: 0.8013
Epoch 8/30

8/8 [==============================] - 0s 32ms/step - loss: 0.5323 - acc: 0.8013
Epoch 9/30

8/8 [==============================] - 0s 33ms/step - loss: 0.4841 - acc: 0.8146
Epoch 10/30

8/8 [==============================] - 0s 32ms/step - loss: 0.4383 - acc: 0.8344
Epoch 11/30

8/8 [==============================] - 0s 34ms/step - loss: 0.4083 - acc: 0.8212
Epoch 12/30

8/8 [==============================] - 0s 33ms/step - loss: 0.3513 - acc: 0.8675
Epoch 13/30

8/8 [==============================] - 0s 33ms/step - loss: 0.3231 - acc: 0.9272
Epoch 14/30

8/8 [==============================] - 0s 34ms/step - loss: 0.3308 - acc: 0.8609
Epoch 15/30

8/8 [==============================] - 0s 32ms/step - loss: 0.3267 - acc: 0.9735
Epoch 16/30

8/8 [==============================] - 0s 33ms/step - loss: 0.2749 - acc: 0.8874
Epoch 17/30

8/8 [==============================] - 0s 33ms/step - loss: 0.2243 - acc: 0.9735
Epoch 18/30

8/8 [==============================] - 0s 32ms/step - loss: 0.2049 - acc: 0.9536
Epoch 19/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1699 - acc: 0.9735
Epoch 20/30

8/8 [==============================] - 0s 33ms/step - loss: 0.1547 - acc: 0.9735
Epoch 21/30

8/8 [==============================] - 0s 33ms/step - loss: 0.1524 - acc: 0.9669
Epoch 22/30

8/8 [==============================] - 0s 33ms/step - loss: 0.1298 - acc: 0.9868
Epoch 23/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1215 - acc: 0.9735
Epoch 24/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1306 - acc: 0.9934
Epoch 25/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1148 - acc: 0.9868
Epoch 26/30

8/8 [==============================] - 0s 33ms/step - loss: 0.0985 - acc: 0.9868
Epoch 27/30

8/8 [==============================] - 0s 32ms/step - loss: 0.0956 - acc: 0.9801
Epoch 28/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1033 - acc: 0.9934
Epoch 29/30

8/8 [==============================] - 0s 33ms/step - loss: 0.0869 - acc: 0.9934
Epoch 30/30

8/8 [==============================] - 0s 32ms/step - loss: 0.0806 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7085
False 1772
True percentage 0.799932256972
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.87      0.95      0.91      7318
      B-LOC       1.00      0.02      0.04       218
      I-LOC       0.69      0.08      0.14       141
      B-PER       0.36      0.10      0.16       438
      B-ORG       0.25      0.19      0.22       296
      I-ORG       0.50      0.01      0.03       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.02      0.01      0.01       154

avg / total       0.79      0.80      0.77      8857

F-1 Score (without O):
0.123406425293
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 100020 unique words.
Found 92 unique chars.
Found 9 unique labels.
16 unique words not found in embedding.
8 unique chars not found in embedding.
Number of OOV: 327
OOV word occurences: 638
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401344     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,778
Trainable params: 6,507,778
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

8/8 [==============================] - 2s 246ms/step - loss: 2.3516 - acc: 0.0057
Epoch 2/30

8/8 [==============================] - 0s 33ms/step - loss: 1.2277 - acc: 0.7841
Epoch 3/30

8/8 [==============================] - 0s 34ms/step - loss: 1.1187 - acc: 0.7841
Epoch 4/30

8/8 [==============================] - 0s 34ms/step - loss: 1.0320 - acc: 0.7841
Epoch 5/30

8/8 [==============================] - 0s 33ms/step - loss: 0.8552 - acc: 0.7841
Epoch 6/30

8/8 [==============================] - 0s 33ms/step - loss: 0.8122 - acc: 0.7841
Epoch 7/30

8/8 [==============================] - 0s 32ms/step - loss: 0.7600 - acc: 0.7841
Epoch 8/30

8/8 [==============================] - 0s 34ms/step - loss: 0.7107 - acc: 0.7841
Epoch 9/30

8/8 [==============================] - 0s 33ms/step - loss: 0.6738 - acc: 0.7841
Epoch 10/30

8/8 [==============================] - 0s 32ms/step - loss: 0.6314 - acc: 0.7898
Epoch 11/30

8/8 [==============================] - 0s 33ms/step - loss: 0.5958 - acc: 0.8068
Epoch 12/30

8/8 [==============================] - 0s 32ms/step - loss: 0.5374 - acc: 0.8182
Epoch 13/30

8/8 [==============================] - 0s 33ms/step - loss: 0.5145 - acc: 0.8182
Epoch 14/30

8/8 [==============================] - 0s 32ms/step - loss: 0.4801 - acc: 0.8523
Epoch 15/30

8/8 [==============================] - 0s 32ms/step - loss: 0.4479 - acc: 0.8409
Epoch 16/30

8/8 [==============================] - 0s 34ms/step - loss: 0.4146 - acc: 0.8750
Epoch 17/30

8/8 [==============================] - 0s 33ms/step - loss: 0.3746 - acc: 0.8807
Epoch 18/30

8/8 [==============================] - 0s 33ms/step - loss: 0.3612 - acc: 0.9091
Epoch 19/30

8/8 [==============================] - 0s 33ms/step - loss: 0.3470 - acc: 0.8864
Epoch 20/30

8/8 [==============================] - 0s 32ms/step - loss: 0.4287 - acc: 0.9545
Epoch 21/30

8/8 [==============================] - 0s 34ms/step - loss: 0.3173 - acc: 0.9091
Epoch 22/30

8/8 [==============================] - 0s 34ms/step - loss: 0.2775 - acc: 0.9432
Epoch 23/30

8/8 [==============================] - 0s 33ms/step - loss: 0.2475 - acc: 0.9432
Epoch 24/30

8/8 [==============================] - 0s 33ms/step - loss: 0.2435 - acc: 0.9432
Epoch 25/30

8/8 [==============================] - 0s 32ms/step - loss: 0.2276 - acc: 0.9545
Epoch 26/30

8/8 [==============================] - 0s 33ms/step - loss: 0.2053 - acc: 0.9716
Epoch 27/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1987 - acc: 0.9602
Epoch 28/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1806 - acc: 0.9886
Epoch 29/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1671 - acc: 0.9659
Epoch 30/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1655 - acc: 0.9830
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7122
False 1949
True percentage 0.785139455407
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.88      0.95      0.91      7318
      B-ORG       0.36      0.22      0.27       296
      I-ORG       0.32      0.17      0.22       151
      B-PER       0.75      0.13      0.23       438
      I-PER       0.18      0.01      0.02       214
     B-MISC       0.05      0.06      0.05       141
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.46      0.07      0.13       218
      I-LOC       0.43      0.02      0.04       141

avg / total       0.79      0.79      0.77      9071

F-1 Score (without O):
0.15404586759
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100012 unique words.
Found 91 unique chars.
Found 9 unique labels.
8 unique words not found in embedding.
7 unique chars not found in embedding.
Number of OOV: 326
OOV word occurences: 638
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5888        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6400832     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,202
Trainable params: 6,507,202
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

8/8 [==============================] - 2s 254ms/step - loss: 2.4752 - acc: 0.0178
Epoch 2/30

8/8 [==============================] - 0s 33ms/step - loss: 1.4511 - acc: 0.7751
Epoch 3/30

8/8 [==============================] - 0s 32ms/step - loss: 1.0096 - acc: 0.7870
Epoch 4/30

8/8 [==============================] - 0s 32ms/step - loss: 0.9152 - acc: 0.7870
Epoch 5/30

8/8 [==============================] - 0s 31ms/step - loss: 0.8472 - acc: 0.7870
Epoch 6/30

8/8 [==============================] - 0s 32ms/step - loss: 0.8250 - acc: 0.7870
Epoch 7/30

8/8 [==============================] - 0s 32ms/step - loss: 0.7508 - acc: 0.7870
Epoch 8/30

8/8 [==============================] - 0s 33ms/step - loss: 0.6836 - acc: 0.7870
Epoch 9/30

8/8 [==============================] - 0s 33ms/step - loss: 0.6209 - acc: 0.7870
Epoch 10/30

8/8 [==============================] - 0s 32ms/step - loss: 0.5753 - acc: 0.7929
Epoch 11/30

8/8 [==============================] - 0s 32ms/step - loss: 0.5411 - acc: 0.7929
Epoch 12/30

8/8 [==============================] - 0s 33ms/step - loss: 0.4974 - acc: 0.8107
Epoch 13/30

8/8 [==============================] - 0s 32ms/step - loss: 0.4633 - acc: 0.8166
Epoch 14/30

8/8 [==============================] - 0s 33ms/step - loss: 0.4428 - acc: 0.8994
Epoch 15/30

8/8 [==============================] - 0s 33ms/step - loss: 0.4005 - acc: 0.8284
Epoch 16/30

8/8 [==============================] - 0s 33ms/step - loss: 0.3727 - acc: 0.9290
Epoch 17/30

8/8 [==============================] - 0s 33ms/step - loss: 0.3323 - acc: 0.8935
Epoch 18/30

8/8 [==============================] - 0s 33ms/step - loss: 0.3086 - acc: 0.9290
Epoch 19/30

8/8 [==============================] - 0s 32ms/step - loss: 0.2673 - acc: 0.9231
Epoch 20/30

8/8 [==============================] - 0s 33ms/step - loss: 0.2384 - acc: 0.9527
Epoch 21/30

8/8 [==============================] - 0s 33ms/step - loss: 0.2313 - acc: 0.9467
Epoch 22/30

8/8 [==============================] - 0s 32ms/step - loss: 0.2189 - acc: 0.9763
Epoch 23/30

8/8 [==============================] - 0s 33ms/step - loss: 0.1960 - acc: 0.9586
Epoch 24/30

8/8 [==============================] - 0s 33ms/step - loss: 0.1893 - acc: 0.9527
Epoch 25/30

8/8 [==============================] - 0s 33ms/step - loss: 0.1777 - acc: 0.9822
Epoch 26/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1526 - acc: 0.9763
Epoch 27/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1407 - acc: 0.9822
Epoch 28/30

8/8 [==============================] - 0s 33ms/step - loss: 0.1341 - acc: 0.9704
Epoch 29/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1191 - acc: 0.9822
Epoch 30/30

8/8 [==============================] - 0s 34ms/step - loss: 0.1160 - acc: 0.9763
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7196
False 1875
True percentage 0.793297321133
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.89      0.95      0.92      7318
      B-PER       0.40      0.28      0.33       438
      B-LOC       0.67      0.27      0.38       218
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-ORG       0.38      0.21      0.27       296
      I-ORG       0.32      0.05      0.08       151
      I-LOC       0.80      0.03      0.05       141
      I-PER       1.00      0.04      0.08       214

avg / total       0.80      0.79      0.78      9071

F-1 Score (without O):
0.224957555178
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 100017 unique words.
Found 92 unique chars.
Found 9 unique labels.
13 unique words not found in embedding.
8 unique chars not found in embedding.
Number of OOV: 325
OOV word occurences: 630
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401152     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,586
Trainable params: 6,507,586
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

8/8 [==============================] - 2s 266ms/step - loss: 2.0963 - acc: 0.4641
Epoch 2/30

8/8 [==============================] - 0s 32ms/step - loss: 1.4001 - acc: 0.6464
Epoch 3/30

8/8 [==============================] - 0s 33ms/step - loss: 1.3313 - acc: 0.6464
Epoch 4/30

8/8 [==============================] - 0s 33ms/step - loss: 1.2581 - acc: 0.6851
Epoch 5/30

8/8 [==============================] - 0s 32ms/step - loss: 1.0487 - acc: 0.6464
Epoch 6/30

8/8 [==============================] - 0s 32ms/step - loss: 0.9751 - acc: 0.6464
Epoch 7/30

8/8 [==============================] - 0s 33ms/step - loss: 0.8965 - acc: 0.6796
Epoch 8/30

8/8 [==============================] - 0s 32ms/step - loss: 0.8206 - acc: 0.7072
Epoch 9/30

8/8 [==============================] - 0s 32ms/step - loss: 0.7657 - acc: 0.7680
Epoch 10/30

8/8 [==============================] - 0s 34ms/step - loss: 0.6867 - acc: 0.7845
Epoch 11/30

8/8 [==============================] - 0s 33ms/step - loss: 0.6483 - acc: 0.8232
Epoch 12/30

8/8 [==============================] - 0s 32ms/step - loss: 0.5500 - acc: 0.8564
Epoch 13/30

8/8 [==============================] - 0s 32ms/step - loss: 0.5008 - acc: 0.9116
Epoch 14/30

8/8 [==============================] - 0s 33ms/step - loss: 0.4675 - acc: 0.8950
Epoch 15/30

8/8 [==============================] - 0s 33ms/step - loss: 0.4019 - acc: 0.9337
Epoch 16/30

8/8 [==============================] - 0s 33ms/step - loss: 0.3844 - acc: 0.9282
Epoch 17/30

8/8 [==============================] - 0s 32ms/step - loss: 0.3677 - acc: 0.9558
Epoch 18/30

8/8 [==============================] - 0s 33ms/step - loss: 0.3448 - acc: 0.9171
Epoch 19/30

8/8 [==============================] - 0s 33ms/step - loss: 0.2853 - acc: 0.9613
Epoch 20/30

8/8 [==============================] - 0s 32ms/step - loss: 0.2400 - acc: 0.9613
Epoch 21/30

8/8 [==============================] - 0s 32ms/step - loss: 0.2160 - acc: 0.9613
Epoch 22/30

8/8 [==============================] - 0s 34ms/step - loss: 0.2028 - acc: 0.9613
Epoch 23/30

8/8 [==============================] - 0s 34ms/step - loss: 0.1753 - acc: 0.9669
Epoch 24/30

8/8 [==============================] - 0s 34ms/step - loss: 0.1795 - acc: 0.9558
Epoch 25/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1631 - acc: 0.9724
Epoch 26/30

8/8 [==============================] - 0s 33ms/step - loss: 0.1356 - acc: 0.9669
Epoch 27/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1323 - acc: 0.9669
Epoch 28/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1554 - acc: 0.9613
Epoch 29/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1209 - acc: 0.9613
Epoch 30/30

8/8 [==============================] - 0s 33ms/step - loss: 0.1065 - acc: 0.9834
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7203
False 1868
True percentage 0.794069011134
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.90      0.94      0.92      7318
      B-ORG       0.41      0.30      0.35       296
      I-ORG       0.19      0.17      0.18       151
      B-PER       0.54      0.28      0.36       438
      I-PER       0.45      0.40      0.42       214
      B-LOC       0.50      0.00      0.01       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.17      0.04      0.06       154

avg / total       0.79      0.79      0.78      9071

F-1 Score (without O):
0.255768478686
