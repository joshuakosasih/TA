Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

1674/1674 [==============================] - 46s 27ms/step - loss: 0.4186 - acc: 0.8725
Epoch 2/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.2499 - acc: 0.9232
Epoch 3/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.2002 - acc: 0.9392
Epoch 4/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.1727 - acc: 0.9476
Epoch 5/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.1486 - acc: 0.9557
Epoch 6/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.1310 - acc: 0.9616
Epoch 7/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.1180 - acc: 0.9652
Epoch 8/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.1057 - acc: 0.9706
Epoch 9/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0982 - acc: 0.9709
Epoch 10/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0870 - acc: 0.9748
Epoch 11/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0787 - acc: 0.9775
Epoch 12/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0740 - acc: 0.9795
Epoch 13/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0683 - acc: 0.9806
Epoch 14/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0622 - acc: 0.9824
Epoch 15/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0578 - acc: 0.9838
Epoch 16/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0556 - acc: 0.9842
Epoch 17/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0510 - acc: 0.9854
Epoch 18/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0489 - acc: 0.9863
Epoch 19/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0460 - acc: 0.9871
Epoch 20/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0432 - acc: 0.9881
Epoch 21/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0405 - acc: 0.9885
Epoch 22/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0392 - acc: 0.9890
Epoch 23/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0378 - acc: 0.9891
Epoch 24/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0345 - acc: 0.9905
Epoch 25/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0340 - acc: 0.9905
Epoch 26/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0327 - acc: 0.9909
Epoch 27/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0308 - acc: 0.9909
Epoch 28/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0306 - acc: 0.9919
Epoch 29/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0290 - acc: 0.9919
Epoch 30/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0274 - acc: 0.9922
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8234
False 837
True percentage 0.907727924154
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-LOC       0.75      0.74      0.74       218
      I-LOC       0.71      0.81      0.75       141
      B-PER       0.88      0.84      0.86       438
      B-ORG       0.75      0.72      0.74       296
      I-ORG       0.66      0.58      0.62       151
     B-MISC       0.44      0.31      0.37       141
     I-MISC       0.49      0.43      0.46       154
      I-PER       0.91      0.64      0.75       214

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.712581991652
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

1674/1674 [==============================] - 46s 28ms/step - loss: 0.4164 - acc: 0.8724
Epoch 2/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.2423 - acc: 0.9277
Epoch 3/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1928 - acc: 0.9419
Epoch 4/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1587 - acc: 0.9530
Epoch 5/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1363 - acc: 0.9604
Epoch 6/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1201 - acc: 0.9649
Epoch 7/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1060 - acc: 0.9694
Epoch 8/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0956 - acc: 0.9728
Epoch 9/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0861 - acc: 0.9751
Epoch 10/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0794 - acc: 0.9775
Epoch 11/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0733 - acc: 0.9799
Epoch 12/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0686 - acc: 0.9808
Epoch 13/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0630 - acc: 0.9824
Epoch 14/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0582 - acc: 0.9839
Epoch 15/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0546 - acc: 0.9848
Epoch 16/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0535 - acc: 0.9854
Epoch 17/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0484 - acc: 0.9863
Epoch 18/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0469 - acc: 0.9869
Epoch 19/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0417 - acc: 0.9890
Epoch 20/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0410 - acc: 0.9889
Epoch 21/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0415 - acc: 0.9876
Epoch 22/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0371 - acc: 0.9897
Epoch 23/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0361 - acc: 0.9898
Epoch 24/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0352 - acc: 0.9902
Epoch 25/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0337 - acc: 0.9910
Epoch 26/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0319 - acc: 0.9907
Epoch 27/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0308 - acc: 0.9912
Epoch 28/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0305 - acc: 0.9914
Epoch 29/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0288 - acc: 0.9918
Epoch 30/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0286 - acc: 0.9916
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8242
False 829
True percentage 0.908609855584
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.72      0.75      0.74       296
      I-ORG       0.57      0.64      0.60       151
      B-PER       0.89      0.84      0.86       438
      I-PER       0.93      0.64      0.76       214
     B-MISC       0.45      0.29      0.35       141
     I-MISC       0.55      0.42      0.48       154
      B-LOC       0.77      0.75      0.76       218
      I-LOC       0.77      0.76      0.76       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.716159809183
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104754 unique words.
4750 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 246
OOV word occurences: in test 365
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6704320     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,816,450
Trainable params: 6,816,450
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

837/837 [==============================] - 24s 29ms/step - loss: 0.5127 - acc: 0.8415
Epoch 2/30

837/837 [==============================] - 22s 26ms/step - loss: 0.3090 - acc: 0.9069
Epoch 3/30

837/837 [==============================] - 22s 27ms/step - loss: 0.2452 - acc: 0.9276
Epoch 4/30

837/837 [==============================] - 22s 26ms/step - loss: 0.2128 - acc: 0.9369
Epoch 5/30

837/837 [==============================] - 22s 27ms/step - loss: 0.1841 - acc: 0.9469
Epoch 6/30

837/837 [==============================] - 22s 26ms/step - loss: 0.1610 - acc: 0.9543
Epoch 7/30

837/837 [==============================] - 22s 27ms/step - loss: 0.1411 - acc: 0.9603
Epoch 8/30

837/837 [==============================] - 22s 26ms/step - loss: 0.1303 - acc: 0.9634
Epoch 9/30

837/837 [==============================] - 22s 27ms/step - loss: 0.1160 - acc: 0.9670
Epoch 10/30

837/837 [==============================] - 22s 27ms/step - loss: 0.1033 - acc: 0.9715
Epoch 11/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0931 - acc: 0.9753
Epoch 12/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0855 - acc: 0.9768
Epoch 13/30

837/837 [==============================] - 22s 26ms/step - loss: 0.0812 - acc: 0.9787
Epoch 14/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0741 - acc: 0.9809
Epoch 15/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0690 - acc: 0.9818
Epoch 16/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0645 - acc: 0.9831
Epoch 17/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0597 - acc: 0.9849
Epoch 18/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0556 - acc: 0.9853
Epoch 19/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0503 - acc: 0.9868
Epoch 20/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0462 - acc: 0.9885
Epoch 21/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0451 - acc: 0.9884
Epoch 22/30

837/837 [==============================] - 22s 26ms/step - loss: 0.0436 - acc: 0.9889
Epoch 23/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0405 - acc: 0.9892
Epoch 24/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0384 - acc: 0.9899
Epoch 25/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0362 - acc: 0.9911
Epoch 26/30

837/837 [==============================] - 22s 26ms/step - loss: 0.0320 - acc: 0.9923
Epoch 27/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0326 - acc: 0.9919
Epoch 28/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0325 - acc: 0.9924
Epoch 29/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0307 - acc: 0.9919
Epoch 30/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0300 - acc: 0.9926
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8153
False 918
True percentage 0.898798368427
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-LOC       0.72      0.71      0.71       218
      I-LOC       0.74      0.77      0.76       141
      B-PER       0.87      0.79      0.83       438
      B-ORG       0.71      0.72      0.72       296
      I-ORG       0.63      0.51      0.56       151
     B-MISC       0.45      0.25      0.32       141
     I-MISC       0.46      0.38      0.41       154
      I-PER       0.88      0.62      0.73       214

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.682911970758
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104718 unique words.
4714 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 245
OOV word occurences: in test 376
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6702016     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,814,146
Trainable params: 6,814,146
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

837/837 [==============================] - 24s 29ms/step - loss: 0.4772 - acc: 0.8528
Epoch 2/30

837/837 [==============================] - 23s 27ms/step - loss: 0.2864 - acc: 0.9130
Epoch 3/30

837/837 [==============================] - 23s 27ms/step - loss: 0.2300 - acc: 0.9325
Epoch 4/30

837/837 [==============================] - 23s 27ms/step - loss: 0.1929 - acc: 0.9456
Epoch 5/30

837/837 [==============================] - 23s 27ms/step - loss: 0.1630 - acc: 0.9530
Epoch 6/30

837/837 [==============================] - 23s 27ms/step - loss: 0.1418 - acc: 0.9605
Epoch 7/30

837/837 [==============================] - 23s 27ms/step - loss: 0.1281 - acc: 0.9644
Epoch 8/30

837/837 [==============================] - 23s 27ms/step - loss: 0.1146 - acc: 0.9699
Epoch 9/30

837/837 [==============================] - 22s 27ms/step - loss: 0.1022 - acc: 0.9708
Epoch 10/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0914 - acc: 0.9749
Epoch 11/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0834 - acc: 0.9781
Epoch 12/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0767 - acc: 0.9800
Epoch 13/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0729 - acc: 0.9803
Epoch 14/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0653 - acc: 0.9826
Epoch 15/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0602 - acc: 0.9838
Epoch 16/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0562 - acc: 0.9850
Epoch 17/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0540 - acc: 0.9860
Epoch 18/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0508 - acc: 0.9866
Epoch 19/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0443 - acc: 0.9892
Epoch 20/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0417 - acc: 0.9891
Epoch 21/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0407 - acc: 0.9894
Epoch 22/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0383 - acc: 0.9896
Epoch 23/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0370 - acc: 0.9903
Epoch 24/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0338 - acc: 0.9912
Epoch 25/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0338 - acc: 0.9904
Epoch 26/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0312 - acc: 0.9916
Epoch 27/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0293 - acc: 0.9922
Epoch 28/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0288 - acc: 0.9928
Epoch 29/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0284 - acc: 0.9918
Epoch 30/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0250 - acc: 0.9935
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8148
False 923
True percentage 0.898247161283
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.74      0.72      0.73       296
      I-ORG       0.62      0.53      0.57       151
      B-PER       0.87      0.76      0.81       438
      I-PER       0.94      0.63      0.76       214
     B-MISC       0.47      0.26      0.34       141
     I-MISC       0.50      0.36      0.42       154
      B-LOC       0.68      0.70      0.69       218
      I-LOC       0.72      0.74      0.73       141

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.683287165282
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104723 unique words.
4719 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 247
OOV word occurences: in test 373
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6702336     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,814,466
Trainable params: 6,814,466
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

837/837 [==============================] - 25s 30ms/step - loss: 0.4886 - acc: 0.8478
Epoch 2/30

837/837 [==============================] - 23s 28ms/step - loss: 0.2919 - acc: 0.9143
Epoch 3/30

837/837 [==============================] - 23s 28ms/step - loss: 0.2320 - acc: 0.9307
Epoch 4/30

837/837 [==============================] - 23s 28ms/step - loss: 0.1941 - acc: 0.9434
Epoch 5/30

837/837 [==============================] - 23s 28ms/step - loss: 0.1679 - acc: 0.9504
Epoch 6/30

837/837 [==============================] - 23s 28ms/step - loss: 0.1465 - acc: 0.9583
Epoch 7/30

837/837 [==============================] - 23s 28ms/step - loss: 0.1301 - acc: 0.9619
Epoch 8/30

837/837 [==============================] - 23s 28ms/step - loss: 0.1169 - acc: 0.9665
Epoch 9/30

837/837 [==============================] - 23s 28ms/step - loss: 0.1034 - acc: 0.9707
Epoch 10/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0910 - acc: 0.9743
Epoch 11/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0849 - acc: 0.9761
Epoch 12/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0782 - acc: 0.9774
Epoch 13/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0707 - acc: 0.9801
Epoch 14/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0644 - acc: 0.9823
Epoch 15/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0628 - acc: 0.9829
Epoch 16/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0574 - acc: 0.9844
Epoch 17/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0535 - acc: 0.9859
Epoch 18/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0490 - acc: 0.9872
Epoch 19/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0461 - acc: 0.9876
Epoch 20/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0429 - acc: 0.9888
Epoch 21/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0407 - acc: 0.9893
Epoch 22/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0383 - acc: 0.9897
Epoch 23/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0365 - acc: 0.9906
Epoch 24/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0353 - acc: 0.9908
Epoch 25/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0321 - acc: 0.9918
Epoch 26/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0308 - acc: 0.9924
Epoch 27/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0293 - acc: 0.9931
Epoch 28/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0289 - acc: 0.9923
Epoch 29/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0259 - acc: 0.9939
Epoch 30/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0258 - acc: 0.9935
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8124
False 947
True percentage 0.895601366994
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.88      0.75      0.81       438
      B-LOC       0.72      0.71      0.72       218
     B-MISC       0.42      0.30      0.35       141
     I-MISC       0.49      0.38      0.42       154
      B-ORG       0.69      0.73      0.71       296
      I-ORG       0.54      0.60      0.57       151
      I-LOC       0.73      0.74      0.73       141
      I-PER       0.89      0.62      0.73       214

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.676655678753
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104344 unique words.
4340 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 264
OOV word occurences: in test 412
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678080     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,210
Trainable params: 6,790,210
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

334/334 [==============================] - 11s 32ms/step - loss: 0.6511 - acc: 0.7979
Epoch 2/30

334/334 [==============================] - 9s 27ms/step - loss: 0.3819 - acc: 0.8825
Epoch 3/30

334/334 [==============================] - 9s 27ms/step - loss: 0.3225 - acc: 0.9024
Epoch 4/30

334/334 [==============================] - 9s 27ms/step - loss: 0.2802 - acc: 0.9161
Epoch 5/30

334/334 [==============================] - 9s 26ms/step - loss: 0.2401 - acc: 0.9304
Epoch 6/30

334/334 [==============================] - 9s 26ms/step - loss: 0.2129 - acc: 0.9390
Epoch 7/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1888 - acc: 0.9459
Epoch 8/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1705 - acc: 0.9520
Epoch 9/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1530 - acc: 0.9583
Epoch 10/30

334/334 [==============================] - 9s 26ms/step - loss: 0.1401 - acc: 0.9627
Epoch 11/30

334/334 [==============================] - 9s 26ms/step - loss: 0.1243 - acc: 0.9670
Epoch 12/30

334/334 [==============================] - 9s 26ms/step - loss: 0.1170 - acc: 0.9688
Epoch 13/30

334/334 [==============================] - 9s 26ms/step - loss: 0.1036 - acc: 0.9750
Epoch 14/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0977 - acc: 0.9758
Epoch 15/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0890 - acc: 0.9802
Epoch 16/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0810 - acc: 0.9801
Epoch 17/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0749 - acc: 0.9833
Epoch 18/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0722 - acc: 0.9836
Epoch 19/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0649 - acc: 0.9858
Epoch 20/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0613 - acc: 0.9864
Epoch 21/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0573 - acc: 0.9869
Epoch 22/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0538 - acc: 0.9881
Epoch 23/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0501 - acc: 0.9888
Epoch 24/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0455 - acc: 0.9910
Epoch 25/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0432 - acc: 0.9912
Epoch 26/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0429 - acc: 0.9915
Epoch 27/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0408 - acc: 0.9904
Epoch 28/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0387 - acc: 0.9926
Epoch 29/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0373 - acc: 0.9928
Epoch 30/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0330 - acc: 0.9934
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8026
False 1045
True percentage 0.884797706978
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.97      7318
      B-LOC       0.68      0.72      0.70       218
      I-LOC       0.74      0.72      0.73       141
      B-PER       0.89      0.71      0.79       438
      B-ORG       0.65      0.69      0.67       296
      I-ORG       0.44      0.50      0.47       151
     B-MISC       0.49      0.24      0.32       141
     I-MISC       0.43      0.38      0.40       154
      I-PER       0.80      0.54      0.65       214

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.640870616687
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104355 unique words.
4351 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 261
OOV word occurences: in test 401
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678784     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,914
Trainable params: 6,790,914
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

334/334 [==============================] - 11s 32ms/step - loss: 0.5896 - acc: 0.8200
Epoch 2/30

334/334 [==============================] - 9s 27ms/step - loss: 0.3568 - acc: 0.8923
Epoch 3/30

334/334 [==============================] - 9s 27ms/step - loss: 0.2961 - acc: 0.9094
Epoch 4/30

334/334 [==============================] - 9s 27ms/step - loss: 0.2543 - acc: 0.9242
Epoch 5/30

334/334 [==============================] - 9s 27ms/step - loss: 0.2262 - acc: 0.9322
Epoch 6/30

334/334 [==============================] - 9s 27ms/step - loss: 0.2024 - acc: 0.9405
Epoch 7/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1769 - acc: 0.9499
Epoch 8/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1603 - acc: 0.9519
Epoch 9/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1517 - acc: 0.9584
Epoch 10/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1295 - acc: 0.9681
Epoch 11/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1257 - acc: 0.9673
Epoch 12/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1109 - acc: 0.9725
Epoch 13/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1023 - acc: 0.9755
Epoch 14/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0898 - acc: 0.9791
Epoch 15/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0870 - acc: 0.9784
Epoch 16/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0799 - acc: 0.9803
Epoch 17/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0765 - acc: 0.9808
Epoch 18/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0687 - acc: 0.9846
Epoch 19/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0640 - acc: 0.9852
Epoch 20/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0639 - acc: 0.9844
Epoch 21/30

334/334 [==============================] - 9s 28ms/step - loss: 0.0544 - acc: 0.9884
Epoch 22/30

334/334 [==============================] - 9s 28ms/step - loss: 0.0550 - acc: 0.9867
Epoch 23/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0497 - acc: 0.9879
Epoch 24/30

334/334 [==============================] - 9s 28ms/step - loss: 0.0472 - acc: 0.9889
Epoch 25/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0432 - acc: 0.9907
Epoch 26/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0424 - acc: 0.9895
Epoch 27/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0393 - acc: 0.9919
Epoch 28/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0376 - acc: 0.9917
Epoch 29/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0349 - acc: 0.9929
Epoch 30/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0331 - acc: 0.9926
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8003
False 1068
True percentage 0.882262154118
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.96      0.97      7318
      B-ORG       0.68      0.70      0.69       296
      I-ORG       0.41      0.41      0.41       151
      B-PER       0.86      0.68      0.76       438
      I-PER       0.88      0.47      0.61       214
     B-MISC       0.38      0.21      0.27       141
     I-MISC       0.45      0.35      0.40       154
      B-LOC       0.66      0.67      0.67       218
      I-LOC       0.74      0.65      0.69       141

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.616246498599
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104341 unique words.
4337 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 260
OOV word occurences: in test 400
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6677888     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,018
Trainable params: 6,790,018
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

334/334 [==============================] - 10s 31ms/step - loss: 0.5802 - acc: 0.8170
Epoch 2/30

334/334 [==============================] - 9s 26ms/step - loss: 0.3475 - acc: 0.8912
Epoch 3/30

334/334 [==============================] - 9s 26ms/step - loss: 0.2843 - acc: 0.9180
Epoch 4/30

334/334 [==============================] - 9s 27ms/step - loss: 0.2500 - acc: 0.9244
Epoch 5/30

334/334 [==============================] - 9s 27ms/step - loss: 0.2124 - acc: 0.9394
Epoch 6/30

334/334 [==============================] - 9s 26ms/step - loss: 0.1922 - acc: 0.9418
Epoch 7/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1715 - acc: 0.9492
Epoch 8/30

334/334 [==============================] - 9s 26ms/step - loss: 0.1550 - acc: 0.9550
Epoch 9/30

334/334 [==============================] - 9s 26ms/step - loss: 0.1401 - acc: 0.9607
Epoch 10/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1280 - acc: 0.9639
Epoch 11/30

334/334 [==============================] - 9s 26ms/step - loss: 0.1206 - acc: 0.9677
Epoch 12/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1035 - acc: 0.9739
Epoch 13/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0950 - acc: 0.9760
Epoch 14/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0901 - acc: 0.9783
Epoch 15/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0837 - acc: 0.9791
Epoch 16/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0761 - acc: 0.9816
Epoch 17/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0708 - acc: 0.9838
Epoch 18/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0658 - acc: 0.9850
Epoch 19/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0603 - acc: 0.9874
Epoch 20/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0564 - acc: 0.9885
Epoch 21/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0506 - acc: 0.9895
Epoch 22/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0487 - acc: 0.9897
Epoch 23/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0440 - acc: 0.9901
Epoch 24/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0416 - acc: 0.9919
Epoch 25/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0403 - acc: 0.9916
Epoch 26/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0393 - acc: 0.9910
Epoch 27/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0384 - acc: 0.9914
Epoch 28/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0341 - acc: 0.9931
Epoch 29/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0315 - acc: 0.9931
Epoch 30/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0314 - acc: 0.9930
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8037
False 1034
True percentage 0.886010362694
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.97      7318
      B-PER       0.83      0.73      0.78       438
      B-LOC       0.70      0.66      0.68       218
     B-MISC       0.42      0.36      0.39       141
     I-MISC       0.41      0.52      0.46       154
      B-ORG       0.67      0.68      0.67       296
      I-ORG       0.52      0.40      0.46       151
      I-LOC       0.75      0.65      0.70       141
      I-PER       0.90      0.61      0.73       214

avg / total       0.93      0.89      0.90      9071

F-1 Score (without O):
0.645895745956
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104210 unique words.
4206 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 272
OOV word occurences: in test 488
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6669504     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,781,634
Trainable params: 6,781,634
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

167/167 [==============================] - 6s 36ms/step - loss: 0.9419 - acc: 0.7302
Epoch 2/30

167/167 [==============================] - 4s 27ms/step - loss: 0.4553 - acc: 0.8533
Epoch 3/30

167/167 [==============================] - 5s 27ms/step - loss: 0.3965 - acc: 0.8712
Epoch 4/30

167/167 [==============================] - 5s 27ms/step - loss: 0.3439 - acc: 0.8957
Epoch 5/30

167/167 [==============================] - 5s 27ms/step - loss: 0.3043 - acc: 0.9080
Epoch 6/30

167/167 [==============================] - 5s 27ms/step - loss: 0.2741 - acc: 0.9225
Epoch 7/30

167/167 [==============================] - 4s 27ms/step - loss: 0.2512 - acc: 0.9293
Epoch 8/30

167/167 [==============================] - 4s 27ms/step - loss: 0.2354 - acc: 0.9345
Epoch 9/30

167/167 [==============================] - 4s 27ms/step - loss: 0.2186 - acc: 0.9408
Epoch 10/30

167/167 [==============================] - 4s 27ms/step - loss: 0.1929 - acc: 0.9512
Epoch 11/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1772 - acc: 0.9531
Epoch 12/30

167/167 [==============================] - 4s 27ms/step - loss: 0.1573 - acc: 0.9619
Epoch 13/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1440 - acc: 0.9683
Epoch 14/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1326 - acc: 0.9663
Epoch 15/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1269 - acc: 0.9719
Epoch 16/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1160 - acc: 0.9759
Epoch 17/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1098 - acc: 0.9728
Epoch 18/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1009 - acc: 0.9794
Epoch 19/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0917 - acc: 0.9821
Epoch 20/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0912 - acc: 0.9828
Epoch 21/30

167/167 [==============================] - 4s 27ms/step - loss: 0.0792 - acc: 0.9857
Epoch 22/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0790 - acc: 0.9847
Epoch 23/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0751 - acc: 0.9854
Epoch 24/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0683 - acc: 0.9890
Epoch 25/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0615 - acc: 0.9904
Epoch 26/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0599 - acc: 0.9904
Epoch 27/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0514 - acc: 0.9919
Epoch 28/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0491 - acc: 0.9927
Epoch 29/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0514 - acc: 0.9924
Epoch 30/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0477 - acc: 0.9941
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7758
False 1313
True percentage 0.855253004079
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.94      0.96      7318
      B-LOC       0.62      0.56      0.59       218
      I-LOC       0.67      0.54      0.60       141
      B-PER       0.85      0.56      0.67       438
      B-ORG       0.59      0.66      0.62       296
      I-ORG       0.42      0.30      0.35       151
     B-MISC       0.24      0.20      0.22       141
     I-MISC       0.30      0.38      0.33       154
      I-PER       0.75      0.43      0.55       214

avg / total       0.90      0.86      0.88      9071

F-1 Score (without O):
0.534242330338
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104225 unique words.
4221 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 272
OOV word occurences: in test 466
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6670464     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,782,594
Trainable params: 6,782,594
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

167/167 [==============================] - 6s 37ms/step - loss: 0.8796 - acc: 0.7467
Epoch 2/30

167/167 [==============================] - 5s 28ms/step - loss: 0.4191 - acc: 0.8652
Epoch 3/30

167/167 [==============================] - 5s 27ms/step - loss: 0.3563 - acc: 0.8878
Epoch 4/30

167/167 [==============================] - 4s 27ms/step - loss: 0.2987 - acc: 0.9075
Epoch 5/30

167/167 [==============================] - 5s 27ms/step - loss: 0.2716 - acc: 0.9254
Epoch 6/30

167/167 [==============================] - 5s 27ms/step - loss: 0.2461 - acc: 0.9309
Epoch 7/30

167/167 [==============================] - 5s 28ms/step - loss: 0.2191 - acc: 0.9427
Epoch 8/30

167/167 [==============================] - 4s 27ms/step - loss: 0.1952 - acc: 0.9492
Epoch 9/30

167/167 [==============================] - 4s 27ms/step - loss: 0.1859 - acc: 0.9507
Epoch 10/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1624 - acc: 0.9631
Epoch 11/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1503 - acc: 0.9645
Epoch 12/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1478 - acc: 0.9649
Epoch 13/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1300 - acc: 0.9708
Epoch 14/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1224 - acc: 0.9722
Epoch 15/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1111 - acc: 0.9774
Epoch 16/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1068 - acc: 0.9772
Epoch 17/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0965 - acc: 0.9810
Epoch 18/30

167/167 [==============================] - 4s 27ms/step - loss: 0.0865 - acc: 0.9839
Epoch 19/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0807 - acc: 0.9832
Epoch 20/30

167/167 [==============================] - 4s 27ms/step - loss: 0.0788 - acc: 0.9842
Epoch 21/30

167/167 [==============================] - 4s 27ms/step - loss: 0.0699 - acc: 0.9860
Epoch 22/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0698 - acc: 0.9871
Epoch 23/30

167/167 [==============================] - 4s 27ms/step - loss: 0.0639 - acc: 0.9869
Epoch 24/30

167/167 [==============================] - 4s 27ms/step - loss: 0.0629 - acc: 0.9875
Epoch 25/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0541 - acc: 0.9924
Epoch 26/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0524 - acc: 0.9917
Epoch 27/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0476 - acc: 0.9925
Epoch 28/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0478 - acc: 0.9907
Epoch 29/30

167/167 [==============================] - 4s 27ms/step - loss: 0.0462 - acc: 0.9920
Epoch 30/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0394 - acc: 0.9931
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7814
False 1257
True percentage 0.861426524088
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-ORG       0.46      0.43      0.45       296
      I-ORG       0.36      0.39      0.37       151
      B-PER       0.77      0.63      0.69       438
      I-PER       0.89      0.43      0.58       214
     B-MISC       0.27      0.18      0.22       141
     I-MISC       0.33      0.31      0.32       154
      B-LOC       0.69      0.63      0.66       218
      I-LOC       0.77      0.49      0.60       141

avg / total       0.90      0.86      0.88      9071

F-1 Score (without O):
0.523076923077
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104194 unique words.
4190 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 269
OOV word occurences: in test 437
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6668480     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,780,610
Trainable params: 6,780,610
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

167/167 [==============================] - 6s 36ms/step - loss: 0.8102 - acc: 0.7622
Epoch 2/30

167/167 [==============================] - 4s 27ms/step - loss: 0.4255 - acc: 0.8662
Epoch 3/30

167/167 [==============================] - 4s 26ms/step - loss: 0.3739 - acc: 0.8824
Epoch 4/30

167/167 [==============================] - 4s 26ms/step - loss: 0.3175 - acc: 0.9065
Epoch 5/30

167/167 [==============================] - 4s 27ms/step - loss: 0.2838 - acc: 0.9171
Epoch 6/30

167/167 [==============================] - 5s 27ms/step - loss: 0.2544 - acc: 0.9280
Epoch 7/30

167/167 [==============================] - 4s 27ms/step - loss: 0.2315 - acc: 0.9358
Epoch 8/30

167/167 [==============================] - 4s 27ms/step - loss: 0.2149 - acc: 0.9366
Epoch 9/30

167/167 [==============================] - 4s 27ms/step - loss: 0.1943 - acc: 0.9499
Epoch 10/30

167/167 [==============================] - 4s 26ms/step - loss: 0.1764 - acc: 0.9538
Epoch 11/30

167/167 [==============================] - 4s 27ms/step - loss: 0.1664 - acc: 0.9510
Epoch 12/30

167/167 [==============================] - 4s 26ms/step - loss: 0.1492 - acc: 0.9641
Epoch 13/30

167/167 [==============================] - 4s 27ms/step - loss: 0.1389 - acc: 0.9614
Epoch 14/30

167/167 [==============================] - 4s 27ms/step - loss: 0.1285 - acc: 0.9641
Epoch 15/30

167/167 [==============================] - 4s 26ms/step - loss: 0.1199 - acc: 0.9681
Epoch 16/30

167/167 [==============================] - 4s 27ms/step - loss: 0.1096 - acc: 0.9738
Epoch 17/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1068 - acc: 0.9730
Epoch 18/30

167/167 [==============================] - 4s 27ms/step - loss: 0.1001 - acc: 0.9771
Epoch 19/30

167/167 [==============================] - 4s 27ms/step - loss: 0.0867 - acc: 0.9809
Epoch 20/30

167/167 [==============================] - 4s 27ms/step - loss: 0.0854 - acc: 0.9811
Epoch 21/30

167/167 [==============================] - 4s 26ms/step - loss: 0.0809 - acc: 0.9813
Epoch 22/30

167/167 [==============================] - 4s 26ms/step - loss: 0.0760 - acc: 0.9842
Epoch 23/30

167/167 [==============================] - 4s 27ms/step - loss: 0.0736 - acc: 0.9831
Epoch 24/30

167/167 [==============================] - 4s 27ms/step - loss: 0.0643 - acc: 0.9865
Epoch 25/30

167/167 [==============================] - 4s 27ms/step - loss: 0.0613 - acc: 0.9881
Epoch 26/30

167/167 [==============================] - 4s 26ms/step - loss: 0.0604 - acc: 0.9864
Epoch 27/30

167/167 [==============================] - 4s 27ms/step - loss: 0.0561 - acc: 0.9890
Epoch 28/30

167/167 [==============================] - 4s 26ms/step - loss: 0.0517 - acc: 0.9913
Epoch 29/30

167/167 [==============================] - 4s 27ms/step - loss: 0.0527 - acc: 0.9887
Epoch 30/30

167/167 [==============================] - 4s 26ms/step - loss: 0.0501 - acc: 0.9909
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7764
False 1307
True percentage 0.855914452651
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.94      0.96      7318
      B-PER       0.82      0.63      0.71       438
      B-LOC       0.64      0.59      0.62       218
     B-MISC       0.18      0.19      0.19       141
     I-MISC       0.28      0.36      0.32       154
      B-ORG       0.62      0.64      0.63       296
      I-ORG       0.29      0.41      0.34       151
      I-LOC       0.60      0.38      0.46       141
      I-PER       0.81      0.46      0.59       214

avg / total       0.91      0.86      0.88      9071

F-1 Score (without O):
0.529254529255
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104116 unique words.
4112 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 278
OOV word occurences: in test 539
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663488     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,618
Trainable params: 6,775,618
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

83/83 [==============================] - 4s 46ms/step - loss: 1.2209 - acc: 0.6504
Epoch 2/30

83/83 [==============================] - 2s 27ms/step - loss: 0.5155 - acc: 0.8386
Epoch 3/30

83/83 [==============================] - 2s 27ms/step - loss: 0.4239 - acc: 0.8712
Epoch 4/30

83/83 [==============================] - 2s 27ms/step - loss: 0.3732 - acc: 0.8848
Epoch 5/30

83/83 [==============================] - 2s 28ms/step - loss: 0.3455 - acc: 0.8895
Epoch 6/30

83/83 [==============================] - 2s 27ms/step - loss: 0.3130 - acc: 0.9055
Epoch 7/30

83/83 [==============================] - 2s 27ms/step - loss: 0.2842 - acc: 0.9258
Epoch 8/30

83/83 [==============================] - 2s 27ms/step - loss: 0.2723 - acc: 0.9282
Epoch 9/30

83/83 [==============================] - 2s 27ms/step - loss: 0.2443 - acc: 0.9360
Epoch 10/30

83/83 [==============================] - 2s 27ms/step - loss: 0.2248 - acc: 0.9430
Epoch 11/30

83/83 [==============================] - 2s 27ms/step - loss: 0.2061 - acc: 0.9491
Epoch 12/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1822 - acc: 0.9568
Epoch 13/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1670 - acc: 0.9634
Epoch 14/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1628 - acc: 0.9609
Epoch 15/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1459 - acc: 0.9722
Epoch 16/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1325 - acc: 0.9729
Epoch 17/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1284 - acc: 0.9738
Epoch 18/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1221 - acc: 0.9788
Epoch 19/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1064 - acc: 0.9799
Epoch 20/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0989 - acc: 0.9830
Epoch 21/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0920 - acc: 0.9897
Epoch 22/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0879 - acc: 0.9849
Epoch 23/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0768 - acc: 0.9901
Epoch 24/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0773 - acc: 0.9909
Epoch 25/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0762 - acc: 0.9930
Epoch 26/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0643 - acc: 0.9966
Epoch 27/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0615 - acc: 0.9965
Epoch 28/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0642 - acc: 0.9914
Epoch 29/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0597 - acc: 0.9913
Epoch 30/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0558 - acc: 0.9947
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7645
False 1426
True percentage 0.842795722633
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.94      0.95      7318
      B-LOC       0.57      0.60      0.58       218
      I-LOC       0.66      0.48      0.55       141
      B-PER       0.75      0.43      0.55       438
      B-ORG       0.50      0.60      0.55       296
      I-ORG       0.28      0.37      0.32       151
     B-MISC       0.32      0.13      0.18       141
     I-MISC       0.38      0.25      0.30       154
      I-PER       0.73      0.38      0.50       214

avg / total       0.89      0.84      0.86      9071

F-1 Score (without O):
0.479595064853
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104129 unique words.
4125 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 276
OOV word occurences: in test 491
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6664320     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,776,450
Trainable params: 6,776,450
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

83/83 [==============================] - 4s 48ms/step - loss: 1.1443 - acc: 0.6758
Epoch 2/30

83/83 [==============================] - 2s 28ms/step - loss: 0.5141 - acc: 0.8459
Epoch 3/30

83/83 [==============================] - 2s 28ms/step - loss: 0.4199 - acc: 0.8705
Epoch 4/30

83/83 [==============================] - 2s 28ms/step - loss: 0.3577 - acc: 0.8938
Epoch 5/30

83/83 [==============================] - 2s 28ms/step - loss: 0.3261 - acc: 0.9015
Epoch 6/30

83/83 [==============================] - 2s 28ms/step - loss: 0.2965 - acc: 0.9177
Epoch 7/30

83/83 [==============================] - 2s 28ms/step - loss: 0.2872 - acc: 0.9126
Epoch 8/30

83/83 [==============================] - 2s 28ms/step - loss: 0.2597 - acc: 0.9267
Epoch 9/30

83/83 [==============================] - 2s 28ms/step - loss: 0.2374 - acc: 0.9342
Epoch 10/30

83/83 [==============================] - 2s 28ms/step - loss: 0.2132 - acc: 0.9484
Epoch 11/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1932 - acc: 0.9591
Epoch 12/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1757 - acc: 0.9589
Epoch 13/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1786 - acc: 0.9582
Epoch 14/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1581 - acc: 0.9611
Epoch 15/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1473 - acc: 0.9670
Epoch 16/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1393 - acc: 0.9692
Epoch 17/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1332 - acc: 0.9745
Epoch 18/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1163 - acc: 0.9754
Epoch 19/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1189 - acc: 0.9770
Epoch 20/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1131 - acc: 0.9780
Epoch 21/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1000 - acc: 0.9835
Epoch 22/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0964 - acc: 0.9839
Epoch 23/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0870 - acc: 0.9875
Epoch 24/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0814 - acc: 0.9863
Epoch 25/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0805 - acc: 0.9855
Epoch 26/30

83/83 [==============================] - 2s 29ms/step - loss: 0.0735 - acc: 0.9851
Epoch 27/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0730 - acc: 0.9864
Epoch 28/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0678 - acc: 0.9896
Epoch 29/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0681 - acc: 0.9900
Epoch 30/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0633 - acc: 0.9900
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7701
False 1370
True percentage 0.848969242641
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.95      0.95      7318
      B-ORG       0.43      0.41      0.42       296
      I-ORG       0.30      0.33      0.32       151
      B-PER       0.71      0.60      0.65       438
      I-PER       0.72      0.48      0.57       214
     B-MISC       0.18      0.06      0.09       141
     I-MISC       0.40      0.06      0.11       154
      B-LOC       0.78      0.52      0.62       218
      I-LOC       0.52      0.57      0.55       141

avg / total       0.88      0.85      0.86      9071

F-1 Score (without O):
0.484435797665
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104112 unique words.
4108 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 277
OOV word occurences: in test 484
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663232     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,362
Trainable params: 6,775,362
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

83/83 [==============================] - 4s 47ms/step - loss: 1.0471 - acc: 0.6819
Epoch 2/30

83/83 [==============================] - 2s 28ms/step - loss: 0.4644 - acc: 0.8502
Epoch 3/30

83/83 [==============================] - 2s 28ms/step - loss: 0.3997 - acc: 0.8809
Epoch 4/30

83/83 [==============================] - 2s 28ms/step - loss: 0.3548 - acc: 0.8973
Epoch 5/30

83/83 [==============================] - 2s 29ms/step - loss: 0.3266 - acc: 0.9044
Epoch 6/30

83/83 [==============================] - 2s 29ms/step - loss: 0.2784 - acc: 0.9140
Epoch 7/30

83/83 [==============================] - 2s 29ms/step - loss: 0.2649 - acc: 0.9265
Epoch 8/30

83/83 [==============================] - 2s 28ms/step - loss: 0.2393 - acc: 0.9343
Epoch 9/30

83/83 [==============================] - 2s 29ms/step - loss: 0.2256 - acc: 0.9440
Epoch 10/30

83/83 [==============================] - 2s 29ms/step - loss: 0.1996 - acc: 0.9556
Epoch 11/30

83/83 [==============================] - 2s 29ms/step - loss: 0.1870 - acc: 0.9530
Epoch 12/30

83/83 [==============================] - 2s 29ms/step - loss: 0.1763 - acc: 0.9566
Epoch 13/30

83/83 [==============================] - 2s 29ms/step - loss: 0.1745 - acc: 0.9562
Epoch 14/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1515 - acc: 0.9687
Epoch 15/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1460 - acc: 0.9670
Epoch 16/30

83/83 [==============================] - 2s 29ms/step - loss: 0.1356 - acc: 0.9718
Epoch 17/30

83/83 [==============================] - 2s 29ms/step - loss: 0.1256 - acc: 0.9768
Epoch 18/30

83/83 [==============================] - 2s 29ms/step - loss: 0.1171 - acc: 0.9744
Epoch 19/30

83/83 [==============================] - 2s 29ms/step - loss: 0.1075 - acc: 0.9789
Epoch 20/30

83/83 [==============================] - 2s 29ms/step - loss: 0.1074 - acc: 0.9811
Epoch 21/30

83/83 [==============================] - 2s 29ms/step - loss: 0.0971 - acc: 0.9803
Epoch 22/30

83/83 [==============================] - 2s 29ms/step - loss: 0.0905 - acc: 0.9856
Epoch 23/30

83/83 [==============================] - 2s 29ms/step - loss: 0.0886 - acc: 0.9804
Epoch 24/30

83/83 [==============================] - 2s 29ms/step - loss: 0.0824 - acc: 0.9851
Epoch 25/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0765 - acc: 0.9849
Epoch 26/30

83/83 [==============================] - 2s 29ms/step - loss: 0.0736 - acc: 0.9886
Epoch 27/30

83/83 [==============================] - 2s 29ms/step - loss: 0.0682 - acc: 0.9908
Epoch 28/30

83/83 [==============================] - 2s 29ms/step - loss: 0.0679 - acc: 0.9890
Epoch 29/30

83/83 [==============================] - 2s 29ms/step - loss: 0.0590 - acc: 0.9920
Epoch 30/30

83/83 [==============================] - 2s 29ms/step - loss: 0.0575 - acc: 0.9904
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7642
False 1429
True percentage 0.842464998346
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-PER       0.72      0.49      0.58       438
      B-LOC       0.67      0.57      0.62       218
     B-MISC       0.20      0.11      0.14       141
     I-MISC       0.32      0.29      0.30       154
      B-ORG       0.45      0.44      0.45       296
      I-ORG       0.21      0.31      0.25       151
      I-LOC       0.72      0.42      0.53       141
      I-PER       0.72      0.35      0.47       214

avg / total       0.88      0.84      0.86      9071

F-1 Score (without O):
0.450142450142
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104117 unique words.
4113 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 275
OOV word occurences: in test 481
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663552     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,682
Trainable params: 6,775,682
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

83/83 [==============================] - 4s 47ms/step - loss: 1.1725 - acc: 0.6432
Epoch 2/30

83/83 [==============================] - 2s 27ms/step - loss: 0.5075 - acc: 0.8374
Epoch 3/30

83/83 [==============================] - 2s 28ms/step - loss: 0.4289 - acc: 0.8760
Epoch 4/30

83/83 [==============================] - 2s 28ms/step - loss: 0.3764 - acc: 0.8892
Epoch 5/30

83/83 [==============================] - 2s 28ms/step - loss: 0.3456 - acc: 0.9079
Epoch 6/30

83/83 [==============================] - 2s 28ms/step - loss: 0.2915 - acc: 0.9183
Epoch 7/30

83/83 [==============================] - 2s 27ms/step - loss: 0.2691 - acc: 0.9313
Epoch 8/30

83/83 [==============================] - 2s 27ms/step - loss: 0.2630 - acc: 0.9308
Epoch 9/30

83/83 [==============================] - 2s 27ms/step - loss: 0.2247 - acc: 0.9451
Epoch 10/30

83/83 [==============================] - 2s 28ms/step - loss: 0.2036 - acc: 0.9492
Epoch 11/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1867 - acc: 0.9585
Epoch 12/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1722 - acc: 0.9590
Epoch 13/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1583 - acc: 0.9688
Epoch 14/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1539 - acc: 0.9581
Epoch 15/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1315 - acc: 0.9704
Epoch 16/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1214 - acc: 0.9758
Epoch 17/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1110 - acc: 0.9822
Epoch 18/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1090 - acc: 0.9773
Epoch 19/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0986 - acc: 0.9829
Epoch 20/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0930 - acc: 0.9843
Epoch 21/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0884 - acc: 0.9834
Epoch 22/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0822 - acc: 0.9887
Epoch 23/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0739 - acc: 0.9895
Epoch 24/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0708 - acc: 0.9872
Epoch 25/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0689 - acc: 0.9890
Epoch 26/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0627 - acc: 0.9926
Epoch 27/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0617 - acc: 0.9922
Epoch 28/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0586 - acc: 0.9905
Epoch 29/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0522 - acc: 0.9924
Epoch 30/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0491 - acc: 0.9930
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7747
False 1324
True percentage 0.854040348363
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.94      0.96      7318
      B-ORG       0.47      0.53      0.50       296
      I-ORG       0.31      0.40      0.35       151
      B-PER       0.78      0.61      0.68       438
      I-PER       0.69      0.55      0.61       214
      B-LOC       0.68      0.52      0.59       218
      I-LOC       0.73      0.33      0.45       141
     B-MISC       0.38      0.14      0.21       141
     I-MISC       0.38      0.34      0.36       154

avg / total       0.90      0.85      0.87      9071

F-1 Score (without O):
0.518195956454
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104064 unique words.
4060 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 558
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660160     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,290
Trainable params: 6,772,290
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

33/33 [==============================] - 3s 78ms/step - loss: 1.5936 - acc: 0.4498
Epoch 2/30

33/33 [==============================] - 1s 30ms/step - loss: 0.7980 - acc: 0.7926
Epoch 3/30

33/33 [==============================] - 1s 30ms/step - loss: 0.6572 - acc: 0.8019
Epoch 4/30

33/33 [==============================] - 1s 30ms/step - loss: 0.6023 - acc: 0.8070
Epoch 5/30

33/33 [==============================] - 1s 30ms/step - loss: 0.5057 - acc: 0.8310
Epoch 6/30

33/33 [==============================] - 1s 29ms/step - loss: 0.4528 - acc: 0.8431
Epoch 7/30

33/33 [==============================] - 1s 30ms/step - loss: 0.4102 - acc: 0.8751
Epoch 8/30

33/33 [==============================] - 1s 30ms/step - loss: 0.4096 - acc: 0.8880
Epoch 9/30

33/33 [==============================] - 1s 30ms/step - loss: 0.3762 - acc: 0.9026
Epoch 10/30

33/33 [==============================] - 1s 30ms/step - loss: 0.3433 - acc: 0.8915
Epoch 11/30

33/33 [==============================] - 1s 30ms/step - loss: 0.3104 - acc: 0.9028
Epoch 12/30

33/33 [==============================] - 1s 31ms/step - loss: 0.3315 - acc: 0.9150
Epoch 13/30

33/33 [==============================] - 1s 29ms/step - loss: 0.2915 - acc: 0.9321
Epoch 14/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2693 - acc: 0.9315
Epoch 15/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2506 - acc: 0.9492
Epoch 16/30

33/33 [==============================] - 1s 29ms/step - loss: 0.2588 - acc: 0.9295
Epoch 17/30

33/33 [==============================] - 1s 31ms/step - loss: 0.2290 - acc: 0.9467
Epoch 18/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2201 - acc: 0.9514
Epoch 19/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2183 - acc: 0.9509
Epoch 20/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2051 - acc: 0.9535
Epoch 21/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1951 - acc: 0.9633
Epoch 22/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1845 - acc: 0.9670
Epoch 23/30

33/33 [==============================] - 1s 29ms/step - loss: 0.1815 - acc: 0.9595
Epoch 24/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1766 - acc: 0.9635
Epoch 25/30

33/33 [==============================] - 1s 29ms/step - loss: 0.1761 - acc: 0.9723
Epoch 26/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1595 - acc: 0.9637
Epoch 27/30

33/33 [==============================] - 1s 31ms/step - loss: 0.1604 - acc: 0.9741
Epoch 28/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1491 - acc: 0.9770
Epoch 29/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1335 - acc: 0.9817
Epoch 30/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1421 - acc: 0.9786
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7548
False 1523
True percentage 0.832102304046
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.95      0.95      7318
      B-LOC       0.57      0.46      0.51       218
      I-LOC       0.40      0.32      0.36       141
      B-PER       0.59      0.50      0.54       438
      B-ORG       0.50      0.36      0.42       296
      I-ORG       0.22      0.17      0.19       151
     B-MISC       0.36      0.23      0.28       141
     I-MISC       0.31      0.21      0.25       154
      I-PER       0.56      0.33      0.41       214

avg / total       0.87      0.83      0.85      9071

F-1 Score (without O):
0.412188728702
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104073 unique words.
4069 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 280
OOV word occurences: in test 496
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660736     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,866
Trainable params: 6,772,866
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

33/33 [==============================] - 3s 78ms/step - loss: 1.4543 - acc: 0.5115
Epoch 2/30

33/33 [==============================] - 1s 29ms/step - loss: 0.6660 - acc: 0.8077
Epoch 3/30

33/33 [==============================] - 1s 31ms/step - loss: 0.5657 - acc: 0.8219
Epoch 4/30

33/33 [==============================] - 1s 30ms/step - loss: 0.5028 - acc: 0.8227
Epoch 5/30

33/33 [==============================] - 1s 29ms/step - loss: 0.4823 - acc: 0.8465
Epoch 6/30

33/33 [==============================] - 1s 30ms/step - loss: 0.4167 - acc: 0.8706
Epoch 7/30

33/33 [==============================] - 1s 30ms/step - loss: 0.3896 - acc: 0.8721
Epoch 8/30

33/33 [==============================] - 1s 30ms/step - loss: 0.3499 - acc: 0.8973
Epoch 9/30

33/33 [==============================] - 1s 29ms/step - loss: 0.3414 - acc: 0.8974
Epoch 10/30

33/33 [==============================] - 1s 30ms/step - loss: 0.3186 - acc: 0.9129
Epoch 11/30

33/33 [==============================] - 1s 29ms/step - loss: 0.3029 - acc: 0.9098
Epoch 12/30

33/33 [==============================] - 1s 29ms/step - loss: 0.2787 - acc: 0.9224
Epoch 13/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2664 - acc: 0.9284
Epoch 14/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2557 - acc: 0.9506
Epoch 15/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2466 - acc: 0.9448
Epoch 16/30

33/33 [==============================] - 1s 31ms/step - loss: 0.2339 - acc: 0.9536
Epoch 17/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2109 - acc: 0.9583
Epoch 18/30

33/33 [==============================] - 1s 29ms/step - loss: 0.2230 - acc: 0.9509
Epoch 19/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2093 - acc: 0.9536
Epoch 20/30

33/33 [==============================] - 1s 31ms/step - loss: 0.2121 - acc: 0.9445
Epoch 21/30

33/33 [==============================] - 1s 31ms/step - loss: 0.1911 - acc: 0.9652
Epoch 22/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1779 - acc: 0.9619
Epoch 23/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1708 - acc: 0.9621
Epoch 24/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1585 - acc: 0.9740
Epoch 25/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1563 - acc: 0.9646
Epoch 26/30

33/33 [==============================] - 1s 31ms/step - loss: 0.1565 - acc: 0.9676
Epoch 27/30

33/33 [==============================] - 1s 31ms/step - loss: 0.1414 - acc: 0.9748
Epoch 28/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1480 - acc: 0.9591
Epoch 29/30

33/33 [==============================] - 1s 29ms/step - loss: 0.1309 - acc: 0.9786
Epoch 30/30

33/33 [==============================] - 1s 31ms/step - loss: 0.1281 - acc: 0.9749
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7519
False 1552
True percentage 0.828905302613
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.94      0.95      7318
      B-ORG       0.38      0.30      0.34       296
      I-ORG       0.24      0.21      0.22       151
      B-PER       0.69      0.46      0.55       438
      I-PER       0.73      0.24      0.36       214
     B-MISC       0.13      0.07      0.09       141
     I-MISC       0.13      0.05      0.07       154
      B-LOC       0.54      0.58      0.56       218
      I-LOC       0.35      0.65      0.46       141

avg / total       0.86      0.83      0.84      9071

F-1 Score (without O):
0.392811296534
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104062 unique words.
4058 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 280
OOV word occurences: in test 496
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660032     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,162
Trainable params: 6,772,162
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

33/33 [==============================] - 3s 80ms/step - loss: 1.6854 - acc: 0.4199
Epoch 2/30

33/33 [==============================] - 1s 31ms/step - loss: 0.7022 - acc: 0.8005
Epoch 3/30

33/33 [==============================] - 1s 31ms/step - loss: 0.5739 - acc: 0.8210
Epoch 4/30

33/33 [==============================] - 1s 30ms/step - loss: 0.5666 - acc: 0.8206
Epoch 5/30

33/33 [==============================] - 1s 30ms/step - loss: 0.4966 - acc: 0.8462
Epoch 6/30

33/33 [==============================] - 1s 31ms/step - loss: 0.4403 - acc: 0.8625
Epoch 7/30

33/33 [==============================] - 1s 29ms/step - loss: 0.4031 - acc: 0.8778
Epoch 8/30

33/33 [==============================] - 1s 30ms/step - loss: 0.3995 - acc: 0.8765
Epoch 9/30

33/33 [==============================] - 1s 31ms/step - loss: 0.3889 - acc: 0.8734
Epoch 10/30

33/33 [==============================] - 1s 30ms/step - loss: 0.3468 - acc: 0.8914
Epoch 11/30

33/33 [==============================] - 1s 30ms/step - loss: 0.3232 - acc: 0.9005
Epoch 12/30

33/33 [==============================] - 1s 29ms/step - loss: 0.2918 - acc: 0.9161
Epoch 13/30

33/33 [==============================] - 1s 31ms/step - loss: 0.2918 - acc: 0.9153
Epoch 14/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2675 - acc: 0.9272
Epoch 15/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2647 - acc: 0.9263
Epoch 16/30

33/33 [==============================] - 1s 29ms/step - loss: 0.2567 - acc: 0.9362
Epoch 17/30

33/33 [==============================] - 1s 31ms/step - loss: 0.2192 - acc: 0.9493
Epoch 18/30

33/33 [==============================] - 1s 31ms/step - loss: 0.2325 - acc: 0.9377
Epoch 19/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2109 - acc: 0.9430
Epoch 20/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2002 - acc: 0.9461
Epoch 21/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1990 - acc: 0.9484
Epoch 22/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1883 - acc: 0.9546
Epoch 23/30

33/33 [==============================] - 1s 31ms/step - loss: 0.1770 - acc: 0.9592
Epoch 24/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1687 - acc: 0.9575
Epoch 25/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1759 - acc: 0.9500
Epoch 26/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1560 - acc: 0.9689
Epoch 27/30

33/33 [==============================] - 1s 31ms/step - loss: 0.1509 - acc: 0.9589
Epoch 28/30

33/33 [==============================] - 1s 31ms/step - loss: 0.1537 - acc: 0.9664
Epoch 29/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1563 - acc: 0.9567
Epoch 30/30

33/33 [==============================] - 1s 31ms/step - loss: 0.1423 - acc: 0.9669
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7373
False 1698
True percentage 0.812810054018
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.94      0.94      7318
      B-PER       0.71      0.37      0.48       438
      B-LOC       0.37      0.35      0.36       218
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-ORG       0.40      0.49      0.44       296
      I-ORG       0.21      0.30      0.25       151
      I-LOC       0.17      0.21      0.19       141
      I-PER       0.63      0.08      0.14       214

avg / total       0.83      0.81      0.82      9071

F-1 Score (without O):
0.319163292848
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104072 unique words.
4068 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 279
OOV word occurences: in test 552
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660672     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,802
Trainable params: 6,772,802
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

33/33 [==============================] - 3s 78ms/step - loss: 1.9689 - acc: 0.3860
Epoch 2/30

33/33 [==============================] - 1s 30ms/step - loss: 0.8614 - acc: 0.7648
Epoch 3/30

33/33 [==============================] - 1s 30ms/step - loss: 0.6389 - acc: 0.8105
Epoch 4/30

33/33 [==============================] - 1s 30ms/step - loss: 0.5532 - acc: 0.8139
Epoch 5/30

33/33 [==============================] - 1s 30ms/step - loss: 0.4955 - acc: 0.8551
Epoch 6/30

33/33 [==============================] - 1s 29ms/step - loss: 0.5020 - acc: 0.8315
Epoch 7/30

33/33 [==============================] - 1s 30ms/step - loss: 0.4686 - acc: 0.8644
Epoch 8/30

33/33 [==============================] - 1s 30ms/step - loss: 0.3983 - acc: 0.8739
Epoch 9/30

33/33 [==============================] - 1s 29ms/step - loss: 0.4046 - acc: 0.8876
Epoch 10/30

33/33 [==============================] - 1s 30ms/step - loss: 0.3493 - acc: 0.9005
Epoch 11/30

33/33 [==============================] - 1s 30ms/step - loss: 0.3462 - acc: 0.8980
Epoch 12/30

33/33 [==============================] - 1s 29ms/step - loss: 0.3163 - acc: 0.9132
Epoch 13/30

33/33 [==============================] - 1s 29ms/step - loss: 0.3211 - acc: 0.9048
Epoch 14/30

33/33 [==============================] - 1s 29ms/step - loss: 0.2875 - acc: 0.9264
Epoch 15/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2862 - acc: 0.9106
Epoch 16/30

33/33 [==============================] - 1s 29ms/step - loss: 0.2622 - acc: 0.9325
Epoch 17/30

33/33 [==============================] - 1s 29ms/step - loss: 0.2499 - acc: 0.9502
Epoch 18/30

33/33 [==============================] - 1s 29ms/step - loss: 0.2354 - acc: 0.9500
Epoch 19/30

33/33 [==============================] - 1s 29ms/step - loss: 0.2330 - acc: 0.9625
Epoch 20/30

33/33 [==============================] - 1s 29ms/step - loss: 0.2176 - acc: 0.9522
Epoch 21/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2012 - acc: 0.9610
Epoch 22/30

33/33 [==============================] - 1s 29ms/step - loss: 0.1928 - acc: 0.9647
Epoch 23/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1839 - acc: 0.9692
Epoch 24/30

33/33 [==============================] - 1s 29ms/step - loss: 0.1880 - acc: 0.9645
Epoch 25/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1746 - acc: 0.9669
Epoch 26/30

33/33 [==============================] - 1s 29ms/step - loss: 0.1622 - acc: 0.9658
Epoch 27/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1601 - acc: 0.9714
Epoch 28/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1494 - acc: 0.9780
Epoch 29/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1472 - acc: 0.9827
Epoch 30/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1374 - acc: 0.9809
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7442
False 1629
True percentage 0.820416712601
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.94      0.94      7318
      B-ORG       0.40      0.40      0.40       296
      I-ORG       0.22      0.23      0.22       151
      B-PER       0.64      0.39      0.49       438
      I-PER       0.42      0.41      0.41       214
      B-LOC       0.73      0.34      0.46       218
      I-LOC       0.76      0.09      0.16       141
     B-MISC       0.44      0.08      0.13       141
     I-MISC       0.31      0.21      0.25       154

avg / total       0.86      0.82      0.83      9071

F-1 Score (without O):
0.370978781656
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 8 unique labels.
Found 104048 unique words.
4044 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 567
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659136     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,116
Trainable params: 6,771,116
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

16/16 [==============================] - 2s 128ms/step - loss: 2.8966 - acc: 0.0206
Epoch 2/30

16/16 [==============================] - 0s 27ms/step - loss: 1.1051 - acc: 0.8260
Epoch 3/30

16/16 [==============================] - 0s 29ms/step - loss: 0.6273 - acc: 0.8466
Epoch 4/30

16/16 [==============================] - 0s 29ms/step - loss: 0.5067 - acc: 0.8525
Epoch 5/30

16/16 [==============================] - 0s 28ms/step - loss: 0.4359 - acc: 0.8525
Epoch 6/30

16/16 [==============================] - 0s 28ms/step - loss: 0.3996 - acc: 0.8820
Epoch 7/30

16/16 [==============================] - 0s 28ms/step - loss: 0.3660 - acc: 0.8614
Epoch 8/30

16/16 [==============================] - 0s 27ms/step - loss: 0.3435 - acc: 0.9056
Epoch 9/30

16/16 [==============================] - 0s 27ms/step - loss: 0.3156 - acc: 0.8702
Epoch 10/30

16/16 [==============================] - 0s 26ms/step - loss: 0.2707 - acc: 0.9440
Epoch 11/30

16/16 [==============================] - 0s 27ms/step - loss: 0.2441 - acc: 0.9381
Epoch 12/30

16/16 [==============================] - 0s 29ms/step - loss: 0.2234 - acc: 0.9469
Epoch 13/30

16/16 [==============================] - 0s 27ms/step - loss: 0.2044 - acc: 0.9528
Epoch 14/30

16/16 [==============================] - 0s 28ms/step - loss: 0.1793 - acc: 0.9558
Epoch 15/30

16/16 [==============================] - 0s 28ms/step - loss: 0.1823 - acc: 0.9676
Epoch 16/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1699 - acc: 0.9617
Epoch 17/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1558 - acc: 0.9705
Epoch 18/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1442 - acc: 0.9735
Epoch 19/30

16/16 [==============================] - 0s 28ms/step - loss: 0.1414 - acc: 0.9764
Epoch 20/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1414 - acc: 0.9735
Epoch 21/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1303 - acc: 0.9882
Epoch 22/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1211 - acc: 0.9794
Epoch 23/30

16/16 [==============================] - 0s 28ms/step - loss: 0.1163 - acc: 0.9941
Epoch 24/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1105 - acc: 0.9882
Epoch 25/30

16/16 [==============================] - 0s 26ms/step - loss: 0.1000 - acc: 0.9882
Epoch 26/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1017 - acc: 0.9882
Epoch 27/30

16/16 [==============================] - 0s 27ms/step - loss: 0.0936 - acc: 0.9912
Epoch 28/30

16/16 [==============================] - 0s 26ms/step - loss: 0.0871 - acc: 1.0000
Epoch 29/30

16/16 [==============================] - 0s 28ms/step - loss: 0.0837 - acc: 0.9912
Epoch 30/30

16/16 [==============================] - 0s 28ms/step - loss: 0.0908 - acc: 0.9912
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7143
False 1714
True percentage 0.80648074969
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.93      0.94      7318
      B-LOC       0.29      0.12      0.17       218
      I-LOC       0.20      0.30      0.24       141
      B-PER       0.75      0.16      0.26       438
      B-ORG       0.23      0.50      0.32       296
      I-ORG       0.18      0.21      0.19       151
     B-MISC       0.02      0.01      0.01       141
     I-MISC       0.23      0.06      0.10       154

avg / total       0.85      0.81      0.81      8857

F-1 Score (without O):
0.231600976631
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104057 unique words.
4053 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 567
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659712     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,842
Trainable params: 6,771,842
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

16/16 [==============================] - 2s 129ms/step - loss: 3.2110 - acc: 0.0777
Epoch 2/30

16/16 [==============================] - 0s 27ms/step - loss: 1.2534 - acc: 0.7373
Epoch 3/30

16/16 [==============================] - 0s 27ms/step - loss: 0.7474 - acc: 0.7802
Epoch 4/30

16/16 [==============================] - 0s 29ms/step - loss: 0.6852 - acc: 0.7989
Epoch 5/30

16/16 [==============================] - 0s 26ms/step - loss: 0.6056 - acc: 0.7936
Epoch 6/30

16/16 [==============================] - 0s 28ms/step - loss: 0.5516 - acc: 0.8391
Epoch 7/30

16/16 [==============================] - 0s 27ms/step - loss: 0.4562 - acc: 0.8525
Epoch 8/30

16/16 [==============================] - 0s 27ms/step - loss: 0.4363 - acc: 0.8847
Epoch 9/30

16/16 [==============================] - 0s 28ms/step - loss: 0.4240 - acc: 0.8606
Epoch 10/30

16/16 [==============================] - 0s 28ms/step - loss: 0.3860 - acc: 0.8767
Epoch 11/30

16/16 [==============================] - 0s 29ms/step - loss: 0.3392 - acc: 0.9035
Epoch 12/30

16/16 [==============================] - 0s 28ms/step - loss: 0.3205 - acc: 0.9276
Epoch 13/30

16/16 [==============================] - 0s 29ms/step - loss: 0.3195 - acc: 0.9357
Epoch 14/30

16/16 [==============================] - 0s 28ms/step - loss: 0.3062 - acc: 0.9276
Epoch 15/30

16/16 [==============================] - 0s 28ms/step - loss: 0.2799 - acc: 0.9303
Epoch 16/30

16/16 [==============================] - 0s 27ms/step - loss: 0.2718 - acc: 0.9357
Epoch 17/30

16/16 [==============================] - 0s 28ms/step - loss: 0.2551 - acc: 0.9464
Epoch 18/30

16/16 [==============================] - 0s 27ms/step - loss: 0.2373 - acc: 0.9571
Epoch 19/30

16/16 [==============================] - 0s 28ms/step - loss: 0.2361 - acc: 0.9464
Epoch 20/30

16/16 [==============================] - 0s 28ms/step - loss: 0.2234 - acc: 0.9678
Epoch 21/30

16/16 [==============================] - 0s 28ms/step - loss: 0.2220 - acc: 0.9544
Epoch 22/30

16/16 [==============================] - 0s 27ms/step - loss: 0.2078 - acc: 0.9759
Epoch 23/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1906 - acc: 0.9625
Epoch 24/30

16/16 [==============================] - 0s 28ms/step - loss: 0.1700 - acc: 0.9732
Epoch 25/30

16/16 [==============================] - 0s 28ms/step - loss: 0.1589 - acc: 0.9839
Epoch 26/30

16/16 [==============================] - 0s 28ms/step - loss: 0.1594 - acc: 0.9839
Epoch 27/30

16/16 [==============================] - 0s 29ms/step - loss: 0.1586 - acc: 0.9786
Epoch 28/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1411 - acc: 0.9893
Epoch 29/30

16/16 [==============================] - 0s 29ms/step - loss: 0.1456 - acc: 0.9759
Epoch 30/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1336 - acc: 0.9866
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7167
False 1904
True percentage 0.7901003197
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.92      0.94      7318
      B-ORG       0.25      0.33      0.29       296
      I-ORG       0.17      0.26      0.21       151
      B-PER       0.43      0.30      0.35       438
      I-PER       0.47      0.29      0.36       214
     B-MISC       0.06      0.07      0.06       141
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.54      0.23      0.33       218
      I-LOC       0.39      0.18      0.25       141

avg / total       0.83      0.79      0.81      9071

F-1 Score (without O):
0.265525982256
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104048 unique words.
4044 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 565
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659136     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,266
Trainable params: 6,771,266
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

16/16 [==============================] - 2s 127ms/step - loss: 2.6912 - acc: 0.0093
Epoch 2/30

16/16 [==============================] - 0s 26ms/step - loss: 1.3010 - acc: 0.7678
Epoch 3/30

16/16 [==============================] - 0s 27ms/step - loss: 0.7674 - acc: 0.7988
Epoch 4/30

16/16 [==============================] - 0s 27ms/step - loss: 0.6014 - acc: 0.8514
Epoch 5/30

16/16 [==============================] - 0s 27ms/step - loss: 0.5570 - acc: 0.8328
Epoch 6/30

16/16 [==============================] - 0s 27ms/step - loss: 0.5887 - acc: 0.8421
Epoch 7/30

16/16 [==============================] - 0s 27ms/step - loss: 0.4595 - acc: 0.8545
Epoch 8/30

16/16 [==============================] - 0s 25ms/step - loss: 0.4020 - acc: 0.8885
Epoch 9/30

16/16 [==============================] - 0s 26ms/step - loss: 0.3783 - acc: 0.8885
Epoch 10/30

16/16 [==============================] - 0s 28ms/step - loss: 0.3596 - acc: 0.9071
Epoch 11/30

16/16 [==============================] - 0s 27ms/step - loss: 0.3392 - acc: 0.9040
Epoch 12/30

16/16 [==============================] - 0s 28ms/step - loss: 0.2997 - acc: 0.9195
Epoch 13/30

16/16 [==============================] - 0s 26ms/step - loss: 0.2916 - acc: 0.9226
Epoch 14/30

16/16 [==============================] - 0s 26ms/step - loss: 0.2587 - acc: 0.9381
Epoch 15/30

16/16 [==============================] - 0s 27ms/step - loss: 0.2440 - acc: 0.9381
Epoch 16/30

16/16 [==============================] - 0s 27ms/step - loss: 0.2200 - acc: 0.9505
Epoch 17/30

16/16 [==============================] - 0s 27ms/step - loss: 0.2201 - acc: 0.9474
Epoch 18/30

16/16 [==============================] - 0s 27ms/step - loss: 0.2164 - acc: 0.9567
Epoch 19/30

16/16 [==============================] - 0s 26ms/step - loss: 0.1870 - acc: 0.9628
Epoch 20/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1852 - acc: 0.9721
Epoch 21/30

16/16 [==============================] - 0s 26ms/step - loss: 0.1714 - acc: 0.9690
Epoch 22/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1712 - acc: 0.9628
Epoch 23/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1714 - acc: 0.9690
Epoch 24/30

16/16 [==============================] - 0s 29ms/step - loss: 0.1469 - acc: 0.9783
Epoch 25/30

16/16 [==============================] - 0s 28ms/step - loss: 0.1301 - acc: 0.9845
Epoch 26/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1312 - acc: 0.9907
Epoch 27/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1184 - acc: 0.9876
Epoch 28/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1182 - acc: 0.9876
Epoch 29/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1099 - acc: 0.9907
Epoch 30/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1197 - acc: 0.9876
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7299
False 1772
True percentage 0.804652188292
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.94      0.94      7318
      B-PER       0.49      0.39      0.43       438
      B-LOC       0.54      0.32      0.40       218
     B-MISC       0.09      0.04      0.05       141
     I-MISC       0.09      0.01      0.02       154
      B-ORG       0.30      0.35      0.32       296
      I-ORG       0.14      0.16      0.15       151
      I-LOC       1.00      0.10      0.18       141
      I-PER       0.68      0.10      0.17       214

avg / total       0.84      0.80      0.81      9071

F-1 Score (without O):
0.285515804099
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104056 unique words.
4052 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 559
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659648     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,778
Trainable params: 6,771,778
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

16/16 [==============================] - 2s 126ms/step - loss: 1.9386 - acc: 0.3607
Epoch 2/30

16/16 [==============================] - 0s 27ms/step - loss: 0.9552 - acc: 0.7692
Epoch 3/30

16/16 [==============================] - 0s 27ms/step - loss: 0.8241 - acc: 0.8117
Epoch 4/30

16/16 [==============================] - 0s 27ms/step - loss: 0.7628 - acc: 0.7692
Epoch 5/30

16/16 [==============================] - 0s 26ms/step - loss: 0.6545 - acc: 0.8488
Epoch 6/30

16/16 [==============================] - 0s 27ms/step - loss: 0.5275 - acc: 0.8276
Epoch 7/30

16/16 [==============================] - 0s 29ms/step - loss: 0.4791 - acc: 0.8700
Epoch 8/30

16/16 [==============================] - 0s 26ms/step - loss: 0.4346 - acc: 0.8780
Epoch 9/30

16/16 [==============================] - 0s 27ms/step - loss: 0.4160 - acc: 0.9019
Epoch 10/30

16/16 [==============================] - 0s 26ms/step - loss: 0.3608 - acc: 0.9019
Epoch 11/30

16/16 [==============================] - 0s 27ms/step - loss: 0.3532 - acc: 0.9072
Epoch 12/30

16/16 [==============================] - 0s 27ms/step - loss: 0.3468 - acc: 0.9204
Epoch 13/30

16/16 [==============================] - 0s 27ms/step - loss: 0.2878 - acc: 0.9523
Epoch 14/30

16/16 [==============================] - 0s 26ms/step - loss: 0.2801 - acc: 0.9363
Epoch 15/30

16/16 [==============================] - 0s 27ms/step - loss: 0.2637 - acc: 0.9549
Epoch 16/30

16/16 [==============================] - 0s 29ms/step - loss: 0.2457 - acc: 0.9602
Epoch 17/30

16/16 [==============================] - 0s 26ms/step - loss: 0.2349 - acc: 0.9496
Epoch 18/30

16/16 [==============================] - 0s 27ms/step - loss: 0.2138 - acc: 0.9708
Epoch 19/30

16/16 [==============================] - 0s 26ms/step - loss: 0.1885 - acc: 0.9735
Epoch 20/30

16/16 [==============================] - 0s 26ms/step - loss: 0.1905 - acc: 0.9735
Epoch 21/30

16/16 [==============================] - 0s 26ms/step - loss: 0.1792 - acc: 0.9761
Epoch 22/30

16/16 [==============================] - 0s 25ms/step - loss: 0.1598 - acc: 0.9788
Epoch 23/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1916 - acc: 0.9682
Epoch 24/30

16/16 [==============================] - 0s 26ms/step - loss: 0.1645 - acc: 0.9735
Epoch 25/30

16/16 [==============================] - 0s 26ms/step - loss: 0.1387 - acc: 0.9788
Epoch 26/30

16/16 [==============================] - 0s 26ms/step - loss: 0.1238 - acc: 0.9894
Epoch 27/30

16/16 [==============================] - 0s 26ms/step - loss: 0.1150 - acc: 0.9920
Epoch 28/30

16/16 [==============================] - 0s 28ms/step - loss: 0.1144 - acc: 0.9920
Epoch 29/30

16/16 [==============================] - 0s 28ms/step - loss: 0.1031 - acc: 0.9920
Epoch 30/30

16/16 [==============================] - 0s 26ms/step - loss: 0.1079 - acc: 0.9920
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7157
False 1914
True percentage 0.788997905413
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.92      0.94      7318
      B-ORG       0.26      0.33      0.29       296
      I-ORG       0.12      0.28      0.16       151
      B-PER       0.40      0.14      0.21       438
      I-PER       0.25      0.34      0.29       214
      B-LOC       0.66      0.43      0.52       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.16      0.16      0.16       154

avg / total       0.83      0.79      0.80      9071

F-1 Score (without O):
0.24343527958
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 8 unique labels.
Found 104041 unique words.
4037 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658688     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,668
Trainable params: 6,770,668
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

8/8 [==============================] - 2s 234ms/step - loss: 2.2628 - acc: 0.0728
Epoch 2/30

8/8 [==============================] - 0s 31ms/step - loss: 0.7665 - acc: 0.8013
Epoch 3/30

8/8 [==============================] - 0s 32ms/step - loss: 0.5307 - acc: 0.8146
Epoch 4/30

8/8 [==============================] - 0s 32ms/step - loss: 0.4519 - acc: 0.8609
Epoch 5/30

8/8 [==============================] - 0s 33ms/step - loss: 0.3826 - acc: 0.8411
Epoch 6/30

8/8 [==============================] - 0s 32ms/step - loss: 0.3594 - acc: 0.9404
Epoch 7/30

8/8 [==============================] - 0s 32ms/step - loss: 0.2983 - acc: 0.9205
Epoch 8/30

8/8 [==============================] - 0s 32ms/step - loss: 0.2467 - acc: 0.9603
Epoch 9/30

8/8 [==============================] - 0s 33ms/step - loss: 0.2270 - acc: 0.9536
Epoch 10/30

8/8 [==============================] - 0s 33ms/step - loss: 0.1932 - acc: 0.9801
Epoch 11/30

8/8 [==============================] - 0s 33ms/step - loss: 0.1926 - acc: 0.9669
Epoch 12/30

8/8 [==============================] - 0s 34ms/step - loss: 0.1773 - acc: 0.9801
Epoch 13/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1431 - acc: 0.9868
Epoch 14/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1327 - acc: 0.9934
Epoch 15/30

8/8 [==============================] - 0s 33ms/step - loss: 0.1287 - acc: 0.9868
Epoch 16/30

8/8 [==============================] - 0s 33ms/step - loss: 0.1050 - acc: 0.9868
Epoch 17/30

8/8 [==============================] - 0s 32ms/step - loss: 0.0953 - acc: 1.0000
Epoch 18/30

8/8 [==============================] - 0s 32ms/step - loss: 0.0914 - acc: 1.0000
Epoch 19/30

8/8 [==============================] - 0s 33ms/step - loss: 0.0867 - acc: 0.9934
Epoch 20/30

8/8 [==============================] - 0s 31ms/step - loss: 0.0779 - acc: 1.0000
Epoch 21/30

8/8 [==============================] - 0s 32ms/step - loss: 0.0756 - acc: 1.0000
Epoch 22/30

8/8 [==============================] - 0s 31ms/step - loss: 0.0678 - acc: 1.0000
Epoch 23/30

8/8 [==============================] - 0s 31ms/step - loss: 0.0631 - acc: 1.0000
Epoch 24/30

8/8 [==============================] - 0s 31ms/step - loss: 0.0619 - acc: 1.0000
Epoch 25/30

8/8 [==============================] - 0s 32ms/step - loss: 0.0546 - acc: 1.0000
Epoch 26/30

8/8 [==============================] - 0s 31ms/step - loss: 0.0587 - acc: 1.0000
Epoch 27/30

8/8 [==============================] - 0s 32ms/step - loss: 0.0543 - acc: 1.0000
Epoch 28/30

8/8 [==============================] - 0s 32ms/step - loss: 0.0521 - acc: 1.0000
Epoch 29/30

8/8 [==============================] - 0s 33ms/step - loss: 0.0474 - acc: 1.0000
Epoch 30/30

8/8 [==============================] - 0s 32ms/step - loss: 0.0402 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7033
False 1824
True percentage 0.794061194535
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.91      0.94      7318
      B-LOC       0.51      0.13      0.21       218
      I-LOC       0.17      0.15      0.16       141
      B-PER       0.38      0.20      0.26       438
      B-ORG       0.22      0.55      0.32       296
      I-ORG       0.16      0.40      0.23       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.08      0.05      0.06       154

avg / total       0.85      0.79      0.81      8857

F-1 Score (without O):
0.232499208109
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 4
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104051 unique words.
4047 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659328     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,458
Trainable params: 6,771,458
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

8/8 [==============================] - 2s 233ms/step - loss: 2.8159 - acc: 0.1193
Epoch 2/30

8/8 [==============================] - 0s 32ms/step - loss: 1.3454 - acc: 0.6648
Epoch 3/30

8/8 [==============================] - 0s 34ms/step - loss: 0.8164 - acc: 0.7898
Epoch 4/30

8/8 [==============================] - 0s 32ms/step - loss: 0.6578 - acc: 0.7841
Epoch 5/30

8/8 [==============================] - 0s 33ms/step - loss: 0.6587 - acc: 0.8523
Epoch 6/30

8/8 [==============================] - 0s 32ms/step - loss: 0.5968 - acc: 0.7898
Epoch 7/30

8/8 [==============================] - 0s 33ms/step - loss: 0.5290 - acc: 0.8636
Epoch 8/30

8/8 [==============================] - 0s 32ms/step - loss: 0.4198 - acc: 0.8750
Epoch 9/30

8/8 [==============================] - 0s 33ms/step - loss: 0.3798 - acc: 0.9034
Epoch 10/30

8/8 [==============================] - 0s 34ms/step - loss: 0.3519 - acc: 0.8864
Epoch 11/30

8/8 [==============================] - 0s 33ms/step - loss: 0.3292 - acc: 0.9148
Epoch 12/30

8/8 [==============================] - 0s 32ms/step - loss: 0.3065 - acc: 0.9091
Epoch 13/30

8/8 [==============================] - 0s 32ms/step - loss: 0.2818 - acc: 0.9261
Epoch 14/30

8/8 [==============================] - 0s 33ms/step - loss: 0.2629 - acc: 0.9318
Epoch 15/30

8/8 [==============================] - 0s 33ms/step - loss: 0.2399 - acc: 0.9261
Epoch 16/30

8/8 [==============================] - 0s 31ms/step - loss: 0.2328 - acc: 0.9432
Epoch 17/30

8/8 [==============================] - 0s 32ms/step - loss: 0.2132 - acc: 0.9602
Epoch 18/30

8/8 [==============================] - 0s 33ms/step - loss: 0.2111 - acc: 0.9545
Epoch 19/30

8/8 [==============================] - 0s 34ms/step - loss: 0.1936 - acc: 0.9545
Epoch 20/30

8/8 [==============================] - 0s 33ms/step - loss: 0.1829 - acc: 0.9830
Epoch 21/30

8/8 [==============================] - 0s 34ms/step - loss: 0.1655 - acc: 0.9773
Epoch 22/30

8/8 [==============================] - 0s 33ms/step - loss: 0.1637 - acc: 0.9773
Epoch 23/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1332 - acc: 0.9886
Epoch 24/30

8/8 [==============================] - 0s 31ms/step - loss: 0.1322 - acc: 0.9886
Epoch 25/30

8/8 [==============================] - 0s 33ms/step - loss: 0.1334 - acc: 0.9886
Epoch 26/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1141 - acc: 0.9943
Epoch 27/30

8/8 [==============================] - 0s 34ms/step - loss: 0.1079 - acc: 1.0000
Epoch 28/30

8/8 [==============================] - 0s 32ms/step - loss: 0.0951 - acc: 1.0000
Epoch 29/30

8/8 [==============================] - 0s 32ms/step - loss: 0.0957 - acc: 0.9943
Epoch 30/30

8/8 [==============================] - 0s 33ms/step - loss: 0.0898 - acc: 0.9886
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7074
False 1997
True percentage 0.779847866828
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.92      0.94      7318
      B-ORG       0.19      0.17      0.18       296
      I-ORG       0.15      0.36      0.22       151
      B-PER       0.46      0.22      0.30       438
      I-PER       0.45      0.12      0.19       214
     B-MISC       0.07      0.19      0.10       141
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.44      0.23      0.30       218
      I-LOC       0.23      0.02      0.04       141

avg / total       0.83      0.78      0.79      9071

F-1 Score (without O):
0.194673430564
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104043 unique words.
4039 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 565
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658816     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,946
Trainable params: 6,770,946
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

8/8 [==============================] - 2s 232ms/step - loss: 2.9602 - acc: 0.0414
Epoch 2/30

8/8 [==============================] - 0s 31ms/step - loss: 1.4870 - acc: 0.5680
Epoch 3/30

8/8 [==============================] - 0s 32ms/step - loss: 0.8767 - acc: 0.8402
Epoch 4/30

8/8 [==============================] - 0s 31ms/step - loss: 0.6004 - acc: 0.8047
Epoch 5/30

8/8 [==============================] - 0s 31ms/step - loss: 0.5256 - acc: 0.8757
Epoch 6/30

8/8 [==============================] - 0s 32ms/step - loss: 0.4543 - acc: 0.8462
Epoch 7/30

8/8 [==============================] - 0s 33ms/step - loss: 0.4580 - acc: 0.8757
Epoch 8/30

8/8 [==============================] - 0s 32ms/step - loss: 0.3597 - acc: 0.8757
Epoch 9/30

8/8 [==============================] - 0s 32ms/step - loss: 0.3313 - acc: 0.9527
Epoch 10/30

8/8 [==============================] - 0s 32ms/step - loss: 0.2886 - acc: 0.9408
Epoch 11/30

8/8 [==============================] - 0s 31ms/step - loss: 0.2696 - acc: 0.9586
Epoch 12/30

8/8 [==============================] - 0s 31ms/step - loss: 0.2486 - acc: 0.9527
Epoch 13/30

8/8 [==============================] - 0s 32ms/step - loss: 0.2104 - acc: 0.9822
Epoch 14/30

8/8 [==============================] - 0s 32ms/step - loss: 0.2037 - acc: 0.9704
Epoch 15/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1841 - acc: 0.9941
Epoch 16/30

8/8 [==============================] - 0s 31ms/step - loss: 0.1981 - acc: 0.9586
Epoch 17/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1781 - acc: 0.9941
Epoch 18/30

8/8 [==============================] - 0s 30ms/step - loss: 0.1345 - acc: 0.9941
Epoch 19/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1438 - acc: 0.9822
Epoch 20/30

8/8 [==============================] - 0s 33ms/step - loss: 0.1268 - acc: 0.9882
Epoch 21/30

8/8 [==============================] - 0s 33ms/step - loss: 0.1160 - acc: 0.9941
Epoch 22/30

8/8 [==============================] - 0s 33ms/step - loss: 0.1089 - acc: 0.9882
Epoch 23/30

8/8 [==============================] - 0s 31ms/step - loss: 0.0954 - acc: 0.9941
Epoch 24/30

8/8 [==============================] - 0s 31ms/step - loss: 0.0805 - acc: 0.9941
Epoch 25/30

8/8 [==============================] - 0s 32ms/step - loss: 0.0817 - acc: 1.0000
Epoch 26/30

8/8 [==============================] - 0s 32ms/step - loss: 0.0852 - acc: 0.9941
Epoch 27/30

8/8 [==============================] - 0s 32ms/step - loss: 0.0848 - acc: 1.0000
Epoch 28/30

8/8 [==============================] - 0s 32ms/step - loss: 0.0743 - acc: 0.9941
Epoch 29/30

8/8 [==============================] - 0s 31ms/step - loss: 0.0899 - acc: 1.0000
Epoch 30/30

8/8 [==============================] - 0s 33ms/step - loss: 0.0641 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7277
False 1794
True percentage 0.80222687686
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.94      0.94      7318
      B-PER       0.39      0.40      0.39       438
      B-LOC       0.46      0.30      0.36       218
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-ORG       0.43      0.29      0.35       296
      I-ORG       0.16      0.27      0.20       151
      I-LOC       0.29      0.11      0.16       141
      I-PER       0.42      0.05      0.09       214

avg / total       0.81      0.80      0.80      9071

F-1 Score (without O):
0.273451021115
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104046 unique words.
4042 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 559
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659008     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,138
Trainable params: 6,771,138
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

8/8 [==============================] - 2s 235ms/step - loss: 2.4830 - acc: 0.0552
Epoch 2/30

8/8 [==============================] - 0s 34ms/step - loss: 1.2464 - acc: 0.6409
Epoch 3/30

8/8 [==============================] - 0s 34ms/step - loss: 0.9397 - acc: 0.7017
Epoch 4/30

8/8 [==============================] - 0s 33ms/step - loss: 0.7821 - acc: 0.7514
Epoch 5/30

8/8 [==============================] - 0s 33ms/step - loss: 0.8670 - acc: 0.7624
Epoch 6/30

8/8 [==============================] - 0s 34ms/step - loss: 0.9738 - acc: 0.6575
Epoch 7/30

8/8 [==============================] - 0s 33ms/step - loss: 0.7123 - acc: 0.8232
Epoch 8/30

8/8 [==============================] - 0s 34ms/step - loss: 0.5370 - acc: 0.8840
Epoch 9/30

8/8 [==============================] - 0s 34ms/step - loss: 0.4806 - acc: 0.9116
Epoch 10/30

8/8 [==============================] - 0s 34ms/step - loss: 0.4537 - acc: 0.8950
Epoch 11/30

8/8 [==============================] - 0s 33ms/step - loss: 0.3995 - acc: 0.9448
Epoch 12/30

8/8 [==============================] - 0s 32ms/step - loss: 0.3653 - acc: 0.9392
Epoch 13/30

8/8 [==============================] - 0s 33ms/step - loss: 0.3337 - acc: 0.9282
Epoch 14/30

8/8 [==============================] - 0s 35ms/step - loss: 0.3188 - acc: 0.9448
Epoch 15/30

8/8 [==============================] - 0s 33ms/step - loss: 0.2866 - acc: 0.9448
Epoch 16/30

8/8 [==============================] - 0s 32ms/step - loss: 0.2815 - acc: 0.9448
Epoch 17/30

8/8 [==============================] - 0s 33ms/step - loss: 0.2422 - acc: 0.9669
Epoch 18/30

8/8 [==============================] - 0s 34ms/step - loss: 0.2472 - acc: 0.9613
Epoch 19/30

8/8 [==============================] - 0s 33ms/step - loss: 0.2307 - acc: 0.9669
Epoch 20/30

8/8 [==============================] - 0s 33ms/step - loss: 0.1794 - acc: 0.9779
Epoch 21/30

8/8 [==============================] - 0s 33ms/step - loss: 0.1854 - acc: 0.9724
Epoch 22/30

8/8 [==============================] - 0s 33ms/step - loss: 0.1833 - acc: 0.9724
Epoch 23/30

8/8 [==============================] - 0s 34ms/step - loss: 0.1628 - acc: 0.9779
Epoch 24/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1497 - acc: 0.9890
Epoch 25/30

8/8 [==============================] - 0s 33ms/step - loss: 0.1365 - acc: 0.9890
Epoch 26/30

8/8 [==============================] - 0s 34ms/step - loss: 0.1283 - acc: 0.9779
Epoch 27/30

8/8 [==============================] - 0s 33ms/step - loss: 0.1369 - acc: 0.9890
Epoch 28/30

8/8 [==============================] - 0s 34ms/step - loss: 0.0989 - acc: 0.9890
Epoch 29/30

8/8 [==============================] - 0s 35ms/step - loss: 0.0987 - acc: 0.9890
Epoch 30/30

8/8 [==============================] - 0s 33ms/step - loss: 0.1006 - acc: 0.9945
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7048
False 2023
True percentage 0.776981589681
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.91      0.93      7318
      B-ORG       0.25      0.30      0.28       296
      I-ORG       0.14      0.40      0.21       151
      B-PER       0.33      0.31      0.32       438
      I-PER       0.28      0.28      0.28       214
      B-LOC       0.29      0.02      0.03       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.40      0.03      0.05       141
     I-MISC       0.28      0.11      0.16       154

avg / total       0.82      0.78      0.79      9071

F-1 Score (without O):
0.229153798641
