Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

1674/1674 [==============================] - 36s 21ms/step - loss: 0.3993 - acc: 0.8777
Epoch 2/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.2324 - acc: 0.9315
Epoch 3/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.1824 - acc: 0.9463
Epoch 4/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.1504 - acc: 0.9551
Epoch 5/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.1308 - acc: 0.9616
Epoch 6/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.1124 - acc: 0.9673
Epoch 7/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.1024 - acc: 0.9701
Epoch 8/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0908 - acc: 0.9739
Epoch 9/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0829 - acc: 0.9761
Epoch 10/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0762 - acc: 0.9784
Epoch 11/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0705 - acc: 0.9800
Epoch 12/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0658 - acc: 0.9816
Epoch 13/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0601 - acc: 0.9837
Epoch 14/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0556 - acc: 0.9848
Epoch 15/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0532 - acc: 0.9848
Epoch 16/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0488 - acc: 0.9860
Epoch 17/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0482 - acc: 0.9867
Epoch 18/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0447 - acc: 0.9871
Epoch 19/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0417 - acc: 0.9882
Epoch 20/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0402 - acc: 0.9889
Epoch 21/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0380 - acc: 0.9893
Epoch 22/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0377 - acc: 0.9892
Epoch 23/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0343 - acc: 0.9907
Epoch 24/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0325 - acc: 0.9910
Epoch 25/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0321 - acc: 0.9906
Epoch 26/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0295 - acc: 0.9921
Epoch 27/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0293 - acc: 0.9916
Epoch 28/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0298 - acc: 0.9917
Epoch 29/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0265 - acc: 0.9924
Epoch 30/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0271 - acc: 0.9925
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8278
False 793
True percentage 0.912578547018
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
      B-PER       0.92      0.84      0.88       438
      B-ORG       0.78      0.74      0.76       296
      I-ORG       0.65      0.62      0.63       151
      I-PER       0.93      0.67      0.78       214
      B-LOC       0.75      0.77      0.76       218
     B-MISC       0.44      0.34      0.39       141
      I-LOC       0.73      0.78      0.76       141
     I-MISC       0.53      0.48      0.50       154

avg / total       0.94      0.91      0.93      9071

F-1 Score (without O):
0.730367273813
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

1674/1674 [==============================] - 36s 21ms/step - loss: 0.4262 - acc: 0.8722
Epoch 2/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.2408 - acc: 0.9285
Epoch 3/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.1880 - acc: 0.9464
Epoch 4/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.1584 - acc: 0.9532
Epoch 5/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.1368 - acc: 0.9600
Epoch 6/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.1194 - acc: 0.9658
Epoch 7/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.1081 - acc: 0.9689
Epoch 8/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0950 - acc: 0.9729
Epoch 9/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0869 - acc: 0.9751
Epoch 10/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0797 - acc: 0.9769
Epoch 11/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0718 - acc: 0.9802
Epoch 12/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0690 - acc: 0.9802
Epoch 13/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0633 - acc: 0.9823
Epoch 14/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0582 - acc: 0.9838
Epoch 15/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0563 - acc: 0.9839
Epoch 16/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0526 - acc: 0.9852
Epoch 17/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0504 - acc: 0.9858
Epoch 18/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0471 - acc: 0.9869
Epoch 19/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0456 - acc: 0.9865
Epoch 20/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0420 - acc: 0.9886
Epoch 21/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0391 - acc: 0.9888
Epoch 22/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0387 - acc: 0.9888
Epoch 23/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0379 - acc: 0.9894
Epoch 24/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0337 - acc: 0.9906
Epoch 25/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0338 - acc: 0.9904
Epoch 26/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0312 - acc: 0.9914
Epoch 27/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0309 - acc: 0.9911
Epoch 28/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0288 - acc: 0.9918
Epoch 29/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0270 - acc: 0.9920
Epoch 30/30

1674/1674 [==============================] - 34s 21ms/step - loss: 0.0274 - acc: 0.9922
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8258
False 813
True percentage 0.910373718443
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
     B-MISC       0.43      0.33      0.37       141
     I-MISC       0.51      0.49      0.50       154
      B-ORG       0.76      0.73      0.75       296
      B-LOC       0.75      0.74      0.74       218
      B-PER       0.90      0.85      0.87       438
      I-PER       0.92      0.64      0.75       214
      I-ORG       0.66      0.59      0.62       151
      I-LOC       0.77      0.75      0.76       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.719545046393
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104767 unique words.
4763 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 244
OOV word occurences: in test 345
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6705152     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,817,282
Trainable params: 6,817,282
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

837/837 [==============================] - 18s 22ms/step - loss: 0.5498 - acc: 0.8308
Epoch 2/30

837/837 [==============================] - 17s 21ms/step - loss: 0.3240 - acc: 0.8997
Epoch 3/30

837/837 [==============================] - 17s 21ms/step - loss: 0.2571 - acc: 0.9238
Epoch 4/30

837/837 [==============================] - 17s 21ms/step - loss: 0.2144 - acc: 0.9377
Epoch 5/30

837/837 [==============================] - 17s 21ms/step - loss: 0.1827 - acc: 0.9472
Epoch 6/30

837/837 [==============================] - 17s 21ms/step - loss: 0.1661 - acc: 0.9535
Epoch 7/30

837/837 [==============================] - 17s 21ms/step - loss: 0.1478 - acc: 0.9582
Epoch 8/30

837/837 [==============================] - 17s 21ms/step - loss: 0.1335 - acc: 0.9637
Epoch 9/30

837/837 [==============================] - 17s 21ms/step - loss: 0.1195 - acc: 0.9672
Epoch 10/30

837/837 [==============================] - 17s 21ms/step - loss: 0.1082 - acc: 0.9704
Epoch 11/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0981 - acc: 0.9736
Epoch 12/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0901 - acc: 0.9759
Epoch 13/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0836 - acc: 0.9782
Epoch 14/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0763 - acc: 0.9808
Epoch 15/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0722 - acc: 0.9813
Epoch 16/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0690 - acc: 0.9816
Epoch 17/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0599 - acc: 0.9854
Epoch 18/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0601 - acc: 0.9851
Epoch 19/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0544 - acc: 0.9868
Epoch 20/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0512 - acc: 0.9869
Epoch 21/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0490 - acc: 0.9879
Epoch 22/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0436 - acc: 0.9889
Epoch 23/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0419 - acc: 0.9893
Epoch 24/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0392 - acc: 0.9908
Epoch 25/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0397 - acc: 0.9904
Epoch 26/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0357 - acc: 0.9917
Epoch 27/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0363 - acc: 0.9913
Epoch 28/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0334 - acc: 0.9923
Epoch 29/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0317 - acc: 0.9928
Epoch 30/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0297 - acc: 0.9929
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8222
False 849
True percentage 0.906405027009
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
      B-PER       0.91      0.83      0.87       438
      B-ORG       0.76      0.70      0.73       296
      I-ORG       0.68      0.51      0.58       151
      I-PER       0.85      0.63      0.72       214
      B-LOC       0.74      0.75      0.74       218
     B-MISC       0.50      0.40      0.45       141
      I-LOC       0.72      0.78      0.75       141
     I-MISC       0.51      0.51      0.51       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.713090257023
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104764 unique words.
4760 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 248
OOV word occurences: in test 387
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6704960     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,817,090
Trainable params: 6,817,090
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

837/837 [==============================] - 18s 22ms/step - loss: 0.5052 - acc: 0.8453
Epoch 2/30

837/837 [==============================] - 17s 21ms/step - loss: 0.2951 - acc: 0.9124
Epoch 3/30

837/837 [==============================] - 17s 21ms/step - loss: 0.2420 - acc: 0.9278
Epoch 4/30

837/837 [==============================] - 17s 21ms/step - loss: 0.1994 - acc: 0.9407
Epoch 5/30

837/837 [==============================] - 17s 21ms/step - loss: 0.1738 - acc: 0.9498
Epoch 6/30

837/837 [==============================] - 17s 21ms/step - loss: 0.1547 - acc: 0.9561
Epoch 7/30

837/837 [==============================] - 17s 21ms/step - loss: 0.1378 - acc: 0.9597
Epoch 8/30

837/837 [==============================] - 17s 21ms/step - loss: 0.1247 - acc: 0.9660
Epoch 9/30

837/837 [==============================] - 17s 21ms/step - loss: 0.1118 - acc: 0.9692
Epoch 10/30

837/837 [==============================] - 17s 21ms/step - loss: 0.1028 - acc: 0.9719
Epoch 11/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0927 - acc: 0.9738
Epoch 12/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0865 - acc: 0.9762
Epoch 13/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0796 - acc: 0.9791
Epoch 14/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0741 - acc: 0.9801
Epoch 15/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0683 - acc: 0.9823
Epoch 16/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0634 - acc: 0.9831
Epoch 17/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0604 - acc: 0.9843
Epoch 18/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0553 - acc: 0.9858
Epoch 19/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0531 - acc: 0.9863
Epoch 20/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0482 - acc: 0.9880
Epoch 21/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0468 - acc: 0.9883
Epoch 22/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0459 - acc: 0.9883
Epoch 23/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0419 - acc: 0.9887
Epoch 24/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0393 - acc: 0.9898
Epoch 25/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0377 - acc: 0.9902
Epoch 26/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0359 - acc: 0.9907
Epoch 27/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0342 - acc: 0.9917
Epoch 28/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0321 - acc: 0.9920
Epoch 29/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0307 - acc: 0.9924
Epoch 30/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0306 - acc: 0.9925
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8109
False 962
True percentage 0.893947745563
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
     B-MISC       0.37      0.30      0.33       141
     I-MISC       0.48      0.42      0.45       154
      B-ORG       0.70      0.64      0.67       296
      B-LOC       0.72      0.72      0.72       218
      B-PER       0.88      0.74      0.80       438
      I-PER       0.88      0.64      0.74       214
      I-ORG       0.50      0.50      0.50       151
      I-LOC       0.71      0.78      0.75       141

avg / total       0.93      0.89      0.91      9071

F-1 Score (without O):
0.662451068955
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104723 unique words.
4719 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 249
OOV word occurences: in test 356
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6702336     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,814,466
Trainable params: 6,814,466
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

837/837 [==============================] - 18s 22ms/step - loss: 0.5174 - acc: 0.8446
Epoch 2/30

837/837 [==============================] - 17s 21ms/step - loss: 0.3017 - acc: 0.9088
Epoch 3/30

837/837 [==============================] - 17s 21ms/step - loss: 0.2408 - acc: 0.9267
Epoch 4/30

837/837 [==============================] - 17s 21ms/step - loss: 0.2001 - acc: 0.9420
Epoch 5/30

837/837 [==============================] - 17s 21ms/step - loss: 0.1726 - acc: 0.9490
Epoch 6/30

837/837 [==============================] - 17s 21ms/step - loss: 0.1524 - acc: 0.9563
Epoch 7/30

837/837 [==============================] - 17s 21ms/step - loss: 0.1347 - acc: 0.9619
Epoch 8/30

837/837 [==============================] - 17s 21ms/step - loss: 0.1166 - acc: 0.9673
Epoch 9/30

837/837 [==============================] - 17s 21ms/step - loss: 0.1104 - acc: 0.9678
Epoch 10/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0988 - acc: 0.9729
Epoch 11/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0881 - acc: 0.9758
Epoch 12/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0817 - acc: 0.9779
Epoch 13/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0775 - acc: 0.9790
Epoch 14/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0720 - acc: 0.9814
Epoch 15/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0672 - acc: 0.9828
Epoch 16/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0606 - acc: 0.9844
Epoch 17/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0575 - acc: 0.9845
Epoch 18/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0537 - acc: 0.9862
Epoch 19/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0510 - acc: 0.9867
Epoch 20/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0473 - acc: 0.9869
Epoch 21/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0435 - acc: 0.9886
Epoch 22/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0433 - acc: 0.9889
Epoch 23/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0407 - acc: 0.9890
Epoch 24/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0378 - acc: 0.9900
Epoch 25/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0362 - acc: 0.9907
Epoch 26/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0345 - acc: 0.9907
Epoch 27/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0331 - acc: 0.9904
Epoch 28/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0328 - acc: 0.9913
Epoch 29/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0322 - acc: 0.9914
Epoch 30/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0281 - acc: 0.9922
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8187
False 884
True percentage 0.902546577004
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.89      0.81      0.85       438
      B-ORG       0.71      0.76      0.73       296
      I-ORG       0.52      0.64      0.58       151
     B-MISC       0.48      0.34      0.40       141
     I-MISC       0.57      0.38      0.46       154
      I-PER       0.88      0.63      0.74       214
      B-LOC       0.76      0.72      0.74       218
      I-LOC       0.78      0.74      0.76       141

avg / total       0.94      0.90      0.92      9071

F-1 Score (without O):
0.703847300925
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104352 unique words.
4348 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 266
OOV word occurences: in test 428
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678592     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,722
Trainable params: 6,790,722
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

334/334 [==============================] - 8s 24ms/step - loss: 0.6519 - acc: 0.8027
Epoch 2/30

334/334 [==============================] - 7s 20ms/step - loss: 0.3638 - acc: 0.8907
Epoch 3/30

334/334 [==============================] - 7s 20ms/step - loss: 0.2951 - acc: 0.9157
Epoch 4/30

334/334 [==============================] - 7s 20ms/step - loss: 0.2539 - acc: 0.9278
Epoch 5/30

334/334 [==============================] - 7s 20ms/step - loss: 0.2173 - acc: 0.9408
Epoch 6/30

334/334 [==============================] - 7s 20ms/step - loss: 0.1896 - acc: 0.9477
Epoch 7/30

334/334 [==============================] - 7s 21ms/step - loss: 0.1675 - acc: 0.9529
Epoch 8/30

334/334 [==============================] - 7s 20ms/step - loss: 0.1500 - acc: 0.9609
Epoch 9/30

334/334 [==============================] - 7s 20ms/step - loss: 0.1317 - acc: 0.9675
Epoch 10/30

334/334 [==============================] - 7s 20ms/step - loss: 0.1264 - acc: 0.9679
Epoch 11/30

334/334 [==============================] - 7s 21ms/step - loss: 0.1105 - acc: 0.9724
Epoch 12/30

334/334 [==============================] - 7s 21ms/step - loss: 0.1014 - acc: 0.9776
Epoch 13/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0932 - acc: 0.9775
Epoch 14/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0843 - acc: 0.9818
Epoch 15/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0799 - acc: 0.9811
Epoch 16/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0746 - acc: 0.9832
Epoch 17/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0652 - acc: 0.9851
Epoch 18/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0633 - acc: 0.9859
Epoch 19/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0574 - acc: 0.9882
Epoch 20/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0536 - acc: 0.9881
Epoch 21/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0521 - acc: 0.9885
Epoch 22/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0482 - acc: 0.9892
Epoch 23/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0466 - acc: 0.9881
Epoch 24/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0431 - acc: 0.9904
Epoch 25/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0407 - acc: 0.9930
Epoch 26/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0349 - acc: 0.9930
Epoch 27/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0365 - acc: 0.9942
Epoch 28/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0321 - acc: 0.9939
Epoch 29/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0317 - acc: 0.9941
Epoch 30/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0296 - acc: 0.9944
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8058
False 1013
True percentage 0.888325432698
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.86      0.76      0.81       438
      B-ORG       0.70      0.62      0.65       296
      I-ORG       0.53      0.49      0.51       151
      I-PER       0.89      0.58      0.71       214
      B-LOC       0.70      0.73      0.72       218
     B-MISC       0.37      0.18      0.25       141
      I-LOC       0.63      0.79      0.70       141
     I-MISC       0.51      0.25      0.34       154

avg / total       0.92      0.89      0.90      9071

F-1 Score (without O):
0.649133663366
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104348 unique words.
4344 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 262
OOV word occurences: in test 426
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678336     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,466
Trainable params: 6,790,466
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

334/334 [==============================] - 8s 24ms/step - loss: 0.6776 - acc: 0.7841
Epoch 2/30

334/334 [==============================] - 7s 20ms/step - loss: 0.4045 - acc: 0.8694
Epoch 3/30

334/334 [==============================] - 7s 21ms/step - loss: 0.3282 - acc: 0.8970
Epoch 4/30

334/334 [==============================] - 7s 21ms/step - loss: 0.2895 - acc: 0.9107
Epoch 5/30

334/334 [==============================] - 7s 21ms/step - loss: 0.2510 - acc: 0.9265
Epoch 6/30

334/334 [==============================] - 7s 21ms/step - loss: 0.2245 - acc: 0.9354
Epoch 7/30

334/334 [==============================] - 7s 21ms/step - loss: 0.2057 - acc: 0.9418
Epoch 8/30

334/334 [==============================] - 7s 21ms/step - loss: 0.1832 - acc: 0.9484
Epoch 9/30

334/334 [==============================] - 7s 21ms/step - loss: 0.1631 - acc: 0.9580
Epoch 10/30

334/334 [==============================] - 7s 21ms/step - loss: 0.1496 - acc: 0.9596
Epoch 11/30

334/334 [==============================] - 7s 21ms/step - loss: 0.1374 - acc: 0.9643
Epoch 12/30

334/334 [==============================] - 7s 21ms/step - loss: 0.1294 - acc: 0.9664
Epoch 13/30

334/334 [==============================] - 7s 21ms/step - loss: 0.1199 - acc: 0.9697
Epoch 14/30

334/334 [==============================] - 7s 21ms/step - loss: 0.1049 - acc: 0.9739
Epoch 15/30

334/334 [==============================] - 7s 21ms/step - loss: 0.1015 - acc: 0.9742
Epoch 16/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0933 - acc: 0.9759
Epoch 17/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0858 - acc: 0.9800
Epoch 18/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0790 - acc: 0.9797
Epoch 19/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0780 - acc: 0.9806
Epoch 20/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0661 - acc: 0.9834
Epoch 21/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0647 - acc: 0.9846
Epoch 22/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0600 - acc: 0.9851
Epoch 23/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0551 - acc: 0.9871
Epoch 24/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0540 - acc: 0.9877
Epoch 25/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0516 - acc: 0.9880
Epoch 26/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0484 - acc: 0.9897
Epoch 27/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0468 - acc: 0.9891
Epoch 28/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0439 - acc: 0.9915
Epoch 29/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0444 - acc: 0.9908
Epoch 30/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0405 - acc: 0.9908
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7966
False 1105
True percentage 0.878183221255
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.97      7318
     B-MISC       0.27      0.19      0.22       141
     I-MISC       0.44      0.34      0.39       154
      B-ORG       0.62      0.63      0.63       296
      B-LOC       0.64      0.67      0.65       218
      B-PER       0.87      0.69      0.77       438
      I-PER       0.87      0.57      0.69       214
      I-ORG       0.46      0.44      0.45       151
      I-LOC       0.63      0.79      0.70       141

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.61273769997
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104340 unique words.
4336 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 268
OOV word occurences: in test 411
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6677824     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,789,954
Trainable params: 6,789,954
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

334/334 [==============================] - 8s 24ms/step - loss: 0.6215 - acc: 0.8072
Epoch 2/30

334/334 [==============================] - 7s 20ms/step - loss: 0.3523 - acc: 0.8955
Epoch 3/30

334/334 [==============================] - 7s 21ms/step - loss: 0.2912 - acc: 0.9153
Epoch 4/30

334/334 [==============================] - 7s 21ms/step - loss: 0.2409 - acc: 0.9255
Epoch 5/30

334/334 [==============================] - 7s 21ms/step - loss: 0.2099 - acc: 0.9413
Epoch 6/30

334/334 [==============================] - 7s 21ms/step - loss: 0.1860 - acc: 0.9484
Epoch 7/30

334/334 [==============================] - 7s 21ms/step - loss: 0.1654 - acc: 0.9557
Epoch 8/30

334/334 [==============================] - 7s 21ms/step - loss: 0.1437 - acc: 0.9624
Epoch 9/30

334/334 [==============================] - 7s 21ms/step - loss: 0.1309 - acc: 0.9669
Epoch 10/30

334/334 [==============================] - 7s 21ms/step - loss: 0.1128 - acc: 0.9713
Epoch 11/30

334/334 [==============================] - 7s 20ms/step - loss: 0.1047 - acc: 0.9738
Epoch 12/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0986 - acc: 0.9760
Epoch 13/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0853 - acc: 0.9807
Epoch 14/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0820 - acc: 0.9814
Epoch 15/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0739 - acc: 0.9828
Epoch 16/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0661 - acc: 0.9853
Epoch 17/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0606 - acc: 0.9864
Epoch 18/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0569 - acc: 0.9886
Epoch 19/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0545 - acc: 0.9871
Epoch 20/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0485 - acc: 0.9896
Epoch 21/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0464 - acc: 0.9902
Epoch 22/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0428 - acc: 0.9919
Epoch 23/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0404 - acc: 0.9908
Epoch 24/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0384 - acc: 0.9916
Epoch 25/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0351 - acc: 0.9940
Epoch 26/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0356 - acc: 0.9923
Epoch 27/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0342 - acc: 0.9919
Epoch 28/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0313 - acc: 0.9940
Epoch 29/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0294 - acc: 0.9945
Epoch 30/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0284 - acc: 0.9944
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7957
False 1114
True percentage 0.877191048396
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-PER       0.86      0.72      0.78       438
      B-ORG       0.56      0.65      0.60       296
      I-ORG       0.30      0.44      0.36       151
     B-MISC       0.40      0.21      0.27       141
     I-MISC       0.40      0.23      0.29       154
      I-PER       0.89      0.58      0.70       214
      B-LOC       0.76      0.65      0.70       218
      I-LOC       0.74      0.62      0.67       141

avg / total       0.92      0.88      0.89      9071

F-1 Score (without O):
0.603773584906
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104194 unique words.
4190 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 275
OOV word occurences: in test 464
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6668480     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,780,610
Trainable params: 6,780,610
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

167/167 [==============================] - 5s 28ms/step - loss: 0.7719 - acc: 0.7582
Epoch 2/30

167/167 [==============================] - 3s 21ms/step - loss: 0.4190 - acc: 0.8689
Epoch 3/30

167/167 [==============================] - 3s 21ms/step - loss: 0.3501 - acc: 0.8933
Epoch 4/30

167/167 [==============================] - 3s 21ms/step - loss: 0.2974 - acc: 0.9134
Epoch 5/30

167/167 [==============================] - 3s 21ms/step - loss: 0.2767 - acc: 0.9153
Epoch 6/30

167/167 [==============================] - 3s 21ms/step - loss: 0.2463 - acc: 0.9278
Epoch 7/30

167/167 [==============================] - 3s 21ms/step - loss: 0.2209 - acc: 0.9361
Epoch 8/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1971 - acc: 0.9492
Epoch 9/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1818 - acc: 0.9519
Epoch 10/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1677 - acc: 0.9532
Epoch 11/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1515 - acc: 0.9633
Epoch 12/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1410 - acc: 0.9665
Epoch 13/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1281 - acc: 0.9700
Epoch 14/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1177 - acc: 0.9743
Epoch 15/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1122 - acc: 0.9762
Epoch 16/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0998 - acc: 0.9820
Epoch 17/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0953 - acc: 0.9817
Epoch 18/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0891 - acc: 0.9836
Epoch 19/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0832 - acc: 0.9850
Epoch 20/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0781 - acc: 0.9850
Epoch 21/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0699 - acc: 0.9871
Epoch 22/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0669 - acc: 0.9874
Epoch 23/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0676 - acc: 0.9874
Epoch 24/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0554 - acc: 0.9910
Epoch 25/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0573 - acc: 0.9910
Epoch 26/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0528 - acc: 0.9921
Epoch 27/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0523 - acc: 0.9923
Epoch 28/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0457 - acc: 0.9940
Epoch 29/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0412 - acc: 0.9942
Epoch 30/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0451 - acc: 0.9929
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7935
False 1136
True percentage 0.874765736964
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.96      0.96      7318
      B-PER       0.88      0.70      0.78       438
      B-ORG       0.60      0.62      0.61       296
      I-ORG       0.33      0.38      0.35       151
      I-PER       0.85      0.54      0.66       214
      B-LOC       0.80      0.60      0.68       218
     B-MISC       0.43      0.11      0.18       141
      I-LOC       0.72      0.60      0.65       141
     I-MISC       0.59      0.11      0.19       154

avg / total       0.91      0.87      0.89      9071

F-1 Score (without O):
0.593004249755
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104201 unique words.
4197 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 270
OOV word occurences: in test 452
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6668928     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,781,058
Trainable params: 6,781,058
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

167/167 [==============================] - 5s 28ms/step - loss: 0.8152 - acc: 0.7583
Epoch 2/30

167/167 [==============================] - 3s 21ms/step - loss: 0.4408 - acc: 0.8585
Epoch 3/30

167/167 [==============================] - 3s 21ms/step - loss: 0.3688 - acc: 0.8848
Epoch 4/30

167/167 [==============================] - 3s 21ms/step - loss: 0.3168 - acc: 0.9034
Epoch 5/30

167/167 [==============================] - 3s 21ms/step - loss: 0.2727 - acc: 0.9205
Epoch 6/30

167/167 [==============================] - 3s 21ms/step - loss: 0.2537 - acc: 0.9244
Epoch 7/30

167/167 [==============================] - 3s 21ms/step - loss: 0.2299 - acc: 0.9313
Epoch 8/30

167/167 [==============================] - 3s 21ms/step - loss: 0.2063 - acc: 0.9422
Epoch 9/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1916 - acc: 0.9484
Epoch 10/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1732 - acc: 0.9570
Epoch 11/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1552 - acc: 0.9603
Epoch 12/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1450 - acc: 0.9651
Epoch 13/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1312 - acc: 0.9670
Epoch 14/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1213 - acc: 0.9735
Epoch 15/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1120 - acc: 0.9755
Epoch 16/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1060 - acc: 0.9759
Epoch 17/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0989 - acc: 0.9771
Epoch 18/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0943 - acc: 0.9831
Epoch 19/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0883 - acc: 0.9808
Epoch 20/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0794 - acc: 0.9830
Epoch 21/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0728 - acc: 0.9856
Epoch 22/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0724 - acc: 0.9866
Epoch 23/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0644 - acc: 0.9904
Epoch 24/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0625 - acc: 0.9878
Epoch 25/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0545 - acc: 0.9919
Epoch 26/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0514 - acc: 0.9920
Epoch 27/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0510 - acc: 0.9919
Epoch 28/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0480 - acc: 0.9915
Epoch 29/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0453 - acc: 0.9939
Epoch 30/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0414 - acc: 0.9938
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7826
False 1245
True percentage 0.862749421232
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
     B-MISC       0.27      0.24      0.25       141
     I-MISC       0.28      0.20      0.24       154
      B-ORG       0.56      0.54      0.55       296
      B-LOC       0.73      0.61      0.67       218
      B-PER       0.82      0.61      0.70       438
      I-PER       0.77      0.57      0.66       214
      I-ORG       0.32      0.30      0.31       151
      I-LOC       0.57      0.70      0.63       141

avg / total       0.90      0.86      0.88      9071

F-1 Score (without O):
0.549200492005
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104185 unique words.
4181 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 272
OOV word occurences: in test 428
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6667904     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,780,034
Trainable params: 6,780,034
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

167/167 [==============================] - 5s 28ms/step - loss: 0.9215 - acc: 0.7463
Epoch 2/30

167/167 [==============================] - 3s 21ms/step - loss: 0.4716 - acc: 0.8482
Epoch 3/30

167/167 [==============================] - 3s 21ms/step - loss: 0.3843 - acc: 0.8814
Epoch 4/30

167/167 [==============================] - 3s 21ms/step - loss: 0.3422 - acc: 0.8962
Epoch 5/30

167/167 [==============================] - 3s 21ms/step - loss: 0.3071 - acc: 0.9027
Epoch 6/30

167/167 [==============================] - 3s 21ms/step - loss: 0.2773 - acc: 0.9200
Epoch 7/30

167/167 [==============================] - 3s 21ms/step - loss: 0.2432 - acc: 0.9320
Epoch 8/30

167/167 [==============================] - 3s 21ms/step - loss: 0.2248 - acc: 0.9384
Epoch 9/30

167/167 [==============================] - 3s 21ms/step - loss: 0.2023 - acc: 0.9437
Epoch 10/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1878 - acc: 0.9494
Epoch 11/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1738 - acc: 0.9544
Epoch 12/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1582 - acc: 0.9606
Epoch 13/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1516 - acc: 0.9627
Epoch 14/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1403 - acc: 0.9653
Epoch 15/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1284 - acc: 0.9708
Epoch 16/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1138 - acc: 0.9754
Epoch 17/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1121 - acc: 0.9765
Epoch 18/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1034 - acc: 0.9806
Epoch 19/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0963 - acc: 0.9807
Epoch 20/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0922 - acc: 0.9833
Epoch 21/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0834 - acc: 0.9860
Epoch 22/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0809 - acc: 0.9863
Epoch 23/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0739 - acc: 0.9873
Epoch 24/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0676 - acc: 0.9883
Epoch 25/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0684 - acc: 0.9892
Epoch 26/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0619 - acc: 0.9898
Epoch 27/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0580 - acc: 0.9919
Epoch 28/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0553 - acc: 0.9908
Epoch 29/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0540 - acc: 0.9925
Epoch 30/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0508 - acc: 0.9918
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7853
False 1218
True percentage 0.865725939808
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-PER       0.79      0.69      0.74       438
      B-ORG       0.54      0.58      0.56       296
      I-ORG       0.29      0.44      0.35       151
     B-MISC       0.24      0.09      0.12       141
     I-MISC       0.30      0.21      0.25       154
      I-PER       0.76      0.57      0.65       214
      B-LOC       0.70      0.62      0.66       218
      I-LOC       0.80      0.36      0.50       141

avg / total       0.90      0.87      0.88      9071

F-1 Score (without O):
0.547794117647
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104112 unique words.
4108 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 562
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663232     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,362
Trainable params: 6,775,362
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

83/83 [==============================] - 3s 37ms/step - loss: 1.2576 - acc: 0.6477
Epoch 2/30

83/83 [==============================] - 2s 21ms/step - loss: 0.5021 - acc: 0.8344
Epoch 3/30

83/83 [==============================] - 2s 21ms/step - loss: 0.4201 - acc: 0.8691
Epoch 4/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3642 - acc: 0.8963
Epoch 5/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3455 - acc: 0.9021
Epoch 6/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3118 - acc: 0.9144
Epoch 7/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2786 - acc: 0.9237
Epoch 8/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2680 - acc: 0.9247
Epoch 9/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2569 - acc: 0.9306
Epoch 10/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2293 - acc: 0.9410
Epoch 11/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2124 - acc: 0.9500
Epoch 12/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1937 - acc: 0.9515
Epoch 13/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1845 - acc: 0.9555
Epoch 14/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1686 - acc: 0.9586
Epoch 15/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1662 - acc: 0.9618
Epoch 16/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1489 - acc: 0.9656
Epoch 17/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1425 - acc: 0.9663
Epoch 18/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1361 - acc: 0.9689
Epoch 19/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1285 - acc: 0.9735
Epoch 20/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1195 - acc: 0.9761
Epoch 21/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1118 - acc: 0.9756
Epoch 22/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1055 - acc: 0.9769
Epoch 23/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1042 - acc: 0.9762
Epoch 24/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0987 - acc: 0.9778
Epoch 25/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0922 - acc: 0.9815
Epoch 26/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0867 - acc: 0.9821
Epoch 27/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0811 - acc: 0.9856
Epoch 28/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0770 - acc: 0.9851
Epoch 29/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0739 - acc: 0.9888
Epoch 30/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0707 - acc: 0.9885
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7666
False 1405
True percentage 0.845110792636
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.95      0.95      7318
      B-PER       0.74      0.53      0.62       438
      B-ORG       0.46      0.52      0.49       296
      I-ORG       0.24      0.30      0.27       151
      I-PER       0.76      0.36      0.49       214
      B-LOC       0.67      0.56      0.61       218
     B-MISC       0.68      0.12      0.20       141
      I-LOC       0.64      0.42      0.51       141
     I-MISC       0.60      0.14      0.22       154

avg / total       0.89      0.85      0.86      9071

F-1 Score (without O):
0.481456953642
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104118 unique words.
4114 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 276
OOV word occurences: in test 477
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663616     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,746
Trainable params: 6,775,746
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

83/83 [==============================] - 3s 37ms/step - loss: 1.0500 - acc: 0.6747
Epoch 2/30

83/83 [==============================] - 2s 21ms/step - loss: 0.4734 - acc: 0.8437
Epoch 3/30

83/83 [==============================] - 2s 21ms/step - loss: 0.4128 - acc: 0.8679
Epoch 4/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3721 - acc: 0.8799
Epoch 5/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3282 - acc: 0.8995
Epoch 6/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2915 - acc: 0.9144
Epoch 7/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2642 - acc: 0.9224
Epoch 8/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2486 - acc: 0.9283
Epoch 9/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2196 - acc: 0.9442
Epoch 10/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2161 - acc: 0.9492
Epoch 11/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1901 - acc: 0.9475
Epoch 12/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1778 - acc: 0.9535
Epoch 13/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1598 - acc: 0.9593
Epoch 14/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1524 - acc: 0.9605
Epoch 15/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1417 - acc: 0.9667
Epoch 16/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1317 - acc: 0.9723
Epoch 17/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1200 - acc: 0.9785
Epoch 18/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1232 - acc: 0.9745
Epoch 19/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1086 - acc: 0.9787
Epoch 20/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1011 - acc: 0.9813
Epoch 21/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0909 - acc: 0.9817
Epoch 22/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0893 - acc: 0.9843
Epoch 23/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0833 - acc: 0.9880
Epoch 24/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0736 - acc: 0.9869
Epoch 25/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0733 - acc: 0.9851
Epoch 26/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0621 - acc: 0.9970
Epoch 27/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0625 - acc: 0.9908
Epoch 28/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0633 - acc: 0.9909
Epoch 29/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0567 - acc: 0.9942
Epoch 30/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0554 - acc: 0.9919
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7671
False 1400
True percentage 0.84566199978
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.94      0.96      7318
     B-MISC       0.23      0.14      0.17       141
     I-MISC       0.30      0.14      0.19       154
      B-ORG       0.38      0.39      0.39       296
      B-LOC       0.72      0.58      0.64       218
      B-PER       0.76      0.58      0.66       438
      I-PER       0.77      0.45      0.57       214
      I-ORG       0.22      0.34      0.26       151
      I-LOC       0.63      0.53      0.58       141

avg / total       0.89      0.85      0.86      9071

F-1 Score (without O):
0.474703310431
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104114 unique words.
4110 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 276
OOV word occurences: in test 456
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663360     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,490
Trainable params: 6,775,490
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

83/83 [==============================] - 3s 37ms/step - loss: 1.3296 - acc: 0.6415
Epoch 2/30

83/83 [==============================] - 2s 21ms/step - loss: 0.6069 - acc: 0.8070
Epoch 3/30

83/83 [==============================] - 2s 21ms/step - loss: 0.5115 - acc: 0.8310
Epoch 4/30

83/83 [==============================] - 2s 21ms/step - loss: 0.4626 - acc: 0.8529
Epoch 5/30

83/83 [==============================] - 2s 21ms/step - loss: 0.4100 - acc: 0.8734
Epoch 6/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3733 - acc: 0.8896
Epoch 7/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3476 - acc: 0.8955
Epoch 8/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3304 - acc: 0.9054
Epoch 9/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3000 - acc: 0.9069
Epoch 10/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2759 - acc: 0.9202
Epoch 11/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2531 - acc: 0.9321
Epoch 12/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2468 - acc: 0.9334
Epoch 13/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2412 - acc: 0.9308
Epoch 14/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2075 - acc: 0.9505
Epoch 15/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2021 - acc: 0.9512
Epoch 16/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1861 - acc: 0.9547
Epoch 17/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1725 - acc: 0.9605
Epoch 18/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1643 - acc: 0.9665
Epoch 19/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1516 - acc: 0.9720
Epoch 20/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1502 - acc: 0.9682
Epoch 21/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1422 - acc: 0.9703
Epoch 22/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1323 - acc: 0.9776
Epoch 23/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1285 - acc: 0.9762
Epoch 24/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1196 - acc: 0.9777
Epoch 25/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1099 - acc: 0.9803
Epoch 26/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1021 - acc: 0.9827
Epoch 27/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1037 - acc: 0.9818
Epoch 28/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0944 - acc: 0.9863
Epoch 29/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0889 - acc: 0.9870
Epoch 30/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0842 - acc: 0.9866
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7762
False 1309
True percentage 0.855693969794
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.95      0.95      7318
      B-PER       0.81      0.62      0.70       438
      B-ORG       0.56      0.47      0.51       296
      I-ORG       0.30      0.13      0.18       151
     B-MISC       0.28      0.11      0.16       141
     I-MISC       0.31      0.31      0.31       154
      I-PER       0.70      0.50      0.58       214
      B-LOC       0.69      0.57      0.62       218
      I-LOC       0.75      0.44      0.55       141

avg / total       0.88      0.86      0.87      9071

F-1 Score (without O):
0.519326065411
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104134 unique words.
4130 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 280
OOV word occurences: in test 543
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6664640     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,776,770
Trainable params: 6,776,770
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

83/83 [==============================] - 3s 37ms/step - loss: 1.0949 - acc: 0.6617
Epoch 2/30

83/83 [==============================] - 2s 21ms/step - loss: 0.5159 - acc: 0.8470
Epoch 3/30

83/83 [==============================] - 2s 21ms/step - loss: 0.4541 - acc: 0.8689
Epoch 4/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3934 - acc: 0.8877
Epoch 5/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3472 - acc: 0.9048
Epoch 6/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3258 - acc: 0.9100
Epoch 7/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2781 - acc: 0.9269
Epoch 8/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2723 - acc: 0.9202
Epoch 9/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2386 - acc: 0.9387
Epoch 10/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2135 - acc: 0.9497
Epoch 11/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1980 - acc: 0.9527
Epoch 12/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1856 - acc: 0.9596
Epoch 13/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1637 - acc: 0.9611
Epoch 14/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1583 - acc: 0.9687
Epoch 15/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1331 - acc: 0.9704
Epoch 16/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1297 - acc: 0.9738
Epoch 17/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1310 - acc: 0.9728
Epoch 18/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1120 - acc: 0.9778
Epoch 19/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1114 - acc: 0.9812
Epoch 20/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1014 - acc: 0.9815
Epoch 21/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0963 - acc: 0.9848
Epoch 22/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0888 - acc: 0.9827
Epoch 23/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0888 - acc: 0.9845
Epoch 24/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0785 - acc: 0.9869
Epoch 25/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0782 - acc: 0.9851
Epoch 26/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0724 - acc: 0.9891
Epoch 27/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0707 - acc: 0.9898
Epoch 28/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0644 - acc: 0.9888
Epoch 29/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0604 - acc: 0.9915
Epoch 30/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0578 - acc: 0.9914
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7696
False 1375
True percentage 0.848418035498
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-ORG       0.54      0.53      0.54       296
      B-PER       0.76      0.46      0.57       438
      I-PER       0.58      0.43      0.49       214
      B-LOC       0.74      0.59      0.66       218
      I-LOC       0.72      0.57      0.64       141
      I-ORG       0.21      0.38      0.27       151
     B-MISC       0.26      0.21      0.23       141
     I-MISC       0.41      0.17      0.24       154

avg / total       0.90      0.85      0.87      9071

F-1 Score (without O):
0.482371294852
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104069 unique words.
4065 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660480     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,610
Trainable params: 6,772,610
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

33/33 [==============================] - 2s 62ms/step - loss: 2.0426 - acc: 0.4271
Epoch 2/30

33/33 [==============================] - 1s 23ms/step - loss: 0.5261 - acc: 0.8760
Epoch 3/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3585 - acc: 0.8863
Epoch 4/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3376 - acc: 0.8837
Epoch 5/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2758 - acc: 0.9079
Epoch 6/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2809 - acc: 0.9111
Epoch 7/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2290 - acc: 0.9353
Epoch 8/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2272 - acc: 0.9254
Epoch 9/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2006 - acc: 0.9475
Epoch 10/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1786 - acc: 0.9541
Epoch 11/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1695 - acc: 0.9441
Epoch 12/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1661 - acc: 0.9571
Epoch 13/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1628 - acc: 0.9563
Epoch 14/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1527 - acc: 0.9530
Epoch 15/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1454 - acc: 0.9660
Epoch 16/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1412 - acc: 0.9649
Epoch 17/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1559 - acc: 0.9572
Epoch 18/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1307 - acc: 0.9682
Epoch 19/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1302 - acc: 0.9665
Epoch 20/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1260 - acc: 0.9737
Epoch 21/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1106 - acc: 0.9755
Epoch 22/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1076 - acc: 0.9751
Epoch 23/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1029 - acc: 0.9757
Epoch 24/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1006 - acc: 0.9707
Epoch 25/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1029 - acc: 0.9800
Epoch 26/30

33/33 [==============================] - 1s 23ms/step - loss: 0.0958 - acc: 0.9754
Epoch 27/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1012 - acc: 0.9714
Epoch 28/30

33/33 [==============================] - 1s 23ms/step - loss: 0.0929 - acc: 0.9845
Epoch 29/30

33/33 [==============================] - 1s 23ms/step - loss: 0.0911 - acc: 0.9747
Epoch 30/30

33/33 [==============================] - 1s 23ms/step - loss: 0.0821 - acc: 0.9840
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7201
False 1870
True percentage 0.793848528277
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.93      0.93      7318
      B-PER       0.49      0.32      0.39       438
      B-ORG       0.27      0.44      0.33       296
      I-ORG       0.14      0.25      0.17       151
      I-PER       0.48      0.16      0.24       214
      B-LOC       0.62      0.13      0.21       218
     B-MISC       0.00      0.00      0.00       141
      I-LOC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.81      0.79      0.80      9071

F-1 Score (without O):
0.254033642293
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104068 unique words.
4064 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 279
OOV word occurences: in test 482
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660416     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,546
Trainable params: 6,772,546
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

33/33 [==============================] - 2s 62ms/step - loss: 1.5175 - acc: 0.5118
Epoch 2/30

33/33 [==============================] - 1s 23ms/step - loss: 0.6553 - acc: 0.8156
Epoch 3/30

33/33 [==============================] - 1s 23ms/step - loss: 0.6153 - acc: 0.8077
Epoch 4/30

33/33 [==============================] - 1s 23ms/step - loss: 0.5096 - acc: 0.8230
Epoch 5/30

33/33 [==============================] - 1s 23ms/step - loss: 0.4808 - acc: 0.8220
Epoch 6/30

33/33 [==============================] - 1s 23ms/step - loss: 0.4438 - acc: 0.8461
Epoch 7/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3972 - acc: 0.8586
Epoch 8/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3524 - acc: 0.8866
Epoch 9/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3680 - acc: 0.8887
Epoch 10/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3379 - acc: 0.9018
Epoch 11/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3345 - acc: 0.8846
Epoch 12/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2844 - acc: 0.9210
Epoch 13/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2955 - acc: 0.9142
Epoch 14/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2590 - acc: 0.9435
Epoch 15/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2831 - acc: 0.9253
Epoch 16/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2579 - acc: 0.9318
Epoch 17/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2452 - acc: 0.9420
Epoch 18/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2399 - acc: 0.9321
Epoch 19/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2087 - acc: 0.9630
Epoch 20/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1987 - acc: 0.9637
Epoch 21/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1994 - acc: 0.9604
Epoch 22/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2143 - acc: 0.9374
Epoch 23/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1789 - acc: 0.9677
Epoch 24/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1670 - acc: 0.9729
Epoch 25/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1737 - acc: 0.9633
Epoch 26/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1759 - acc: 0.9509
Epoch 27/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2233 - acc: 0.9417
Epoch 28/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1477 - acc: 0.9808
Epoch 29/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1449 - acc: 0.9637
Epoch 30/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1558 - acc: 0.9600
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7478
False 1593
True percentage 0.824385404035
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.94      0.95      7318
     B-MISC       0.16      0.04      0.07       141
     I-MISC       0.16      0.03      0.05       154
      B-ORG       0.42      0.34      0.38       296
      B-LOC       0.48      0.66      0.56       218
      B-PER       0.74      0.47      0.57       438
      I-PER       0.77      0.27      0.40       214
      I-ORG       0.14      0.34      0.20       151
      I-LOC       0.80      0.03      0.05       141

avg / total       0.87      0.82      0.83      9071

F-1 Score (without O):
0.371040723982
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104062 unique words.
4058 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 281
OOV word occurences: in test 473
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660032     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,162
Trainable params: 6,772,162
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

33/33 [==============================] - 2s 62ms/step - loss: 1.8651 - acc: 0.4341
Epoch 2/30

33/33 [==============================] - 1s 23ms/step - loss: 0.6818 - acc: 0.8157
Epoch 3/30

33/33 [==============================] - 1s 23ms/step - loss: 0.4946 - acc: 0.8399
Epoch 4/30

33/33 [==============================] - 1s 23ms/step - loss: 0.4597 - acc: 0.8442
Epoch 5/30

33/33 [==============================] - 1s 23ms/step - loss: 0.4017 - acc: 0.8671
Epoch 6/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3697 - acc: 0.8842
Epoch 7/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3372 - acc: 0.8940
Epoch 8/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3231 - acc: 0.8925
Epoch 9/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3045 - acc: 0.9063
Epoch 10/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2698 - acc: 0.9146
Epoch 11/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2544 - acc: 0.9312
Epoch 12/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2475 - acc: 0.9298
Epoch 13/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2367 - acc: 0.9479
Epoch 14/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2165 - acc: 0.9506
Epoch 15/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2279 - acc: 0.9396
Epoch 16/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1945 - acc: 0.9550
Epoch 17/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1942 - acc: 0.9522
Epoch 18/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1759 - acc: 0.9651
Epoch 19/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1795 - acc: 0.9699
Epoch 20/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1639 - acc: 0.9688
Epoch 21/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1533 - acc: 0.9708
Epoch 22/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1553 - acc: 0.9660
Epoch 23/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1368 - acc: 0.9831
Epoch 24/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1246 - acc: 0.9847
Epoch 25/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1700 - acc: 0.9543
Epoch 26/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1332 - acc: 0.9811
Epoch 27/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1163 - acc: 0.9859
Epoch 28/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1048 - acc: 0.9846
Epoch 29/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1174 - acc: 0.9856
Epoch 30/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1094 - acc: 0.9897
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7532
False 1539
True percentage 0.830338441186
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.93      0.95      7318
      B-PER       0.77      0.48      0.60       438
      B-ORG       0.35      0.54      0.42       296
      I-ORG       0.17      0.30      0.22       151
     B-MISC       0.32      0.16      0.21       141
     I-MISC       0.27      0.35      0.31       154
      I-PER       0.63      0.50      0.55       214
      B-LOC       0.70      0.40      0.51       218
      I-LOC       1.00      0.05      0.09       141

avg / total       0.89      0.83      0.85      9071

F-1 Score (without O):
0.418632788869
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104087 unique words.
4083 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 553
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6661632     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,773,762
Trainable params: 6,773,762
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

33/33 [==============================] - 2s 65ms/step - loss: 1.9282 - acc: 0.4063
Epoch 2/30

33/33 [==============================] - 1s 23ms/step - loss: 0.8832 - acc: 0.7735
Epoch 3/30

33/33 [==============================] - 1s 23ms/step - loss: 0.6356 - acc: 0.7940
Epoch 4/30

33/33 [==============================] - 1s 23ms/step - loss: 0.5743 - acc: 0.8219
Epoch 5/30

33/33 [==============================] - 1s 23ms/step - loss: 0.5753 - acc: 0.8193
Epoch 6/30

33/33 [==============================] - 1s 23ms/step - loss: 0.4971 - acc: 0.8329
Epoch 7/30

33/33 [==============================] - 1s 23ms/step - loss: 0.4552 - acc: 0.8432
Epoch 8/30

33/33 [==============================] - 1s 23ms/step - loss: 0.4498 - acc: 0.8906
Epoch 9/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3676 - acc: 0.8952
Epoch 10/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3626 - acc: 0.8919
Epoch 11/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3458 - acc: 0.9032
Epoch 12/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3256 - acc: 0.9136
Epoch 13/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3122 - acc: 0.9177
Epoch 14/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3031 - acc: 0.9218
Epoch 15/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3017 - acc: 0.9127
Epoch 16/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2683 - acc: 0.9290
Epoch 17/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2554 - acc: 0.9415
Epoch 18/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2587 - acc: 0.9525
Epoch 19/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2335 - acc: 0.9481
Epoch 20/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2236 - acc: 0.9438
Epoch 21/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2284 - acc: 0.9527
Epoch 22/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2054 - acc: 0.9618
Epoch 23/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1924 - acc: 0.9707
Epoch 24/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1977 - acc: 0.9554
Epoch 25/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1745 - acc: 0.9756
Epoch 26/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1942 - acc: 0.9623
Epoch 27/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1778 - acc: 0.9685
Epoch 28/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1617 - acc: 0.9821
Epoch 29/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1519 - acc: 0.9764
Epoch 30/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1506 - acc: 0.9820
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7423
False 1648
True percentage 0.818322125455
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.94      0.95      7318
      B-ORG       0.42      0.51      0.46       296
      B-PER       0.61      0.24      0.35       438
      I-PER       0.53      0.14      0.23       214
      B-LOC       0.45      0.45      0.45       218
      I-LOC       0.43      0.54      0.48       141
      I-ORG       0.16      0.26      0.20       151
     B-MISC       0.33      0.06      0.11       141
     I-MISC       0.46      0.18      0.25       154

avg / total       0.86      0.82      0.83      9071

F-1 Score (without O):
0.349381912817
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 7 unique labels.
Found 104057 unique words.
4053 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659712     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 8)        1112        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,544
Trainable params: 6,771,544
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

16/16 [==============================] - 2s 101ms/step - loss: 2.2670 - acc: 0.0983
Epoch 2/30

16/16 [==============================] - 0s 20ms/step - loss: 0.7822 - acc: 0.8287
Epoch 3/30

16/16 [==============================] - 0s 20ms/step - loss: 0.4995 - acc: 0.8371
Epoch 4/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3943 - acc: 0.8708
Epoch 5/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3415 - acc: 0.8596
Epoch 6/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3394 - acc: 0.9298
Epoch 7/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2615 - acc: 0.9045
Epoch 8/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2418 - acc: 0.9494
Epoch 9/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2068 - acc: 0.9522
Epoch 10/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2006 - acc: 0.9663
Epoch 11/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1846 - acc: 0.9607
Epoch 12/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1714 - acc: 0.9691
Epoch 13/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1512 - acc: 0.9719
Epoch 14/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1345 - acc: 0.9888
Epoch 15/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1407 - acc: 0.9691
Epoch 16/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1267 - acc: 0.9888
Epoch 17/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1198 - acc: 0.9719
Epoch 18/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1074 - acc: 0.9860
Epoch 19/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1063 - acc: 0.9775
Epoch 20/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1077 - acc: 0.9860
Epoch 21/30

16/16 [==============================] - 0s 20ms/step - loss: 0.0912 - acc: 0.9831
Epoch 22/30

16/16 [==============================] - 0s 20ms/step - loss: 0.0863 - acc: 0.9860
Epoch 23/30

16/16 [==============================] - 0s 20ms/step - loss: 0.0780 - acc: 0.9888
Epoch 24/30

16/16 [==============================] - 0s 20ms/step - loss: 0.0794 - acc: 0.9888
Epoch 25/30

16/16 [==============================] - 0s 20ms/step - loss: 0.0771 - acc: 0.9860
Epoch 26/30

16/16 [==============================] - 0s 20ms/step - loss: 0.0729 - acc: 0.9888
Epoch 27/30

16/16 [==============================] - 0s 20ms/step - loss: 0.0727 - acc: 0.9860
Epoch 28/30

16/16 [==============================] - 0s 20ms/step - loss: 0.0691 - acc: 0.9888
Epoch 29/30

16/16 [==============================] - 0s 20ms/step - loss: 0.0651 - acc: 0.9916
Epoch 30/30

16/16 [==============================] - 0s 20ms/step - loss: 0.0657 - acc: 0.9888
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7181
False 1595
True percentage 0.818254329991
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.93      0.94      7318
      B-PER       0.52      0.29      0.37       438
      B-ORG       0.23      0.42      0.30       296
      I-ORG       0.12      0.32      0.17       151
      I-PER       0.41      0.31      0.35       214
      B-LOC       0.00      0.00      0.00       218
     B-MISC       0.00      0.00      0.00       141

avg / total       0.84      0.82      0.83      8776

F-1 Score (without O):
0.259378349411
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104057 unique words.
4053 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 281
OOV word occurences: in test 492
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659712     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,842
Trainable params: 6,771,842
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

16/16 [==============================] - 2s 103ms/step - loss: 2.3299 - acc: 0.1507
Epoch 2/30

16/16 [==============================] - 0s 20ms/step - loss: 0.8902 - acc: 0.7863
Epoch 3/30

16/16 [==============================] - 0s 20ms/step - loss: 0.6709 - acc: 0.7890
Epoch 4/30

16/16 [==============================] - 0s 20ms/step - loss: 0.6853 - acc: 0.8356
Epoch 5/30

16/16 [==============================] - 0s 20ms/step - loss: 0.7666 - acc: 0.7890
Epoch 6/30

16/16 [==============================] - 0s 20ms/step - loss: 0.5347 - acc: 0.8493
Epoch 7/30

16/16 [==============================] - 0s 20ms/step - loss: 0.4504 - acc: 0.8521
Epoch 8/30

16/16 [==============================] - 0s 20ms/step - loss: 0.4092 - acc: 0.8712
Epoch 9/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3815 - acc: 0.8822
Epoch 10/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3477 - acc: 0.9096
Epoch 11/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3300 - acc: 0.9014
Epoch 12/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3063 - acc: 0.9178
Epoch 13/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2823 - acc: 0.9288
Epoch 14/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2616 - acc: 0.9370
Epoch 15/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2474 - acc: 0.9589
Epoch 16/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2353 - acc: 0.9370
Epoch 17/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2193 - acc: 0.9699
Epoch 18/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2128 - acc: 0.9671
Epoch 19/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1984 - acc: 0.9699
Epoch 20/30

16/16 [==============================] - 0s 21ms/step - loss: 0.1908 - acc: 0.9644
Epoch 21/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1768 - acc: 0.9699
Epoch 22/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1682 - acc: 0.9808
Epoch 23/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1730 - acc: 0.9699
Epoch 24/30

16/16 [==============================] - 0s 21ms/step - loss: 0.1582 - acc: 0.9863
Epoch 25/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1493 - acc: 0.9753
Epoch 26/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1422 - acc: 0.9836
Epoch 27/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1338 - acc: 0.9918
Epoch 28/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1221 - acc: 0.9945
Epoch 29/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1252 - acc: 0.9890
Epoch 30/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1073 - acc: 0.9945
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7160
False 1911
True percentage 0.789328629699
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.93      0.94      7318
     B-MISC       0.10      0.19      0.14       141
     I-MISC       0.11      0.08      0.09       154
      B-ORG       0.23      0.36      0.28       296
      B-LOC       0.82      0.24      0.37       218
      B-PER       0.75      0.20      0.32       438
      I-PER       0.45      0.15      0.23       214
      I-ORG       0.13      0.35      0.19       151
      I-LOC       0.00      0.00      0.00       141

avg / total       0.85      0.79      0.81      9071

F-1 Score (without O):
0.229064039409
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104046 unique words.
4042 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659008     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,138
Trainable params: 6,771,138
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

16/16 [==============================] - 2s 101ms/step - loss: 2.5894 - acc: 0.0353
Epoch 2/30

16/16 [==============================] - 0s 20ms/step - loss: 1.0783 - acc: 0.8029
Epoch 3/30

16/16 [==============================] - 0s 20ms/step - loss: 0.7032 - acc: 0.8265
Epoch 4/30

16/16 [==============================] - 0s 20ms/step - loss: 0.6766 - acc: 0.8471
Epoch 5/30

16/16 [==============================] - 0s 21ms/step - loss: 0.7591 - acc: 0.8265
Epoch 6/30

16/16 [==============================] - 0s 21ms/step - loss: 0.5335 - acc: 0.8500
Epoch 7/30

16/16 [==============================] - 0s 20ms/step - loss: 0.4573 - acc: 0.8500
Epoch 8/30

16/16 [==============================] - 0s 21ms/step - loss: 0.4249 - acc: 0.8765
Epoch 9/30

16/16 [==============================] - 0s 21ms/step - loss: 0.3703 - acc: 0.8735
Epoch 10/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3516 - acc: 0.9000
Epoch 11/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3288 - acc: 0.8853
Epoch 12/30

16/16 [==============================] - 0s 21ms/step - loss: 0.3157 - acc: 0.9147
Epoch 13/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3079 - acc: 0.8941
Epoch 14/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2868 - acc: 0.9147
Epoch 15/30

16/16 [==============================] - 0s 21ms/step - loss: 0.2757 - acc: 0.9088
Epoch 16/30

16/16 [==============================] - 0s 21ms/step - loss: 0.2572 - acc: 0.9353
Epoch 17/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2343 - acc: 0.9382
Epoch 18/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2318 - acc: 0.9412
Epoch 19/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2130 - acc: 0.9500
Epoch 20/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2074 - acc: 0.9529
Epoch 21/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1786 - acc: 0.9618
Epoch 22/30

16/16 [==============================] - 0s 21ms/step - loss: 0.1848 - acc: 0.9559
Epoch 23/30

16/16 [==============================] - 0s 21ms/step - loss: 0.1692 - acc: 0.9794
Epoch 24/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1546 - acc: 0.9794
Epoch 25/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1502 - acc: 0.9765
Epoch 26/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1391 - acc: 0.9735
Epoch 27/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1389 - acc: 0.9824
Epoch 28/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1228 - acc: 0.9853
Epoch 29/30

16/16 [==============================] - 0s 21ms/step - loss: 0.1191 - acc: 0.9853
Epoch 30/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1172 - acc: 0.9853
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7226
False 1845
True percentage 0.796604563995
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.94      0.93      7318
      B-PER       0.36      0.31      0.33       438
      B-ORG       0.32      0.38      0.35       296
      I-ORG       0.10      0.04      0.06       151
     B-MISC       0.17      0.01      0.01       141
     I-MISC       0.00      0.00      0.00       154
      I-PER       0.25      0.24      0.25       214
      B-LOC       0.55      0.27      0.36       218
      I-LOC       1.00      0.02      0.04       141

avg / total       0.82      0.80      0.80      9071

F-1 Score (without O):
0.256624825662
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104060 unique words.
4056 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 567
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659904     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,034
Trainable params: 6,772,034
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

16/16 [==============================] - 2s 101ms/step - loss: 2.4543 - acc: 0.0570
Epoch 2/30

16/16 [==============================] - 0s 20ms/step - loss: 1.0219 - acc: 0.8100
Epoch 3/30

16/16 [==============================] - 0s 20ms/step - loss: 0.7323 - acc: 0.7696
Epoch 4/30

16/16 [==============================] - 0s 20ms/step - loss: 0.7780 - acc: 0.7933
Epoch 5/30

16/16 [==============================] - 0s 20ms/step - loss: 0.6049 - acc: 0.7886
Epoch 6/30

16/16 [==============================] - 0s 20ms/step - loss: 0.5076 - acc: 0.8694
Epoch 7/30

16/16 [==============================] - 0s 20ms/step - loss: 0.4361 - acc: 0.8812
Epoch 8/30

16/16 [==============================] - 0s 21ms/step - loss: 0.4025 - acc: 0.8979
Epoch 9/30

16/16 [==============================] - 0s 21ms/step - loss: 0.3871 - acc: 0.8979
Epoch 10/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3544 - acc: 0.9097
Epoch 11/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3291 - acc: 0.9264
Epoch 12/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2928 - acc: 0.9216
Epoch 13/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2783 - acc: 0.9359
Epoch 14/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2591 - acc: 0.9382
Epoch 15/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2381 - acc: 0.9406
Epoch 16/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2299 - acc: 0.9501
Epoch 17/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2084 - acc: 0.9596
Epoch 18/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1999 - acc: 0.9525
Epoch 19/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1860 - acc: 0.9620
Epoch 20/30

16/16 [==============================] - 0s 21ms/step - loss: 0.1700 - acc: 0.9667
Epoch 21/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1739 - acc: 0.9620
Epoch 22/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1577 - acc: 0.9786
Epoch 23/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1466 - acc: 0.9786
Epoch 24/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1478 - acc: 0.9739
Epoch 25/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1396 - acc: 0.9762
Epoch 26/30

16/16 [==============================] - 0s 21ms/step - loss: 0.1275 - acc: 0.9881
Epoch 27/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1192 - acc: 0.9905
Epoch 28/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1077 - acc: 0.9905
Epoch 29/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1017 - acc: 0.9881
Epoch 30/30

16/16 [==============================] - 0s 20ms/step - loss: 0.0959 - acc: 0.9952
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7278
False 1793
True percentage 0.802337118289
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.94      0.95      7318
      B-ORG       0.33      0.37      0.35       296
      B-PER       0.40      0.27      0.32       438
      I-PER       0.42      0.28      0.34       214
      B-LOC       0.53      0.38      0.44       218
      I-LOC       0.22      0.04      0.07       141
      I-ORG       0.10      0.18      0.13       151
     B-MISC       0.18      0.12      0.14       141
     I-MISC       0.33      0.01      0.01       154

avg / total       0.84      0.80      0.81      9071

F-1 Score (without O):
0.27399934917
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 6 unique labels.
Found 104044 unique words.
4040 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658880     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 7)        966         bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,566
Trainable params: 6,770,566
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

8/8 [==============================] - 1s 185ms/step - loss: 1.7370 - acc: 0.2707
Epoch 2/30

8/8 [==============================] - 0s 24ms/step - loss: 0.5617 - acc: 0.8729
Epoch 3/30

8/8 [==============================] - 0s 24ms/step - loss: 0.4787 - acc: 0.8785
Epoch 4/30

8/8 [==============================] - 0s 24ms/step - loss: 0.4306 - acc: 0.8729
Epoch 5/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3084 - acc: 0.9061
Epoch 6/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2483 - acc: 0.9006
Epoch 7/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2026 - acc: 0.9503
Epoch 8/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1833 - acc: 0.9503
Epoch 9/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1549 - acc: 0.9669
Epoch 10/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1298 - acc: 0.9724
Epoch 11/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1143 - acc: 0.9834
Epoch 12/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0952 - acc: 0.9834
Epoch 13/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0839 - acc: 0.9890
Epoch 14/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0753 - acc: 0.9890
Epoch 15/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0671 - acc: 0.9890
Epoch 16/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0643 - acc: 0.9890
Epoch 17/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0532 - acc: 0.9945
Epoch 18/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0549 - acc: 0.9945
Epoch 19/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0451 - acc: 0.9945
Epoch 20/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0398 - acc: 0.9945
Epoch 21/30

8/8 [==============================] - 0s 23ms/step - loss: 0.0470 - acc: 0.9945
Epoch 22/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0418 - acc: 0.9945
Epoch 23/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0382 - acc: 0.9945
Epoch 24/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0318 - acc: 1.0000
Epoch 25/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0333 - acc: 1.0000
Epoch 26/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0261 - acc: 1.0000
Epoch 27/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0311 - acc: 1.0000
Epoch 28/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0219 - acc: 1.0000
Epoch 29/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0200 - acc: 1.0000
Epoch 30/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0228 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7120
False 1515
True percentage 0.824551244933
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.92      0.93      7318
      B-PER       0.26      0.48      0.33       438
      B-ORG       0.37      0.29      0.33       296
      I-ORG       0.13      0.05      0.07       151
      I-PER       0.34      0.33      0.33       214
      B-LOC       0.00      0.00      0.00       218

avg / total       0.83      0.82      0.83      8635

F-1 Score (without O):
0.283542379323
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 8 unique labels.
Found 104049 unique words.
4045 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 500
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659200     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,180
Trainable params: 6,771,180
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

8/8 [==============================] - 2s 188ms/step - loss: 2.6776 - acc: 0.0435
Epoch 2/30

8/8 [==============================] - 0s 24ms/step - loss: 0.8770 - acc: 0.8261
Epoch 3/30

8/8 [==============================] - 0s 24ms/step - loss: 0.5866 - acc: 0.8261
Epoch 4/30

8/8 [==============================] - 0s 24ms/step - loss: 0.5172 - acc: 0.8967
Epoch 5/30

8/8 [==============================] - 0s 24ms/step - loss: 0.4153 - acc: 0.8478
Epoch 6/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3259 - acc: 0.9130
Epoch 7/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2958 - acc: 0.9130
Epoch 8/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2827 - acc: 0.9239
Epoch 9/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2501 - acc: 0.9402
Epoch 10/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2227 - acc: 0.9511
Epoch 11/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1980 - acc: 0.9565
Epoch 12/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1896 - acc: 0.9674
Epoch 13/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1767 - acc: 0.9620
Epoch 14/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1586 - acc: 0.9783
Epoch 15/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1571 - acc: 0.9620
Epoch 16/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1365 - acc: 0.9837
Epoch 17/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1385 - acc: 0.9837
Epoch 18/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1236 - acc: 0.9837
Epoch 19/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1163 - acc: 0.9891
Epoch 20/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1175 - acc: 0.9837
Epoch 21/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1074 - acc: 0.9891
Epoch 22/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0997 - acc: 0.9837
Epoch 23/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0977 - acc: 0.9946
Epoch 24/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0872 - acc: 0.9946
Epoch 25/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0810 - acc: 0.9946
Epoch 26/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0816 - acc: 0.9891
Epoch 27/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0714 - acc: 0.9946
Epoch 28/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0760 - acc: 0.9891
Epoch 29/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0713 - acc: 0.9946
Epoch 30/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0705 - acc: 0.9946
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7002
False 1928
True percentage 0.784098544233
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.93      0.93      7318
     B-MISC       0.12      0.21      0.16       141
     I-MISC       0.12      0.05      0.07       154
      B-ORG       0.16      0.24      0.19       296
      B-LOC       0.00      0.00      0.00       218
      B-PER       0.76      0.19      0.30       438
      I-PER       0.50      0.00      0.01       214
      I-ORG       0.08      0.27      0.12       151

avg / total       0.83      0.78      0.79      8930

F-1 Score (without O):
0.154976619906
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104041 unique words.
4037 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658688     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,818
Trainable params: 6,770,818
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

8/8 [==============================] - 1s 185ms/step - loss: 2.1010 - acc: 0.1098
Epoch 2/30

8/8 [==============================] - 0s 24ms/step - loss: 0.8258 - acc: 0.8208
Epoch 3/30

8/8 [==============================] - 0s 24ms/step - loss: 0.6276 - acc: 0.8150
Epoch 4/30

8/8 [==============================] - 0s 24ms/step - loss: 0.5772 - acc: 0.8208
Epoch 5/30

8/8 [==============================] - 0s 24ms/step - loss: 0.5804 - acc: 0.8728
Epoch 6/30

8/8 [==============================] - 0s 24ms/step - loss: 0.5000 - acc: 0.8208
Epoch 7/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3899 - acc: 0.9075
Epoch 8/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3298 - acc: 0.9017
Epoch 9/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2786 - acc: 0.9133
Epoch 10/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2673 - acc: 0.9306
Epoch 11/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2514 - acc: 0.9306
Epoch 12/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2314 - acc: 0.9480
Epoch 13/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2097 - acc: 0.9595
Epoch 14/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1896 - acc: 0.9538
Epoch 15/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1905 - acc: 0.9480
Epoch 16/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1699 - acc: 0.9595
Epoch 17/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1656 - acc: 0.9769
Epoch 18/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1517 - acc: 0.9769
Epoch 19/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1355 - acc: 0.9653
Epoch 20/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1408 - acc: 0.9827
Epoch 21/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1104 - acc: 0.9942
Epoch 22/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1074 - acc: 0.9827
Epoch 23/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1108 - acc: 0.9884
Epoch 24/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0970 - acc: 0.9942
Epoch 25/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0892 - acc: 0.9942
Epoch 26/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0845 - acc: 1.0000
Epoch 27/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0707 - acc: 1.0000
Epoch 28/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0719 - acc: 1.0000
Epoch 29/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0625 - acc: 1.0000
Epoch 30/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0686 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7116
False 1955
True percentage 0.784478006835
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.91      0.93      0.92      7318
      B-PER       0.33      0.23      0.27       438
      B-ORG       0.27      0.39      0.32       296
      I-ORG       0.00      0.00      0.00       151
     B-MISC       0.22      0.10      0.14       141
     I-MISC       0.16      0.06      0.09       154
      I-PER       0.32      0.18      0.23       214
      B-LOC       0.31      0.04      0.07       218
      I-LOC       0.64      0.05      0.09       141

avg / total       0.79      0.78      0.78      9071

F-1 Score (without O):
0.212536023055
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104044 unique words.
4040 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 567
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658880     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,010
Trainable params: 6,771,010
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

8/8 [==============================] - 1s 186ms/step - loss: 2.6943 - acc: 0.0110
Epoch 2/30

8/8 [==============================] - 0s 24ms/step - loss: 1.3974 - acc: 0.6961
Epoch 3/30

8/8 [==============================] - 0s 24ms/step - loss: 0.9261 - acc: 0.7348
Epoch 4/30

8/8 [==============================] - 0s 24ms/step - loss: 0.7324 - acc: 0.7293
Epoch 5/30

8/8 [==============================] - 0s 24ms/step - loss: 0.6426 - acc: 0.8674
Epoch 6/30

8/8 [==============================] - 0s 24ms/step - loss: 0.7638 - acc: 0.7293
Epoch 7/30

8/8 [==============================] - 0s 24ms/step - loss: 0.6989 - acc: 0.8508
Epoch 8/30

8/8 [==============================] - 0s 24ms/step - loss: 0.4831 - acc: 0.8729
Epoch 9/30

8/8 [==============================] - 0s 24ms/step - loss: 0.4005 - acc: 0.9227
Epoch 10/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3824 - acc: 0.9282
Epoch 11/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3584 - acc: 0.9116
Epoch 12/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2948 - acc: 0.9337
Epoch 13/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2997 - acc: 0.9448
Epoch 14/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2683 - acc: 0.9392
Epoch 15/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2472 - acc: 0.9392
Epoch 16/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2337 - acc: 0.9503
Epoch 17/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2164 - acc: 0.9669
Epoch 18/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1963 - acc: 0.9724
Epoch 19/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1923 - acc: 0.9558
Epoch 20/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1790 - acc: 0.9724
Epoch 21/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1518 - acc: 0.9945
Epoch 22/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1391 - acc: 0.9945
Epoch 23/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1445 - acc: 0.9669
Epoch 24/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1304 - acc: 1.0000
Epoch 25/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1140 - acc: 1.0000
Epoch 26/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1061 - acc: 1.0000
Epoch 27/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0987 - acc: 1.0000
Epoch 28/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1078 - acc: 0.9890
Epoch 29/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0899 - acc: 1.0000
Epoch 30/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0952 - acc: 0.9890
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7372
False 1699
True percentage 0.81269981259
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.95      0.94      7318
      B-ORG       0.43      0.30      0.35       296
      B-PER       0.48      0.45      0.46       438
      I-PER       0.34      0.23      0.28       214
      B-LOC       0.51      0.36      0.42       218
      I-LOC       0.25      0.01      0.01       141
      I-ORG       0.13      0.13      0.13       151
     B-MISC       0.44      0.05      0.09       141
     I-MISC       0.40      0.03      0.05       154

avg / total       0.83      0.81      0.81      9071

F-1 Score (without O):
0.311267605634
