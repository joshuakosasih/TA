Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 84s 50ms/step - loss: 0.4162 - acc: 0.8702
Epoch 2/28

1674/1674 [==============================] - 81s 48ms/step - loss: 0.2491 - acc: 0.9245
Epoch 3/28

1674/1674 [==============================] - 80s 48ms/step - loss: 0.1911 - acc: 0.9444
Epoch 4/28

1674/1674 [==============================] - 81s 48ms/step - loss: 0.1594 - acc: 0.9539
Epoch 5/28

1674/1674 [==============================] - 80s 48ms/step - loss: 0.1395 - acc: 0.9582
Epoch 6/28

1674/1674 [==============================] - 80s 47ms/step - loss: 0.1196 - acc: 0.9641
Epoch 7/28

1674/1674 [==============================] - 80s 48ms/step - loss: 0.1070 - acc: 0.9686
Epoch 8/28

1674/1674 [==============================] - 80s 48ms/step - loss: 0.0962 - acc: 0.9724
Epoch 9/28

1674/1674 [==============================] - 80s 47ms/step - loss: 0.0880 - acc: 0.9748
Epoch 10/28

1674/1674 [==============================] - 81s 48ms/step - loss: 0.0801 - acc: 0.9772
Epoch 11/28

1674/1674 [==============================] - 80s 48ms/step - loss: 0.0743 - acc: 0.9788
Epoch 12/28

1674/1674 [==============================] - 80s 48ms/step - loss: 0.0680 - acc: 0.9808
Epoch 13/28

1674/1674 [==============================] - 80s 48ms/step - loss: 0.0629 - acc: 0.9819
Epoch 14/28

1674/1674 [==============================] - 80s 48ms/step - loss: 0.0590 - acc: 0.9835
Epoch 15/28

1674/1674 [==============================] - 80s 48ms/step - loss: 0.0556 - acc: 0.9844
Epoch 16/28

1674/1674 [==============================] - 80s 48ms/step - loss: 0.0520 - acc: 0.9861
Epoch 17/28

1674/1674 [==============================] - 80s 48ms/step - loss: 0.0467 - acc: 0.9869
Epoch 18/28

1674/1674 [==============================] - 80s 48ms/step - loss: 0.0438 - acc: 0.9877
Epoch 19/28

1674/1674 [==============================] - 80s 48ms/step - loss: 0.0436 - acc: 0.9882
Epoch 20/28

1674/1674 [==============================] - 80s 48ms/step - loss: 0.0435 - acc: 0.9876
Epoch 21/28

1674/1674 [==============================] - 80s 48ms/step - loss: 0.0392 - acc: 0.9889
Epoch 22/28

1674/1674 [==============================] - 80s 48ms/step - loss: 0.0378 - acc: 0.9902
Epoch 23/28

1674/1674 [==============================] - 80s 48ms/step - loss: 0.0366 - acc: 0.9897
Epoch 24/28

1674/1674 [==============================] - 80s 48ms/step - loss: 0.0366 - acc: 0.9894
Epoch 25/28

1674/1674 [==============================] - 80s 48ms/step - loss: 0.0328 - acc: 0.9908
Epoch 26/28

1674/1674 [==============================] - 80s 48ms/step - loss: 0.0323 - acc: 0.9908
Epoch 27/28

1674/1674 [==============================] - 80s 48ms/step - loss: 0.0308 - acc: 0.9911
Epoch 28/28

1674/1674 [==============================] - 80s 48ms/step - loss: 0.0302 - acc: 0.9915
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8254
False 817
True percentage 0.909932752728
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.92      0.85      0.88       438
      B-ORG       0.73      0.74      0.74       296
      I-ORG       0.61      0.62      0.61       151
      I-PER       0.90      0.66      0.76       214
      B-LOC       0.78      0.73      0.76       218
     B-MISC       0.40      0.30      0.35       141
      I-LOC       0.75      0.81      0.78       141
     I-MISC       0.54      0.40      0.46       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.718086696562
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 83s 50ms/step - loss: 0.3856 - acc: 0.8808
Epoch 2/28

1674/1674 [==============================] - 80s 48ms/step - loss: 0.2264 - acc: 0.9303
Epoch 3/28

1674/1674 [==============================] - 80s 48ms/step - loss: 0.1789 - acc: 0.9461
Epoch 4/28

1674/1674 [==============================] - 80s 48ms/step - loss: 0.1500 - acc: 0.9554
Epoch 5/28

1674/1674 [==============================] - 79s 47ms/step - loss: 0.1275 - acc: 0.9623
Epoch 6/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.1101 - acc: 0.9685
Epoch 7/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.1016 - acc: 0.9711
Epoch 8/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0888 - acc: 0.9738
Epoch 9/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0817 - acc: 0.9767
Epoch 10/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0739 - acc: 0.9795
Epoch 11/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0682 - acc: 0.9807
Epoch 12/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0619 - acc: 0.9825
Epoch 13/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0572 - acc: 0.9838
Epoch 14/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0554 - acc: 0.9842
Epoch 15/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0506 - acc: 0.9857
Epoch 16/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0474 - acc: 0.9868
Epoch 17/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0442 - acc: 0.9874
Epoch 18/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0432 - acc: 0.9877
Epoch 19/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0411 - acc: 0.9885
Epoch 20/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0384 - acc: 0.9894
Epoch 21/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0363 - acc: 0.9901
Epoch 22/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0354 - acc: 0.9901
Epoch 23/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0327 - acc: 0.9909
Epoch 24/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0335 - acc: 0.9908
Epoch 25/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0308 - acc: 0.9914
Epoch 26/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0296 - acc: 0.9916
Epoch 27/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0273 - acc: 0.9925
Epoch 28/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0280 - acc: 0.9920
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8247
False 824
True percentage 0.909161062727
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.89      0.83      0.86       438
      B-ORG       0.75      0.73      0.74       296
      I-ORG       0.61      0.60      0.60       151
     B-MISC       0.42      0.32      0.36       141
     I-MISC       0.54      0.44      0.49       154
      I-PER       0.90      0.66      0.76       214
      B-LOC       0.77      0.73      0.75       218
      I-LOC       0.78      0.77      0.77       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.715827338129
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 82s 49ms/step - loss: 0.3842 - acc: 0.8832
Epoch 2/28

1674/1674 [==============================] - 80s 48ms/step - loss: 0.2281 - acc: 0.9311
Epoch 3/28

1674/1674 [==============================] - 80s 48ms/step - loss: 0.1840 - acc: 0.9445
Epoch 4/28

1674/1674 [==============================] - 80s 48ms/step - loss: 0.1551 - acc: 0.9542
Epoch 5/28

1674/1674 [==============================] - 79s 47ms/step - loss: 0.1336 - acc: 0.9603
Epoch 6/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.1162 - acc: 0.9658
Epoch 7/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.1028 - acc: 0.9700
Epoch 8/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0932 - acc: 0.9732
Epoch 9/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0845 - acc: 0.9761
Epoch 10/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0783 - acc: 0.9774
Epoch 11/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0712 - acc: 0.9800
Epoch 12/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0645 - acc: 0.9826
Epoch 13/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0601 - acc: 0.9829
Epoch 14/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0571 - acc: 0.9848
Epoch 15/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0526 - acc: 0.9860
Epoch 16/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0492 - acc: 0.9859
Epoch 17/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0479 - acc: 0.9867
Epoch 18/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0443 - acc: 0.9877
Epoch 19/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0413 - acc: 0.9884
Epoch 20/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0394 - acc: 0.9889
Epoch 21/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0368 - acc: 0.9896
Epoch 22/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0350 - acc: 0.9903
Epoch 23/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0359 - acc: 0.9902
Epoch 24/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0329 - acc: 0.9910
Epoch 25/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0307 - acc: 0.9912
Epoch 26/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0312 - acc: 0.9912
Epoch 27/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0287 - acc: 0.9922
Epoch 28/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0272 - acc: 0.9923
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8253
False 818
True percentage 0.9098225113
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.79      0.73      0.76       296
      B-PER       0.91      0.82      0.86       438
      I-PER       0.88      0.63      0.74       214
      B-LOC       0.76      0.74      0.75       218
      I-LOC       0.79      0.78      0.79       141
      I-ORG       0.67      0.67      0.67       151
     B-MISC       0.39      0.32      0.35       141
     I-MISC       0.50      0.45      0.47       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.720288115246
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 83s 49ms/step - loss: 0.4375 - acc: 0.8625
Epoch 2/28

1674/1674 [==============================] - 81s 48ms/step - loss: 0.2577 - acc: 0.9214
Epoch 3/28

1674/1674 [==============================] - 80s 48ms/step - loss: 0.2027 - acc: 0.9398
Epoch 4/28

1674/1674 [==============================] - 81s 48ms/step - loss: 0.1671 - acc: 0.9508
Epoch 5/28

1674/1674 [==============================] - 81s 48ms/step - loss: 0.1440 - acc: 0.9582
Epoch 6/28

1674/1674 [==============================] - 81s 48ms/step - loss: 0.1261 - acc: 0.9644
Epoch 7/28

1674/1674 [==============================] - 81s 48ms/step - loss: 0.1091 - acc: 0.9684
Epoch 8/28

1674/1674 [==============================] - 81s 48ms/step - loss: 0.1003 - acc: 0.9722
Epoch 9/28

1674/1674 [==============================] - 81s 48ms/step - loss: 0.0883 - acc: 0.9752
Epoch 10/28

1674/1674 [==============================] - 81s 48ms/step - loss: 0.0822 - acc: 0.9769
Epoch 11/28

1674/1674 [==============================] - 80s 48ms/step - loss: 0.0756 - acc: 0.9789
Epoch 12/28

1674/1674 [==============================] - 80s 48ms/step - loss: 0.0695 - acc: 0.9806
Epoch 13/28

1674/1674 [==============================] - 79s 47ms/step - loss: 0.0656 - acc: 0.9808
Epoch 14/28

1674/1674 [==============================] - 79s 47ms/step - loss: 0.0600 - acc: 0.9830
Epoch 15/28

1674/1674 [==============================] - 78s 46ms/step - loss: 0.0567 - acc: 0.9835
Epoch 16/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0534 - acc: 0.9852
Epoch 17/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0506 - acc: 0.9860
Epoch 18/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0481 - acc: 0.9866
Epoch 19/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0453 - acc: 0.9873
Epoch 20/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0421 - acc: 0.9881
Epoch 21/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0416 - acc: 0.9880
Epoch 22/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0388 - acc: 0.9888
Epoch 23/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0380 - acc: 0.9894
Epoch 24/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0367 - acc: 0.9898
Epoch 25/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0333 - acc: 0.9901
Epoch 26/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0337 - acc: 0.9902
Epoch 27/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0327 - acc: 0.9907
Epoch 28/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0295 - acc: 0.9913
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8254
False 817
True percentage 0.909932752728
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
     B-MISC       0.41      0.34      0.37       141
     I-MISC       0.49      0.44      0.46       154
      B-ORG       0.75      0.74      0.75       296
      B-LOC       0.78      0.77      0.78       218
      B-PER       0.91      0.83      0.87       438
      I-PER       0.90      0.65      0.76       214
      I-ORG       0.59      0.62      0.60       151
      I-LOC       0.77      0.77      0.77       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.718055143789
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 84s 50ms/step - loss: 0.4172 - acc: 0.8727
Epoch 2/28

1674/1674 [==============================] - 80s 48ms/step - loss: 0.2459 - acc: 0.9267
Epoch 3/28

1674/1674 [==============================] - 80s 48ms/step - loss: 0.1952 - acc: 0.9403
Epoch 4/28

1674/1674 [==============================] - 80s 48ms/step - loss: 0.1620 - acc: 0.9519
Epoch 5/28

1674/1674 [==============================] - 80s 48ms/step - loss: 0.1398 - acc: 0.9594
Epoch 6/28

1674/1674 [==============================] - 79s 47ms/step - loss: 0.1226 - acc: 0.9656
Epoch 7/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.1096 - acc: 0.9686
Epoch 8/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0975 - acc: 0.9721
Epoch 9/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0873 - acc: 0.9757
Epoch 10/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0824 - acc: 0.9769
Epoch 11/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0729 - acc: 0.9794
Epoch 12/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0686 - acc: 0.9813
Epoch 13/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0653 - acc: 0.9823
Epoch 14/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0606 - acc: 0.9833
Epoch 15/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0565 - acc: 0.9842
Epoch 16/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0530 - acc: 0.9850
Epoch 17/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0502 - acc: 0.9862
Epoch 18/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0478 - acc: 0.9865
Epoch 19/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0437 - acc: 0.9884
Epoch 20/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0429 - acc: 0.9872
Epoch 21/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0404 - acc: 0.9885
Epoch 22/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0377 - acc: 0.9898
Epoch 23/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0353 - acc: 0.9901
Epoch 24/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0352 - acc: 0.9898
Epoch 25/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0329 - acc: 0.9904
Epoch 26/28

1674/1674 [==============================] - 77s 46ms/step - loss: 0.0324 - acc: 0.9906
Epoch 27/28

1674/1674 [==============================] - 76s 46ms/step - loss: 0.0306 - acc: 0.9912
Epoch 28/28

1674/1674 [==============================] - 76s 45ms/step - loss: 0.0286 - acc: 0.9922
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8271
False 800
True percentage 0.911806857017
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.92      0.84      0.88       438
      I-PER       0.91      0.64      0.75       214
          O       0.98      0.96      0.97      7318
      B-ORG       0.75      0.74      0.75       296
      B-LOC       0.77      0.74      0.76       218
      I-ORG       0.67      0.68      0.67       151
      I-LOC       0.74      0.79      0.77       141
     B-MISC       0.43      0.35      0.39       141
     I-MISC       0.54      0.43      0.48       154

avg / total       0.94      0.91      0.93      9071

F-1 Score (without O):
0.930194231901
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104767 unique words.
4763 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 244
OOV word occurences: in test 345
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6705152     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,817,282
Trainable params: 6,817,282
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 43s 51ms/step - loss: 0.5132 - acc: 0.8440
Epoch 2/28

837/837 [==============================] - 40s 48ms/step - loss: 0.2941 - acc: 0.9115
Epoch 3/28

837/837 [==============================] - 40s 48ms/step - loss: 0.2345 - acc: 0.9310
Epoch 4/28

837/837 [==============================] - 40s 48ms/step - loss: 0.1995 - acc: 0.9404
Epoch 5/28

837/837 [==============================] - 40s 47ms/step - loss: 0.1751 - acc: 0.9480
Epoch 6/28

837/837 [==============================] - 40s 48ms/step - loss: 0.1545 - acc: 0.9553
Epoch 7/28

837/837 [==============================] - 40s 47ms/step - loss: 0.1371 - acc: 0.9603
Epoch 8/28

837/837 [==============================] - 39s 46ms/step - loss: 0.1198 - acc: 0.9664
Epoch 9/28

837/837 [==============================] - 38s 46ms/step - loss: 0.1085 - acc: 0.9699
Epoch 10/28

837/837 [==============================] - 38s 46ms/step - loss: 0.1001 - acc: 0.9723
Epoch 11/28

837/837 [==============================] - 38s 46ms/step - loss: 0.0896 - acc: 0.9756
Epoch 12/28

837/837 [==============================] - 38s 46ms/step - loss: 0.0840 - acc: 0.9768
Epoch 13/28

837/837 [==============================] - 38s 46ms/step - loss: 0.0757 - acc: 0.9795
Epoch 14/28

837/837 [==============================] - 38s 46ms/step - loss: 0.0712 - acc: 0.9814
Epoch 15/28

837/837 [==============================] - 38s 46ms/step - loss: 0.0662 - acc: 0.9825
Epoch 16/28

837/837 [==============================] - 38s 46ms/step - loss: 0.0617 - acc: 0.9848
Epoch 17/28

837/837 [==============================] - 38s 46ms/step - loss: 0.0561 - acc: 0.9853
Epoch 18/28

837/837 [==============================] - 38s 46ms/step - loss: 0.0539 - acc: 0.9864
Epoch 19/28

837/837 [==============================] - 38s 46ms/step - loss: 0.0491 - acc: 0.9878
Epoch 20/28

837/837 [==============================] - 38s 46ms/step - loss: 0.0475 - acc: 0.9888
Epoch 21/28

837/837 [==============================] - 38s 46ms/step - loss: 0.0449 - acc: 0.9887
Epoch 22/28

837/837 [==============================] - 38s 46ms/step - loss: 0.0442 - acc: 0.9896
Epoch 23/28

837/837 [==============================] - 38s 46ms/step - loss: 0.0390 - acc: 0.9907
Epoch 24/28

837/837 [==============================] - 38s 46ms/step - loss: 0.0387 - acc: 0.9909
Epoch 25/28

837/837 [==============================] - 38s 46ms/step - loss: 0.0371 - acc: 0.9909
Epoch 26/28

837/837 [==============================] - 38s 46ms/step - loss: 0.0348 - acc: 0.9921
Epoch 27/28

837/837 [==============================] - 38s 46ms/step - loss: 0.0323 - acc: 0.9919
Epoch 28/28

837/837 [==============================] - 38s 46ms/step - loss: 0.0300 - acc: 0.9923
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8182
False 889
True percentage 0.90199536986
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.91      0.81      0.86       438
      B-ORG       0.76      0.67      0.71       296
      I-ORG       0.61      0.45      0.52       151
      I-PER       0.85      0.63      0.72       214
      B-LOC       0.72      0.75      0.73       218
     B-MISC       0.43      0.35      0.39       141
      I-LOC       0.73      0.79      0.76       141
     I-MISC       0.43      0.41      0.42       154

avg / total       0.93      0.90      0.92      9071

F-1 Score (without O):
0.689821806101
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104723 unique words.
4719 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 249
OOV word occurences: in test 356
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6702336     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,814,466
Trainable params: 6,814,466
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 44s 52ms/step - loss: 0.4904 - acc: 0.8433
Epoch 2/28

837/837 [==============================] - 41s 49ms/step - loss: 0.2996 - acc: 0.9077
Epoch 3/28

837/837 [==============================] - 41s 49ms/step - loss: 0.2413 - acc: 0.9264
Epoch 4/28

837/837 [==============================] - 41s 49ms/step - loss: 0.2058 - acc: 0.9387
Epoch 5/28

837/837 [==============================] - 41s 49ms/step - loss: 0.1801 - acc: 0.9479
Epoch 6/28

837/837 [==============================] - 41s 49ms/step - loss: 0.1564 - acc: 0.9563
Epoch 7/28

837/837 [==============================] - 41s 49ms/step - loss: 0.1406 - acc: 0.9616
Epoch 8/28

837/837 [==============================] - 41s 49ms/step - loss: 0.1250 - acc: 0.9664
Epoch 9/28

837/837 [==============================] - 41s 49ms/step - loss: 0.1113 - acc: 0.9693
Epoch 10/28

837/837 [==============================] - 41s 49ms/step - loss: 0.1036 - acc: 0.9726
Epoch 11/28

837/837 [==============================] - 41s 49ms/step - loss: 0.0939 - acc: 0.9737
Epoch 12/28

837/837 [==============================] - 40s 48ms/step - loss: 0.0866 - acc: 0.9771
Epoch 13/28

837/837 [==============================] - 41s 49ms/step - loss: 0.0815 - acc: 0.9780
Epoch 14/28

837/837 [==============================] - 41s 48ms/step - loss: 0.0759 - acc: 0.9804
Epoch 15/28

837/837 [==============================] - 40s 48ms/step - loss: 0.0676 - acc: 0.9818
Epoch 16/28

837/837 [==============================] - 40s 48ms/step - loss: 0.0641 - acc: 0.9835
Epoch 17/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0599 - acc: 0.9837
Epoch 18/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0571 - acc: 0.9846
Epoch 19/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0533 - acc: 0.9862
Epoch 20/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0529 - acc: 0.9856
Epoch 21/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0488 - acc: 0.9873
Epoch 22/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0438 - acc: 0.9888
Epoch 23/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0416 - acc: 0.9895
Epoch 24/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0389 - acc: 0.9905
Epoch 25/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0391 - acc: 0.9900
Epoch 26/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0376 - acc: 0.9901
Epoch 27/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0352 - acc: 0.9909
Epoch 28/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0339 - acc: 0.9917
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8211
False 860
True percentage 0.905192371293
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.91      0.80      0.85       438
      B-ORG       0.72      0.78      0.75       296
      I-ORG       0.55      0.66      0.60       151
     B-MISC       0.54      0.29      0.38       141
     I-MISC       0.57      0.38      0.46       154
      I-PER       0.86      0.64      0.73       214
      B-LOC       0.74      0.73      0.74       218
      I-LOC       0.77      0.76      0.76       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.709735576923
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104715 unique words.
4711 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 248
OOV word occurences: in test 352
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6701824     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,813,954
Trainable params: 6,813,954
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 43s 52ms/step - loss: 0.5204 - acc: 0.8387
Epoch 2/28

837/837 [==============================] - 41s 49ms/step - loss: 0.3203 - acc: 0.9010
Epoch 3/28

837/837 [==============================] - 41s 49ms/step - loss: 0.2562 - acc: 0.9237
Epoch 4/28

837/837 [==============================] - 41s 49ms/step - loss: 0.2132 - acc: 0.9370
Epoch 5/28

837/837 [==============================] - 41s 49ms/step - loss: 0.1796 - acc: 0.9477
Epoch 6/28

837/837 [==============================] - 41s 49ms/step - loss: 0.1557 - acc: 0.9562
Epoch 7/28

837/837 [==============================] - 41s 49ms/step - loss: 0.1353 - acc: 0.9616
Epoch 8/28

837/837 [==============================] - 41s 49ms/step - loss: 0.1236 - acc: 0.9656
Epoch 9/28

837/837 [==============================] - 41s 49ms/step - loss: 0.1099 - acc: 0.9695
Epoch 10/28

837/837 [==============================] - 41s 49ms/step - loss: 0.0974 - acc: 0.9732
Epoch 11/28

837/837 [==============================] - 41s 49ms/step - loss: 0.0905 - acc: 0.9743
Epoch 12/28

837/837 [==============================] - 41s 49ms/step - loss: 0.0803 - acc: 0.9778
Epoch 13/28

837/837 [==============================] - 41s 49ms/step - loss: 0.0740 - acc: 0.9806
Epoch 14/28

837/837 [==============================] - 41s 49ms/step - loss: 0.0688 - acc: 0.9818
Epoch 15/28

837/837 [==============================] - 41s 49ms/step - loss: 0.0634 - acc: 0.9836
Epoch 16/28

837/837 [==============================] - 41s 49ms/step - loss: 0.0598 - acc: 0.9839
Epoch 17/28

837/837 [==============================] - 41s 49ms/step - loss: 0.0538 - acc: 0.9859
Epoch 18/28

837/837 [==============================] - 40s 48ms/step - loss: 0.0520 - acc: 0.9846
Epoch 19/28

837/837 [==============================] - 40s 48ms/step - loss: 0.0473 - acc: 0.9882
Epoch 20/28

837/837 [==============================] - 40s 48ms/step - loss: 0.0453 - acc: 0.9882
Epoch 21/28

837/837 [==============================] - 40s 48ms/step - loss: 0.0409 - acc: 0.9889
Epoch 22/28

837/837 [==============================] - 40s 48ms/step - loss: 0.0381 - acc: 0.9907
Epoch 23/28

837/837 [==============================] - 40s 48ms/step - loss: 0.0382 - acc: 0.9895
Epoch 24/28

837/837 [==============================] - 40s 48ms/step - loss: 0.0364 - acc: 0.9900
Epoch 25/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0363 - acc: 0.9905
Epoch 26/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0338 - acc: 0.9913
Epoch 27/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0301 - acc: 0.9923
Epoch 28/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0289 - acc: 0.9927
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8174
False 897
True percentage 0.90111343843
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.72      0.71      0.71       296
      B-PER       0.88      0.79      0.83       438
      I-PER       0.89      0.61      0.72       214
      B-LOC       0.77      0.72      0.74       218
      I-LOC       0.78      0.76      0.77       141
      I-ORG       0.55      0.56      0.55       151
     B-MISC       0.40      0.28      0.33       141
     I-MISC       0.50      0.43      0.46       154

avg / total       0.93      0.90      0.92      9071

F-1 Score (without O):
0.687027517387
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104764 unique words.
4760 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 248
OOV word occurences: in test 387
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6704960     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,817,090
Trainable params: 6,817,090
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 43s 51ms/step - loss: 0.4866 - acc: 0.8484
Epoch 2/28

837/837 [==============================] - 41s 48ms/step - loss: 0.2961 - acc: 0.9102
Epoch 3/28

837/837 [==============================] - 40s 48ms/step - loss: 0.2308 - acc: 0.9291
Epoch 4/28

837/837 [==============================] - 40s 48ms/step - loss: 0.1970 - acc: 0.9412
Epoch 5/28

837/837 [==============================] - 40s 48ms/step - loss: 0.1716 - acc: 0.9509
Epoch 6/28

837/837 [==============================] - 40s 48ms/step - loss: 0.1478 - acc: 0.9585
Epoch 7/28

837/837 [==============================] - 40s 48ms/step - loss: 0.1333 - acc: 0.9631
Epoch 8/28

837/837 [==============================] - 39s 47ms/step - loss: 0.1195 - acc: 0.9679
Epoch 9/28

837/837 [==============================] - 39s 46ms/step - loss: 0.1080 - acc: 0.9705
Epoch 10/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0951 - acc: 0.9758
Epoch 11/28

837/837 [==============================] - 38s 46ms/step - loss: 0.0885 - acc: 0.9756
Epoch 12/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0809 - acc: 0.9786
Epoch 13/28

837/837 [==============================] - 38s 46ms/step - loss: 0.0736 - acc: 0.9810
Epoch 14/28

837/837 [==============================] - 38s 46ms/step - loss: 0.0680 - acc: 0.9827
Epoch 15/28

837/837 [==============================] - 38s 46ms/step - loss: 0.0629 - acc: 0.9843
Epoch 16/28

837/837 [==============================] - 38s 46ms/step - loss: 0.0581 - acc: 0.9851
Epoch 17/28

837/837 [==============================] - 38s 46ms/step - loss: 0.0571 - acc: 0.9848
Epoch 18/28

837/837 [==============================] - 38s 46ms/step - loss: 0.0521 - acc: 0.9868
Epoch 19/28

837/837 [==============================] - 38s 46ms/step - loss: 0.0474 - acc: 0.9873
Epoch 20/28

837/837 [==============================] - 38s 46ms/step - loss: 0.0448 - acc: 0.9884
Epoch 21/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0414 - acc: 0.9894
Epoch 22/28

837/837 [==============================] - 38s 46ms/step - loss: 0.0396 - acc: 0.9896
Epoch 23/28

837/837 [==============================] - 38s 46ms/step - loss: 0.0380 - acc: 0.9898
Epoch 24/28

837/837 [==============================] - 38s 46ms/step - loss: 0.0370 - acc: 0.9901
Epoch 25/28

837/837 [==============================] - 38s 46ms/step - loss: 0.0348 - acc: 0.9915
Epoch 26/28

837/837 [==============================] - 41s 49ms/step - loss: 0.0319 - acc: 0.9919
Epoch 27/28

837/837 [==============================] - 41s 48ms/step - loss: 0.0293 - acc: 0.9927
Epoch 28/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0290 - acc: 0.9932
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8074
False 997
True percentage 0.890089295557
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
     B-MISC       0.35      0.29      0.32       141
     I-MISC       0.39      0.42      0.40       154
      B-ORG       0.70      0.63      0.66       296
      B-LOC       0.76      0.70      0.73       218
      B-PER       0.87      0.72      0.79       438
      I-PER       0.89      0.62      0.73       214
      I-ORG       0.48      0.38      0.42       151
      I-LOC       0.69      0.77      0.72       141

avg / total       0.93      0.89      0.91      9071

F-1 Score (without O):
0.642748555792
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104723 unique words.
4719 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 245
OOV word occurences: in test 385
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6702336     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,814,466
Trainable params: 6,814,466
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 44s 52ms/step - loss: 0.4937 - acc: 0.8517
Epoch 2/28

837/837 [==============================] - 41s 49ms/step - loss: 0.2974 - acc: 0.9112
Epoch 3/28

837/837 [==============================] - 41s 49ms/step - loss: 0.2394 - acc: 0.9311
Epoch 4/28

837/837 [==============================] - 41s 49ms/step - loss: 0.2001 - acc: 0.9409
Epoch 5/28

837/837 [==============================] - 41s 49ms/step - loss: 0.1751 - acc: 0.9495
Epoch 6/28

837/837 [==============================] - 41s 49ms/step - loss: 0.1553 - acc: 0.9550
Epoch 7/28

837/837 [==============================] - 41s 49ms/step - loss: 0.1362 - acc: 0.9610
Epoch 8/28

837/837 [==============================] - 41s 49ms/step - loss: 0.1216 - acc: 0.9657
Epoch 9/28

837/837 [==============================] - 41s 49ms/step - loss: 0.1085 - acc: 0.9693
Epoch 10/28

837/837 [==============================] - 40s 48ms/step - loss: 0.0984 - acc: 0.9738
Epoch 11/28

837/837 [==============================] - 40s 48ms/step - loss: 0.0900 - acc: 0.9759
Epoch 12/28

837/837 [==============================] - 40s 48ms/step - loss: 0.0851 - acc: 0.9769
Epoch 13/28

837/837 [==============================] - 40s 48ms/step - loss: 0.0760 - acc: 0.9798
Epoch 14/28

837/837 [==============================] - 40s 48ms/step - loss: 0.0711 - acc: 0.9819
Epoch 15/28

837/837 [==============================] - 40s 48ms/step - loss: 0.0651 - acc: 0.9823
Epoch 16/28

837/837 [==============================] - 40s 48ms/step - loss: 0.0633 - acc: 0.9835
Epoch 17/28

837/837 [==============================] - 40s 48ms/step - loss: 0.0594 - acc: 0.9847
Epoch 18/28

837/837 [==============================] - 40s 47ms/step - loss: 0.0535 - acc: 0.9865
Epoch 19/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0500 - acc: 0.9876
Epoch 20/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0461 - acc: 0.9892
Epoch 21/28

837/837 [==============================] - 39s 47ms/step - loss: 0.0430 - acc: 0.9890
Epoch 22/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0423 - acc: 0.9891
Epoch 23/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0410 - acc: 0.9898
Epoch 24/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0365 - acc: 0.9907
Epoch 25/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0361 - acc: 0.9913
Epoch 26/28

837/837 [==============================] - 38s 46ms/step - loss: 0.0326 - acc: 0.9922
Epoch 27/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0314 - acc: 0.9922
Epoch 28/28

837/837 [==============================] - 39s 46ms/step - loss: 0.0298 - acc: 0.9929
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8122
False 949
True percentage 0.895380884136
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.89      0.74      0.81       438
      I-PER       0.86      0.64      0.73       214
          O       0.99      0.96      0.97      7318
      B-ORG       0.72      0.73      0.72       296
      B-LOC       0.71      0.68      0.69       218
      I-ORG       0.56      0.58      0.57       151
      I-LOC       0.76      0.72      0.74       141
     B-MISC       0.41      0.30      0.35       141
     I-MISC       0.45      0.45      0.45       154

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.919827738776
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104352 unique words.
4348 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 266
OOV word occurences: in test 428
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678592     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,722
Trainable params: 6,790,722
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 19s 55ms/step - loss: 0.6594 - acc: 0.8031
Epoch 2/28

334/334 [==============================] - 16s 48ms/step - loss: 0.3740 - acc: 0.8863
Epoch 3/28

334/334 [==============================] - 16s 49ms/step - loss: 0.3161 - acc: 0.9065
Epoch 4/28

334/334 [==============================] - 16s 49ms/step - loss: 0.2674 - acc: 0.9243
Epoch 5/28

334/334 [==============================] - 16s 49ms/step - loss: 0.2286 - acc: 0.9403
Epoch 6/28

334/334 [==============================] - 16s 49ms/step - loss: 0.1997 - acc: 0.9464
Epoch 7/28

334/334 [==============================] - 16s 49ms/step - loss: 0.1730 - acc: 0.9560
Epoch 8/28

334/334 [==============================] - 16s 49ms/step - loss: 0.1541 - acc: 0.9610
Epoch 9/28

334/334 [==============================] - 16s 49ms/step - loss: 0.1368 - acc: 0.9671
Epoch 10/28

334/334 [==============================] - 16s 49ms/step - loss: 0.1245 - acc: 0.9720
Epoch 11/28

334/334 [==============================] - 16s 49ms/step - loss: 0.1124 - acc: 0.9752
Epoch 12/28

334/334 [==============================] - 16s 49ms/step - loss: 0.1033 - acc: 0.9759
Epoch 13/28

334/334 [==============================] - 16s 49ms/step - loss: 0.0942 - acc: 0.9782
Epoch 14/28

334/334 [==============================] - 16s 49ms/step - loss: 0.0854 - acc: 0.9803
Epoch 15/28

334/334 [==============================] - 16s 49ms/step - loss: 0.0788 - acc: 0.9837
Epoch 16/28

334/334 [==============================] - 16s 49ms/step - loss: 0.0706 - acc: 0.9843
Epoch 17/28

334/334 [==============================] - 16s 49ms/step - loss: 0.0654 - acc: 0.9862
Epoch 18/28

334/334 [==============================] - 16s 49ms/step - loss: 0.0636 - acc: 0.9855
Epoch 19/28

334/334 [==============================] - 16s 49ms/step - loss: 0.0569 - acc: 0.9871
Epoch 20/28

334/334 [==============================] - 16s 49ms/step - loss: 0.0542 - acc: 0.9883
Epoch 21/28

334/334 [==============================] - 16s 49ms/step - loss: 0.0513 - acc: 0.9887
Epoch 22/28

334/334 [==============================] - 16s 49ms/step - loss: 0.0462 - acc: 0.9907
Epoch 23/28

334/334 [==============================] - 16s 49ms/step - loss: 0.0467 - acc: 0.9903
Epoch 24/28

334/334 [==============================] - 16s 49ms/step - loss: 0.0430 - acc: 0.9904
Epoch 25/28

334/334 [==============================] - 16s 49ms/step - loss: 0.0416 - acc: 0.9912
Epoch 26/28

334/334 [==============================] - 16s 49ms/step - loss: 0.0379 - acc: 0.9928
Epoch 27/28

334/334 [==============================] - 16s 49ms/step - loss: 0.0326 - acc: 0.9941
Epoch 28/28

334/334 [==============================] - 16s 49ms/step - loss: 0.0346 - acc: 0.9919
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8076
False 995
True percentage 0.890309778415
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.96      0.97      7318
      B-PER       0.88      0.75      0.81       438
      B-ORG       0.75      0.64      0.69       296
      I-ORG       0.45      0.48      0.46       151
      I-PER       0.85      0.59      0.70       214
      B-LOC       0.74      0.75      0.74       218
     B-MISC       0.42      0.17      0.24       141
      I-LOC       0.75      0.73      0.74       141
     I-MISC       0.52      0.23      0.32       154

avg / total       0.92      0.89      0.90      9071

F-1 Score (without O):
0.656772971266
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104340 unique words.
4336 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 268
OOV word occurences: in test 411
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6677824     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,789,954
Trainable params: 6,789,954
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 18s 55ms/step - loss: 0.6452 - acc: 0.8040
Epoch 2/28

334/334 [==============================] - 16s 48ms/step - loss: 0.3642 - acc: 0.8907
Epoch 3/28

334/334 [==============================] - 16s 49ms/step - loss: 0.2918 - acc: 0.9133
Epoch 4/28

334/334 [==============================] - 16s 49ms/step - loss: 0.2526 - acc: 0.9274
Epoch 5/28

334/334 [==============================] - 16s 48ms/step - loss: 0.2146 - acc: 0.9389
Epoch 6/28

334/334 [==============================] - 16s 49ms/step - loss: 0.1948 - acc: 0.9471
Epoch 7/28

334/334 [==============================] - 16s 49ms/step - loss: 0.1678 - acc: 0.9527
Epoch 8/28

334/334 [==============================] - 16s 49ms/step - loss: 0.1498 - acc: 0.9587
Epoch 9/28

334/334 [==============================] - 16s 49ms/step - loss: 0.1316 - acc: 0.9665
Epoch 10/28

334/334 [==============================] - 16s 49ms/step - loss: 0.1205 - acc: 0.9699
Epoch 11/28

334/334 [==============================] - 16s 49ms/step - loss: 0.1089 - acc: 0.9729
Epoch 12/28

334/334 [==============================] - 16s 49ms/step - loss: 0.1004 - acc: 0.9752
Epoch 13/28

334/334 [==============================] - 16s 49ms/step - loss: 0.0929 - acc: 0.9801
Epoch 14/28

334/334 [==============================] - 16s 49ms/step - loss: 0.0825 - acc: 0.9834
Epoch 15/28

334/334 [==============================] - 16s 48ms/step - loss: 0.0799 - acc: 0.9829
Epoch 16/28

334/334 [==============================] - 16s 48ms/step - loss: 0.0735 - acc: 0.9841
Epoch 17/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0683 - acc: 0.9844
Epoch 18/28

334/334 [==============================] - 16s 48ms/step - loss: 0.0610 - acc: 0.9852
Epoch 19/28

334/334 [==============================] - 16s 48ms/step - loss: 0.0556 - acc: 0.9888
Epoch 20/28

334/334 [==============================] - 16s 48ms/step - loss: 0.0578 - acc: 0.9872
Epoch 21/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0499 - acc: 0.9899
Epoch 22/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0472 - acc: 0.9899
Epoch 23/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0456 - acc: 0.9901
Epoch 24/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0430 - acc: 0.9918
Epoch 25/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0407 - acc: 0.9910
Epoch 26/28

334/334 [==============================] - 16s 48ms/step - loss: 0.0355 - acc: 0.9939
Epoch 27/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0359 - acc: 0.9931
Epoch 28/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0345 - acc: 0.9934
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7999
False 1072
True percentage 0.881821188403
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.97      7318
      B-PER       0.85      0.71      0.77       438
      B-ORG       0.65      0.65      0.65       296
      I-ORG       0.39      0.48      0.43       151
     B-MISC       0.32      0.24      0.27       141
     I-MISC       0.39      0.35      0.37       154
      I-PER       0.90      0.57      0.70       214
      B-LOC       0.71      0.69      0.70       218
      I-LOC       0.82      0.65      0.73       141

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.621670702179
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104355 unique words.
4351 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 262
OOV word occurences: in test 406
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678784     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,914
Trainable params: 6,790,914
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 18s 55ms/step - loss: 0.8123 - acc: 0.7661
Epoch 2/28

334/334 [==============================] - 16s 48ms/step - loss: 0.4430 - acc: 0.8592
Epoch 3/28

334/334 [==============================] - 16s 48ms/step - loss: 0.3703 - acc: 0.8861
Epoch 4/28

334/334 [==============================] - 16s 48ms/step - loss: 0.3237 - acc: 0.9002
Epoch 5/28

334/334 [==============================] - 16s 48ms/step - loss: 0.2824 - acc: 0.9142
Epoch 6/28

334/334 [==============================] - 16s 48ms/step - loss: 0.2498 - acc: 0.9310
Epoch 7/28

334/334 [==============================] - 16s 48ms/step - loss: 0.2224 - acc: 0.9402
Epoch 8/28

334/334 [==============================] - 16s 48ms/step - loss: 0.2030 - acc: 0.9428
Epoch 9/28

334/334 [==============================] - 16s 48ms/step - loss: 0.1803 - acc: 0.9503
Epoch 10/28

334/334 [==============================] - 16s 48ms/step - loss: 0.1658 - acc: 0.9566
Epoch 11/28

334/334 [==============================] - 16s 48ms/step - loss: 0.1508 - acc: 0.9583
Epoch 12/28

334/334 [==============================] - 16s 48ms/step - loss: 0.1345 - acc: 0.9681
Epoch 13/28

334/334 [==============================] - 16s 48ms/step - loss: 0.1226 - acc: 0.9705
Epoch 14/28

334/334 [==============================] - 16s 48ms/step - loss: 0.1140 - acc: 0.9713
Epoch 15/28

334/334 [==============================] - 16s 48ms/step - loss: 0.1057 - acc: 0.9760
Epoch 16/28

334/334 [==============================] - 16s 48ms/step - loss: 0.1007 - acc: 0.9759
Epoch 17/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0888 - acc: 0.9795
Epoch 18/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0821 - acc: 0.9807
Epoch 19/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0784 - acc: 0.9841
Epoch 20/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0769 - acc: 0.9816
Epoch 21/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0700 - acc: 0.9841
Epoch 22/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0641 - acc: 0.9871
Epoch 23/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0639 - acc: 0.9853
Epoch 24/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0562 - acc: 0.9885
Epoch 25/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0554 - acc: 0.9875
Epoch 26/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0500 - acc: 0.9894
Epoch 27/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0495 - acc: 0.9890
Epoch 28/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0420 - acc: 0.9915
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8065
False 1006
True percentage 0.889097122699
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.69      0.72      0.71       296
      B-PER       0.88      0.66      0.76       438
      I-PER       0.88      0.57      0.69       214
      B-LOC       0.67      0.67      0.67       218
      I-LOC       0.71      0.72      0.72       141
      I-ORG       0.52      0.54      0.53       151
     B-MISC       0.45      0.23      0.31       141
     I-MISC       0.52      0.29      0.37       154

avg / total       0.92      0.89      0.90      9071

F-1 Score (without O):
0.644257703081
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104348 unique words.
4344 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 262
OOV word occurences: in test 426
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678336     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,466
Trainable params: 6,790,466
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 18s 55ms/step - loss: 0.5966 - acc: 0.8224
Epoch 2/28

334/334 [==============================] - 16s 48ms/step - loss: 0.3597 - acc: 0.8860
Epoch 3/28

334/334 [==============================] - 16s 48ms/step - loss: 0.2971 - acc: 0.9079
Epoch 4/28

334/334 [==============================] - 16s 48ms/step - loss: 0.2557 - acc: 0.9195
Epoch 5/28

334/334 [==============================] - 16s 48ms/step - loss: 0.2263 - acc: 0.9339
Epoch 6/28

334/334 [==============================] - 16s 48ms/step - loss: 0.1946 - acc: 0.9430
Epoch 7/28

334/334 [==============================] - 16s 48ms/step - loss: 0.1757 - acc: 0.9523
Epoch 8/28

334/334 [==============================] - 16s 48ms/step - loss: 0.1556 - acc: 0.9580
Epoch 9/28

334/334 [==============================] - 16s 48ms/step - loss: 0.1399 - acc: 0.9600
Epoch 10/28

334/334 [==============================] - 16s 48ms/step - loss: 0.1309 - acc: 0.9652
Epoch 11/28

334/334 [==============================] - 16s 47ms/step - loss: 0.1121 - acc: 0.9701
Epoch 12/28

334/334 [==============================] - 16s 47ms/step - loss: 0.1018 - acc: 0.9747
Epoch 13/28

334/334 [==============================] - 16s 48ms/step - loss: 0.0934 - acc: 0.9779
Epoch 14/28

334/334 [==============================] - 16s 48ms/step - loss: 0.0896 - acc: 0.9784
Epoch 15/28

334/334 [==============================] - 16s 48ms/step - loss: 0.0803 - acc: 0.9802
Epoch 16/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0756 - acc: 0.9817
Epoch 17/28

334/334 [==============================] - 16s 48ms/step - loss: 0.0707 - acc: 0.9821
Epoch 18/28

334/334 [==============================] - 16s 48ms/step - loss: 0.0639 - acc: 0.9852
Epoch 19/28

334/334 [==============================] - 16s 48ms/step - loss: 0.0610 - acc: 0.9864
Epoch 20/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0561 - acc: 0.9864
Epoch 21/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0515 - acc: 0.9890
Epoch 22/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0492 - acc: 0.9885
Epoch 23/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0488 - acc: 0.9888
Epoch 24/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0456 - acc: 0.9892
Epoch 25/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0431 - acc: 0.9903
Epoch 26/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0401 - acc: 0.9906
Epoch 27/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0388 - acc: 0.9911
Epoch 28/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0363 - acc: 0.9925
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7937
False 1134
True percentage 0.874986219821
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
     B-MISC       0.35      0.26      0.30       141
     I-MISC       0.46      0.30      0.36       154
      B-ORG       0.62      0.64      0.63       296
      B-LOC       0.64      0.71      0.67       218
      B-PER       0.86      0.68      0.76       438
      I-PER       0.88      0.52      0.66       214
      I-ORG       0.38      0.40      0.39       151
      I-LOC       0.55      0.76      0.64       141

avg / total       0.92      0.87      0.89      9071

F-1 Score (without O):
0.601982577351
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104309 unique words.
4305 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 264
OOV word occurences: in test 431
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6675840     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,787,970
Trainable params: 6,787,970
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 18s 55ms/step - loss: 0.6278 - acc: 0.8125
Epoch 2/28

334/334 [==============================] - 16s 48ms/step - loss: 0.3714 - acc: 0.8844
Epoch 3/28

334/334 [==============================] - 16s 48ms/step - loss: 0.2988 - acc: 0.9108
Epoch 4/28

334/334 [==============================] - 16s 48ms/step - loss: 0.2540 - acc: 0.9286
Epoch 5/28

334/334 [==============================] - 16s 48ms/step - loss: 0.2225 - acc: 0.9387
Epoch 6/28

334/334 [==============================] - 16s 48ms/step - loss: 0.2022 - acc: 0.9432
Epoch 7/28

334/334 [==============================] - 16s 47ms/step - loss: 0.1790 - acc: 0.9519
Epoch 8/28

334/334 [==============================] - 16s 48ms/step - loss: 0.1598 - acc: 0.9590
Epoch 9/28

334/334 [==============================] - 16s 48ms/step - loss: 0.1439 - acc: 0.9630
Epoch 10/28

334/334 [==============================] - 16s 48ms/step - loss: 0.1315 - acc: 0.9664
Epoch 11/28

334/334 [==============================] - 16s 47ms/step - loss: 0.1152 - acc: 0.9716
Epoch 12/28

334/334 [==============================] - 16s 48ms/step - loss: 0.1073 - acc: 0.9752
Epoch 13/28

334/334 [==============================] - 16s 47ms/step - loss: 0.1022 - acc: 0.9727
Epoch 14/28

334/334 [==============================] - 16s 48ms/step - loss: 0.0933 - acc: 0.9781
Epoch 15/28

334/334 [==============================] - 16s 48ms/step - loss: 0.0869 - acc: 0.9802
Epoch 16/28

334/334 [==============================] - 16s 48ms/step - loss: 0.0779 - acc: 0.9830
Epoch 17/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0700 - acc: 0.9838
Epoch 18/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0669 - acc: 0.9843
Epoch 19/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0641 - acc: 0.9845
Epoch 20/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0580 - acc: 0.9860
Epoch 21/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0572 - acc: 0.9876
Epoch 22/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0516 - acc: 0.9888
Epoch 23/28

334/334 [==============================] - 16s 47ms/step - loss: 0.0472 - acc: 0.9899
Epoch 24/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0456 - acc: 0.9894
Epoch 25/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0433 - acc: 0.9912
Epoch 26/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0418 - acc: 0.9914
Epoch 27/28

334/334 [==============================] - 15s 46ms/step - loss: 0.0374 - acc: 0.9931
Epoch 28/28

334/334 [==============================] - 16s 46ms/step - loss: 0.0354 - acc: 0.9926
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7966
False 1105
True percentage 0.878183221255
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.84      0.66      0.74       438
      I-PER       0.82      0.58      0.68       214
          O       0.97      0.95      0.96      7318
      B-ORG       0.64      0.66      0.65       296
      B-LOC       0.73      0.67      0.70       218
      I-ORG       0.41      0.46      0.44       151
      I-LOC       0.72      0.62      0.66       141
     B-MISC       0.36      0.18      0.24       141
     I-MISC       0.39      0.28      0.32       154

avg / total       0.91      0.88      0.89      9071

F-1 Score (without O):
0.906888810115
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104194 unique words.
4190 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 275
OOV word occurences: in test 464
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6668480     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,780,610
Trainable params: 6,780,610
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 11s 64ms/step - loss: 0.9837 - acc: 0.7302
Epoch 2/28

167/167 [==============================] - 8s 49ms/step - loss: 0.4520 - acc: 0.8614
Epoch 3/28

167/167 [==============================] - 8s 49ms/step - loss: 0.3814 - acc: 0.8827
Epoch 4/28

167/167 [==============================] - 8s 49ms/step - loss: 0.3386 - acc: 0.8988
Epoch 5/28

167/167 [==============================] - 8s 49ms/step - loss: 0.3031 - acc: 0.9155
Epoch 6/28

167/167 [==============================] - 8s 50ms/step - loss: 0.2714 - acc: 0.9207
Epoch 7/28

167/167 [==============================] - 8s 49ms/step - loss: 0.2505 - acc: 0.9269
Epoch 8/28

167/167 [==============================] - 8s 50ms/step - loss: 0.2237 - acc: 0.9396
Epoch 9/28

167/167 [==============================] - 8s 50ms/step - loss: 0.2051 - acc: 0.9460
Epoch 10/28

167/167 [==============================] - 8s 49ms/step - loss: 0.1811 - acc: 0.9516
Epoch 11/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1722 - acc: 0.9571
Epoch 12/28

167/167 [==============================] - 8s 49ms/step - loss: 0.1556 - acc: 0.9581
Epoch 13/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1464 - acc: 0.9639
Epoch 14/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1345 - acc: 0.9713
Epoch 15/28

167/167 [==============================] - 8s 49ms/step - loss: 0.1263 - acc: 0.9749
Epoch 16/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1184 - acc: 0.9749
Epoch 17/28

167/167 [==============================] - 8s 49ms/step - loss: 0.1064 - acc: 0.9775
Epoch 18/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1012 - acc: 0.9761
Epoch 19/28

167/167 [==============================] - 8s 49ms/step - loss: 0.0967 - acc: 0.9795
Epoch 20/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0881 - acc: 0.9837
Epoch 21/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0855 - acc: 0.9837
Epoch 22/28

167/167 [==============================] - 8s 49ms/step - loss: 0.0786 - acc: 0.9854
Epoch 23/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0722 - acc: 0.9880
Epoch 24/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0715 - acc: 0.9888
Epoch 25/28

167/167 [==============================] - 8s 49ms/step - loss: 0.0668 - acc: 0.9879
Epoch 26/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0620 - acc: 0.9892
Epoch 27/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0595 - acc: 0.9910
Epoch 28/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0583 - acc: 0.9893
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7875
False 1196
True percentage 0.86815125124
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.96      0.96      7318
      B-PER       0.90      0.66      0.76       438
      B-ORG       0.54      0.64      0.58       296
      I-ORG       0.26      0.45      0.33       151
      I-PER       0.81      0.57      0.67       214
      B-LOC       0.78      0.59      0.67       218
     B-MISC       0.41      0.11      0.17       141
      I-LOC       0.75      0.35      0.48       141
     I-MISC       0.73      0.10      0.18       154

avg / total       0.91      0.87      0.88      9071

F-1 Score (without O):
0.559897501602
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104185 unique words.
4181 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 272
OOV word occurences: in test 428
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6667904     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,780,034
Trainable params: 6,780,034
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 11s 65ms/step - loss: 0.9042 - acc: 0.7397
Epoch 2/28

167/167 [==============================] - 8s 50ms/step - loss: 0.4785 - acc: 0.8456
Epoch 3/28

167/167 [==============================] - 8s 50ms/step - loss: 0.3921 - acc: 0.8830
Epoch 4/28

167/167 [==============================] - 8s 50ms/step - loss: 0.3580 - acc: 0.8865
Epoch 5/28

167/167 [==============================] - 8s 50ms/step - loss: 0.3216 - acc: 0.9024
Epoch 6/28

167/167 [==============================] - 8s 50ms/step - loss: 0.2887 - acc: 0.9148
Epoch 7/28

167/167 [==============================] - 8s 50ms/step - loss: 0.2615 - acc: 0.9228
Epoch 8/28

167/167 [==============================] - 8s 50ms/step - loss: 0.2399 - acc: 0.9276
Epoch 9/28

167/167 [==============================] - 8s 50ms/step - loss: 0.2172 - acc: 0.9387
Epoch 10/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1994 - acc: 0.9431
Epoch 11/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1852 - acc: 0.9485
Epoch 12/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1684 - acc: 0.9532
Epoch 13/28

167/167 [==============================] - 8s 51ms/step - loss: 0.1632 - acc: 0.9544
Epoch 14/28

167/167 [==============================] - 8s 49ms/step - loss: 0.1466 - acc: 0.9663
Epoch 15/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1387 - acc: 0.9675
Epoch 16/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1274 - acc: 0.9704
Epoch 17/28

167/167 [==============================] - 8s 49ms/step - loss: 0.1176 - acc: 0.9725
Epoch 18/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1087 - acc: 0.9773
Epoch 19/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1087 - acc: 0.9754
Epoch 20/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1000 - acc: 0.9816
Epoch 21/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0894 - acc: 0.9830
Epoch 22/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0825 - acc: 0.9863
Epoch 23/28

167/167 [==============================] - 8s 49ms/step - loss: 0.0836 - acc: 0.9809
Epoch 24/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0772 - acc: 0.9853
Epoch 25/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0767 - acc: 0.9847
Epoch 26/28

167/167 [==============================] - 8s 49ms/step - loss: 0.0663 - acc: 0.9883
Epoch 27/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0633 - acc: 0.9882
Epoch 28/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0615 - acc: 0.9878
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7847
False 1224
True percentage 0.865064491236
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-PER       0.86      0.64      0.73       438
      B-ORG       0.51      0.66      0.57       296
      I-ORG       0.28      0.46      0.35       151
     B-MISC       0.33      0.16      0.22       141
     I-MISC       0.37      0.30      0.33       154
      I-PER       0.76      0.55      0.64       214
      B-LOC       0.75      0.63      0.68       218
      I-LOC       0.68      0.27      0.39       141

avg / total       0.91      0.87      0.88      9071

F-1 Score (without O):
0.54998480705
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104214 unique words.
4210 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 271
OOV word occurences: in test 452
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6669760     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,781,890
Trainable params: 6,781,890
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 11s 65ms/step - loss: 0.8796 - acc: 0.7475
Epoch 2/28

167/167 [==============================] - 8s 50ms/step - loss: 0.4898 - acc: 0.8435
Epoch 3/28

167/167 [==============================] - 8s 50ms/step - loss: 0.4144 - acc: 0.8704
Epoch 4/28

167/167 [==============================] - 9s 51ms/step - loss: 0.3663 - acc: 0.8907
Epoch 5/28

167/167 [==============================] - 9s 51ms/step - loss: 0.3185 - acc: 0.9084
Epoch 6/28

167/167 [==============================] - 9s 51ms/step - loss: 0.2960 - acc: 0.9105
Epoch 7/28

167/167 [==============================] - 9s 51ms/step - loss: 0.2572 - acc: 0.9254
Epoch 8/28

167/167 [==============================] - 9s 51ms/step - loss: 0.2441 - acc: 0.9319
Epoch 9/28

167/167 [==============================] - 9s 51ms/step - loss: 0.2195 - acc: 0.9384
Epoch 10/28

167/167 [==============================] - 9s 51ms/step - loss: 0.1971 - acc: 0.9476
Epoch 11/28

167/167 [==============================] - 9s 51ms/step - loss: 0.1854 - acc: 0.9541
Epoch 12/28

167/167 [==============================] - 9s 52ms/step - loss: 0.1625 - acc: 0.9597
Epoch 13/28

167/167 [==============================] - 8s 51ms/step - loss: 0.1559 - acc: 0.9609
Epoch 14/28

167/167 [==============================] - 9s 51ms/step - loss: 0.1405 - acc: 0.9658
Epoch 15/28

167/167 [==============================] - 9s 51ms/step - loss: 0.1295 - acc: 0.9715
Epoch 16/28

167/167 [==============================] - 9s 51ms/step - loss: 0.1249 - acc: 0.9710
Epoch 17/28

167/167 [==============================] - 8s 51ms/step - loss: 0.1102 - acc: 0.9772
Epoch 18/28

167/167 [==============================] - 9s 52ms/step - loss: 0.1042 - acc: 0.9790
Epoch 19/28

167/167 [==============================] - 9s 52ms/step - loss: 0.0972 - acc: 0.9808
Epoch 20/28

167/167 [==============================] - 9s 51ms/step - loss: 0.0919 - acc: 0.9803
Epoch 21/28

167/167 [==============================] - 9s 51ms/step - loss: 0.0877 - acc: 0.9813
Epoch 22/28

167/167 [==============================] - 9s 51ms/step - loss: 0.0802 - acc: 0.9862
Epoch 23/28

167/167 [==============================] - 9s 51ms/step - loss: 0.0785 - acc: 0.9862
Epoch 24/28

167/167 [==============================] - 9s 51ms/step - loss: 0.0734 - acc: 0.9861
Epoch 25/28

167/167 [==============================] - 9s 51ms/step - loss: 0.0649 - acc: 0.9892
Epoch 26/28

167/167 [==============================] - 9s 51ms/step - loss: 0.0636 - acc: 0.9892
Epoch 27/28

167/167 [==============================] - 9s 52ms/step - loss: 0.0578 - acc: 0.9908
Epoch 28/28

167/167 [==============================] - 9s 51ms/step - loss: 0.0541 - acc: 0.9901
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7882
False 1189
True percentage 0.868922941241
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-ORG       0.61      0.64      0.62       296
      B-PER       0.83      0.63      0.71       438
      I-PER       0.75      0.56      0.64       214
      B-LOC       0.69      0.58      0.63       218
      I-LOC       0.69      0.48      0.56       141
      I-ORG       0.31      0.51      0.39       151
     B-MISC       0.35      0.27      0.31       141
     I-MISC       0.43      0.34      0.38       154

avg / total       0.92      0.87      0.89      9071

F-1 Score (without O):
0.570996978852
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104201 unique words.
4197 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 270
OOV word occurences: in test 452
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6668928     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,781,058
Trainable params: 6,781,058
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 11s 64ms/step - loss: 0.9200 - acc: 0.7365
Epoch 2/28

167/167 [==============================] - 8s 50ms/step - loss: 0.4709 - acc: 0.8434
Epoch 3/28

167/167 [==============================] - 8s 50ms/step - loss: 0.3935 - acc: 0.8774
Epoch 4/28

167/167 [==============================] - 8s 51ms/step - loss: 0.3384 - acc: 0.8950
Epoch 5/28

167/167 [==============================] - 8s 51ms/step - loss: 0.3054 - acc: 0.9074
Epoch 6/28

167/167 [==============================] - 8s 51ms/step - loss: 0.2671 - acc: 0.9227
Epoch 7/28

167/167 [==============================] - 8s 51ms/step - loss: 0.2381 - acc: 0.9301
Epoch 8/28

167/167 [==============================] - 8s 51ms/step - loss: 0.2300 - acc: 0.9413
Epoch 9/28

167/167 [==============================] - 8s 51ms/step - loss: 0.1989 - acc: 0.9448
Epoch 10/28

167/167 [==============================] - 8s 51ms/step - loss: 0.1833 - acc: 0.9542
Epoch 11/28

167/167 [==============================] - 8s 51ms/step - loss: 0.1723 - acc: 0.9525
Epoch 12/28

167/167 [==============================] - 8s 51ms/step - loss: 0.1586 - acc: 0.9586
Epoch 13/28

167/167 [==============================] - 8s 51ms/step - loss: 0.1405 - acc: 0.9667
Epoch 14/28

167/167 [==============================] - 8s 51ms/step - loss: 0.1332 - acc: 0.9695
Epoch 15/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1247 - acc: 0.9689
Epoch 16/28

167/167 [==============================] - 8s 50ms/step - loss: 0.1108 - acc: 0.9759
Epoch 17/28

167/167 [==============================] - 8s 51ms/step - loss: 0.1015 - acc: 0.9775
Epoch 18/28

167/167 [==============================] - 9s 51ms/step - loss: 0.0927 - acc: 0.9812
Epoch 19/28

167/167 [==============================] - 9s 51ms/step - loss: 0.0899 - acc: 0.9815
Epoch 20/28

167/167 [==============================] - 8s 51ms/step - loss: 0.0785 - acc: 0.9869
Epoch 21/28

167/167 [==============================] - 8s 51ms/step - loss: 0.0760 - acc: 0.9855
Epoch 22/28

167/167 [==============================] - 8s 51ms/step - loss: 0.0699 - acc: 0.9882
Epoch 23/28

167/167 [==============================] - 8s 51ms/step - loss: 0.0684 - acc: 0.9896
Epoch 24/28

167/167 [==============================] - 9s 51ms/step - loss: 0.0628 - acc: 0.9881
Epoch 25/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0549 - acc: 0.9920
Epoch 26/28

167/167 [==============================] - 8s 51ms/step - loss: 0.0548 - acc: 0.9913
Epoch 27/28

167/167 [==============================] - 8s 51ms/step - loss: 0.0486 - acc: 0.9941
Epoch 28/28

167/167 [==============================] - 8s 50ms/step - loss: 0.0475 - acc: 0.9928
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7863
False 1208
True percentage 0.866828354095
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
     B-MISC       0.29      0.16      0.21       141
     I-MISC       0.46      0.16      0.24       154
      B-ORG       0.59      0.56      0.57       296
      B-LOC       0.74      0.61      0.66       218
      B-PER       0.80      0.64      0.71       438
      I-PER       0.78      0.55      0.64       214
      I-ORG       0.34      0.54      0.41       151
      I-LOC       0.65      0.69      0.67       141

avg / total       0.91      0.87      0.88      9071

F-1 Score (without O):
0.568252007412
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104181 unique words.
4177 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 273
OOV word occurences: in test 525
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6667648     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,779,778
Trainable params: 6,779,778
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 11s 66ms/step - loss: 0.8080 - acc: 0.7576
Epoch 2/28

167/167 [==============================] - 8s 51ms/step - loss: 0.4381 - acc: 0.8521
Epoch 3/28

167/167 [==============================] - 9s 51ms/step - loss: 0.3706 - acc: 0.8807
Epoch 4/28

167/167 [==============================] - 9s 52ms/step - loss: 0.3234 - acc: 0.8997
Epoch 5/28

167/167 [==============================] - 9s 52ms/step - loss: 0.2943 - acc: 0.9112
Epoch 6/28

167/167 [==============================] - 9s 52ms/step - loss: 0.2584 - acc: 0.9243
Epoch 7/28

167/167 [==============================] - 9s 52ms/step - loss: 0.2332 - acc: 0.9337
Epoch 8/28

167/167 [==============================] - 9s 51ms/step - loss: 0.2081 - acc: 0.9450
Epoch 9/28

167/167 [==============================] - 9s 52ms/step - loss: 0.1906 - acc: 0.9492
Epoch 10/28

167/167 [==============================] - 9s 52ms/step - loss: 0.1747 - acc: 0.9541
Epoch 11/28

167/167 [==============================] - 9s 51ms/step - loss: 0.1585 - acc: 0.9590
Epoch 12/28

167/167 [==============================] - 9s 52ms/step - loss: 0.1440 - acc: 0.9669
Epoch 13/28

167/167 [==============================] - 9s 52ms/step - loss: 0.1339 - acc: 0.9700
Epoch 14/28

167/167 [==============================] - 9s 51ms/step - loss: 0.1228 - acc: 0.9715
Epoch 15/28

167/167 [==============================] - 9s 51ms/step - loss: 0.1133 - acc: 0.9752
Epoch 16/28

167/167 [==============================] - 9s 51ms/step - loss: 0.1054 - acc: 0.9784
Epoch 17/28

167/167 [==============================] - 9s 52ms/step - loss: 0.0951 - acc: 0.9794
Epoch 18/28

167/167 [==============================] - 9s 51ms/step - loss: 0.0934 - acc: 0.9760
Epoch 19/28

167/167 [==============================] - 9s 51ms/step - loss: 0.0861 - acc: 0.9813
Epoch 20/28

167/167 [==============================] - 9s 51ms/step - loss: 0.0725 - acc: 0.9856
Epoch 21/28

167/167 [==============================] - 9s 51ms/step - loss: 0.0649 - acc: 0.9883
Epoch 22/28

167/167 [==============================] - 9s 52ms/step - loss: 0.0638 - acc: 0.9886
Epoch 23/28

167/167 [==============================] - 9s 52ms/step - loss: 0.0632 - acc: 0.9885
Epoch 24/28

167/167 [==============================] - 9s 51ms/step - loss: 0.0586 - acc: 0.9902
Epoch 25/28

167/167 [==============================] - 9s 51ms/step - loss: 0.0568 - acc: 0.9899
Epoch 26/28

167/167 [==============================] - 9s 51ms/step - loss: 0.0478 - acc: 0.9929
Epoch 27/28

167/167 [==============================] - 9s 51ms/step - loss: 0.0479 - acc: 0.9920
Epoch 28/28

167/167 [==============================] - 9s 51ms/step - loss: 0.0452 - acc: 0.9916
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7801
False 1270
True percentage 0.859993385514
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.82      0.49      0.62       438
      I-PER       0.75      0.42      0.54       214
          O       0.97      0.95      0.96      7318
      B-ORG       0.63      0.58      0.61       296
      B-LOC       0.74      0.61      0.67       218
      I-ORG       0.26      0.38      0.31       151
      I-LOC       0.75      0.56      0.64       141
     B-MISC       0.37      0.23      0.28       141
     I-MISC       0.42      0.37      0.39       154

avg / total       0.91      0.86      0.88      9071

F-1 Score (without O):
0.896796311621
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104112 unique words.
4108 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 562
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663232     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,362
Trainable params: 6,775,362
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 7s 85ms/step - loss: 1.0673 - acc: 0.6745
Epoch 2/28

83/83 [==============================] - 5s 55ms/step - loss: 0.4782 - acc: 0.8526
Epoch 3/28

83/83 [==============================] - 5s 55ms/step - loss: 0.4017 - acc: 0.8787
Epoch 4/28

83/83 [==============================] - 5s 56ms/step - loss: 0.3699 - acc: 0.8862
Epoch 5/28

83/83 [==============================] - 5s 54ms/step - loss: 0.3158 - acc: 0.9124
Epoch 6/28

83/83 [==============================] - 5s 55ms/step - loss: 0.2823 - acc: 0.9142
Epoch 7/28

83/83 [==============================] - 5s 55ms/step - loss: 0.2601 - acc: 0.9196
Epoch 8/28

83/83 [==============================] - 5s 55ms/step - loss: 0.2432 - acc: 0.9353
Epoch 9/28

83/83 [==============================] - 5s 55ms/step - loss: 0.2276 - acc: 0.9386
Epoch 10/28

83/83 [==============================] - 4s 54ms/step - loss: 0.2175 - acc: 0.9406
Epoch 11/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1899 - acc: 0.9515
Epoch 12/28

83/83 [==============================] - 5s 54ms/step - loss: 0.1804 - acc: 0.9597
Epoch 13/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1768 - acc: 0.9580
Epoch 14/28

83/83 [==============================] - 5s 54ms/step - loss: 0.1602 - acc: 0.9615
Epoch 15/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1497 - acc: 0.9641
Epoch 16/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1416 - acc: 0.9649
Epoch 17/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1425 - acc: 0.9696
Epoch 18/28

83/83 [==============================] - 5s 54ms/step - loss: 0.1339 - acc: 0.9697
Epoch 19/28

83/83 [==============================] - 5s 54ms/step - loss: 0.1244 - acc: 0.9745
Epoch 20/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1146 - acc: 0.9785
Epoch 21/28

83/83 [==============================] - 4s 54ms/step - loss: 0.1104 - acc: 0.9768
Epoch 22/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1142 - acc: 0.9748
Epoch 23/28

83/83 [==============================] - 5s 54ms/step - loss: 0.0961 - acc: 0.9819
Epoch 24/28

83/83 [==============================] - 5s 54ms/step - loss: 0.0954 - acc: 0.9846
Epoch 25/28

83/83 [==============================] - 5s 55ms/step - loss: 0.0929 - acc: 0.9815
Epoch 26/28

83/83 [==============================] - 5s 55ms/step - loss: 0.0836 - acc: 0.9861
Epoch 27/28

83/83 [==============================] - 4s 54ms/step - loss: 0.0774 - acc: 0.9880
Epoch 28/28

83/83 [==============================] - 4s 54ms/step - loss: 0.0794 - acc: 0.9871
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7637
False 1434
True percentage 0.841913791203
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.95      0.95      7318
      B-PER       0.76      0.48      0.59       438
      B-ORG       0.47      0.47      0.47       296
      I-ORG       0.23      0.38      0.29       151
      I-PER       0.68      0.43      0.53       214
      B-LOC       0.66      0.55      0.60       218
     B-MISC       0.55      0.11      0.19       141
      I-LOC       0.80      0.37      0.50       141
     I-MISC       0.58      0.14      0.23       154

avg / total       0.89      0.84      0.86      9071

F-1 Score (without O):
0.468874172185
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104114 unique words.
4110 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 276
OOV word occurences: in test 456
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663360     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,490
Trainable params: 6,775,490
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 7s 84ms/step - loss: 1.2553 - acc: 0.6452
Epoch 2/28

83/83 [==============================] - 5s 54ms/step - loss: 0.5655 - acc: 0.8214
Epoch 3/28

83/83 [==============================] - 5s 54ms/step - loss: 0.4519 - acc: 0.8505
Epoch 4/28

83/83 [==============================] - 5s 55ms/step - loss: 0.4134 - acc: 0.8723
Epoch 5/28

83/83 [==============================] - 5s 55ms/step - loss: 0.3841 - acc: 0.8830
Epoch 6/28

83/83 [==============================] - 5s 55ms/step - loss: 0.3408 - acc: 0.9015
Epoch 7/28

83/83 [==============================] - 5s 55ms/step - loss: 0.3062 - acc: 0.9091
Epoch 8/28

83/83 [==============================] - 5s 54ms/step - loss: 0.2855 - acc: 0.9156
Epoch 9/28

83/83 [==============================] - 5s 55ms/step - loss: 0.2511 - acc: 0.9252
Epoch 10/28

83/83 [==============================] - 5s 54ms/step - loss: 0.2340 - acc: 0.9389
Epoch 11/28

83/83 [==============================] - 5s 55ms/step - loss: 0.2217 - acc: 0.9396
Epoch 12/28

83/83 [==============================] - 5s 54ms/step - loss: 0.1982 - acc: 0.9547
Epoch 13/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1856 - acc: 0.9573
Epoch 14/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1761 - acc: 0.9623
Epoch 15/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1618 - acc: 0.9668
Epoch 16/28

83/83 [==============================] - 5s 54ms/step - loss: 0.1520 - acc: 0.9625
Epoch 17/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1427 - acc: 0.9703
Epoch 18/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1407 - acc: 0.9693
Epoch 19/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1280 - acc: 0.9741
Epoch 20/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1213 - acc: 0.9792
Epoch 21/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1191 - acc: 0.9781
Epoch 22/28

83/83 [==============================] - 5s 54ms/step - loss: 0.1055 - acc: 0.9835
Epoch 23/28

83/83 [==============================] - 5s 54ms/step - loss: 0.1026 - acc: 0.9818
Epoch 24/28

83/83 [==============================] - 5s 54ms/step - loss: 0.0959 - acc: 0.9834
Epoch 25/28

83/83 [==============================] - 5s 55ms/step - loss: 0.0892 - acc: 0.9823
Epoch 26/28

83/83 [==============================] - 4s 54ms/step - loss: 0.0877 - acc: 0.9894
Epoch 27/28

83/83 [==============================] - 5s 54ms/step - loss: 0.0798 - acc: 0.9867
Epoch 28/28

83/83 [==============================] - 5s 54ms/step - loss: 0.0812 - acc: 0.9860
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7772
False 1299
True percentage 0.856796384081
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.94      0.96      7318
      B-PER       0.74      0.62      0.68       438
      B-ORG       0.48      0.52      0.50       296
      I-ORG       0.30      0.36      0.33       151
     B-MISC       0.31      0.11      0.17       141
     I-MISC       0.29      0.26      0.27       154
      I-PER       0.65      0.57      0.61       214
      B-LOC       0.65      0.66      0.66       218
      I-LOC       0.73      0.50      0.59       141

avg / total       0.90      0.86      0.88      9071

F-1 Score (without O):
0.527744270205
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104134 unique words.
4130 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 280
OOV word occurences: in test 543
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6664640     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,776,770
Trainable params: 6,776,770
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 7s 85ms/step - loss: 1.2816 - acc: 0.6309
Epoch 2/28

83/83 [==============================] - 5s 55ms/step - loss: 0.5888 - acc: 0.8135
Epoch 3/28

83/83 [==============================] - 5s 55ms/step - loss: 0.4853 - acc: 0.8486
Epoch 4/28

83/83 [==============================] - 5s 55ms/step - loss: 0.4206 - acc: 0.8742
Epoch 5/28

83/83 [==============================] - 5s 55ms/step - loss: 0.3801 - acc: 0.8853
Epoch 6/28

83/83 [==============================] - 5s 55ms/step - loss: 0.3483 - acc: 0.8959
Epoch 7/28

83/83 [==============================] - 5s 55ms/step - loss: 0.3142 - acc: 0.9067
Epoch 8/28

83/83 [==============================] - 5s 55ms/step - loss: 0.2700 - acc: 0.9288
Epoch 9/28

83/83 [==============================] - 5s 55ms/step - loss: 0.2570 - acc: 0.9316
Epoch 10/28

83/83 [==============================] - 5s 55ms/step - loss: 0.2427 - acc: 0.9401
Epoch 11/28

83/83 [==============================] - 5s 54ms/step - loss: 0.2206 - acc: 0.9446
Epoch 12/28

83/83 [==============================] - 5s 55ms/step - loss: 0.2105 - acc: 0.9456
Epoch 13/28

83/83 [==============================] - 5s 54ms/step - loss: 0.1896 - acc: 0.9555
Epoch 14/28

83/83 [==============================] - 4s 54ms/step - loss: 0.1693 - acc: 0.9662
Epoch 15/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1638 - acc: 0.9594
Epoch 16/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1502 - acc: 0.9676
Epoch 17/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1471 - acc: 0.9687
Epoch 18/28

83/83 [==============================] - 5s 56ms/step - loss: 0.1310 - acc: 0.9738
Epoch 19/28

83/83 [==============================] - 5s 56ms/step - loss: 0.1283 - acc: 0.9756
Epoch 20/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1149 - acc: 0.9801
Epoch 21/28

83/83 [==============================] - 5s 56ms/step - loss: 0.1115 - acc: 0.9766
Epoch 22/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1023 - acc: 0.9804
Epoch 23/28

83/83 [==============================] - 5s 55ms/step - loss: 0.0977 - acc: 0.9823
Epoch 24/28

83/83 [==============================] - 5s 56ms/step - loss: 0.0961 - acc: 0.9790
Epoch 25/28

83/83 [==============================] - 5s 55ms/step - loss: 0.0864 - acc: 0.9866
Epoch 26/28

83/83 [==============================] - 5s 54ms/step - loss: 0.0801 - acc: 0.9835
Epoch 27/28

83/83 [==============================] - 5s 55ms/step - loss: 0.0774 - acc: 0.9867
Epoch 28/28

83/83 [==============================] - 5s 55ms/step - loss: 0.0730 - acc: 0.9865
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7600
False 1471
True percentage 0.83783485834
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.94      0.96      7318
      B-ORG       0.41      0.60      0.48       296
      B-PER       0.76      0.45      0.57       438
      I-PER       0.58      0.32      0.41       214
      B-LOC       0.80      0.52      0.63       218
      I-LOC       0.50      0.48      0.49       141
      I-ORG       0.18      0.40      0.25       151
     B-MISC       0.35      0.12      0.18       141
     I-MISC       0.33      0.12      0.17       154

avg / total       0.90      0.84      0.86      9071

F-1 Score (without O):
0.439306358382
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104118 unique words.
4114 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 276
OOV word occurences: in test 477
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663616     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,746
Trainable params: 6,775,746
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 7s 83ms/step - loss: 1.2177 - acc: 0.6556
Epoch 2/28

83/83 [==============================] - 4s 54ms/step - loss: 0.5482 - acc: 0.8322
Epoch 3/28

83/83 [==============================] - 5s 55ms/step - loss: 0.4522 - acc: 0.8515
Epoch 4/28

83/83 [==============================] - 5s 55ms/step - loss: 0.3871 - acc: 0.8795
Epoch 5/28

83/83 [==============================] - 5s 55ms/step - loss: 0.3498 - acc: 0.8982
Epoch 6/28

83/83 [==============================] - 5s 55ms/step - loss: 0.3127 - acc: 0.9036
Epoch 7/28

83/83 [==============================] - 5s 55ms/step - loss: 0.3218 - acc: 0.9039
Epoch 8/28

83/83 [==============================] - 5s 55ms/step - loss: 0.2642 - acc: 0.9210
Epoch 9/28

83/83 [==============================] - 5s 55ms/step - loss: 0.2435 - acc: 0.9306
Epoch 10/28

83/83 [==============================] - 5s 55ms/step - loss: 0.2273 - acc: 0.9324
Epoch 11/28

83/83 [==============================] - 5s 55ms/step - loss: 0.2126 - acc: 0.9493
Epoch 12/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1933 - acc: 0.9512
Epoch 13/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1841 - acc: 0.9573
Epoch 14/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1711 - acc: 0.9583
Epoch 15/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1667 - acc: 0.9624
Epoch 16/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1575 - acc: 0.9612
Epoch 17/28

83/83 [==============================] - 4s 54ms/step - loss: 0.1423 - acc: 0.9635
Epoch 18/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1361 - acc: 0.9662
Epoch 19/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1292 - acc: 0.9736
Epoch 20/28

83/83 [==============================] - 5s 54ms/step - loss: 0.1232 - acc: 0.9738
Epoch 21/28

83/83 [==============================] - 5s 54ms/step - loss: 0.1166 - acc: 0.9753
Epoch 22/28

83/83 [==============================] - 5s 54ms/step - loss: 0.1131 - acc: 0.9769
Epoch 23/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1043 - acc: 0.9812
Epoch 24/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1039 - acc: 0.9814
Epoch 25/28

83/83 [==============================] - 5s 55ms/step - loss: 0.0962 - acc: 0.9822
Epoch 26/28

83/83 [==============================] - 4s 54ms/step - loss: 0.0834 - acc: 0.9886
Epoch 27/28

83/83 [==============================] - 5s 55ms/step - loss: 0.0826 - acc: 0.9853
Epoch 28/28

83/83 [==============================] - 4s 54ms/step - loss: 0.0783 - acc: 0.9887
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7633
False 1438
True percentage 0.841472825488
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
     B-MISC       0.23      0.18      0.21       141
     I-MISC       0.31      0.14      0.19       154
      B-ORG       0.45      0.43      0.44       296
      B-LOC       0.73      0.51      0.60       218
      B-PER       0.83      0.55      0.66       438
      I-PER       0.79      0.39      0.52       214
      I-ORG       0.19      0.46      0.27       151
      I-LOC       0.58      0.26      0.35       141

avg / total       0.89      0.84      0.86      9071

F-1 Score (without O):
0.447639887465
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104107 unique words.
4103 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 276
OOV word occurences: in test 528
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6662912     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,042
Trainable params: 6,775,042
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 7s 84ms/step - loss: 1.0131 - acc: 0.7076
Epoch 2/28

83/83 [==============================] - 5s 55ms/step - loss: 0.4599 - acc: 0.8590
Epoch 3/28

83/83 [==============================] - 5s 54ms/step - loss: 0.3891 - acc: 0.8794
Epoch 4/28

83/83 [==============================] - 5s 55ms/step - loss: 0.3424 - acc: 0.9016
Epoch 5/28

83/83 [==============================] - 5s 55ms/step - loss: 0.3176 - acc: 0.9058
Epoch 6/28

83/83 [==============================] - 5s 55ms/step - loss: 0.2887 - acc: 0.9142
Epoch 7/28

83/83 [==============================] - 4s 54ms/step - loss: 0.2582 - acc: 0.9207
Epoch 8/28

83/83 [==============================] - 5s 56ms/step - loss: 0.2306 - acc: 0.9342
Epoch 9/28

83/83 [==============================] - 5s 55ms/step - loss: 0.2183 - acc: 0.9425
Epoch 10/28

83/83 [==============================] - 5s 56ms/step - loss: 0.1950 - acc: 0.9432
Epoch 11/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1795 - acc: 0.9575
Epoch 12/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1715 - acc: 0.9528
Epoch 13/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1478 - acc: 0.9656
Epoch 14/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1353 - acc: 0.9709
Epoch 15/28

83/83 [==============================] - 5s 56ms/step - loss: 0.1213 - acc: 0.9741
Epoch 16/28

83/83 [==============================] - 5s 55ms/step - loss: 0.1139 - acc: 0.9798
Epoch 17/28

83/83 [==============================] - 5s 56ms/step - loss: 0.1102 - acc: 0.9807
Epoch 18/28

83/83 [==============================] - 5s 56ms/step - loss: 0.0987 - acc: 0.9809
Epoch 19/28

83/83 [==============================] - 5s 55ms/step - loss: 0.0932 - acc: 0.9871
Epoch 20/28

83/83 [==============================] - 5s 56ms/step - loss: 0.0832 - acc: 0.9877
Epoch 21/28

83/83 [==============================] - 5s 56ms/step - loss: 0.0792 - acc: 0.9873
Epoch 22/28

83/83 [==============================] - 5s 56ms/step - loss: 0.0739 - acc: 0.9906
Epoch 23/28

83/83 [==============================] - 5s 55ms/step - loss: 0.0720 - acc: 0.9892
Epoch 24/28

83/83 [==============================] - 5s 55ms/step - loss: 0.0611 - acc: 0.9927
Epoch 25/28

83/83 [==============================] - 5s 55ms/step - loss: 0.0629 - acc: 0.9916
Epoch 26/28

83/83 [==============================] - 5s 55ms/step - loss: 0.0571 - acc: 0.9954
Epoch 27/28

83/83 [==============================] - 5s 54ms/step - loss: 0.0528 - acc: 0.9959
Epoch 28/28

83/83 [==============================] - 5s 56ms/step - loss: 0.0452 - acc: 0.9977
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7632
False 1439
True percentage 0.841362584059
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.87      0.43      0.58       438
      I-PER       0.77      0.21      0.32       214
          O       0.96      0.95      0.96      7318
      B-ORG       0.51      0.58      0.54       296
      B-LOC       0.72      0.59      0.65       218
      I-ORG       0.21      0.44      0.28       151
      I-LOC       0.53      0.30      0.38       141
     B-MISC       0.30      0.09      0.14       141
     I-MISC       0.29      0.19      0.23       154

avg / total       0.89      0.84      0.86      9071

F-1 Score (without O):
0.877749601934
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104069 unique words.
4065 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660480     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,610
Trainable params: 6,772,610
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 5s 141ms/step - loss: 1.6284 - acc: 0.5572
Epoch 2/28

33/33 [==============================] - 2s 69ms/step - loss: 0.4678 - acc: 0.8622
Epoch 3/28

33/33 [==============================] - 2s 68ms/step - loss: 0.3687 - acc: 0.8802
Epoch 4/28

33/33 [==============================] - 2s 69ms/step - loss: 0.3112 - acc: 0.8967
Epoch 5/28

33/33 [==============================] - 2s 67ms/step - loss: 0.3056 - acc: 0.9098
Epoch 6/28

33/33 [==============================] - 2s 68ms/step - loss: 0.2647 - acc: 0.9183
Epoch 7/28

33/33 [==============================] - 2s 67ms/step - loss: 0.2333 - acc: 0.9279
Epoch 8/28

33/33 [==============================] - 2s 68ms/step - loss: 0.2182 - acc: 0.9396
Epoch 9/28

33/33 [==============================] - 2s 69ms/step - loss: 0.2058 - acc: 0.9379
Epoch 10/28

33/33 [==============================] - 2s 68ms/step - loss: 0.1921 - acc: 0.9534
Epoch 11/28

33/33 [==============================] - 2s 69ms/step - loss: 0.1925 - acc: 0.9484
Epoch 12/28

33/33 [==============================] - 2s 69ms/step - loss: 0.1777 - acc: 0.9439
Epoch 13/28

33/33 [==============================] - 2s 69ms/step - loss: 0.1651 - acc: 0.9547
Epoch 14/28

33/33 [==============================] - 2s 69ms/step - loss: 0.1596 - acc: 0.9534
Epoch 15/28

33/33 [==============================] - 2s 69ms/step - loss: 0.1592 - acc: 0.9561
Epoch 16/28

33/33 [==============================] - 2s 68ms/step - loss: 0.1436 - acc: 0.9609
Epoch 17/28

33/33 [==============================] - 2s 69ms/step - loss: 0.1441 - acc: 0.9615
Epoch 18/28

33/33 [==============================] - 2s 70ms/step - loss: 0.1371 - acc: 0.9595
Epoch 19/28

33/33 [==============================] - 2s 69ms/step - loss: 0.1317 - acc: 0.9615
Epoch 20/28

33/33 [==============================] - 2s 69ms/step - loss: 0.1346 - acc: 0.9571
Epoch 21/28

33/33 [==============================] - 2s 69ms/step - loss: 0.1287 - acc: 0.9576
Epoch 22/28

33/33 [==============================] - 2s 70ms/step - loss: 0.1160 - acc: 0.9750
Epoch 23/28

33/33 [==============================] - 2s 67ms/step - loss: 0.1211 - acc: 0.9696
Epoch 24/28

33/33 [==============================] - 2s 70ms/step - loss: 0.1141 - acc: 0.9681
Epoch 25/28

33/33 [==============================] - 2s 68ms/step - loss: 0.1084 - acc: 0.9696
Epoch 26/28

33/33 [==============================] - 2s 68ms/step - loss: 0.1111 - acc: 0.9688
Epoch 27/28

33/33 [==============================] - 2s 68ms/step - loss: 0.1062 - acc: 0.9742
Epoch 28/28

33/33 [==============================] - 2s 69ms/step - loss: 0.0985 - acc: 0.9765
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7159
False 1912
True percentage 0.78921838827
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.93      0.93      7318
      B-PER       0.44      0.28      0.34       438
      B-ORG       0.22      0.43      0.30       296
      I-ORG       0.15      0.26      0.19       151
      I-PER       0.60      0.28      0.38       214
      B-LOC       0.00      0.00      0.00       218
     B-MISC       0.00      0.00      0.00       141
      I-LOC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.80      0.79      0.79      9071

F-1 Score (without O):
0.235175202156
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104062 unique words.
4058 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 281
OOV word occurences: in test 473
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660032     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,162
Trainable params: 6,772,162
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 5s 143ms/step - loss: 1.8741 - acc: 0.4495
Epoch 2/28

33/33 [==============================] - 2s 67ms/step - loss: 0.6806 - acc: 0.8007
Epoch 3/28

33/33 [==============================] - 2s 67ms/step - loss: 0.5642 - acc: 0.8304
Epoch 4/28

33/33 [==============================] - 2s 69ms/step - loss: 0.4844 - acc: 0.8472
Epoch 5/28

33/33 [==============================] - 2s 68ms/step - loss: 0.4224 - acc: 0.8533
Epoch 6/28

33/33 [==============================] - 2s 69ms/step - loss: 0.4549 - acc: 0.8305
Epoch 7/28

33/33 [==============================] - 2s 69ms/step - loss: 0.6015 - acc: 0.8439
Epoch 8/28

33/33 [==============================] - 2s 68ms/step - loss: 0.3470 - acc: 0.8965
Epoch 9/28

33/33 [==============================] - 2s 69ms/step - loss: 0.3135 - acc: 0.9202
Epoch 10/28

33/33 [==============================] - 2s 69ms/step - loss: 0.2920 - acc: 0.9215
Epoch 11/28

33/33 [==============================] - 2s 68ms/step - loss: 0.2957 - acc: 0.8858
Epoch 12/28

33/33 [==============================] - 2s 69ms/step - loss: 0.2647 - acc: 0.9347
Epoch 13/28

33/33 [==============================] - 2s 68ms/step - loss: 0.2540 - acc: 0.9346
Epoch 14/28

33/33 [==============================] - 2s 68ms/step - loss: 0.2592 - acc: 0.9325
Epoch 15/28

33/33 [==============================] - 2s 69ms/step - loss: 0.2389 - acc: 0.9417
Epoch 16/28

33/33 [==============================] - 2s 69ms/step - loss: 0.2280 - acc: 0.9387
Epoch 17/28

33/33 [==============================] - 2s 70ms/step - loss: 0.2131 - acc: 0.9568
Epoch 18/28

33/33 [==============================] - 2s 68ms/step - loss: 0.2034 - acc: 0.9729
Epoch 19/28

33/33 [==============================] - 2s 69ms/step - loss: 0.1966 - acc: 0.9664
Epoch 20/28

33/33 [==============================] - 2s 68ms/step - loss: 0.1875 - acc: 0.9652
Epoch 21/28

33/33 [==============================] - 2s 69ms/step - loss: 0.1931 - acc: 0.9617
Epoch 22/28

33/33 [==============================] - 2s 70ms/step - loss: 0.1759 - acc: 0.9695
Epoch 23/28

33/33 [==============================] - 2s 68ms/step - loss: 0.1670 - acc: 0.9743
Epoch 24/28

33/33 [==============================] - 2s 69ms/step - loss: 0.1539 - acc: 0.9812
Epoch 25/28

33/33 [==============================] - 2s 69ms/step - loss: 0.1486 - acc: 0.9694
Epoch 26/28

33/33 [==============================] - 2s 70ms/step - loss: 0.1405 - acc: 0.9770
Epoch 27/28

33/33 [==============================] - 2s 69ms/step - loss: 0.1423 - acc: 0.9749
Epoch 28/28

33/33 [==============================] - 2s 68ms/step - loss: 0.1344 - acc: 0.9775
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7459
False 1612
True percentage 0.822290816889
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.93      0.95      7318
      B-PER       0.51      0.59      0.55       438
      B-ORG       0.43      0.34      0.38       296
      I-ORG       0.16      0.29      0.20       151
     B-MISC       0.31      0.18      0.23       141
     I-MISC       0.21      0.29      0.24       154
      I-PER       0.67      0.36      0.47       214
      B-LOC       0.53      0.49      0.51       218
      I-LOC       1.00      0.02      0.04       141

avg / total       0.88      0.82      0.84      9071

F-1 Score (without O):
0.38961038961
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104087 unique words.
4083 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 553
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6661632     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,773,762
Trainable params: 6,773,762
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 5s 141ms/step - loss: 2.1235 - acc: 0.3734
Epoch 2/28

33/33 [==============================] - 2s 68ms/step - loss: 0.8468 - acc: 0.7755
Epoch 3/28

33/33 [==============================] - 2s 67ms/step - loss: 0.9222 - acc: 0.7770
Epoch 4/28

33/33 [==============================] - 2s 69ms/step - loss: 0.6130 - acc: 0.8076
Epoch 5/28

33/33 [==============================] - 2s 67ms/step - loss: 0.5773 - acc: 0.7996
Epoch 6/28

33/33 [==============================] - 2s 69ms/step - loss: 0.5528 - acc: 0.8413
Epoch 7/28

33/33 [==============================] - 2s 69ms/step - loss: 0.4738 - acc: 0.8456
Epoch 8/28

33/33 [==============================] - 2s 68ms/step - loss: 0.4329 - acc: 0.8591
Epoch 9/28

33/33 [==============================] - 2s 69ms/step - loss: 0.4914 - acc: 0.8342
Epoch 10/28

33/33 [==============================] - 2s 69ms/step - loss: 0.4023 - acc: 0.8821
Epoch 11/28

33/33 [==============================] - 2s 68ms/step - loss: 0.3815 - acc: 0.8759
Epoch 12/28

33/33 [==============================] - 2s 70ms/step - loss: 0.3825 - acc: 0.8775
Epoch 13/28

33/33 [==============================] - 2s 68ms/step - loss: 0.3659 - acc: 0.8864
Epoch 14/28

33/33 [==============================] - 2s 68ms/step - loss: 0.3323 - acc: 0.8973
Epoch 15/28

33/33 [==============================] - 2s 69ms/step - loss: 0.3677 - acc: 0.8831
Epoch 16/28

33/33 [==============================] - 2s 68ms/step - loss: 0.3346 - acc: 0.8928
Epoch 17/28

33/33 [==============================] - 2s 70ms/step - loss: 0.2896 - acc: 0.9331
Epoch 18/28

33/33 [==============================] - 2s 69ms/step - loss: 0.2795 - acc: 0.9330
Epoch 19/28

33/33 [==============================] - 2s 68ms/step - loss: 0.2709 - acc: 0.9283
Epoch 20/28

33/33 [==============================] - 2s 69ms/step - loss: 0.2563 - acc: 0.9347
Epoch 21/28

33/33 [==============================] - 2s 68ms/step - loss: 0.2629 - acc: 0.9229
Epoch 22/28

33/33 [==============================] - 2s 68ms/step - loss: 0.2517 - acc: 0.9241
Epoch 23/28

33/33 [==============================] - 2s 68ms/step - loss: 0.2454 - acc: 0.9384
Epoch 24/28

33/33 [==============================] - 2s 67ms/step - loss: 0.2160 - acc: 0.9457
Epoch 25/28

33/33 [==============================] - 2s 69ms/step - loss: 0.2240 - acc: 0.9445
Epoch 26/28

33/33 [==============================] - 2s 68ms/step - loss: 0.2193 - acc: 0.9558
Epoch 27/28

33/33 [==============================] - 2s 69ms/step - loss: 0.1954 - acc: 0.9627
Epoch 28/28

33/33 [==============================] - 2s 69ms/step - loss: 0.1920 - acc: 0.9688
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7370
False 1701
True percentage 0.812479329732
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.94      0.95      7318
      B-ORG       0.31      0.50      0.38       296
      B-PER       0.43      0.30      0.35       438
      I-PER       0.47      0.21      0.29       214
      B-LOC       0.72      0.32      0.44       218
      I-LOC       0.53      0.28      0.36       141
      I-ORG       0.17      0.26      0.21       151
     B-MISC       0.35      0.05      0.09       141
     I-MISC       0.32      0.20      0.25       154

avg / total       0.86      0.81      0.83      9071

F-1 Score (without O):
0.323174603175
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104068 unique words.
4064 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 279
OOV word occurences: in test 482
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660416     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,546
Trainable params: 6,772,546
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 5s 141ms/step - loss: 1.8009 - acc: 0.4416
Epoch 2/28

33/33 [==============================] - 2s 68ms/step - loss: 0.6210 - acc: 0.8078
Epoch 3/28

33/33 [==============================] - 2s 68ms/step - loss: 0.5788 - acc: 0.8221
Epoch 4/28

33/33 [==============================] - 2s 69ms/step - loss: 0.4735 - acc: 0.8421
Epoch 5/28

33/33 [==============================] - 2s 69ms/step - loss: 0.4345 - acc: 0.8638
Epoch 6/28

33/33 [==============================] - 2s 68ms/step - loss: 0.4090 - acc: 0.8731
Epoch 7/28

33/33 [==============================] - 2s 68ms/step - loss: 0.4108 - acc: 0.8686
Epoch 8/28

33/33 [==============================] - 2s 68ms/step - loss: 0.4207 - acc: 0.8809
Epoch 9/28

33/33 [==============================] - 2s 68ms/step - loss: 0.3497 - acc: 0.8882
Epoch 10/28

33/33 [==============================] - 2s 67ms/step - loss: 0.3261 - acc: 0.9135
Epoch 11/28

33/33 [==============================] - 2s 69ms/step - loss: 0.3058 - acc: 0.9172
Epoch 12/28

33/33 [==============================] - 2s 68ms/step - loss: 0.2822 - acc: 0.9257
Epoch 13/28

33/33 [==============================] - 2s 68ms/step - loss: 0.2716 - acc: 0.9268
Epoch 14/28

33/33 [==============================] - 2s 68ms/step - loss: 0.2827 - acc: 0.9102
Epoch 15/28

33/33 [==============================] - 2s 69ms/step - loss: 0.2605 - acc: 0.9244
Epoch 16/28

33/33 [==============================] - 2s 67ms/step - loss: 0.2558 - acc: 0.9239
Epoch 17/28

33/33 [==============================] - 2s 68ms/step - loss: 0.2578 - acc: 0.9185
Epoch 18/28

33/33 [==============================] - 2s 69ms/step - loss: 0.2296 - acc: 0.9374
Epoch 19/28

33/33 [==============================] - 2s 69ms/step - loss: 0.2323 - acc: 0.9459
Epoch 20/28

33/33 [==============================] - 2s 70ms/step - loss: 0.2112 - acc: 0.9536
Epoch 21/28

33/33 [==============================] - 2s 68ms/step - loss: 0.2051 - acc: 0.9501
Epoch 22/28

33/33 [==============================] - 2s 68ms/step - loss: 0.2032 - acc: 0.9530
Epoch 23/28

33/33 [==============================] - 2s 69ms/step - loss: 0.2038 - acc: 0.9529
Epoch 24/28

33/33 [==============================] - 2s 68ms/step - loss: 0.2028 - acc: 0.9589
Epoch 25/28

33/33 [==============================] - 2s 68ms/step - loss: 0.1809 - acc: 0.9597
Epoch 26/28

33/33 [==============================] - 2s 69ms/step - loss: 0.1708 - acc: 0.9641
Epoch 27/28

33/33 [==============================] - 2s 68ms/step - loss: 0.1675 - acc: 0.9705
Epoch 28/28

33/33 [==============================] - 2s 69ms/step - loss: 0.1667 - acc: 0.9614
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7404
False 1667
True percentage 0.816227538309
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.94      0.95      7318
     B-MISC       0.20      0.18      0.19       141
     I-MISC       0.25      0.12      0.16       154
      B-ORG       0.32      0.40      0.35       296
      B-LOC       0.54      0.57      0.56       218
      B-PER       0.76      0.33      0.46       438
      I-PER       0.52      0.20      0.29       214
      I-ORG       0.12      0.30      0.17       151
      I-LOC       0.00      0.00      0.00       141

avg / total       0.86      0.82      0.83      9071

F-1 Score (without O):
0.323383084577
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104068 unique words.
4064 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 281
OOV word occurences: in test 534
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660416     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,546
Trainable params: 6,772,546
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 5s 142ms/step - loss: 1.8036 - acc: 0.4364
Epoch 2/28

33/33 [==============================] - 2s 67ms/step - loss: 0.7632 - acc: 0.8172
Epoch 3/28

33/33 [==============================] - 2s 69ms/step - loss: 0.6137 - acc: 0.8158
Epoch 4/28

33/33 [==============================] - 2s 68ms/step - loss: 0.6787 - acc: 0.8203
Epoch 5/28

33/33 [==============================] - 2s 69ms/step - loss: 0.4900 - acc: 0.8463
Epoch 6/28

33/33 [==============================] - 2s 68ms/step - loss: 0.4469 - acc: 0.8560
Epoch 7/28

33/33 [==============================] - 2s 69ms/step - loss: 0.4123 - acc: 0.8689
Epoch 8/28

33/33 [==============================] - 2s 69ms/step - loss: 0.3947 - acc: 0.8773
Epoch 9/28

33/33 [==============================] - 2s 69ms/step - loss: 0.3637 - acc: 0.8910
Epoch 10/28

33/33 [==============================] - 2s 68ms/step - loss: 0.3503 - acc: 0.8973
Epoch 11/28

33/33 [==============================] - 2s 69ms/step - loss: 0.3413 - acc: 0.8922
Epoch 12/28

33/33 [==============================] - 2s 70ms/step - loss: 0.3273 - acc: 0.9051
Epoch 13/28

33/33 [==============================] - 2s 68ms/step - loss: 0.3187 - acc: 0.8985
Epoch 14/28

33/33 [==============================] - 2s 67ms/step - loss: 0.3140 - acc: 0.8991
Epoch 15/28

33/33 [==============================] - 2s 70ms/step - loss: 0.2819 - acc: 0.9103
Epoch 16/28

33/33 [==============================] - 2s 69ms/step - loss: 0.2874 - acc: 0.9033
Epoch 17/28

33/33 [==============================] - 2s 69ms/step - loss: 0.2604 - acc: 0.9175
Epoch 18/28

33/33 [==============================] - 2s 69ms/step - loss: 0.2513 - acc: 0.9269
Epoch 19/28

33/33 [==============================] - 2s 69ms/step - loss: 0.2297 - acc: 0.9424
Epoch 20/28

33/33 [==============================] - 2s 69ms/step - loss: 0.2273 - acc: 0.9460
Epoch 21/28

33/33 [==============================] - 2s 69ms/step - loss: 0.2184 - acc: 0.9502
Epoch 22/28

33/33 [==============================] - 2s 69ms/step - loss: 0.1972 - acc: 0.9376
Epoch 23/28

33/33 [==============================] - 2s 69ms/step - loss: 0.2393 - acc: 0.9250
Epoch 24/28

33/33 [==============================] - 2s 69ms/step - loss: 0.1970 - acc: 0.9550
Epoch 25/28

33/33 [==============================] - 2s 69ms/step - loss: 0.1860 - acc: 0.9607
Epoch 26/28

33/33 [==============================] - 2s 69ms/step - loss: 0.1642 - acc: 0.9629
Epoch 27/28

33/33 [==============================] - 2s 67ms/step - loss: 0.1620 - acc: 0.9710
Epoch 28/28

33/33 [==============================] - 2s 68ms/step - loss: 0.1566 - acc: 0.9674
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7388
False 1683
True percentage 0.814463675449
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.68      0.41      0.51       438
      I-PER       0.83      0.07      0.13       214
          O       0.97      0.94      0.95      7318
      B-ORG       0.33      0.55      0.41       296
      B-LOC       0.58      0.35      0.43       218
      I-ORG       0.17      0.46      0.25       151
      I-LOC       0.57      0.06      0.10       141
     B-MISC       0.36      0.04      0.06       141
     I-MISC       0.19      0.15      0.17       154

avg / total       0.88      0.81      0.83      9071

F-1 Score (without O):
0.852833313616
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 7 unique labels.
Found 104057 unique words.
4053 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659712     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 8)        1112        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,544
Trainable params: 6,771,544
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 3s 200ms/step - loss: 1.6437 - acc: 0.3652
Epoch 2/28

16/16 [==============================] - 1s 47ms/step - loss: 0.7058 - acc: 0.8287
Epoch 3/28

16/16 [==============================] - 1s 47ms/step - loss: 0.5483 - acc: 0.8596
Epoch 4/28

16/16 [==============================] - 1s 46ms/step - loss: 0.4827 - acc: 0.8343
Epoch 5/28

16/16 [==============================] - 1s 48ms/step - loss: 0.3948 - acc: 0.8736
Epoch 6/28

16/16 [==============================] - 1s 46ms/step - loss: 0.3128 - acc: 0.8708
Epoch 7/28

16/16 [==============================] - 1s 48ms/step - loss: 0.2822 - acc: 0.9157
Epoch 8/28

16/16 [==============================] - 1s 47ms/step - loss: 0.2564 - acc: 0.9157
Epoch 9/28

16/16 [==============================] - 1s 46ms/step - loss: 0.2378 - acc: 0.9382
Epoch 10/28

16/16 [==============================] - 1s 48ms/step - loss: 0.2398 - acc: 0.9073
Epoch 11/28

16/16 [==============================] - 1s 48ms/step - loss: 0.2322 - acc: 0.9607
Epoch 12/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1915 - acc: 0.9522
Epoch 13/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1756 - acc: 0.9691
Epoch 14/28

16/16 [==============================] - 1s 47ms/step - loss: 0.1530 - acc: 0.9719
Epoch 15/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1421 - acc: 0.9663
Epoch 16/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1393 - acc: 0.9691
Epoch 17/28

16/16 [==============================] - 1s 49ms/step - loss: 0.1252 - acc: 0.9775
Epoch 18/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1121 - acc: 0.9691
Epoch 19/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1095 - acc: 0.9775
Epoch 20/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1059 - acc: 0.9831
Epoch 21/28

16/16 [==============================] - 1s 49ms/step - loss: 0.1113 - acc: 0.9747
Epoch 22/28

16/16 [==============================] - 1s 49ms/step - loss: 0.0903 - acc: 0.9831
Epoch 23/28

16/16 [==============================] - 1s 46ms/step - loss: 0.0875 - acc: 0.9888
Epoch 24/28

16/16 [==============================] - 1s 46ms/step - loss: 0.0949 - acc: 0.9831
Epoch 25/28

16/16 [==============================] - 1s 46ms/step - loss: 0.0863 - acc: 0.9831
Epoch 26/28

16/16 [==============================] - 1s 48ms/step - loss: 0.0701 - acc: 0.9916
Epoch 27/28

16/16 [==============================] - 1s 48ms/step - loss: 0.0647 - acc: 0.9888
Epoch 28/28

16/16 [==============================] - 1s 48ms/step - loss: 0.0684 - acc: 0.9831
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7179
False 1597
True percentage 0.818026435734
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.93      0.94      7318
      B-PER       0.51      0.27      0.35       438
      B-ORG       0.22      0.45      0.29       296
      I-ORG       0.15      0.30      0.20       151
      I-PER       0.65      0.19      0.30       214
      B-LOC       0.00      0.00      0.00       218
     B-MISC       0.00      0.00      0.00       141

avg / total       0.83      0.82      0.82      8776

F-1 Score (without O):
0.252339947585
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104046 unique words.
4042 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659008     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,138
Trainable params: 6,771,138
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 3s 200ms/step - loss: 2.4870 - acc: 0.0559
Epoch 2/28

16/16 [==============================] - 1s 47ms/step - loss: 0.8896 - acc: 0.8265
Epoch 3/28

16/16 [==============================] - 1s 47ms/step - loss: 0.6833 - acc: 0.8265
Epoch 4/28

16/16 [==============================] - 1s 47ms/step - loss: 0.5574 - acc: 0.8265
Epoch 5/28

16/16 [==============================] - 1s 46ms/step - loss: 0.5869 - acc: 0.8706
Epoch 6/28

16/16 [==============================] - 1s 47ms/step - loss: 0.7742 - acc: 0.8265
Epoch 7/28

16/16 [==============================] - 1s 48ms/step - loss: 0.4545 - acc: 0.8647
Epoch 8/28

16/16 [==============================] - 1s 47ms/step - loss: 0.4115 - acc: 0.8676
Epoch 9/28

16/16 [==============================] - 1s 47ms/step - loss: 0.3803 - acc: 0.8971
Epoch 10/28

16/16 [==============================] - 1s 47ms/step - loss: 0.3530 - acc: 0.8706
Epoch 11/28

16/16 [==============================] - 1s 47ms/step - loss: 0.3292 - acc: 0.9176
Epoch 12/28

16/16 [==============================] - 1s 47ms/step - loss: 0.3027 - acc: 0.9176
Epoch 13/28

16/16 [==============================] - 1s 47ms/step - loss: 0.2785 - acc: 0.9265
Epoch 14/28

16/16 [==============================] - 1s 47ms/step - loss: 0.2756 - acc: 0.9324
Epoch 15/28

16/16 [==============================] - 1s 47ms/step - loss: 0.2634 - acc: 0.9382
Epoch 16/28

16/16 [==============================] - 1s 49ms/step - loss: 0.2507 - acc: 0.9324
Epoch 17/28

16/16 [==============================] - 1s 48ms/step - loss: 0.2319 - acc: 0.9441
Epoch 18/28

16/16 [==============================] - 1s 48ms/step - loss: 0.2207 - acc: 0.9412
Epoch 19/28

16/16 [==============================] - 1s 48ms/step - loss: 0.2162 - acc: 0.9559
Epoch 20/28

16/16 [==============================] - 1s 46ms/step - loss: 0.1959 - acc: 0.9441
Epoch 21/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1842 - acc: 0.9588
Epoch 22/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1766 - acc: 0.9618
Epoch 23/28

16/16 [==============================] - 1s 47ms/step - loss: 0.1694 - acc: 0.9647
Epoch 24/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1528 - acc: 0.9735
Epoch 25/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1466 - acc: 0.9794
Epoch 26/28

16/16 [==============================] - 1s 46ms/step - loss: 0.1373 - acc: 0.9853
Epoch 27/28

16/16 [==============================] - 1s 47ms/step - loss: 0.1330 - acc: 0.9794
Epoch 28/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1249 - acc: 0.9824
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7229
False 1842
True percentage 0.796935288281
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.92      0.94      0.93      7318
      B-PER       0.57      0.22      0.32       438
      B-ORG       0.27      0.41      0.32       296
      I-ORG       0.23      0.09      0.13       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      I-PER       0.22      0.26      0.24       214
      B-LOC       0.59      0.21      0.31       218
      I-LOC       0.00      0.00      0.00       141

avg / total       0.80      0.80      0.79      9071

F-1 Score (without O):
0.241678726483
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104060 unique words.
4056 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 567
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659904     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,034
Trainable params: 6,772,034
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 3s 200ms/step - loss: 2.6586 - acc: 0.1259
Epoch 2/28

16/16 [==============================] - 1s 46ms/step - loss: 1.0908 - acc: 0.7601
Epoch 3/28

16/16 [==============================] - 1s 45ms/step - loss: 0.7703 - acc: 0.7648
Epoch 4/28

16/16 [==============================] - 1s 48ms/step - loss: 0.6197 - acc: 0.8100
Epoch 5/28

16/16 [==============================] - 1s 47ms/step - loss: 0.5384 - acc: 0.8124
Epoch 6/28

16/16 [==============================] - 1s 46ms/step - loss: 0.9074 - acc: 0.7862
Epoch 7/28

16/16 [==============================] - 1s 48ms/step - loss: 0.5887 - acc: 0.7886
Epoch 8/28

16/16 [==============================] - 1s 46ms/step - loss: 0.4092 - acc: 0.9026
Epoch 9/28

16/16 [==============================] - 1s 46ms/step - loss: 0.3775 - acc: 0.9216
Epoch 10/28

16/16 [==============================] - 1s 47ms/step - loss: 0.3630 - acc: 0.9097
Epoch 11/28

16/16 [==============================] - 1s 48ms/step - loss: 0.3226 - acc: 0.9192
Epoch 12/28

16/16 [==============================] - 1s 47ms/step - loss: 0.3099 - acc: 0.9121
Epoch 13/28

16/16 [==============================] - 1s 47ms/step - loss: 0.2916 - acc: 0.9311
Epoch 14/28

16/16 [==============================] - 1s 48ms/step - loss: 0.2660 - acc: 0.9477
Epoch 15/28

16/16 [==============================] - 1s 46ms/step - loss: 0.2778 - acc: 0.9287
Epoch 16/28

16/16 [==============================] - 1s 47ms/step - loss: 0.2480 - acc: 0.9454
Epoch 17/28

16/16 [==============================] - 1s 48ms/step - loss: 0.2308 - acc: 0.9477
Epoch 18/28

16/16 [==============================] - 1s 46ms/step - loss: 0.2232 - acc: 0.9501
Epoch 19/28

16/16 [==============================] - 1s 47ms/step - loss: 0.2067 - acc: 0.9549
Epoch 20/28

16/16 [==============================] - 1s 49ms/step - loss: 0.1894 - acc: 0.9525
Epoch 21/28

16/16 [==============================] - 1s 46ms/step - loss: 0.1757 - acc: 0.9715
Epoch 22/28

16/16 [==============================] - 1s 46ms/step - loss: 0.1701 - acc: 0.9667
Epoch 23/28

16/16 [==============================] - 1s 47ms/step - loss: 0.1642 - acc: 0.9667
Epoch 24/28

16/16 [==============================] - 1s 46ms/step - loss: 0.1583 - acc: 0.9715
Epoch 25/28

16/16 [==============================] - 1s 46ms/step - loss: 0.1426 - acc: 0.9786
Epoch 26/28

16/16 [==============================] - 1s 47ms/step - loss: 0.1415 - acc: 0.9739
Epoch 27/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1205 - acc: 0.9857
Epoch 28/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1169 - acc: 0.9857
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7322
False 1749
True percentage 0.807187741153
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.95      0.94      7318
      B-ORG       0.33      0.31      0.32       296
      B-PER       0.42      0.27      0.33       438
      I-PER       0.42      0.34      0.38       214
      B-LOC       0.66      0.31      0.42       218
      I-LOC       0.82      0.06      0.12       141
      I-ORG       0.14      0.21      0.16       151
     B-MISC       0.30      0.04      0.07       141
     I-MISC       0.31      0.03      0.05       154

avg / total       0.84      0.81      0.81      9071

F-1 Score (without O):
0.281228192603
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104057 unique words.
4053 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 281
OOV word occurences: in test 492
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659712     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,842
Trainable params: 6,771,842
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 3s 199ms/step - loss: 2.3019 - acc: 0.1014
Epoch 2/28

16/16 [==============================] - 1s 47ms/step - loss: 0.9228 - acc: 0.7890
Epoch 3/28

16/16 [==============================] - 1s 46ms/step - loss: 0.8329 - acc: 0.8274
Epoch 4/28

16/16 [==============================] - 1s 48ms/step - loss: 0.8146 - acc: 0.7890
Epoch 5/28

16/16 [==============================] - 1s 47ms/step - loss: 0.6039 - acc: 0.8247
Epoch 6/28

16/16 [==============================] - 1s 47ms/step - loss: 0.5232 - acc: 0.8301
Epoch 7/28

16/16 [==============================] - 1s 46ms/step - loss: 0.4918 - acc: 0.8329
Epoch 8/28

16/16 [==============================] - 1s 46ms/step - loss: 0.4320 - acc: 0.8630
Epoch 9/28

16/16 [==============================] - 1s 47ms/step - loss: 0.3946 - acc: 0.8685
Epoch 10/28

16/16 [==============================] - 1s 46ms/step - loss: 0.3781 - acc: 0.8712
Epoch 11/28

16/16 [==============================] - 1s 46ms/step - loss: 0.3284 - acc: 0.8959
Epoch 12/28

16/16 [==============================] - 1s 46ms/step - loss: 0.3140 - acc: 0.9151
Epoch 13/28

16/16 [==============================] - 1s 46ms/step - loss: 0.2934 - acc: 0.9233
Epoch 14/28

16/16 [==============================] - 1s 49ms/step - loss: 0.2772 - acc: 0.9260
Epoch 15/28

16/16 [==============================] - 1s 46ms/step - loss: 0.2585 - acc: 0.9370
Epoch 16/28

16/16 [==============================] - 1s 48ms/step - loss: 0.2794 - acc: 0.8932
Epoch 17/28

16/16 [==============================] - 1s 46ms/step - loss: 0.3227 - acc: 0.9123
Epoch 18/28

16/16 [==============================] - 1s 47ms/step - loss: 0.2391 - acc: 0.9397
Epoch 19/28

16/16 [==============================] - 1s 47ms/step - loss: 0.2129 - acc: 0.9753
Epoch 20/28

16/16 [==============================] - 1s 48ms/step - loss: 0.2144 - acc: 0.9589
Epoch 21/28

16/16 [==============================] - 1s 47ms/step - loss: 0.1962 - acc: 0.9644
Epoch 22/28

16/16 [==============================] - 1s 47ms/step - loss: 0.1891 - acc: 0.9753
Epoch 23/28

16/16 [==============================] - 1s 47ms/step - loss: 0.1658 - acc: 0.9753
Epoch 24/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1578 - acc: 0.9836
Epoch 25/28

16/16 [==============================] - 1s 46ms/step - loss: 0.1489 - acc: 0.9863
Epoch 26/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1545 - acc: 0.9644
Epoch 27/28

16/16 [==============================] - 1s 46ms/step - loss: 0.1329 - acc: 0.9863
Epoch 28/28

16/16 [==============================] - 1s 46ms/step - loss: 0.1499 - acc: 0.9836
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7105
False 1966
True percentage 0.783265351119
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.92      0.94      7318
     B-MISC       0.12      0.28      0.17       141
     I-MISC       0.22      0.07      0.11       154
      B-ORG       0.27      0.34      0.30       296
      B-LOC       0.78      0.15      0.25       218
      B-PER       0.74      0.26      0.38       438
      I-PER       0.55      0.03      0.05       214
      I-ORG       0.10      0.32      0.15       151
      I-LOC       0.00      0.00      0.00       141

avg / total       0.85      0.78      0.80      9071

F-1 Score (without O):
0.217797137523
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104046 unique words.
4042 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659008     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,138
Trainable params: 6,771,138
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 3s 199ms/step - loss: 2.8459 - acc: 0.0256
Epoch 2/28

16/16 [==============================] - 1s 48ms/step - loss: 1.1748 - acc: 0.8013
Epoch 3/28

16/16 [==============================] - 1s 47ms/step - loss: 0.7393 - acc: 0.8173
Epoch 4/28

16/16 [==============================] - 1s 46ms/step - loss: 0.6405 - acc: 0.8558
Epoch 5/28

16/16 [==============================] - 1s 47ms/step - loss: 0.6157 - acc: 0.8205
Epoch 6/28

16/16 [==============================] - 1s 47ms/step - loss: 0.5397 - acc: 0.8878
Epoch 7/28

16/16 [==============================] - 1s 47ms/step - loss: 0.4541 - acc: 0.8333
Epoch 8/28

16/16 [==============================] - 1s 47ms/step - loss: 0.4147 - acc: 0.8846
Epoch 9/28

16/16 [==============================] - 1s 47ms/step - loss: 0.3843 - acc: 0.8686
Epoch 10/28

16/16 [==============================] - 1s 47ms/step - loss: 0.3453 - acc: 0.8942
Epoch 11/28

16/16 [==============================] - 1s 47ms/step - loss: 0.3348 - acc: 0.8942
Epoch 12/28

16/16 [==============================] - 1s 47ms/step - loss: 0.3200 - acc: 0.8878
Epoch 13/28

16/16 [==============================] - 1s 47ms/step - loss: 0.3087 - acc: 0.9071
Epoch 14/28

16/16 [==============================] - 1s 48ms/step - loss: 0.2591 - acc: 0.9199
Epoch 15/28

16/16 [==============================] - 1s 46ms/step - loss: 0.2583 - acc: 0.9327
Epoch 16/28

16/16 [==============================] - 1s 47ms/step - loss: 0.2462 - acc: 0.9359
Epoch 17/28

16/16 [==============================] - 1s 47ms/step - loss: 0.2301 - acc: 0.9295
Epoch 18/28

16/16 [==============================] - 1s 48ms/step - loss: 0.2269 - acc: 0.9391
Epoch 19/28

16/16 [==============================] - 1s 47ms/step - loss: 0.2098 - acc: 0.9455
Epoch 20/28

16/16 [==============================] - 1s 46ms/step - loss: 0.2013 - acc: 0.9519
Epoch 21/28

16/16 [==============================] - 1s 46ms/step - loss: 0.1978 - acc: 0.9679
Epoch 22/28

16/16 [==============================] - 1s 49ms/step - loss: 0.1785 - acc: 0.9679
Epoch 23/28

16/16 [==============================] - 1s 47ms/step - loss: 0.1725 - acc: 0.9808
Epoch 24/28

16/16 [==============================] - 1s 46ms/step - loss: 0.1761 - acc: 0.9615
Epoch 25/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1630 - acc: 0.9712
Epoch 26/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1411 - acc: 0.9808
Epoch 27/28

16/16 [==============================] - 1s 48ms/step - loss: 0.1355 - acc: 0.9840
Epoch 28/28

16/16 [==============================] - 1s 47ms/step - loss: 0.1324 - acc: 0.9808
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7222
False 1849
True percentage 0.79616359828
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.47      0.21      0.29       438
      I-PER       0.00      0.00      0.00       214
          O       0.94      0.93      0.94      7318
      B-ORG       0.29      0.36      0.32       296
      B-LOC       0.52      0.39      0.45       218
      I-ORG       0.13      0.28      0.17       151
      I-LOC       0.39      0.34      0.36       141
     B-MISC       0.15      0.03      0.05       141
     I-MISC       0.20      0.01      0.02       154

avg / total       0.82      0.80      0.80      9071

F-1 Score (without O):
0.841806908769
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 6 unique labels.
Found 104044 unique words.
4040 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658880     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 7)        966         bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,566
Trainable params: 6,770,566
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 3s 396ms/step - loss: 1.5078 - acc: 0.5967
Epoch 2/28

8/8 [==============================] - 1s 90ms/step - loss: 0.6364 - acc: 0.8729
Epoch 3/28

8/8 [==============================] - 1s 92ms/step - loss: 0.4801 - acc: 0.8840
Epoch 4/28

8/8 [==============================] - 1s 93ms/step - loss: 0.4018 - acc: 0.8729
Epoch 5/28

8/8 [==============================] - 1s 94ms/step - loss: 0.3111 - acc: 0.9227
Epoch 6/28

8/8 [==============================] - 1s 91ms/step - loss: 0.2617 - acc: 0.9006
Epoch 7/28

8/8 [==============================] - 1s 91ms/step - loss: 0.2149 - acc: 0.9558
Epoch 8/28

8/8 [==============================] - 1s 92ms/step - loss: 0.1831 - acc: 0.9392
Epoch 9/28

8/8 [==============================] - 1s 92ms/step - loss: 0.1467 - acc: 0.9834
Epoch 10/28

8/8 [==============================] - 1s 95ms/step - loss: 0.1318 - acc: 0.9834
Epoch 11/28

8/8 [==============================] - 1s 93ms/step - loss: 0.1183 - acc: 0.9834
Epoch 12/28

8/8 [==============================] - 1s 95ms/step - loss: 0.0963 - acc: 0.9779
Epoch 13/28

8/8 [==============================] - 1s 95ms/step - loss: 0.0923 - acc: 0.9890
Epoch 14/28

8/8 [==============================] - 1s 92ms/step - loss: 0.0870 - acc: 0.9834
Epoch 15/28

8/8 [==============================] - 1s 92ms/step - loss: 0.0713 - acc: 0.9890
Epoch 16/28

8/8 [==============================] - 1s 94ms/step - loss: 0.0639 - acc: 0.9945
Epoch 17/28

8/8 [==============================] - 1s 95ms/step - loss: 0.0626 - acc: 0.9945
Epoch 18/28

8/8 [==============================] - 1s 94ms/step - loss: 0.0490 - acc: 0.9945
Epoch 19/28

8/8 [==============================] - 1s 94ms/step - loss: 0.0484 - acc: 1.0000
Epoch 20/28

8/8 [==============================] - 1s 95ms/step - loss: 0.0435 - acc: 0.9945
Epoch 21/28

8/8 [==============================] - 1s 94ms/step - loss: 0.0359 - acc: 1.0000
Epoch 22/28

8/8 [==============================] - 1s 93ms/step - loss: 0.0414 - acc: 1.0000
Epoch 23/28

8/8 [==============================] - 1s 90ms/step - loss: 0.0349 - acc: 1.0000
Epoch 24/28

8/8 [==============================] - 1s 97ms/step - loss: 0.0363 - acc: 0.9945
Epoch 25/28

8/8 [==============================] - 1s 93ms/step - loss: 0.0356 - acc: 1.0000
Epoch 26/28

8/8 [==============================] - 1s 94ms/step - loss: 0.0265 - acc: 1.0000
Epoch 27/28

8/8 [==============================] - 1s 93ms/step - loss: 0.0283 - acc: 1.0000
Epoch 28/28

8/8 [==============================] - 1s 93ms/step - loss: 0.0277 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7179
False 1456
True percentage 0.831383902721
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.92      0.94      0.93      7318
      B-PER       0.29      0.37      0.33       438
      B-ORG       0.30      0.24      0.26       296
      I-ORG       0.21      0.06      0.09       151
      I-PER       0.33      0.25      0.28       214
      B-LOC       0.00      0.00      0.00       218

avg / total       0.81      0.83      0.82      8635

F-1 Score (without O):
0.254782608696
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104041 unique words.
4037 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658688     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,818
Trainable params: 6,770,818
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 3s 399ms/step - loss: 2.5241 - acc: 0.0925
Epoch 2/28

8/8 [==============================] - 1s 92ms/step - loss: 0.8251 - acc: 0.8208
Epoch 3/28

8/8 [==============================] - 1s 92ms/step - loss: 0.6438 - acc: 0.8208
Epoch 4/28

8/8 [==============================] - 1s 95ms/step - loss: 0.6853 - acc: 0.8497
Epoch 5/28

8/8 [==============================] - 1s 95ms/step - loss: 0.6307 - acc: 0.8208
Epoch 6/28

8/8 [==============================] - 1s 92ms/step - loss: 0.4565 - acc: 0.8671
Epoch 7/28

8/8 [==============================] - 1s 95ms/step - loss: 0.4189 - acc: 0.8728
Epoch 8/28

8/8 [==============================] - 1s 96ms/step - loss: 0.3716 - acc: 0.9017
Epoch 9/28

8/8 [==============================] - 1s 97ms/step - loss: 0.3576 - acc: 0.8960
Epoch 10/28

8/8 [==============================] - 1s 97ms/step - loss: 0.3296 - acc: 0.8960
Epoch 11/28

8/8 [==============================] - 1s 96ms/step - loss: 0.2888 - acc: 0.9075
Epoch 12/28

8/8 [==============================] - 1s 98ms/step - loss: 0.2688 - acc: 0.9075
Epoch 13/28

8/8 [==============================] - 1s 97ms/step - loss: 0.2435 - acc: 0.9364
Epoch 14/28

8/8 [==============================] - 1s 95ms/step - loss: 0.2272 - acc: 0.9306
Epoch 15/28

8/8 [==============================] - 1s 92ms/step - loss: 0.2164 - acc: 0.9364
Epoch 16/28

8/8 [==============================] - 1s 95ms/step - loss: 0.2126 - acc: 0.9538
Epoch 17/28

8/8 [==============================] - 1s 96ms/step - loss: 0.1900 - acc: 0.9595
Epoch 18/28

8/8 [==============================] - 1s 95ms/step - loss: 0.1551 - acc: 0.9942
Epoch 19/28

8/8 [==============================] - 1s 98ms/step - loss: 0.1625 - acc: 0.9653
Epoch 20/28

8/8 [==============================] - 1s 94ms/step - loss: 0.1441 - acc: 0.9827
Epoch 21/28

8/8 [==============================] - 1s 93ms/step - loss: 0.1394 - acc: 0.9942
Epoch 22/28

8/8 [==============================] - 1s 92ms/step - loss: 0.1181 - acc: 0.9942
Epoch 23/28

8/8 [==============================] - 1s 96ms/step - loss: 0.1179 - acc: 0.9942
Epoch 24/28

8/8 [==============================] - 1s 96ms/step - loss: 0.1200 - acc: 0.9884
Epoch 25/28

8/8 [==============================] - 1s 96ms/step - loss: 0.1221 - acc: 0.9884
Epoch 26/28

8/8 [==============================] - 1s 92ms/step - loss: 0.1037 - acc: 0.9884
Epoch 27/28

8/8 [==============================] - 1s 93ms/step - loss: 0.0974 - acc: 1.0000
Epoch 28/28

8/8 [==============================] - 1s 97ms/step - loss: 0.0830 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7151
False 1920
True percentage 0.78833645684
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.89      0.95      0.92      7318
      B-PER       0.41      0.21      0.27       438
      B-ORG       0.28      0.32      0.30       296
      I-ORG       0.00      0.00      0.00       151
     B-MISC       0.12      0.03      0.05       141
     I-MISC       0.11      0.03      0.05       154
      I-PER       0.24      0.11      0.15       214
      B-LOC       0.74      0.06      0.12       218
      I-LOC       1.00      0.02      0.04       141

avg / total       0.79      0.79      0.77      9071

F-1 Score (without O):
0.186656076251
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104044 unique words.
4040 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 567
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658880     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,010
Trainable params: 6,771,010
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 3s 399ms/step - loss: 2.6340 - acc: 0.0276
Epoch 2/28

8/8 [==============================] - 1s 94ms/step - loss: 1.2069 - acc: 0.7238
Epoch 3/28

8/8 [==============================] - 1s 96ms/step - loss: 0.7960 - acc: 0.7238
Epoch 4/28

8/8 [==============================] - 1s 93ms/step - loss: 0.6336 - acc: 0.7956
Epoch 5/28

8/8 [==============================] - 1s 93ms/step - loss: 0.5616 - acc: 0.8232
Epoch 6/28

8/8 [==============================] - 1s 96ms/step - loss: 0.5464 - acc: 0.7790
Epoch 7/28

8/8 [==============================] - 1s 95ms/step - loss: 0.6995 - acc: 0.8122
Epoch 8/28

8/8 [==============================] - 1s 94ms/step - loss: 0.4757 - acc: 0.8343
Epoch 9/28

8/8 [==============================] - 1s 92ms/step - loss: 0.4204 - acc: 0.9006
Epoch 10/28

8/8 [==============================] - 1s 95ms/step - loss: 0.3566 - acc: 0.9392
Epoch 11/28

8/8 [==============================] - 1s 94ms/step - loss: 0.3155 - acc: 0.9337
Epoch 12/28

8/8 [==============================] - 1s 95ms/step - loss: 0.2723 - acc: 0.9392
Epoch 13/28

8/8 [==============================] - 1s 95ms/step - loss: 0.2817 - acc: 0.9448
Epoch 14/28

8/8 [==============================] - 1s 95ms/step - loss: 0.2474 - acc: 0.9392
Epoch 15/28

8/8 [==============================] - 1s 95ms/step - loss: 0.2298 - acc: 0.9503
Epoch 16/28

8/8 [==============================] - 1s 97ms/step - loss: 0.2094 - acc: 0.9558
Epoch 17/28

8/8 [==============================] - 1s 95ms/step - loss: 0.1861 - acc: 0.9613
Epoch 18/28

8/8 [==============================] - 1s 95ms/step - loss: 0.1762 - acc: 0.9724
Epoch 19/28

8/8 [==============================] - 1s 96ms/step - loss: 0.1581 - acc: 0.9779
Epoch 20/28

8/8 [==============================] - 1s 93ms/step - loss: 0.1674 - acc: 0.9613
Epoch 21/28

8/8 [==============================] - 1s 96ms/step - loss: 0.1453 - acc: 0.9779
Epoch 22/28

8/8 [==============================] - 1s 92ms/step - loss: 0.1449 - acc: 0.9669
Epoch 23/28

8/8 [==============================] - 1s 95ms/step - loss: 0.1272 - acc: 0.9779
Epoch 24/28

8/8 [==============================] - 1s 92ms/step - loss: 0.1130 - acc: 0.9779
Epoch 25/28

8/8 [==============================] - 1s 94ms/step - loss: 0.1126 - acc: 0.9890
Epoch 26/28

8/8 [==============================] - 1s 94ms/step - loss: 0.1101 - acc: 0.9834
Epoch 27/28

8/8 [==============================] - 1s 96ms/step - loss: 0.1113 - acc: 0.9890
Epoch 28/28

8/8 [==============================] - 1s 97ms/step - loss: 0.1032 - acc: 0.9945
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7266
False 1805
True percentage 0.801014221144
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.93      0.94      7318
      B-ORG       0.41      0.29      0.34       296
      B-PER       0.37      0.39      0.38       438
      I-PER       0.38      0.29      0.33       214
      B-LOC       0.40      0.36      0.38       218
      I-LOC       0.00      0.00      0.00       141
      I-ORG       0.11      0.16      0.13       151
     B-MISC       0.10      0.01      0.02       141
     I-MISC       0.43      0.02      0.04       154

avg / total       0.82      0.80      0.81      9071

F-1 Score (without O):
0.280724876442
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 8 unique labels.
Found 104049 unique words.
4045 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 500
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659200     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,180
Trainable params: 6,771,180
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 3s 398ms/step - loss: 2.2351 - acc: 0.0761
Epoch 2/28

8/8 [==============================] - 1s 92ms/step - loss: 0.8481 - acc: 0.8261
Epoch 3/28

8/8 [==============================] - 1s 93ms/step - loss: 0.5225 - acc: 0.8478
Epoch 4/28

8/8 [==============================] - 1s 95ms/step - loss: 0.4187 - acc: 0.8967
Epoch 5/28

8/8 [==============================] - 1s 94ms/step - loss: 0.4027 - acc: 0.8478
Epoch 6/28

8/8 [==============================] - 1s 96ms/step - loss: 0.4479 - acc: 0.9130
Epoch 7/28

8/8 [==============================] - 1s 93ms/step - loss: 0.2839 - acc: 0.8967
Epoch 8/28

8/8 [==============================] - 1s 93ms/step - loss: 0.2531 - acc: 0.9402
Epoch 9/28

8/8 [==============================] - 1s 93ms/step - loss: 0.2389 - acc: 0.9457
Epoch 10/28

8/8 [==============================] - 1s 94ms/step - loss: 0.2152 - acc: 0.9511
Epoch 11/28

8/8 [==============================] - 1s 95ms/step - loss: 0.1950 - acc: 0.9674
Epoch 12/28

8/8 [==============================] - 1s 94ms/step - loss: 0.1807 - acc: 0.9620
Epoch 13/28

8/8 [==============================] - 1s 96ms/step - loss: 0.1765 - acc: 0.9620
Epoch 14/28

8/8 [==============================] - 1s 96ms/step - loss: 0.1400 - acc: 0.9891
Epoch 15/28

8/8 [==============================] - 1s 92ms/step - loss: 0.1456 - acc: 0.9837
Epoch 16/28

8/8 [==============================] - 1s 97ms/step - loss: 0.1432 - acc: 0.9783
Epoch 17/28

8/8 [==============================] - 1s 96ms/step - loss: 0.1175 - acc: 0.9837
Epoch 18/28

8/8 [==============================] - 1s 96ms/step - loss: 0.1102 - acc: 0.9891
Epoch 19/28

8/8 [==============================] - 1s 98ms/step - loss: 0.1117 - acc: 0.9783
Epoch 20/28

8/8 [==============================] - 1s 96ms/step - loss: 0.0983 - acc: 0.9891
Epoch 21/28

8/8 [==============================] - 1s 96ms/step - loss: 0.0859 - acc: 0.9946
Epoch 22/28

8/8 [==============================] - 1s 98ms/step - loss: 0.0799 - acc: 0.9891
Epoch 23/28

8/8 [==============================] - 1s 96ms/step - loss: 0.0791 - acc: 0.9891
Epoch 24/28

8/8 [==============================] - 1s 95ms/step - loss: 0.0700 - acc: 0.9946
Epoch 25/28

8/8 [==============================] - 1s 92ms/step - loss: 0.0545 - acc: 0.9946
Epoch 26/28

8/8 [==============================] - 1s 95ms/step - loss: 0.0615 - acc: 0.9946
Epoch 27/28

8/8 [==============================] - 1s 94ms/step - loss: 0.0506 - acc: 1.0000
Epoch 28/28

8/8 [==============================] - 1s 96ms/step - loss: 0.0457 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 6984
False 1946
True percentage 0.782082866741
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.92      0.93      7318
     B-MISC       0.10      0.07      0.08       141
     I-MISC       0.17      0.05      0.08       154
      B-ORG       0.16      0.30      0.21       296
      B-LOC       0.00      0.00      0.00       218
      B-PER       0.60      0.20      0.30       438
      I-PER       0.00      0.00      0.00       214
      I-ORG       0.07      0.22      0.10       151

avg / total       0.81      0.78      0.79      8930

F-1 Score (without O):
0.154312668464
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104039 unique words.
4035 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658560     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,690
Trainable params: 6,770,690
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 3s 396ms/step - loss: 2.4068 - acc: 0.0570
Epoch 2/28

8/8 [==============================] - 1s 95ms/step - loss: 0.8291 - acc: 0.8165
Epoch 3/28

8/8 [==============================] - 1s 94ms/step - loss: 0.5446 - acc: 0.8291
Epoch 4/28

8/8 [==============================] - 1s 96ms/step - loss: 0.5825 - acc: 0.8544
Epoch 5/28

8/8 [==============================] - 1s 95ms/step - loss: 0.4875 - acc: 0.8291
Epoch 6/28

8/8 [==============================] - 1s 91ms/step - loss: 0.3910 - acc: 0.9241
Epoch 7/28

8/8 [==============================] - 1s 97ms/step - loss: 0.3016 - acc: 0.9304
Epoch 8/28

8/8 [==============================] - 1s 96ms/step - loss: 0.2820 - acc: 0.9367
Epoch 9/28

8/8 [==============================] - 1s 96ms/step - loss: 0.2641 - acc: 0.9367
Epoch 10/28

8/8 [==============================] - 1s 97ms/step - loss: 0.2421 - acc: 0.9367
Epoch 11/28

8/8 [==============================] - 1s 95ms/step - loss: 0.2105 - acc: 0.9557
Epoch 12/28

8/8 [==============================] - 1s 95ms/step - loss: 0.2048 - acc: 0.9494
Epoch 13/28

8/8 [==============================] - 1s 95ms/step - loss: 0.1731 - acc: 0.9557
Epoch 14/28

8/8 [==============================] - 1s 96ms/step - loss: 0.1720 - acc: 0.9620
Epoch 15/28

8/8 [==============================] - 1s 96ms/step - loss: 0.1468 - acc: 0.9557
Epoch 16/28

8/8 [==============================] - 1s 97ms/step - loss: 0.1371 - acc: 0.9747
Epoch 17/28

8/8 [==============================] - 1s 95ms/step - loss: 0.1387 - acc: 0.9684
Epoch 18/28

8/8 [==============================] - 1s 96ms/step - loss: 0.1204 - acc: 0.9620
Epoch 19/28

8/8 [==============================] - 1s 96ms/step - loss: 0.1173 - acc: 0.9684
Epoch 20/28

8/8 [==============================] - 1s 96ms/step - loss: 0.1070 - acc: 0.9810
Epoch 21/28

8/8 [==============================] - 1s 93ms/step - loss: 0.0984 - acc: 0.9873
Epoch 22/28

8/8 [==============================] - 1s 96ms/step - loss: 0.0829 - acc: 1.0000
Epoch 23/28

8/8 [==============================] - 1s 97ms/step - loss: 0.0816 - acc: 1.0000
Epoch 24/28

8/8 [==============================] - 1s 96ms/step - loss: 0.0756 - acc: 1.0000
Epoch 25/28

8/8 [==============================] - 1s 96ms/step - loss: 0.0786 - acc: 1.0000
Epoch 26/28

8/8 [==============================] - 1s 95ms/step - loss: 0.0775 - acc: 1.0000
Epoch 27/28

8/8 [==============================] - 1s 96ms/step - loss: 0.0606 - acc: 1.0000
Epoch 28/28

8/8 [==============================] - 1s 95ms/step - loss: 0.0625 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7113
False 1958
True percentage 0.784147282549
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.33      0.19      0.24       438
      I-PER       0.00      0.00      0.00       214
          O       0.94      0.93      0.94      7318
      B-ORG       0.27      0.41      0.32       296
      B-LOC       0.35      0.09      0.14       218
      I-ORG       0.12      0.35      0.18       151
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.79      0.78      0.78      9071

F-1 Score (without O):
0.832898791183
