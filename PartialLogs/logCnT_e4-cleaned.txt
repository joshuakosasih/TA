Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

1674/1674 [==============================] - 35s 21ms/step - loss: 0.4601 - acc: 0.8669
Epoch 2/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.2277 - acc: 0.9299
Epoch 3/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.1754 - acc: 0.9470
Epoch 4/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.1428 - acc: 0.9574
Epoch 5/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.1231 - acc: 0.9634
Epoch 6/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.1072 - acc: 0.9692
Epoch 7/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0942 - acc: 0.9736
Epoch 8/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0847 - acc: 0.9758
Epoch 9/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0753 - acc: 0.9790
Epoch 10/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0706 - acc: 0.9802
Epoch 11/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0647 - acc: 0.9814
Epoch 12/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0586 - acc: 0.9833
Epoch 13/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0549 - acc: 0.9844
Epoch 14/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0510 - acc: 0.9860
Epoch 15/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0482 - acc: 0.9866
Epoch 16/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0439 - acc: 0.9875
Epoch 17/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0426 - acc: 0.9882
Epoch 18/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0412 - acc: 0.9877
Epoch 19/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0388 - acc: 0.9886
Epoch 20/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0364 - acc: 0.9893
Epoch 21/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0339 - acc: 0.9899
Epoch 22/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0333 - acc: 0.9898
Epoch 23/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0305 - acc: 0.9908
Epoch 24/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0297 - acc: 0.9916
Epoch 25/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0294 - acc: 0.9913
Epoch 26/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0283 - acc: 0.9916
Epoch 27/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0269 - acc: 0.9923
Epoch 28/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0262 - acc: 0.9927
Epoch 29/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0259 - acc: 0.9922
Epoch 30/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0233 - acc: 0.9936
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8226
False 845
True percentage 0.906845992724
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.89      0.83      0.86       438
      B-ORG       0.75      0.74      0.75       296
      I-ORG       0.63      0.64      0.63       151
      I-PER       0.92      0.63      0.74       214
      B-LOC       0.75      0.75      0.75       218
     B-MISC       0.41      0.31      0.35       141
      I-LOC       0.74      0.79      0.77       141
     I-MISC       0.48      0.43      0.45       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.712247324614
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

1674/1674 [==============================] - 35s 21ms/step - loss: 0.4679 - acc: 0.8626
Epoch 2/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.2181 - acc: 0.9349
Epoch 3/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.1688 - acc: 0.9507
Epoch 4/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.1369 - acc: 0.9605
Epoch 5/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.1173 - acc: 0.9660
Epoch 6/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.1026 - acc: 0.9712
Epoch 7/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0923 - acc: 0.9737
Epoch 8/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0806 - acc: 0.9772
Epoch 9/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0747 - acc: 0.9788
Epoch 10/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0672 - acc: 0.9814
Epoch 11/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0619 - acc: 0.9833
Epoch 12/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0586 - acc: 0.9839
Epoch 13/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0531 - acc: 0.9849
Epoch 14/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0499 - acc: 0.9855
Epoch 15/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0461 - acc: 0.9878
Epoch 16/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0434 - acc: 0.9880
Epoch 17/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0408 - acc: 0.9882
Epoch 18/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0386 - acc: 0.9890
Epoch 19/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0348 - acc: 0.9895
Epoch 20/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0352 - acc: 0.9900
Epoch 21/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0319 - acc: 0.9916
Epoch 22/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0316 - acc: 0.9906
Epoch 23/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0286 - acc: 0.9916
Epoch 24/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0285 - acc: 0.9918
Epoch 25/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0273 - acc: 0.9920
Epoch 26/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0247 - acc: 0.9930
Epoch 27/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0258 - acc: 0.9929
Epoch 28/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0236 - acc: 0.9933
Epoch 29/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0230 - acc: 0.9939
Epoch 30/30

1674/1674 [==============================] - 34s 20ms/step - loss: 0.0217 - acc: 0.9940
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8273
False 798
True percentage 0.912027339874
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
     B-MISC       0.39      0.32      0.35       141
     I-MISC       0.54      0.45      0.49       154
      B-ORG       0.79      0.75      0.77       296
      B-LOC       0.77      0.78      0.77       218
      B-PER       0.92      0.84      0.88       438
      I-PER       0.93      0.66      0.78       214
      I-ORG       0.68      0.64      0.66       151
      I-LOC       0.73      0.84      0.78       141

avg / total       0.94      0.91      0.93      9071

F-1 Score (without O):
0.734645199761
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100836 unique words.
Found 94 unique chars.
Found 9 unique labels.
832 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 256
OOV word occurences: 362
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6453568     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,560,130
Trainable params: 6,560,130
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

837/837 [==============================] - 18s 22ms/step - loss: 0.5940 - acc: 0.8283
Epoch 2/30

837/837 [==============================] - 17s 20ms/step - loss: 0.3046 - acc: 0.9101
Epoch 3/30

837/837 [==============================] - 17s 20ms/step - loss: 0.2232 - acc: 0.9337
Epoch 4/30

837/837 [==============================] - 17s 20ms/step - loss: 0.1800 - acc: 0.9491
Epoch 5/30

837/837 [==============================] - 17s 20ms/step - loss: 0.1543 - acc: 0.9554
Epoch 6/30

837/837 [==============================] - 17s 20ms/step - loss: 0.1306 - acc: 0.9631
Epoch 7/30

837/837 [==============================] - 17s 20ms/step - loss: 0.1149 - acc: 0.9691
Epoch 8/30

837/837 [==============================] - 17s 20ms/step - loss: 0.1019 - acc: 0.9727
Epoch 9/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0945 - acc: 0.9742
Epoch 10/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0822 - acc: 0.9788
Epoch 11/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0746 - acc: 0.9797
Epoch 12/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0674 - acc: 0.9832
Epoch 13/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0607 - acc: 0.9843
Epoch 14/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0580 - acc: 0.9857
Epoch 15/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0536 - acc: 0.9866
Epoch 16/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0485 - acc: 0.9882
Epoch 17/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0450 - acc: 0.9885
Epoch 18/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0404 - acc: 0.9899
Epoch 19/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0405 - acc: 0.9907
Epoch 20/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0361 - acc: 0.9910
Epoch 21/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0337 - acc: 0.9923
Epoch 22/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0336 - acc: 0.9920
Epoch 23/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0309 - acc: 0.9927
Epoch 24/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0307 - acc: 0.9921
Epoch 25/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0281 - acc: 0.9934
Epoch 26/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0259 - acc: 0.9939
Epoch 27/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0254 - acc: 0.9934
Epoch 28/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0240 - acc: 0.9945
Epoch 29/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0215 - acc: 0.9947
Epoch 30/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0215 - acc: 0.9951
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8190
False 881
True percentage 0.90287730129
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.90      0.84      0.87       438
      B-ORG       0.78      0.70      0.74       296
      I-ORG       0.66      0.52      0.58       151
      I-PER       0.90      0.63      0.74       214
      B-LOC       0.69      0.76      0.72       218
     B-MISC       0.48      0.34      0.40       141
      I-LOC       0.70      0.76      0.73       141
     I-MISC       0.54      0.44      0.48       154

avg / total       0.94      0.90      0.92      9071

F-1 Score (without O):
0.709151313802
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 100841 unique words.
Found 94 unique chars.
Found 9 unique labels.
837 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 258
OOV word occurences: 402
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6453888     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,560,450
Trainable params: 6,560,450
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

837/837 [==============================] - 18s 22ms/step - loss: 0.6097 - acc: 0.8235
Epoch 2/30

837/837 [==============================] - 17s 20ms/step - loss: 0.3063 - acc: 0.9074
Epoch 3/30

837/837 [==============================] - 17s 20ms/step - loss: 0.2313 - acc: 0.9304
Epoch 4/30

837/837 [==============================] - 17s 21ms/step - loss: 0.1894 - acc: 0.9435
Epoch 5/30

837/837 [==============================] - 17s 21ms/step - loss: 0.1610 - acc: 0.9521
Epoch 6/30

837/837 [==============================] - 17s 20ms/step - loss: 0.1437 - acc: 0.9587
Epoch 7/30

837/837 [==============================] - 17s 20ms/step - loss: 0.1239 - acc: 0.9646
Epoch 8/30

837/837 [==============================] - 17s 20ms/step - loss: 0.1102 - acc: 0.9707
Epoch 9/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0944 - acc: 0.9748
Epoch 10/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0897 - acc: 0.9765
Epoch 11/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0793 - acc: 0.9786
Epoch 12/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0704 - acc: 0.9820
Epoch 13/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0676 - acc: 0.9824
Epoch 14/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0637 - acc: 0.9853
Epoch 15/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0574 - acc: 0.9849
Epoch 16/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0528 - acc: 0.9869
Epoch 17/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0506 - acc: 0.9866
Epoch 18/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0487 - acc: 0.9870
Epoch 19/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0426 - acc: 0.9887
Epoch 20/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0407 - acc: 0.9891
Epoch 21/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0399 - acc: 0.9895
Epoch 22/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0377 - acc: 0.9900
Epoch 23/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0345 - acc: 0.9910
Epoch 24/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0341 - acc: 0.9903
Epoch 25/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0299 - acc: 0.9929
Epoch 26/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0301 - acc: 0.9921
Epoch 27/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0275 - acc: 0.9933
Epoch 28/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0271 - acc: 0.9936
Epoch 29/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0239 - acc: 0.9943
Epoch 30/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0237 - acc: 0.9944
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8077
False 994
True percentage 0.890420019843
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.97      7318
     B-MISC       0.33      0.35      0.34       141
     I-MISC       0.45      0.50      0.47       154
      B-ORG       0.72      0.62      0.67       296
      B-LOC       0.76      0.71      0.74       218
      B-PER       0.89      0.72      0.79       438
      I-PER       0.91      0.63      0.74       214
      I-ORG       0.51      0.44      0.48       151
      I-LOC       0.71      0.77      0.74       141

avg / total       0.93      0.89      0.91      9071

F-1 Score (without O):
0.65642878651
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100788 unique words.
Found 94 unique chars.
Found 9 unique labels.
784 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 261
OOV word occurences: 373
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6450496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,557,058
Trainable params: 6,557,058
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

837/837 [==============================] - 18s 22ms/step - loss: 0.5901 - acc: 0.8302
Epoch 2/30

837/837 [==============================] - 17s 20ms/step - loss: 0.3020 - acc: 0.9121
Epoch 3/30

837/837 [==============================] - 17s 20ms/step - loss: 0.2256 - acc: 0.9329
Epoch 4/30

837/837 [==============================] - 17s 20ms/step - loss: 0.1851 - acc: 0.9471
Epoch 5/30

837/837 [==============================] - 17s 20ms/step - loss: 0.1519 - acc: 0.9553
Epoch 6/30

837/837 [==============================] - 17s 20ms/step - loss: 0.1338 - acc: 0.9622
Epoch 7/30

837/837 [==============================] - 17s 20ms/step - loss: 0.1195 - acc: 0.9666
Epoch 8/30

837/837 [==============================] - 17s 20ms/step - loss: 0.1069 - acc: 0.9703
Epoch 9/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0955 - acc: 0.9736
Epoch 10/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0859 - acc: 0.9779
Epoch 11/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0800 - acc: 0.9769
Epoch 12/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0716 - acc: 0.9802
Epoch 13/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0691 - acc: 0.9819
Epoch 14/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0623 - acc: 0.9835
Epoch 15/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0563 - acc: 0.9853
Epoch 16/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0541 - acc: 0.9855
Epoch 17/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0490 - acc: 0.9871
Epoch 18/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0449 - acc: 0.9881
Epoch 19/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0422 - acc: 0.9894
Epoch 20/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0407 - acc: 0.9893
Epoch 21/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0390 - acc: 0.9900
Epoch 22/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0378 - acc: 0.9897
Epoch 23/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0351 - acc: 0.9907
Epoch 24/30

837/837 [==============================] - 17s 21ms/step - loss: 0.0315 - acc: 0.9921
Epoch 25/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0309 - acc: 0.9920
Epoch 26/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0301 - acc: 0.9917
Epoch 27/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0291 - acc: 0.9921
Epoch 28/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0265 - acc: 0.9933
Epoch 29/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0238 - acc: 0.9938
Epoch 30/30

837/837 [==============================] - 17s 20ms/step - loss: 0.0233 - acc: 0.9946
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8134
False 937
True percentage 0.896703781281
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.96      0.97      7318
      B-PER       0.89      0.79      0.84       438
      B-ORG       0.75      0.71      0.73       296
      I-ORG       0.59      0.56      0.57       151
     B-MISC       0.38      0.25      0.30       141
     I-MISC       0.50      0.37      0.43       154
      I-PER       0.86      0.62      0.72       214
      B-LOC       0.74      0.67      0.70       218
      I-LOC       0.80      0.73      0.77       141

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.685731857319
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100383 unique words.
Found 94 unique chars.
Found 9 unique labels.
379 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 289
OOV word occurences: 465
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6424576     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,531,138
Trainable params: 6,531,138
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

334/334 [==============================] - 8s 24ms/step - loss: 0.7395 - acc: 0.8035
Epoch 2/30

334/334 [==============================] - 7s 20ms/step - loss: 0.4172 - acc: 0.8737
Epoch 3/30

334/334 [==============================] - 7s 20ms/step - loss: 0.3020 - acc: 0.9187
Epoch 4/30

334/334 [==============================] - 7s 20ms/step - loss: 0.2405 - acc: 0.9344
Epoch 5/30

334/334 [==============================] - 7s 20ms/step - loss: 0.1882 - acc: 0.9494
Epoch 6/30

334/334 [==============================] - 7s 20ms/step - loss: 0.1568 - acc: 0.9578
Epoch 7/30

334/334 [==============================] - 7s 20ms/step - loss: 0.1385 - acc: 0.9639
Epoch 8/30

334/334 [==============================] - 7s 20ms/step - loss: 0.1247 - acc: 0.9676
Epoch 9/30

334/334 [==============================] - 7s 20ms/step - loss: 0.1074 - acc: 0.9730
Epoch 10/30

334/334 [==============================] - 7s 20ms/step - loss: 0.1014 - acc: 0.9749
Epoch 11/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0901 - acc: 0.9772
Epoch 12/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0822 - acc: 0.9800
Epoch 13/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0698 - acc: 0.9851
Epoch 14/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0676 - acc: 0.9849
Epoch 15/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0611 - acc: 0.9871
Epoch 16/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0592 - acc: 0.9869
Epoch 17/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0530 - acc: 0.9873
Epoch 18/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0509 - acc: 0.9893
Epoch 19/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0432 - acc: 0.9911
Epoch 20/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0414 - acc: 0.9917
Epoch 21/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0409 - acc: 0.9921
Epoch 22/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0378 - acc: 0.9919
Epoch 23/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0352 - acc: 0.9932
Epoch 24/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0329 - acc: 0.9930
Epoch 25/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0315 - acc: 0.9938
Epoch 26/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0301 - acc: 0.9942
Epoch 27/30

334/334 [==============================] - 7s 21ms/step - loss: 0.0279 - acc: 0.9954
Epoch 28/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0237 - acc: 0.9962
Epoch 29/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0262 - acc: 0.9953
Epoch 30/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0228 - acc: 0.9960
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8013
False 1058
True percentage 0.883364568405
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.96      0.96      7318
      B-PER       0.87      0.75      0.81       438
      B-ORG       0.76      0.59      0.66       296
      I-ORG       0.55      0.46      0.50       151
      I-PER       0.93      0.57      0.71       214
      B-LOC       0.71      0.70      0.70       218
     B-MISC       0.30      0.20      0.24       141
      I-LOC       0.70      0.72      0.71       141
     I-MISC       0.44      0.28      0.34       154

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.643736194383
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 100380 unique words.
Found 94 unique chars.
Found 9 unique labels.
376 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 280
OOV word occurences: 449
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6424384     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,530,946
Trainable params: 6,530,946
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

334/334 [==============================] - 8s 24ms/step - loss: 0.8116 - acc: 0.7724
Epoch 2/30

334/334 [==============================] - 7s 20ms/step - loss: 0.4426 - acc: 0.8652
Epoch 3/30

334/334 [==============================] - 7s 20ms/step - loss: 0.3311 - acc: 0.8978
Epoch 4/30

334/334 [==============================] - 7s 20ms/step - loss: 0.2686 - acc: 0.9198
Epoch 5/30

334/334 [==============================] - 7s 20ms/step - loss: 0.2203 - acc: 0.9392
Epoch 6/30

334/334 [==============================] - 7s 20ms/step - loss: 0.1918 - acc: 0.9484
Epoch 7/30

334/334 [==============================] - 7s 20ms/step - loss: 0.1654 - acc: 0.9551
Epoch 8/30

334/334 [==============================] - 7s 20ms/step - loss: 0.1483 - acc: 0.9588
Epoch 9/30

334/334 [==============================] - 7s 20ms/step - loss: 0.1337 - acc: 0.9622
Epoch 10/30

334/334 [==============================] - 7s 20ms/step - loss: 0.1201 - acc: 0.9703
Epoch 11/30

334/334 [==============================] - 7s 20ms/step - loss: 0.1054 - acc: 0.9740
Epoch 12/30

334/334 [==============================] - 7s 20ms/step - loss: 0.1003 - acc: 0.9739
Epoch 13/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0887 - acc: 0.9779
Epoch 14/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0839 - acc: 0.9800
Epoch 15/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0730 - acc: 0.9826
Epoch 16/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0716 - acc: 0.9842
Epoch 17/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0642 - acc: 0.9861
Epoch 18/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0637 - acc: 0.9846
Epoch 19/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0556 - acc: 0.9857
Epoch 20/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0513 - acc: 0.9878
Epoch 21/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0476 - acc: 0.9896
Epoch 22/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0443 - acc: 0.9905
Epoch 23/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0432 - acc: 0.9902
Epoch 24/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0394 - acc: 0.9912
Epoch 25/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0386 - acc: 0.9904
Epoch 26/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0356 - acc: 0.9931
Epoch 27/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0352 - acc: 0.9922
Epoch 28/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0324 - acc: 0.9930
Epoch 29/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0287 - acc: 0.9947
Epoch 30/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0275 - acc: 0.9957
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7898
False 1173
True percentage 0.870686804101
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
     B-MISC       0.33      0.21      0.26       141
     I-MISC       0.39      0.26      0.31       154
      B-ORG       0.62      0.59      0.61       296
      B-LOC       0.64      0.67      0.66       218
      B-PER       0.86      0.62      0.72       438
      I-PER       0.91      0.55      0.68       214
      I-ORG       0.39      0.43      0.41       151
      I-LOC       0.74      0.74      0.74       141

avg / total       0.91      0.87      0.89      9071

F-1 Score (without O):
0.592014971928
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100367 unique words.
Found 94 unique chars.
Found 9 unique labels.
363 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 292
OOV word occurences: 453
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6423552     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,530,114
Trainable params: 6,530,114
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

334/334 [==============================] - 8s 24ms/step - loss: 0.7712 - acc: 0.7823
Epoch 2/30

334/334 [==============================] - 7s 20ms/step - loss: 0.4222 - acc: 0.8730
Epoch 3/30

334/334 [==============================] - 7s 20ms/step - loss: 0.3216 - acc: 0.9050
Epoch 4/30

334/334 [==============================] - 7s 20ms/step - loss: 0.2529 - acc: 0.9242
Epoch 5/30

334/334 [==============================] - 7s 20ms/step - loss: 0.2186 - acc: 0.9340
Epoch 6/30

334/334 [==============================] - 7s 20ms/step - loss: 0.1851 - acc: 0.9461
Epoch 7/30

334/334 [==============================] - 7s 20ms/step - loss: 0.1656 - acc: 0.9514
Epoch 8/30

334/334 [==============================] - 7s 20ms/step - loss: 0.1431 - acc: 0.9633
Epoch 9/30

334/334 [==============================] - 7s 20ms/step - loss: 0.1255 - acc: 0.9661
Epoch 10/30

334/334 [==============================] - 7s 20ms/step - loss: 0.1127 - acc: 0.9730
Epoch 11/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0984 - acc: 0.9762
Epoch 12/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0893 - acc: 0.9794
Epoch 13/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0844 - acc: 0.9798
Epoch 14/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0750 - acc: 0.9828
Epoch 15/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0684 - acc: 0.9868
Epoch 16/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0647 - acc: 0.9835
Epoch 17/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0582 - acc: 0.9877
Epoch 18/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0578 - acc: 0.9864
Epoch 19/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0487 - acc: 0.9902
Epoch 20/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0455 - acc: 0.9901
Epoch 21/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0444 - acc: 0.9910
Epoch 22/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0399 - acc: 0.9925
Epoch 23/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0420 - acc: 0.9904
Epoch 24/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0354 - acc: 0.9933
Epoch 25/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0336 - acc: 0.9926
Epoch 26/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0333 - acc: 0.9922
Epoch 27/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0322 - acc: 0.9928
Epoch 28/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0283 - acc: 0.9942
Epoch 29/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0269 - acc: 0.9949
Epoch 30/30

334/334 [==============================] - 7s 20ms/step - loss: 0.0282 - acc: 0.9928
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7915
False 1156
True percentage 0.872560908389
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-PER       0.84      0.70      0.76       438
      B-ORG       0.69      0.60      0.64       296
      I-ORG       0.50      0.32      0.39       151
     B-MISC       0.20      0.17      0.18       141
     I-MISC       0.36      0.43      0.39       154
      I-PER       0.88      0.58      0.70       214
      B-LOC       0.67      0.67      0.67       218
      I-LOC       0.74      0.71      0.72       141

avg / total       0.92      0.87      0.89      9071

F-1 Score (without O):
0.605875152999
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100202 unique words.
Found 94 unique chars.
Found 9 unique labels.
198 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 306
OOV word occurences: 516
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6412992     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,519,554
Trainable params: 6,519,554
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

167/167 [==============================] - 5s 29ms/step - loss: 1.0130 - acc: 0.7309
Epoch 2/30

167/167 [==============================] - 3s 20ms/step - loss: 0.6018 - acc: 0.8199
Epoch 3/30

167/167 [==============================] - 3s 20ms/step - loss: 0.4577 - acc: 0.8641
Epoch 4/30

167/167 [==============================] - 3s 21ms/step - loss: 0.3665 - acc: 0.8874
Epoch 5/30

167/167 [==============================] - 3s 21ms/step - loss: 0.3047 - acc: 0.9153
Epoch 6/30

167/167 [==============================] - 3s 21ms/step - loss: 0.2450 - acc: 0.9351
Epoch 7/30

167/167 [==============================] - 3s 21ms/step - loss: 0.2107 - acc: 0.9434
Epoch 8/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1946 - acc: 0.9493
Epoch 9/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1728 - acc: 0.9534
Epoch 10/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1484 - acc: 0.9622
Epoch 11/30

167/167 [==============================] - 3s 20ms/step - loss: 0.1326 - acc: 0.9685
Epoch 12/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1218 - acc: 0.9712
Epoch 13/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1125 - acc: 0.9751
Epoch 14/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1022 - acc: 0.9779
Epoch 15/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0890 - acc: 0.9825
Epoch 16/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0839 - acc: 0.9828
Epoch 17/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0770 - acc: 0.9835
Epoch 18/30

167/167 [==============================] - 3s 20ms/step - loss: 0.0697 - acc: 0.9860
Epoch 19/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0643 - acc: 0.9882
Epoch 20/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0557 - acc: 0.9919
Epoch 21/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0579 - acc: 0.9898
Epoch 22/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0508 - acc: 0.9904
Epoch 23/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0496 - acc: 0.9921
Epoch 24/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0476 - acc: 0.9925
Epoch 25/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0413 - acc: 0.9939
Epoch 26/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0395 - acc: 0.9935
Epoch 27/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0370 - acc: 0.9939
Epoch 28/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0334 - acc: 0.9946
Epoch 29/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0345 - acc: 0.9936
Epoch 30/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0308 - acc: 0.9953
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7865
False 1206
True percentage 0.867048836953
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.95      0.95      7318
      B-PER       0.85      0.63      0.72       438
      B-ORG       0.62      0.62      0.62       296
      I-ORG       0.38      0.40      0.39       151
      I-PER       0.83      0.56      0.67       214
      B-LOC       0.82      0.61      0.70       218
     B-MISC       0.54      0.09      0.16       141
      I-LOC       0.77      0.64      0.70       141
     I-MISC       0.67      0.13      0.22       154

avg / total       0.91      0.87      0.88      9071

F-1 Score (without O):
0.594289508632
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 100205 unique words.
Found 94 unique chars.
Found 9 unique labels.
201 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 300
OOV word occurences: 499
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6413184     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,519,746
Trainable params: 6,519,746
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

167/167 [==============================] - 5s 29ms/step - loss: 1.0145 - acc: 0.7341
Epoch 2/30

167/167 [==============================] - 3s 20ms/step - loss: 0.6171 - acc: 0.8144
Epoch 3/30

167/167 [==============================] - 3s 20ms/step - loss: 0.4905 - acc: 0.8515
Epoch 4/30

167/167 [==============================] - 3s 20ms/step - loss: 0.4066 - acc: 0.8726
Epoch 5/30

167/167 [==============================] - 3s 21ms/step - loss: 0.3197 - acc: 0.9042
Epoch 6/30

167/167 [==============================] - 3s 21ms/step - loss: 0.2659 - acc: 0.9273
Epoch 7/30

167/167 [==============================] - 3s 21ms/step - loss: 0.2323 - acc: 0.9375
Epoch 8/30

167/167 [==============================] - 3s 21ms/step - loss: 0.2014 - acc: 0.9469
Epoch 9/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1749 - acc: 0.9540
Epoch 10/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1593 - acc: 0.9613
Epoch 11/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1385 - acc: 0.9673
Epoch 12/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1297 - acc: 0.9676
Epoch 13/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1135 - acc: 0.9747
Epoch 14/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1051 - acc: 0.9809
Epoch 15/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0907 - acc: 0.9821
Epoch 16/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0833 - acc: 0.9817
Epoch 17/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0790 - acc: 0.9838
Epoch 18/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0691 - acc: 0.9887
Epoch 19/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0652 - acc: 0.9867
Epoch 20/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0599 - acc: 0.9879
Epoch 21/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0543 - acc: 0.9916
Epoch 22/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0518 - acc: 0.9902
Epoch 23/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0507 - acc: 0.9913
Epoch 24/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0439 - acc: 0.9919
Epoch 25/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0424 - acc: 0.9924
Epoch 26/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0370 - acc: 0.9948
Epoch 27/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0365 - acc: 0.9944
Epoch 28/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0343 - acc: 0.9968
Epoch 29/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0351 - acc: 0.9957
Epoch 30/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0303 - acc: 0.9956
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7753
False 1318
True percentage 0.854701796935
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.94      0.95      7318
     B-MISC       0.30      0.17      0.22       141
     I-MISC       0.29      0.15      0.20       154
      B-ORG       0.55      0.53      0.54       296
      B-LOC       0.69      0.61      0.65       218
      B-PER       0.81      0.60      0.69       438
      I-PER       0.75      0.56      0.64       214
      I-ORG       0.33      0.36      0.34       151
      I-LOC       0.65      0.67      0.66       141

avg / total       0.89      0.85      0.87      9071

F-1 Score (without O):
0.544030084613
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100187 unique words.
Found 94 unique chars.
Found 9 unique labels.
183 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 304
OOV word occurences: 482
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6412032     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,518,594
Trainable params: 6,518,594
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

167/167 [==============================] - 5s 29ms/step - loss: 1.0163 - acc: 0.7280
Epoch 2/30

167/167 [==============================] - 3s 21ms/step - loss: 0.5886 - acc: 0.8172
Epoch 3/30

167/167 [==============================] - 3s 21ms/step - loss: 0.4615 - acc: 0.8620
Epoch 4/30

167/167 [==============================] - 3s 21ms/step - loss: 0.3651 - acc: 0.8946
Epoch 5/30

167/167 [==============================] - 3s 21ms/step - loss: 0.3140 - acc: 0.9101
Epoch 6/30

167/167 [==============================] - 3s 21ms/step - loss: 0.2559 - acc: 0.9309
Epoch 7/30

167/167 [==============================] - 3s 21ms/step - loss: 0.2217 - acc: 0.9403
Epoch 8/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1946 - acc: 0.9486
Epoch 9/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1692 - acc: 0.9550
Epoch 10/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1530 - acc: 0.9623
Epoch 11/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1421 - acc: 0.9642
Epoch 12/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1249 - acc: 0.9690
Epoch 13/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1161 - acc: 0.9692
Epoch 14/30

167/167 [==============================] - 3s 21ms/step - loss: 0.1062 - acc: 0.9759
Epoch 15/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0983 - acc: 0.9772
Epoch 16/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0891 - acc: 0.9796
Epoch 17/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0851 - acc: 0.9819
Epoch 18/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0798 - acc: 0.9847
Epoch 19/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0692 - acc: 0.9869
Epoch 20/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0666 - acc: 0.9868
Epoch 21/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0606 - acc: 0.9891
Epoch 22/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0558 - acc: 0.9904
Epoch 23/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0515 - acc: 0.9909
Epoch 24/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0498 - acc: 0.9930
Epoch 25/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0465 - acc: 0.9894
Epoch 26/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0447 - acc: 0.9913
Epoch 27/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0424 - acc: 0.9924
Epoch 28/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0382 - acc: 0.9934
Epoch 29/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0346 - acc: 0.9957
Epoch 30/30

167/167 [==============================] - 3s 21ms/step - loss: 0.0365 - acc: 0.9937
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7843
False 1228
True percentage 0.864623525521
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-PER       0.82      0.68      0.74       438
      B-ORG       0.56      0.67      0.61       296
      I-ORG       0.35      0.53      0.42       151
     B-MISC       0.22      0.08      0.12       141
     I-MISC       0.33      0.14      0.20       154
      I-PER       0.81      0.51      0.63       214
      B-LOC       0.68      0.65      0.66       218
      I-LOC       0.75      0.50      0.60       141

avg / total       0.91      0.86      0.88      9071

F-1 Score (without O):
0.570988604866
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100102 unique words.
Found 94 unique chars.
Found 9 unique labels.
98 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 317
OOV word occurences: 620
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6406592     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,513,154
Trainable params: 6,513,154
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

83/83 [==============================] - 3s 37ms/step - loss: 1.2036 - acc: 0.6593
Epoch 2/30

83/83 [==============================] - 2s 21ms/step - loss: 0.6947 - acc: 0.8134
Epoch 3/30

83/83 [==============================] - 2s 21ms/step - loss: 0.5953 - acc: 0.8174
Epoch 4/30

83/83 [==============================] - 2s 21ms/step - loss: 0.4956 - acc: 0.8423
Epoch 5/30

83/83 [==============================] - 2s 21ms/step - loss: 0.4282 - acc: 0.8654
Epoch 6/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3820 - acc: 0.8835
Epoch 7/30

83/83 [==============================] - 2s 21ms/step - loss: 0.4278 - acc: 0.8968
Epoch 8/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3092 - acc: 0.9090
Epoch 9/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2788 - acc: 0.9211
Epoch 10/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2520 - acc: 0.9331
Epoch 11/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2306 - acc: 0.9361
Epoch 12/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2070 - acc: 0.9487
Epoch 13/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1882 - acc: 0.9531
Epoch 14/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1698 - acc: 0.9585
Epoch 15/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1570 - acc: 0.9638
Epoch 16/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1465 - acc: 0.9660
Epoch 17/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1338 - acc: 0.9700
Epoch 18/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1248 - acc: 0.9732
Epoch 19/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1198 - acc: 0.9728
Epoch 20/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1067 - acc: 0.9776
Epoch 21/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1003 - acc: 0.9832
Epoch 22/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0943 - acc: 0.9807
Epoch 23/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0901 - acc: 0.9854
Epoch 24/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0832 - acc: 0.9827
Epoch 25/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0870 - acc: 0.9817
Epoch 26/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0714 - acc: 0.9876
Epoch 27/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0722 - acc: 0.9843
Epoch 28/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0701 - acc: 0.9905
Epoch 29/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0657 - acc: 0.9885
Epoch 30/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0600 - acc: 0.9890
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7629
False 1442
True percentage 0.841031859773
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.94      0.95      7318
      B-PER       0.80      0.47      0.59       438
      B-ORG       0.50      0.54      0.52       296
      I-ORG       0.28      0.43      0.34       151
      I-PER       0.70      0.36      0.47       214
      B-LOC       0.77      0.56      0.64       218
     B-MISC       0.64      0.06      0.12       141
      I-LOC       0.79      0.53      0.64       141
     I-MISC       0.72      0.08      0.15       154

avg / total       0.90      0.84      0.86      9071

F-1 Score (without O):
0.490196078431
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 100107 unique words.
Found 94 unique chars.
Found 9 unique labels.
103 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 312
OOV word occurences: 534
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6406912     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,513,474
Trainable params: 6,513,474
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

83/83 [==============================] - 3s 37ms/step - loss: 1.1756 - acc: 0.6837
Epoch 2/30

83/83 [==============================] - 2s 21ms/step - loss: 0.7432 - acc: 0.8060
Epoch 3/30

83/83 [==============================] - 2s 21ms/step - loss: 0.5634 - acc: 0.8231
Epoch 4/30

83/83 [==============================] - 2s 21ms/step - loss: 0.4603 - acc: 0.8525
Epoch 5/30

83/83 [==============================] - 2s 21ms/step - loss: 0.4213 - acc: 0.8707
Epoch 6/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3505 - acc: 0.8926
Epoch 7/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3050 - acc: 0.9122
Epoch 8/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2654 - acc: 0.9217
Epoch 9/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2432 - acc: 0.9342
Epoch 10/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2161 - acc: 0.9375
Epoch 11/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1879 - acc: 0.9473
Epoch 12/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1735 - acc: 0.9589
Epoch 13/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1615 - acc: 0.9583
Epoch 14/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1393 - acc: 0.9701
Epoch 15/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1372 - acc: 0.9672
Epoch 16/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1206 - acc: 0.9773
Epoch 17/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1153 - acc: 0.9749
Epoch 18/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0977 - acc: 0.9869
Epoch 19/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0941 - acc: 0.9831
Epoch 20/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0832 - acc: 0.9869
Epoch 21/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0808 - acc: 0.9852
Epoch 22/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0700 - acc: 0.9898
Epoch 23/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0714 - acc: 0.9928
Epoch 24/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0630 - acc: 0.9958
Epoch 25/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0582 - acc: 0.9944
Epoch 26/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0536 - acc: 0.9953
Epoch 27/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0504 - acc: 0.9953
Epoch 28/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0492 - acc: 0.9954
Epoch 29/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0455 - acc: 0.9977
Epoch 30/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0437 - acc: 0.9977
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7604
False 1467
True percentage 0.838275824055
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.94      0.95      7318
     B-MISC       0.15      0.11      0.12       141
     I-MISC       0.17      0.12      0.14       154
      B-ORG       0.50      0.40      0.45       296
      B-LOC       0.68      0.54      0.60       218
      B-PER       0.80      0.57      0.67       438
      I-PER       0.86      0.34      0.48       214
      I-ORG       0.33      0.30      0.31       151
      I-LOC       0.59      0.48      0.53       141

avg / total       0.88      0.84      0.85      9071

F-1 Score (without O):
0.465961665565
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100100 unique words.
Found 94 unique chars.
Found 9 unique labels.
96 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 312
OOV word occurences: 517
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6406464     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,513,026
Trainable params: 6,513,026
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

83/83 [==============================] - 3s 37ms/step - loss: 1.2484 - acc: 0.6537
Epoch 2/30

83/83 [==============================] - 2s 21ms/step - loss: 0.7500 - acc: 0.7951
Epoch 3/30

83/83 [==============================] - 2s 21ms/step - loss: 0.6402 - acc: 0.7989
Epoch 4/30

83/83 [==============================] - 2s 21ms/step - loss: 0.5225 - acc: 0.8425
Epoch 5/30

83/83 [==============================] - 2s 21ms/step - loss: 0.4919 - acc: 0.8608
Epoch 6/30

83/83 [==============================] - 2s 21ms/step - loss: 0.4032 - acc: 0.8776
Epoch 7/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3423 - acc: 0.8964
Epoch 8/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3026 - acc: 0.9113
Epoch 9/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2677 - acc: 0.9266
Epoch 10/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2385 - acc: 0.9431
Epoch 11/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2157 - acc: 0.9554
Epoch 12/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1962 - acc: 0.9519
Epoch 13/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1822 - acc: 0.9584
Epoch 14/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1645 - acc: 0.9595
Epoch 15/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1500 - acc: 0.9695
Epoch 16/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1366 - acc: 0.9705
Epoch 17/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1245 - acc: 0.9799
Epoch 18/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1122 - acc: 0.9787
Epoch 19/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1072 - acc: 0.9777
Epoch 20/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1042 - acc: 0.9809
Epoch 21/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0874 - acc: 0.9846
Epoch 22/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0856 - acc: 0.9856
Epoch 23/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0791 - acc: 0.9881
Epoch 24/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0760 - acc: 0.9863
Epoch 25/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0757 - acc: 0.9876
Epoch 26/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0656 - acc: 0.9905
Epoch 27/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0591 - acc: 0.9912
Epoch 28/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0606 - acc: 0.9909
Epoch 29/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0539 - acc: 0.9949
Epoch 30/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0504 - acc: 0.9957
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7704
False 1367
True percentage 0.849299966928
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.94      0.95      7318
      B-PER       0.80      0.65      0.72       438
      B-ORG       0.51      0.56      0.53       296
      I-ORG       0.44      0.13      0.20       151
     B-MISC       0.14      0.04      0.06       141
     I-MISC       0.25      0.17      0.20       154
      I-PER       0.70      0.45      0.55       214
      B-LOC       0.63      0.58      0.60       218
      I-LOC       0.80      0.56      0.66       141

avg / total       0.88      0.85      0.86      9071

F-1 Score (without O):
0.525008172605
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 100124 unique words.
Found 94 unique chars.
Found 9 unique labels.
120 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 318
OOV word occurences: 605
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6408000     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,514,562
Trainable params: 6,514,562
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

83/83 [==============================] - 3s 38ms/step - loss: 1.4757 - acc: 0.6229
Epoch 2/30

83/83 [==============================] - 2s 21ms/step - loss: 0.7784 - acc: 0.7684
Epoch 3/30

83/83 [==============================] - 2s 21ms/step - loss: 0.6290 - acc: 0.7940
Epoch 4/30

83/83 [==============================] - 2s 21ms/step - loss: 0.5325 - acc: 0.8434
Epoch 5/30

83/83 [==============================] - 2s 21ms/step - loss: 0.4679 - acc: 0.8571
Epoch 6/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3847 - acc: 0.8821
Epoch 7/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3402 - acc: 0.8982
Epoch 8/30

83/83 [==============================] - 2s 21ms/step - loss: 0.3088 - acc: 0.9161
Epoch 9/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2801 - acc: 0.9261
Epoch 10/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2349 - acc: 0.9432
Epoch 11/30

83/83 [==============================] - 2s 21ms/step - loss: 0.2018 - acc: 0.9492
Epoch 12/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1816 - acc: 0.9587
Epoch 13/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1720 - acc: 0.9560
Epoch 14/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1558 - acc: 0.9684
Epoch 15/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1483 - acc: 0.9705
Epoch 16/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1356 - acc: 0.9648
Epoch 17/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1163 - acc: 0.9783
Epoch 18/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1166 - acc: 0.9761
Epoch 19/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1070 - acc: 0.9785
Epoch 20/30

83/83 [==============================] - 2s 21ms/step - loss: 0.1015 - acc: 0.9783
Epoch 21/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0906 - acc: 0.9854
Epoch 22/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0821 - acc: 0.9876
Epoch 23/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0829 - acc: 0.9870
Epoch 24/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0747 - acc: 0.9884
Epoch 25/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0674 - acc: 0.9926
Epoch 26/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0744 - acc: 0.9892
Epoch 27/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0694 - acc: 0.9870
Epoch 28/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0621 - acc: 0.9891
Epoch 29/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0554 - acc: 0.9933
Epoch 30/30

83/83 [==============================] - 2s 21ms/step - loss: 0.0553 - acc: 0.9887
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7687
False 1384
True percentage 0.847425862639
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.94      0.95      7318
      B-ORG       0.63      0.58      0.60       296
      B-PER       0.80      0.48      0.60       438
      I-PER       0.59      0.31      0.41       214
      B-LOC       0.71      0.62      0.66       218
      I-LOC       0.71      0.69      0.70       141
      I-ORG       0.27      0.34      0.30       151
     B-MISC       0.25      0.10      0.14       141
     I-MISC       0.36      0.23      0.28       154

avg / total       0.90      0.85      0.87      9071

F-1 Score (without O):
0.508771929825
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100047 unique words.
Found 92 unique chars.
Found 9 unique labels.
43 unique words not found in embedding.
8 unique chars not found in embedding.
Number of OOV: 326
OOV word occurences: 637
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6403072     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,509,506
Trainable params: 6,509,506
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

33/33 [==============================] - 2s 67ms/step - loss: 1.7438 - acc: 0.4266
Epoch 2/30

33/33 [==============================] - 1s 23ms/step - loss: 0.6664 - acc: 0.8462
Epoch 3/30

33/33 [==============================] - 1s 23ms/step - loss: 0.5988 - acc: 0.8457
Epoch 4/30

33/33 [==============================] - 1s 23ms/step - loss: 0.5424 - acc: 0.8494
Epoch 5/30

33/33 [==============================] - 1s 23ms/step - loss: 0.4740 - acc: 0.8487
Epoch 6/30

33/33 [==============================] - 1s 22ms/step - loss: 0.4317 - acc: 0.8564
Epoch 7/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3922 - acc: 0.8736
Epoch 8/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3375 - acc: 0.8915
Epoch 9/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3401 - acc: 0.8943
Epoch 10/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3010 - acc: 0.9061
Epoch 11/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2724 - acc: 0.9124
Epoch 12/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2614 - acc: 0.9243
Epoch 13/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2387 - acc: 0.9245
Epoch 14/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2348 - acc: 0.9235
Epoch 15/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2072 - acc: 0.9367
Epoch 16/30

33/33 [==============================] - 1s 22ms/step - loss: 0.2085 - acc: 0.9386
Epoch 17/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1838 - acc: 0.9517
Epoch 18/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1837 - acc: 0.9592
Epoch 19/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1691 - acc: 0.9605
Epoch 20/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1687 - acc: 0.9600
Epoch 21/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1516 - acc: 0.9646
Epoch 22/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1581 - acc: 0.9520
Epoch 23/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1395 - acc: 0.9682
Epoch 24/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1257 - acc: 0.9671
Epoch 25/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1168 - acc: 0.9732
Epoch 26/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1164 - acc: 0.9692
Epoch 27/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1154 - acc: 0.9715
Epoch 28/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1063 - acc: 0.9709
Epoch 29/30

33/33 [==============================] - 1s 23ms/step - loss: 0.0982 - acc: 0.9749
Epoch 30/30

33/33 [==============================] - 1s 23ms/step - loss: 0.0969 - acc: 0.9756
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7273
False 1798
True percentage 0.801785911145
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.90      0.95      0.92      7318
      B-PER       0.71      0.32      0.45       438
      B-ORG       0.34      0.42      0.38       296
      I-ORG       0.35      0.15      0.21       151
      I-PER       0.59      0.19      0.29       214
      B-LOC       0.00      0.00      0.00       218
     B-MISC       0.00      0.00      0.00       141
      I-LOC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.79      0.80      0.79      9071

F-1 Score (without O):
0.269497754185
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 100039 unique words.
Found 93 unique chars.
Found 9 unique labels.
35 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 321
OOV word occurences: 550
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6402560     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,509,058
Trainable params: 6,509,058
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

33/33 [==============================] - 2s 66ms/step - loss: 1.7929 - acc: 0.3915
Epoch 2/30

33/33 [==============================] - 1s 23ms/step - loss: 0.8646 - acc: 0.7888
Epoch 3/30

33/33 [==============================] - 1s 23ms/step - loss: 0.7643 - acc: 0.7856
Epoch 4/30

33/33 [==============================] - 1s 23ms/step - loss: 0.7836 - acc: 0.8003
Epoch 5/30

33/33 [==============================] - 1s 23ms/step - loss: 0.6186 - acc: 0.7969
Epoch 6/30

33/33 [==============================] - 1s 23ms/step - loss: 0.5752 - acc: 0.8082
Epoch 7/30

33/33 [==============================] - 1s 23ms/step - loss: 0.5224 - acc: 0.8099
Epoch 8/30

33/33 [==============================] - 1s 23ms/step - loss: 0.4954 - acc: 0.8231
Epoch 9/30

33/33 [==============================] - 1s 23ms/step - loss: 0.4609 - acc: 0.8517
Epoch 10/30

33/33 [==============================] - 1s 23ms/step - loss: 0.4299 - acc: 0.8605
Epoch 11/30

33/33 [==============================] - 1s 22ms/step - loss: 0.4034 - acc: 0.8719
Epoch 12/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3815 - acc: 0.8854
Epoch 13/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3612 - acc: 0.8962
Epoch 14/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3336 - acc: 0.9052
Epoch 15/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3251 - acc: 0.9234
Epoch 16/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3044 - acc: 0.9191
Epoch 17/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2839 - acc: 0.9297
Epoch 18/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3030 - acc: 0.9174
Epoch 19/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2682 - acc: 0.9436
Epoch 20/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3013 - acc: 0.9585
Epoch 21/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2345 - acc: 0.9619
Epoch 22/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2231 - acc: 0.9660
Epoch 23/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2121 - acc: 0.9682
Epoch 24/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1999 - acc: 0.9673
Epoch 25/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1901 - acc: 0.9668
Epoch 26/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1811 - acc: 0.9733
Epoch 27/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1755 - acc: 0.9662
Epoch 28/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1602 - acc: 0.9699
Epoch 29/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1565 - acc: 0.9711
Epoch 30/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1432 - acc: 0.9773
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7269
False 1802
True percentage 0.80134494543
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.93      0.94      7318
     B-MISC       0.12      0.05      0.07       141
     I-MISC       0.17      0.04      0.06       154
      B-ORG       0.28      0.49      0.36       296
      B-LOC       0.79      0.28      0.42       218
      B-PER       0.74      0.33      0.46       438
      I-PER       0.72      0.12      0.21       214
      I-ORG       0.18      0.68      0.29       151
      I-LOC       0.00      0.00      0.00       141

avg / total       0.87      0.80      0.82      9071

F-1 Score (without O):
0.305032417413
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100038 unique words.
Found 93 unique chars.
Found 9 unique labels.
34 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 322
OOV word occurences: 540
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6402496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,508,994
Trainable params: 6,508,994
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

33/33 [==============================] - 2s 66ms/step - loss: 1.6402 - acc: 0.4944
Epoch 2/30

33/33 [==============================] - 1s 23ms/step - loss: 0.9804 - acc: 0.8002
Epoch 3/30

33/33 [==============================] - 1s 23ms/step - loss: 0.8431 - acc: 0.8039
Epoch 4/30

33/33 [==============================] - 1s 23ms/step - loss: 0.7299 - acc: 0.7968
Epoch 5/30

33/33 [==============================] - 1s 23ms/step - loss: 0.6740 - acc: 0.8021
Epoch 6/30

33/33 [==============================] - 1s 23ms/step - loss: 0.6293 - acc: 0.8022
Epoch 7/30

33/33 [==============================] - 1s 22ms/step - loss: 0.5844 - acc: 0.8128
Epoch 8/30

33/33 [==============================] - 1s 23ms/step - loss: 0.5556 - acc: 0.8224
Epoch 9/30

33/33 [==============================] - 1s 23ms/step - loss: 0.5911 - acc: 0.8399
Epoch 10/30

33/33 [==============================] - 1s 23ms/step - loss: 0.4767 - acc: 0.8340
Epoch 11/30

33/33 [==============================] - 1s 23ms/step - loss: 0.4418 - acc: 0.8504
Epoch 12/30

33/33 [==============================] - 1s 23ms/step - loss: 0.4169 - acc: 0.8666
Epoch 13/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3981 - acc: 0.8728
Epoch 14/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3689 - acc: 0.8974
Epoch 15/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3579 - acc: 0.8959
Epoch 16/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3395 - acc: 0.9032
Epoch 17/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3340 - acc: 0.8940
Epoch 18/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2893 - acc: 0.9259
Epoch 19/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2748 - acc: 0.9269
Epoch 20/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2684 - acc: 0.9316
Epoch 21/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2428 - acc: 0.9366
Epoch 22/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2231 - acc: 0.9405
Epoch 23/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2258 - acc: 0.9451
Epoch 24/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2530 - acc: 0.9426
Epoch 25/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2027 - acc: 0.9682
Epoch 26/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1844 - acc: 0.9704
Epoch 27/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1791 - acc: 0.9684
Epoch 28/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1954 - acc: 0.9561
Epoch 29/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1584 - acc: 0.9758
Epoch 30/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1482 - acc: 0.9795
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7274
False 1797
True percentage 0.801896152574
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.90      0.94      0.92      7318
      B-PER       0.72      0.36      0.48       438
      B-ORG       0.46      0.39      0.42       296
      I-ORG       0.38      0.07      0.11       151
     B-MISC       0.12      0.01      0.03       141
     I-MISC       0.14      0.22      0.17       154
      I-PER       0.67      0.07      0.13       214
      B-LOC       0.44      0.12      0.19       218
      I-LOC       0.00      0.00      0.00       141

avg / total       0.81      0.80      0.79      9071

F-1 Score (without O):
0.279320987654
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 100068 unique words.
Found 94 unique chars.
Found 9 unique labels.
64 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 322
OOV word occurences: 621
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6404416     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,510,978
Trainable params: 6,510,978
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

33/33 [==============================] - 2s 67ms/step - loss: 1.6670 - acc: 0.4472
Epoch 2/30

33/33 [==============================] - 1s 23ms/step - loss: 1.0129 - acc: 0.7534
Epoch 3/30

33/33 [==============================] - 1s 23ms/step - loss: 0.9018 - acc: 0.7513
Epoch 4/30

33/33 [==============================] - 1s 23ms/step - loss: 0.8058 - acc: 0.7561
Epoch 5/30

33/33 [==============================] - 1s 23ms/step - loss: 0.7159 - acc: 0.7711
Epoch 6/30

33/33 [==============================] - 1s 23ms/step - loss: 0.6453 - acc: 0.7981
Epoch 7/30

33/33 [==============================] - 1s 22ms/step - loss: 0.5869 - acc: 0.8038
Epoch 8/30

33/33 [==============================] - 1s 23ms/step - loss: 0.5569 - acc: 0.8120
Epoch 9/30

33/33 [==============================] - 1s 23ms/step - loss: 0.5039 - acc: 0.8316
Epoch 10/30

33/33 [==============================] - 1s 23ms/step - loss: 0.4742 - acc: 0.8746
Epoch 11/30

33/33 [==============================] - 1s 23ms/step - loss: 0.4359 - acc: 0.8557
Epoch 12/30

33/33 [==============================] - 1s 22ms/step - loss: 0.3984 - acc: 0.8973
Epoch 13/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3795 - acc: 0.8662
Epoch 14/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3434 - acc: 0.8866
Epoch 15/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3333 - acc: 0.9013
Epoch 16/30

33/33 [==============================] - 1s 23ms/step - loss: 0.3240 - acc: 0.9312
Epoch 17/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2961 - acc: 0.9160
Epoch 18/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2586 - acc: 0.9248
Epoch 19/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2529 - acc: 0.9326
Epoch 20/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2386 - acc: 0.9335
Epoch 21/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2357 - acc: 0.9514
Epoch 22/30

33/33 [==============================] - 1s 23ms/step - loss: 0.2118 - acc: 0.9371
Epoch 23/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1902 - acc: 0.9695
Epoch 24/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1834 - acc: 0.9715
Epoch 25/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1764 - acc: 0.9614
Epoch 26/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1712 - acc: 0.9654
Epoch 27/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1688 - acc: 0.9598
Epoch 28/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1620 - acc: 0.9776
Epoch 29/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1388 - acc: 0.9781
Epoch 30/30

33/33 [==============================] - 1s 23ms/step - loss: 0.1439 - acc: 0.9799
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7375
False 1696
True percentage 0.813030536876
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.92      0.95      0.93      7318
      B-ORG       0.57      0.43      0.49       296
      B-PER       0.60      0.28      0.38       438
      I-PER       0.56      0.13      0.21       214
      B-LOC       0.58      0.43      0.49       218
      I-LOC       0.66      0.25      0.36       141
      I-ORG       0.19      0.21      0.19       151
     B-MISC       0.25      0.02      0.04       141
     I-MISC       0.39      0.10      0.16       154

avg / total       0.84      0.81      0.81      9071

F-1 Score (without O):
0.341225103345
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100027 unique words.
Found 87 unique chars.
Found 7 unique labels.
23 unique words not found in embedding.
3 unique chars not found in embedding.
Number of OOV: 327
OOV word occurences: 638
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5632        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401792     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 8)        1112        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,608
Trainable params: 6,507,608
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

16/16 [==============================] - 2s 114ms/step - loss: 2.1452 - acc: 0.0421
Epoch 2/30

16/16 [==============================] - 0s 20ms/step - loss: 1.2601 - acc: 0.8287
Epoch 3/30

16/16 [==============================] - 0s 20ms/step - loss: 0.7415 - acc: 0.8287
Epoch 4/30

16/16 [==============================] - 0s 20ms/step - loss: 0.6779 - acc: 0.8287
Epoch 5/30

16/16 [==============================] - 0s 20ms/step - loss: 0.6693 - acc: 0.8287
Epoch 6/30

16/16 [==============================] - 0s 20ms/step - loss: 0.6647 - acc: 0.8315
Epoch 7/30

16/16 [==============================] - 0s 20ms/step - loss: 0.5433 - acc: 0.8287
Epoch 8/30

16/16 [==============================] - 0s 20ms/step - loss: 0.5013 - acc: 0.8287
Epoch 9/30

16/16 [==============================] - 0s 20ms/step - loss: 0.4665 - acc: 0.8287
Epoch 10/30

16/16 [==============================] - 0s 20ms/step - loss: 0.4246 - acc: 0.8371
Epoch 11/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3978 - acc: 0.8315
Epoch 12/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3633 - acc: 0.8455
Epoch 13/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3403 - acc: 0.8708
Epoch 14/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2994 - acc: 0.8961
Epoch 15/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2907 - acc: 0.9017
Epoch 16/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2519 - acc: 0.9242
Epoch 17/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2379 - acc: 0.9354
Epoch 18/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2118 - acc: 0.9298
Epoch 19/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2001 - acc: 0.9522
Epoch 20/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1813 - acc: 0.9494
Epoch 21/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1772 - acc: 0.9747
Epoch 22/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1764 - acc: 0.9438
Epoch 23/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1991 - acc: 0.9719
Epoch 24/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1338 - acc: 0.9663
Epoch 25/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1322 - acc: 0.9747
Epoch 26/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1194 - acc: 0.9719
Epoch 27/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1102 - acc: 0.9860
Epoch 28/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1004 - acc: 0.9803
Epoch 29/30

16/16 [==============================] - 0s 20ms/step - loss: 0.0969 - acc: 0.9831
Epoch 30/30

16/16 [==============================] - 0s 20ms/step - loss: 0.0924 - acc: 0.9860
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7184
False 1592
True percentage 0.818596171376
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.88      0.95      0.91      7318
      B-PER       0.74      0.18      0.29       438
      B-ORG       0.39      0.31      0.35       296
      I-ORG       0.17      0.09      0.12       151
      I-PER       0.43      0.08      0.14       214
      B-LOC       0.00      0.00      0.00       218
     B-MISC       0.00      0.00      0.00       141

avg / total       0.79      0.82      0.79      8776

F-1 Score (without O):
0.212168486739
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 100026 unique words.
Found 89 unique chars.
Found 9 unique labels.
22 unique words not found in embedding.
5 unique chars not found in embedding.
Number of OOV: 325
OOV word occurences: 565
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5760        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401728     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,970
Trainable params: 6,507,970
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

16/16 [==============================] - 2s 109ms/step - loss: 2.2457 - acc: 0.0932
Epoch 2/30

16/16 [==============================] - 0s 20ms/step - loss: 1.1907 - acc: 0.7890
Epoch 3/30

16/16 [==============================] - 0s 20ms/step - loss: 0.9783 - acc: 0.7890
Epoch 4/30

16/16 [==============================] - 0s 20ms/step - loss: 0.9474 - acc: 0.7890
Epoch 5/30

16/16 [==============================] - 0s 20ms/step - loss: 0.7943 - acc: 0.7890
Epoch 6/30

16/16 [==============================] - 0s 20ms/step - loss: 0.7229 - acc: 0.7890
Epoch 7/30

16/16 [==============================] - 0s 20ms/step - loss: 0.7009 - acc: 0.7890
Epoch 8/30

16/16 [==============================] - 0s 20ms/step - loss: 0.6582 - acc: 0.7918
Epoch 9/30

16/16 [==============================] - 0s 20ms/step - loss: 0.6072 - acc: 0.8082
Epoch 10/30

16/16 [==============================] - 0s 20ms/step - loss: 0.5629 - acc: 0.7973
Epoch 11/30

16/16 [==============================] - 0s 20ms/step - loss: 0.5353 - acc: 0.8247
Epoch 12/30

16/16 [==============================] - 0s 21ms/step - loss: 0.5029 - acc: 0.8110
Epoch 13/30

16/16 [==============================] - 0s 20ms/step - loss: 0.4704 - acc: 0.8630
Epoch 14/30

16/16 [==============================] - 0s 20ms/step - loss: 0.4220 - acc: 0.8438
Epoch 15/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3964 - acc: 0.8904
Epoch 16/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3820 - acc: 0.8658
Epoch 17/30

16/16 [==============================] - 0s 21ms/step - loss: 0.3560 - acc: 0.9178
Epoch 18/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3248 - acc: 0.8904
Epoch 19/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3010 - acc: 0.9315
Epoch 20/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2966 - acc: 0.9123
Epoch 21/30

16/16 [==============================] - 0s 21ms/step - loss: 0.2836 - acc: 0.9452
Epoch 22/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2571 - acc: 0.9151
Epoch 23/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2411 - acc: 0.9589
Epoch 24/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2195 - acc: 0.9452
Epoch 25/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1979 - acc: 0.9616
Epoch 26/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1882 - acc: 0.9562
Epoch 27/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1735 - acc: 0.9699
Epoch 28/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1642 - acc: 0.9726
Epoch 29/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1470 - acc: 0.9726
Epoch 30/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1518 - acc: 0.9671
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7143
False 1928
True percentage 0.787454525411
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.90      0.94      0.92      7318
     B-MISC       0.07      0.11      0.08       141
     I-MISC       0.00      0.00      0.00       154
      B-ORG       0.36      0.28      0.32       296
      B-LOC       0.75      0.01      0.03       218
      B-PER       0.71      0.28      0.40       438
      I-PER       0.60      0.03      0.05       214
      I-ORG       0.16      0.19      0.17       151
      I-LOC       0.00      0.00      0.00       141

avg / total       0.80      0.79      0.78      9071

F-1 Score (without O):
0.201008925107
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100017 unique words.
Found 90 unique chars.
Found 9 unique labels.
13 unique words not found in embedding.
6 unique chars not found in embedding.
Number of OOV: 326
OOV word occurences: 636
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5824        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401152     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,458
Trainable params: 6,507,458
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

16/16 [==============================] - 2s 109ms/step - loss: 2.2849 - acc: 0.0412
Epoch 2/30

16/16 [==============================] - 0s 20ms/step - loss: 1.2279 - acc: 0.8265
Epoch 3/30

16/16 [==============================] - 0s 20ms/step - loss: 0.7292 - acc: 0.8265
Epoch 4/30

16/16 [==============================] - 0s 20ms/step - loss: 0.6905 - acc: 0.8265
Epoch 5/30

16/16 [==============================] - 0s 20ms/step - loss: 0.6711 - acc: 0.8265
Epoch 6/30

16/16 [==============================] - 0s 20ms/step - loss: 0.6737 - acc: 0.8294
Epoch 7/30

16/16 [==============================] - 0s 20ms/step - loss: 0.5937 - acc: 0.8265
Epoch 8/30

16/16 [==============================] - 0s 20ms/step - loss: 0.5533 - acc: 0.8294
Epoch 9/30

16/16 [==============================] - 0s 20ms/step - loss: 0.5045 - acc: 0.8294
Epoch 10/30

16/16 [==============================] - 0s 20ms/step - loss: 0.4649 - acc: 0.8353
Epoch 11/30

16/16 [==============================] - 0s 20ms/step - loss: 0.4329 - acc: 0.8559
Epoch 12/30

16/16 [==============================] - 0s 20ms/step - loss: 0.4015 - acc: 0.8618
Epoch 13/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3618 - acc: 0.8912
Epoch 14/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3296 - acc: 0.8912
Epoch 15/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3067 - acc: 0.9000
Epoch 16/30

16/16 [==============================] - 0s 21ms/step - loss: 0.3377 - acc: 0.9471
Epoch 17/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2847 - acc: 0.8971
Epoch 18/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2636 - acc: 0.9382
Epoch 19/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2416 - acc: 0.9324
Epoch 20/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2146 - acc: 0.9441
Epoch 21/30

16/16 [==============================] - 0s 21ms/step - loss: 0.2012 - acc: 0.9382
Epoch 22/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1862 - acc: 0.9647
Epoch 23/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1963 - acc: 0.9412
Epoch 24/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2422 - acc: 0.9588
Epoch 25/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1709 - acc: 0.9647
Epoch 26/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1542 - acc: 0.9618
Epoch 27/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1468 - acc: 0.9735
Epoch 28/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1433 - acc: 0.9706
Epoch 29/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1253 - acc: 0.9824
Epoch 30/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1248 - acc: 0.9882
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7161
False 1910
True percentage 0.789438871128
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.88      0.95      0.91      7318
      B-PER       0.54      0.16      0.25       438
      B-ORG       0.39      0.36      0.37       296
      I-ORG       0.27      0.04      0.07       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      I-PER       0.35      0.10      0.16       214
      B-LOC       0.78      0.03      0.06       218
      I-LOC       0.00      0.00      0.00       141

avg / total       0.78      0.79      0.77      9071

F-1 Score (without O):
0.188360728565
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 100036 unique words.
Found 94 unique chars.
Found 9 unique labels.
32 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 327
OOV word occurences: 640
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6402368     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,508,930
Trainable params: 6,508,930
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

16/16 [==============================] - 2s 110ms/step - loss: 2.1135 - acc: 0.2043
Epoch 2/30

16/16 [==============================] - 0s 20ms/step - loss: 1.1471 - acc: 0.7625
Epoch 3/30

16/16 [==============================] - 0s 20ms/step - loss: 0.9623 - acc: 0.7625
Epoch 4/30

16/16 [==============================] - 0s 20ms/step - loss: 0.9239 - acc: 0.7648
Epoch 5/30

16/16 [==============================] - 0s 20ms/step - loss: 0.7909 - acc: 0.7625
Epoch 6/30

16/16 [==============================] - 0s 20ms/step - loss: 0.7457 - acc: 0.7648
Epoch 7/30

16/16 [==============================] - 0s 20ms/step - loss: 0.6976 - acc: 0.7672
Epoch 8/30

16/16 [==============================] - 0s 20ms/step - loss: 0.6484 - acc: 0.7862
Epoch 9/30

16/16 [==============================] - 0s 20ms/step - loss: 0.5985 - acc: 0.7981
Epoch 10/30

16/16 [==============================] - 0s 20ms/step - loss: 0.5502 - acc: 0.8290
Epoch 11/30

16/16 [==============================] - 0s 20ms/step - loss: 0.5168 - acc: 0.8242
Epoch 12/30

16/16 [==============================] - 0s 20ms/step - loss: 0.4623 - acc: 0.8456
Epoch 13/30

16/16 [==============================] - 0s 20ms/step - loss: 0.4426 - acc: 0.8599
Epoch 14/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3960 - acc: 0.8551
Epoch 15/30

16/16 [==============================] - 0s 20ms/step - loss: 0.4925 - acc: 0.8931
Epoch 16/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3808 - acc: 0.8504
Epoch 17/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3398 - acc: 0.9097
Epoch 18/30

16/16 [==============================] - 0s 20ms/step - loss: 0.3078 - acc: 0.9311
Epoch 19/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2825 - acc: 0.9264
Epoch 20/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2656 - acc: 0.9382
Epoch 21/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2431 - acc: 0.9454
Epoch 22/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2286 - acc: 0.9454
Epoch 23/30

16/16 [==============================] - 0s 20ms/step - loss: 0.2028 - acc: 0.9620
Epoch 24/30

16/16 [==============================] - 0s 21ms/step - loss: 0.1980 - acc: 0.9572
Epoch 25/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1824 - acc: 0.9667
Epoch 26/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1631 - acc: 0.9620
Epoch 27/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1515 - acc: 0.9762
Epoch 28/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1390 - acc: 0.9762
Epoch 29/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1257 - acc: 0.9715
Epoch 30/30

16/16 [==============================] - 0s 20ms/step - loss: 0.1188 - acc: 0.9810
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7214
False 1857
True percentage 0.79528166685
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.90      0.94      0.92      7318
      B-ORG       0.38      0.32      0.35       296
      B-PER       0.43      0.23      0.30       438
      I-PER       0.55      0.10      0.17       214
      B-LOC       0.43      0.33      0.37       218
      I-LOC       0.33      0.01      0.03       141
      I-ORG       0.22      0.10      0.14       151
     B-MISC       0.05      0.01      0.01       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.79      0.80      0.79      9071

F-1 Score (without O):
0.243786982249
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100013 unique words.
Found 85 unique chars.
Found 6 unique labels.
9 unique words not found in embedding.
1 unique chars not found in embedding.
Number of OOV: 328
OOV word occurences: 641
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5504        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6400896     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 7)        966         bidirectional_2[0][0]            
==================================================================================================
Total params: 6,506,438
Trainable params: 6,506,438
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

8/8 [==============================] - 2s 202ms/step - loss: 1.6716 - acc: 0.5746
Epoch 2/30

8/8 [==============================] - 0s 24ms/step - loss: 0.6627 - acc: 0.8729
Epoch 3/30

8/8 [==============================] - 0s 24ms/step - loss: 0.5489 - acc: 0.8729
Epoch 4/30

8/8 [==============================] - 0s 24ms/step - loss: 0.4944 - acc: 0.8729
Epoch 5/30

8/8 [==============================] - 0s 24ms/step - loss: 0.4313 - acc: 0.8729
Epoch 6/30

8/8 [==============================] - 0s 24ms/step - loss: 0.4011 - acc: 0.8729
Epoch 7/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3789 - acc: 0.8729
Epoch 8/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3445 - acc: 0.8785
Epoch 9/30

8/8 [==============================] - 0s 23ms/step - loss: 0.3238 - acc: 0.8840
Epoch 10/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2868 - acc: 0.8840
Epoch 11/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2612 - acc: 0.9006
Epoch 12/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2460 - acc: 0.9503
Epoch 13/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2494 - acc: 0.8895
Epoch 14/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2364 - acc: 0.9779
Epoch 15/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1795 - acc: 0.9392
Epoch 16/30

8/8 [==============================] - 0s 23ms/step - loss: 0.1534 - acc: 0.9613
Epoch 17/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1406 - acc: 0.9613
Epoch 18/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1165 - acc: 0.9779
Epoch 19/30

8/8 [==============================] - 0s 23ms/step - loss: 0.1137 - acc: 0.9724
Epoch 20/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1107 - acc: 0.9779
Epoch 21/30

8/8 [==============================] - 0s 23ms/step - loss: 0.0872 - acc: 0.9834
Epoch 22/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0814 - acc: 0.9890
Epoch 23/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0709 - acc: 0.9834
Epoch 24/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0666 - acc: 0.9945
Epoch 25/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0620 - acc: 0.9945
Epoch 26/30

8/8 [==============================] - 0s 23ms/step - loss: 0.0634 - acc: 0.9945
Epoch 27/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0485 - acc: 0.9890
Epoch 28/30

8/8 [==============================] - 0s 23ms/step - loss: 0.0465 - acc: 0.9945
Epoch 29/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0452 - acc: 1.0000
Epoch 30/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0383 - acc: 0.9945
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7208
False 1427
True percentage 0.834742327736
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.87      0.95      0.91      7318
      B-PER       0.66      0.23      0.34       438
      B-ORG       0.48      0.29      0.36       296
      I-ORG       0.55      0.04      0.07       151
      I-PER       0.53      0.14      0.22       214
      B-LOC       0.00      0.00      0.00       218

avg / total       0.81      0.83      0.81      8635

F-1 Score (without O):
0.258440046566
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 7
Found 100004 word vectors.
Found 84 char vectors.
Found 100017 unique words.
Found 86 unique chars.
Found 8 unique labels.
13 unique words not found in embedding.
2 unique chars not found in embedding.
Number of OOV: 327
OOV word occurences: 573
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5568        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401152     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,052
Trainable params: 6,507,052
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

8/8 [==============================] - 2s 202ms/step - loss: 2.3385 - acc: 0.0109
Epoch 2/30

8/8 [==============================] - 0s 24ms/step - loss: 1.4149 - acc: 0.8261
Epoch 3/30

8/8 [==============================] - 0s 24ms/step - loss: 0.7646 - acc: 0.8261
Epoch 4/30

8/8 [==============================] - 0s 24ms/step - loss: 0.6602 - acc: 0.8261
Epoch 5/30

8/8 [==============================] - 0s 24ms/step - loss: 0.7399 - acc: 0.8261
Epoch 6/30

8/8 [==============================] - 0s 24ms/step - loss: 0.7321 - acc: 0.8478
Epoch 7/30

8/8 [==============================] - 0s 24ms/step - loss: 0.5535 - acc: 0.8261
Epoch 8/30

8/8 [==============================] - 0s 24ms/step - loss: 0.5349 - acc: 0.8261
Epoch 9/30

8/8 [==============================] - 0s 24ms/step - loss: 0.4844 - acc: 0.8261
Epoch 10/30

8/8 [==============================] - 0s 24ms/step - loss: 0.4434 - acc: 0.8478
Epoch 11/30

8/8 [==============================] - 0s 24ms/step - loss: 0.4177 - acc: 0.8533
Epoch 12/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3895 - acc: 0.8696
Epoch 13/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3708 - acc: 0.8587
Epoch 14/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3338 - acc: 0.8804
Epoch 15/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3347 - acc: 0.9076
Epoch 16/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2932 - acc: 0.8913
Epoch 17/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2737 - acc: 0.9185
Epoch 18/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2602 - acc: 0.9293
Epoch 19/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2265 - acc: 0.9457
Epoch 20/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2142 - acc: 0.9565
Epoch 21/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1936 - acc: 0.9457
Epoch 22/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1797 - acc: 0.9728
Epoch 23/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1735 - acc: 0.9620
Epoch 24/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1490 - acc: 0.9783
Epoch 25/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1332 - acc: 0.9783
Epoch 26/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1395 - acc: 0.9837
Epoch 27/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1272 - acc: 0.9891
Epoch 28/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1052 - acc: 0.9783
Epoch 29/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1266 - acc: 0.9891
Epoch 30/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1187 - acc: 0.9674
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7129
False 1801
True percentage 0.798320268757
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.87      0.95      0.91      7318
     B-MISC       0.03      0.01      0.02       141
     I-MISC       0.00      0.00      0.00       154
      B-ORG       0.37      0.25      0.30       296
      B-LOC       0.00      0.00      0.00       218
      B-PER       0.84      0.17      0.28       438
      I-PER       0.00      0.00      0.00       214
      I-ORG       0.14      0.11      0.13       151

avg / total       0.77      0.80      0.77      8930

F-1 Score (without O):
0.159961685824
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100010 unique words.
Found 89 unique chars.
Found 9 unique labels.
6 unique words not found in embedding.
5 unique chars not found in embedding.
Number of OOV: 328
OOV word occurences: 641
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5760        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6400704     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,506,946
Trainable params: 6,506,946
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

8/8 [==============================] - 2s 203ms/step - loss: 2.5402 - acc: 0.0116
Epoch 2/30

8/8 [==============================] - 0s 24ms/step - loss: 1.2680 - acc: 0.8208
Epoch 3/30

8/8 [==============================] - 0s 24ms/step - loss: 0.8887 - acc: 0.8208
Epoch 4/30

8/8 [==============================] - 0s 24ms/step - loss: 0.8310 - acc: 0.8208
Epoch 5/30

8/8 [==============================] - 0s 24ms/step - loss: 0.7298 - acc: 0.8208
Epoch 6/30

8/8 [==============================] - 0s 24ms/step - loss: 0.6926 - acc: 0.8208
Epoch 7/30

8/8 [==============================] - 0s 24ms/step - loss: 0.6494 - acc: 0.8208
Epoch 8/30

8/8 [==============================] - 0s 24ms/step - loss: 0.6253 - acc: 0.8208
Epoch 9/30

8/8 [==============================] - 0s 24ms/step - loss: 0.5864 - acc: 0.8208
Epoch 10/30

8/8 [==============================] - 0s 24ms/step - loss: 0.5625 - acc: 0.8208
Epoch 11/30

8/8 [==============================] - 0s 24ms/step - loss: 0.5448 - acc: 0.8208
Epoch 12/30

8/8 [==============================] - 0s 24ms/step - loss: 0.4972 - acc: 0.8439
Epoch 13/30

8/8 [==============================] - 0s 24ms/step - loss: 0.4703 - acc: 0.8208
Epoch 14/30

8/8 [==============================] - 0s 24ms/step - loss: 0.4419 - acc: 0.8728
Epoch 15/30

8/8 [==============================] - 0s 24ms/step - loss: 0.4206 - acc: 0.8266
Epoch 16/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3708 - acc: 0.8786
Epoch 17/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3484 - acc: 0.8728
Epoch 18/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3329 - acc: 0.9191
Epoch 19/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3148 - acc: 0.9075
Epoch 20/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3049 - acc: 0.9306
Epoch 21/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2735 - acc: 0.9075
Epoch 22/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2582 - acc: 0.9480
Epoch 23/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2488 - acc: 0.9306
Epoch 24/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2389 - acc: 0.9480
Epoch 25/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2108 - acc: 0.9306
Epoch 26/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2072 - acc: 0.9364
Epoch 27/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1920 - acc: 0.9422
Epoch 28/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1812 - acc: 0.9769
Epoch 29/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1685 - acc: 0.9364
Epoch 30/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1743 - acc: 0.9769
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7054
False 2017
True percentage 0.777643038254
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.87      0.95      0.90      7318
      B-PER       0.74      0.07      0.13       438
      B-ORG       0.25      0.33      0.28       296
      I-ORG       0.00      0.00      0.00       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      I-PER       0.50      0.01      0.02       214
      B-LOC       0.60      0.01      0.03       218
      I-LOC       0.00      0.00      0.00       141

avg / total       0.77      0.78      0.75      9071

F-1 Score (without O):
0.122282608696
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 100013 unique words.
Found 93 unique chars.
Found 9 unique labels.
9 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 327
OOV word occurences: 640
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6400896     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,394
Trainable params: 6,507,394
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

8/8 [==============================] - 2s 202ms/step - loss: 2.0500 - acc: 0.5359
Epoch 2/30

8/8 [==============================] - 0s 24ms/step - loss: 1.3196 - acc: 0.7238
Epoch 3/30

8/8 [==============================] - 0s 24ms/step - loss: 0.9936 - acc: 0.7238
Epoch 4/30

8/8 [==============================] - 0s 24ms/step - loss: 0.9211 - acc: 0.7238
Epoch 5/30

8/8 [==============================] - 0s 24ms/step - loss: 0.8359 - acc: 0.7238
Epoch 6/30

8/8 [==============================] - 0s 24ms/step - loss: 0.7759 - acc: 0.7459
Epoch 7/30

8/8 [==============================] - 0s 24ms/step - loss: 0.7635 - acc: 0.7238
Epoch 8/30

8/8 [==============================] - 0s 24ms/step - loss: 0.7412 - acc: 0.8564
Epoch 9/30

8/8 [==============================] - 0s 24ms/step - loss: 0.5726 - acc: 0.7845
Epoch 10/30

8/8 [==============================] - 0s 24ms/step - loss: 0.5143 - acc: 0.8122
Epoch 11/30

8/8 [==============================] - 0s 24ms/step - loss: 0.4770 - acc: 0.8785
Epoch 12/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3989 - acc: 0.8840
Epoch 13/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3960 - acc: 0.9061
Epoch 14/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3365 - acc: 0.8950
Epoch 15/30

8/8 [==============================] - 0s 24ms/step - loss: 0.3267 - acc: 0.9558
Epoch 16/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2703 - acc: 0.9337
Epoch 17/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2375 - acc: 0.9613
Epoch 18/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2378 - acc: 0.9558
Epoch 19/30

8/8 [==============================] - 0s 24ms/step - loss: 0.2118 - acc: 0.9724
Epoch 20/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1906 - acc: 0.9558
Epoch 21/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1918 - acc: 0.9945
Epoch 22/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1543 - acc: 0.9724
Epoch 23/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1419 - acc: 0.9834
Epoch 24/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1180 - acc: 0.9945
Epoch 25/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1183 - acc: 0.9890
Epoch 26/30

8/8 [==============================] - 0s 24ms/step - loss: 0.1176 - acc: 0.9890
Epoch 27/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0934 - acc: 1.0000
Epoch 28/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0852 - acc: 1.0000
Epoch 29/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0773 - acc: 0.9945
Epoch 30/30

8/8 [==============================] - 0s 24ms/step - loss: 0.0775 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7216
False 1855
True percentage 0.795502149708
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.89      0.95      0.92      7318
      B-ORG       0.51      0.28      0.36       296
      B-PER       0.45      0.23      0.30       438
      I-PER       0.32      0.10      0.15       214
      B-LOC       0.42      0.31      0.35       218
      I-LOC       0.00      0.00      0.00       141
      I-ORG       0.20      0.01      0.01       151
     B-MISC       0.42      0.04      0.07       141
     I-MISC       0.18      0.01      0.02       154

avg / total       0.79      0.80      0.78      9071

F-1 Score (without O):
0.233082706767
