Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

1674/1674 [==============================] - 48s 29ms/step - loss: 0.4101 - acc: 0.8755
Epoch 2/30

1674/1674 [==============================] - 46s 27ms/step - loss: 0.2367 - acc: 0.9290
Epoch 3/30

1674/1674 [==============================] - 46s 28ms/step - loss: 0.1887 - acc: 0.9436
Epoch 4/30

1674/1674 [==============================] - 46s 28ms/step - loss: 0.1551 - acc: 0.9544
Epoch 5/30

1674/1674 [==============================] - 46s 28ms/step - loss: 0.1334 - acc: 0.9614
Epoch 6/30

1674/1674 [==============================] - 47s 28ms/step - loss: 0.1180 - acc: 0.9657
Epoch 7/30

1674/1674 [==============================] - 47s 28ms/step - loss: 0.1038 - acc: 0.9697
Epoch 8/30

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0954 - acc: 0.9725
Epoch 9/30

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0860 - acc: 0.9747
Epoch 10/30

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0798 - acc: 0.9766
Epoch 11/30

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0729 - acc: 0.9798
Epoch 12/30

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0675 - acc: 0.9809
Epoch 13/30

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0612 - acc: 0.9825
Epoch 14/30

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0576 - acc: 0.9837
Epoch 15/30

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0541 - acc: 0.9843
Epoch 16/30

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0510 - acc: 0.9855
Epoch 17/30

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0487 - acc: 0.9861
Epoch 18/30

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0470 - acc: 0.9859
Epoch 19/30

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0435 - acc: 0.9878
Epoch 20/30

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0404 - acc: 0.9888
Epoch 21/30

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0397 - acc: 0.9889
Epoch 22/30

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0373 - acc: 0.9899
Epoch 23/30

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0352 - acc: 0.9903
Epoch 24/30

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0360 - acc: 0.9898
Epoch 25/30

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0326 - acc: 0.9908
Epoch 26/30

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0303 - acc: 0.9915
Epoch 27/30

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0305 - acc: 0.9912
Epoch 28/30

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0310 - acc: 0.9909
Epoch 29/30

1674/1674 [==============================] - 46s 28ms/step - loss: 0.0282 - acc: 0.9919
Epoch 30/30

1674/1674 [==============================] - 47s 28ms/step - loss: 0.0276 - acc: 0.9925
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8260
False 811
True percentage 0.910594201301
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
      B-LOC       0.73      0.74      0.74       218
      I-LOC       0.74      0.78      0.76       141
      B-PER       0.90      0.84      0.87       438
      B-ORG       0.76      0.73      0.75       296
      I-ORG       0.63      0.58      0.61       151
     B-MISC       0.46      0.36      0.40       141
     I-MISC       0.53      0.45      0.49       154
      I-PER       0.92      0.67      0.78       214

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.721477509681
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

1674/1674 [==============================] - 46s 27ms/step - loss: 0.4068 - acc: 0.8737
Epoch 2/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.2375 - acc: 0.9272
Epoch 3/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.1899 - acc: 0.9433
Epoch 4/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.1584 - acc: 0.9532
Epoch 5/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.1359 - acc: 0.9597
Epoch 6/30

1674/1674 [==============================] - 44s 27ms/step - loss: 0.1190 - acc: 0.9648
Epoch 7/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.1050 - acc: 0.9698
Epoch 8/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0979 - acc: 0.9724
Epoch 9/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0852 - acc: 0.9760
Epoch 10/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0778 - acc: 0.9787
Epoch 11/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0713 - acc: 0.9801
Epoch 12/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0660 - acc: 0.9820
Epoch 13/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0619 - acc: 0.9833
Epoch 14/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0594 - acc: 0.9833
Epoch 15/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0539 - acc: 0.9855
Epoch 16/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0494 - acc: 0.9864
Epoch 17/30

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0470 - acc: 0.9869
Epoch 18/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0449 - acc: 0.9872
Epoch 19/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0432 - acc: 0.9877
Epoch 20/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0412 - acc: 0.9884
Epoch 21/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0391 - acc: 0.9887
Epoch 22/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0379 - acc: 0.9886
Epoch 23/30

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0358 - acc: 0.9901
Epoch 24/30

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0335 - acc: 0.9905
Epoch 25/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0331 - acc: 0.9904
Epoch 26/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0314 - acc: 0.9912
Epoch 27/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0296 - acc: 0.9916
Epoch 28/30

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0296 - acc: 0.9913
Epoch 29/30

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0275 - acc: 0.9921
Epoch 30/30

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0270 - acc: 0.9925
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8246
False 825
True percentage 0.909050821299
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.90      0.84      0.87       438
      I-PER       0.92      0.66      0.77       214
          O       0.99      0.96      0.97      7318
      B-ORG       0.74      0.73      0.73       296
      I-ORG       0.63      0.68      0.65       151
      B-LOC       0.75      0.74      0.75       218
      I-LOC       0.69      0.79      0.74       141
     B-MISC       0.43      0.30      0.36       141
     I-MISC       0.54      0.43      0.48       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.927788903287
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104754 unique words.
4750 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 246
OOV word occurences: in test 365
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6704320     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,816,450
Trainable params: 6,816,450
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

837/837 [==============================] - 24s 29ms/step - loss: 0.5258 - acc: 0.8376
Epoch 2/30

837/837 [==============================] - 23s 27ms/step - loss: 0.3151 - acc: 0.9041
Epoch 3/30

837/837 [==============================] - 23s 27ms/step - loss: 0.2572 - acc: 0.9222
Epoch 4/30

837/837 [==============================] - 23s 27ms/step - loss: 0.2156 - acc: 0.9380
Epoch 5/30

837/837 [==============================] - 23s 27ms/step - loss: 0.1901 - acc: 0.9452
Epoch 6/30

837/837 [==============================] - 23s 27ms/step - loss: 0.1668 - acc: 0.9523
Epoch 7/30

837/837 [==============================] - 22s 27ms/step - loss: 0.1485 - acc: 0.9572
Epoch 8/30

837/837 [==============================] - 23s 27ms/step - loss: 0.1351 - acc: 0.9619
Epoch 9/30

837/837 [==============================] - 23s 27ms/step - loss: 0.1234 - acc: 0.9644
Epoch 10/30

837/837 [==============================] - 23s 27ms/step - loss: 0.1080 - acc: 0.9719
Epoch 11/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0996 - acc: 0.9724
Epoch 12/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0923 - acc: 0.9749
Epoch 13/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0821 - acc: 0.9780
Epoch 14/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0753 - acc: 0.9791
Epoch 15/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0705 - acc: 0.9805
Epoch 16/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0663 - acc: 0.9826
Epoch 17/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0614 - acc: 0.9827
Epoch 18/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0591 - acc: 0.9852
Epoch 19/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0540 - acc: 0.9868
Epoch 20/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0497 - acc: 0.9881
Epoch 21/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0465 - acc: 0.9889
Epoch 22/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0461 - acc: 0.9880
Epoch 23/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0427 - acc: 0.9893
Epoch 24/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0411 - acc: 0.9893
Epoch 25/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0393 - acc: 0.9895
Epoch 26/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0371 - acc: 0.9906
Epoch 27/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0348 - acc: 0.9911
Epoch 28/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0343 - acc: 0.9917
Epoch 29/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0329 - acc: 0.9918
Epoch 30/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0310 - acc: 0.9922
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8153
False 918
True percentage 0.898798368427
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-LOC       0.70      0.78      0.73       218
      I-LOC       0.74      0.83      0.78       141
      B-PER       0.90      0.78      0.83       438
      B-ORG       0.70      0.67      0.69       296
      I-ORG       0.57      0.54      0.55       151
     B-MISC       0.41      0.23      0.30       141
     I-MISC       0.49      0.35      0.41       154
      I-PER       0.90      0.61      0.73       214

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.682867557716
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104724 unique words.
4720 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 245
OOV word occurences: in test 381
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6702400     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,814,530
Trainable params: 6,814,530
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

837/837 [==============================] - 24s 28ms/step - loss: 0.5156 - acc: 0.8400
Epoch 2/30

837/837 [==============================] - 22s 27ms/step - loss: 0.3085 - acc: 0.9082
Epoch 3/30

837/837 [==============================] - 22s 27ms/step - loss: 0.2490 - acc: 0.9255
Epoch 4/30

837/837 [==============================] - 22s 27ms/step - loss: 0.2076 - acc: 0.9381
Epoch 5/30

837/837 [==============================] - 22s 27ms/step - loss: 0.1782 - acc: 0.9485
Epoch 6/30

837/837 [==============================] - 22s 27ms/step - loss: 0.1553 - acc: 0.9562
Epoch 7/30

837/837 [==============================] - 22s 27ms/step - loss: 0.1395 - acc: 0.9598
Epoch 8/30

837/837 [==============================] - 22s 27ms/step - loss: 0.1205 - acc: 0.9673
Epoch 9/30

837/837 [==============================] - 22s 27ms/step - loss: 0.1131 - acc: 0.9674
Epoch 10/30

837/837 [==============================] - 22s 27ms/step - loss: 0.1004 - acc: 0.9731
Epoch 11/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0926 - acc: 0.9742
Epoch 12/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0823 - acc: 0.9782
Epoch 13/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0783 - acc: 0.9789
Epoch 14/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0723 - acc: 0.9814
Epoch 15/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0675 - acc: 0.9829
Epoch 16/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0633 - acc: 0.9848
Epoch 17/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0589 - acc: 0.9853
Epoch 18/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0558 - acc: 0.9858
Epoch 19/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0516 - acc: 0.9867
Epoch 20/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0496 - acc: 0.9869
Epoch 21/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0489 - acc: 0.9866
Epoch 22/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0445 - acc: 0.9885
Epoch 23/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0408 - acc: 0.9897
Epoch 24/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0381 - acc: 0.9905
Epoch 25/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0375 - acc: 0.9902
Epoch 26/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0353 - acc: 0.9910
Epoch 27/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0332 - acc: 0.9917
Epoch 28/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0325 - acc: 0.9912
Epoch 29/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0309 - acc: 0.9926
Epoch 30/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0295 - acc: 0.9933
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8116
False 955
True percentage 0.894719435564
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.86      0.74      0.80       438
      I-PER       0.91      0.64      0.75       214
          O       0.98      0.96      0.97      7318
      B-ORG       0.69      0.70      0.70       296
      I-ORG       0.54      0.56      0.55       151
      B-LOC       0.71      0.76      0.73       218
      I-LOC       0.63      0.79      0.70       141
     B-MISC       0.44      0.19      0.27       141
     I-MISC       0.53      0.25      0.34       154

avg / total       0.93      0.89      0.91      9071

F-1 Score (without O):
0.91951852726
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104723 unique words.
4719 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 247
OOV word occurences: in test 373
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6702336     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,814,466
Trainable params: 6,814,466
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

837/837 [==============================] - 24s 29ms/step - loss: 0.5021 - acc: 0.8439
Epoch 2/30

837/837 [==============================] - 23s 27ms/step - loss: 0.2906 - acc: 0.9127
Epoch 3/30

837/837 [==============================] - 23s 27ms/step - loss: 0.2348 - acc: 0.9292
Epoch 4/30

837/837 [==============================] - 23s 27ms/step - loss: 0.1957 - acc: 0.9431
Epoch 5/30

837/837 [==============================] - 23s 27ms/step - loss: 0.1713 - acc: 0.9491
Epoch 6/30

837/837 [==============================] - 23s 27ms/step - loss: 0.1495 - acc: 0.9563
Epoch 7/30

837/837 [==============================] - 23s 28ms/step - loss: 0.1363 - acc: 0.9612
Epoch 8/30

837/837 [==============================] - 23s 27ms/step - loss: 0.1196 - acc: 0.9650
Epoch 9/30

837/837 [==============================] - 23s 28ms/step - loss: 0.1077 - acc: 0.9699
Epoch 10/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0976 - acc: 0.9724
Epoch 11/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0887 - acc: 0.9756
Epoch 12/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0810 - acc: 0.9771
Epoch 13/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0741 - acc: 0.9797
Epoch 14/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0664 - acc: 0.9829
Epoch 15/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0649 - acc: 0.9826
Epoch 16/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0598 - acc: 0.9837
Epoch 17/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0519 - acc: 0.9864
Epoch 18/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0535 - acc: 0.9854
Epoch 19/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0480 - acc: 0.9877
Epoch 20/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0457 - acc: 0.9878
Epoch 21/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0441 - acc: 0.9879
Epoch 22/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0386 - acc: 0.9906
Epoch 23/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0373 - acc: 0.9907
Epoch 24/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0359 - acc: 0.9908
Epoch 25/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0340 - acc: 0.9919
Epoch 26/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0297 - acc: 0.9925
Epoch 27/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0297 - acc: 0.9923
Epoch 28/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0298 - acc: 0.9923
Epoch 29/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0267 - acc: 0.9940
Epoch 30/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0270 - acc: 0.9928
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8134
False 937
True percentage 0.896703781281
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.88      0.74      0.80       438
      B-LOC       0.71      0.69      0.70       218
     B-MISC       0.43      0.30      0.36       141
     I-MISC       0.52      0.37      0.43       154
      B-ORG       0.68      0.73      0.71       296
      I-ORG       0.56      0.63      0.59       151
      I-LOC       0.75      0.72      0.73       141
      I-PER       0.89      0.65      0.75       214

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.678119349005
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104344 unique words.
4340 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 264
OOV word occurences: in test 412
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678080     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,210
Trainable params: 6,790,210
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

334/334 [==============================] - 11s 32ms/step - loss: 0.6883 - acc: 0.7890
Epoch 2/30

334/334 [==============================] - 9s 26ms/step - loss: 0.4170 - acc: 0.8676
Epoch 3/30

334/334 [==============================] - 9s 26ms/step - loss: 0.3497 - acc: 0.8937
Epoch 4/30

334/334 [==============================] - 9s 27ms/step - loss: 0.2977 - acc: 0.9122
Epoch 5/30

334/334 [==============================] - 9s 27ms/step - loss: 0.2672 - acc: 0.9219
Epoch 6/30

334/334 [==============================] - 9s 27ms/step - loss: 0.2339 - acc: 0.9339
Epoch 7/30

334/334 [==============================] - 9s 27ms/step - loss: 0.2069 - acc: 0.9434
Epoch 8/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1926 - acc: 0.9451
Epoch 9/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1696 - acc: 0.9579
Epoch 10/30

334/334 [==============================] - 9s 26ms/step - loss: 0.1506 - acc: 0.9609
Epoch 11/30

334/334 [==============================] - 9s 26ms/step - loss: 0.1398 - acc: 0.9661
Epoch 12/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1262 - acc: 0.9687
Epoch 13/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1174 - acc: 0.9694
Epoch 14/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1054 - acc: 0.9748
Epoch 15/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0957 - acc: 0.9769
Epoch 16/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0918 - acc: 0.9771
Epoch 17/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0855 - acc: 0.9784
Epoch 18/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0777 - acc: 0.9806
Epoch 19/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0736 - acc: 0.9820
Epoch 20/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0663 - acc: 0.9846
Epoch 21/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0637 - acc: 0.9844
Epoch 22/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0608 - acc: 0.9852
Epoch 23/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0569 - acc: 0.9869
Epoch 24/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0548 - acc: 0.9872
Epoch 25/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0485 - acc: 0.9901
Epoch 26/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0462 - acc: 0.9901
Epoch 27/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0443 - acc: 0.9906
Epoch 28/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0406 - acc: 0.9923
Epoch 29/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0411 - acc: 0.9901
Epoch 30/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0357 - acc: 0.9933
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8001
False 1070
True percentage 0.88204167126
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.97      7318
      B-LOC       0.66      0.72      0.69       218
      I-LOC       0.70      0.72      0.71       141
      B-PER       0.87      0.71      0.78       438
      B-ORG       0.58      0.71      0.64       296
      I-ORG       0.42      0.48      0.45       151
     B-MISC       0.53      0.26      0.34       141
     I-MISC       0.48      0.31      0.37       154
      I-PER       0.85      0.56      0.67       214

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.631863186319
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104349 unique words.
4345 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 258
OOV word occurences: in test 418
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678400     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,530
Trainable params: 6,790,530
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

334/334 [==============================] - 11s 32ms/step - loss: 0.6311 - acc: 0.8043
Epoch 2/30

334/334 [==============================] - 9s 27ms/step - loss: 0.3709 - acc: 0.8883
Epoch 3/30

334/334 [==============================] - 9s 27ms/step - loss: 0.3065 - acc: 0.9089
Epoch 4/30

334/334 [==============================] - 9s 27ms/step - loss: 0.2593 - acc: 0.9249
Epoch 5/30

334/334 [==============================] - 9s 27ms/step - loss: 0.2311 - acc: 0.9312
Epoch 6/30

334/334 [==============================] - 9s 27ms/step - loss: 0.2012 - acc: 0.9442
Epoch 7/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1830 - acc: 0.9481
Epoch 8/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1626 - acc: 0.9564
Epoch 9/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1468 - acc: 0.9603
Epoch 10/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1312 - acc: 0.9653
Epoch 11/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1201 - acc: 0.9697
Epoch 12/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1093 - acc: 0.9728
Epoch 13/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0974 - acc: 0.9752
Epoch 14/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0887 - acc: 0.9782
Epoch 15/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0856 - acc: 0.9781
Epoch 16/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0754 - acc: 0.9820
Epoch 17/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0690 - acc: 0.9831
Epoch 18/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0660 - acc: 0.9849
Epoch 19/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0601 - acc: 0.9870
Epoch 20/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0543 - acc: 0.9893
Epoch 21/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0521 - acc: 0.9868
Epoch 22/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0486 - acc: 0.9890
Epoch 23/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0446 - acc: 0.9913
Epoch 24/30

334/334 [==============================] - 9s 28ms/step - loss: 0.0431 - acc: 0.9908
Epoch 25/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0375 - acc: 0.9926
Epoch 26/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0403 - acc: 0.9909
Epoch 27/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0373 - acc: 0.9929
Epoch 28/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0336 - acc: 0.9938
Epoch 29/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0318 - acc: 0.9944
Epoch 30/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0306 - acc: 0.9948
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7988
False 1083
True percentage 0.880608532687
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.78      0.71      0.74       438
      I-PER       0.87      0.58      0.70       214
          O       0.98      0.96      0.97      7318
      B-ORG       0.62      0.58      0.60       296
      I-ORG       0.50      0.40      0.44       151
      B-LOC       0.67      0.71      0.69       218
      I-LOC       0.68      0.67      0.68       141
     B-MISC       0.29      0.13      0.18       141
     I-MISC       0.45      0.28      0.35       154

avg / total       0.91      0.88      0.90      9071

F-1 Score (without O):
0.909273954755
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104341 unique words.
4337 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 260
OOV word occurences: in test 400
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6677888     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,018
Trainable params: 6,790,018
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

334/334 [==============================] - 11s 32ms/step - loss: 0.5953 - acc: 0.8145
Epoch 2/30

334/334 [==============================] - 9s 27ms/step - loss: 0.3399 - acc: 0.8948
Epoch 3/30

334/334 [==============================] - 9s 27ms/step - loss: 0.2770 - acc: 0.9198
Epoch 4/30

334/334 [==============================] - 9s 27ms/step - loss: 0.2348 - acc: 0.9344
Epoch 5/30

334/334 [==============================] - 9s 27ms/step - loss: 0.2046 - acc: 0.9434
Epoch 6/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1787 - acc: 0.9489
Epoch 7/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1648 - acc: 0.9540
Epoch 8/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1449 - acc: 0.9593
Epoch 9/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1299 - acc: 0.9645
Epoch 10/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1173 - acc: 0.9669
Epoch 11/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1073 - acc: 0.9713
Epoch 12/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0984 - acc: 0.9756
Epoch 13/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0903 - acc: 0.9762
Epoch 14/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0830 - acc: 0.9787
Epoch 15/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0756 - acc: 0.9813
Epoch 16/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0729 - acc: 0.9826
Epoch 17/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0643 - acc: 0.9837
Epoch 18/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0611 - acc: 0.9849
Epoch 19/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0540 - acc: 0.9874
Epoch 20/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0546 - acc: 0.9876
Epoch 21/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0503 - acc: 0.9899
Epoch 22/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0437 - acc: 0.9910
Epoch 23/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0427 - acc: 0.9914
Epoch 24/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0397 - acc: 0.9922
Epoch 25/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0394 - acc: 0.9926
Epoch 26/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0350 - acc: 0.9924
Epoch 27/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0353 - acc: 0.9928
Epoch 28/30

334/334 [==============================] - 9s 28ms/step - loss: 0.0339 - acc: 0.9933
Epoch 29/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0298 - acc: 0.9939
Epoch 30/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0292 - acc: 0.9948
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8060
False 1011
True percentage 0.888545915555
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.97      7318
      B-PER       0.86      0.73      0.79       438
      B-LOC       0.69      0.73      0.71       218
     B-MISC       0.45      0.31      0.37       141
     I-MISC       0.41      0.38      0.40       154
      B-ORG       0.70      0.67      0.68       296
      I-ORG       0.47      0.43      0.45       151
      I-LOC       0.71      0.68      0.69       141
      I-PER       0.89      0.63      0.74       214

avg / total       0.93      0.89      0.91      9071

F-1 Score (without O):
0.652160773648
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104210 unique words.
4206 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 272
OOV word occurences: in test 488
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6669504     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,781,634
Trainable params: 6,781,634
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

167/167 [==============================] - 6s 37ms/step - loss: 0.8404 - acc: 0.7439
Epoch 2/30

167/167 [==============================] - 4s 27ms/step - loss: 0.4519 - acc: 0.8605
Epoch 3/30

167/167 [==============================] - 4s 27ms/step - loss: 0.3725 - acc: 0.8871
Epoch 4/30

167/167 [==============================] - 4s 27ms/step - loss: 0.3295 - acc: 0.9043
Epoch 5/30

167/167 [==============================] - 4s 27ms/step - loss: 0.2869 - acc: 0.9185
Epoch 6/30

167/167 [==============================] - 4s 27ms/step - loss: 0.2515 - acc: 0.9302
Epoch 7/30

167/167 [==============================] - 4s 27ms/step - loss: 0.2364 - acc: 0.9312
Epoch 8/30

167/167 [==============================] - 5s 27ms/step - loss: 0.2097 - acc: 0.9423
Epoch 9/30

167/167 [==============================] - 4s 27ms/step - loss: 0.1967 - acc: 0.9451
Epoch 10/30

167/167 [==============================] - 4s 27ms/step - loss: 0.1783 - acc: 0.9488
Epoch 11/30

167/167 [==============================] - 4s 27ms/step - loss: 0.1632 - acc: 0.9592
Epoch 12/30

167/167 [==============================] - 4s 27ms/step - loss: 0.1500 - acc: 0.9648
Epoch 13/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1348 - acc: 0.9675
Epoch 14/30

167/167 [==============================] - 4s 27ms/step - loss: 0.1226 - acc: 0.9735
Epoch 15/30

167/167 [==============================] - 4s 27ms/step - loss: 0.1130 - acc: 0.9754
Epoch 16/30

167/167 [==============================] - 4s 27ms/step - loss: 0.1038 - acc: 0.9772
Epoch 17/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0969 - acc: 0.9785
Epoch 18/30

167/167 [==============================] - 4s 27ms/step - loss: 0.0873 - acc: 0.9858
Epoch 19/30

167/167 [==============================] - 4s 27ms/step - loss: 0.0816 - acc: 0.9845
Epoch 20/30

167/167 [==============================] - 4s 27ms/step - loss: 0.0735 - acc: 0.9864
Epoch 21/30

167/167 [==============================] - 4s 27ms/step - loss: 0.0713 - acc: 0.9884
Epoch 22/30

167/167 [==============================] - 4s 27ms/step - loss: 0.0705 - acc: 0.9875
Epoch 23/30

167/167 [==============================] - 4s 26ms/step - loss: 0.0632 - acc: 0.9888
Epoch 24/30

167/167 [==============================] - 4s 27ms/step - loss: 0.0631 - acc: 0.9883
Epoch 25/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0549 - acc: 0.9915
Epoch 26/30

167/167 [==============================] - 4s 27ms/step - loss: 0.0500 - acc: 0.9933
Epoch 27/30

167/167 [==============================] - 4s 27ms/step - loss: 0.0453 - acc: 0.9954
Epoch 28/30

167/167 [==============================] - 4s 26ms/step - loss: 0.0455 - acc: 0.9929
Epoch 29/30

167/167 [==============================] - 4s 27ms/step - loss: 0.0432 - acc: 0.9957
Epoch 30/30

167/167 [==============================] - 4s 27ms/step - loss: 0.0399 - acc: 0.9945
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7759
False 1312
True percentage 0.855363245508
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.94      0.96      7318
      B-LOC       0.65      0.61      0.63       218
      I-LOC       0.73      0.53      0.61       141
      B-PER       0.84      0.56      0.67       438
      B-ORG       0.52      0.64      0.57       296
      I-ORG       0.30      0.35      0.32       151
     B-MISC       0.31      0.22      0.26       141
     I-MISC       0.40      0.37      0.39       154
      I-PER       0.66      0.45      0.53       214

avg / total       0.90      0.86      0.88      9071

F-1 Score (without O):
0.535855965822
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104209 unique words.
4205 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 266
OOV word occurences: in test 445
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6669440     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,781,570
Trainable params: 6,781,570
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

167/167 [==============================] - 6s 36ms/step - loss: 0.7842 - acc: 0.7699
Epoch 2/30

167/167 [==============================] - 5s 27ms/step - loss: 0.4100 - acc: 0.8710
Epoch 3/30

167/167 [==============================] - 5s 27ms/step - loss: 0.3471 - acc: 0.9019
Epoch 4/30

167/167 [==============================] - 5s 28ms/step - loss: 0.2949 - acc: 0.9186
Epoch 5/30

167/167 [==============================] - 5s 27ms/step - loss: 0.2666 - acc: 0.9270
Epoch 6/30

167/167 [==============================] - 5s 27ms/step - loss: 0.2339 - acc: 0.9368
Epoch 7/30

167/167 [==============================] - 5s 28ms/step - loss: 0.2122 - acc: 0.9437
Epoch 8/30

167/167 [==============================] - 4s 27ms/step - loss: 0.1931 - acc: 0.9462
Epoch 9/30

167/167 [==============================] - 5s 28ms/step - loss: 0.1732 - acc: 0.9569
Epoch 10/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1616 - acc: 0.9583
Epoch 11/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1466 - acc: 0.9623
Epoch 12/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1368 - acc: 0.9690
Epoch 13/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1245 - acc: 0.9656
Epoch 14/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1132 - acc: 0.9744
Epoch 15/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1054 - acc: 0.9747
Epoch 16/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0993 - acc: 0.9778
Epoch 17/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0898 - acc: 0.9826
Epoch 18/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0866 - acc: 0.9807
Epoch 19/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0781 - acc: 0.9842
Epoch 20/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0724 - acc: 0.9848
Epoch 21/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0660 - acc: 0.9884
Epoch 22/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0669 - acc: 0.9875
Epoch 23/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0594 - acc: 0.9887
Epoch 24/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0531 - acc: 0.9923
Epoch 25/30

167/167 [==============================] - 4s 27ms/step - loss: 0.0504 - acc: 0.9922
Epoch 26/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0469 - acc: 0.9929
Epoch 27/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0455 - acc: 0.9918
Epoch 28/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0425 - acc: 0.9931
Epoch 29/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0378 - acc: 0.9966
Epoch 30/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0379 - acc: 0.9930
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7867
False 1204
True percentage 0.86726931981
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.77      0.65      0.70       438
      I-PER       0.72      0.57      0.64       214
          O       0.98      0.96      0.97      7318
      B-ORG       0.56      0.48      0.52       296
      I-ORG       0.30      0.36      0.33       151
      B-LOC       0.66      0.70      0.68       218
      I-LOC       0.73      0.51      0.60       141
     B-MISC       0.23      0.11      0.14       141
     I-MISC       0.38      0.23      0.28       154

avg / total       0.90      0.87      0.88      9071

F-1 Score (without O):
0.897874607779
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104194 unique words.
4190 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 269
OOV word occurences: in test 437
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6668480     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,780,610
Trainable params: 6,780,610
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

167/167 [==============================] - 6s 37ms/step - loss: 0.9334 - acc: 0.7411
Epoch 2/30

167/167 [==============================] - 5s 27ms/step - loss: 0.4262 - acc: 0.8715
Epoch 3/30

167/167 [==============================] - 5s 28ms/step - loss: 0.3606 - acc: 0.8942
Epoch 4/30

167/167 [==============================] - 5s 27ms/step - loss: 0.3274 - acc: 0.9049
Epoch 5/30

167/167 [==============================] - 5s 27ms/step - loss: 0.2821 - acc: 0.9190
Epoch 6/30

167/167 [==============================] - 5s 27ms/step - loss: 0.2554 - acc: 0.9286
Epoch 7/30

167/167 [==============================] - 5s 27ms/step - loss: 0.2315 - acc: 0.9380
Epoch 8/30

167/167 [==============================] - 5s 27ms/step - loss: 0.2075 - acc: 0.9448
Epoch 9/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1905 - acc: 0.9486
Epoch 10/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1726 - acc: 0.9516
Epoch 11/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1579 - acc: 0.9605
Epoch 12/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1508 - acc: 0.9641
Epoch 13/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1323 - acc: 0.9675
Epoch 14/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1248 - acc: 0.9683
Epoch 15/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1127 - acc: 0.9737
Epoch 16/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1082 - acc: 0.9757
Epoch 17/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1012 - acc: 0.9769
Epoch 18/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0935 - acc: 0.9780
Epoch 19/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0850 - acc: 0.9840
Epoch 20/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0841 - acc: 0.9786
Epoch 21/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0753 - acc: 0.9849
Epoch 22/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0716 - acc: 0.9844
Epoch 23/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0641 - acc: 0.9861
Epoch 24/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0662 - acc: 0.9875
Epoch 25/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0588 - acc: 0.9887
Epoch 26/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0544 - acc: 0.9885
Epoch 27/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0515 - acc: 0.9903
Epoch 28/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0494 - acc: 0.9913
Epoch 29/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0469 - acc: 0.9912
Epoch 30/30

167/167 [==============================] - 4s 27ms/step - loss: 0.0435 - acc: 0.9929
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7760
False 1311
True percentage 0.855473486936
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.94      0.96      7318
      B-PER       0.79      0.60      0.68       438
      B-LOC       0.67      0.58      0.62       218
     B-MISC       0.19      0.16      0.17       141
     I-MISC       0.30      0.46      0.36       154
      B-ORG       0.54      0.68      0.60       296
      I-ORG       0.33      0.34      0.34       151
      I-LOC       0.74      0.48      0.58       141
      I-PER       0.80      0.38      0.52       214

avg / total       0.90      0.86      0.88      9071

F-1 Score (without O):
0.527099463967
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104116 unique words.
4112 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 278
OOV word occurences: in test 539
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663488     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,618
Trainable params: 6,775,618
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

83/83 [==============================] - 4s 46ms/step - loss: 1.1957 - acc: 0.6731
Epoch 2/30

83/83 [==============================] - 2s 27ms/step - loss: 0.5677 - acc: 0.8229
Epoch 3/30

83/83 [==============================] - 2s 28ms/step - loss: 0.4707 - acc: 0.8465
Epoch 4/30

83/83 [==============================] - 2s 28ms/step - loss: 0.4170 - acc: 0.8670
Epoch 5/30

83/83 [==============================] - 2s 27ms/step - loss: 0.3805 - acc: 0.8776
Epoch 6/30

83/83 [==============================] - 2s 27ms/step - loss: 0.3451 - acc: 0.8985
Epoch 7/30

83/83 [==============================] - 2s 27ms/step - loss: 0.3094 - acc: 0.9127
Epoch 8/30

83/83 [==============================] - 2s 27ms/step - loss: 0.2871 - acc: 0.9187
Epoch 9/30

83/83 [==============================] - 2s 28ms/step - loss: 0.2629 - acc: 0.9266
Epoch 10/30

83/83 [==============================] - 2s 28ms/step - loss: 0.2569 - acc: 0.9280
Epoch 11/30

83/83 [==============================] - 2s 27ms/step - loss: 0.2212 - acc: 0.9424
Epoch 12/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1986 - acc: 0.9565
Epoch 13/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1905 - acc: 0.9512
Epoch 14/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1742 - acc: 0.9590
Epoch 15/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1578 - acc: 0.9678
Epoch 16/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1526 - acc: 0.9712
Epoch 17/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1459 - acc: 0.9706
Epoch 18/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1313 - acc: 0.9753
Epoch 19/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1200 - acc: 0.9802
Epoch 20/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1127 - acc: 0.9833
Epoch 21/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1046 - acc: 0.9842
Epoch 22/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0954 - acc: 0.9826
Epoch 23/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0932 - acc: 0.9851
Epoch 24/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0846 - acc: 0.9861
Epoch 25/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0813 - acc: 0.9889
Epoch 26/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0724 - acc: 0.9875
Epoch 27/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0757 - acc: 0.9896
Epoch 28/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0655 - acc: 0.9919
Epoch 29/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0663 - acc: 0.9882
Epoch 30/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0630 - acc: 0.9915
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7513
False 1558
True percentage 0.82824385404
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.94      0.95      7318
      B-LOC       0.66      0.49      0.56       218
      I-LOC       0.56      0.25      0.34       141
      B-PER       0.86      0.30      0.44       438
      B-ORG       0.42      0.60      0.49       296
      I-ORG       0.23      0.40      0.30       151
     B-MISC       0.20      0.11      0.14       141
     I-MISC       0.29      0.23      0.26       154
      I-PER       0.83      0.31      0.45       214

avg / total       0.88      0.83      0.84      9071

F-1 Score (without O):
0.406088082902
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104129 unique words.
4125 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 271
OOV word occurences: in test 452
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6664320     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,776,450
Trainable params: 6,776,450
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

83/83 [==============================] - 4s 47ms/step - loss: 1.0258 - acc: 0.6948
Epoch 2/30

83/83 [==============================] - 2s 28ms/step - loss: 0.5300 - acc: 0.8274
Epoch 3/30

83/83 [==============================] - 2s 28ms/step - loss: 0.4380 - acc: 0.8576
Epoch 4/30

83/83 [==============================] - 2s 28ms/step - loss: 0.3870 - acc: 0.8850
Epoch 5/30

83/83 [==============================] - 2s 28ms/step - loss: 0.3567 - acc: 0.8941
Epoch 6/30

83/83 [==============================] - 2s 28ms/step - loss: 0.3286 - acc: 0.9078
Epoch 7/30

83/83 [==============================] - 2s 29ms/step - loss: 0.2972 - acc: 0.9188
Epoch 8/30

83/83 [==============================] - 2s 27ms/step - loss: 0.2796 - acc: 0.9130
Epoch 9/30

83/83 [==============================] - 2s 28ms/step - loss: 0.2526 - acc: 0.9242
Epoch 10/30

83/83 [==============================] - 2s 28ms/step - loss: 0.2251 - acc: 0.9423
Epoch 11/30

83/83 [==============================] - 2s 27ms/step - loss: 0.2218 - acc: 0.9373
Epoch 12/30

83/83 [==============================] - 2s 27ms/step - loss: 0.2073 - acc: 0.9436
Epoch 13/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1927 - acc: 0.9508
Epoch 14/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1789 - acc: 0.9501
Epoch 15/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1660 - acc: 0.9637
Epoch 16/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1513 - acc: 0.9669
Epoch 17/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1427 - acc: 0.9707
Epoch 18/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1328 - acc: 0.9709
Epoch 19/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1275 - acc: 0.9776
Epoch 20/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1208 - acc: 0.9724
Epoch 21/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1129 - acc: 0.9772
Epoch 22/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1049 - acc: 0.9799
Epoch 23/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1014 - acc: 0.9780
Epoch 24/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0963 - acc: 0.9796
Epoch 25/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0917 - acc: 0.9801
Epoch 26/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0883 - acc: 0.9843
Epoch 27/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0881 - acc: 0.9831
Epoch 28/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0900 - acc: 0.9802
Epoch 29/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0766 - acc: 0.9856
Epoch 30/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0723 - acc: 0.9868
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7651
False 1420
True percentage 0.843457171205
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.69      0.58      0.63       438
      I-PER       0.68      0.45      0.54       214
          O       0.97      0.95      0.96      7318
      B-ORG       0.42      0.46      0.44       296
      I-ORG       0.18      0.30      0.22       151
      B-LOC       0.69      0.47      0.56       218
      I-LOC       1.00      0.09      0.17       141
     B-MISC       0.28      0.16      0.21       141
     I-MISC       0.32      0.23      0.27       154

avg / total       0.89      0.84      0.86      9071

F-1 Score (without O):
0.876176940842
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104112 unique words.
4108 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 277
OOV word occurences: in test 484
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663232     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,362
Trainable params: 6,775,362
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

83/83 [==============================] - 4s 48ms/step - loss: 1.4322 - acc: 0.6403
Epoch 2/30

83/83 [==============================] - 2s 29ms/step - loss: 0.6350 - acc: 0.8156
Epoch 3/30

83/83 [==============================] - 2s 28ms/step - loss: 0.4847 - acc: 0.8359
Epoch 4/30

83/83 [==============================] - 2s 28ms/step - loss: 0.4243 - acc: 0.8682
Epoch 5/30

83/83 [==============================] - 2s 29ms/step - loss: 0.3702 - acc: 0.8799
Epoch 6/30

83/83 [==============================] - 2s 29ms/step - loss: 0.3374 - acc: 0.8917
Epoch 7/30

83/83 [==============================] - 2s 29ms/step - loss: 0.3158 - acc: 0.9023
Epoch 8/30

83/83 [==============================] - 2s 28ms/step - loss: 0.2897 - acc: 0.9165
Epoch 9/30

83/83 [==============================] - 2s 28ms/step - loss: 0.2742 - acc: 0.9216
Epoch 10/30

83/83 [==============================] - 2s 28ms/step - loss: 0.2502 - acc: 0.9301
Epoch 11/30

83/83 [==============================] - 2s 28ms/step - loss: 0.2321 - acc: 0.9381
Epoch 12/30

83/83 [==============================] - 2s 28ms/step - loss: 0.2267 - acc: 0.9321
Epoch 13/30

83/83 [==============================] - 2s 29ms/step - loss: 0.2090 - acc: 0.9464
Epoch 14/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1910 - acc: 0.9568
Epoch 15/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1789 - acc: 0.9599
Epoch 16/30

83/83 [==============================] - 2s 29ms/step - loss: 0.1698 - acc: 0.9574
Epoch 17/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1647 - acc: 0.9642
Epoch 18/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1574 - acc: 0.9612
Epoch 19/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1482 - acc: 0.9630
Epoch 20/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1299 - acc: 0.9746
Epoch 21/30

83/83 [==============================] - 2s 29ms/step - loss: 0.1335 - acc: 0.9705
Epoch 22/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1235 - acc: 0.9764
Epoch 23/30

83/83 [==============================] - 2s 29ms/step - loss: 0.1079 - acc: 0.9801
Epoch 24/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1101 - acc: 0.9768
Epoch 25/30

83/83 [==============================] - 2s 29ms/step - loss: 0.1001 - acc: 0.9826
Epoch 26/30

83/83 [==============================] - 2s 29ms/step - loss: 0.0949 - acc: 0.9823
Epoch 27/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0897 - acc: 0.9815
Epoch 28/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0886 - acc: 0.9870
Epoch 29/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0789 - acc: 0.9885
Epoch 30/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0785 - acc: 0.9858
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7667
False 1404
True percentage 0.845221034065
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.95      0.95      7318
      B-PER       0.73      0.51      0.60       438
      B-LOC       0.64      0.59      0.61       218
     B-MISC       0.41      0.10      0.16       141
     I-MISC       0.41      0.23      0.29       154
      B-ORG       0.47      0.47      0.47       296
      I-ORG       0.21      0.26      0.23       151
      I-LOC       0.69      0.34      0.45       141
      I-PER       0.71      0.41      0.52       214

avg / total       0.88      0.85      0.86      9071

F-1 Score (without O):
0.468279921517
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104117 unique words.
4113 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 275
OOV word occurences: in test 481
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663552     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,775,682
Trainable params: 6,775,682
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

83/83 [==============================] - 4s 48ms/step - loss: 1.3413 - acc: 0.6410
Epoch 2/30

83/83 [==============================] - 2s 28ms/step - loss: 0.5748 - acc: 0.8247
Epoch 3/30

83/83 [==============================] - 2s 28ms/step - loss: 0.5132 - acc: 0.8409
Epoch 4/30

83/83 [==============================] - 2s 28ms/step - loss: 0.4401 - acc: 0.8605
Epoch 5/30

83/83 [==============================] - 2s 28ms/step - loss: 0.4043 - acc: 0.8741
Epoch 6/30

83/83 [==============================] - 2s 28ms/step - loss: 0.3492 - acc: 0.8998
Epoch 7/30

83/83 [==============================] - 2s 28ms/step - loss: 0.3238 - acc: 0.9152
Epoch 8/30

83/83 [==============================] - 2s 28ms/step - loss: 0.3047 - acc: 0.9173
Epoch 9/30

83/83 [==============================] - 2s 28ms/step - loss: 0.2956 - acc: 0.9181
Epoch 10/30

83/83 [==============================] - 2s 29ms/step - loss: 0.2681 - acc: 0.9249
Epoch 11/30

83/83 [==============================] - 2s 28ms/step - loss: 0.2348 - acc: 0.9392
Epoch 12/30

83/83 [==============================] - 2s 28ms/step - loss: 0.2272 - acc: 0.9389
Epoch 13/30

83/83 [==============================] - 2s 28ms/step - loss: 0.2071 - acc: 0.9532
Epoch 14/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1889 - acc: 0.9589
Epoch 15/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1691 - acc: 0.9569
Epoch 16/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1642 - acc: 0.9622
Epoch 17/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1538 - acc: 0.9658
Epoch 18/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1462 - acc: 0.9637
Epoch 19/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1378 - acc: 0.9667
Epoch 20/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1328 - acc: 0.9760
Epoch 21/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1192 - acc: 0.9735
Epoch 22/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1084 - acc: 0.9808
Epoch 23/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1162 - acc: 0.9727
Epoch 24/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0957 - acc: 0.9798
Epoch 25/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0948 - acc: 0.9847
Epoch 26/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0881 - acc: 0.9896
Epoch 27/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0850 - acc: 0.9858
Epoch 28/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0790 - acc: 0.9881
Epoch 29/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0723 - acc: 0.9907
Epoch 30/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0734 - acc: 0.9863
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7718
False 1353
True percentage 0.85084334693
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.95      0.96      7318
      B-ORG       0.43      0.45      0.44       296
      I-ORG       0.26      0.42      0.32       151
      B-PER       0.80      0.58      0.67       438
      I-PER       0.73      0.53      0.62       214
      B-LOC       0.69      0.50      0.58       218
      I-LOC       0.72      0.27      0.39       141
     B-MISC       0.26      0.10      0.14       141
     I-MISC       0.50      0.23      0.32       154

avg / total       0.89      0.85      0.87      9071

F-1 Score (without O):
0.489130434783
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104064 unique words.
4060 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 558
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660160     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,290
Trainable params: 6,772,290
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

33/33 [==============================] - 3s 79ms/step - loss: 1.9212 - acc: 0.4090
Epoch 2/30

33/33 [==============================] - 1s 29ms/step - loss: 0.8093 - acc: 0.7906
Epoch 3/30

33/33 [==============================] - 1s 30ms/step - loss: 0.6287 - acc: 0.8057
Epoch 4/30

33/33 [==============================] - 1s 30ms/step - loss: 0.5833 - acc: 0.8175
Epoch 5/30

33/33 [==============================] - 1s 30ms/step - loss: 0.5368 - acc: 0.8393
Epoch 6/30

33/33 [==============================] - 1s 30ms/step - loss: 0.4679 - acc: 0.8497
Epoch 7/30

33/33 [==============================] - 1s 29ms/step - loss: 0.4325 - acc: 0.8520
Epoch 8/30

33/33 [==============================] - 1s 29ms/step - loss: 0.3805 - acc: 0.9043
Epoch 9/30

33/33 [==============================] - 1s 30ms/step - loss: 0.3611 - acc: 0.8998
Epoch 10/30

33/33 [==============================] - 1s 30ms/step - loss: 0.3682 - acc: 0.9181
Epoch 11/30

33/33 [==============================] - 1s 31ms/step - loss: 0.3230 - acc: 0.9270
Epoch 12/30

33/33 [==============================] - 1s 31ms/step - loss: 0.2989 - acc: 0.9294
Epoch 13/30

33/33 [==============================] - 1s 31ms/step - loss: 0.2791 - acc: 0.9293
Epoch 14/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2589 - acc: 0.9331
Epoch 15/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2556 - acc: 0.9455
Epoch 16/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2332 - acc: 0.9340
Epoch 17/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2395 - acc: 0.9460
Epoch 18/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2253 - acc: 0.9539
Epoch 19/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2040 - acc: 0.9543
Epoch 20/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1857 - acc: 0.9633
Epoch 21/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1930 - acc: 0.9537
Epoch 22/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1767 - acc: 0.9745
Epoch 23/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1631 - acc: 0.9708
Epoch 24/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1532 - acc: 0.9879
Epoch 25/30

33/33 [==============================] - 1s 31ms/step - loss: 0.1470 - acc: 0.9878
Epoch 26/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1541 - acc: 0.9785
Epoch 27/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1424 - acc: 0.9742
Epoch 28/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1335 - acc: 0.9736
Epoch 29/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1294 - acc: 0.9832
Epoch 30/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1254 - acc: 0.9818
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7468
False 1603
True percentage 0.823282989748
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.94      0.95      7318
      B-LOC       0.52      0.46      0.49       218
      I-LOC       0.30      0.18      0.23       141
      B-PER       0.64      0.48      0.55       438
      B-ORG       0.36      0.40      0.38       296
      I-ORG       0.20      0.27      0.23       151
     B-MISC       0.23      0.14      0.18       141
     I-MISC       0.45      0.18      0.25       154
      I-PER       0.66      0.16      0.26       214

avg / total       0.87      0.82      0.84      9071

F-1 Score (without O):
0.37366892546
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104073 unique words.
4069 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 277
OOV word occurences: in test 468
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660736     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,866
Trainable params: 6,772,866
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

33/33 [==============================] - 3s 79ms/step - loss: 1.6987 - acc: 0.4263
Epoch 2/30

33/33 [==============================] - 1s 29ms/step - loss: 0.7687 - acc: 0.7837
Epoch 3/30

33/33 [==============================] - 1s 30ms/step - loss: 0.5705 - acc: 0.8196
Epoch 4/30

33/33 [==============================] - 1s 30ms/step - loss: 0.5193 - acc: 0.8461
Epoch 5/30

33/33 [==============================] - 1s 29ms/step - loss: 0.5439 - acc: 0.8197
Epoch 6/30

33/33 [==============================] - 1s 29ms/step - loss: 0.4451 - acc: 0.8568
Epoch 7/30

33/33 [==============================] - 1s 30ms/step - loss: 0.4197 - acc: 0.8725
Epoch 8/30

33/33 [==============================] - 1s 29ms/step - loss: 0.3925 - acc: 0.8770
Epoch 9/30

33/33 [==============================] - 1s 30ms/step - loss: 0.3402 - acc: 0.8969
Epoch 10/30

33/33 [==============================] - 1s 30ms/step - loss: 0.3350 - acc: 0.9207
Epoch 11/30

33/33 [==============================] - 1s 30ms/step - loss: 0.3211 - acc: 0.9169
Epoch 12/30

33/33 [==============================] - 1s 30ms/step - loss: 0.3104 - acc: 0.9211
Epoch 13/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2809 - acc: 0.9366
Epoch 14/30

33/33 [==============================] - 1s 31ms/step - loss: 0.2760 - acc: 0.9314
Epoch 15/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2615 - acc: 0.9480
Epoch 16/30

33/33 [==============================] - 1s 29ms/step - loss: 0.2697 - acc: 0.9398
Epoch 17/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2348 - acc: 0.9543
Epoch 18/30

33/33 [==============================] - 1s 31ms/step - loss: 0.2253 - acc: 0.9479
Epoch 19/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2100 - acc: 0.9618
Epoch 20/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2024 - acc: 0.9502
Epoch 21/30

33/33 [==============================] - 1s 29ms/step - loss: 0.2002 - acc: 0.9638
Epoch 22/30

33/33 [==============================] - 1s 29ms/step - loss: 0.1943 - acc: 0.9602
Epoch 23/30

33/33 [==============================] - 1s 29ms/step - loss: 0.1783 - acc: 0.9718
Epoch 24/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1646 - acc: 0.9746
Epoch 25/30

33/33 [==============================] - 1s 29ms/step - loss: 0.1604 - acc: 0.9710
Epoch 26/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1586 - acc: 0.9708
Epoch 27/30

33/33 [==============================] - 1s 29ms/step - loss: 0.1532 - acc: 0.9762
Epoch 28/30

33/33 [==============================] - 1s 31ms/step - loss: 0.1489 - acc: 0.9720
Epoch 29/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1320 - acc: 0.9639
Epoch 30/30

33/33 [==============================] - 1s 29ms/step - loss: 0.1440 - acc: 0.9775
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7487
False 1584
True percentage 0.825377576893
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.62      0.50      0.55       438
      I-PER       0.52      0.33      0.41       214
          O       0.95      0.94      0.95      7318
      B-ORG       0.42      0.39      0.40       296
      I-ORG       0.16      0.31      0.21       151
      B-LOC       0.58      0.40      0.48       218
      I-LOC       0.76      0.11      0.20       141
     B-MISC       0.15      0.01      0.03       141
     I-MISC       0.20      0.15      0.17       154

avg / total       0.86      0.83      0.84      9071

F-1 Score (without O):
0.861000888362
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104062 unique words.
4058 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 280
OOV word occurences: in test 496
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660032     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,162
Trainable params: 6,772,162
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

33/33 [==============================] - 3s 79ms/step - loss: 1.8191 - acc: 0.4397
Epoch 2/30

33/33 [==============================] - 1s 29ms/step - loss: 0.7271 - acc: 0.8041
Epoch 3/30

33/33 [==============================] - 1s 30ms/step - loss: 0.5410 - acc: 0.8325
Epoch 4/30

33/33 [==============================] - 1s 30ms/step - loss: 0.4848 - acc: 0.8425
Epoch 5/30

33/33 [==============================] - 1s 29ms/step - loss: 0.4404 - acc: 0.8615
Epoch 6/30

33/33 [==============================] - 1s 30ms/step - loss: 0.4212 - acc: 0.8602
Epoch 7/30

33/33 [==============================] - 1s 30ms/step - loss: 0.4128 - acc: 0.8734
Epoch 8/30

33/33 [==============================] - 1s 29ms/step - loss: 0.3485 - acc: 0.8930
Epoch 9/30

33/33 [==============================] - 1s 30ms/step - loss: 0.3363 - acc: 0.9164
Epoch 10/30

33/33 [==============================] - 1s 30ms/step - loss: 0.3167 - acc: 0.9088
Epoch 11/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2804 - acc: 0.9285
Epoch 12/30

33/33 [==============================] - 1s 29ms/step - loss: 0.2974 - acc: 0.9091
Epoch 13/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2855 - acc: 0.9182
Epoch 14/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2439 - acc: 0.9388
Epoch 15/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2493 - acc: 0.9404
Epoch 16/30

33/33 [==============================] - 1s 29ms/step - loss: 0.2042 - acc: 0.9555
Epoch 17/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2515 - acc: 0.9247
Epoch 18/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1881 - acc: 0.9612
Epoch 19/30

33/33 [==============================] - 1s 29ms/step - loss: 0.1809 - acc: 0.9597
Epoch 20/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1797 - acc: 0.9507
Epoch 21/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1801 - acc: 0.9449
Epoch 22/30

33/33 [==============================] - 1s 29ms/step - loss: 0.1638 - acc: 0.9616
Epoch 23/30

33/33 [==============================] - 1s 29ms/step - loss: 0.1530 - acc: 0.9753
Epoch 24/30

33/33 [==============================] - 1s 29ms/step - loss: 0.1539 - acc: 0.9685
Epoch 25/30

33/33 [==============================] - 1s 29ms/step - loss: 0.1477 - acc: 0.9673
Epoch 26/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1351 - acc: 0.9732
Epoch 27/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1468 - acc: 0.9616
Epoch 28/30

33/33 [==============================] - 1s 29ms/step - loss: 0.1208 - acc: 0.9783
Epoch 29/30

33/33 [==============================] - 1s 29ms/step - loss: 0.1240 - acc: 0.9755
Epoch 30/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1117 - acc: 0.9780
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7407
False 1664
True percentage 0.816558262595
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.94      0.94      7318
      B-PER       0.61      0.48      0.53       438
      B-LOC       0.51      0.42      0.46       218
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-ORG       0.36      0.44      0.40       296
      I-ORG       0.15      0.26      0.19       151
      I-LOC       0.34      0.13      0.19       141
      I-PER       0.50      0.14      0.22       214

avg / total       0.83      0.82      0.82      9071

F-1 Score (without O):
0.34234828496
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104072 unique words.
4068 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 279
OOV word occurences: in test 552
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660672     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,802
Trainable params: 6,772,802
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

33/33 [==============================] - 3s 78ms/step - loss: 1.4869 - acc: 0.5043
Epoch 2/30

33/33 [==============================] - 1s 30ms/step - loss: 0.7814 - acc: 0.7820
Epoch 3/30

33/33 [==============================] - 1s 29ms/step - loss: 0.5725 - acc: 0.8297
Epoch 4/30

33/33 [==============================] - 1s 31ms/step - loss: 0.5074 - acc: 0.8360
Epoch 5/30

33/33 [==============================] - 1s 29ms/step - loss: 0.4504 - acc: 0.8702
Epoch 6/30

33/33 [==============================] - 1s 30ms/step - loss: 0.4169 - acc: 0.8741
Epoch 7/30

33/33 [==============================] - 1s 30ms/step - loss: 0.4221 - acc: 0.8613
Epoch 8/30

33/33 [==============================] - 1s 29ms/step - loss: 0.3780 - acc: 0.8825
Epoch 9/30

33/33 [==============================] - 1s 30ms/step - loss: 0.3359 - acc: 0.9040
Epoch 10/30

33/33 [==============================] - 1s 30ms/step - loss: 0.3086 - acc: 0.9194
Epoch 11/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2969 - acc: 0.9154
Epoch 12/30

33/33 [==============================] - 1s 29ms/step - loss: 0.2949 - acc: 0.9160
Epoch 13/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2720 - acc: 0.9373
Epoch 14/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2509 - acc: 0.9513
Epoch 15/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2464 - acc: 0.9481
Epoch 16/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2355 - acc: 0.9461
Epoch 17/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2251 - acc: 0.9543
Epoch 18/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2112 - acc: 0.9575
Epoch 19/30

33/33 [==============================] - 1s 29ms/step - loss: 0.1961 - acc: 0.9553
Epoch 20/30

33/33 [==============================] - 1s 29ms/step - loss: 0.1886 - acc: 0.9588
Epoch 21/30

33/33 [==============================] - 1s 29ms/step - loss: 0.1845 - acc: 0.9675
Epoch 22/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1859 - acc: 0.9592
Epoch 23/30

33/33 [==============================] - 1s 29ms/step - loss: 0.1732 - acc: 0.9583
Epoch 24/30

33/33 [==============================] - 1s 29ms/step - loss: 0.1581 - acc: 0.9701
Epoch 25/30

33/33 [==============================] - 1s 29ms/step - loss: 0.1555 - acc: 0.9743
Epoch 26/30

33/33 [==============================] - 1s 29ms/step - loss: 0.1442 - acc: 0.9710
Epoch 27/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1328 - acc: 0.9811
Epoch 28/30

33/33 [==============================] - 1s 29ms/step - loss: 0.1306 - acc: 0.9817
Epoch 29/30

33/33 [==============================] - 1s 29ms/step - loss: 0.1370 - acc: 0.9826
Epoch 30/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1154 - acc: 0.9858
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7414
False 1657
True percentage 0.817329952596
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.93      0.95      7318
      B-ORG       0.43      0.40      0.41       296
      I-ORG       0.19      0.28      0.23       151
      B-PER       0.57      0.47      0.52       438
      I-PER       0.44      0.49      0.46       214
      B-LOC       0.65      0.37      0.47       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.36      0.15      0.21       141
     I-MISC       0.28      0.36      0.32       154

avg / total       0.86      0.82      0.84      9071

F-1 Score (without O):
0.387755102041
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 8 unique labels.
Found 104048 unique words.
4044 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 567
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659136     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,116
Trainable params: 6,771,116
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

16/16 [==============================] - 2s 130ms/step - loss: 2.4873 - acc: 0.0472
Epoch 2/30

16/16 [==============================] - 0s 26ms/step - loss: 0.7424 - acc: 0.8466
Epoch 3/30

16/16 [==============================] - 0s 26ms/step - loss: 0.5622 - acc: 0.8466
Epoch 4/30

16/16 [==============================] - 0s 27ms/step - loss: 0.6110 - acc: 0.8732
Epoch 5/30

16/16 [==============================] - 0s 26ms/step - loss: 0.5984 - acc: 0.8466
Epoch 6/30

16/16 [==============================] - 0s 25ms/step - loss: 0.4104 - acc: 0.8702
Epoch 7/30

16/16 [==============================] - 0s 26ms/step - loss: 0.3704 - acc: 0.8702
Epoch 8/30

16/16 [==============================] - 0s 26ms/step - loss: 0.3503 - acc: 0.8850
Epoch 9/30

16/16 [==============================] - 0s 26ms/step - loss: 0.3162 - acc: 0.9027
Epoch 10/30

16/16 [==============================] - 0s 26ms/step - loss: 0.3030 - acc: 0.8968
Epoch 11/30

16/16 [==============================] - 0s 26ms/step - loss: 0.2733 - acc: 0.9263
Epoch 12/30

16/16 [==============================] - 0s 26ms/step - loss: 0.2687 - acc: 0.9115
Epoch 13/30

16/16 [==============================] - 0s 25ms/step - loss: 0.2386 - acc: 0.9440
Epoch 14/30

16/16 [==============================] - 0s 26ms/step - loss: 0.2324 - acc: 0.9410
Epoch 15/30

16/16 [==============================] - 0s 26ms/step - loss: 0.2152 - acc: 0.9558
Epoch 16/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1946 - acc: 0.9705
Epoch 17/30

16/16 [==============================] - 0s 26ms/step - loss: 0.1915 - acc: 0.9587
Epoch 18/30

16/16 [==============================] - 0s 26ms/step - loss: 0.1756 - acc: 0.9764
Epoch 19/30

16/16 [==============================] - 0s 26ms/step - loss: 0.1690 - acc: 0.9676
Epoch 20/30

16/16 [==============================] - 0s 26ms/step - loss: 0.1562 - acc: 0.9794
Epoch 21/30

16/16 [==============================] - 0s 25ms/step - loss: 0.1651 - acc: 0.9528
Epoch 22/30

16/16 [==============================] - 0s 25ms/step - loss: 0.1477 - acc: 0.9823
Epoch 23/30

16/16 [==============================] - 0s 26ms/step - loss: 0.1370 - acc: 0.9794
Epoch 24/30

16/16 [==============================] - 0s 26ms/step - loss: 0.1242 - acc: 0.9882
Epoch 25/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1253 - acc: 0.9764
Epoch 26/30

16/16 [==============================] - 0s 26ms/step - loss: 0.1269 - acc: 0.9882
Epoch 27/30

16/16 [==============================] - 0s 26ms/step - loss: 0.1133 - acc: 0.9853
Epoch 28/30

16/16 [==============================] - 0s 25ms/step - loss: 0.1132 - acc: 0.9823
Epoch 29/30

16/16 [==============================] - 0s 26ms/step - loss: 0.1055 - acc: 0.9882
Epoch 30/30

16/16 [==============================] - 0s 26ms/step - loss: 0.0931 - acc: 0.9971
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7204
False 1653
True percentage 0.813367957548
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.94      0.93      7318
      B-LOC       0.22      0.08      0.11       218
      I-LOC       0.38      0.15      0.21       141
      B-PER       0.52      0.23      0.32       438
      B-ORG       0.25      0.42      0.31       296
      I-ORG       0.17      0.15      0.16       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.16      0.10      0.12       154

avg / total       0.82      0.81      0.81      8857

F-1 Score (without O):
0.231749710313
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104055 unique words.
4051 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 567
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659584     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,714
Trainable params: 6,771,714
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

16/16 [==============================] - 2s 137ms/step - loss: 2.3552 - acc: 0.1164
Epoch 2/30

16/16 [==============================] - 0s 27ms/step - loss: 0.9528 - acc: 0.7673
Epoch 3/30

16/16 [==============================] - 0s 27ms/step - loss: 0.7631 - acc: 0.7799
Epoch 4/30

16/16 [==============================] - 0s 27ms/step - loss: 0.6605 - acc: 0.8208
Epoch 5/30

16/16 [==============================] - 0s 28ms/step - loss: 0.7971 - acc: 0.7642
Epoch 6/30

16/16 [==============================] - 0s 27ms/step - loss: 0.6881 - acc: 0.8585
Epoch 7/30

16/16 [==============================] - 0s 26ms/step - loss: 0.5056 - acc: 0.8302
Epoch 8/30

16/16 [==============================] - 0s 27ms/step - loss: 0.4603 - acc: 0.8774
Epoch 9/30

16/16 [==============================] - 0s 28ms/step - loss: 0.4160 - acc: 0.9151
Epoch 10/30

16/16 [==============================] - 0s 26ms/step - loss: 0.3882 - acc: 0.9025
Epoch 11/30

16/16 [==============================] - 0s 26ms/step - loss: 0.3649 - acc: 0.9182
Epoch 12/30

16/16 [==============================] - 0s 27ms/step - loss: 0.3352 - acc: 0.9277
Epoch 13/30

16/16 [==============================] - 0s 28ms/step - loss: 0.3120 - acc: 0.9371
Epoch 14/30

16/16 [==============================] - 0s 27ms/step - loss: 0.2940 - acc: 0.9403
Epoch 15/30

16/16 [==============================] - 0s 26ms/step - loss: 0.2750 - acc: 0.9403
Epoch 16/30

16/16 [==============================] - 0s 26ms/step - loss: 0.2507 - acc: 0.9403
Epoch 17/30

16/16 [==============================] - 0s 25ms/step - loss: 0.2478 - acc: 0.9623
Epoch 18/30

16/16 [==============================] - 0s 27ms/step - loss: 0.2359 - acc: 0.9654
Epoch 19/30

16/16 [==============================] - 0s 26ms/step - loss: 0.2086 - acc: 0.9623
Epoch 20/30

16/16 [==============================] - 0s 26ms/step - loss: 0.1927 - acc: 0.9748
Epoch 21/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1941 - acc: 0.9717
Epoch 22/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1750 - acc: 0.9748
Epoch 23/30

16/16 [==============================] - 0s 25ms/step - loss: 0.1825 - acc: 0.9717
Epoch 24/30

16/16 [==============================] - 0s 28ms/step - loss: 0.1760 - acc: 0.9717
Epoch 25/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1556 - acc: 0.9780
Epoch 26/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1377 - acc: 0.9843
Epoch 27/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1296 - acc: 0.9811
Epoch 28/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1461 - acc: 0.9843
Epoch 29/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1357 - acc: 0.9780
Epoch 30/30

16/16 [==============================] - 0s 25ms/step - loss: 0.1308 - acc: 0.9843
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7238
False 1833
True percentage 0.79792746114
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.54      0.36      0.43       438
      I-PER       0.47      0.27      0.34       214
          O       0.95      0.93      0.94      7318
      B-ORG       0.27      0.35      0.30       296
      I-ORG       0.16      0.30      0.21       151
      B-LOC       0.36      0.34      0.35       218
      I-LOC       0.39      0.13      0.19       141
     B-MISC       0.06      0.01      0.02       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.83      0.80      0.81      9071

F-1 Score (without O):
0.840555621513
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104048 unique words.
4044 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 565
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659136     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,266
Trainable params: 6,771,266
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

16/16 [==============================] - 2s 128ms/step - loss: 2.5861 - acc: 0.1300
Epoch 2/30

16/16 [==============================] - 0s 27ms/step - loss: 1.1656 - acc: 0.7678
Epoch 3/30

16/16 [==============================] - 0s 28ms/step - loss: 0.7502 - acc: 0.7802
Epoch 4/30

16/16 [==============================] - 0s 28ms/step - loss: 0.6333 - acc: 0.8080
Epoch 5/30

16/16 [==============================] - 0s 27ms/step - loss: 0.6001 - acc: 0.7926
Epoch 6/30

16/16 [==============================] - 0s 27ms/step - loss: 0.6895 - acc: 0.8204
Epoch 7/30

16/16 [==============================] - 0s 26ms/step - loss: 0.5581 - acc: 0.7957
Epoch 8/30

16/16 [==============================] - 0s 27ms/step - loss: 0.4914 - acc: 0.8669
Epoch 9/30

16/16 [==============================] - 0s 26ms/step - loss: 0.4257 - acc: 0.8731
Epoch 10/30

16/16 [==============================] - 0s 27ms/step - loss: 0.3829 - acc: 0.9009
Epoch 11/30

16/16 [==============================] - 0s 27ms/step - loss: 0.3521 - acc: 0.8978
Epoch 12/30

16/16 [==============================] - 0s 26ms/step - loss: 0.3576 - acc: 0.9071
Epoch 13/30

16/16 [==============================] - 0s 26ms/step - loss: 0.3088 - acc: 0.9071
Epoch 14/30

16/16 [==============================] - 0s 27ms/step - loss: 0.3071 - acc: 0.9102
Epoch 15/30

16/16 [==============================] - 0s 28ms/step - loss: 0.2943 - acc: 0.9226
Epoch 16/30

16/16 [==============================] - 0s 26ms/step - loss: 0.2684 - acc: 0.9226
Epoch 17/30

16/16 [==============================] - 0s 26ms/step - loss: 0.2513 - acc: 0.9226
Epoch 18/30

16/16 [==============================] - 0s 27ms/step - loss: 0.2314 - acc: 0.9474
Epoch 19/30

16/16 [==============================] - 0s 26ms/step - loss: 0.2252 - acc: 0.9474
Epoch 20/30

16/16 [==============================] - 0s 27ms/step - loss: 0.2090 - acc: 0.9567
Epoch 21/30

16/16 [==============================] - 0s 27ms/step - loss: 0.2136 - acc: 0.9443
Epoch 22/30

16/16 [==============================] - 0s 28ms/step - loss: 0.1853 - acc: 0.9598
Epoch 23/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1763 - acc: 0.9752
Epoch 24/30

16/16 [==============================] - 0s 26ms/step - loss: 0.1803 - acc: 0.9536
Epoch 25/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1788 - acc: 0.9721
Epoch 26/30

16/16 [==============================] - 0s 28ms/step - loss: 0.1446 - acc: 0.9721
Epoch 27/30

16/16 [==============================] - 0s 26ms/step - loss: 0.1358 - acc: 0.9876
Epoch 28/30

16/16 [==============================] - 0s 28ms/step - loss: 0.1455 - acc: 0.9721
Epoch 29/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1207 - acc: 0.9938
Epoch 30/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1246 - acc: 0.9876
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7164
False 1907
True percentage 0.789769595414
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.92      0.94      7318
      B-PER       0.38      0.37      0.37       438
      B-LOC       0.45      0.34      0.39       218
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.04      0.01      0.01       154
      B-ORG       0.29      0.41      0.34       296
      I-ORG       0.13      0.28      0.18       151
      I-LOC       0.75      0.02      0.04       141
      I-PER       0.21      0.03      0.05       214

avg / total       0.82      0.79      0.80      9071

F-1 Score (without O):
0.259400892288
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104056 unique words.
4052 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 559
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659648     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,778
Trainable params: 6,771,778
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

16/16 [==============================] - 2s 130ms/step - loss: 3.5189 - acc: 0.0133
Epoch 2/30

16/16 [==============================] - 0s 27ms/step - loss: 1.7307 - acc: 0.4536
Epoch 3/30

16/16 [==============================] - 0s 28ms/step - loss: 0.9532 - acc: 0.7692
Epoch 4/30

16/16 [==============================] - 0s 28ms/step - loss: 0.7506 - acc: 0.7772
Epoch 5/30

16/16 [==============================] - 0s 27ms/step - loss: 0.6384 - acc: 0.7851
Epoch 6/30

16/16 [==============================] - 0s 28ms/step - loss: 0.6036 - acc: 0.8223
Epoch 7/30

16/16 [==============================] - 0s 28ms/step - loss: 0.6947 - acc: 0.7719
Epoch 8/30

16/16 [==============================] - 0s 27ms/step - loss: 0.6990 - acc: 0.8249
Epoch 9/30

16/16 [==============================] - 0s 26ms/step - loss: 0.5233 - acc: 0.8276
Epoch 10/30

16/16 [==============================] - 0s 28ms/step - loss: 0.4777 - acc: 0.8939
Epoch 11/30

16/16 [==============================] - 0s 29ms/step - loss: 0.4338 - acc: 0.8833
Epoch 12/30

16/16 [==============================] - 0s 28ms/step - loss: 0.4193 - acc: 0.8966
Epoch 13/30

16/16 [==============================] - 0s 27ms/step - loss: 0.3798 - acc: 0.8966
Epoch 14/30

16/16 [==============================] - 0s 27ms/step - loss: 0.3682 - acc: 0.9151
Epoch 15/30

16/16 [==============================] - 0s 27ms/step - loss: 0.3573 - acc: 0.9151
Epoch 16/30

16/16 [==============================] - 0s 28ms/step - loss: 0.3479 - acc: 0.9098
Epoch 17/30

16/16 [==============================] - 0s 27ms/step - loss: 0.3237 - acc: 0.9151
Epoch 18/30

16/16 [==============================] - 0s 27ms/step - loss: 0.3264 - acc: 0.9284
Epoch 19/30

16/16 [==============================] - 0s 28ms/step - loss: 0.2891 - acc: 0.9310
Epoch 20/30

16/16 [==============================] - 0s 27ms/step - loss: 0.2619 - acc: 0.9496
Epoch 21/30

16/16 [==============================] - 0s 29ms/step - loss: 0.2726 - acc: 0.9443
Epoch 22/30

16/16 [==============================] - 0s 26ms/step - loss: 0.2620 - acc: 0.9523
Epoch 23/30

16/16 [==============================] - 0s 28ms/step - loss: 0.2425 - acc: 0.9523
Epoch 24/30

16/16 [==============================] - 0s 28ms/step - loss: 0.2226 - acc: 0.9576
Epoch 25/30

16/16 [==============================] - 0s 27ms/step - loss: 0.2230 - acc: 0.9682
Epoch 26/30

16/16 [==============================] - 0s 26ms/step - loss: 0.2154 - acc: 0.9576
Epoch 27/30

16/16 [==============================] - 0s 28ms/step - loss: 0.1941 - acc: 0.9708
Epoch 28/30

16/16 [==============================] - 0s 28ms/step - loss: 0.1908 - acc: 0.9629
Epoch 29/30

16/16 [==============================] - 0s 26ms/step - loss: 0.1833 - acc: 0.9655
Epoch 30/30

16/16 [==============================] - 0s 28ms/step - loss: 0.1743 - acc: 0.9629
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7091
False 1980
True percentage 0.781721971117
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.92      0.94      7318
      B-ORG       0.18      0.29      0.22       296
      I-ORG       0.11      0.36      0.17       151
      B-PER       0.50      0.16      0.24       438
      I-PER       0.27      0.20      0.23       214
      B-LOC       0.44      0.26      0.33       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.26      0.11      0.16       154

avg / total       0.82      0.78      0.80      9071

F-1 Score (without O):
0.204709576138
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 8 unique labels.
Found 104041 unique words.
4037 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658688     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,668
Trainable params: 6,770,668
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

8/8 [==============================] - 2s 244ms/step - loss: 2.1228 - acc: 0.2318
Epoch 2/30

8/8 [==============================] - 0s 31ms/step - loss: 0.9418 - acc: 0.8013
Epoch 3/30

8/8 [==============================] - 0s 31ms/step - loss: 0.6555 - acc: 0.8013
Epoch 4/30

8/8 [==============================] - 0s 31ms/step - loss: 0.5583 - acc: 0.8146
Epoch 5/30

8/8 [==============================] - 0s 31ms/step - loss: 0.4651 - acc: 0.8212
Epoch 6/30

8/8 [==============================] - 0s 33ms/step - loss: 0.4750 - acc: 0.8742
Epoch 7/30

8/8 [==============================] - 0s 32ms/step - loss: 0.4921 - acc: 0.8079
Epoch 8/30

8/8 [==============================] - 0s 31ms/step - loss: 0.3652 - acc: 0.9272
Epoch 9/30

8/8 [==============================] - 0s 32ms/step - loss: 0.2826 - acc: 0.9536
Epoch 10/30

8/8 [==============================] - 0s 32ms/step - loss: 0.2518 - acc: 0.9735
Epoch 11/30

8/8 [==============================] - 0s 31ms/step - loss: 0.2278 - acc: 0.9603
Epoch 12/30

8/8 [==============================] - 0s 33ms/step - loss: 0.2068 - acc: 0.9669
Epoch 13/30

8/8 [==============================] - 0s 32ms/step - loss: 0.2090 - acc: 0.9735
Epoch 14/30

8/8 [==============================] - 0s 31ms/step - loss: 0.1617 - acc: 0.9801
Epoch 15/30

8/8 [==============================] - 0s 31ms/step - loss: 0.1645 - acc: 0.9868
Epoch 16/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1397 - acc: 1.0000
Epoch 17/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1539 - acc: 0.9735
Epoch 18/30

8/8 [==============================] - 0s 33ms/step - loss: 0.1286 - acc: 0.9868
Epoch 19/30

8/8 [==============================] - 0s 31ms/step - loss: 0.1253 - acc: 0.9934
Epoch 20/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1102 - acc: 0.9934
Epoch 21/30

8/8 [==============================] - 0s 33ms/step - loss: 0.0965 - acc: 1.0000
Epoch 22/30

8/8 [==============================] - 0s 32ms/step - loss: 0.0903 - acc: 0.9934
Epoch 23/30

8/8 [==============================] - 0s 32ms/step - loss: 0.0863 - acc: 0.9934
Epoch 24/30

8/8 [==============================] - 0s 32ms/step - loss: 0.0848 - acc: 1.0000
Epoch 25/30

8/8 [==============================] - 0s 30ms/step - loss: 0.0926 - acc: 1.0000
Epoch 26/30

8/8 [==============================] - 0s 31ms/step - loss: 0.0750 - acc: 1.0000
Epoch 27/30

8/8 [==============================] - 0s 32ms/step - loss: 0.0660 - acc: 1.0000
Epoch 28/30

8/8 [==============================] - 0s 31ms/step - loss: 0.0634 - acc: 1.0000
Epoch 29/30

8/8 [==============================] - 0s 31ms/step - loss: 0.0645 - acc: 1.0000
Epoch 30/30

8/8 [==============================] - 0s 32ms/step - loss: 0.0603 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7053
False 1804
True percentage 0.796319295473
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.91      0.93      7318
      B-LOC       0.35      0.18      0.24       218
      I-LOC       0.39      0.12      0.18       141
      B-PER       0.43      0.22      0.29       438
      B-ORG       0.22      0.57      0.32       296
      I-ORG       0.16      0.36      0.22       151
     B-MISC       0.33      0.01      0.03       141
     I-MISC       0.12      0.07      0.09       154

avg / total       0.85      0.80      0.81      8857

F-1 Score (without O):
0.250725104737
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104046 unique words.
4042 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659008     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,138
Trainable params: 6,771,138
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

8/8 [==============================] - 2s 239ms/step - loss: 2.0763 - acc: 0.2449
Epoch 2/30

8/8 [==============================] - 0s 31ms/step - loss: 0.9314 - acc: 0.7619
Epoch 3/30

8/8 [==============================] - 0s 31ms/step - loss: 0.6477 - acc: 0.7891
Epoch 4/30

8/8 [==============================] - 0s 31ms/step - loss: 0.5373 - acc: 0.8435
Epoch 5/30

8/8 [==============================] - 0s 32ms/step - loss: 0.7457 - acc: 0.7755
Epoch 6/30

8/8 [==============================] - 0s 33ms/step - loss: 0.6314 - acc: 0.8639
Epoch 7/30

8/8 [==============================] - 0s 31ms/step - loss: 0.3791 - acc: 0.9524
Epoch 8/30

8/8 [==============================] - 0s 32ms/step - loss: 0.3285 - acc: 0.9388
Epoch 9/30

8/8 [==============================] - 0s 32ms/step - loss: 0.2910 - acc: 0.9592
Epoch 10/30

8/8 [==============================] - 0s 31ms/step - loss: 0.2685 - acc: 0.9660
Epoch 11/30

8/8 [==============================] - 0s 32ms/step - loss: 0.2417 - acc: 0.9728
Epoch 12/30

8/8 [==============================] - 0s 33ms/step - loss: 0.1927 - acc: 0.9796
Epoch 13/30

8/8 [==============================] - 0s 31ms/step - loss: 0.2015 - acc: 0.9728
Epoch 14/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1802 - acc: 0.9796
Epoch 15/30

8/8 [==============================] - 0s 31ms/step - loss: 0.1437 - acc: 0.9864
Epoch 16/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1409 - acc: 0.9728
Epoch 17/30

8/8 [==============================] - 0s 33ms/step - loss: 0.1206 - acc: 0.9932
Epoch 18/30

8/8 [==============================] - 0s 31ms/step - loss: 0.1090 - acc: 0.9932
Epoch 19/30

8/8 [==============================] - 0s 31ms/step - loss: 0.1144 - acc: 0.9864
Epoch 20/30

8/8 [==============================] - 0s 33ms/step - loss: 0.1010 - acc: 0.9796
Epoch 21/30

8/8 [==============================] - 0s 31ms/step - loss: 0.0839 - acc: 1.0000
Epoch 22/30

8/8 [==============================] - 0s 32ms/step - loss: 0.0834 - acc: 1.0000
Epoch 23/30

8/8 [==============================] - 0s 31ms/step - loss: 0.0785 - acc: 1.0000
Epoch 24/30

8/8 [==============================] - 0s 32ms/step - loss: 0.0727 - acc: 1.0000
Epoch 25/30

8/8 [==============================] - 0s 32ms/step - loss: 0.0774 - acc: 0.9932
Epoch 26/30

8/8 [==============================] - 0s 32ms/step - loss: 0.0666 - acc: 1.0000
Epoch 27/30

8/8 [==============================] - 0s 32ms/step - loss: 0.0656 - acc: 1.0000
Epoch 28/30

8/8 [==============================] - 0s 31ms/step - loss: 0.0563 - acc: 1.0000
Epoch 29/30

8/8 [==============================] - 0s 31ms/step - loss: 0.0524 - acc: 1.0000
Epoch 30/30

8/8 [==============================] - 0s 32ms/step - loss: 0.0545 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7084
False 1987
True percentage 0.780950281116
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.33      0.16      0.21       438
      I-PER       0.25      0.18      0.21       214
          O       0.95      0.92      0.94      7318
      B-ORG       0.21      0.50      0.30       296
      I-ORG       0.15      0.29      0.20       151
      B-LOC       0.96      0.11      0.20       218
      I-LOC       0.48      0.07      0.12       141
     B-MISC       0.08      0.01      0.01       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.83      0.78      0.79      9071

F-1 Score (without O):
0.828971465706
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104043 unique words.
4039 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 565
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658816     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,946
Trainable params: 6,770,946
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

8/8 [==============================] - 2s 231ms/step - loss: 2.8691 - acc: 0.0178
Epoch 2/30

8/8 [==============================] - 0s 32ms/step - loss: 1.2806 - acc: 0.7278
Epoch 3/30

8/8 [==============================] - 0s 34ms/step - loss: 0.7387 - acc: 0.7988
Epoch 4/30

8/8 [==============================] - 0s 31ms/step - loss: 0.5772 - acc: 0.8166
Epoch 5/30

8/8 [==============================] - 0s 31ms/step - loss: 0.5086 - acc: 0.8580
Epoch 6/30

8/8 [==============================] - 0s 33ms/step - loss: 0.4719 - acc: 0.8225
Epoch 7/30

8/8 [==============================] - 0s 33ms/step - loss: 0.5052 - acc: 0.8817
Epoch 8/30

8/8 [==============================] - 0s 32ms/step - loss: 0.3643 - acc: 0.8580
Epoch 9/30

8/8 [==============================] - 0s 32ms/step - loss: 0.3259 - acc: 0.9467
Epoch 10/30

8/8 [==============================] - 0s 33ms/step - loss: 0.2781 - acc: 0.9231
Epoch 11/30

8/8 [==============================] - 0s 32ms/step - loss: 0.2711 - acc: 0.9527
Epoch 12/30

8/8 [==============================] - 0s 32ms/step - loss: 0.2323 - acc: 0.9349
Epoch 13/30

8/8 [==============================] - 0s 32ms/step - loss: 0.2446 - acc: 0.9586
Epoch 14/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1984 - acc: 0.9763
Epoch 15/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1681 - acc: 0.9704
Epoch 16/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1657 - acc: 0.9882
Epoch 17/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1524 - acc: 0.9941
Epoch 18/30

8/8 [==============================] - 0s 34ms/step - loss: 0.1457 - acc: 0.9822
Epoch 19/30

8/8 [==============================] - 0s 33ms/step - loss: 0.1183 - acc: 1.0000
Epoch 20/30

8/8 [==============================] - 0s 33ms/step - loss: 0.1223 - acc: 0.9882
Epoch 21/30

8/8 [==============================] - 0s 33ms/step - loss: 0.1123 - acc: 0.9882
Epoch 22/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1011 - acc: 0.9941
Epoch 23/30

8/8 [==============================] - 0s 33ms/step - loss: 0.0907 - acc: 0.9941
Epoch 24/30

8/8 [==============================] - 0s 33ms/step - loss: 0.0788 - acc: 0.9941
Epoch 25/30

8/8 [==============================] - 0s 33ms/step - loss: 0.0768 - acc: 1.0000
Epoch 26/30

8/8 [==============================] - 0s 32ms/step - loss: 0.0796 - acc: 0.9941
Epoch 27/30

8/8 [==============================] - 0s 32ms/step - loss: 0.0698 - acc: 1.0000
Epoch 28/30

8/8 [==============================] - 0s 32ms/step - loss: 0.0788 - acc: 0.9882
Epoch 29/30

8/8 [==============================] - 0s 31ms/step - loss: 0.0621 - acc: 1.0000
Epoch 30/30

8/8 [==============================] - 0s 31ms/step - loss: 0.0658 - acc: 0.9941
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7335
False 1736
True percentage 0.808620879727
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.93      0.94      7318
      B-PER       0.45      0.47      0.46       438
      B-LOC       0.45      0.42      0.43       218
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-ORG       0.33      0.33      0.33       296
      I-ORG       0.17      0.30      0.22       151
      I-LOC       0.62      0.16      0.26       141
      I-PER       0.51      0.13      0.20       214

avg / total       0.84      0.81      0.82      9071

F-1 Score (without O):
0.321846553966
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104046 unique words.
4042 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 559
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659008     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,138
Trainable params: 6,771,138
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

8/8 [==============================] - 2s 234ms/step - loss: 2.6238 - acc: 0.0387
Epoch 2/30

8/8 [==============================] - 0s 32ms/step - loss: 1.2958 - acc: 0.6188
Epoch 3/30

8/8 [==============================] - 0s 32ms/step - loss: 0.9547 - acc: 0.7348
Epoch 4/30

8/8 [==============================] - 0s 32ms/step - loss: 0.8242 - acc: 0.7072
Epoch 5/30

8/8 [==============================] - 0s 32ms/step - loss: 0.9313 - acc: 0.7569
Epoch 6/30

8/8 [==============================] - 0s 32ms/step - loss: 0.7507 - acc: 0.7238
Epoch 7/30

8/8 [==============================] - 0s 33ms/step - loss: 0.6448 - acc: 0.8508
Epoch 8/30

8/8 [==============================] - 0s 32ms/step - loss: 0.5270 - acc: 0.8950
Epoch 9/30

8/8 [==============================] - 0s 32ms/step - loss: 0.4719 - acc: 0.9282
Epoch 10/30

8/8 [==============================] - 0s 31ms/step - loss: 0.4196 - acc: 0.9337
Epoch 11/30

8/8 [==============================] - 0s 31ms/step - loss: 0.3896 - acc: 0.9282
Epoch 12/30

8/8 [==============================] - 0s 32ms/step - loss: 0.3699 - acc: 0.9337
Epoch 13/30

8/8 [==============================] - 0s 34ms/step - loss: 0.3389 - acc: 0.9503
Epoch 14/30

8/8 [==============================] - 0s 33ms/step - loss: 0.3157 - acc: 0.9448
Epoch 15/30

8/8 [==============================] - 0s 32ms/step - loss: 0.2848 - acc: 0.9503
Epoch 16/30

8/8 [==============================] - 0s 32ms/step - loss: 0.2792 - acc: 0.9503
Epoch 17/30

8/8 [==============================] - 0s 31ms/step - loss: 0.2434 - acc: 0.9669
Epoch 18/30

8/8 [==============================] - 0s 34ms/step - loss: 0.2182 - acc: 0.9558
Epoch 19/30

8/8 [==============================] - 0s 32ms/step - loss: 0.2120 - acc: 0.9503
Epoch 20/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1852 - acc: 0.9669
Epoch 21/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1718 - acc: 0.9779
Epoch 22/30

8/8 [==============================] - 0s 33ms/step - loss: 0.1712 - acc: 0.9724
Epoch 23/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1457 - acc: 0.9779
Epoch 24/30

8/8 [==============================] - 0s 31ms/step - loss: 0.1650 - acc: 0.9613
Epoch 25/30

8/8 [==============================] - 0s 31ms/step - loss: 0.1719 - acc: 0.9779
Epoch 26/30

8/8 [==============================] - 0s 31ms/step - loss: 0.1233 - acc: 0.9890
Epoch 27/30

8/8 [==============================] - 0s 31ms/step - loss: 0.1361 - acc: 0.9890
Epoch 28/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1131 - acc: 0.9890
Epoch 29/30

8/8 [==============================] - 0s 33ms/step - loss: 0.1052 - acc: 0.9945
Epoch 30/30

8/8 [==============================] - 0s 32ms/step - loss: 0.0994 - acc: 0.9890
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7062
False 2009
True percentage 0.778524969684
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.91      0.94      7318
      B-ORG       0.25      0.39      0.30       296
      I-ORG       0.18      0.59      0.27       151
      B-PER       0.31      0.26      0.28       438
      I-PER       0.31      0.29      0.30       214
      B-LOC       0.43      0.01      0.03       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.31      0.03      0.05       141
     I-MISC       0.21      0.06      0.10       154

avg / total       0.83      0.78      0.79      9071

F-1 Score (without O):
0.236559139785
