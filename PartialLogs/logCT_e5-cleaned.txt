Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 11
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.4194 - acc: 0.8714
Epoch 2/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.2424 - acc: 0.9271
Epoch 3/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.1913 - acc: 0.9441
Epoch 4/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.1565 - acc: 0.9541
Epoch 5/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.1351 - acc: 0.9607
Epoch 6/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1173 - acc: 0.9661
Epoch 7/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.1052 - acc: 0.9706
Epoch 8/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0955 - acc: 0.9727
Epoch 9/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0864 - acc: 0.9755
Epoch 10/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0777 - acc: 0.9783
Epoch 11/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0717 - acc: 0.9798
Epoch 12/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0669 - acc: 0.9808
Epoch 13/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0607 - acc: 0.9832
Epoch 14/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0566 - acc: 0.9840
Epoch 15/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0544 - acc: 0.9847
Epoch 16/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0506 - acc: 0.9858
Epoch 17/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0476 - acc: 0.9866
Epoch 18/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0445 - acc: 0.9876
Epoch 19/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0428 - acc: 0.9873
Epoch 20/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0406 - acc: 0.9888
Epoch 21/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0394 - acc: 0.9883
Epoch 22/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0357 - acc: 0.9903
Epoch 23/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0348 - acc: 0.9899
Epoch 24/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0332 - acc: 0.9905
Epoch 25/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0320 - acc: 0.9906
Epoch 26/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0324 - acc: 0.9903
Epoch 27/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0311 - acc: 0.9908
Epoch 28/28

1674/1674 [==============================] - 46s 27ms/step - loss: 0.0300 - acc: 0.9911
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8246
False 825
True percentage 0.909050821299
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.73      0.74      0.73       296
      I-ORG       0.67      0.64      0.66       151
     B-MISC       0.44      0.33      0.38       141
      B-LOC       0.74      0.70      0.72       218
      B-PER       0.92      0.84      0.87       438
     I-MISC       0.51      0.44      0.47       154
      I-PER       0.93      0.67      0.78       214
      I-LOC       0.72      0.76      0.74       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.716890881913
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 105288 unique words.
5284 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 230
OOV word occurences: in test 314
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6738496     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,850,626
Trainable params: 6,850,626
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

1674/1674 [==============================] - 47s 28ms/step - loss: 0.4492 - acc: 0.8610
Epoch 2/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.2662 - acc: 0.9193
Epoch 3/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.2104 - acc: 0.9382
Epoch 4/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1758 - acc: 0.9477
Epoch 5/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1497 - acc: 0.9571
Epoch 6/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1311 - acc: 0.9622
Epoch 7/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1157 - acc: 0.9672
Epoch 8/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1029 - acc: 0.9708
Epoch 9/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0946 - acc: 0.9733
Epoch 10/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0853 - acc: 0.9765
Epoch 11/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0776 - acc: 0.9785
Epoch 12/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0728 - acc: 0.9796
Epoch 13/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0672 - acc: 0.9820
Epoch 14/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0617 - acc: 0.9831
Epoch 15/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0584 - acc: 0.9838
Epoch 16/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0548 - acc: 0.9846
Epoch 17/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0510 - acc: 0.9857
Epoch 18/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0488 - acc: 0.9867
Epoch 19/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0446 - acc: 0.9877
Epoch 20/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0446 - acc: 0.9868
Epoch 21/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0423 - acc: 0.9882
Epoch 22/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0400 - acc: 0.9884
Epoch 23/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0388 - acc: 0.9885
Epoch 24/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0366 - acc: 0.9901
Epoch 25/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0357 - acc: 0.9900
Epoch 26/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0353 - acc: 0.9901
Epoch 27/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0310 - acc: 0.9914
Epoch 28/28

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0314 - acc: 0.9907
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8244
False 827
True percentage 0.908830338441
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.89      0.84      0.86       438
      B-ORG       0.77      0.73      0.75       296
     B-MISC       0.42      0.33      0.37       141
      I-PER       0.93      0.64      0.76       214
      I-ORG       0.72      0.58      0.64       151
     I-MISC       0.52      0.49      0.51       154
      B-LOC       0.73      0.73      0.73       218
      I-LOC       0.72      0.77      0.74       141

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.717456508698
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 11
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104753 unique words.
4749 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 253
OOV word occurences: in test 357
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6704256     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,816,386
Trainable params: 6,816,386
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 24s 29ms/step - loss: 0.5563 - acc: 0.8325
Epoch 2/28

837/837 [==============================] - 22s 27ms/step - loss: 0.3265 - acc: 0.8989
Epoch 3/28

837/837 [==============================] - 23s 27ms/step - loss: 0.2638 - acc: 0.9210
Epoch 4/28

837/837 [==============================] - 23s 27ms/step - loss: 0.2183 - acc: 0.9356
Epoch 5/28

837/837 [==============================] - 22s 27ms/step - loss: 0.1953 - acc: 0.9426
Epoch 6/28

837/837 [==============================] - 22s 27ms/step - loss: 0.1706 - acc: 0.9509
Epoch 7/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1497 - acc: 0.9571
Epoch 8/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1359 - acc: 0.9619
Epoch 9/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1187 - acc: 0.9666
Epoch 10/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1111 - acc: 0.9696
Epoch 11/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1004 - acc: 0.9718
Epoch 12/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0924 - acc: 0.9755
Epoch 13/28

837/837 [==============================] - 22s 27ms/step - loss: 0.0871 - acc: 0.9763
Epoch 14/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0783 - acc: 0.9791
Epoch 15/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0717 - acc: 0.9814
Epoch 16/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0675 - acc: 0.9824
Epoch 17/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0639 - acc: 0.9836
Epoch 18/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0582 - acc: 0.9848
Epoch 19/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0556 - acc: 0.9858
Epoch 20/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0527 - acc: 0.9855
Epoch 21/28

837/837 [==============================] - 22s 27ms/step - loss: 0.0480 - acc: 0.9875
Epoch 22/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0449 - acc: 0.9889
Epoch 23/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0457 - acc: 0.9873
Epoch 24/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0418 - acc: 0.9894
Epoch 25/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0403 - acc: 0.9898
Epoch 26/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0394 - acc: 0.9892
Epoch 27/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0362 - acc: 0.9894
Epoch 28/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0358 - acc: 0.9905
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8162
False 909
True percentage 0.899790541285
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.71      0.73      0.72       296
      I-ORG       0.59      0.58      0.58       151
     B-MISC       0.42      0.24      0.31       141
      B-LOC       0.71      0.77      0.74       218
      B-PER       0.91      0.76      0.83       438
     I-MISC       0.52      0.36      0.43       154
      I-PER       0.89      0.63      0.74       214
      I-LOC       0.76      0.77      0.76       141

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.692167577413
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104701 unique words.
4697 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 246
OOV word occurences: in test 382
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6700928     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,813,058
Trainable params: 6,813,058
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 25s 30ms/step - loss: 0.5110 - acc: 0.8457
Epoch 2/28

837/837 [==============================] - 24s 28ms/step - loss: 0.2971 - acc: 0.9098
Epoch 3/28

837/837 [==============================] - 24s 28ms/step - loss: 0.2366 - acc: 0.9280
Epoch 4/28

837/837 [==============================] - 24s 28ms/step - loss: 0.1994 - acc: 0.9433
Epoch 5/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1714 - acc: 0.9511
Epoch 6/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1518 - acc: 0.9580
Epoch 7/28

837/837 [==============================] - 24s 28ms/step - loss: 0.1340 - acc: 0.9633
Epoch 8/28

837/837 [==============================] - 24s 28ms/step - loss: 0.1198 - acc: 0.9674
Epoch 9/28

837/837 [==============================] - 24s 28ms/step - loss: 0.1104 - acc: 0.9711
Epoch 10/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0983 - acc: 0.9739
Epoch 11/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0924 - acc: 0.9749
Epoch 12/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0843 - acc: 0.9766
Epoch 13/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0760 - acc: 0.9799
Epoch 14/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0722 - acc: 0.9805
Epoch 15/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0668 - acc: 0.9820
Epoch 16/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0653 - acc: 0.9832
Epoch 17/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0565 - acc: 0.9854
Epoch 18/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0544 - acc: 0.9858
Epoch 19/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0524 - acc: 0.9860
Epoch 20/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0474 - acc: 0.9880
Epoch 21/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0455 - acc: 0.9884
Epoch 22/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0443 - acc: 0.9882
Epoch 23/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0413 - acc: 0.9899
Epoch 24/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0382 - acc: 0.9899
Epoch 25/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0371 - acc: 0.9903
Epoch 26/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0347 - acc: 0.9913
Epoch 27/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0338 - acc: 0.9912
Epoch 28/28

837/837 [==============================] - 24s 28ms/step - loss: 0.0322 - acc: 0.9916
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8053
False 1018
True percentage 0.887774225554
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.87      0.67      0.76       438
      B-ORG       0.64      0.69      0.66       296
     B-MISC       0.42      0.26      0.32       141
      I-PER       0.80      0.62      0.70       214
      I-ORG       0.50      0.47      0.49       151
     I-MISC       0.43      0.42      0.42       154
      B-LOC       0.73      0.72      0.72       218
      I-LOC       0.65      0.70      0.67       141

avg / total       0.92      0.89      0.90      9071

F-1 Score (without O):
0.63734939759
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 13
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104770 unique words.
4766 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 244
OOV word occurences: in test 378
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6705344     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,817,474
Trainable params: 6,817,474
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

837/837 [==============================] - 25s 30ms/step - loss: 0.4894 - acc: 0.8492
Epoch 2/28

837/837 [==============================] - 23s 27ms/step - loss: 0.2871 - acc: 0.9153
Epoch 3/28

837/837 [==============================] - 23s 27ms/step - loss: 0.2290 - acc: 0.9325
Epoch 4/28

837/837 [==============================] - 23s 28ms/step - loss: 0.1915 - acc: 0.9436
Epoch 5/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1669 - acc: 0.9520
Epoch 6/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1465 - acc: 0.9569
Epoch 7/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1290 - acc: 0.9638
Epoch 8/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1149 - acc: 0.9672
Epoch 9/28

837/837 [==============================] - 23s 27ms/step - loss: 0.1066 - acc: 0.9702
Epoch 10/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0924 - acc: 0.9743
Epoch 11/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0833 - acc: 0.9773
Epoch 12/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0759 - acc: 0.9786
Epoch 13/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0695 - acc: 0.9821
Epoch 14/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0652 - acc: 0.9823
Epoch 15/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0609 - acc: 0.9842
Epoch 16/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0586 - acc: 0.9838
Epoch 17/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0534 - acc: 0.9859
Epoch 18/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0481 - acc: 0.9877
Epoch 19/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0463 - acc: 0.9884
Epoch 20/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0430 - acc: 0.9889
Epoch 21/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0407 - acc: 0.9901
Epoch 22/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0380 - acc: 0.9904
Epoch 23/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0352 - acc: 0.9913
Epoch 24/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0337 - acc: 0.9916
Epoch 25/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0315 - acc: 0.9926
Epoch 26/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0294 - acc: 0.9924
Epoch 27/28

837/837 [==============================] - 23s 28ms/step - loss: 0.0303 - acc: 0.9924
Epoch 28/28

837/837 [==============================] - 23s 27ms/step - loss: 0.0288 - acc: 0.9924
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8111
False 960
True percentage 0.89416822842
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.87      0.74      0.80       438
          O       0.98      0.96      0.97      7318
      B-LOC       0.72      0.71      0.71       218
      I-LOC       0.72      0.77      0.74       141
     B-MISC       0.37      0.29      0.32       141
     I-MISC       0.40      0.45      0.42       154
      B-ORG       0.72      0.67      0.69       296
      I-ORG       0.64      0.40      0.50       151
      I-PER       0.88      0.60      0.72       214

avg / total       0.93      0.89      0.91      9071

F-1 Score (without O):
0.918612880396
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 11
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104339 unique words.
4335 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 266
OOV word occurences: in test 406
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6677760     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,789,890
Trainable params: 6,789,890
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 11s 32ms/step - loss: 0.5996 - acc: 0.8097
Epoch 2/28

334/334 [==============================] - 9s 27ms/step - loss: 0.3586 - acc: 0.8895
Epoch 3/28

334/334 [==============================] - 9s 27ms/step - loss: 0.3029 - acc: 0.9125
Epoch 4/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2589 - acc: 0.9235
Epoch 5/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2261 - acc: 0.9342
Epoch 6/28

334/334 [==============================] - 9s 27ms/step - loss: 0.2014 - acc: 0.9449
Epoch 7/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1807 - acc: 0.9472
Epoch 8/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1597 - acc: 0.9557
Epoch 9/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1420 - acc: 0.9637
Epoch 10/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1262 - acc: 0.9703
Epoch 11/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1154 - acc: 0.9708
Epoch 12/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1055 - acc: 0.9741
Epoch 13/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0971 - acc: 0.9769
Epoch 14/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0864 - acc: 0.9811
Epoch 15/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0807 - acc: 0.9816
Epoch 16/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0751 - acc: 0.9833
Epoch 17/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0680 - acc: 0.9842
Epoch 18/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0634 - acc: 0.9854
Epoch 19/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0573 - acc: 0.9879
Epoch 20/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0537 - acc: 0.9889
Epoch 21/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0525 - acc: 0.9878
Epoch 22/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0483 - acc: 0.9907
Epoch 23/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0422 - acc: 0.9901
Epoch 24/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0434 - acc: 0.9901
Epoch 25/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0407 - acc: 0.9910
Epoch 26/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0378 - acc: 0.9935
Epoch 27/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0346 - acc: 0.9933
Epoch 28/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0342 - acc: 0.9933
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8044
False 1027
True percentage 0.886782052695
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.72      0.59      0.65       296
      I-ORG       0.58      0.48      0.53       151
     B-MISC       0.37      0.30      0.33       141
      B-LOC       0.72      0.74      0.73       218
      B-PER       0.83      0.72      0.77       438
     I-MISC       0.47      0.50      0.49       154
      I-PER       0.81      0.54      0.65       214
      I-LOC       0.71      0.67      0.69       141

avg / total       0.92      0.89      0.90      9071

F-1 Score (without O):
0.642118076689
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104315 unique words.
4311 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 264
OOV word occurences: in test 444
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6676224     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,788,354
Trainable params: 6,788,354
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 11s 34ms/step - loss: 0.6743 - acc: 0.7931
Epoch 2/28

334/334 [==============================] - 9s 28ms/step - loss: 0.3788 - acc: 0.8788
Epoch 3/28

334/334 [==============================] - 9s 28ms/step - loss: 0.3173 - acc: 0.9018
Epoch 4/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2792 - acc: 0.9161
Epoch 5/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2465 - acc: 0.9258
Epoch 6/28

334/334 [==============================] - 9s 28ms/step - loss: 0.2219 - acc: 0.9356
Epoch 7/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1969 - acc: 0.9416
Epoch 8/28

334/334 [==============================] - 10s 29ms/step - loss: 0.1783 - acc: 0.9499
Epoch 9/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1607 - acc: 0.9559
Epoch 10/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1537 - acc: 0.9590
Epoch 11/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1418 - acc: 0.9627
Epoch 12/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1282 - acc: 0.9657
Epoch 13/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1177 - acc: 0.9699
Epoch 14/28

334/334 [==============================] - 9s 28ms/step - loss: 0.1088 - acc: 0.9730
Epoch 15/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0974 - acc: 0.9760
Epoch 16/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0943 - acc: 0.9768
Epoch 17/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0818 - acc: 0.9815
Epoch 18/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0781 - acc: 0.9816
Epoch 19/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0722 - acc: 0.9836
Epoch 20/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0677 - acc: 0.9844
Epoch 21/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0634 - acc: 0.9838
Epoch 22/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0567 - acc: 0.9874
Epoch 23/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0531 - acc: 0.9891
Epoch 24/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0527 - acc: 0.9870
Epoch 25/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0476 - acc: 0.9892
Epoch 26/28

334/334 [==============================] - 10s 28ms/step - loss: 0.0460 - acc: 0.9893
Epoch 27/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0421 - acc: 0.9901
Epoch 28/28

334/334 [==============================] - 9s 28ms/step - loss: 0.0390 - acc: 0.9919
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7914
False 1157
True percentage 0.872450666961
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.94      0.96      7318
      B-PER       0.87      0.62      0.73       438
      B-ORG       0.54      0.59      0.56       296
     B-MISC       0.44      0.33      0.37       141
      I-PER       0.84      0.58      0.69       214
      I-ORG       0.38      0.52      0.44       151
     I-MISC       0.40      0.40      0.40       154
      B-LOC       0.71      0.69      0.70       218
      I-LOC       0.79      0.67      0.72       141

avg / total       0.92      0.87      0.89      9071

F-1 Score (without O):
0.601260126013
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 13
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104351 unique words.
4347 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 265
OOV word occurences: in test 421
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6678528     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,790,658
Trainable params: 6,790,658
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

334/334 [==============================] - 11s 32ms/step - loss: 0.6167 - acc: 0.8088
Epoch 2/28

334/334 [==============================] - 9s 27ms/step - loss: 0.3719 - acc: 0.8838
Epoch 3/28

334/334 [==============================] - 9s 27ms/step - loss: 0.2999 - acc: 0.9104
Epoch 4/28

334/334 [==============================] - 9s 26ms/step - loss: 0.2635 - acc: 0.9229
Epoch 5/28

334/334 [==============================] - 9s 26ms/step - loss: 0.2216 - acc: 0.9377
Epoch 6/28

334/334 [==============================] - 9s 26ms/step - loss: 0.1977 - acc: 0.9456
Epoch 7/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1739 - acc: 0.9523
Epoch 8/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1572 - acc: 0.9581
Epoch 9/28

334/334 [==============================] - 9s 26ms/step - loss: 0.1390 - acc: 0.9651
Epoch 10/28

334/334 [==============================] - 9s 26ms/step - loss: 0.1222 - acc: 0.9679
Epoch 11/28

334/334 [==============================] - 9s 26ms/step - loss: 0.1135 - acc: 0.9705
Epoch 12/28

334/334 [==============================] - 9s 27ms/step - loss: 0.1034 - acc: 0.9741
Epoch 13/28

334/334 [==============================] - 9s 26ms/step - loss: 0.0924 - acc: 0.9770
Epoch 14/28

334/334 [==============================] - 9s 26ms/step - loss: 0.0856 - acc: 0.9787
Epoch 15/28

334/334 [==============================] - 9s 26ms/step - loss: 0.0768 - acc: 0.9818
Epoch 16/28

334/334 [==============================] - 9s 26ms/step - loss: 0.0698 - acc: 0.9848
Epoch 17/28

334/334 [==============================] - 9s 26ms/step - loss: 0.0634 - acc: 0.9862
Epoch 18/28

334/334 [==============================] - 9s 26ms/step - loss: 0.0622 - acc: 0.9846
Epoch 19/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0575 - acc: 0.9870
Epoch 20/28

334/334 [==============================] - 9s 26ms/step - loss: 0.0524 - acc: 0.9892
Epoch 21/28

334/334 [==============================] - 9s 26ms/step - loss: 0.0479 - acc: 0.9901
Epoch 22/28

334/334 [==============================] - 9s 27ms/step - loss: 0.0441 - acc: 0.9915
Epoch 23/28

334/334 [==============================] - 9s 26ms/step - loss: 0.0420 - acc: 0.9915
Epoch 24/28

334/334 [==============================] - 9s 26ms/step - loss: 0.0406 - acc: 0.9913
Epoch 25/28

334/334 [==============================] - 9s 26ms/step - loss: 0.0392 - acc: 0.9923
Epoch 26/28

334/334 [==============================] - 9s 26ms/step - loss: 0.0370 - acc: 0.9919
Epoch 27/28

334/334 [==============================] - 9s 26ms/step - loss: 0.0342 - acc: 0.9939
Epoch 28/28

334/334 [==============================] - 9s 26ms/step - loss: 0.0307 - acc: 0.9941
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8012
False 1059
True percentage 0.883254326976
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.87      0.67      0.75       438
          O       0.98      0.96      0.97      7318
      B-LOC       0.66      0.68      0.67       218
      I-LOC       0.72      0.72      0.72       141
     B-MISC       0.36      0.21      0.26       141
     I-MISC       0.45      0.44      0.45       154
      B-ORG       0.68      0.66      0.67       296
      I-ORG       0.43      0.36      0.40       151
      I-PER       0.81      0.59      0.68       214

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.911129470081
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 11
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104211 unique words.
4207 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 272
OOV word occurences: in test 450
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6669568     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,781,698
Trainable params: 6,781,698
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 6s 38ms/step - loss: 0.7156 - acc: 0.7634
Epoch 2/28

167/167 [==============================] - 5s 27ms/step - loss: 0.4210 - acc: 0.8611
Epoch 3/28

167/167 [==============================] - 5s 28ms/step - loss: 0.3505 - acc: 0.8885
Epoch 4/28

167/167 [==============================] - 5s 28ms/step - loss: 0.3063 - acc: 0.9030
Epoch 5/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2667 - acc: 0.9237
Epoch 6/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2371 - acc: 0.9370
Epoch 7/28

167/167 [==============================] - 5s 27ms/step - loss: 0.2238 - acc: 0.9395
Epoch 8/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1996 - acc: 0.9430
Epoch 9/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1755 - acc: 0.9536
Epoch 10/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1626 - acc: 0.9562
Epoch 11/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1468 - acc: 0.9658
Epoch 12/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1302 - acc: 0.9707
Epoch 13/28

167/167 [==============================] - 5s 27ms/step - loss: 0.1191 - acc: 0.9734
Epoch 14/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1087 - acc: 0.9780
Epoch 15/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0955 - acc: 0.9816
Epoch 16/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0908 - acc: 0.9816
Epoch 17/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0854 - acc: 0.9850
Epoch 18/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0753 - acc: 0.9864
Epoch 19/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0718 - acc: 0.9876
Epoch 20/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0636 - acc: 0.9891
Epoch 21/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0609 - acc: 0.9905
Epoch 22/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0575 - acc: 0.9910
Epoch 23/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0503 - acc: 0.9933
Epoch 24/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0529 - acc: 0.9905
Epoch 25/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0454 - acc: 0.9936
Epoch 26/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0420 - acc: 0.9939
Epoch 27/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0400 - acc: 0.9938
Epoch 28/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0399 - acc: 0.9939
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7902
False 1169
True percentage 0.871127769816
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-ORG       0.55      0.62      0.59       296
      I-ORG       0.41      0.53      0.47       151
     B-MISC       0.33      0.10      0.15       141
      B-LOC       0.65      0.64      0.65       218
      B-PER       0.85      0.63      0.72       438
     I-MISC       0.49      0.27      0.35       154
      I-PER       0.77      0.56      0.65       214
      I-LOC       0.66      0.64      0.65       141

avg / total       0.91      0.87      0.89      9071

F-1 Score (without O):
0.584158415842
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104165 unique words.
4161 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 270
OOV word occurences: in test 538
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6666624     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,778,754
Trainable params: 6,778,754
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 6s 37ms/step - loss: 0.8322 - acc: 0.7534
Epoch 2/28

167/167 [==============================] - 4s 27ms/step - loss: 0.4244 - acc: 0.8622
Epoch 3/28

167/167 [==============================] - 5s 27ms/step - loss: 0.3625 - acc: 0.8864
Epoch 4/28

167/167 [==============================] - 5s 27ms/step - loss: 0.3240 - acc: 0.9067
Epoch 5/28

167/167 [==============================] - 5s 27ms/step - loss: 0.2888 - acc: 0.9176
Epoch 6/28

167/167 [==============================] - 5s 27ms/step - loss: 0.2592 - acc: 0.9298
Epoch 7/28

167/167 [==============================] - 4s 27ms/step - loss: 0.2400 - acc: 0.9263
Epoch 8/28

167/167 [==============================] - 5s 27ms/step - loss: 0.2098 - acc: 0.9460
Epoch 9/28

167/167 [==============================] - 5s 27ms/step - loss: 0.1958 - acc: 0.9470
Epoch 10/28

167/167 [==============================] - 5s 27ms/step - loss: 0.1798 - acc: 0.9523
Epoch 11/28

167/167 [==============================] - 4s 27ms/step - loss: 0.1618 - acc: 0.9604
Epoch 12/28

167/167 [==============================] - 5s 27ms/step - loss: 0.1507 - acc: 0.9634
Epoch 13/28

167/167 [==============================] - 5s 27ms/step - loss: 0.1367 - acc: 0.9648
Epoch 14/28

167/167 [==============================] - 5s 27ms/step - loss: 0.1311 - acc: 0.9683
Epoch 15/28

167/167 [==============================] - 5s 27ms/step - loss: 0.1212 - acc: 0.9689
Epoch 16/28

167/167 [==============================] - 4s 27ms/step - loss: 0.1168 - acc: 0.9720
Epoch 17/28

167/167 [==============================] - 5s 27ms/step - loss: 0.1012 - acc: 0.9747
Epoch 18/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0937 - acc: 0.9819
Epoch 19/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0908 - acc: 0.9780
Epoch 20/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0836 - acc: 0.9804
Epoch 21/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0789 - acc: 0.9799
Epoch 22/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0737 - acc: 0.9852
Epoch 23/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0711 - acc: 0.9853
Epoch 24/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0649 - acc: 0.9863
Epoch 25/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0586 - acc: 0.9874
Epoch 26/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0566 - acc: 0.9885
Epoch 27/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0552 - acc: 0.9883
Epoch 28/28

167/167 [==============================] - 5s 27ms/step - loss: 0.0552 - acc: 0.9875
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7702
False 1369
True percentage 0.84907948407
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.94      0.96      7318
      B-PER       0.70      0.50      0.59       438
      B-ORG       0.45      0.48      0.46       296
     B-MISC       0.38      0.18      0.25       141
      I-PER       0.65      0.50      0.56       214
      I-ORG       0.25      0.43      0.32       151
     I-MISC       0.55      0.19      0.28       154
      B-LOC       0.79      0.61      0.69       218
      I-LOC       0.66      0.64      0.65       141

avg / total       0.90      0.85      0.87      9071

F-1 Score (without O):
0.501239157373
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 13
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104210 unique words.
4206 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 271
OOV word occurences: in test 429
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6669504     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,781,634
Trainable params: 6,781,634
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

167/167 [==============================] - 6s 38ms/step - loss: 0.8126 - acc: 0.7544
Epoch 2/28

167/167 [==============================] - 5s 28ms/step - loss: 0.4299 - acc: 0.8613
Epoch 3/28

167/167 [==============================] - 5s 28ms/step - loss: 0.3747 - acc: 0.8799
Epoch 4/28

167/167 [==============================] - 5s 28ms/step - loss: 0.3197 - acc: 0.9029
Epoch 5/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2895 - acc: 0.9166
Epoch 6/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2558 - acc: 0.9278
Epoch 7/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2307 - acc: 0.9370
Epoch 8/28

167/167 [==============================] - 5s 28ms/step - loss: 0.2063 - acc: 0.9491
Epoch 9/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1974 - acc: 0.9438
Epoch 10/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1727 - acc: 0.9577
Epoch 11/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1567 - acc: 0.9603
Epoch 12/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1444 - acc: 0.9651
Epoch 13/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1297 - acc: 0.9703
Epoch 14/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1167 - acc: 0.9748
Epoch 15/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1141 - acc: 0.9746
Epoch 16/28

167/167 [==============================] - 5s 28ms/step - loss: 0.1063 - acc: 0.9752
Epoch 17/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0940 - acc: 0.9796
Epoch 18/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0878 - acc: 0.9808
Epoch 19/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0863 - acc: 0.9838
Epoch 20/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0797 - acc: 0.9818
Epoch 21/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0661 - acc: 0.9887
Epoch 22/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0647 - acc: 0.9880
Epoch 23/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0631 - acc: 0.9893
Epoch 24/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0557 - acc: 0.9920
Epoch 25/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0559 - acc: 0.9905
Epoch 26/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0516 - acc: 0.9911
Epoch 27/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0476 - acc: 0.9915
Epoch 28/28

167/167 [==============================] - 5s 28ms/step - loss: 0.0458 - acc: 0.9920
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7860
False 1211
True percentage 0.866497629809
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.78      0.65      0.71       438
          O       0.98      0.94      0.96      7318
      B-LOC       0.72      0.66      0.69       218
      I-LOC       0.67      0.59      0.63       141
     B-MISC       0.36      0.18      0.24       141
     I-MISC       0.39      0.25      0.30       154
      B-ORG       0.63      0.66      0.64       296
      I-ORG       0.23      0.40      0.29       151
      I-PER       0.78      0.57      0.65       214

avg / total       0.91      0.87      0.89      9071

F-1 Score (without O):
0.895931882687
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 11
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104122 unique words.
4118 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 280
OOV word occurences: in test 495
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6663872     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,776,002
Trainable params: 6,776,002
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 4s 48ms/step - loss: 1.2845 - acc: 0.6368
Epoch 2/28

83/83 [==============================] - 2s 28ms/step - loss: 0.5473 - acc: 0.8222
Epoch 3/28

83/83 [==============================] - 2s 27ms/step - loss: 0.4647 - acc: 0.8455
Epoch 4/28

83/83 [==============================] - 2s 29ms/step - loss: 0.4197 - acc: 0.8663
Epoch 5/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3806 - acc: 0.8772
Epoch 6/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3519 - acc: 0.8925
Epoch 7/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3284 - acc: 0.9017
Epoch 8/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3068 - acc: 0.9154
Epoch 9/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2848 - acc: 0.9137
Epoch 10/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2675 - acc: 0.9301
Epoch 11/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2481 - acc: 0.9334
Epoch 12/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2309 - acc: 0.9432
Epoch 13/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2194 - acc: 0.9441
Epoch 14/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2036 - acc: 0.9554
Epoch 15/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1952 - acc: 0.9585
Epoch 16/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1843 - acc: 0.9559
Epoch 17/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1727 - acc: 0.9624
Epoch 18/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1547 - acc: 0.9680
Epoch 19/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1606 - acc: 0.9668
Epoch 20/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1473 - acc: 0.9747
Epoch 21/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1339 - acc: 0.9801
Epoch 22/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1254 - acc: 0.9776
Epoch 23/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1130 - acc: 0.9828
Epoch 24/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1165 - acc: 0.9795
Epoch 25/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1138 - acc: 0.9829
Epoch 26/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0996 - acc: 0.9853
Epoch 27/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1028 - acc: 0.9841
Epoch 28/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0953 - acc: 0.9839
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7662
False 1409
True percentage 0.844669826921
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.94      0.95      7318
      B-ORG       0.52      0.43      0.47       296
      I-ORG       0.29      0.26      0.27       151
     B-MISC       0.20      0.13      0.16       141
      B-LOC       0.55      0.67      0.60       218
      B-PER       0.77      0.51      0.61       438
     I-MISC       0.39      0.33      0.36       154
      I-PER       0.64      0.48      0.55       214
      I-LOC       0.47      0.64      0.54       141

avg / total       0.89      0.84      0.86      9071

F-1 Score (without O):
0.486967187979
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104103 unique words.
4099 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 277
OOV word occurences: in test 557
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6662656     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,774,786
Trainable params: 6,774,786
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 4s 47ms/step - loss: 0.9009 - acc: 0.7567
Epoch 2/28

83/83 [==============================] - 2s 28ms/step - loss: 0.4539 - acc: 0.8647
Epoch 3/28

83/83 [==============================] - 2s 27ms/step - loss: 0.3660 - acc: 0.8905
Epoch 4/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3026 - acc: 0.9126
Epoch 5/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2767 - acc: 0.9194
Epoch 6/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2355 - acc: 0.9335
Epoch 7/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2217 - acc: 0.9435
Epoch 8/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1936 - acc: 0.9533
Epoch 9/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1803 - acc: 0.9577
Epoch 10/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1655 - acc: 0.9648
Epoch 11/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1496 - acc: 0.9632
Epoch 12/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1279 - acc: 0.9726
Epoch 13/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1268 - acc: 0.9733
Epoch 14/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1132 - acc: 0.9795
Epoch 15/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1146 - acc: 0.9795
Epoch 16/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1036 - acc: 0.9770
Epoch 17/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0927 - acc: 0.9828
Epoch 18/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0842 - acc: 0.9867
Epoch 19/28

83/83 [==============================] - 2s 29ms/step - loss: 0.0804 - acc: 0.9898
Epoch 20/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0774 - acc: 0.9867
Epoch 21/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0745 - acc: 0.9890
Epoch 22/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0664 - acc: 0.9886
Epoch 23/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0603 - acc: 0.9908
Epoch 24/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0598 - acc: 0.9906
Epoch 25/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0589 - acc: 0.9899
Epoch 26/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0504 - acc: 0.9926
Epoch 27/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0464 - acc: 0.9955
Epoch 28/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0478 - acc: 0.9935
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7623
False 1448
True percentage 0.840370411201
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.94      0.96      7318
      B-PER       0.67      0.43      0.53       438
      B-ORG       0.43      0.48      0.45       296
     B-MISC       0.38      0.17      0.24       141
      I-PER       0.86      0.41      0.55       214
      I-ORG       0.26      0.40      0.31       151
     I-MISC       0.33      0.17      0.22       154
      B-LOC       0.75      0.52      0.61       218
      I-LOC       0.52      0.57      0.55       141

avg / total       0.89      0.84      0.86      9071

F-1 Score (without O):
0.459287531807
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 13
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104128 unique words.
4124 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 279
OOV word occurences: in test 555
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6664256     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,776,386
Trainable params: 6,776,386
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 4s 47ms/step - loss: 1.4656 - acc: 0.6307
Epoch 2/28

83/83 [==============================] - 2s 28ms/step - loss: 0.5665 - acc: 0.8245
Epoch 3/28

83/83 [==============================] - 2s 28ms/step - loss: 0.4828 - acc: 0.8399
Epoch 4/28

83/83 [==============================] - 2s 28ms/step - loss: 0.4502 - acc: 0.8596
Epoch 5/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3838 - acc: 0.8840
Epoch 6/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3651 - acc: 0.8910
Epoch 7/28

83/83 [==============================] - 2s 27ms/step - loss: 0.3240 - acc: 0.9103
Epoch 8/28

83/83 [==============================] - 2s 27ms/step - loss: 0.3139 - acc: 0.9048
Epoch 9/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2920 - acc: 0.9121
Epoch 10/28

83/83 [==============================] - 2s 27ms/step - loss: 0.2679 - acc: 0.9357
Epoch 11/28

83/83 [==============================] - 2s 27ms/step - loss: 0.2566 - acc: 0.9306
Epoch 12/28

83/83 [==============================] - 2s 27ms/step - loss: 0.2298 - acc: 0.9393
Epoch 13/28

83/83 [==============================] - 2s 27ms/step - loss: 0.2214 - acc: 0.9464
Epoch 14/28

83/83 [==============================] - 2s 27ms/step - loss: 0.2136 - acc: 0.9467
Epoch 15/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1982 - acc: 0.9517
Epoch 16/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1837 - acc: 0.9583
Epoch 17/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1762 - acc: 0.9590
Epoch 18/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1688 - acc: 0.9667
Epoch 19/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1505 - acc: 0.9670
Epoch 20/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1455 - acc: 0.9694
Epoch 21/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1378 - acc: 0.9736
Epoch 22/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1272 - acc: 0.9770
Epoch 23/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1276 - acc: 0.9777
Epoch 24/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1207 - acc: 0.9755
Epoch 25/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1107 - acc: 0.9776
Epoch 26/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1081 - acc: 0.9815
Epoch 27/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1024 - acc: 0.9796
Epoch 28/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0955 - acc: 0.9824
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7502
False 1569
True percentage 0.827031198324
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.77      0.30      0.43       438
          O       0.95      0.95      0.95      7318
      B-LOC       0.66      0.56      0.61       218
      I-LOC       0.77      0.31      0.44       141
     B-MISC       0.10      0.03      0.04       141
     I-MISC       0.36      0.13      0.19       154
      B-ORG       0.45      0.40      0.42       296
      I-ORG       0.22      0.34      0.27       151
      I-PER       0.48      0.41      0.44       214

avg / total       0.86      0.83      0.84      9071

F-1 Score (without O):
0.868233492372
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 14
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104131 unique words.
4127 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 277
OOV word occurences: in test 531
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6664448     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,776,578
Trainable params: 6,776,578
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

83/83 [==============================] - 4s 47ms/step - loss: 1.1727 - acc: 0.6635
Epoch 2/28

83/83 [==============================] - 2s 28ms/step - loss: 0.5575 - acc: 0.8270
Epoch 3/28

83/83 [==============================] - 2s 27ms/step - loss: 0.4651 - acc: 0.8580
Epoch 4/28

83/83 [==============================] - 2s 28ms/step - loss: 0.4093 - acc: 0.8737
Epoch 5/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3552 - acc: 0.8996
Epoch 6/28

83/83 [==============================] - 2s 28ms/step - loss: 0.3327 - acc: 0.9098
Epoch 7/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2986 - acc: 0.9097
Epoch 8/28

83/83 [==============================] - 2s 27ms/step - loss: 0.2660 - acc: 0.9256
Epoch 9/28

83/83 [==============================] - 2s 29ms/step - loss: 0.2418 - acc: 0.9364
Epoch 10/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2401 - acc: 0.9298
Epoch 11/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2183 - acc: 0.9403
Epoch 12/28

83/83 [==============================] - 2s 28ms/step - loss: 0.2025 - acc: 0.9473
Epoch 13/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1873 - acc: 0.9538
Epoch 14/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1761 - acc: 0.9546
Epoch 15/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1659 - acc: 0.9629
Epoch 16/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1669 - acc: 0.9628
Epoch 17/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1607 - acc: 0.9567
Epoch 18/28

83/83 [==============================] - 2s 29ms/step - loss: 0.1428 - acc: 0.9608
Epoch 19/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1364 - acc: 0.9679
Epoch 20/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1278 - acc: 0.9738
Epoch 21/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1280 - acc: 0.9725
Epoch 22/28

83/83 [==============================] - 2s 27ms/step - loss: 0.1106 - acc: 0.9763
Epoch 23/28

83/83 [==============================] - 2s 28ms/step - loss: 0.1043 - acc: 0.9814
Epoch 24/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0991 - acc: 0.9817
Epoch 25/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0978 - acc: 0.9816
Epoch 26/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0901 - acc: 0.9832
Epoch 27/28

83/83 [==============================] - 2s 28ms/step - loss: 0.0885 - acc: 0.9842
Epoch 28/28

83/83 [==============================] - 2s 27ms/step - loss: 0.0802 - acc: 0.9878
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7655
False 1416
True percentage 0.84389813692
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.48      0.49      0.48       296
          O       0.97      0.95      0.96      7318
      B-LOC       0.73      0.52      0.61       218
      B-PER       0.73      0.46      0.56       438
      I-PER       0.65      0.33      0.44       214
     B-MISC       0.34      0.23      0.28       141
     I-MISC       0.45      0.40      0.42       154
      I-ORG       0.16      0.19      0.17       151
      I-LOC       0.53      0.44      0.48       141

avg / total       0.89      0.84      0.86      9071

F-1 Score (without O):
0.882854287897
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 11
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104074 unique words.
4070 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660800     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,930
Trainable params: 6,772,930
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 3s 77ms/step - loss: 1.5478 - acc: 0.4695
Epoch 2/28

33/33 [==============================] - 1s 29ms/step - loss: 0.7906 - acc: 0.7506
Epoch 3/28

33/33 [==============================] - 1s 30ms/step - loss: 0.6464 - acc: 0.7826
Epoch 4/28

33/33 [==============================] - 1s 30ms/step - loss: 0.5539 - acc: 0.8057
Epoch 5/28

33/33 [==============================] - 1s 30ms/step - loss: 0.5175 - acc: 0.8297
Epoch 6/28

33/33 [==============================] - 1s 30ms/step - loss: 0.5143 - acc: 0.8286
Epoch 7/28

33/33 [==============================] - 1s 30ms/step - loss: 0.4686 - acc: 0.8508
Epoch 8/28

33/33 [==============================] - 1s 30ms/step - loss: 0.4024 - acc: 0.8746
Epoch 9/28

33/33 [==============================] - 1s 29ms/step - loss: 0.3753 - acc: 0.8935
Epoch 10/28

33/33 [==============================] - 1s 30ms/step - loss: 0.3451 - acc: 0.9063
Epoch 11/28

33/33 [==============================] - 1s 30ms/step - loss: 0.3430 - acc: 0.8956
Epoch 12/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2947 - acc: 0.9286
Epoch 13/28

33/33 [==============================] - 1s 29ms/step - loss: 0.3214 - acc: 0.9023
Epoch 14/28

33/33 [==============================] - 1s 29ms/step - loss: 0.2654 - acc: 0.9491
Epoch 15/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2563 - acc: 0.9507
Epoch 16/28

33/33 [==============================] - 1s 29ms/step - loss: 0.2906 - acc: 0.9192
Epoch 17/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2377 - acc: 0.9438
Epoch 18/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2146 - acc: 0.9296
Epoch 19/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2085 - acc: 0.9510
Epoch 20/28

33/33 [==============================] - 1s 29ms/step - loss: 0.1862 - acc: 0.9600
Epoch 21/28

33/33 [==============================] - 1s 29ms/step - loss: 0.1851 - acc: 0.9641
Epoch 22/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1778 - acc: 0.9653
Epoch 23/28

33/33 [==============================] - 1s 29ms/step - loss: 0.1732 - acc: 0.9676
Epoch 24/28

33/33 [==============================] - 1s 29ms/step - loss: 0.1661 - acc: 0.9622
Epoch 25/28

33/33 [==============================] - 1s 29ms/step - loss: 0.1492 - acc: 0.9753
Epoch 26/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1506 - acc: 0.9621
Epoch 27/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1361 - acc: 0.9748
Epoch 28/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1417 - acc: 0.9754
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7300
False 1771
True percentage 0.804762429721
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.93      0.95      7318
      B-ORG       0.30      0.45      0.36       296
      I-ORG       0.14      0.36      0.20       151
     B-MISC       0.18      0.17      0.18       141
      B-LOC       0.68      0.34      0.46       218
      B-PER       0.62      0.27      0.37       438
     I-MISC       0.17      0.09      0.12       154
      I-PER       0.66      0.15      0.25       214
      I-LOC       0.69      0.13      0.22       141

avg / total       0.87      0.80      0.82      9071

F-1 Score (without O):
0.294896030246
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104064 unique words.
4060 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 280
OOV word occurences: in test 560
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660160     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,290
Trainable params: 6,772,290
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 3s 80ms/step - loss: 1.3756 - acc: 0.5874
Epoch 2/28

33/33 [==============================] - 1s 30ms/step - loss: 0.5203 - acc: 0.8528
Epoch 3/28

33/33 [==============================] - 1s 30ms/step - loss: 0.4866 - acc: 0.8725
Epoch 4/28

33/33 [==============================] - 1s 30ms/step - loss: 0.3632 - acc: 0.8839
Epoch 5/28

33/33 [==============================] - 1s 30ms/step - loss: 0.3263 - acc: 0.8946
Epoch 6/28

33/33 [==============================] - 1s 30ms/step - loss: 0.3302 - acc: 0.8927
Epoch 7/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2927 - acc: 0.9305
Epoch 8/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2847 - acc: 0.9329
Epoch 9/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2549 - acc: 0.9162
Epoch 10/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2343 - acc: 0.9371
Epoch 11/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2174 - acc: 0.9417
Epoch 12/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2182 - acc: 0.9414
Epoch 13/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2040 - acc: 0.9350
Epoch 14/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1937 - acc: 0.9414
Epoch 15/28

33/33 [==============================] - 1s 29ms/step - loss: 0.1959 - acc: 0.9396
Epoch 16/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1883 - acc: 0.9465
Epoch 17/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1688 - acc: 0.9654
Epoch 18/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1562 - acc: 0.9597
Epoch 19/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1479 - acc: 0.9524
Epoch 20/28

33/33 [==============================] - 1s 29ms/step - loss: 0.1488 - acc: 0.9609
Epoch 21/28

33/33 [==============================] - 1s 29ms/step - loss: 0.1405 - acc: 0.9677
Epoch 22/28

33/33 [==============================] - 1s 29ms/step - loss: 0.1239 - acc: 0.9839
Epoch 23/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1197 - acc: 0.9856
Epoch 24/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1162 - acc: 0.9885
Epoch 25/28

33/33 [==============================] - 1s 29ms/step - loss: 0.1225 - acc: 0.9746
Epoch 26/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1062 - acc: 0.9793
Epoch 27/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1041 - acc: 0.9860
Epoch 28/28

33/33 [==============================] - 1s 31ms/step - loss: 0.0959 - acc: 0.9842
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7313
False 1758
True percentage 0.806195568295
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.93      0.95      7318
      B-PER       0.57      0.46      0.51       438
      B-ORG       0.24      0.49      0.33       296
     B-MISC       0.18      0.11      0.14       141
      I-PER       0.67      0.31      0.42       214
      I-ORG       0.19      0.42      0.26       151
     I-MISC       0.31      0.10      0.15       154
      B-LOC       1.00      0.02      0.04       218
      I-LOC       0.00      0.00      0.00       141

avg / total       0.87      0.81      0.82      9071

F-1 Score (without O):
0.311696264544
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 13
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104071 unique words.
4067 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 566
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660608     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,772,738
Trainable params: 6,772,738
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 3s 79ms/step - loss: 1.4967 - acc: 0.4942
Epoch 2/28

33/33 [==============================] - 1s 30ms/step - loss: 0.6304 - acc: 0.8141
Epoch 3/28

33/33 [==============================] - 1s 30ms/step - loss: 0.4672 - acc: 0.8561
Epoch 4/28

33/33 [==============================] - 1s 30ms/step - loss: 0.4309 - acc: 0.8773
Epoch 5/28

33/33 [==============================] - 1s 29ms/step - loss: 0.3951 - acc: 0.8878
Epoch 6/28

33/33 [==============================] - 1s 30ms/step - loss: 0.3860 - acc: 0.8776
Epoch 7/28

33/33 [==============================] - 1s 30ms/step - loss: 0.3299 - acc: 0.9018
Epoch 8/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2988 - acc: 0.9149
Epoch 9/28

33/33 [==============================] - 1s 31ms/step - loss: 0.3379 - acc: 0.9144
Epoch 10/28

33/33 [==============================] - 1s 29ms/step - loss: 0.2724 - acc: 0.9468
Epoch 11/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2583 - acc: 0.9308
Epoch 12/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2581 - acc: 0.9313
Epoch 13/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2434 - acc: 0.9253
Epoch 14/28

33/33 [==============================] - 1s 29ms/step - loss: 0.2138 - acc: 0.9508
Epoch 15/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1996 - acc: 0.9613
Epoch 16/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1985 - acc: 0.9725
Epoch 17/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1953 - acc: 0.9639
Epoch 18/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1766 - acc: 0.9718
Epoch 19/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1801 - acc: 0.9527
Epoch 20/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1659 - acc: 0.9666
Epoch 21/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1555 - acc: 0.9640
Epoch 22/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1540 - acc: 0.9740
Epoch 23/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1360 - acc: 0.9763
Epoch 24/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1335 - acc: 0.9746
Epoch 25/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1287 - acc: 0.9820
Epoch 26/28

33/33 [==============================] - 1s 29ms/step - loss: 0.1153 - acc: 0.9859
Epoch 27/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1129 - acc: 0.9808
Epoch 28/28

33/33 [==============================] - 1s 31ms/step - loss: 0.1161 - acc: 0.9800
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7389
False 1682
True percentage 0.814573916878
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.57      0.31      0.40       438
          O       0.94      0.94      0.94      7318
      B-LOC       0.66      0.48      0.55       218
      I-LOC       0.53      0.28      0.37       141
     B-MISC       0.23      0.07      0.11       141
     I-MISC       0.39      0.09      0.15       154
      B-ORG       0.38      0.35      0.36       296
      I-ORG       0.13      0.14      0.13       151
      I-PER       0.33      0.34      0.34       214

avg / total       0.85      0.81      0.82      9071

F-1 Score (without O):
0.858292408733
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 14
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104077 unique words.
4073 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 280
OOV word occurences: in test 560
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6660992     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,773,122
Trainable params: 6,773,122
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

33/33 [==============================] - 3s 78ms/step - loss: 1.5744 - acc: 0.4889
Epoch 2/28

33/33 [==============================] - 1s 30ms/step - loss: 1.0307 - acc: 0.6847
Epoch 3/28

33/33 [==============================] - 1s 30ms/step - loss: 0.6747 - acc: 0.8121
Epoch 4/28

33/33 [==============================] - 1s 29ms/step - loss: 0.5668 - acc: 0.8136
Epoch 5/28

33/33 [==============================] - 1s 30ms/step - loss: 0.7070 - acc: 0.7996
Epoch 6/28

33/33 [==============================] - 1s 29ms/step - loss: 0.5140 - acc: 0.8255
Epoch 7/28

33/33 [==============================] - 1s 30ms/step - loss: 0.4553 - acc: 0.8542
Epoch 8/28

33/33 [==============================] - 1s 30ms/step - loss: 0.4504 - acc: 0.8489
Epoch 9/28

33/33 [==============================] - 1s 30ms/step - loss: 0.4188 - acc: 0.8646
Epoch 10/28

33/33 [==============================] - 1s 30ms/step - loss: 0.3962 - acc: 0.8879
Epoch 11/28

33/33 [==============================] - 1s 30ms/step - loss: 0.3660 - acc: 0.8748
Epoch 12/28

33/33 [==============================] - 1s 30ms/step - loss: 0.3646 - acc: 0.8880
Epoch 13/28

33/33 [==============================] - 1s 30ms/step - loss: 0.3321 - acc: 0.9055
Epoch 14/28

33/33 [==============================] - 1s 29ms/step - loss: 0.3077 - acc: 0.9200
Epoch 15/28

33/33 [==============================] - 1s 29ms/step - loss: 0.3024 - acc: 0.8986
Epoch 16/28

33/33 [==============================] - 1s 31ms/step - loss: 0.2823 - acc: 0.9110
Epoch 17/28

33/33 [==============================] - 1s 29ms/step - loss: 0.2833 - acc: 0.9109
Epoch 18/28

33/33 [==============================] - 1s 29ms/step - loss: 0.2626 - acc: 0.9153
Epoch 19/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2472 - acc: 0.9382
Epoch 20/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2295 - acc: 0.9567
Epoch 21/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2198 - acc: 0.9491
Epoch 22/28

33/33 [==============================] - 1s 30ms/step - loss: 0.2130 - acc: 0.9515
Epoch 23/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1956 - acc: 0.9625
Epoch 24/28

33/33 [==============================] - 1s 29ms/step - loss: 0.1953 - acc: 0.9645
Epoch 25/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1889 - acc: 0.9576
Epoch 26/28

33/33 [==============================] - 1s 29ms/step - loss: 0.1873 - acc: 0.9621
Epoch 27/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1688 - acc: 0.9787
Epoch 28/28

33/33 [==============================] - 1s 30ms/step - loss: 0.1532 - acc: 0.9778
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7455
False 1616
True percentage 0.821849851174
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.46      0.46      0.46       296
          O       0.94      0.95      0.95      7318
      B-LOC       0.79      0.37      0.50       218
      B-PER       0.85      0.28      0.42       438
      I-PER       0.62      0.28      0.38       214
     B-MISC       0.35      0.16      0.22       141
     I-MISC       0.22      0.21      0.21       154
      I-ORG       0.14      0.23      0.17       151
      I-LOC       0.00      0.00      0.00       141

avg / total       0.86      0.82      0.83      9071

F-1 Score (without O):
0.861447910536
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 11
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104057 unique words.
4053 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659712     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,842
Trainable params: 6,771,842
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 2s 125ms/step - loss: 2.4658 - acc: 0.0948
Epoch 2/28

16/16 [==============================] - 0s 27ms/step - loss: 1.0238 - acc: 0.7737
Epoch 3/28

16/16 [==============================] - 0s 26ms/step - loss: 0.7530 - acc: 0.7737
Epoch 4/28

16/16 [==============================] - 0s 27ms/step - loss: 0.7207 - acc: 0.8226
Epoch 5/28

16/16 [==============================] - 0s 26ms/step - loss: 0.7201 - acc: 0.7706
Epoch 6/28

16/16 [==============================] - 0s 26ms/step - loss: 0.5804 - acc: 0.8440
Epoch 7/28

16/16 [==============================] - 0s 27ms/step - loss: 0.4867 - acc: 0.8502
Epoch 8/28

16/16 [==============================] - 0s 27ms/step - loss: 0.4246 - acc: 0.8899
Epoch 9/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3785 - acc: 0.8899
Epoch 10/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3288 - acc: 0.9205
Epoch 11/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3218 - acc: 0.9083
Epoch 12/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2857 - acc: 0.9450
Epoch 13/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2793 - acc: 0.9358
Epoch 14/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2748 - acc: 0.9388
Epoch 15/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2371 - acc: 0.9450
Epoch 16/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2246 - acc: 0.9602
Epoch 17/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2007 - acc: 0.9725
Epoch 18/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1897 - acc: 0.9633
Epoch 19/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1870 - acc: 0.9664
Epoch 20/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1676 - acc: 0.9817
Epoch 21/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1638 - acc: 0.9664
Epoch 22/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1441 - acc: 0.9786
Epoch 23/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1511 - acc: 0.9817
Epoch 24/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1360 - acc: 0.9908
Epoch 25/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1223 - acc: 0.9908
Epoch 26/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1136 - acc: 0.9908
Epoch 27/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1055 - acc: 0.9969
Epoch 28/28

16/16 [==============================] - 0s 26ms/step - loss: 0.0959 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7212
False 1859
True percentage 0.795061183993
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.93      0.95      7318
      B-ORG       0.23      0.25      0.24       296
      I-ORG       0.16      0.45      0.23       151
     B-MISC       0.22      0.04      0.06       141
      B-LOC       0.73      0.11      0.19       218
      B-PER       0.40      0.38      0.39       438
     I-MISC       0.50      0.02      0.04       154
      I-PER       0.31      0.22      0.26       214
      I-LOC       0.00      0.00      0.00       141

avg / total       0.84      0.80      0.81      9071

F-1 Score (without O):
0.247219574198
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 8 unique labels.
Found 104049 unique words.
4045 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 564
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659200     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,180
Trainable params: 6,771,180
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 2s 127ms/step - loss: 2.6316 - acc: 0.0546
Epoch 2/28

16/16 [==============================] - 0s 27ms/step - loss: 0.9735 - acc: 0.8259
Epoch 3/28

16/16 [==============================] - 0s 27ms/step - loss: 0.6697 - acc: 0.8328
Epoch 4/28

16/16 [==============================] - 0s 27ms/step - loss: 0.6496 - acc: 0.8430
Epoch 5/28

16/16 [==============================] - 0s 27ms/step - loss: 0.6247 - acc: 0.8328
Epoch 6/28

16/16 [==============================] - 0s 28ms/step - loss: 0.4813 - acc: 0.8601
Epoch 7/28

16/16 [==============================] - 0s 28ms/step - loss: 0.4326 - acc: 0.8362
Epoch 8/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3940 - acc: 0.8703
Epoch 9/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3628 - acc: 0.8737
Epoch 10/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3248 - acc: 0.9010
Epoch 11/28

16/16 [==============================] - 0s 28ms/step - loss: 0.3111 - acc: 0.9044
Epoch 12/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2937 - acc: 0.9147
Epoch 13/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2534 - acc: 0.9317
Epoch 14/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2413 - acc: 0.9420
Epoch 15/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2160 - acc: 0.9386
Epoch 16/28

16/16 [==============================] - 0s 29ms/step - loss: 0.2063 - acc: 0.9488
Epoch 17/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1821 - acc: 0.9659
Epoch 18/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1837 - acc: 0.9488
Epoch 19/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1744 - acc: 0.9590
Epoch 20/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1433 - acc: 0.9556
Epoch 21/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1454 - acc: 0.9761
Epoch 22/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1419 - acc: 0.9693
Epoch 23/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1260 - acc: 0.9761
Epoch 24/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1187 - acc: 0.9693
Epoch 25/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1172 - acc: 0.9863
Epoch 26/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1029 - acc: 0.9898
Epoch 27/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1021 - acc: 0.9795
Epoch 28/28

16/16 [==============================] - 0s 29ms/step - loss: 0.0982 - acc: 0.9863
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7259
False 1671
True percentage 0.81287793953
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.90      0.95      0.93      7318
      B-PER       0.39      0.26      0.31       438
      B-ORG       0.30      0.35      0.33       296
     B-MISC       0.00      0.00      0.00       141
      I-PER       0.41      0.31      0.35       214
      I-ORG       0.71      0.03      0.06       151
     I-MISC       0.00      0.00      0.00       154
      B-LOC       1.00      0.01      0.02       218

avg / total       0.82      0.81      0.80      8930

F-1 Score (without O):
0.241193535019
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 13
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104057 unique words.
4053 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 282
OOV word occurences: in test 566
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659712     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,842
Trainable params: 6,771,842
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 2s 127ms/step - loss: 3.1817 - acc: 0.0239
Epoch 2/28

16/16 [==============================] - 0s 26ms/step - loss: 1.2199 - acc: 0.7373
Epoch 3/28

16/16 [==============================] - 0s 26ms/step - loss: 0.9964 - acc: 0.7701
Epoch 4/28

16/16 [==============================] - 0s 26ms/step - loss: 0.9768 - acc: 0.7910
Epoch 5/28

16/16 [==============================] - 0s 27ms/step - loss: 0.8308 - acc: 0.7701
Epoch 6/28

16/16 [==============================] - 0s 26ms/step - loss: 0.6648 - acc: 0.8119
Epoch 7/28

16/16 [==============================] - 0s 26ms/step - loss: 0.6051 - acc: 0.7970
Epoch 8/28

16/16 [==============================] - 0s 26ms/step - loss: 0.5481 - acc: 0.8239
Epoch 9/28

16/16 [==============================] - 0s 26ms/step - loss: 0.5037 - acc: 0.8090
Epoch 10/28

16/16 [==============================] - 0s 26ms/step - loss: 0.4631 - acc: 0.8716
Epoch 11/28

16/16 [==============================] - 0s 27ms/step - loss: 0.4395 - acc: 0.8716
Epoch 12/28

16/16 [==============================] - 0s 27ms/step - loss: 0.4159 - acc: 0.9104
Epoch 13/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3776 - acc: 0.8716
Epoch 14/28

16/16 [==============================] - 0s 26ms/step - loss: 0.3649 - acc: 0.9224
Epoch 15/28

16/16 [==============================] - 0s 26ms/step - loss: 0.3543 - acc: 0.8985
Epoch 16/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3201 - acc: 0.9254
Epoch 17/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3054 - acc: 0.9493
Epoch 18/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2866 - acc: 0.9403
Epoch 19/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2819 - acc: 0.9701
Epoch 20/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2677 - acc: 0.9433
Epoch 21/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2475 - acc: 0.9672
Epoch 22/28

16/16 [==============================] - 0s 26ms/step - loss: 0.2173 - acc: 0.9701
Epoch 23/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2131 - acc: 0.9731
Epoch 24/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1973 - acc: 0.9761
Epoch 25/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1903 - acc: 0.9731
Epoch 26/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1922 - acc: 0.9731
Epoch 27/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1789 - acc: 0.9701
Epoch 28/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1723 - acc: 0.9761
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7325
False 1746
True percentage 0.807518465439
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.48      0.35      0.41       438
          O       0.94      0.93      0.94      7318
      B-LOC       0.43      0.42      0.42       218
      I-LOC       0.46      0.43      0.45       141
     B-MISC       0.16      0.09      0.12       141
     I-MISC       0.20      0.10      0.14       154
      B-ORG       0.49      0.31      0.38       296
      I-ORG       0.19      0.10      0.13       151
      I-PER       0.34      0.24      0.28       214

avg / total       0.83      0.81      0.82      9071

F-1 Score (without O):
0.852657866572
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 14
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104052 unique words.
4048 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 565
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659392     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,522
Trainable params: 6,771,522
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

16/16 [==============================] - 2s 126ms/step - loss: 3.2650 - acc: 0.0197
Epoch 2/28

16/16 [==============================] - 0s 27ms/step - loss: 1.2954 - acc: 0.7803
Epoch 3/28

16/16 [==============================] - 0s 28ms/step - loss: 0.7572 - acc: 0.7770
Epoch 4/28

16/16 [==============================] - 0s 28ms/step - loss: 0.7303 - acc: 0.8066
Epoch 5/28

16/16 [==============================] - 0s 26ms/step - loss: 0.6399 - acc: 0.7902
Epoch 6/28

16/16 [==============================] - 0s 28ms/step - loss: 0.5267 - acc: 0.8557
Epoch 7/28

16/16 [==============================] - 0s 28ms/step - loss: 0.4675 - acc: 0.8623
Epoch 8/28

16/16 [==============================] - 0s 27ms/step - loss: 0.4218 - acc: 0.8525
Epoch 9/28

16/16 [==============================] - 0s 28ms/step - loss: 0.4090 - acc: 0.8656
Epoch 10/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3659 - acc: 0.8852
Epoch 11/28

16/16 [==============================] - 0s 26ms/step - loss: 0.3591 - acc: 0.8984
Epoch 12/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3264 - acc: 0.9279
Epoch 13/28

16/16 [==============================] - 0s 27ms/step - loss: 0.3206 - acc: 0.9148
Epoch 14/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2760 - acc: 0.9279
Epoch 15/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2799 - acc: 0.9279
Epoch 16/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2632 - acc: 0.9443
Epoch 17/28

16/16 [==============================] - 0s 27ms/step - loss: 0.2416 - acc: 0.9377
Epoch 18/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2320 - acc: 0.9508
Epoch 19/28

16/16 [==============================] - 0s 28ms/step - loss: 0.2099 - acc: 0.9574
Epoch 20/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1927 - acc: 0.9770
Epoch 21/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1892 - acc: 0.9738
Epoch 22/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1776 - acc: 0.9738
Epoch 23/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1720 - acc: 0.9869
Epoch 24/28

16/16 [==============================] - 0s 29ms/step - loss: 0.1785 - acc: 0.9738
Epoch 25/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1669 - acc: 0.9738
Epoch 26/28

16/16 [==============================] - 0s 26ms/step - loss: 0.1502 - acc: 0.9902
Epoch 27/28

16/16 [==============================] - 0s 27ms/step - loss: 0.1327 - acc: 0.9836
Epoch 28/28

16/16 [==============================] - 0s 28ms/step - loss: 0.1367 - acc: 0.9869
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7185
False 1886
True percentage 0.792084665417
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.28      0.30      0.29       296
          O       0.94      0.94      0.94      7318
      B-LOC       0.45      0.12      0.19       218
      B-PER       0.73      0.06      0.11       438
      I-PER       0.44      0.22      0.30       214
     B-MISC       0.20      0.23      0.21       141
     I-MISC       0.17      0.55      0.26       154
      I-ORG       0.22      0.06      0.09       151
      I-LOC       0.00      0.00      0.00       141

avg / total       0.84      0.79      0.79      9071

F-1 Score (without O):
0.836762365148
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 11
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104043 unique words.
4039 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658816     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,946
Trainable params: 6,770,946
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 2s 233ms/step - loss: 2.3930 - acc: 0.0674
Epoch 2/28

8/8 [==============================] - 0s 32ms/step - loss: 1.0447 - acc: 0.7978
Epoch 3/28

8/8 [==============================] - 0s 33ms/step - loss: 0.6645 - acc: 0.8090
Epoch 4/28

8/8 [==============================] - 0s 33ms/step - loss: 0.6373 - acc: 0.8596
Epoch 5/28

8/8 [==============================] - 0s 34ms/step - loss: 0.7098 - acc: 0.8090
Epoch 6/28

8/8 [==============================] - 0s 33ms/step - loss: 0.5064 - acc: 0.8876
Epoch 7/28

8/8 [==============================] - 0s 33ms/step - loss: 0.4295 - acc: 0.8371
Epoch 8/28

8/8 [==============================] - 0s 33ms/step - loss: 0.3492 - acc: 0.9326
Epoch 9/28

8/8 [==============================] - 0s 31ms/step - loss: 0.3104 - acc: 0.9213
Epoch 10/28

8/8 [==============================] - 0s 31ms/step - loss: 0.2967 - acc: 0.9382
Epoch 11/28

8/8 [==============================] - 0s 32ms/step - loss: 0.2649 - acc: 0.9494
Epoch 12/28

8/8 [==============================] - 0s 32ms/step - loss: 0.2417 - acc: 0.9551
Epoch 13/28

8/8 [==============================] - 0s 31ms/step - loss: 0.2042 - acc: 0.9607
Epoch 14/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1910 - acc: 0.9663
Epoch 15/28

8/8 [==============================] - 0s 31ms/step - loss: 0.1743 - acc: 0.9719
Epoch 16/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1744 - acc: 0.9775
Epoch 17/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1443 - acc: 0.9775
Epoch 18/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1534 - acc: 0.9663
Epoch 19/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1525 - acc: 0.9607
Epoch 20/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1235 - acc: 0.9888
Epoch 21/28

8/8 [==============================] - 0s 31ms/step - loss: 0.1049 - acc: 0.9831
Epoch 22/28

8/8 [==============================] - 0s 31ms/step - loss: 0.1227 - acc: 0.9944
Epoch 23/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1114 - acc: 0.9775
Epoch 24/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0973 - acc: 1.0000
Epoch 25/28

8/8 [==============================] - 0s 31ms/step - loss: 0.0872 - acc: 0.9944
Epoch 26/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0769 - acc: 0.9944
Epoch 27/28

8/8 [==============================] - 0s 32ms/step - loss: 0.0878 - acc: 0.9888
Epoch 28/28

8/8 [==============================] - 0s 32ms/step - loss: 0.0789 - acc: 0.9944
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7109
False 1962
True percentage 0.783706316834
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.93      0.94      7318
      B-ORG       0.23      0.37      0.28       296
      I-ORG       0.16      0.62      0.25       151
     B-MISC       0.07      0.01      0.01       141
      B-LOC       0.51      0.23      0.32       218
      B-PER       0.56      0.16      0.25       438
     I-MISC       0.00      0.00      0.00       154
      I-PER       0.29      0.05      0.08       214
      I-LOC       0.00      0.00      0.00       141

avg / total       0.82      0.78      0.79      9071

F-1 Score (without O):
0.216111290844
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 12
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 8 unique labels.
Found 104041 unique words.
4037 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 567
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658688     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,668
Trainable params: 6,770,668
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 2s 232ms/step - loss: 2.4592 - acc: 0.0604
Epoch 2/28

8/8 [==============================] - 0s 33ms/step - loss: 0.7605 - acc: 0.8658
Epoch 3/28

8/8 [==============================] - 0s 33ms/step - loss: 0.4534 - acc: 0.8658
Epoch 4/28

8/8 [==============================] - 0s 34ms/step - loss: 0.3558 - acc: 0.8993
Epoch 5/28

8/8 [==============================] - 0s 32ms/step - loss: 0.3080 - acc: 0.8859
Epoch 6/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2838 - acc: 0.9664
Epoch 7/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2430 - acc: 0.8993
Epoch 8/28

8/8 [==============================] - 0s 32ms/step - loss: 0.2223 - acc: 0.9732
Epoch 9/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1923 - acc: 0.9463
Epoch 10/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1633 - acc: 0.9732
Epoch 11/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1428 - acc: 0.9664
Epoch 12/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1212 - acc: 1.0000
Epoch 13/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1269 - acc: 0.9664
Epoch 14/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1170 - acc: 0.9933
Epoch 15/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1094 - acc: 0.9933
Epoch 16/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0933 - acc: 0.9933
Epoch 17/28

8/8 [==============================] - 0s 32ms/step - loss: 0.0871 - acc: 0.9933
Epoch 18/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0990 - acc: 0.9933
Epoch 19/28

8/8 [==============================] - 0s 34ms/step - loss: 0.0803 - acc: 0.9933
Epoch 20/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0896 - acc: 0.9866
Epoch 21/28

8/8 [==============================] - 0s 32ms/step - loss: 0.0679 - acc: 1.0000
Epoch 22/28

8/8 [==============================] - 0s 32ms/step - loss: 0.0586 - acc: 1.0000
Epoch 23/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0598 - acc: 0.9933
Epoch 24/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0608 - acc: 0.9933
Epoch 25/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0523 - acc: 1.0000
Epoch 26/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0476 - acc: 1.0000
Epoch 27/28

8/8 [==============================] - 0s 32ms/step - loss: 0.0479 - acc: 1.0000
Epoch 28/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0432 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7118
False 1812
True percentage 0.797088465845
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.92      0.94      0.93      7318
      B-PER       0.26      0.23      0.25       438
      B-ORG       0.21      0.28      0.24       296
     B-MISC       0.00      0.00      0.00       141
      I-PER       0.17      0.13      0.15       214
      I-ORG       0.00      0.00      0.00       151
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.65      0.15      0.24       218

avg / total       0.79      0.80      0.79      8930

F-1 Score (without O):
0.185708826901
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 13
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 9 unique labels.
Found 104046 unique words.
4042 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 283
OOV word occurences: in test 567
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6659008     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,771,138
Trainable params: 6,771,138
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 2s 230ms/step - loss: 2.3270 - acc: 0.2063
Epoch 2/28

8/8 [==============================] - 0s 32ms/step - loss: 0.7763 - acc: 0.8201
Epoch 3/28

8/8 [==============================] - 0s 33ms/step - loss: 0.5839 - acc: 0.8148
Epoch 4/28

8/8 [==============================] - 0s 33ms/step - loss: 0.5220 - acc: 0.8889
Epoch 5/28

8/8 [==============================] - 0s 33ms/step - loss: 0.4834 - acc: 0.8201
Epoch 6/28

8/8 [==============================] - 0s 32ms/step - loss: 0.4537 - acc: 0.8889
Epoch 7/28

8/8 [==============================] - 0s 33ms/step - loss: 0.3635 - acc: 0.8783
Epoch 8/28

8/8 [==============================] - 0s 32ms/step - loss: 0.3320 - acc: 0.9312
Epoch 9/28

8/8 [==============================] - 0s 33ms/step - loss: 0.3159 - acc: 0.9153
Epoch 10/28

8/8 [==============================] - 0s 32ms/step - loss: 0.2788 - acc: 0.9259
Epoch 11/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2484 - acc: 0.9365
Epoch 12/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2471 - acc: 0.9365
Epoch 13/28

8/8 [==============================] - 0s 32ms/step - loss: 0.2373 - acc: 0.9418
Epoch 14/28

8/8 [==============================] - 0s 31ms/step - loss: 0.2065 - acc: 0.9524
Epoch 15/28

8/8 [==============================] - 0s 32ms/step - loss: 0.2077 - acc: 0.9630
Epoch 16/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1820 - acc: 0.9577
Epoch 17/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1517 - acc: 0.9735
Epoch 18/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1404 - acc: 0.9788
Epoch 19/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1657 - acc: 0.9788
Epoch 20/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1356 - acc: 0.9894
Epoch 21/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1311 - acc: 0.9735
Epoch 22/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1169 - acc: 0.9947
Epoch 23/28

8/8 [==============================] - 0s 31ms/step - loss: 0.1012 - acc: 0.9841
Epoch 24/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1124 - acc: 0.9841
Epoch 25/28

8/8 [==============================] - 0s 32ms/step - loss: 0.0982 - acc: 0.9947
Epoch 26/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0988 - acc: 0.9947
Epoch 27/28

8/8 [==============================] - 0s 32ms/step - loss: 0.0780 - acc: 0.9894
Epoch 28/28

8/8 [==============================] - 0s 32ms/step - loss: 0.0794 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7190
False 1881
True percentage 0.792635872561
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.35      0.22      0.27       438
          O       0.90      0.94      0.92      7318
      B-LOC       0.34      0.43      0.38       218
      I-LOC       0.37      0.53      0.44       141
     B-MISC       0.16      0.04      0.07       141
     I-MISC       0.00      0.00      0.00       154
      B-ORG       0.41      0.12      0.19       296
      I-ORG       0.20      0.01      0.01       151
      I-PER       0.17      0.01      0.03       214

avg / total       0.78      0.79      0.78      9071

F-1 Score (without O):
0.841337602277
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 14
Found 100004 word vectors.
Found 84 char vectors.
Found 104036 unique words.
Found 181 unique chars.
Found 8 unique labels.
Found 104043 unique words.
4039 unique words not found in embedding.
97 unique chars not found in embedding.
Number of train OOV: 0
OOV word occurences in train: 0
Number of test OOV: 284
OOV word occurences: in test 568
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       11648       input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6658816     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,770,796
Trainable params: 6,770,796
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/28

8/8 [==============================] - 2s 231ms/step - loss: 2.3850 - acc: 0.0753
Epoch 2/28

8/8 [==============================] - 0s 33ms/step - loss: 1.1469 - acc: 0.7740
Epoch 3/28

8/8 [==============================] - 0s 33ms/step - loss: 0.6898 - acc: 0.8151
Epoch 4/28

8/8 [==============================] - 0s 31ms/step - loss: 0.5948 - acc: 0.8082
Epoch 5/28

8/8 [==============================] - 0s 33ms/step - loss: 0.6571 - acc: 0.8836
Epoch 6/28

8/8 [==============================] - 0s 35ms/step - loss: 0.4903 - acc: 0.8151
Epoch 7/28

8/8 [==============================] - 0s 33ms/step - loss: 0.3907 - acc: 0.9178
Epoch 8/28

8/8 [==============================] - 0s 33ms/step - loss: 0.3422 - acc: 0.8904
Epoch 9/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2904 - acc: 0.9247
Epoch 10/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2677 - acc: 0.9452
Epoch 11/28

8/8 [==============================] - 0s 32ms/step - loss: 0.2552 - acc: 0.9315
Epoch 12/28

8/8 [==============================] - 0s 33ms/step - loss: 0.2268 - acc: 0.9521
Epoch 13/28

8/8 [==============================] - 0s 32ms/step - loss: 0.2046 - acc: 0.9658
Epoch 14/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1945 - acc: 0.9658
Epoch 15/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1843 - acc: 0.9863
Epoch 16/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1486 - acc: 0.9795
Epoch 17/28

8/8 [==============================] - 0s 31ms/step - loss: 0.1501 - acc: 0.9863
Epoch 18/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1464 - acc: 0.9726
Epoch 19/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1161 - acc: 0.9932
Epoch 20/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1233 - acc: 0.9795
Epoch 21/28

8/8 [==============================] - 0s 33ms/step - loss: 0.1252 - acc: 0.9863
Epoch 22/28

8/8 [==============================] - 0s 32ms/step - loss: 0.1194 - acc: 0.9658
Epoch 23/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1059 - acc: 0.9863
Epoch 24/28

8/8 [==============================] - 0s 34ms/step - loss: 0.1004 - acc: 0.9795
Epoch 25/28

8/8 [==============================] - 0s 33ms/step - loss: 0.0923 - acc: 0.9863
Epoch 26/28

8/8 [==============================] - 0s 32ms/step - loss: 0.0807 - acc: 1.0000
Epoch 27/28

8/8 [==============================] - 0s 32ms/step - loss: 0.0819 - acc: 0.9932
Epoch 28/28

8/8 [==============================] - 0s 31ms/step - loss: 0.0730 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7185
False 1745
True percentage 0.804591265398
Sklearn evaluation:
             precision    recall  f1-score   support

      B-ORG       0.25      0.32      0.28       296
          O       0.94      0.93      0.93      7318
      B-LOC       0.47      0.17      0.25       218
      B-PER       0.29      0.22      0.25       438
      I-PER       0.37      0.39      0.38       214
     B-MISC       0.25      0.17      0.20       141
     I-MISC       0.27      0.24      0.26       154
      I-ORG       1.00      0.01      0.01       151

avg / total       0.84      0.80      0.81      8930

F-1 Score (without O):
0.846332875813
