Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 1674 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 237
OOV word occurences: 324
Padding...
Data padded!
Padding...
Data padded!
Padded until 83 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,992,194
Trainable params: 6,992,194
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1506 samples, validate on 168 samples
Epoch 1/70

  32/1506 [..............................] - ETA: 2:09 - loss: 2.1841 - acc: 0.1944
  64/1506 [>.............................] - ETA: 1:18 - loss: 1.5952 - acc: 0.4921
  96/1506 [>.............................] - ETA: 1:00 - loss: 1.7646 - acc: 0.6022
 128/1506 [=>............................] - ETA: 51s - loss: 1.5805 - acc: 0.6582 
 160/1506 [==>...........................] - ETA: 45s - loss: 1.3963 - acc: 0.6960
 192/1506 [==>...........................] - ETA: 41s - loss: 1.3156 - acc: 0.7085
 224/1506 [===>..........................] - ETA: 38s - loss: 1.2313 - acc: 0.7229
 256/1506 [====>.........................] - ETA: 36s - loss: 1.1542 - acc: 0.7383
 288/1506 [====>.........................] - ETA: 34s - loss: 1.1028 - acc: 0.7457
 320/1506 [=====>........................] - ETA: 32s - loss: 1.0611 - acc: 0.7517
 352/1506 [======>.......................] - ETA: 30s - loss: 1.0220 - acc: 0.7565
 384/1506 [======>.......................] - ETA: 29s - loss: 0.9943 - acc: 0.7592
 416/1506 [=======>......................] - ETA: 27s - loss: 0.9657 - acc: 0.7637
 448/1506 [=======>......................] - ETA: 26s - loss: 0.9373 - acc: 0.7674
 480/1506 [========>.....................] - ETA: 25s - loss: 0.9126 - acc: 0.7719
 512/1506 [=========>....................] - ETA: 24s - loss: 0.8933 - acc: 0.7744
 544/1506 [=========>....................] - ETA: 23s - loss: 0.8739 - acc: 0.7778
 576/1506 [==========>...................] - ETA: 22s - loss: 0.8529 - acc: 0.7813
 608/1506 [===========>..................] - ETA: 21s - loss: 0.8339 - acc: 0.7846
 640/1506 [===========>..................] - ETA: 20s - loss: 0.8161 - acc: 0.7879
 672/1506 [============>.................] - ETA: 19s - loss: 0.7932 - acc: 0.7937
 704/1506 [=============>................] - ETA: 18s - loss: 0.7831 - acc: 0.7947
 736/1506 [=============>................] - ETA: 17s - loss: 0.7803 - acc: 0.7961
 768/1506 [==============>...............] - ETA: 16s - loss: 0.7676 - acc: 0.7988
 800/1506 [==============>...............] - ETA: 15s - loss: 0.7566 - acc: 0.8007
 832/1506 [===============>..............] - ETA: 15s - loss: 0.7456 - acc: 0.8032
 864/1506 [================>.............] - ETA: 14s - loss: 0.7335 - acc: 0.8055
 896/1506 [================>.............] - ETA: 13s - loss: 0.7233 - acc: 0.8077
 928/1506 [=================>............] - ETA: 12s - loss: 0.7119 - acc: 0.8098
 960/1506 [==================>...........] - ETA: 12s - loss: 0.7050 - acc: 0.8107
 992/1506 [==================>...........] - ETA: 11s - loss: 0.6941 - acc: 0.8132
1024/1506 [===================>..........] - ETA: 10s - loss: 0.6839 - acc: 0.8154
1056/1506 [====================>.........] - ETA: 9s - loss: 0.6741 - acc: 0.8174 
1088/1506 [====================>.........] - ETA: 9s - loss: 0.6647 - acc: 0.8195
1120/1506 [=====================>........] - ETA: 8s - loss: 0.6560 - acc: 0.8216
1152/1506 [=====================>........] - ETA: 7s - loss: 0.6499 - acc: 0.8227
1184/1506 [======================>.......] - ETA: 6s - loss: 0.6434 - acc: 0.8240
1216/1506 [=======================>......] - ETA: 6s - loss: 0.6374 - acc: 0.8248
1248/1506 [=======================>......] - ETA: 5s - loss: 0.6288 - acc: 0.8271
1280/1506 [========================>.....] - ETA: 4s - loss: 0.6235 - acc: 0.8281
1312/1506 [=========================>....] - ETA: 4s - loss: 0.6161 - acc: 0.8298
1344/1506 [=========================>....] - ETA: 3s - loss: 0.6070 - acc: 0.8323
1376/1506 [==========================>...] - ETA: 2s - loss: 0.6011 - acc: 0.8335
1408/1506 [===========================>..] - ETA: 2s - loss: 0.5933 - acc: 0.8356
1440/1506 [===========================>..] - ETA: 1s - loss: 0.5877 - acc: 0.8366
1472/1506 [============================>.] - ETA: 0s - loss: 0.5808 - acc: 0.8385
1504/1506 [============================>.] - ETA: 0s - loss: 0.5759 - acc: 0.8399
1506/1506 [==============================] - 33s 22ms/step - loss: 0.5755 - acc: 0.8400 - val_loss: 0.4031 - val_acc: 0.8779
Epoch 2/70

  32/1506 [..............................] - ETA: 27s - loss: 0.4179 - acc: 0.8632
  64/1506 [>.............................] - ETA: 27s - loss: 0.3959 - acc: 0.8686
  96/1506 [>.............................] - ETA: 26s - loss: 0.3656 - acc: 0.8812
 128/1506 [=>............................] - ETA: 26s - loss: 0.3607 - acc: 0.8829
 160/1506 [==>...........................] - ETA: 25s - loss: 0.3417 - acc: 0.8916
 192/1506 [==>...........................] - ETA: 24s - loss: 0.3367 - acc: 0.8925
 224/1506 [===>..........................] - ETA: 24s - loss: 0.3450 - acc: 0.8893
 256/1506 [====>.........................] - ETA: 23s - loss: 0.3403 - acc: 0.8914
 288/1506 [====>.........................] - ETA: 23s - loss: 0.3284 - acc: 0.8955
 320/1506 [=====>........................] - ETA: 22s - loss: 0.3362 - acc: 0.8947
 352/1506 [======>.......................] - ETA: 21s - loss: 0.3312 - acc: 0.8973
 384/1506 [======>.......................] - ETA: 21s - loss: 0.3277 - acc: 0.8980
 416/1506 [=======>......................] - ETA: 20s - loss: 0.3303 - acc: 0.8971
 448/1506 [=======>......................] - ETA: 19s - loss: 0.3247 - acc: 0.8984
 480/1506 [========>.....................] - ETA: 19s - loss: 0.3195 - acc: 0.9001
 512/1506 [=========>....................] - ETA: 18s - loss: 0.3179 - acc: 0.9010
 544/1506 [=========>....................] - ETA: 18s - loss: 0.3156 - acc: 0.9012
 576/1506 [==========>...................] - ETA: 17s - loss: 0.3136 - acc: 0.9020
 608/1506 [===========>..................] - ETA: 16s - loss: 0.3099 - acc: 0.9034
 640/1506 [===========>..................] - ETA: 16s - loss: 0.3125 - acc: 0.9029
 672/1506 [============>.................] - ETA: 15s - loss: 0.3100 - acc: 0.9033
 704/1506 [=============>................] - ETA: 15s - loss: 0.3071 - acc: 0.9051
 736/1506 [=============>................] - ETA: 14s - loss: 0.3039 - acc: 0.9063
 768/1506 [==============>...............] - ETA: 13s - loss: 0.3019 - acc: 0.9071
 800/1506 [==============>...............] - ETA: 13s - loss: 0.3020 - acc: 0.9066
 832/1506 [===============>..............] - ETA: 12s - loss: 0.3054 - acc: 0.9055
 864/1506 [================>.............] - ETA: 12s - loss: 0.3038 - acc: 0.9058
 896/1506 [================>.............] - ETA: 11s - loss: 0.2997 - acc: 0.9069
 928/1506 [=================>............] - ETA: 10s - loss: 0.2990 - acc: 0.9068
 960/1506 [==================>...........] - ETA: 10s - loss: 0.2965 - acc: 0.9078
 992/1506 [==================>...........] - ETA: 9s - loss: 0.2956 - acc: 0.9080 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.2944 - acc: 0.9088
1056/1506 [====================>.........] - ETA: 8s - loss: 0.2918 - acc: 0.9098
1088/1506 [====================>.........] - ETA: 7s - loss: 0.2917 - acc: 0.9100
1120/1506 [=====================>........] - ETA: 7s - loss: 0.2904 - acc: 0.9103
1152/1506 [=====================>........] - ETA: 6s - loss: 0.2887 - acc: 0.9109
1184/1506 [======================>.......] - ETA: 6s - loss: 0.2865 - acc: 0.9116
1216/1506 [=======================>......] - ETA: 5s - loss: 0.2843 - acc: 0.9122
1248/1506 [=======================>......] - ETA: 4s - loss: 0.2814 - acc: 0.9132
1280/1506 [========================>.....] - ETA: 4s - loss: 0.2793 - acc: 0.9137
1312/1506 [=========================>....] - ETA: 3s - loss: 0.2771 - acc: 0.9143
1344/1506 [=========================>....] - ETA: 3s - loss: 0.2763 - acc: 0.9146
1376/1506 [==========================>...] - ETA: 2s - loss: 0.2750 - acc: 0.9149
1408/1506 [===========================>..] - ETA: 1s - loss: 0.2738 - acc: 0.9154
1440/1506 [===========================>..] - ETA: 1s - loss: 0.2730 - acc: 0.9157
1472/1506 [============================>.] - ETA: 0s - loss: 0.2737 - acc: 0.9156
1504/1506 [============================>.] - ETA: 0s - loss: 0.2729 - acc: 0.9157
1506/1506 [==============================] - 30s 20ms/step - loss: 0.2726 - acc: 0.9158 - val_loss: 0.2219 - val_acc: 0.9314
Epoch 3/70

  32/1506 [..............................] - ETA: 27s - loss: 0.1956 - acc: 0.9441
  64/1506 [>.............................] - ETA: 27s - loss: 0.1868 - acc: 0.9407
  96/1506 [>.............................] - ETA: 26s - loss: 0.1885 - acc: 0.9407
 128/1506 [=>............................] - ETA: 26s - loss: 0.1935 - acc: 0.9394
 160/1506 [==>...........................] - ETA: 25s - loss: 0.2109 - acc: 0.9331
 192/1506 [==>...........................] - ETA: 24s - loss: 0.2236 - acc: 0.9288
 224/1506 [===>..........................] - ETA: 24s - loss: 0.2218 - acc: 0.9311
 256/1506 [====>.........................] - ETA: 23s - loss: 0.2376 - acc: 0.9240
 288/1506 [====>.........................] - ETA: 23s - loss: 0.2424 - acc: 0.9221
 320/1506 [=====>........................] - ETA: 22s - loss: 0.2384 - acc: 0.9247
 352/1506 [======>.......................] - ETA: 21s - loss: 0.2362 - acc: 0.9250
 384/1506 [======>.......................] - ETA: 21s - loss: 0.2373 - acc: 0.9248
 416/1506 [=======>......................] - ETA: 20s - loss: 0.2379 - acc: 0.9256
 448/1506 [=======>......................] - ETA: 19s - loss: 0.2314 - acc: 0.9276
 480/1506 [========>.....................] - ETA: 19s - loss: 0.2308 - acc: 0.9274
 512/1506 [=========>....................] - ETA: 18s - loss: 0.2319 - acc: 0.9269
 544/1506 [=========>....................] - ETA: 18s - loss: 0.2294 - acc: 0.9281
 576/1506 [==========>...................] - ETA: 17s - loss: 0.2264 - acc: 0.9289
 608/1506 [===========>..................] - ETA: 16s - loss: 0.2254 - acc: 0.9292
 640/1506 [===========>..................] - ETA: 16s - loss: 0.2234 - acc: 0.9297
 672/1506 [============>.................] - ETA: 15s - loss: 0.2203 - acc: 0.9307
 704/1506 [=============>................] - ETA: 15s - loss: 0.2183 - acc: 0.9317
 736/1506 [=============>................] - ETA: 14s - loss: 0.2170 - acc: 0.9316
 768/1506 [==============>...............] - ETA: 13s - loss: 0.2153 - acc: 0.9322
 800/1506 [==============>...............] - ETA: 13s - loss: 0.2149 - acc: 0.9329
 832/1506 [===============>..............] - ETA: 12s - loss: 0.2158 - acc: 0.9323
 864/1506 [================>.............] - ETA: 12s - loss: 0.2172 - acc: 0.9316
 896/1506 [================>.............] - ETA: 11s - loss: 0.2152 - acc: 0.9326
 928/1506 [=================>............] - ETA: 10s - loss: 0.2162 - acc: 0.9322
 960/1506 [==================>...........] - ETA: 10s - loss: 0.2131 - acc: 0.9332
 992/1506 [==================>...........] - ETA: 9s - loss: 0.2118 - acc: 0.9338 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.2137 - acc: 0.9335
1056/1506 [====================>.........] - ETA: 8s - loss: 0.2135 - acc: 0.9338
1088/1506 [====================>.........] - ETA: 7s - loss: 0.2154 - acc: 0.9330
1120/1506 [=====================>........] - ETA: 7s - loss: 0.2161 - acc: 0.9328
1152/1506 [=====================>........] - ETA: 6s - loss: 0.2180 - acc: 0.9320
1184/1506 [======================>.......] - ETA: 6s - loss: 0.2169 - acc: 0.9324
1216/1506 [=======================>......] - ETA: 5s - loss: 0.2153 - acc: 0.9326
1248/1506 [=======================>......] - ETA: 4s - loss: 0.2138 - acc: 0.9333
1280/1506 [========================>.....] - ETA: 4s - loss: 0.2127 - acc: 0.9332
1312/1506 [=========================>....] - ETA: 3s - loss: 0.2120 - acc: 0.9335
1344/1506 [=========================>....] - ETA: 3s - loss: 0.2119 - acc: 0.9336
1376/1506 [==========================>...] - ETA: 2s - loss: 0.2100 - acc: 0.9343
1408/1506 [===========================>..] - ETA: 1s - loss: 0.2101 - acc: 0.9342
1440/1506 [===========================>..] - ETA: 1s - loss: 0.2115 - acc: 0.9341
1472/1506 [============================>.] - ETA: 0s - loss: 0.2122 - acc: 0.9337
1504/1506 [============================>.] - ETA: 0s - loss: 0.2122 - acc: 0.9337
1506/1506 [==============================] - 30s 20ms/step - loss: 0.2120 - acc: 0.9337 - val_loss: 0.2021 - val_acc: 0.9334
Epoch 4/70

  32/1506 [..............................] - ETA: 27s - loss: 0.1840 - acc: 0.9498
  64/1506 [>.............................] - ETA: 27s - loss: 0.1502 - acc: 0.9573
  96/1506 [>.............................] - ETA: 26s - loss: 0.1544 - acc: 0.9549
 128/1506 [=>............................] - ETA: 25s - loss: 0.1593 - acc: 0.9527
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1594 - acc: 0.9519
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1840 - acc: 0.9423
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1767 - acc: 0.9461
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1827 - acc: 0.9439
 288/1506 [====>.........................] - ETA: 22s - loss: 0.1830 - acc: 0.9437
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1859 - acc: 0.9426
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1890 - acc: 0.9407
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1863 - acc: 0.9426
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1841 - acc: 0.9434
 448/1506 [=======>......................] - ETA: 19s - loss: 0.1844 - acc: 0.9436
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1827 - acc: 0.9444
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1830 - acc: 0.9438
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1798 - acc: 0.9450
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1814 - acc: 0.9449
 608/1506 [===========>..................] - ETA: 16s - loss: 0.1820 - acc: 0.9443
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1809 - acc: 0.9447
 672/1506 [============>.................] - ETA: 15s - loss: 0.1828 - acc: 0.9438
 704/1506 [=============>................] - ETA: 15s - loss: 0.1831 - acc: 0.9439
 736/1506 [=============>................] - ETA: 14s - loss: 0.1846 - acc: 0.9432
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1856 - acc: 0.9427
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1840 - acc: 0.9431
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1841 - acc: 0.9431
 864/1506 [================>.............] - ETA: 12s - loss: 0.1847 - acc: 0.9429
 896/1506 [================>.............] - ETA: 11s - loss: 0.1814 - acc: 0.9440
 928/1506 [=================>............] - ETA: 10s - loss: 0.1811 - acc: 0.9441
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1823 - acc: 0.9435
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1817 - acc: 0.9435 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1819 - acc: 0.9437
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1821 - acc: 0.9438
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1821 - acc: 0.9434
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1819 - acc: 0.9434
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1817 - acc: 0.9436
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1820 - acc: 0.9434
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1818 - acc: 0.9435
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1822 - acc: 0.9431
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1831 - acc: 0.9425
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1831 - acc: 0.9426
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1827 - acc: 0.9427
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1817 - acc: 0.9431
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1803 - acc: 0.9436
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1820 - acc: 0.9429
1472/1506 [============================>.] - ETA: 0s - loss: 0.1810 - acc: 0.9432
1504/1506 [============================>.] - ETA: 0s - loss: 0.1812 - acc: 0.9432
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1813 - acc: 0.9432 - val_loss: 0.2808 - val_acc: 0.9114
Epoch 5/70

  32/1506 [..............................] - ETA: 28s - loss: 0.2795 - acc: 0.9145
  64/1506 [>.............................] - ETA: 27s - loss: 0.2606 - acc: 0.9234
  96/1506 [>.............................] - ETA: 26s - loss: 0.2390 - acc: 0.9273
 128/1506 [=>............................] - ETA: 25s - loss: 0.2274 - acc: 0.9304
 160/1506 [==>...........................] - ETA: 25s - loss: 0.2181 - acc: 0.9334
 192/1506 [==>...........................] - ETA: 24s - loss: 0.2053 - acc: 0.9378
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1971 - acc: 0.9390
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1905 - acc: 0.9425
 288/1506 [====>.........................] - ETA: 22s - loss: 0.1863 - acc: 0.9441
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1847 - acc: 0.9440
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1750 - acc: 0.9469
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1775 - acc: 0.9471
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1756 - acc: 0.9470
 448/1506 [=======>......................] - ETA: 19s - loss: 0.1733 - acc: 0.9480
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1714 - acc: 0.9484
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1700 - acc: 0.9490
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1674 - acc: 0.9500
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1669 - acc: 0.9500
 608/1506 [===========>..................] - ETA: 16s - loss: 0.1704 - acc: 0.9490
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1692 - acc: 0.9493
 672/1506 [============>.................] - ETA: 15s - loss: 0.1679 - acc: 0.9491
 704/1506 [=============>................] - ETA: 15s - loss: 0.1656 - acc: 0.9500
 736/1506 [=============>................] - ETA: 14s - loss: 0.1669 - acc: 0.9492
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1666 - acc: 0.9494
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1651 - acc: 0.9497
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1634 - acc: 0.9507
 864/1506 [================>.............] - ETA: 12s - loss: 0.1649 - acc: 0.9500
 896/1506 [================>.............] - ETA: 11s - loss: 0.1650 - acc: 0.9503
 928/1506 [=================>............] - ETA: 10s - loss: 0.1659 - acc: 0.9497
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1639 - acc: 0.9501
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1649 - acc: 0.9501 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1642 - acc: 0.9505
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1636 - acc: 0.9507
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1632 - acc: 0.9508
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1632 - acc: 0.9506
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1655 - acc: 0.9500
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1653 - acc: 0.9499
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1665 - acc: 0.9493
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1684 - acc: 0.9488
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1692 - acc: 0.9483
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1682 - acc: 0.9483
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1679 - acc: 0.9485
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1667 - acc: 0.9491
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1667 - acc: 0.9493
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1651 - acc: 0.9499
1472/1506 [============================>.] - ETA: 0s - loss: 0.1650 - acc: 0.9499
1504/1506 [============================>.] - ETA: 0s - loss: 0.1636 - acc: 0.9503
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1639 - acc: 0.9502 - val_loss: 0.1899 - val_acc: 0.9361
Epoch 6/70

  32/1506 [..............................] - ETA: 26s - loss: 0.2114 - acc: 0.9268
  64/1506 [>.............................] - ETA: 26s - loss: 0.1829 - acc: 0.9360
  96/1506 [>.............................] - ETA: 26s - loss: 0.1838 - acc: 0.9380
 128/1506 [=>............................] - ETA: 25s - loss: 0.1937 - acc: 0.9357
 160/1506 [==>...........................] - ETA: 24s - loss: 0.2006 - acc: 0.9322
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1900 - acc: 0.9368
 224/1506 [===>..........................] - ETA: 23s - loss: 0.1848 - acc: 0.9385
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1787 - acc: 0.9415
 288/1506 [====>.........................] - ETA: 22s - loss: 0.1719 - acc: 0.9439
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1681 - acc: 0.9445
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1670 - acc: 0.9445
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1612 - acc: 0.9463
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1587 - acc: 0.9474
 448/1506 [=======>......................] - ETA: 19s - loss: 0.1578 - acc: 0.9485
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1533 - acc: 0.9498
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1503 - acc: 0.9515
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1481 - acc: 0.9527
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1491 - acc: 0.9529
 608/1506 [===========>..................] - ETA: 16s - loss: 0.1476 - acc: 0.9534
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1465 - acc: 0.9538
 672/1506 [============>.................] - ETA: 15s - loss: 0.1454 - acc: 0.9543
 704/1506 [=============>................] - ETA: 15s - loss: 0.1450 - acc: 0.9544
 736/1506 [=============>................] - ETA: 14s - loss: 0.1440 - acc: 0.9548
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1438 - acc: 0.9550
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1428 - acc: 0.9554
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1422 - acc: 0.9557
 864/1506 [================>.............] - ETA: 12s - loss: 0.1406 - acc: 0.9563
 896/1506 [================>.............] - ETA: 11s - loss: 0.1386 - acc: 0.9572
 928/1506 [=================>............] - ETA: 10s - loss: 0.1405 - acc: 0.9566
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1391 - acc: 0.9570
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1381 - acc: 0.9573 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1386 - acc: 0.9568
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1401 - acc: 0.9562
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1397 - acc: 0.9561
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1407 - acc: 0.9556
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1416 - acc: 0.9553
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1415 - acc: 0.9553
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1420 - acc: 0.9552
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1429 - acc: 0.9552
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1421 - acc: 0.9555
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1429 - acc: 0.9552
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1445 - acc: 0.9548
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1447 - acc: 0.9547
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1440 - acc: 0.9550
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1446 - acc: 0.9547
1472/1506 [============================>.] - ETA: 0s - loss: 0.1444 - acc: 0.9546
1504/1506 [============================>.] - ETA: 0s - loss: 0.1448 - acc: 0.9544
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1447 - acc: 0.9544 - val_loss: 0.1877 - val_acc: 0.9348
Epoch 7/70

  32/1506 [..............................] - ETA: 27s - loss: 0.1551 - acc: 0.9567
  64/1506 [>.............................] - ETA: 27s - loss: 0.1972 - acc: 0.9345
  96/1506 [>.............................] - ETA: 26s - loss: 0.1849 - acc: 0.9387
 128/1506 [=>............................] - ETA: 25s - loss: 0.1659 - acc: 0.9456
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1542 - acc: 0.9501
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1560 - acc: 0.9490
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1458 - acc: 0.9526
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1460 - acc: 0.9537
 288/1506 [====>.........................] - ETA: 22s - loss: 0.1468 - acc: 0.9535
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1444 - acc: 0.9544
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1436 - acc: 0.9553
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1413 - acc: 0.9562
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1401 - acc: 0.9559
 448/1506 [=======>......................] - ETA: 19s - loss: 0.1368 - acc: 0.9567
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1330 - acc: 0.9580
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1338 - acc: 0.9577
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1337 - acc: 0.9579
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1314 - acc: 0.9588
 608/1506 [===========>..................] - ETA: 16s - loss: 0.1308 - acc: 0.9586
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1335 - acc: 0.9569
 672/1506 [============>.................] - ETA: 15s - loss: 0.1343 - acc: 0.9566
 704/1506 [=============>................] - ETA: 15s - loss: 0.1342 - acc: 0.9567
 736/1506 [=============>................] - ETA: 14s - loss: 0.1324 - acc: 0.9570
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1300 - acc: 0.9578
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1290 - acc: 0.9585
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1314 - acc: 0.9578
 864/1506 [================>.............] - ETA: 12s - loss: 0.1319 - acc: 0.9577
 896/1506 [================>.............] - ETA: 11s - loss: 0.1342 - acc: 0.9571
 928/1506 [=================>............] - ETA: 10s - loss: 0.1342 - acc: 0.9574
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1360 - acc: 0.9565
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1360 - acc: 0.9565 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1362 - acc: 0.9564
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1364 - acc: 0.9566
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1360 - acc: 0.9568
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1354 - acc: 0.9571
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1347 - acc: 0.9575
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1332 - acc: 0.9580
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1320 - acc: 0.9584
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1335 - acc: 0.9579
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1337 - acc: 0.9580
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1330 - acc: 0.9581
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1327 - acc: 0.9582
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1321 - acc: 0.9584
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1321 - acc: 0.9583
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1319 - acc: 0.9583
1472/1506 [============================>.] - ETA: 0s - loss: 0.1314 - acc: 0.9585
1504/1506 [============================>.] - ETA: 0s - loss: 0.1307 - acc: 0.9588
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1310 - acc: 0.9587 - val_loss: 0.2046 - val_acc: 0.9347
Epoch 8/70

  32/1506 [..............................] - ETA: 27s - loss: 0.1307 - acc: 0.9494
  64/1506 [>.............................] - ETA: 27s - loss: 0.1191 - acc: 0.9569
  96/1506 [>.............................] - ETA: 26s - loss: 0.1194 - acc: 0.9590
 128/1506 [=>............................] - ETA: 26s - loss: 0.1190 - acc: 0.9600
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1202 - acc: 0.9578
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1192 - acc: 0.9580
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1212 - acc: 0.9575
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1186 - acc: 0.9586
 288/1506 [====>.........................] - ETA: 22s - loss: 0.1178 - acc: 0.9599
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1178 - acc: 0.9604
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1183 - acc: 0.9604
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1173 - acc: 0.9609
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1175 - acc: 0.9610
 448/1506 [=======>......................] - ETA: 19s - loss: 0.1199 - acc: 0.9609
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1190 - acc: 0.9610
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1216 - acc: 0.9598
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1223 - acc: 0.9598
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1207 - acc: 0.9604
 608/1506 [===========>..................] - ETA: 16s - loss: 0.1193 - acc: 0.9611
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1172 - acc: 0.9617
 672/1506 [============>.................] - ETA: 15s - loss: 0.1163 - acc: 0.9620
 704/1506 [=============>................] - ETA: 15s - loss: 0.1167 - acc: 0.9624
 736/1506 [=============>................] - ETA: 14s - loss: 0.1166 - acc: 0.9626
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1171 - acc: 0.9627
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1169 - acc: 0.9627
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1166 - acc: 0.9626
 864/1506 [================>.............] - ETA: 12s - loss: 0.1158 - acc: 0.9629
 896/1506 [================>.............] - ETA: 11s - loss: 0.1165 - acc: 0.9630
 928/1506 [=================>............] - ETA: 10s - loss: 0.1164 - acc: 0.9632
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1151 - acc: 0.9638
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1150 - acc: 0.9639 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1150 - acc: 0.9636
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1168 - acc: 0.9631
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1165 - acc: 0.9632
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1168 - acc: 0.9630
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1169 - acc: 0.9629
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1171 - acc: 0.9628
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1160 - acc: 0.9632
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1169 - acc: 0.9630
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1168 - acc: 0.9632
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1171 - acc: 0.9633
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1179 - acc: 0.9630
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1198 - acc: 0.9627
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1204 - acc: 0.9626
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1199 - acc: 0.9629
1472/1506 [============================>.] - ETA: 0s - loss: 0.1193 - acc: 0.9630
1504/1506 [============================>.] - ETA: 0s - loss: 0.1187 - acc: 0.9632
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1186 - acc: 0.9633 - val_loss: 0.1529 - val_acc: 0.9519
Epoch 9/70

  32/1506 [..............................] - ETA: 27s - loss: 0.0803 - acc: 0.9697
  64/1506 [>.............................] - ETA: 27s - loss: 0.0969 - acc: 0.9628
  96/1506 [>.............................] - ETA: 26s - loss: 0.0961 - acc: 0.9633
 128/1506 [=>............................] - ETA: 26s - loss: 0.0962 - acc: 0.9630
 160/1506 [==>...........................] - ETA: 25s - loss: 0.0959 - acc: 0.9658
 192/1506 [==>...........................] - ETA: 24s - loss: 0.0981 - acc: 0.9663
 224/1506 [===>..........................] - ETA: 24s - loss: 0.0963 - acc: 0.9680
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1037 - acc: 0.9661
 288/1506 [====>.........................] - ETA: 23s - loss: 0.1043 - acc: 0.9661
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1004 - acc: 0.9677
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1037 - acc: 0.9676
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1038 - acc: 0.9674
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1027 - acc: 0.9683
 448/1506 [=======>......................] - ETA: 19s - loss: 0.1043 - acc: 0.9678
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1057 - acc: 0.9679
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1079 - acc: 0.9666
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1100 - acc: 0.9662
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1096 - acc: 0.9663
 608/1506 [===========>..................] - ETA: 16s - loss: 0.1095 - acc: 0.9665
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1075 - acc: 0.9672
 672/1506 [============>.................] - ETA: 15s - loss: 0.1075 - acc: 0.9673
 704/1506 [=============>................] - ETA: 15s - loss: 0.1079 - acc: 0.9669
 736/1506 [=============>................] - ETA: 14s - loss: 0.1094 - acc: 0.9662
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1088 - acc: 0.9662
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1071 - acc: 0.9666
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1057 - acc: 0.9669
 864/1506 [================>.............] - ETA: 12s - loss: 0.1057 - acc: 0.9669
 896/1506 [================>.............] - ETA: 11s - loss: 0.1038 - acc: 0.9676
 928/1506 [=================>............] - ETA: 10s - loss: 0.1029 - acc: 0.9677
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1045 - acc: 0.9673
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1043 - acc: 0.9673 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1067 - acc: 0.9663
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1088 - acc: 0.9656
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1101 - acc: 0.9655
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1094 - acc: 0.9659
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1088 - acc: 0.9661
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1094 - acc: 0.9660
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1085 - acc: 0.9662
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1084 - acc: 0.9662
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1088 - acc: 0.9661
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1094 - acc: 0.9660
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1085 - acc: 0.9664
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1087 - acc: 0.9663
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1074 - acc: 0.9667
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1070 - acc: 0.9668
1472/1506 [============================>.] - ETA: 0s - loss: 0.1071 - acc: 0.9667
1504/1506 [============================>.] - ETA: 0s - loss: 0.1071 - acc: 0.9664
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1070 - acc: 0.9664 - val_loss: 0.1564 - val_acc: 0.9545
Epoch 10/70

  32/1506 [..............................] - ETA: 27s - loss: 0.1616 - acc: 0.9520
  64/1506 [>.............................] - ETA: 27s - loss: 0.1081 - acc: 0.9696
  96/1506 [>.............................] - ETA: 26s - loss: 0.1073 - acc: 0.9678
 128/1506 [=>............................] - ETA: 25s - loss: 0.1102 - acc: 0.9667
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1137 - acc: 0.9642
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1197 - acc: 0.9626
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1179 - acc: 0.9630
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1173 - acc: 0.9627
 288/1506 [====>.........................] - ETA: 22s - loss: 0.1136 - acc: 0.9645
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1180 - acc: 0.9625
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1142 - acc: 0.9640
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1136 - acc: 0.9647
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1126 - acc: 0.9653
 448/1506 [=======>......................] - ETA: 19s - loss: 0.1106 - acc: 0.9665
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1077 - acc: 0.9669
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1054 - acc: 0.9674
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1033 - acc: 0.9680
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1050 - acc: 0.9674
 608/1506 [===========>..................] - ETA: 16s - loss: 0.1039 - acc: 0.9673
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1037 - acc: 0.9672
 672/1506 [============>.................] - ETA: 15s - loss: 0.1028 - acc: 0.9677
 704/1506 [=============>................] - ETA: 15s - loss: 0.1026 - acc: 0.9683
 736/1506 [=============>................] - ETA: 14s - loss: 0.1022 - acc: 0.9684
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1023 - acc: 0.9678
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1036 - acc: 0.9676
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1026 - acc: 0.9678
 864/1506 [================>.............] - ETA: 12s - loss: 0.1034 - acc: 0.9679
 896/1506 [================>.............] - ETA: 11s - loss: 0.1026 - acc: 0.9681
 928/1506 [=================>............] - ETA: 10s - loss: 0.1020 - acc: 0.9683
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1016 - acc: 0.9684
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1007 - acc: 0.9688 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1018 - acc: 0.9686
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1019 - acc: 0.9687
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1021 - acc: 0.9685
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1033 - acc: 0.9681
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1037 - acc: 0.9679
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1042 - acc: 0.9676
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1046 - acc: 0.9675
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1048 - acc: 0.9676
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1041 - acc: 0.9677
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1037 - acc: 0.9679
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1041 - acc: 0.9676
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1034 - acc: 0.9678
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1028 - acc: 0.9681
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1017 - acc: 0.9683
1472/1506 [============================>.] - ETA: 0s - loss: 0.1023 - acc: 0.9681
1504/1506 [============================>.] - ETA: 0s - loss: 0.1030 - acc: 0.9679
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1028 - acc: 0.9679 - val_loss: 0.1447 - val_acc: 0.9555
Epoch 11/70

  32/1506 [..............................] - ETA: 27s - loss: 0.0516 - acc: 0.9859
  64/1506 [>.............................] - ETA: 27s - loss: 0.0725 - acc: 0.9794
  96/1506 [>.............................] - ETA: 26s - loss: 0.0637 - acc: 0.9818
 128/1506 [=>............................] - ETA: 26s - loss: 0.0709 - acc: 0.9786
 160/1506 [==>...........................] - ETA: 25s - loss: 0.0854 - acc: 0.9754
 192/1506 [==>...........................] - ETA: 24s - loss: 0.0872 - acc: 0.9746
 224/1506 [===>..........................] - ETA: 24s - loss: 0.0971 - acc: 0.9713
 256/1506 [====>.........................] - ETA: 23s - loss: 0.0993 - acc: 0.9711
 288/1506 [====>.........................] - ETA: 23s - loss: 0.0962 - acc: 0.9719
 320/1506 [=====>........................] - ETA: 22s - loss: 0.0959 - acc: 0.9710
 352/1506 [======>.......................] - ETA: 21s - loss: 0.0961 - acc: 0.9716
 384/1506 [======>.......................] - ETA: 21s - loss: 0.0946 - acc: 0.9714
 416/1506 [=======>......................] - ETA: 20s - loss: 0.0937 - acc: 0.9717
 448/1506 [=======>......................] - ETA: 20s - loss: 0.0930 - acc: 0.9721
 480/1506 [========>.....................] - ETA: 19s - loss: 0.0928 - acc: 0.9714
 512/1506 [=========>....................] - ETA: 18s - loss: 0.0931 - acc: 0.9717
 544/1506 [=========>....................] - ETA: 18s - loss: 0.0955 - acc: 0.9708
 576/1506 [==========>...................] - ETA: 17s - loss: 0.0948 - acc: 0.9712
 608/1506 [===========>..................] - ETA: 16s - loss: 0.0947 - acc: 0.9712
 640/1506 [===========>..................] - ETA: 16s - loss: 0.0950 - acc: 0.9712
 672/1506 [============>.................] - ETA: 15s - loss: 0.0950 - acc: 0.9712
 704/1506 [=============>................] - ETA: 15s - loss: 0.0970 - acc: 0.9705
 736/1506 [=============>................] - ETA: 14s - loss: 0.0959 - acc: 0.9709
 768/1506 [==============>...............] - ETA: 13s - loss: 0.0941 - acc: 0.9714
 800/1506 [==============>...............] - ETA: 13s - loss: 0.0934 - acc: 0.9715
 832/1506 [===============>..............] - ETA: 12s - loss: 0.0926 - acc: 0.9717
 864/1506 [================>.............] - ETA: 12s - loss: 0.0931 - acc: 0.9716
 896/1506 [================>.............] - ETA: 11s - loss: 0.0930 - acc: 0.9716
 928/1506 [=================>............] - ETA: 10s - loss: 0.0939 - acc: 0.9712
 960/1506 [==================>...........] - ETA: 10s - loss: 0.0956 - acc: 0.9705
 992/1506 [==================>...........] - ETA: 9s - loss: 0.0944 - acc: 0.9709 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.0951 - acc: 0.9706
1056/1506 [====================>.........] - ETA: 8s - loss: 0.0952 - acc: 0.9705
1088/1506 [====================>.........] - ETA: 7s - loss: 0.0949 - acc: 0.9706
1120/1506 [=====================>........] - ETA: 7s - loss: 0.0955 - acc: 0.9705
1152/1506 [=====================>........] - ETA: 6s - loss: 0.0952 - acc: 0.9707
1184/1506 [======================>.......] - ETA: 6s - loss: 0.0950 - acc: 0.9707
1216/1506 [=======================>......] - ETA: 5s - loss: 0.0941 - acc: 0.9711
1248/1506 [=======================>......] - ETA: 4s - loss: 0.0939 - acc: 0.9712
1280/1506 [========================>.....] - ETA: 4s - loss: 0.0943 - acc: 0.9708
1312/1506 [=========================>....] - ETA: 3s - loss: 0.0944 - acc: 0.9708
1344/1506 [=========================>....] - ETA: 3s - loss: 0.0941 - acc: 0.9708
1376/1506 [==========================>...] - ETA: 2s - loss: 0.0933 - acc: 0.9711
1408/1506 [===========================>..] - ETA: 1s - loss: 0.0922 - acc: 0.9715
1440/1506 [===========================>..] - ETA: 1s - loss: 0.0921 - acc: 0.9717
1472/1506 [============================>.] - ETA: 0s - loss: 0.0921 - acc: 0.9716
1504/1506 [============================>.] - ETA: 0s - loss: 0.0926 - acc: 0.9716
1506/1506 [==============================] - 30s 20ms/step - loss: 0.0925 - acc: 0.9717 - val_loss: 0.1439 - val_acc: 0.9540
Epoch 12/70

  32/1506 [..............................] - ETA: 27s - loss: 0.1254 - acc: 0.9638
  64/1506 [>.............................] - ETA: 26s - loss: 0.1143 - acc: 0.9698
  96/1506 [>.............................] - ETA: 26s - loss: 0.0985 - acc: 0.9748
 128/1506 [=>............................] - ETA: 25s - loss: 0.0924 - acc: 0.9745
 160/1506 [==>...........................] - ETA: 25s - loss: 0.0919 - acc: 0.9735
 192/1506 [==>...........................] - ETA: 24s - loss: 0.0865 - acc: 0.9746
 224/1506 [===>..........................] - ETA: 24s - loss: 0.0839 - acc: 0.9752
 256/1506 [====>.........................] - ETA: 23s - loss: 0.0847 - acc: 0.9748
 288/1506 [====>.........................] - ETA: 23s - loss: 0.0876 - acc: 0.9748
 320/1506 [=====>........................] - ETA: 22s - loss: 0.0887 - acc: 0.9739
 352/1506 [======>.......................] - ETA: 21s - loss: 0.0869 - acc: 0.9744
 384/1506 [======>.......................] - ETA: 21s - loss: 0.0860 - acc: 0.9748
 416/1506 [=======>......................] - ETA: 20s - loss: 0.0871 - acc: 0.9742
 448/1506 [=======>......................] - ETA: 19s - loss: 0.0890 - acc: 0.9734
 480/1506 [========>.....................] - ETA: 19s - loss: 0.0922 - acc: 0.9717
 512/1506 [=========>....................] - ETA: 18s - loss: 0.0908 - acc: 0.9722
 544/1506 [=========>....................] - ETA: 18s - loss: 0.0907 - acc: 0.9722
 576/1506 [==========>...................] - ETA: 17s - loss: 0.0916 - acc: 0.9720
 608/1506 [===========>..................] - ETA: 16s - loss: 0.0925 - acc: 0.9721
 640/1506 [===========>..................] - ETA: 16s - loss: 0.0915 - acc: 0.9722
 672/1506 [============>.................] - ETA: 15s - loss: 0.0912 - acc: 0.9722
 704/1506 [=============>................] - ETA: 15s - loss: 0.0892 - acc: 0.9731
 736/1506 [=============>................] - ETA: 14s - loss: 0.0892 - acc: 0.9732
 768/1506 [==============>...............] - ETA: 13s - loss: 0.0890 - acc: 0.9734
 800/1506 [==============>...............] - ETA: 13s - loss: 0.0884 - acc: 0.9736
 832/1506 [===============>..............] - ETA: 12s - loss: 0.0899 - acc: 0.9726
 864/1506 [================>.............] - ETA: 12s - loss: 0.0905 - acc: 0.9721
 896/1506 [================>.............] - ETA: 11s - loss: 0.0900 - acc: 0.9724
 928/1506 [=================>............] - ETA: 10s - loss: 0.0904 - acc: 0.9721
 960/1506 [==================>...........] - ETA: 10s - loss: 0.0897 - acc: 0.9724
 992/1506 [==================>...........] - ETA: 9s - loss: 0.0897 - acc: 0.9724 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.0904 - acc: 0.9722
1056/1506 [====================>.........] - ETA: 8s - loss: 0.0910 - acc: 0.9716
1088/1506 [====================>.........] - ETA: 7s - loss: 0.0902 - acc: 0.9720
1120/1506 [=====================>........] - ETA: 7s - loss: 0.0897 - acc: 0.9721
1152/1506 [=====================>........] - ETA: 6s - loss: 0.0900 - acc: 0.9720
1184/1506 [======================>.......] - ETA: 6s - loss: 0.0892 - acc: 0.9723
1216/1506 [=======================>......] - ETA: 5s - loss: 0.0882 - acc: 0.9726
1248/1506 [=======================>......] - ETA: 4s - loss: 0.0871 - acc: 0.9730
1280/1506 [========================>.....] - ETA: 4s - loss: 0.0862 - acc: 0.9734
1312/1506 [=========================>....] - ETA: 3s - loss: 0.0860 - acc: 0.9734
1344/1506 [=========================>....] - ETA: 3s - loss: 0.0863 - acc: 0.9733
1376/1506 [==========================>...] - ETA: 2s - loss: 0.0872 - acc: 0.9733
1408/1506 [===========================>..] - ETA: 1s - loss: 0.0873 - acc: 0.9733
1440/1506 [===========================>..] - ETA: 1s - loss: 0.0878 - acc: 0.9731
1472/1506 [============================>.] - ETA: 0s - loss: 0.0872 - acc: 0.9733
1504/1506 [============================>.] - ETA: 0s - loss: 0.0872 - acc: 0.9733
1506/1506 [==============================] - 30s 20ms/step - loss: 0.0871 - acc: 0.9733 - val_loss: 0.1414 - val_acc: 0.9547
Epoch 13/70

  32/1506 [..............................] - ETA: 27s - loss: 0.1030 - acc: 0.9700
  64/1506 [>.............................] - ETA: 27s - loss: 0.0832 - acc: 0.9768
  96/1506 [>.............................] - ETA: 26s - loss: 0.0844 - acc: 0.9736
 128/1506 [=>............................] - ETA: 25s - loss: 0.0829 - acc: 0.9742
 160/1506 [==>...........................] - ETA: 25s - loss: 0.0803 - acc: 0.9754
 192/1506 [==>...........................] - ETA: 24s - loss: 0.0765 - acc: 0.9771
 224/1506 [===>..........................] - ETA: 24s - loss: 0.0777 - acc: 0.9763
 256/1506 [====>.........................] - ETA: 23s - loss: 0.0793 - acc: 0.9747
 288/1506 [====>.........................] - ETA: 22s - loss: 0.0807 - acc: 0.9741
 320/1506 [=====>........................] - ETA: 22s - loss: 0.0829 - acc: 0.9732
 352/1506 [======>.......................] - ETA: 21s - loss: 0.0853 - acc: 0.9726
 384/1506 [======>.......................] - ETA: 21s - loss: 0.0877 - acc: 0.9724
 416/1506 [=======>......................] - ETA: 20s - loss: 0.0883 - acc: 0.9723
 448/1506 [=======>......................] - ETA: 19s - loss: 0.0874 - acc: 0.9726
 480/1506 [========>.....................] - ETA: 19s - loss: 0.0837 - acc: 0.9739
 512/1506 [=========>....................] - ETA: 18s - loss: 0.0823 - acc: 0.9742
 544/1506 [=========>....................] - ETA: 18s - loss: 0.0810 - acc: 0.9746
 576/1506 [==========>...................] - ETA: 17s - loss: 0.0806 - acc: 0.9748
 608/1506 [===========>..................] - ETA: 16s - loss: 0.0775 - acc: 0.9758
 640/1506 [===========>..................] - ETA: 16s - loss: 0.0780 - acc: 0.9759
 672/1506 [============>.................] - ETA: 15s - loss: 0.0800 - acc: 0.9752
 704/1506 [=============>................] - ETA: 15s - loss: 0.0807 - acc: 0.9751
 736/1506 [=============>................] - ETA: 14s - loss: 0.0828 - acc: 0.9743
 768/1506 [==============>...............] - ETA: 13s - loss: 0.0835 - acc: 0.9739
 800/1506 [==============>...............] - ETA: 13s - loss: 0.0824 - acc: 0.9743
 832/1506 [===============>..............] - ETA: 12s - loss: 0.0830 - acc: 0.9740
 864/1506 [================>.............] - ETA: 12s - loss: 0.0831 - acc: 0.9739
 896/1506 [================>.............] - ETA: 11s - loss: 0.0832 - acc: 0.9738
 928/1506 [=================>............] - ETA: 10s - loss: 0.0834 - acc: 0.9735
 960/1506 [==================>...........] - ETA: 10s - loss: 0.0830 - acc: 0.9736
 992/1506 [==================>...........] - ETA: 9s - loss: 0.0838 - acc: 0.9736 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.0835 - acc: 0.9738
1056/1506 [====================>.........] - ETA: 8s - loss: 0.0841 - acc: 0.9738
1088/1506 [====================>.........] - ETA: 7s - loss: 0.0848 - acc: 0.9736
1120/1506 [=====================>........] - ETA: 7s - loss: 0.0852 - acc: 0.9734
1152/1506 [=====================>........] - ETA: 6s - loss: 0.0856 - acc: 0.9731
1184/1506 [======================>.......] - ETA: 6s - loss: 0.0860 - acc: 0.9732
1216/1506 [=======================>......] - ETA: 5s - loss: 0.0864 - acc: 0.9730
1248/1506 [=======================>......] - ETA: 4s - loss: 0.0852 - acc: 0.9734
1280/1506 [========================>.....] - ETA: 4s - loss: 0.0850 - acc: 0.9733
1312/1506 [=========================>....] - ETA: 3s - loss: 0.0851 - acc: 0.9733
1344/1506 [=========================>....] - ETA: 3s - loss: 0.0847 - acc: 0.9734
1376/1506 [==========================>...] - ETA: 2s - loss: 0.0843 - acc: 0.9735
1408/1506 [===========================>..] - ETA: 1s - loss: 0.0847 - acc: 0.9735
1440/1506 [===========================>..] - ETA: 1s - loss: 0.0846 - acc: 0.9736
1472/1506 [============================>.] - ETA: 0s - loss: 0.0843 - acc: 0.9735
1504/1506 [============================>.] - ETA: 0s - loss: 0.0838 - acc: 0.9737
1506/1506 [==============================] - 30s 20ms/step - loss: 0.0837 - acc: 0.9737 - val_loss: 0.1427 - val_acc: 0.9552
Epoch 14/70

  32/1506 [..............................] - ETA: 27s - loss: 0.0765 - acc: 0.9740
  64/1506 [>.............................] - ETA: 27s - loss: 0.0637 - acc: 0.9811
  96/1506 [>.............................] - ETA: 26s - loss: 0.0633 - acc: 0.9818
 128/1506 [=>............................] - ETA: 25s - loss: 0.0650 - acc: 0.9817
 160/1506 [==>...........................] - ETA: 25s - loss: 0.0599 - acc: 0.9839
 192/1506 [==>...........................] - ETA: 24s - loss: 0.0610 - acc: 0.9843
 224/1506 [===>..........................] - ETA: 24s - loss: 0.0700 - acc: 0.9813
 256/1506 [====>.........................] - ETA: 23s - loss: 0.0690 - acc: 0.9818
 288/1506 [====>.........................] - ETA: 23s - loss: 0.0746 - acc: 0.9807
 320/1506 [=====>........................] - ETA: 22s - loss: 0.0734 - acc: 0.9810
 352/1506 [======>.......................] - ETA: 21s - loss: 0.0761 - acc: 0.9799
 384/1506 [======>.......................] - ETA: 21s - loss: 0.0767 - acc: 0.9793
 416/1506 [=======>......................] - ETA: 20s - loss: 0.0784 - acc: 0.9784
 448/1506 [=======>......................] - ETA: 19s - loss: 0.0778 - acc: 0.9780
 480/1506 [========>.....................] - ETA: 19s - loss: 0.0775 - acc: 0.9780
 512/1506 [=========>....................] - ETA: 18s - loss: 0.0755 - acc: 0.9787
 544/1506 [=========>....................] - ETA: 18s - loss: 0.0773 - acc: 0.9779
 576/1506 [==========>...................] - ETA: 17s - loss: 0.0789 - acc: 0.9771
 608/1506 [===========>..................] - ETA: 16s - loss: 0.0789 - acc: 0.9770
 640/1506 [===========>..................] - ETA: 16s - loss: 0.0792 - acc: 0.9771
 672/1506 [============>.................] - ETA: 15s - loss: 0.0775 - acc: 0.9777
 704/1506 [=============>................] - ETA: 15s - loss: 0.0770 - acc: 0.9779
 736/1506 [=============>................] - ETA: 14s - loss: 0.0779 - acc: 0.9775
 768/1506 [==============>...............] - ETA: 13s - loss: 0.0773 - acc: 0.9777
 800/1506 [==============>...............] - ETA: 13s - loss: 0.0804 - acc: 0.9766
 832/1506 [===============>..............] - ETA: 12s - loss: 0.0807 - acc: 0.9763
 864/1506 [================>.............] - ETA: 12s - loss: 0.0797 - acc: 0.9766
 896/1506 [================>.............] - ETA: 11s - loss: 0.0790 - acc: 0.9769
 928/1506 [=================>............] - ETA: 10s - loss: 0.0801 - acc: 0.9765
 960/1506 [==================>...........] - ETA: 10s - loss: 0.0797 - acc: 0.9765
 992/1506 [==================>...........] - ETA: 9s - loss: 0.0796 - acc: 0.9768 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.0788 - acc: 0.9770
1056/1506 [====================>.........] - ETA: 8s - loss: 0.0784 - acc: 0.9772
1088/1506 [====================>.........] - ETA: 7s - loss: 0.0778 - acc: 0.9776
1120/1506 [=====================>........] - ETA: 7s - loss: 0.0777 - acc: 0.9777
1152/1506 [=====================>........] - ETA: 6s - loss: 0.0775 - acc: 0.9776
1184/1506 [======================>.......] - ETA: 6s - loss: 0.0770 - acc: 0.9777
1216/1506 [=======================>......] - ETA: 5s - loss: 0.0770 - acc: 0.9776
1248/1506 [=======================>......] - ETA: 4s - loss: 0.0772 - acc: 0.9773
1280/1506 [========================>.....] - ETA: 4s - loss: 0.0774 - acc: 0.9773
1312/1506 [=========================>....] - ETA: 3s - loss: 0.0769 - acc: 0.9774
1344/1506 [=========================>....] - ETA: 3s - loss: 0.0763 - acc: 0.9776
1376/1506 [==========================>...] - ETA: 2s - loss: 0.0763 - acc: 0.9774
1408/1506 [===========================>..] - ETA: 1s - loss: 0.0765 - acc: 0.9774
1440/1506 [===========================>..] - ETA: 1s - loss: 0.0769 - acc: 0.9773
1472/1506 [============================>.] - ETA: 0s - loss: 0.0777 - acc: 0.9768
1504/1506 [============================>.] - ETA: 0s - loss: 0.0777 - acc: 0.9768
1506/1506 [==============================] - 30s 20ms/step - loss: 0.0776 - acc: 0.9768 - val_loss: 0.1415 - val_acc: 0.9585
Computing...
Manual evaluation: (didn't understand why I made this)
True 8253
False 818
True percentage 0.9098225113
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.92      0.84      0.88       438
      B-LOC       0.72      0.80      0.75       218
      B-ORG       0.77      0.74      0.76       296
      I-ORG       0.67      0.61      0.64       151
      I-PER       0.92      0.63      0.75       214
      I-LOC       0.70      0.79      0.74       141
     B-MISC       0.50      0.28      0.36       141
     I-MISC       0.53      0.41      0.46       154

avg / total       0.94      0.91      0.92      9071

F-1 Score:
0.72393007836
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 1674 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 237
OOV word occurences: 324
Padding...
Data padded!
Padding...
Data padded!
Padded until 83 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,992,194
Trainable params: 6,992,194
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1506 samples, validate on 168 samples
Epoch 1/70

  32/1506 [..............................] - ETA: 2:08 - loss: 2.2649 - acc: 0.0298
  64/1506 [>.............................] - ETA: 1:18 - loss: 1.5707 - acc: 0.4238
  96/1506 [>.............................] - ETA: 1:01 - loss: 1.5259 - acc: 0.5471
 128/1506 [=>............................] - ETA: 52s - loss: 1.5270 - acc: 0.6016 
 160/1506 [==>...........................] - ETA: 46s - loss: 1.3739 - acc: 0.6446
 192/1506 [==>...........................] - ETA: 42s - loss: 1.2588 - acc: 0.6760
 224/1506 [===>..........................] - ETA: 38s - loss: 1.1800 - acc: 0.6954
 256/1506 [====>.........................] - ETA: 36s - loss: 1.1128 - acc: 0.7099
 288/1506 [====>.........................] - ETA: 34s - loss: 1.0653 - acc: 0.7195
 320/1506 [=====>........................] - ETA: 32s - loss: 1.0284 - acc: 0.7267
 352/1506 [======>.......................] - ETA: 30s - loss: 0.9794 - acc: 0.7380
 384/1506 [======>.......................] - ETA: 29s - loss: 0.9497 - acc: 0.7431
 416/1506 [=======>......................] - ETA: 27s - loss: 0.9182 - acc: 0.7501
 448/1506 [=======>......................] - ETA: 26s - loss: 0.8832 - acc: 0.7586
 480/1506 [========>.....................] - ETA: 25s - loss: 0.8629 - acc: 0.7630
 512/1506 [=========>....................] - ETA: 24s - loss: 0.8384 - acc: 0.7691
 544/1506 [=========>....................] - ETA: 23s - loss: 0.8244 - acc: 0.7720
 576/1506 [==========>...................] - ETA: 22s - loss: 0.8134 - acc: 0.7760
 608/1506 [===========>..................] - ETA: 21s - loss: 0.8022 - acc: 0.7775
 640/1506 [===========>..................] - ETA: 20s - loss: 0.7885 - acc: 0.7812
 672/1506 [============>.................] - ETA: 19s - loss: 0.7711 - acc: 0.7857
 704/1506 [=============>................] - ETA: 18s - loss: 0.7580 - acc: 0.7882
 736/1506 [=============>................] - ETA: 17s - loss: 0.7442 - acc: 0.7916
 768/1506 [==============>...............] - ETA: 16s - loss: 0.7292 - acc: 0.7949
 800/1506 [==============>...............] - ETA: 15s - loss: 0.7159 - acc: 0.7982
 832/1506 [===============>..............] - ETA: 15s - loss: 0.7071 - acc: 0.8005
 864/1506 [================>.............] - ETA: 14s - loss: 0.6968 - acc: 0.8032
 896/1506 [================>.............] - ETA: 13s - loss: 0.6885 - acc: 0.8053
 928/1506 [=================>............] - ETA: 12s - loss: 0.6778 - acc: 0.8084
 960/1506 [==================>...........] - ETA: 12s - loss: 0.6687 - acc: 0.8103
 992/1506 [==================>...........] - ETA: 11s - loss: 0.6616 - acc: 0.8119
1024/1506 [===================>..........] - ETA: 10s - loss: 0.6513 - acc: 0.8151
1056/1506 [====================>.........] - ETA: 9s - loss: 0.6434 - acc: 0.8171 
1088/1506 [====================>.........] - ETA: 9s - loss: 0.6337 - acc: 0.8196
1120/1506 [=====================>........] - ETA: 8s - loss: 0.6266 - acc: 0.8215
1152/1506 [=====================>........] - ETA: 7s - loss: 0.6239 - acc: 0.8220
1184/1506 [======================>.......] - ETA: 6s - loss: 0.6207 - acc: 0.8237
1216/1506 [=======================>......] - ETA: 6s - loss: 0.6149 - acc: 0.8250
1248/1506 [=======================>......] - ETA: 5s - loss: 0.6085 - acc: 0.8267
1280/1506 [========================>.....] - ETA: 4s - loss: 0.6022 - acc: 0.8286
1312/1506 [=========================>....] - ETA: 4s - loss: 0.5961 - acc: 0.8302
1344/1506 [=========================>....] - ETA: 3s - loss: 0.5913 - acc: 0.8311
1376/1506 [==========================>...] - ETA: 2s - loss: 0.5875 - acc: 0.8321
1408/1506 [===========================>..] - ETA: 2s - loss: 0.5832 - acc: 0.8328
1440/1506 [===========================>..] - ETA: 1s - loss: 0.5775 - acc: 0.8342
1472/1506 [============================>.] - ETA: 0s - loss: 0.5707 - acc: 0.8362
1504/1506 [============================>.] - ETA: 0s - loss: 0.5650 - acc: 0.8376
1506/1506 [==============================] - 33s 22ms/step - loss: 0.5651 - acc: 0.8375 - val_loss: 0.3617 - val_acc: 0.8806
Epoch 2/70

  32/1506 [..............................] - ETA: 28s - loss: 0.4343 - acc: 0.8578
  64/1506 [>.............................] - ETA: 27s - loss: 0.3754 - acc: 0.8866
  96/1506 [>.............................] - ETA: 27s - loss: 0.3532 - acc: 0.8943
 128/1506 [=>............................] - ETA: 26s - loss: 0.3398 - acc: 0.8961
 160/1506 [==>...........................] - ETA: 25s - loss: 0.3368 - acc: 0.8971
 192/1506 [==>...........................] - ETA: 25s - loss: 0.3212 - acc: 0.9017
 224/1506 [===>..........................] - ETA: 24s - loss: 0.3099 - acc: 0.9056
 256/1506 [====>.........................] - ETA: 23s - loss: 0.3132 - acc: 0.9042
 288/1506 [====>.........................] - ETA: 23s - loss: 0.3046 - acc: 0.9061
 320/1506 [=====>........................] - ETA: 22s - loss: 0.2946 - acc: 0.9091
 352/1506 [======>.......................] - ETA: 22s - loss: 0.2933 - acc: 0.9101
 384/1506 [======>.......................] - ETA: 21s - loss: 0.2929 - acc: 0.9103
 416/1506 [=======>......................] - ETA: 20s - loss: 0.2892 - acc: 0.9109
 448/1506 [=======>......................] - ETA: 20s - loss: 0.2913 - acc: 0.9094
 480/1506 [========>.....................] - ETA: 19s - loss: 0.2856 - acc: 0.9118
 512/1506 [=========>....................] - ETA: 18s - loss: 0.2905 - acc: 0.9098
 544/1506 [=========>....................] - ETA: 18s - loss: 0.2881 - acc: 0.9109
 576/1506 [==========>...................] - ETA: 17s - loss: 0.2836 - acc: 0.9123
 608/1506 [===========>..................] - ETA: 17s - loss: 0.2865 - acc: 0.9103
 640/1506 [===========>..................] - ETA: 16s - loss: 0.2883 - acc: 0.9106
 672/1506 [============>.................] - ETA: 15s - loss: 0.2912 - acc: 0.9089
 704/1506 [=============>................] - ETA: 15s - loss: 0.2913 - acc: 0.9089
 736/1506 [=============>................] - ETA: 14s - loss: 0.2921 - acc: 0.9083
 768/1506 [==============>...............] - ETA: 13s - loss: 0.2895 - acc: 0.9089
 800/1506 [==============>...............] - ETA: 13s - loss: 0.2899 - acc: 0.9082
 832/1506 [===============>..............] - ETA: 12s - loss: 0.2894 - acc: 0.9082
 864/1506 [================>.............] - ETA: 12s - loss: 0.2869 - acc: 0.9092
 896/1506 [================>.............] - ETA: 11s - loss: 0.2881 - acc: 0.9085
 928/1506 [=================>............] - ETA: 10s - loss: 0.2853 - acc: 0.9098
 960/1506 [==================>...........] - ETA: 10s - loss: 0.2817 - acc: 0.9110
 992/1506 [==================>...........] - ETA: 9s - loss: 0.2792 - acc: 0.9117 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.2755 - acc: 0.9128
1056/1506 [====================>.........] - ETA: 8s - loss: 0.2748 - acc: 0.9130
1088/1506 [====================>.........] - ETA: 7s - loss: 0.2755 - acc: 0.9129
1120/1506 [=====================>........] - ETA: 7s - loss: 0.2739 - acc: 0.9133
1152/1506 [=====================>........] - ETA: 6s - loss: 0.2740 - acc: 0.9135
1184/1506 [======================>.......] - ETA: 6s - loss: 0.2722 - acc: 0.9146
1216/1506 [=======================>......] - ETA: 5s - loss: 0.2693 - acc: 0.9155
1248/1506 [=======================>......] - ETA: 4s - loss: 0.2698 - acc: 0.9156
1280/1506 [========================>.....] - ETA: 4s - loss: 0.2689 - acc: 0.9157
1312/1506 [=========================>....] - ETA: 3s - loss: 0.2684 - acc: 0.9159
1344/1506 [=========================>....] - ETA: 3s - loss: 0.2676 - acc: 0.9162
1376/1506 [==========================>...] - ETA: 2s - loss: 0.2666 - acc: 0.9166
1408/1506 [===========================>..] - ETA: 1s - loss: 0.2664 - acc: 0.9167
1440/1506 [===========================>..] - ETA: 1s - loss: 0.2656 - acc: 0.9168
1472/1506 [============================>.] - ETA: 0s - loss: 0.2672 - acc: 0.9163
1504/1506 [============================>.] - ETA: 0s - loss: 0.2667 - acc: 0.9164
1506/1506 [==============================] - 30s 20ms/step - loss: 0.2672 - acc: 0.9163 - val_loss: 0.4001 - val_acc: 0.8657
Epoch 3/70

  32/1506 [..............................] - ETA: 27s - loss: 0.5647 - acc: 0.8046
  64/1506 [>.............................] - ETA: 27s - loss: 0.3879 - acc: 0.8711
  96/1506 [>.............................] - ETA: 26s - loss: 0.3182 - acc: 0.8960
 128/1506 [=>............................] - ETA: 25s - loss: 0.3272 - acc: 0.8932
 160/1506 [==>...........................] - ETA: 25s - loss: 0.3049 - acc: 0.9005
 192/1506 [==>...........................] - ETA: 24s - loss: 0.2904 - acc: 0.9053
 224/1506 [===>..........................] - ETA: 24s - loss: 0.2955 - acc: 0.9059
 256/1506 [====>.........................] - ETA: 23s - loss: 0.2849 - acc: 0.9102
 288/1506 [====>.........................] - ETA: 22s - loss: 0.2730 - acc: 0.9145
 320/1506 [=====>........................] - ETA: 22s - loss: 0.2724 - acc: 0.9151
 352/1506 [======>.......................] - ETA: 21s - loss: 0.2657 - acc: 0.9176
 384/1506 [======>.......................] - ETA: 21s - loss: 0.2627 - acc: 0.9198
 416/1506 [=======>......................] - ETA: 20s - loss: 0.2631 - acc: 0.9192
 448/1506 [=======>......................] - ETA: 19s - loss: 0.2599 - acc: 0.9195
 480/1506 [========>.....................] - ETA: 19s - loss: 0.2550 - acc: 0.9221
 512/1506 [=========>....................] - ETA: 18s - loss: 0.2501 - acc: 0.9236
 544/1506 [=========>....................] - ETA: 18s - loss: 0.2474 - acc: 0.9245
 576/1506 [==========>...................] - ETA: 17s - loss: 0.2496 - acc: 0.9245
 608/1506 [===========>..................] - ETA: 16s - loss: 0.2454 - acc: 0.9254
 640/1506 [===========>..................] - ETA: 16s - loss: 0.2444 - acc: 0.9257
 672/1506 [============>.................] - ETA: 15s - loss: 0.2407 - acc: 0.9264
 704/1506 [=============>................] - ETA: 15s - loss: 0.2398 - acc: 0.9263
 736/1506 [=============>................] - ETA: 14s - loss: 0.2392 - acc: 0.9264
 768/1506 [==============>...............] - ETA: 13s - loss: 0.2376 - acc: 0.9268
 800/1506 [==============>...............] - ETA: 13s - loss: 0.2359 - acc: 0.9274
 832/1506 [===============>..............] - ETA: 12s - loss: 0.2353 - acc: 0.9273
 864/1506 [================>.............] - ETA: 12s - loss: 0.2332 - acc: 0.9279
 896/1506 [================>.............] - ETA: 11s - loss: 0.2331 - acc: 0.9281
 928/1506 [=================>............] - ETA: 10s - loss: 0.2314 - acc: 0.9290
 960/1506 [==================>...........] - ETA: 10s - loss: 0.2307 - acc: 0.9293
 992/1506 [==================>...........] - ETA: 9s - loss: 0.2303 - acc: 0.9297 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.2291 - acc: 0.9299
1056/1506 [====================>.........] - ETA: 8s - loss: 0.2274 - acc: 0.9301
1088/1506 [====================>.........] - ETA: 7s - loss: 0.2259 - acc: 0.9308
1120/1506 [=====================>........] - ETA: 7s - loss: 0.2253 - acc: 0.9308
1152/1506 [=====================>........] - ETA: 6s - loss: 0.2232 - acc: 0.9313
1184/1506 [======================>.......] - ETA: 6s - loss: 0.2214 - acc: 0.9318
1216/1506 [=======================>......] - ETA: 5s - loss: 0.2207 - acc: 0.9318
1248/1506 [=======================>......] - ETA: 4s - loss: 0.2211 - acc: 0.9315
1280/1506 [========================>.....] - ETA: 4s - loss: 0.2225 - acc: 0.9311
1312/1506 [=========================>....] - ETA: 3s - loss: 0.2210 - acc: 0.9314
1344/1506 [=========================>....] - ETA: 3s - loss: 0.2207 - acc: 0.9316
1376/1506 [==========================>...] - ETA: 2s - loss: 0.2197 - acc: 0.9319
1408/1506 [===========================>..] - ETA: 1s - loss: 0.2198 - acc: 0.9315
1440/1506 [===========================>..] - ETA: 1s - loss: 0.2181 - acc: 0.9321
1472/1506 [============================>.] - ETA: 0s - loss: 0.2185 - acc: 0.9321
1504/1506 [============================>.] - ETA: 0s - loss: 0.2184 - acc: 0.9319
1506/1506 [==============================] - 30s 20ms/step - loss: 0.2182 - acc: 0.9320 - val_loss: 0.1758 - val_acc: 0.9486
Epoch 4/70

  32/1506 [..............................] - ETA: 27s - loss: 0.1980 - acc: 0.9338
  64/1506 [>.............................] - ETA: 26s - loss: 0.1933 - acc: 0.9296
  96/1506 [>.............................] - ETA: 26s - loss: 0.2002 - acc: 0.9324
 128/1506 [=>............................] - ETA: 25s - loss: 0.1899 - acc: 0.9344
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1868 - acc: 0.9364
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1815 - acc: 0.9380
 224/1506 [===>..........................] - ETA: 23s - loss: 0.1797 - acc: 0.9376
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1814 - acc: 0.9382
 288/1506 [====>.........................] - ETA: 22s - loss: 0.1823 - acc: 0.9390
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1936 - acc: 0.9349
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1880 - acc: 0.9369
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1881 - acc: 0.9374
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1862 - acc: 0.9384
 448/1506 [=======>......................] - ETA: 19s - loss: 0.1875 - acc: 0.9387
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1874 - acc: 0.9384
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1853 - acc: 0.9394
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1857 - acc: 0.9393
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1860 - acc: 0.9392
 608/1506 [===========>..................] - ETA: 16s - loss: 0.1890 - acc: 0.9386
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1907 - acc: 0.9378
 672/1506 [============>.................] - ETA: 15s - loss: 0.1881 - acc: 0.9386
 704/1506 [=============>................] - ETA: 15s - loss: 0.1884 - acc: 0.9382
 736/1506 [=============>................] - ETA: 14s - loss: 0.1867 - acc: 0.9388
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1871 - acc: 0.9389
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1880 - acc: 0.9378
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1870 - acc: 0.9382
 864/1506 [================>.............] - ETA: 12s - loss: 0.1893 - acc: 0.9380
 896/1506 [================>.............] - ETA: 11s - loss: 0.1896 - acc: 0.9380
 928/1506 [=================>............] - ETA: 10s - loss: 0.1887 - acc: 0.9383
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1877 - acc: 0.9386
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1866 - acc: 0.9391 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1858 - acc: 0.9396
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1869 - acc: 0.9394
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1869 - acc: 0.9394
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1879 - acc: 0.9388
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1874 - acc: 0.9392
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1858 - acc: 0.9397
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1862 - acc: 0.9396
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1850 - acc: 0.9400
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1860 - acc: 0.9397
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1856 - acc: 0.9398
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1854 - acc: 0.9398
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1845 - acc: 0.9402
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1837 - acc: 0.9403
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1848 - acc: 0.9400
1472/1506 [============================>.] - ETA: 0s - loss: 0.1839 - acc: 0.9403
1504/1506 [============================>.] - ETA: 0s - loss: 0.1847 - acc: 0.9402
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1850 - acc: 0.9401 - val_loss: 0.2642 - val_acc: 0.9174
Epoch 5/70

  32/1506 [..............................] - ETA: 28s - loss: 0.2397 - acc: 0.9104
  64/1506 [>.............................] - ETA: 27s - loss: 0.2031 - acc: 0.9286
  96/1506 [>.............................] - ETA: 26s - loss: 0.2076 - acc: 0.9303
 128/1506 [=>............................] - ETA: 26s - loss: 0.1972 - acc: 0.9345
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1937 - acc: 0.9356
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1853 - acc: 0.9399
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1738 - acc: 0.9442
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1760 - acc: 0.9438
 288/1506 [====>.........................] - ETA: 23s - loss: 0.1769 - acc: 0.9445
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1765 - acc: 0.9442
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1779 - acc: 0.9438
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1767 - acc: 0.9440
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1758 - acc: 0.9446
 448/1506 [=======>......................] - ETA: 19s - loss: 0.1747 - acc: 0.9451
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1737 - acc: 0.9452
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1710 - acc: 0.9464
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1673 - acc: 0.9478
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1655 - acc: 0.9480
 608/1506 [===========>..................] - ETA: 16s - loss: 0.1637 - acc: 0.9485
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1630 - acc: 0.9488
 672/1506 [============>.................] - ETA: 15s - loss: 0.1624 - acc: 0.9491
 704/1506 [=============>................] - ETA: 15s - loss: 0.1640 - acc: 0.9486
 736/1506 [=============>................] - ETA: 14s - loss: 0.1618 - acc: 0.9494
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1622 - acc: 0.9494
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1634 - acc: 0.9488
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1617 - acc: 0.9492
 864/1506 [================>.............] - ETA: 12s - loss: 0.1631 - acc: 0.9487
 896/1506 [================>.............] - ETA: 11s - loss: 0.1624 - acc: 0.9492
 928/1506 [=================>............] - ETA: 10s - loss: 0.1619 - acc: 0.9493
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1612 - acc: 0.9495
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1594 - acc: 0.9501 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1581 - acc: 0.9506
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1583 - acc: 0.9503
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1600 - acc: 0.9504
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1598 - acc: 0.9502
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1585 - acc: 0.9506
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1577 - acc: 0.9510
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1604 - acc: 0.9498
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1618 - acc: 0.9491
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1629 - acc: 0.9487
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1622 - acc: 0.9489
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1626 - acc: 0.9486
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1630 - acc: 0.9484
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1621 - acc: 0.9490
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1631 - acc: 0.9488
1472/1506 [============================>.] - ETA: 0s - loss: 0.1614 - acc: 0.9496
1504/1506 [============================>.] - ETA: 0s - loss: 0.1618 - acc: 0.9494
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1620 - acc: 0.9494 - val_loss: 0.2659 - val_acc: 0.9076
Computing...
Manual evaluation: (didn't understand why I made this)
True 7804
False 1267
True percentage 0.8603241098
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.77      0.43      0.55       296
      B-LOC       0.39      0.89      0.54       218
      I-ORG       0.54      0.09      0.16       151
     B-MISC       0.24      0.04      0.07       141
     I-MISC       0.47      0.05      0.08       154
      B-PER       0.96      0.58      0.72       438
      I-PER       0.99      0.39      0.56       214
      I-LOC       0.24      0.90      0.38       141

avg / total       0.92      0.86      0.87      9071

F-1 Score:
0.481261154075
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 1674 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 237
OOV word occurences: 324
Padding...
Data padded!
Padding...
Data padded!
Padded until 83 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,992,194
Trainable params: 6,992,194
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1506 samples, validate on 168 samples
Epoch 1/70

  32/1506 [..............................] - ETA: 2:12 - loss: 2.1893 - acc: 0.0652
  64/1506 [>.............................] - ETA: 1:20 - loss: 1.4404 - acc: 0.4632
  96/1506 [>.............................] - ETA: 1:01 - loss: 1.6461 - acc: 0.5819
 128/1506 [=>............................] - ETA: 52s - loss: 1.5323 - acc: 0.6362 
 160/1506 [==>...........................] - ETA: 46s - loss: 1.3936 - acc: 0.6724
 192/1506 [==>...........................] - ETA: 41s - loss: 1.2941 - acc: 0.6950
 224/1506 [===>..........................] - ETA: 38s - loss: 1.2252 - acc: 0.7071
 256/1506 [====>.........................] - ETA: 35s - loss: 1.1663 - acc: 0.7206
 288/1506 [====>.........................] - ETA: 33s - loss: 1.1147 - acc: 0.7302
 320/1506 [=====>........................] - ETA: 31s - loss: 1.0766 - acc: 0.7373
 352/1506 [======>.......................] - ETA: 29s - loss: 1.0518 - acc: 0.7391
 384/1506 [======>.......................] - ETA: 28s - loss: 1.0115 - acc: 0.7475
 416/1506 [=======>......................] - ETA: 27s - loss: 0.9791 - acc: 0.7527
 448/1506 [=======>......................] - ETA: 25s - loss: 0.9410 - acc: 0.7613
 480/1506 [========>.....................] - ETA: 24s - loss: 0.9153 - acc: 0.7671
 512/1506 [=========>....................] - ETA: 23s - loss: 0.8997 - acc: 0.7706
 544/1506 [=========>....................] - ETA: 22s - loss: 0.8782 - acc: 0.7749
 576/1506 [==========>...................] - ETA: 21s - loss: 0.8584 - acc: 0.7781
 608/1506 [===========>..................] - ETA: 20s - loss: 0.8418 - acc: 0.7812
 640/1506 [===========>..................] - ETA: 19s - loss: 0.8248 - acc: 0.7845
 672/1506 [============>.................] - ETA: 19s - loss: 0.8055 - acc: 0.7886
 704/1506 [=============>................] - ETA: 18s - loss: 0.7913 - acc: 0.7913
 736/1506 [=============>................] - ETA: 17s - loss: 0.7774 - acc: 0.7943
 768/1506 [==============>...............] - ETA: 16s - loss: 0.7615 - acc: 0.7976
 800/1506 [==============>...............] - ETA: 15s - loss: 0.7493 - acc: 0.8001
 832/1506 [===============>..............] - ETA: 15s - loss: 0.7384 - acc: 0.8018
 864/1506 [================>.............] - ETA: 14s - loss: 0.7258 - acc: 0.8041
 896/1506 [================>.............] - ETA: 13s - loss: 0.7146 - acc: 0.8069
 928/1506 [=================>............] - ETA: 12s - loss: 0.7153 - acc: 0.8074
 960/1506 [==================>...........] - ETA: 11s - loss: 0.7175 - acc: 0.8071
 992/1506 [==================>...........] - ETA: 11s - loss: 0.7094 - acc: 0.8094
1024/1506 [===================>..........] - ETA: 10s - loss: 0.7029 - acc: 0.8106
1056/1506 [====================>.........] - ETA: 9s - loss: 0.6939 - acc: 0.8130 
1088/1506 [====================>.........] - ETA: 9s - loss: 0.6849 - acc: 0.8153
1120/1506 [=====================>........] - ETA: 8s - loss: 0.6758 - acc: 0.8176
1152/1506 [=====================>........] - ETA: 7s - loss: 0.6687 - acc: 0.8193
1184/1506 [======================>.......] - ETA: 6s - loss: 0.6607 - acc: 0.8212
1216/1506 [=======================>......] - ETA: 6s - loss: 0.6551 - acc: 0.8221
1248/1506 [=======================>......] - ETA: 5s - loss: 0.6483 - acc: 0.8239
1280/1506 [========================>.....] - ETA: 4s - loss: 0.6414 - acc: 0.8251
1312/1506 [=========================>....] - ETA: 4s - loss: 0.6353 - acc: 0.8263
1344/1506 [=========================>....] - ETA: 3s - loss: 0.6286 - acc: 0.8280
1376/1506 [==========================>...] - ETA: 2s - loss: 0.6216 - acc: 0.8296
1408/1506 [===========================>..] - ETA: 2s - loss: 0.6155 - acc: 0.8313
1440/1506 [===========================>..] - ETA: 1s - loss: 0.6099 - acc: 0.8326
1472/1506 [============================>.] - ETA: 0s - loss: 0.6026 - acc: 0.8347
1504/1506 [============================>.] - ETA: 0s - loss: 0.5953 - acc: 0.8363
1506/1506 [==============================] - 33s 22ms/step - loss: 0.5947 - acc: 0.8365 - val_loss: 0.3803 - val_acc: 0.8745
Epoch 2/70

  32/1506 [..............................] - ETA: 27s - loss: 0.2705 - acc: 0.9129
  64/1506 [>.............................] - ETA: 27s - loss: 0.2928 - acc: 0.9000
  96/1506 [>.............................] - ETA: 26s - loss: 0.2891 - acc: 0.9087
 128/1506 [=>............................] - ETA: 26s - loss: 0.2944 - acc: 0.9063
 160/1506 [==>...........................] - ETA: 25s - loss: 0.2963 - acc: 0.9075
 192/1506 [==>...........................] - ETA: 24s - loss: 0.2941 - acc: 0.9076
 224/1506 [===>..........................] - ETA: 24s - loss: 0.2924 - acc: 0.9082
 256/1506 [====>.........................] - ETA: 23s - loss: 0.3093 - acc: 0.9038
 288/1506 [====>.........................] - ETA: 23s - loss: 0.3079 - acc: 0.9037
 320/1506 [=====>........................] - ETA: 22s - loss: 0.3068 - acc: 0.9040
 352/1506 [======>.......................] - ETA: 21s - loss: 0.3034 - acc: 0.9047
 384/1506 [======>.......................] - ETA: 21s - loss: 0.3016 - acc: 0.9066
 416/1506 [=======>......................] - ETA: 20s - loss: 0.3040 - acc: 0.9057
 448/1506 [=======>......................] - ETA: 20s - loss: 0.3049 - acc: 0.9056
 480/1506 [========>.....................] - ETA: 19s - loss: 0.2992 - acc: 0.9076
 512/1506 [=========>....................] - ETA: 18s - loss: 0.3026 - acc: 0.9066
 544/1506 [=========>....................] - ETA: 18s - loss: 0.3036 - acc: 0.9059
 576/1506 [==========>...................] - ETA: 17s - loss: 0.3066 - acc: 0.9050
 608/1506 [===========>..................] - ETA: 17s - loss: 0.3043 - acc: 0.9056
 640/1506 [===========>..................] - ETA: 16s - loss: 0.3028 - acc: 0.9059
 672/1506 [============>.................] - ETA: 15s - loss: 0.3017 - acc: 0.9064
 704/1506 [=============>................] - ETA: 15s - loss: 0.3021 - acc: 0.9057
 736/1506 [=============>................] - ETA: 14s - loss: 0.2999 - acc: 0.9068
 768/1506 [==============>...............] - ETA: 14s - loss: 0.3005 - acc: 0.9067
 800/1506 [==============>...............] - ETA: 13s - loss: 0.2985 - acc: 0.9072
 832/1506 [===============>..............] - ETA: 12s - loss: 0.2989 - acc: 0.9078
 864/1506 [================>.............] - ETA: 12s - loss: 0.2985 - acc: 0.9079
 896/1506 [================>.............] - ETA: 11s - loss: 0.2976 - acc: 0.9076
 928/1506 [=================>............] - ETA: 10s - loss: 0.2964 - acc: 0.9086
 960/1506 [==================>...........] - ETA: 10s - loss: 0.2951 - acc: 0.9090
 992/1506 [==================>...........] - ETA: 9s - loss: 0.2927 - acc: 0.9097 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.2915 - acc: 0.9102
1056/1506 [====================>.........] - ETA: 8s - loss: 0.2914 - acc: 0.9103
1088/1506 [====================>.........] - ETA: 7s - loss: 0.2896 - acc: 0.9110
1120/1506 [=====================>........] - ETA: 7s - loss: 0.2874 - acc: 0.9118
1152/1506 [=====================>........] - ETA: 6s - loss: 0.2863 - acc: 0.9123
1184/1506 [======================>.......] - ETA: 6s - loss: 0.2891 - acc: 0.9111
1216/1506 [=======================>......] - ETA: 5s - loss: 0.2893 - acc: 0.9109
1248/1506 [=======================>......] - ETA: 4s - loss: 0.2877 - acc: 0.9116
1280/1506 [========================>.....] - ETA: 4s - loss: 0.2874 - acc: 0.9113
1312/1506 [=========================>....] - ETA: 3s - loss: 0.2864 - acc: 0.9113
1344/1506 [=========================>....] - ETA: 3s - loss: 0.2843 - acc: 0.9122
1376/1506 [==========================>...] - ETA: 2s - loss: 0.2827 - acc: 0.9125
1408/1506 [===========================>..] - ETA: 1s - loss: 0.2808 - acc: 0.9131
1440/1506 [===========================>..] - ETA: 1s - loss: 0.2806 - acc: 0.9129
1472/1506 [============================>.] - ETA: 0s - loss: 0.2797 - acc: 0.9134
1504/1506 [============================>.] - ETA: 0s - loss: 0.2776 - acc: 0.9141
1506/1506 [==============================] - 30s 20ms/step - loss: 0.2777 - acc: 0.9141 - val_loss: 0.2824 - val_acc: 0.9084
Epoch 3/70

  32/1506 [..............................] - ETA: 27s - loss: 0.3918 - acc: 0.8698
  64/1506 [>.............................] - ETA: 27s - loss: 0.3159 - acc: 0.9034
  96/1506 [>.............................] - ETA: 26s - loss: 0.2697 - acc: 0.9197
 128/1506 [=>............................] - ETA: 25s - loss: 0.2653 - acc: 0.9210
 160/1506 [==>...........................] - ETA: 25s - loss: 0.2524 - acc: 0.9241
 192/1506 [==>...........................] - ETA: 24s - loss: 0.2403 - acc: 0.9282
 224/1506 [===>..........................] - ETA: 24s - loss: 0.2281 - acc: 0.9317
 256/1506 [====>.........................] - ETA: 23s - loss: 0.2344 - acc: 0.9290
 288/1506 [====>.........................] - ETA: 22s - loss: 0.2312 - acc: 0.9303
 320/1506 [=====>........................] - ETA: 22s - loss: 0.2295 - acc: 0.9313
 352/1506 [======>.......................] - ETA: 21s - loss: 0.2333 - acc: 0.9296
 384/1506 [======>.......................] - ETA: 21s - loss: 0.2247 - acc: 0.9330
 416/1506 [=======>......................] - ETA: 20s - loss: 0.2266 - acc: 0.9320
 448/1506 [=======>......................] - ETA: 19s - loss: 0.2247 - acc: 0.9328
 480/1506 [========>.....................] - ETA: 19s - loss: 0.2252 - acc: 0.9330
 512/1506 [=========>....................] - ETA: 18s - loss: 0.2243 - acc: 0.9324
 544/1506 [=========>....................] - ETA: 18s - loss: 0.2277 - acc: 0.9319
 576/1506 [==========>...................] - ETA: 17s - loss: 0.2299 - acc: 0.9312
 608/1506 [===========>..................] - ETA: 16s - loss: 0.2258 - acc: 0.9324
 640/1506 [===========>..................] - ETA: 16s - loss: 0.2285 - acc: 0.9316
 672/1506 [============>.................] - ETA: 15s - loss: 0.2274 - acc: 0.9315
 704/1506 [=============>................] - ETA: 15s - loss: 0.2273 - acc: 0.9313
 736/1506 [=============>................] - ETA: 14s - loss: 0.2265 - acc: 0.9315
 768/1506 [==============>...............] - ETA: 13s - loss: 0.2279 - acc: 0.9314
 800/1506 [==============>...............] - ETA: 13s - loss: 0.2262 - acc: 0.9316
 832/1506 [===============>..............] - ETA: 12s - loss: 0.2273 - acc: 0.9310
 864/1506 [================>.............] - ETA: 12s - loss: 0.2270 - acc: 0.9308
 896/1506 [================>.............] - ETA: 11s - loss: 0.2237 - acc: 0.9322
 928/1506 [=================>............] - ETA: 10s - loss: 0.2236 - acc: 0.9323
 960/1506 [==================>...........] - ETA: 10s - loss: 0.2227 - acc: 0.9321
 992/1506 [==================>...........] - ETA: 9s - loss: 0.2211 - acc: 0.9325 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.2208 - acc: 0.9327
1056/1506 [====================>.........] - ETA: 8s - loss: 0.2203 - acc: 0.9325
1088/1506 [====================>.........] - ETA: 7s - loss: 0.2199 - acc: 0.9323
1120/1506 [=====================>........] - ETA: 7s - loss: 0.2209 - acc: 0.9318
1152/1506 [=====================>........] - ETA: 6s - loss: 0.2201 - acc: 0.9321
1184/1506 [======================>.......] - ETA: 6s - loss: 0.2189 - acc: 0.9327
1216/1506 [=======================>......] - ETA: 5s - loss: 0.2186 - acc: 0.9326
1248/1506 [=======================>......] - ETA: 4s - loss: 0.2191 - acc: 0.9322
1280/1506 [========================>.....] - ETA: 4s - loss: 0.2210 - acc: 0.9317
1312/1506 [=========================>....] - ETA: 3s - loss: 0.2213 - acc: 0.9312
1344/1506 [=========================>....] - ETA: 3s - loss: 0.2205 - acc: 0.9311
1376/1506 [==========================>...] - ETA: 2s - loss: 0.2186 - acc: 0.9320
1408/1506 [===========================>..] - ETA: 1s - loss: 0.2181 - acc: 0.9324
1440/1506 [===========================>..] - ETA: 1s - loss: 0.2179 - acc: 0.9325
1472/1506 [============================>.] - ETA: 0s - loss: 0.2164 - acc: 0.9331
1504/1506 [============================>.] - ETA: 0s - loss: 0.2161 - acc: 0.9334
1506/1506 [==============================] - 30s 20ms/step - loss: 0.2159 - acc: 0.9334 - val_loss: 0.2369 - val_acc: 0.9224
Epoch 4/70

  32/1506 [..............................] - ETA: 27s - loss: 0.2559 - acc: 0.9235
  64/1506 [>.............................] - ETA: 27s - loss: 0.2250 - acc: 0.9348
  96/1506 [>.............................] - ETA: 26s - loss: 0.2378 - acc: 0.9298
 128/1506 [=>............................] - ETA: 25s - loss: 0.2253 - acc: 0.9307
 160/1506 [==>...........................] - ETA: 25s - loss: 0.2265 - acc: 0.9298
 192/1506 [==>...........................] - ETA: 24s - loss: 0.2158 - acc: 0.9347
 224/1506 [===>..........................] - ETA: 24s - loss: 0.2080 - acc: 0.9370
 256/1506 [====>.........................] - ETA: 23s - loss: 0.2029 - acc: 0.9379
 288/1506 [====>.........................] - ETA: 22s - loss: 0.1959 - acc: 0.9395
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1884 - acc: 0.9422
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1928 - acc: 0.9405
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1990 - acc: 0.9378
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1969 - acc: 0.9385
 448/1506 [=======>......................] - ETA: 19s - loss: 0.1936 - acc: 0.9399
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1912 - acc: 0.9403
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1936 - acc: 0.9400
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1911 - acc: 0.9405
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1908 - acc: 0.9409
 608/1506 [===========>..................] - ETA: 16s - loss: 0.1907 - acc: 0.9408
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1899 - acc: 0.9413
 672/1506 [============>.................] - ETA: 15s - loss: 0.1914 - acc: 0.9406
 704/1506 [=============>................] - ETA: 15s - loss: 0.1911 - acc: 0.9403
 736/1506 [=============>................] - ETA: 14s - loss: 0.1909 - acc: 0.9402
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1907 - acc: 0.9401
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1900 - acc: 0.9405
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1910 - acc: 0.9401
 864/1506 [================>.............] - ETA: 12s - loss: 0.1927 - acc: 0.9395
 896/1506 [================>.............] - ETA: 11s - loss: 0.1920 - acc: 0.9394
 928/1506 [=================>............] - ETA: 10s - loss: 0.1917 - acc: 0.9397
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1912 - acc: 0.9396
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1893 - acc: 0.9402 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1873 - acc: 0.9406
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1872 - acc: 0.9406
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1889 - acc: 0.9398
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1881 - acc: 0.9402
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1870 - acc: 0.9405
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1861 - acc: 0.9407
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1859 - acc: 0.9410
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1856 - acc: 0.9410
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1854 - acc: 0.9408
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1846 - acc: 0.9409
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1840 - acc: 0.9414
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1839 - acc: 0.9417
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1839 - acc: 0.9418
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1828 - acc: 0.9421
1472/1506 [============================>.] - ETA: 0s - loss: 0.1832 - acc: 0.9417
1504/1506 [============================>.] - ETA: 0s - loss: 0.1826 - acc: 0.9420
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1829 - acc: 0.9420 - val_loss: 0.3334 - val_acc: 0.8950
Epoch 5/70

  32/1506 [..............................] - ETA: 27s - loss: 0.2571 - acc: 0.9142
  64/1506 [>.............................] - ETA: 26s - loss: 0.2298 - acc: 0.9225
  96/1506 [>.............................] - ETA: 26s - loss: 0.2221 - acc: 0.9264
 128/1506 [=>............................] - ETA: 25s - loss: 0.2069 - acc: 0.9338
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1872 - acc: 0.9414
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1920 - acc: 0.9414
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1931 - acc: 0.9416
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1915 - acc: 0.9412
 288/1506 [====>.........................] - ETA: 22s - loss: 0.1856 - acc: 0.9426
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1892 - acc: 0.9419
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1834 - acc: 0.9434
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1866 - acc: 0.9416
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1834 - acc: 0.9426
 448/1506 [=======>......................] - ETA: 19s - loss: 0.1798 - acc: 0.9433
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1790 - acc: 0.9440
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1777 - acc: 0.9449
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1800 - acc: 0.9438
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1804 - acc: 0.9438
 608/1506 [===========>..................] - ETA: 16s - loss: 0.1783 - acc: 0.9442
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1774 - acc: 0.9442
 672/1506 [============>.................] - ETA: 15s - loss: 0.1780 - acc: 0.9446
 704/1506 [=============>................] - ETA: 15s - loss: 0.1754 - acc: 0.9454
 736/1506 [=============>................] - ETA: 14s - loss: 0.1741 - acc: 0.9457
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1714 - acc: 0.9464
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1703 - acc: 0.9468
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1692 - acc: 0.9470
 864/1506 [================>.............] - ETA: 12s - loss: 0.1685 - acc: 0.9470
 896/1506 [================>.............] - ETA: 11s - loss: 0.1686 - acc: 0.9468
 928/1506 [=================>............] - ETA: 10s - loss: 0.1699 - acc: 0.9457
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1696 - acc: 0.9458
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1690 - acc: 0.9462 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1684 - acc: 0.9465
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1674 - acc: 0.9467
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1665 - acc: 0.9469
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1664 - acc: 0.9471
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1663 - acc: 0.9472
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1664 - acc: 0.9474
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1657 - acc: 0.9478
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1676 - acc: 0.9472
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1672 - acc: 0.9475
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1665 - acc: 0.9478
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1664 - acc: 0.9476
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1669 - acc: 0.9475
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1655 - acc: 0.9480
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1644 - acc: 0.9483
1472/1506 [============================>.] - ETA: 0s - loss: 0.1632 - acc: 0.9486
1504/1506 [============================>.] - ETA: 0s - loss: 0.1628 - acc: 0.9488
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1627 - acc: 0.9488 - val_loss: 0.2700 - val_acc: 0.9137
Computing...
Manual evaluation: (didn't understand why I made this)
True 8001
False 1070
True percentage 0.88204167126
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.95      0.97      7318
      B-PER       0.88      0.79      0.84       438
      B-ORG       0.48      0.79      0.60       296
      I-ORG       0.31      0.80      0.45       151
      I-PER       0.86      0.60      0.71       214
      B-LOC       0.74      0.64      0.69       218
      I-LOC       0.68      0.77      0.72       141
     B-MISC       0.50      0.01      0.01       141
     I-MISC       1.00      0.01      0.01       154

avg / total       0.94      0.88      0.89      9071

F-1 Score:
0.613810741688
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 1674 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 237
OOV word occurences: 324
Padding...
Data padded!
Padding...
Data padded!
Padded until 83 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,992,194
Trainable params: 6,992,194
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1506 samples, validate on 168 samples
Epoch 1/70

  32/1506 [..............................] - ETA: 2:09 - loss: 2.4504 - acc: 0.0484
  64/1506 [>.............................] - ETA: 1:19 - loss: 1.7436 - acc: 0.4170
  96/1506 [>.............................] - ETA: 1:01 - loss: 2.0382 - acc: 0.5469
 128/1506 [=>............................] - ETA: 52s - loss: 1.7852 - acc: 0.6023 
 160/1506 [==>...........................] - ETA: 46s - loss: 1.5802 - acc: 0.6451
 192/1506 [==>...........................] - ETA: 42s - loss: 1.4715 - acc: 0.6660
 224/1506 [===>..........................] - ETA: 38s - loss: 1.3642 - acc: 0.6879
 256/1506 [====>.........................] - ETA: 36s - loss: 1.2786 - acc: 0.7054
 288/1506 [====>.........................] - ETA: 33s - loss: 1.2134 - acc: 0.7176
 320/1506 [=====>........................] - ETA: 32s - loss: 1.1659 - acc: 0.7235
 352/1506 [======>.......................] - ETA: 30s - loss: 1.1331 - acc: 0.7283
 384/1506 [======>.......................] - ETA: 29s - loss: 1.0897 - acc: 0.7357
 416/1506 [=======>......................] - ETA: 27s - loss: 1.0512 - acc: 0.7420
 448/1506 [=======>......................] - ETA: 26s - loss: 1.0118 - acc: 0.7485
 480/1506 [========>.....................] - ETA: 25s - loss: 0.9821 - acc: 0.7541
 512/1506 [=========>....................] - ETA: 24s - loss: 0.9526 - acc: 0.7597
 544/1506 [=========>....................] - ETA: 23s - loss: 0.9299 - acc: 0.7645
 576/1506 [==========>...................] - ETA: 22s - loss: 0.9110 - acc: 0.7674
 608/1506 [===========>..................] - ETA: 21s - loss: 0.8918 - acc: 0.7725
 640/1506 [===========>..................] - ETA: 20s - loss: 0.8719 - acc: 0.7759
 672/1506 [============>.................] - ETA: 19s - loss: 0.8560 - acc: 0.7809
 704/1506 [=============>................] - ETA: 18s - loss: 0.8396 - acc: 0.7836
 736/1506 [=============>................] - ETA: 17s - loss: 0.8217 - acc: 0.7873
 768/1506 [==============>...............] - ETA: 16s - loss: 0.8053 - acc: 0.7910
 800/1506 [==============>...............] - ETA: 15s - loss: 0.7916 - acc: 0.7929
 832/1506 [===============>..............] - ETA: 15s - loss: 0.7757 - acc: 0.7972
 864/1506 [================>.............] - ETA: 14s - loss: 0.7629 - acc: 0.7998
 896/1506 [================>.............] - ETA: 13s - loss: 0.7490 - acc: 0.8032
 928/1506 [=================>............] - ETA: 12s - loss: 0.7406 - acc: 0.8050
 960/1506 [==================>...........] - ETA: 12s - loss: 0.7280 - acc: 0.8075
 992/1506 [==================>...........] - ETA: 11s - loss: 0.7172 - acc: 0.8096
1024/1506 [===================>..........] - ETA: 10s - loss: 0.7068 - acc: 0.8119
1056/1506 [====================>.........] - ETA: 9s - loss: 0.6944 - acc: 0.8148 
1088/1506 [====================>.........] - ETA: 9s - loss: 0.6837 - acc: 0.8170
1120/1506 [=====================>........] - ETA: 8s - loss: 0.6742 - acc: 0.8186
1152/1506 [=====================>........] - ETA: 7s - loss: 0.6681 - acc: 0.8199
1184/1506 [======================>.......] - ETA: 6s - loss: 0.6617 - acc: 0.8211
1216/1506 [=======================>......] - ETA: 6s - loss: 0.6523 - acc: 0.8240
1248/1506 [=======================>......] - ETA: 5s - loss: 0.6446 - acc: 0.8255
1280/1506 [========================>.....] - ETA: 4s - loss: 0.6400 - acc: 0.8261
1312/1506 [=========================>....] - ETA: 4s - loss: 0.6330 - acc: 0.8278
1344/1506 [=========================>....] - ETA: 3s - loss: 0.6251 - acc: 0.8294
1376/1506 [==========================>...] - ETA: 2s - loss: 0.6186 - acc: 0.8310
1408/1506 [===========================>..] - ETA: 2s - loss: 0.6116 - acc: 0.8326
1440/1506 [===========================>..] - ETA: 1s - loss: 0.6043 - acc: 0.8343
1472/1506 [============================>.] - ETA: 0s - loss: 0.5973 - acc: 0.8363
1504/1506 [============================>.] - ETA: 0s - loss: 0.5899 - acc: 0.8382
1506/1506 [==============================] - 33s 22ms/step - loss: 0.5894 - acc: 0.8383 - val_loss: 0.3075 - val_acc: 0.9016
Epoch 2/70

  32/1506 [..............................] - ETA: 27s - loss: 0.2226 - acc: 0.9343
  64/1506 [>.............................] - ETA: 27s - loss: 0.2637 - acc: 0.9203
  96/1506 [>.............................] - ETA: 26s - loss: 0.3312 - acc: 0.8956
 128/1506 [=>............................] - ETA: 26s - loss: 0.3321 - acc: 0.8945
 160/1506 [==>...........................] - ETA: 25s - loss: 0.3170 - acc: 0.9018
 192/1506 [==>...........................] - ETA: 24s - loss: 0.3045 - acc: 0.9051
 224/1506 [===>..........................] - ETA: 24s - loss: 0.2973 - acc: 0.9071
 256/1506 [====>.........................] - ETA: 23s - loss: 0.2891 - acc: 0.9116
 288/1506 [====>.........................] - ETA: 23s - loss: 0.2916 - acc: 0.9109
 320/1506 [=====>........................] - ETA: 22s - loss: 0.2892 - acc: 0.9121
 352/1506 [======>.......................] - ETA: 21s - loss: 0.2910 - acc: 0.9106
 384/1506 [======>.......................] - ETA: 21s - loss: 0.2908 - acc: 0.9104
 416/1506 [=======>......................] - ETA: 20s - loss: 0.2884 - acc: 0.9116
 448/1506 [=======>......................] - ETA: 20s - loss: 0.2895 - acc: 0.9115
 480/1506 [========>.....................] - ETA: 19s - loss: 0.2871 - acc: 0.9119
 512/1506 [=========>....................] - ETA: 18s - loss: 0.2856 - acc: 0.9123
 544/1506 [=========>....................] - ETA: 18s - loss: 0.2866 - acc: 0.9124
 576/1506 [==========>...................] - ETA: 17s - loss: 0.2874 - acc: 0.9117
 608/1506 [===========>..................] - ETA: 17s - loss: 0.2889 - acc: 0.9102
 640/1506 [===========>..................] - ETA: 16s - loss: 0.2824 - acc: 0.9126
 672/1506 [============>.................] - ETA: 15s - loss: 0.2837 - acc: 0.9117
 704/1506 [=============>................] - ETA: 15s - loss: 0.2847 - acc: 0.9111
 736/1506 [=============>................] - ETA: 14s - loss: 0.2833 - acc: 0.9117
 768/1506 [==============>...............] - ETA: 13s - loss: 0.2812 - acc: 0.9124
 800/1506 [==============>...............] - ETA: 13s - loss: 0.2814 - acc: 0.9120
 832/1506 [===============>..............] - ETA: 12s - loss: 0.2782 - acc: 0.9135
 864/1506 [================>.............] - ETA: 12s - loss: 0.2777 - acc: 0.9138
 896/1506 [================>.............] - ETA: 11s - loss: 0.2753 - acc: 0.9149
 928/1506 [=================>............] - ETA: 10s - loss: 0.2746 - acc: 0.9152
 960/1506 [==================>...........] - ETA: 10s - loss: 0.2742 - acc: 0.9155
 992/1506 [==================>...........] - ETA: 9s - loss: 0.2740 - acc: 0.9157 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.2735 - acc: 0.9161
1056/1506 [====================>.........] - ETA: 8s - loss: 0.2713 - acc: 0.9166
1088/1506 [====================>.........] - ETA: 7s - loss: 0.2684 - acc: 0.9175
1120/1506 [=====================>........] - ETA: 7s - loss: 0.2682 - acc: 0.9173
1152/1506 [=====================>........] - ETA: 6s - loss: 0.2679 - acc: 0.9178
1184/1506 [======================>.......] - ETA: 6s - loss: 0.2669 - acc: 0.9179
1216/1506 [=======================>......] - ETA: 5s - loss: 0.2659 - acc: 0.9183
1248/1506 [=======================>......] - ETA: 4s - loss: 0.2656 - acc: 0.9182
1280/1506 [========================>.....] - ETA: 4s - loss: 0.2651 - acc: 0.9182
1312/1506 [=========================>....] - ETA: 3s - loss: 0.2638 - acc: 0.9187
1344/1506 [=========================>....] - ETA: 3s - loss: 0.2624 - acc: 0.9190
1376/1506 [==========================>...] - ETA: 2s - loss: 0.2622 - acc: 0.9194
1408/1506 [===========================>..] - ETA: 1s - loss: 0.2621 - acc: 0.9193
1440/1506 [===========================>..] - ETA: 1s - loss: 0.2637 - acc: 0.9188
1472/1506 [============================>.] - ETA: 0s - loss: 0.2637 - acc: 0.9189
1504/1506 [============================>.] - ETA: 0s - loss: 0.2623 - acc: 0.9194
1506/1506 [==============================] - 30s 20ms/step - loss: 0.2621 - acc: 0.9195 - val_loss: 0.2768 - val_acc: 0.9095
Epoch 3/70

  32/1506 [..............................] - ETA: 27s - loss: 0.2801 - acc: 0.9116
  64/1506 [>.............................] - ETA: 27s - loss: 0.2540 - acc: 0.9179
  96/1506 [>.............................] - ETA: 26s - loss: 0.2303 - acc: 0.9268
 128/1506 [=>............................] - ETA: 26s - loss: 0.2244 - acc: 0.9267
 160/1506 [==>...........................] - ETA: 25s - loss: 0.2203 - acc: 0.9296
 192/1506 [==>...........................] - ETA: 25s - loss: 0.2150 - acc: 0.9333
 224/1506 [===>..........................] - ETA: 24s - loss: 0.2168 - acc: 0.9319
 256/1506 [====>.........................] - ETA: 23s - loss: 0.2149 - acc: 0.9322
 288/1506 [====>.........................] - ETA: 23s - loss: 0.2223 - acc: 0.9288
 320/1506 [=====>........................] - ETA: 22s - loss: 0.2220 - acc: 0.9283
 352/1506 [======>.......................] - ETA: 21s - loss: 0.2180 - acc: 0.9294
 384/1506 [======>.......................] - ETA: 21s - loss: 0.2201 - acc: 0.9284
 416/1506 [=======>......................] - ETA: 20s - loss: 0.2199 - acc: 0.9286
 448/1506 [=======>......................] - ETA: 20s - loss: 0.2198 - acc: 0.9280
 480/1506 [========>.....................] - ETA: 19s - loss: 0.2209 - acc: 0.9284
 512/1506 [=========>....................] - ETA: 18s - loss: 0.2216 - acc: 0.9276
 544/1506 [=========>....................] - ETA: 18s - loss: 0.2198 - acc: 0.9286
 576/1506 [==========>...................] - ETA: 17s - loss: 0.2207 - acc: 0.9283
 608/1506 [===========>..................] - ETA: 17s - loss: 0.2204 - acc: 0.9284
 640/1506 [===========>..................] - ETA: 16s - loss: 0.2182 - acc: 0.9295
 672/1506 [============>.................] - ETA: 15s - loss: 0.2179 - acc: 0.9299
 704/1506 [=============>................] - ETA: 15s - loss: 0.2188 - acc: 0.9290
 736/1506 [=============>................] - ETA: 14s - loss: 0.2230 - acc: 0.9285
 768/1506 [==============>...............] - ETA: 14s - loss: 0.2227 - acc: 0.9290
 800/1506 [==============>...............] - ETA: 13s - loss: 0.2218 - acc: 0.9294
 832/1506 [===============>..............] - ETA: 12s - loss: 0.2184 - acc: 0.9303
 864/1506 [================>.............] - ETA: 12s - loss: 0.2171 - acc: 0.9309
 896/1506 [================>.............] - ETA: 11s - loss: 0.2171 - acc: 0.9316
 928/1506 [=================>............] - ETA: 10s - loss: 0.2162 - acc: 0.9322
 960/1506 [==================>...........] - ETA: 10s - loss: 0.2146 - acc: 0.9328
 992/1506 [==================>...........] - ETA: 9s - loss: 0.2164 - acc: 0.9320 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.2153 - acc: 0.9325
1056/1506 [====================>.........] - ETA: 8s - loss: 0.2161 - acc: 0.9326
1088/1506 [====================>.........] - ETA: 7s - loss: 0.2151 - acc: 0.9329
1120/1506 [=====================>........] - ETA: 7s - loss: 0.2134 - acc: 0.9336
1152/1506 [=====================>........] - ETA: 6s - loss: 0.2147 - acc: 0.9332
1184/1506 [======================>.......] - ETA: 6s - loss: 0.2138 - acc: 0.9333
1216/1506 [=======================>......] - ETA: 5s - loss: 0.2114 - acc: 0.9340
1248/1506 [=======================>......] - ETA: 4s - loss: 0.2096 - acc: 0.9347
1280/1506 [========================>.....] - ETA: 4s - loss: 0.2101 - acc: 0.9343
1312/1506 [=========================>....] - ETA: 3s - loss: 0.2086 - acc: 0.9348
1344/1506 [=========================>....] - ETA: 3s - loss: 0.2079 - acc: 0.9351
1376/1506 [==========================>...] - ETA: 2s - loss: 0.2066 - acc: 0.9357
1408/1506 [===========================>..] - ETA: 1s - loss: 0.2059 - acc: 0.9362
1440/1506 [===========================>..] - ETA: 1s - loss: 0.2078 - acc: 0.9355
1472/1506 [============================>.] - ETA: 0s - loss: 0.2077 - acc: 0.9355
1504/1506 [============================>.] - ETA: 0s - loss: 0.2077 - acc: 0.9353
1506/1506 [==============================] - 30s 20ms/step - loss: 0.2077 - acc: 0.9353 - val_loss: 0.2095 - val_acc: 0.9356
Epoch 4/70

  32/1506 [..............................] - ETA: 27s - loss: 0.1873 - acc: 0.9332
  64/1506 [>.............................] - ETA: 27s - loss: 0.1655 - acc: 0.9500
  96/1506 [>.............................] - ETA: 26s - loss: 0.1517 - acc: 0.9556
 128/1506 [=>............................] - ETA: 26s - loss: 0.1601 - acc: 0.9525
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1527 - acc: 0.9561
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1545 - acc: 0.9538
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1602 - acc: 0.9500
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1632 - acc: 0.9488
 288/1506 [====>.........................] - ETA: 23s - loss: 0.1647 - acc: 0.9481
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1657 - acc: 0.9476
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1655 - acc: 0.9477
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1687 - acc: 0.9464
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1700 - acc: 0.9464
 448/1506 [=======>......................] - ETA: 20s - loss: 0.1690 - acc: 0.9472
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1660 - acc: 0.9486
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1649 - acc: 0.9488
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1627 - acc: 0.9498
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1656 - acc: 0.9486
 608/1506 [===========>..................] - ETA: 16s - loss: 0.1699 - acc: 0.9463
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1709 - acc: 0.9459
 672/1506 [============>.................] - ETA: 15s - loss: 0.1693 - acc: 0.9466
 704/1506 [=============>................] - ETA: 15s - loss: 0.1704 - acc: 0.9461
 736/1506 [=============>................] - ETA: 14s - loss: 0.1697 - acc: 0.9459
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1698 - acc: 0.9459
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1685 - acc: 0.9464
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1695 - acc: 0.9462
 864/1506 [================>.............] - ETA: 12s - loss: 0.1702 - acc: 0.9461
 896/1506 [================>.............] - ETA: 11s - loss: 0.1698 - acc: 0.9464
 928/1506 [=================>............] - ETA: 10s - loss: 0.1687 - acc: 0.9471
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1687 - acc: 0.9469
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1681 - acc: 0.9469 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1680 - acc: 0.9470
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1702 - acc: 0.9460
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1707 - acc: 0.9456
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1713 - acc: 0.9454
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1716 - acc: 0.9457
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1713 - acc: 0.9458
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1731 - acc: 0.9458
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1737 - acc: 0.9459
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1726 - acc: 0.9461
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1733 - acc: 0.9459
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1730 - acc: 0.9460
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1718 - acc: 0.9465
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1734 - acc: 0.9458
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1741 - acc: 0.9457
1472/1506 [============================>.] - ETA: 0s - loss: 0.1748 - acc: 0.9454
1504/1506 [============================>.] - ETA: 0s - loss: 0.1753 - acc: 0.9453
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1756 - acc: 0.9452 - val_loss: 0.2315 - val_acc: 0.9307
Epoch 5/70

  32/1506 [..............................] - ETA: 27s - loss: 0.2421 - acc: 0.9241
  64/1506 [>.............................] - ETA: 27s - loss: 0.2069 - acc: 0.9359
  96/1506 [>.............................] - ETA: 26s - loss: 0.2066 - acc: 0.9354
 128/1506 [=>............................] - ETA: 25s - loss: 0.2030 - acc: 0.9368
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1982 - acc: 0.9381
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1951 - acc: 0.9383
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1897 - acc: 0.9398
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1831 - acc: 0.9424
 288/1506 [====>.........................] - ETA: 22s - loss: 0.1760 - acc: 0.9447
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1737 - acc: 0.9453
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1691 - acc: 0.9466
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1694 - acc: 0.9468
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1699 - acc: 0.9462
 448/1506 [=======>......................] - ETA: 19s - loss: 0.1717 - acc: 0.9457
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1737 - acc: 0.9450
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1733 - acc: 0.9456
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1726 - acc: 0.9464
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1682 - acc: 0.9479
 608/1506 [===========>..................] - ETA: 17s - loss: 0.1700 - acc: 0.9473
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1696 - acc: 0.9472
 672/1506 [============>.................] - ETA: 15s - loss: 0.1721 - acc: 0.9465
 704/1506 [=============>................] - ETA: 15s - loss: 0.1717 - acc: 0.9466
 736/1506 [=============>................] - ETA: 14s - loss: 0.1692 - acc: 0.9472
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1712 - acc: 0.9469
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1720 - acc: 0.9465
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1711 - acc: 0.9468
 864/1506 [================>.............] - ETA: 12s - loss: 0.1693 - acc: 0.9474
 896/1506 [================>.............] - ETA: 11s - loss: 0.1681 - acc: 0.9478
 928/1506 [=================>............] - ETA: 10s - loss: 0.1682 - acc: 0.9480
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1681 - acc: 0.9482
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1677 - acc: 0.9483 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1681 - acc: 0.9482
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1688 - acc: 0.9480
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1674 - acc: 0.9485
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1681 - acc: 0.9483
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1671 - acc: 0.9485
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1667 - acc: 0.9485
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1664 - acc: 0.9486
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1662 - acc: 0.9487
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1650 - acc: 0.9491
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1657 - acc: 0.9489
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1649 - acc: 0.9492
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1641 - acc: 0.9493
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1639 - acc: 0.9494
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1631 - acc: 0.9496
1472/1506 [============================>.] - ETA: 0s - loss: 0.1630 - acc: 0.9497
1504/1506 [============================>.] - ETA: 0s - loss: 0.1614 - acc: 0.9502
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1621 - acc: 0.9500 - val_loss: 0.2671 - val_acc: 0.9102
Computing...
Manual evaluation: (didn't understand why I made this)
True 7851
False 1220
True percentage 0.865505456951
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.95      0.97      7318
     B-MISC       0.42      0.04      0.07       141
     I-MISC       0.26      0.12      0.16       154
      B-ORG       0.35      0.82      0.50       296
      I-ORG       0.34      0.79      0.47       151
      B-PER       0.94      0.54      0.69       438
      I-PER       0.89      0.57      0.69       214
      B-LOC       0.84      0.47      0.61       218
      I-LOC       0.80      0.60      0.69       141

avg / total       0.92      0.87      0.88      9071

F-1 Score:
0.533638705983
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 1674 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 237
OOV word occurences: 324
Padding...
Data padded!
Padding...
Data padded!
Padded until 83 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,992,194
Trainable params: 6,992,194
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1506 samples, validate on 168 samples
Epoch 1/70

  32/1506 [..............................] - ETA: 2:09 - loss: 2.2959 - acc: 0.0344
  64/1506 [>.............................] - ETA: 1:18 - loss: 1.6459 - acc: 0.4184
  96/1506 [>.............................] - ETA: 1:01 - loss: 1.9118 - acc: 0.5509
 128/1506 [=>............................] - ETA: 51s - loss: 1.6846 - acc: 0.6077 
 160/1506 [==>...........................] - ETA: 46s - loss: 1.5294 - acc: 0.6435
 192/1506 [==>...........................] - ETA: 41s - loss: 1.4293 - acc: 0.6723
 224/1506 [===>..........................] - ETA: 38s - loss: 1.3271 - acc: 0.6934
 256/1506 [====>.........................] - ETA: 36s - loss: 1.2619 - acc: 0.7053
 288/1506 [====>.........................] - ETA: 33s - loss: 1.2053 - acc: 0.7144
 320/1506 [=====>........................] - ETA: 31s - loss: 1.1560 - acc: 0.7229
 352/1506 [======>.......................] - ETA: 30s - loss: 1.1079 - acc: 0.7313
 384/1506 [======>.......................] - ETA: 28s - loss: 1.0685 - acc: 0.7382
 416/1506 [=======>......................] - ETA: 27s - loss: 1.0278 - acc: 0.7461
 448/1506 [=======>......................] - ETA: 26s - loss: 1.0047 - acc: 0.7491
 480/1506 [========>.....................] - ETA: 25s - loss: 0.9781 - acc: 0.7537
 512/1506 [=========>....................] - ETA: 24s - loss: 0.9542 - acc: 0.7567
 544/1506 [=========>....................] - ETA: 23s - loss: 0.9267 - acc: 0.7638
 576/1506 [==========>...................] - ETA: 22s - loss: 0.9094 - acc: 0.7661
 608/1506 [===========>..................] - ETA: 21s - loss: 0.8879 - acc: 0.7713
 640/1506 [===========>..................] - ETA: 20s - loss: 0.8703 - acc: 0.7741
 672/1506 [============>.................] - ETA: 19s - loss: 0.8505 - acc: 0.7787
 704/1506 [=============>................] - ETA: 18s - loss: 0.8347 - acc: 0.7815
 736/1506 [=============>................] - ETA: 17s - loss: 0.8177 - acc: 0.7856
 768/1506 [==============>...............] - ETA: 16s - loss: 0.8016 - acc: 0.7885
 800/1506 [==============>...............] - ETA: 16s - loss: 0.7932 - acc: 0.7901
 832/1506 [===============>..............] - ETA: 15s - loss: 0.7828 - acc: 0.7919
 864/1506 [================>.............] - ETA: 14s - loss: 0.7679 - acc: 0.7957
 896/1506 [================>.............] - ETA: 13s - loss: 0.7517 - acc: 0.7995
 928/1506 [=================>............] - ETA: 12s - loss: 0.7357 - acc: 0.8033
 960/1506 [==================>...........] - ETA: 12s - loss: 0.7265 - acc: 0.8049
 992/1506 [==================>...........] - ETA: 11s - loss: 0.7171 - acc: 0.8069
1024/1506 [===================>..........] - ETA: 10s - loss: 0.7130 - acc: 0.8073
1056/1506 [====================>.........] - ETA: 9s - loss: 0.7061 - acc: 0.8100 
1088/1506 [====================>.........] - ETA: 9s - loss: 0.6963 - acc: 0.8120
1120/1506 [=====================>........] - ETA: 8s - loss: 0.6906 - acc: 0.8133
1152/1506 [=====================>........] - ETA: 7s - loss: 0.6819 - acc: 0.8152
1184/1506 [======================>.......] - ETA: 6s - loss: 0.6744 - acc: 0.8166
1216/1506 [=======================>......] - ETA: 6s - loss: 0.6640 - acc: 0.8194
1248/1506 [=======================>......] - ETA: 5s - loss: 0.6571 - acc: 0.8208
1280/1506 [========================>.....] - ETA: 4s - loss: 0.6501 - acc: 0.8227
1312/1506 [=========================>....] - ETA: 4s - loss: 0.6444 - acc: 0.8237
1344/1506 [=========================>....] - ETA: 3s - loss: 0.6368 - acc: 0.8256
1376/1506 [==========================>...] - ETA: 2s - loss: 0.6293 - acc: 0.8274
1408/1506 [===========================>..] - ETA: 2s - loss: 0.6227 - acc: 0.8290
1440/1506 [===========================>..] - ETA: 1s - loss: 0.6154 - acc: 0.8306
1472/1506 [============================>.] - ETA: 0s - loss: 0.6085 - acc: 0.8323
1504/1506 [============================>.] - ETA: 0s - loss: 0.6008 - acc: 0.8343
1506/1506 [==============================] - 33s 22ms/step - loss: 0.6002 - acc: 0.8345 - val_loss: 0.2791 - val_acc: 0.9110
Epoch 2/70

  32/1506 [..............................] - ETA: 27s - loss: 0.3748 - acc: 0.8714
  64/1506 [>.............................] - ETA: 27s - loss: 0.3079 - acc: 0.8976
  96/1506 [>.............................] - ETA: 26s - loss: 0.2998 - acc: 0.8998
 128/1506 [=>............................] - ETA: 26s - loss: 0.2951 - acc: 0.9047
 160/1506 [==>...........................] - ETA: 25s - loss: 0.2913 - acc: 0.9083
 192/1506 [==>...........................] - ETA: 24s - loss: 0.2962 - acc: 0.9082
 224/1506 [===>..........................] - ETA: 24s - loss: 0.2985 - acc: 0.9076
 256/1506 [====>.........................] - ETA: 23s - loss: 0.3024 - acc: 0.9053
 288/1506 [====>.........................] - ETA: 23s - loss: 0.2912 - acc: 0.9097
 320/1506 [=====>........................] - ETA: 22s - loss: 0.2926 - acc: 0.9098
 352/1506 [======>.......................] - ETA: 22s - loss: 0.2930 - acc: 0.9105
 384/1506 [======>.......................] - ETA: 21s - loss: 0.2933 - acc: 0.9099
 416/1506 [=======>......................] - ETA: 20s - loss: 0.2898 - acc: 0.9111
 448/1506 [=======>......................] - ETA: 20s - loss: 0.2889 - acc: 0.9106
 480/1506 [========>.....................] - ETA: 19s - loss: 0.2868 - acc: 0.9113
 512/1506 [=========>....................] - ETA: 18s - loss: 0.2841 - acc: 0.9125
 544/1506 [=========>....................] - ETA: 18s - loss: 0.2834 - acc: 0.9123
 576/1506 [==========>...................] - ETA: 17s - loss: 0.2790 - acc: 0.9141
 608/1506 [===========>..................] - ETA: 17s - loss: 0.2835 - acc: 0.9119
 640/1506 [===========>..................] - ETA: 16s - loss: 0.2780 - acc: 0.9136
 672/1506 [============>.................] - ETA: 15s - loss: 0.2761 - acc: 0.9133
 704/1506 [=============>................] - ETA: 15s - loss: 0.2732 - acc: 0.9140
 736/1506 [=============>................] - ETA: 14s - loss: 0.2702 - acc: 0.9157
 768/1506 [==============>...............] - ETA: 14s - loss: 0.2679 - acc: 0.9168
 800/1506 [==============>...............] - ETA: 13s - loss: 0.2684 - acc: 0.9166
 832/1506 [===============>..............] - ETA: 12s - loss: 0.2670 - acc: 0.9169
 864/1506 [================>.............] - ETA: 12s - loss: 0.2671 - acc: 0.9168
 896/1506 [================>.............] - ETA: 11s - loss: 0.2660 - acc: 0.9173
 928/1506 [=================>............] - ETA: 11s - loss: 0.2692 - acc: 0.9168
 960/1506 [==================>...........] - ETA: 10s - loss: 0.2682 - acc: 0.9171
 992/1506 [==================>...........] - ETA: 9s - loss: 0.2661 - acc: 0.9177 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.2647 - acc: 0.9182
1056/1506 [====================>.........] - ETA: 8s - loss: 0.2665 - acc: 0.9176
1088/1506 [====================>.........] - ETA: 7s - loss: 0.2691 - acc: 0.9171
1120/1506 [=====================>........] - ETA: 7s - loss: 0.2678 - acc: 0.9171
1152/1506 [=====================>........] - ETA: 6s - loss: 0.2671 - acc: 0.9172
1184/1506 [======================>.......] - ETA: 6s - loss: 0.2662 - acc: 0.9173
1216/1506 [=======================>......] - ETA: 5s - loss: 0.2659 - acc: 0.9174
1248/1506 [=======================>......] - ETA: 4s - loss: 0.2669 - acc: 0.9172
1280/1506 [========================>.....] - ETA: 4s - loss: 0.2665 - acc: 0.9171
1312/1506 [=========================>....] - ETA: 3s - loss: 0.2668 - acc: 0.9170
1344/1506 [=========================>....] - ETA: 3s - loss: 0.2677 - acc: 0.9164
1376/1506 [==========================>...] - ETA: 2s - loss: 0.2672 - acc: 0.9168
1408/1506 [===========================>..] - ETA: 1s - loss: 0.2657 - acc: 0.9172
1440/1506 [===========================>..] - ETA: 1s - loss: 0.2635 - acc: 0.9179
1472/1506 [============================>.] - ETA: 0s - loss: 0.2616 - acc: 0.9185
1504/1506 [============================>.] - ETA: 0s - loss: 0.2621 - acc: 0.9183
1506/1506 [==============================] - 30s 20ms/step - loss: 0.2619 - acc: 0.9184 - val_loss: 0.1921 - val_acc: 0.9402
Epoch 3/70

  32/1506 [..............................] - ETA: 27s - loss: 0.2603 - acc: 0.9133
  64/1506 [>.............................] - ETA: 26s - loss: 0.2204 - acc: 0.9262
  96/1506 [>.............................] - ETA: 26s - loss: 0.2069 - acc: 0.9328
 128/1506 [=>............................] - ETA: 25s - loss: 0.2050 - acc: 0.9331
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1962 - acc: 0.9358
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1962 - acc: 0.9374
 224/1506 [===>..........................] - ETA: 24s - loss: 0.2029 - acc: 0.9368
 256/1506 [====>.........................] - ETA: 23s - loss: 0.2008 - acc: 0.9365
 288/1506 [====>.........................] - ETA: 23s - loss: 0.2013 - acc: 0.9379
 320/1506 [=====>........................] - ETA: 22s - loss: 0.2006 - acc: 0.9376
 352/1506 [======>.......................] - ETA: 21s - loss: 0.2061 - acc: 0.9352
 384/1506 [======>.......................] - ETA: 21s - loss: 0.2097 - acc: 0.9347
 416/1506 [=======>......................] - ETA: 20s - loss: 0.2118 - acc: 0.9337
 448/1506 [=======>......................] - ETA: 20s - loss: 0.2139 - acc: 0.9328
 480/1506 [========>.....................] - ETA: 19s - loss: 0.2101 - acc: 0.9346
 512/1506 [=========>....................] - ETA: 18s - loss: 0.2125 - acc: 0.9339
 544/1506 [=========>....................] - ETA: 18s - loss: 0.2120 - acc: 0.9343
 576/1506 [==========>...................] - ETA: 17s - loss: 0.2132 - acc: 0.9334
 608/1506 [===========>..................] - ETA: 17s - loss: 0.2104 - acc: 0.9344
 640/1506 [===========>..................] - ETA: 16s - loss: 0.2120 - acc: 0.9340
 672/1506 [============>.................] - ETA: 15s - loss: 0.2129 - acc: 0.9334
 704/1506 [=============>................] - ETA: 15s - loss: 0.2104 - acc: 0.9346
 736/1506 [=============>................] - ETA: 14s - loss: 0.2121 - acc: 0.9344
 768/1506 [==============>...............] - ETA: 14s - loss: 0.2116 - acc: 0.9348
 800/1506 [==============>...............] - ETA: 13s - loss: 0.2113 - acc: 0.9347
 832/1506 [===============>..............] - ETA: 12s - loss: 0.2118 - acc: 0.9347
 864/1506 [================>.............] - ETA: 12s - loss: 0.2117 - acc: 0.9346
 896/1506 [================>.............] - ETA: 11s - loss: 0.2119 - acc: 0.9348
 928/1506 [=================>............] - ETA: 11s - loss: 0.2098 - acc: 0.9354
 960/1506 [==================>...........] - ETA: 10s - loss: 0.2092 - acc: 0.9352
 992/1506 [==================>...........] - ETA: 9s - loss: 0.2115 - acc: 0.9347 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.2122 - acc: 0.9348
1056/1506 [====================>.........] - ETA: 8s - loss: 0.2118 - acc: 0.9349
1088/1506 [====================>.........] - ETA: 7s - loss: 0.2126 - acc: 0.9345
1120/1506 [=====================>........] - ETA: 7s - loss: 0.2124 - acc: 0.9346
1152/1506 [=====================>........] - ETA: 6s - loss: 0.2120 - acc: 0.9345
1184/1506 [======================>.......] - ETA: 6s - loss: 0.2103 - acc: 0.9350
1216/1506 [=======================>......] - ETA: 5s - loss: 0.2131 - acc: 0.9339
1248/1506 [=======================>......] - ETA: 4s - loss: 0.2129 - acc: 0.9342
1280/1506 [========================>.....] - ETA: 4s - loss: 0.2130 - acc: 0.9339
1312/1506 [=========================>....] - ETA: 3s - loss: 0.2116 - acc: 0.9344
1344/1506 [=========================>....] - ETA: 3s - loss: 0.2104 - acc: 0.9350
1376/1506 [==========================>...] - ETA: 2s - loss: 0.2108 - acc: 0.9351
1408/1506 [===========================>..] - ETA: 1s - loss: 0.2105 - acc: 0.9350
1440/1506 [===========================>..] - ETA: 1s - loss: 0.2105 - acc: 0.9349
1472/1506 [============================>.] - ETA: 0s - loss: 0.2095 - acc: 0.9351
1504/1506 [============================>.] - ETA: 0s - loss: 0.2087 - acc: 0.9353
1506/1506 [==============================] - 30s 20ms/step - loss: 0.2084 - acc: 0.9354 - val_loss: 0.1625 - val_acc: 0.9444
Epoch 4/70

  32/1506 [..............................] - ETA: 27s - loss: 0.2435 - acc: 0.9173
  64/1506 [>.............................] - ETA: 27s - loss: 0.1835 - acc: 0.9372
  96/1506 [>.............................] - ETA: 26s - loss: 0.1769 - acc: 0.9440
 128/1506 [=>............................] - ETA: 26s - loss: 0.1875 - acc: 0.9396
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1816 - acc: 0.9425
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1902 - acc: 0.9414
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1850 - acc: 0.9447
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1791 - acc: 0.9452
 288/1506 [====>.........................] - ETA: 23s - loss: 0.1889 - acc: 0.9445
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1891 - acc: 0.9439
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1944 - acc: 0.9405
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1915 - acc: 0.9412
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1886 - acc: 0.9419
 448/1506 [=======>......................] - ETA: 20s - loss: 0.1851 - acc: 0.9426
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1828 - acc: 0.9436
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1828 - acc: 0.9431
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1844 - acc: 0.9425
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1850 - acc: 0.9426
 608/1506 [===========>..................] - ETA: 17s - loss: 0.1826 - acc: 0.9437
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1825 - acc: 0.9444
 672/1506 [============>.................] - ETA: 15s - loss: 0.1813 - acc: 0.9446
 704/1506 [=============>................] - ETA: 15s - loss: 0.1795 - acc: 0.9452
 736/1506 [=============>................] - ETA: 14s - loss: 0.1788 - acc: 0.9450
 768/1506 [==============>...............] - ETA: 14s - loss: 0.1768 - acc: 0.9455
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1764 - acc: 0.9456
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1752 - acc: 0.9460
 864/1506 [================>.............] - ETA: 12s - loss: 0.1752 - acc: 0.9459
 896/1506 [================>.............] - ETA: 11s - loss: 0.1763 - acc: 0.9455
 928/1506 [=================>............] - ETA: 10s - loss: 0.1805 - acc: 0.9443
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1812 - acc: 0.9440
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1828 - acc: 0.9434 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1833 - acc: 0.9429
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1828 - acc: 0.9431
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1821 - acc: 0.9436
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1842 - acc: 0.9429
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1842 - acc: 0.9428
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1828 - acc: 0.9429
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1843 - acc: 0.9426
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1834 - acc: 0.9430
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1824 - acc: 0.9432
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1819 - acc: 0.9433
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1817 - acc: 0.9435
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1810 - acc: 0.9437
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1803 - acc: 0.9440
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1789 - acc: 0.9445
1472/1506 [============================>.] - ETA: 0s - loss: 0.1779 - acc: 0.9446
1504/1506 [============================>.] - ETA: 0s - loss: 0.1787 - acc: 0.9442
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1788 - acc: 0.9441 - val_loss: 0.1985 - val_acc: 0.9408
Epoch 5/70

  32/1506 [..............................] - ETA: 28s - loss: 0.2083 - acc: 0.9407
  64/1506 [>.............................] - ETA: 27s - loss: 0.1922 - acc: 0.9412
  96/1506 [>.............................] - ETA: 26s - loss: 0.2021 - acc: 0.9351
 128/1506 [=>............................] - ETA: 26s - loss: 0.2197 - acc: 0.9308
 160/1506 [==>...........................] - ETA: 25s - loss: 0.2077 - acc: 0.9318
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1958 - acc: 0.9361
 224/1506 [===>..........................] - ETA: 24s - loss: 0.2043 - acc: 0.9323
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1954 - acc: 0.9353
 288/1506 [====>.........................] - ETA: 23s - loss: 0.1956 - acc: 0.9361
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1910 - acc: 0.9379
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1956 - acc: 0.9362
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1922 - acc: 0.9377
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1838 - acc: 0.9405
 448/1506 [=======>......................] - ETA: 20s - loss: 0.1830 - acc: 0.9412
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1821 - acc: 0.9422
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1806 - acc: 0.9430
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1774 - acc: 0.9444
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1753 - acc: 0.9456
 608/1506 [===========>..................] - ETA: 17s - loss: 0.1746 - acc: 0.9460
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1722 - acc: 0.9464
 672/1506 [============>.................] - ETA: 15s - loss: 0.1709 - acc: 0.9467
 704/1506 [=============>................] - ETA: 15s - loss: 0.1696 - acc: 0.9474
 736/1506 [=============>................] - ETA: 14s - loss: 0.1678 - acc: 0.9479
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1655 - acc: 0.9486
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1668 - acc: 0.9482
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1671 - acc: 0.9482
 864/1506 [================>.............] - ETA: 12s - loss: 0.1671 - acc: 0.9480
 896/1506 [================>.............] - ETA: 11s - loss: 0.1668 - acc: 0.9484
 928/1506 [=================>............] - ETA: 10s - loss: 0.1668 - acc: 0.9487
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1657 - acc: 0.9491
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1636 - acc: 0.9497 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1634 - acc: 0.9495
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1630 - acc: 0.9495
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1646 - acc: 0.9491
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1639 - acc: 0.9493
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1631 - acc: 0.9496
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1624 - acc: 0.9495
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1616 - acc: 0.9498
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1615 - acc: 0.9498
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1619 - acc: 0.9496
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1625 - acc: 0.9496
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1625 - acc: 0.9496
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1623 - acc: 0.9497
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1627 - acc: 0.9494
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1637 - acc: 0.9491
1472/1506 [============================>.] - ETA: 0s - loss: 0.1634 - acc: 0.9492
1504/1506 [============================>.] - ETA: 0s - loss: 0.1617 - acc: 0.9498
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1616 - acc: 0.9498 - val_loss: 0.1430 - val_acc: 0.9526
Epoch 6/70

  32/1506 [..............................] - ETA: 27s - loss: 0.1326 - acc: 0.9501
  64/1506 [>.............................] - ETA: 27s - loss: 0.1102 - acc: 0.9615
  96/1506 [>.............................] - ETA: 26s - loss: 0.1592 - acc: 0.9501
 128/1506 [=>............................] - ETA: 26s - loss: 0.1573 - acc: 0.9506
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1533 - acc: 0.9515
 192/1506 [==>...........................] - ETA: 25s - loss: 0.1489 - acc: 0.9532
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1479 - acc: 0.9536
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1538 - acc: 0.9516
 288/1506 [====>.........................] - ETA: 23s - loss: 0.1574 - acc: 0.9505
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1569 - acc: 0.9507
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1545 - acc: 0.9519
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1532 - acc: 0.9522
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1542 - acc: 0.9521
 448/1506 [=======>......................] - ETA: 20s - loss: 0.1569 - acc: 0.9519
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1573 - acc: 0.9515
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1519 - acc: 0.9533
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1501 - acc: 0.9537
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1496 - acc: 0.9542
 608/1506 [===========>..................] - ETA: 17s - loss: 0.1506 - acc: 0.9533
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1481 - acc: 0.9543
 672/1506 [============>.................] - ETA: 15s - loss: 0.1477 - acc: 0.9540
 704/1506 [=============>................] - ETA: 15s - loss: 0.1503 - acc: 0.9536
 736/1506 [=============>................] - ETA: 14s - loss: 0.1473 - acc: 0.9544
 768/1506 [==============>...............] - ETA: 14s - loss: 0.1469 - acc: 0.9546
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1457 - acc: 0.9546
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1450 - acc: 0.9549
 864/1506 [================>.............] - ETA: 12s - loss: 0.1432 - acc: 0.9554
 896/1506 [================>.............] - ETA: 11s - loss: 0.1440 - acc: 0.9545
 928/1506 [=================>............] - ETA: 10s - loss: 0.1434 - acc: 0.9552
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1431 - acc: 0.9553
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1445 - acc: 0.9544 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1476 - acc: 0.9537
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1463 - acc: 0.9539
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1465 - acc: 0.9538
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1456 - acc: 0.9541
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1450 - acc: 0.9543
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1436 - acc: 0.9548
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1437 - acc: 0.9548
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1436 - acc: 0.9547
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1428 - acc: 0.9547
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1418 - acc: 0.9551
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1434 - acc: 0.9547
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1433 - acc: 0.9547
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1431 - acc: 0.9549
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1426 - acc: 0.9552
1472/1506 [============================>.] - ETA: 0s - loss: 0.1424 - acc: 0.9552
1504/1506 [============================>.] - ETA: 0s - loss: 0.1434 - acc: 0.9548
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1433 - acc: 0.9548 - val_loss: 0.1503 - val_acc: 0.9524
Epoch 7/70

  32/1506 [..............................] - ETA: 27s - loss: 0.1724 - acc: 0.9339
  64/1506 [>.............................] - ETA: 27s - loss: 0.1825 - acc: 0.9382
  96/1506 [>.............................] - ETA: 26s - loss: 0.1488 - acc: 0.9501
 128/1506 [=>............................] - ETA: 25s - loss: 0.1397 - acc: 0.9543
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1469 - acc: 0.9508
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1387 - acc: 0.9539
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1336 - acc: 0.9560
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1341 - acc: 0.9556
 288/1506 [====>.........................] - ETA: 23s - loss: 0.1288 - acc: 0.9577
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1271 - acc: 0.9591
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1277 - acc: 0.9587
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1229 - acc: 0.9607
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1225 - acc: 0.9605
 448/1506 [=======>......................] - ETA: 19s - loss: 0.1228 - acc: 0.9608
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1217 - acc: 0.9612
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1199 - acc: 0.9621
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1191 - acc: 0.9628
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1244 - acc: 0.9620
 608/1506 [===========>..................] - ETA: 16s - loss: 0.1251 - acc: 0.9618
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1250 - acc: 0.9618
 672/1506 [============>.................] - ETA: 15s - loss: 0.1268 - acc: 0.9615
 704/1506 [=============>................] - ETA: 15s - loss: 0.1262 - acc: 0.9616
 736/1506 [=============>................] - ETA: 14s - loss: 0.1263 - acc: 0.9616
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1249 - acc: 0.9623
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1290 - acc: 0.9611
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1298 - acc: 0.9606
 864/1506 [================>.............] - ETA: 12s - loss: 0.1292 - acc: 0.9608
 896/1506 [================>.............] - ETA: 11s - loss: 0.1311 - acc: 0.9601
 928/1506 [=================>............] - ETA: 10s - loss: 0.1304 - acc: 0.9603
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1312 - acc: 0.9593
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1317 - acc: 0.9594 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1315 - acc: 0.9593
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1315 - acc: 0.9594
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1313 - acc: 0.9596
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1315 - acc: 0.9598
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1321 - acc: 0.9595
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1325 - acc: 0.9591
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1316 - acc: 0.9594
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1326 - acc: 0.9591
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1328 - acc: 0.9591
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1329 - acc: 0.9590
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1331 - acc: 0.9588
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1338 - acc: 0.9585
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1340 - acc: 0.9583
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1341 - acc: 0.9582
1472/1506 [============================>.] - ETA: 0s - loss: 0.1335 - acc: 0.9584
1504/1506 [============================>.] - ETA: 0s - loss: 0.1320 - acc: 0.9589
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1319 - acc: 0.9590 - val_loss: 0.1512 - val_acc: 0.9502
Computing...
Manual evaluation: (didn't understand why I made this)
True 8129
False 942
True percentage 0.896152574137
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.84      0.59      0.69       296
      B-LOC       0.72      0.72      0.72       218
      B-PER       0.94      0.80      0.86       438
      I-PER       0.90      0.59      0.72       214
     B-MISC       0.34      0.39      0.36       141
      I-ORG       0.78      0.30      0.43       151
      I-LOC       0.73      0.72      0.73       141
     I-MISC       0.31      0.65      0.42       154

avg / total       0.94      0.90      0.91      9071

F-1 Score:
0.658956109134
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 1674 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 237
OOV word occurences: 324
Padding...
Data padded!
Padding...
Data padded!
Padded until 83 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,992,194
Trainable params: 6,992,194
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1506 samples, validate on 168 samples
Epoch 1/70

  32/1506 [..............................] - ETA: 2:09 - loss: 2.1424 - acc: 0.2816
  64/1506 [>.............................] - ETA: 1:18 - loss: 1.5388 - acc: 0.5438
  96/1506 [>.............................] - ETA: 1:00 - loss: 1.6260 - acc: 0.6312
 128/1506 [=>............................] - ETA: 51s - loss: 1.5267 - acc: 0.6783 
 160/1506 [==>...........................] - ETA: 45s - loss: 1.3799 - acc: 0.7036
 192/1506 [==>...........................] - ETA: 41s - loss: 1.2981 - acc: 0.7146
 224/1506 [===>..........................] - ETA: 38s - loss: 1.2027 - acc: 0.7324
 256/1506 [====>.........................] - ETA: 35s - loss: 1.1348 - acc: 0.7425
 288/1506 [====>.........................] - ETA: 33s - loss: 1.0997 - acc: 0.7438
 320/1506 [=====>........................] - ETA: 31s - loss: 1.0655 - acc: 0.7480
 352/1506 [======>.......................] - ETA: 30s - loss: 1.0287 - acc: 0.7529
 384/1506 [======>.......................] - ETA: 28s - loss: 1.0046 - acc: 0.7543
 416/1506 [=======>......................] - ETA: 27s - loss: 0.9673 - acc: 0.7616
 448/1506 [=======>......................] - ETA: 25s - loss: 0.9350 - acc: 0.7674
 480/1506 [========>.....................] - ETA: 24s - loss: 0.9089 - acc: 0.7719
 512/1506 [=========>....................] - ETA: 23s - loss: 0.8858 - acc: 0.7759
 544/1506 [=========>....................] - ETA: 22s - loss: 0.8705 - acc: 0.7776
 576/1506 [==========>...................] - ETA: 21s - loss: 0.8576 - acc: 0.7787
 608/1506 [===========>..................] - ETA: 20s - loss: 0.8372 - acc: 0.7823
 640/1506 [===========>..................] - ETA: 19s - loss: 0.8203 - acc: 0.7849
 672/1506 [============>.................] - ETA: 19s - loss: 0.8089 - acc: 0.7884
 704/1506 [=============>................] - ETA: 18s - loss: 0.7919 - acc: 0.7917
 736/1506 [=============>................] - ETA: 17s - loss: 0.7829 - acc: 0.7931
 768/1506 [==============>...............] - ETA: 16s - loss: 0.7716 - acc: 0.7954
 800/1506 [==============>...............] - ETA: 15s - loss: 0.7576 - acc: 0.7979
 832/1506 [===============>..............] - ETA: 14s - loss: 0.7395 - acc: 0.8026
 864/1506 [================>.............] - ETA: 14s - loss: 0.7336 - acc: 0.8036
 896/1506 [================>.............] - ETA: 13s - loss: 0.7291 - acc: 0.8058
 928/1506 [=================>............] - ETA: 12s - loss: 0.7158 - acc: 0.8090
 960/1506 [==================>...........] - ETA: 11s - loss: 0.7035 - acc: 0.8116
 992/1506 [==================>...........] - ETA: 11s - loss: 0.6927 - acc: 0.8143
1024/1506 [===================>..........] - ETA: 10s - loss: 0.6821 - acc: 0.8167
1056/1506 [====================>.........] - ETA: 9s - loss: 0.6752 - acc: 0.8181 
1088/1506 [====================>.........] - ETA: 8s - loss: 0.6677 - acc: 0.8197
1120/1506 [=====================>........] - ETA: 8s - loss: 0.6587 - acc: 0.8215
1152/1506 [=====================>........] - ETA: 7s - loss: 0.6491 - acc: 0.8237
1184/1506 [======================>.......] - ETA: 6s - loss: 0.6390 - acc: 0.8262
1216/1506 [=======================>......] - ETA: 6s - loss: 0.6333 - acc: 0.8273
1248/1506 [=======================>......] - ETA: 5s - loss: 0.6258 - acc: 0.8293
1280/1506 [========================>.....] - ETA: 4s - loss: 0.6187 - acc: 0.8309
1312/1506 [=========================>....] - ETA: 4s - loss: 0.6124 - acc: 0.8327
1344/1506 [=========================>....] - ETA: 3s - loss: 0.6090 - acc: 0.8332
1376/1506 [==========================>...] - ETA: 2s - loss: 0.6014 - acc: 0.8351
1408/1506 [===========================>..] - ETA: 2s - loss: 0.5959 - acc: 0.8363
1440/1506 [===========================>..] - ETA: 1s - loss: 0.5892 - acc: 0.8382
1472/1506 [============================>.] - ETA: 0s - loss: 0.5833 - acc: 0.8393
1504/1506 [============================>.] - ETA: 0s - loss: 0.5767 - acc: 0.8406
1506/1506 [==============================] - 33s 22ms/step - loss: 0.5763 - acc: 0.8407 - val_loss: 0.2953 - val_acc: 0.9087
Epoch 2/70

  32/1506 [..............................] - ETA: 28s - loss: 0.3646 - acc: 0.8851
  64/1506 [>.............................] - ETA: 27s - loss: 0.3825 - acc: 0.8735
  96/1506 [>.............................] - ETA: 26s - loss: 0.3366 - acc: 0.8952
 128/1506 [=>............................] - ETA: 26s - loss: 0.3373 - acc: 0.8944
 160/1506 [==>...........................] - ETA: 25s - loss: 0.3251 - acc: 0.9012
 192/1506 [==>...........................] - ETA: 24s - loss: 0.3336 - acc: 0.8977
 224/1506 [===>..........................] - ETA: 24s - loss: 0.3340 - acc: 0.8979
 256/1506 [====>.........................] - ETA: 23s - loss: 0.3236 - acc: 0.9004
 288/1506 [====>.........................] - ETA: 23s - loss: 0.3291 - acc: 0.8977
 320/1506 [=====>........................] - ETA: 22s - loss: 0.3250 - acc: 0.8985
 352/1506 [======>.......................] - ETA: 21s - loss: 0.3198 - acc: 0.8994
 384/1506 [======>.......................] - ETA: 21s - loss: 0.3121 - acc: 0.9026
 416/1506 [=======>......................] - ETA: 20s - loss: 0.3116 - acc: 0.9038
 448/1506 [=======>......................] - ETA: 20s - loss: 0.3101 - acc: 0.9049
 480/1506 [========>.....................] - ETA: 19s - loss: 0.3072 - acc: 0.9057
 512/1506 [=========>....................] - ETA: 18s - loss: 0.3062 - acc: 0.9060
 544/1506 [=========>....................] - ETA: 18s - loss: 0.3032 - acc: 0.9066
 576/1506 [==========>...................] - ETA: 17s - loss: 0.3010 - acc: 0.9069
 608/1506 [===========>..................] - ETA: 17s - loss: 0.2985 - acc: 0.9078
 640/1506 [===========>..................] - ETA: 16s - loss: 0.2959 - acc: 0.9087
 672/1506 [============>.................] - ETA: 15s - loss: 0.2922 - acc: 0.9099
 704/1506 [=============>................] - ETA: 15s - loss: 0.2899 - acc: 0.9102
 736/1506 [=============>................] - ETA: 14s - loss: 0.2921 - acc: 0.9092
 768/1506 [==============>...............] - ETA: 14s - loss: 0.2882 - acc: 0.9107
 800/1506 [==============>...............] - ETA: 13s - loss: 0.2839 - acc: 0.9116
 832/1506 [===============>..............] - ETA: 12s - loss: 0.2807 - acc: 0.9124
 864/1506 [================>.............] - ETA: 12s - loss: 0.2796 - acc: 0.9128
 896/1506 [================>.............] - ETA: 11s - loss: 0.2768 - acc: 0.9138
 928/1506 [=================>............] - ETA: 10s - loss: 0.2740 - acc: 0.9149
 960/1506 [==================>...........] - ETA: 10s - loss: 0.2743 - acc: 0.9147
 992/1506 [==================>...........] - ETA: 9s - loss: 0.2735 - acc: 0.9149 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.2712 - acc: 0.9157
1056/1506 [====================>.........] - ETA: 8s - loss: 0.2680 - acc: 0.9167
1088/1506 [====================>.........] - ETA: 7s - loss: 0.2675 - acc: 0.9167
1120/1506 [=====================>........] - ETA: 7s - loss: 0.2656 - acc: 0.9170
1152/1506 [=====================>........] - ETA: 6s - loss: 0.2643 - acc: 0.9175
1184/1506 [======================>.......] - ETA: 6s - loss: 0.2662 - acc: 0.9168
1216/1506 [=======================>......] - ETA: 5s - loss: 0.2667 - acc: 0.9163
1248/1506 [=======================>......] - ETA: 4s - loss: 0.2651 - acc: 0.9170
1280/1506 [========================>.....] - ETA: 4s - loss: 0.2656 - acc: 0.9167
1312/1506 [=========================>....] - ETA: 3s - loss: 0.2663 - acc: 0.9166
1344/1506 [=========================>....] - ETA: 3s - loss: 0.2663 - acc: 0.9166
1376/1506 [==========================>...] - ETA: 2s - loss: 0.2664 - acc: 0.9168
1408/1506 [===========================>..] - ETA: 1s - loss: 0.2660 - acc: 0.9168
1440/1506 [===========================>..] - ETA: 1s - loss: 0.2645 - acc: 0.9174
1472/1506 [============================>.] - ETA: 0s - loss: 0.2634 - acc: 0.9178
1504/1506 [============================>.] - ETA: 0s - loss: 0.2639 - acc: 0.9178
1506/1506 [==============================] - 30s 20ms/step - loss: 0.2636 - acc: 0.9179 - val_loss: 0.3201 - val_acc: 0.8947
Epoch 3/70

  32/1506 [..............................] - ETA: 27s - loss: 0.3337 - acc: 0.8876
  64/1506 [>.............................] - ETA: 27s - loss: 0.2976 - acc: 0.9010
  96/1506 [>.............................] - ETA: 26s - loss: 0.3156 - acc: 0.8950
 128/1506 [=>............................] - ETA: 25s - loss: 0.3143 - acc: 0.8947
 160/1506 [==>...........................] - ETA: 25s - loss: 0.3108 - acc: 0.9012
 192/1506 [==>...........................] - ETA: 24s - loss: 0.2883 - acc: 0.9092
 224/1506 [===>..........................] - ETA: 24s - loss: 0.2655 - acc: 0.9166
 256/1506 [====>.........................] - ETA: 23s - loss: 0.2549 - acc: 0.9195
 288/1506 [====>.........................] - ETA: 23s - loss: 0.2414 - acc: 0.9240
 320/1506 [=====>........................] - ETA: 22s - loss: 0.2413 - acc: 0.9250
 352/1506 [======>.......................] - ETA: 21s - loss: 0.2356 - acc: 0.9265
 384/1506 [======>.......................] - ETA: 21s - loss: 0.2321 - acc: 0.9267
 416/1506 [=======>......................] - ETA: 20s - loss: 0.2324 - acc: 0.9262
 448/1506 [=======>......................] - ETA: 19s - loss: 0.2326 - acc: 0.9267
 480/1506 [========>.....................] - ETA: 19s - loss: 0.2342 - acc: 0.9256
 512/1506 [=========>....................] - ETA: 18s - loss: 0.2302 - acc: 0.9271
 544/1506 [=========>....................] - ETA: 18s - loss: 0.2283 - acc: 0.9280
 576/1506 [==========>...................] - ETA: 17s - loss: 0.2245 - acc: 0.9298
 608/1506 [===========>..................] - ETA: 16s - loss: 0.2280 - acc: 0.9285
 640/1506 [===========>..................] - ETA: 16s - loss: 0.2259 - acc: 0.9291
 672/1506 [============>.................] - ETA: 15s - loss: 0.2241 - acc: 0.9295
 704/1506 [=============>................] - ETA: 15s - loss: 0.2212 - acc: 0.9301
 736/1506 [=============>................] - ETA: 14s - loss: 0.2198 - acc: 0.9306
 768/1506 [==============>...............] - ETA: 13s - loss: 0.2183 - acc: 0.9311
 800/1506 [==============>...............] - ETA: 13s - loss: 0.2181 - acc: 0.9313
 832/1506 [===============>..............] - ETA: 12s - loss: 0.2172 - acc: 0.9318
 864/1506 [================>.............] - ETA: 12s - loss: 0.2173 - acc: 0.9317
 896/1506 [================>.............] - ETA: 11s - loss: 0.2167 - acc: 0.9317
 928/1506 [=================>............] - ETA: 10s - loss: 0.2164 - acc: 0.9317
 960/1506 [==================>...........] - ETA: 10s - loss: 0.2147 - acc: 0.9320
 992/1506 [==================>...........] - ETA: 9s - loss: 0.2142 - acc: 0.9323 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.2144 - acc: 0.9323
1056/1506 [====================>.........] - ETA: 8s - loss: 0.2159 - acc: 0.9321
1088/1506 [====================>.........] - ETA: 7s - loss: 0.2157 - acc: 0.9317
1120/1506 [=====================>........] - ETA: 7s - loss: 0.2141 - acc: 0.9323
1152/1506 [=====================>........] - ETA: 6s - loss: 0.2136 - acc: 0.9324
1184/1506 [======================>.......] - ETA: 6s - loss: 0.2123 - acc: 0.9328
1216/1506 [=======================>......] - ETA: 5s - loss: 0.2113 - acc: 0.9332
1248/1506 [=======================>......] - ETA: 4s - loss: 0.2131 - acc: 0.9327
1280/1506 [========================>.....] - ETA: 4s - loss: 0.2124 - acc: 0.9330
1312/1506 [=========================>....] - ETA: 3s - loss: 0.2136 - acc: 0.9326
1344/1506 [=========================>....] - ETA: 3s - loss: 0.2132 - acc: 0.9329
1376/1506 [==========================>...] - ETA: 2s - loss: 0.2124 - acc: 0.9331
1408/1506 [===========================>..] - ETA: 1s - loss: 0.2122 - acc: 0.9332
1440/1506 [===========================>..] - ETA: 1s - loss: 0.2139 - acc: 0.9327
1472/1506 [============================>.] - ETA: 0s - loss: 0.2123 - acc: 0.9330
1504/1506 [============================>.] - ETA: 0s - loss: 0.2114 - acc: 0.9331
1506/1506 [==============================] - 30s 20ms/step - loss: 0.2113 - acc: 0.9332 - val_loss: 0.2100 - val_acc: 0.9321
Epoch 4/70

  32/1506 [..............................] - ETA: 28s - loss: 0.1896 - acc: 0.9388
  64/1506 [>.............................] - ETA: 27s - loss: 0.1844 - acc: 0.9421
  96/1506 [>.............................] - ETA: 26s - loss: 0.1786 - acc: 0.9432
 128/1506 [=>............................] - ETA: 25s - loss: 0.1809 - acc: 0.9423
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1719 - acc: 0.9477
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1649 - acc: 0.9505
 224/1506 [===>..........................] - ETA: 23s - loss: 0.1583 - acc: 0.9514
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1517 - acc: 0.9531
 288/1506 [====>.........................] - ETA: 22s - loss: 0.1608 - acc: 0.9505
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1578 - acc: 0.9513
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1600 - acc: 0.9501
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1612 - acc: 0.9481
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1662 - acc: 0.9468
 448/1506 [=======>......................] - ETA: 19s - loss: 0.1689 - acc: 0.9461
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1727 - acc: 0.9448
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1744 - acc: 0.9445
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1713 - acc: 0.9460
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1715 - acc: 0.9456
 608/1506 [===========>..................] - ETA: 16s - loss: 0.1707 - acc: 0.9457
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1682 - acc: 0.9470
 672/1506 [============>.................] - ETA: 15s - loss: 0.1711 - acc: 0.9458
 704/1506 [=============>................] - ETA: 15s - loss: 0.1690 - acc: 0.9465
 736/1506 [=============>................] - ETA: 14s - loss: 0.1692 - acc: 0.9469
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1688 - acc: 0.9473
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1671 - acc: 0.9477
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1670 - acc: 0.9478
 864/1506 [================>.............] - ETA: 12s - loss: 0.1681 - acc: 0.9478
 896/1506 [================>.............] - ETA: 11s - loss: 0.1667 - acc: 0.9481
 928/1506 [=================>............] - ETA: 10s - loss: 0.1673 - acc: 0.9483
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1704 - acc: 0.9474
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1728 - acc: 0.9466 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1730 - acc: 0.9466
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1728 - acc: 0.9466
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1734 - acc: 0.9466
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1731 - acc: 0.9464
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1729 - acc: 0.9465
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1736 - acc: 0.9464
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1744 - acc: 0.9462
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1731 - acc: 0.9465
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1723 - acc: 0.9466
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1730 - acc: 0.9466
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1723 - acc: 0.9469
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1728 - acc: 0.9466
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1720 - acc: 0.9466
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1725 - acc: 0.9466
1472/1506 [============================>.] - ETA: 0s - loss: 0.1732 - acc: 0.9465
1504/1506 [============================>.] - ETA: 0s - loss: 0.1757 - acc: 0.9454
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1757 - acc: 0.9453 - val_loss: 0.2087 - val_acc: 0.9322
Epoch 5/70

  32/1506 [..............................] - ETA: 27s - loss: 0.2235 - acc: 0.9342
  64/1506 [>.............................] - ETA: 27s - loss: 0.1761 - acc: 0.9486
  96/1506 [>.............................] - ETA: 26s - loss: 0.1891 - acc: 0.9436
 128/1506 [=>............................] - ETA: 25s - loss: 0.1795 - acc: 0.9466
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1812 - acc: 0.9441
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1796 - acc: 0.9427
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1817 - acc: 0.9432
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1737 - acc: 0.9465
 288/1506 [====>.........................] - ETA: 23s - loss: 0.1793 - acc: 0.9438
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1782 - acc: 0.9437
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1740 - acc: 0.9457
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1785 - acc: 0.9440
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1748 - acc: 0.9448
 448/1506 [=======>......................] - ETA: 19s - loss: 0.1811 - acc: 0.9425
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1826 - acc: 0.9422
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1808 - acc: 0.9426
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1781 - acc: 0.9437
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1761 - acc: 0.9445
 608/1506 [===========>..................] - ETA: 16s - loss: 0.1721 - acc: 0.9458
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1714 - acc: 0.9455
 672/1506 [============>.................] - ETA: 15s - loss: 0.1682 - acc: 0.9467
 704/1506 [=============>................] - ETA: 15s - loss: 0.1688 - acc: 0.9469
 736/1506 [=============>................] - ETA: 14s - loss: 0.1691 - acc: 0.9467
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1704 - acc: 0.9460
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1676 - acc: 0.9469
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1671 - acc: 0.9472
 864/1506 [================>.............] - ETA: 12s - loss: 0.1669 - acc: 0.9473
 896/1506 [================>.............] - ETA: 11s - loss: 0.1676 - acc: 0.9471
 928/1506 [=================>............] - ETA: 10s - loss: 0.1650 - acc: 0.9484
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1666 - acc: 0.9474
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1660 - acc: 0.9477 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1663 - acc: 0.9477
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1648 - acc: 0.9482
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1638 - acc: 0.9488
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1627 - acc: 0.9490
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1619 - acc: 0.9492
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1623 - acc: 0.9491
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1606 - acc: 0.9497
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1595 - acc: 0.9503
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1592 - acc: 0.9503
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1585 - acc: 0.9504
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1587 - acc: 0.9503
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1584 - acc: 0.9504
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1588 - acc: 0.9503
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1578 - acc: 0.9506
1472/1506 [============================>.] - ETA: 0s - loss: 0.1578 - acc: 0.9507
1504/1506 [============================>.] - ETA: 0s - loss: 0.1573 - acc: 0.9508
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1575 - acc: 0.9508 - val_loss: 0.3396 - val_acc: 0.8915
Epoch 6/70

  32/1506 [..............................] - ETA: 28s - loss: 0.3880 - acc: 0.8828
  64/1506 [>.............................] - ETA: 27s - loss: 0.2569 - acc: 0.9205
  96/1506 [>.............................] - ETA: 26s - loss: 0.1975 - acc: 0.9392
 128/1506 [=>............................] - ETA: 25s - loss: 0.1781 - acc: 0.9461
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1713 - acc: 0.9475
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1598 - acc: 0.9513
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1582 - acc: 0.9514
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1526 - acc: 0.9540
 288/1506 [====>.........................] - ETA: 22s - loss: 0.1496 - acc: 0.9531
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1485 - acc: 0.9523
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1492 - acc: 0.9524
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1436 - acc: 0.9543
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1429 - acc: 0.9546
 448/1506 [=======>......................] - ETA: 19s - loss: 0.1418 - acc: 0.9556
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1431 - acc: 0.9550
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1442 - acc: 0.9545
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1430 - acc: 0.9542
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1432 - acc: 0.9539
 608/1506 [===========>..................] - ETA: 16s - loss: 0.1408 - acc: 0.9546
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1444 - acc: 0.9536
 672/1506 [============>.................] - ETA: 15s - loss: 0.1434 - acc: 0.9535
 704/1506 [=============>................] - ETA: 15s - loss: 0.1415 - acc: 0.9545
 736/1506 [=============>................] - ETA: 14s - loss: 0.1399 - acc: 0.9553
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1426 - acc: 0.9547
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1435 - acc: 0.9544
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1418 - acc: 0.9550
 864/1506 [================>.............] - ETA: 12s - loss: 0.1431 - acc: 0.9543
 896/1506 [================>.............] - ETA: 11s - loss: 0.1424 - acc: 0.9542
 928/1506 [=================>............] - ETA: 10s - loss: 0.1442 - acc: 0.9540
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1439 - acc: 0.9544
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1453 - acc: 0.9541 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1462 - acc: 0.9538
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1471 - acc: 0.9532
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1470 - acc: 0.9535
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1469 - acc: 0.9535
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1465 - acc: 0.9536
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1464 - acc: 0.9533
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1451 - acc: 0.9537
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1442 - acc: 0.9542
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1449 - acc: 0.9537
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1460 - acc: 0.9535
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1449 - acc: 0.9538
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1454 - acc: 0.9535
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1456 - acc: 0.9535
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1459 - acc: 0.9535
1472/1506 [============================>.] - ETA: 0s - loss: 0.1463 - acc: 0.9535
1504/1506 [============================>.] - ETA: 0s - loss: 0.1455 - acc: 0.9537
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1454 - acc: 0.9537 - val_loss: 0.1663 - val_acc: 0.9448
Epoch 7/70

  32/1506 [..............................] - ETA: 27s - loss: 0.1289 - acc: 0.9472
  64/1506 [>.............................] - ETA: 26s - loss: 0.1559 - acc: 0.9400
  96/1506 [>.............................] - ETA: 26s - loss: 0.1477 - acc: 0.9464
 128/1506 [=>............................] - ETA: 25s - loss: 0.1425 - acc: 0.9513
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1404 - acc: 0.9536
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1350 - acc: 0.9556
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1347 - acc: 0.9561
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1294 - acc: 0.9573
 288/1506 [====>.........................] - ETA: 22s - loss: 0.1363 - acc: 0.9548
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1324 - acc: 0.9569
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1315 - acc: 0.9576
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1320 - acc: 0.9576
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1350 - acc: 0.9569
 448/1506 [=======>......................] - ETA: 19s - loss: 0.1363 - acc: 0.9572
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1357 - acc: 0.9573
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1339 - acc: 0.9580
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1321 - acc: 0.9590
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1329 - acc: 0.9586
 608/1506 [===========>..................] - ETA: 16s - loss: 0.1328 - acc: 0.9583
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1336 - acc: 0.9578
 672/1506 [============>.................] - ETA: 15s - loss: 0.1309 - acc: 0.9585
 704/1506 [=============>................] - ETA: 15s - loss: 0.1306 - acc: 0.9584
 736/1506 [=============>................] - ETA: 14s - loss: 0.1299 - acc: 0.9585
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1298 - acc: 0.9586
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1320 - acc: 0.9579
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1304 - acc: 0.9585
 864/1506 [================>.............] - ETA: 12s - loss: 0.1305 - acc: 0.9584
 896/1506 [================>.............] - ETA: 11s - loss: 0.1300 - acc: 0.9584
 928/1506 [=================>............] - ETA: 10s - loss: 0.1307 - acc: 0.9582
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1306 - acc: 0.9586
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1290 - acc: 0.9593 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1284 - acc: 0.9595
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1280 - acc: 0.9596
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1279 - acc: 0.9594
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1272 - acc: 0.9593
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1269 - acc: 0.9596
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1263 - acc: 0.9599
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1265 - acc: 0.9599
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1273 - acc: 0.9595
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1278 - acc: 0.9590
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1279 - acc: 0.9590
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1279 - acc: 0.9591
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1296 - acc: 0.9587
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1300 - acc: 0.9586
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1302 - acc: 0.9587
1472/1506 [============================>.] - ETA: 0s - loss: 0.1310 - acc: 0.9584
1504/1506 [============================>.] - ETA: 0s - loss: 0.1308 - acc: 0.9585
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1308 - acc: 0.9586 - val_loss: 0.2233 - val_acc: 0.9303
Epoch 8/70

  32/1506 [..............................] - ETA: 27s - loss: 0.1961 - acc: 0.9377
  64/1506 [>.............................] - ETA: 26s - loss: 0.1826 - acc: 0.9462
  96/1506 [>.............................] - ETA: 26s - loss: 0.1658 - acc: 0.9500
 128/1506 [=>............................] - ETA: 26s - loss: 0.1466 - acc: 0.9569
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1368 - acc: 0.9592
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1352 - acc: 0.9583
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1317 - acc: 0.9594
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1266 - acc: 0.9609
 288/1506 [====>.........................] - ETA: 23s - loss: 0.1261 - acc: 0.9605
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1224 - acc: 0.9617
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1221 - acc: 0.9613
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1238 - acc: 0.9617
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1225 - acc: 0.9612
 448/1506 [=======>......................] - ETA: 20s - loss: 0.1247 - acc: 0.9604
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1242 - acc: 0.9604
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1243 - acc: 0.9603
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1234 - acc: 0.9611
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1248 - acc: 0.9608
 608/1506 [===========>..................] - ETA: 16s - loss: 0.1237 - acc: 0.9610
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1204 - acc: 0.9622
 672/1506 [============>.................] - ETA: 15s - loss: 0.1201 - acc: 0.9621
 704/1506 [=============>................] - ETA: 15s - loss: 0.1198 - acc: 0.9622
 736/1506 [=============>................] - ETA: 14s - loss: 0.1192 - acc: 0.9623
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1177 - acc: 0.9624
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1161 - acc: 0.9628
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1151 - acc: 0.9630
 864/1506 [================>.............] - ETA: 12s - loss: 0.1135 - acc: 0.9637
 896/1506 [================>.............] - ETA: 11s - loss: 0.1130 - acc: 0.9644
 928/1506 [=================>............] - ETA: 10s - loss: 0.1139 - acc: 0.9643
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1143 - acc: 0.9645
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1152 - acc: 0.9646 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1173 - acc: 0.9636
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1182 - acc: 0.9634
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1179 - acc: 0.9634
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1175 - acc: 0.9636
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1183 - acc: 0.9631
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1193 - acc: 0.9629
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1184 - acc: 0.9631
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1190 - acc: 0.9630
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1183 - acc: 0.9633
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1177 - acc: 0.9636
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1172 - acc: 0.9637
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1174 - acc: 0.9637
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1184 - acc: 0.9633
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1191 - acc: 0.9630
1472/1506 [============================>.] - ETA: 0s - loss: 0.1195 - acc: 0.9629
1504/1506 [============================>.] - ETA: 0s - loss: 0.1198 - acc: 0.9628
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1197 - acc: 0.9629 - val_loss: 0.1619 - val_acc: 0.9480
Epoch 9/70

  32/1506 [..............................] - ETA: 27s - loss: 0.0983 - acc: 0.9581
  64/1506 [>.............................] - ETA: 27s - loss: 0.0897 - acc: 0.9658
  96/1506 [>.............................] - ETA: 26s - loss: 0.0819 - acc: 0.9704
 128/1506 [=>............................] - ETA: 26s - loss: 0.0823 - acc: 0.9729
 160/1506 [==>...........................] - ETA: 25s - loss: 0.0777 - acc: 0.9754
 192/1506 [==>...........................] - ETA: 24s - loss: 0.0835 - acc: 0.9726
 224/1506 [===>..........................] - ETA: 24s - loss: 0.0842 - acc: 0.9712
 256/1506 [====>.........................] - ETA: 23s - loss: 0.0891 - acc: 0.9710
 288/1506 [====>.........................] - ETA: 22s - loss: 0.0887 - acc: 0.9708
 320/1506 [=====>........................] - ETA: 22s - loss: 0.0905 - acc: 0.9699
 352/1506 [======>.......................] - ETA: 21s - loss: 0.0867 - acc: 0.9718
 384/1506 [======>.......................] - ETA: 21s - loss: 0.0914 - acc: 0.9693
 416/1506 [=======>......................] - ETA: 20s - loss: 0.0933 - acc: 0.9693
 448/1506 [=======>......................] - ETA: 19s - loss: 0.0924 - acc: 0.9698
 480/1506 [========>.....................] - ETA: 19s - loss: 0.0920 - acc: 0.9698
 512/1506 [=========>....................] - ETA: 18s - loss: 0.0930 - acc: 0.9700
 544/1506 [=========>....................] - ETA: 18s - loss: 0.0931 - acc: 0.9699
 576/1506 [==========>...................] - ETA: 17s - loss: 0.0932 - acc: 0.9697
 608/1506 [===========>..................] - ETA: 16s - loss: 0.0940 - acc: 0.9698
 640/1506 [===========>..................] - ETA: 16s - loss: 0.0984 - acc: 0.9690
 672/1506 [============>.................] - ETA: 15s - loss: 0.0984 - acc: 0.9693
 704/1506 [=============>................] - ETA: 15s - loss: 0.1018 - acc: 0.9688
 736/1506 [=============>................] - ETA: 14s - loss: 0.1031 - acc: 0.9686
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1029 - acc: 0.9685
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1014 - acc: 0.9690
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1019 - acc: 0.9688
 864/1506 [================>.............] - ETA: 12s - loss: 0.1040 - acc: 0.9683
 896/1506 [================>.............] - ETA: 11s - loss: 0.1028 - acc: 0.9685
 928/1506 [=================>............] - ETA: 10s - loss: 0.1014 - acc: 0.9689
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1016 - acc: 0.9686
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1019 - acc: 0.9685 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1028 - acc: 0.9682
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1023 - acc: 0.9681
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1021 - acc: 0.9683
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1026 - acc: 0.9681
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1031 - acc: 0.9678
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1043 - acc: 0.9673
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1049 - acc: 0.9669
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1050 - acc: 0.9668
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1052 - acc: 0.9667
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1052 - acc: 0.9666
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1057 - acc: 0.9664
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1055 - acc: 0.9667
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1047 - acc: 0.9669
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1047 - acc: 0.9669
1472/1506 [============================>.] - ETA: 0s - loss: 0.1054 - acc: 0.9666
1504/1506 [============================>.] - ETA: 0s - loss: 0.1059 - acc: 0.9662
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1059 - acc: 0.9662 - val_loss: 0.1549 - val_acc: 0.9496
Epoch 10/70

  32/1506 [..............................] - ETA: 28s - loss: 0.0926 - acc: 0.9707
  64/1506 [>.............................] - ETA: 27s - loss: 0.0939 - acc: 0.9711
  96/1506 [>.............................] - ETA: 26s - loss: 0.0930 - acc: 0.9707
 128/1506 [=>............................] - ETA: 25s - loss: 0.0870 - acc: 0.9730
 160/1506 [==>...........................] - ETA: 25s - loss: 0.0915 - acc: 0.9699
 192/1506 [==>...........................] - ETA: 24s - loss: 0.0874 - acc: 0.9719
 224/1506 [===>..........................] - ETA: 24s - loss: 0.0842 - acc: 0.9725
 256/1506 [====>.........................] - ETA: 23s - loss: 0.0890 - acc: 0.9713
 288/1506 [====>.........................] - ETA: 22s - loss: 0.0872 - acc: 0.9717
 320/1506 [=====>........................] - ETA: 22s - loss: 0.0861 - acc: 0.9718
 352/1506 [======>.......................] - ETA: 21s - loss: 0.0883 - acc: 0.9712
 384/1506 [======>.......................] - ETA: 21s - loss: 0.0864 - acc: 0.9720
 416/1506 [=======>......................] - ETA: 20s - loss: 0.0875 - acc: 0.9721
 448/1506 [=======>......................] - ETA: 19s - loss: 0.0886 - acc: 0.9719
 480/1506 [========>.....................] - ETA: 19s - loss: 0.0923 - acc: 0.9715
 512/1506 [=========>....................] - ETA: 18s - loss: 0.0948 - acc: 0.9710
 544/1506 [=========>....................] - ETA: 18s - loss: 0.0948 - acc: 0.9710
 576/1506 [==========>...................] - ETA: 17s - loss: 0.0946 - acc: 0.9713
 608/1506 [===========>..................] - ETA: 16s - loss: 0.0975 - acc: 0.9708
 640/1506 [===========>..................] - ETA: 16s - loss: 0.0964 - acc: 0.9712
 672/1506 [============>.................] - ETA: 15s - loss: 0.0967 - acc: 0.9709
 704/1506 [=============>................] - ETA: 15s - loss: 0.0965 - acc: 0.9711
 736/1506 [=============>................] - ETA: 14s - loss: 0.0976 - acc: 0.9706
 768/1506 [==============>...............] - ETA: 13s - loss: 0.0983 - acc: 0.9701
 800/1506 [==============>...............] - ETA: 13s - loss: 0.0964 - acc: 0.9707
 832/1506 [===============>..............] - ETA: 12s - loss: 0.0968 - acc: 0.9704
 864/1506 [================>.............] - ETA: 12s - loss: 0.0978 - acc: 0.9703
 896/1506 [================>.............] - ETA: 11s - loss: 0.0992 - acc: 0.9697
 928/1506 [=================>............] - ETA: 10s - loss: 0.1010 - acc: 0.9689
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1014 - acc: 0.9686
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1009 - acc: 0.9687 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1000 - acc: 0.9689
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1011 - acc: 0.9685
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1008 - acc: 0.9686
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1011 - acc: 0.9687
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1012 - acc: 0.9687
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1008 - acc: 0.9688
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1004 - acc: 0.9688
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1035 - acc: 0.9679
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1037 - acc: 0.9680
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1027 - acc: 0.9682
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1040 - acc: 0.9676
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1040 - acc: 0.9678
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1037 - acc: 0.9679
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1028 - acc: 0.9682
1472/1506 [============================>.] - ETA: 0s - loss: 0.1029 - acc: 0.9681
1504/1506 [============================>.] - ETA: 0s - loss: 0.1025 - acc: 0.9683
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1026 - acc: 0.9682 - val_loss: 0.1989 - val_acc: 0.9416
Epoch 11/70

  32/1506 [..............................] - ETA: 27s - loss: 0.1081 - acc: 0.9685
  64/1506 [>.............................] - ETA: 26s - loss: 0.1099 - acc: 0.9658
  96/1506 [>.............................] - ETA: 26s - loss: 0.0965 - acc: 0.9703
 128/1506 [=>............................] - ETA: 25s - loss: 0.0981 - acc: 0.9688
 160/1506 [==>...........................] - ETA: 25s - loss: 0.0902 - acc: 0.9718
 192/1506 [==>...........................] - ETA: 24s - loss: 0.0851 - acc: 0.9732
 224/1506 [===>..........................] - ETA: 24s - loss: 0.0845 - acc: 0.9736
 256/1506 [====>.........................] - ETA: 23s - loss: 0.0785 - acc: 0.9756
 288/1506 [====>.........................] - ETA: 23s - loss: 0.0798 - acc: 0.9750
 320/1506 [=====>........................] - ETA: 22s - loss: 0.0820 - acc: 0.9743
 352/1506 [======>.......................] - ETA: 21s - loss: 0.0851 - acc: 0.9735
 384/1506 [======>.......................] - ETA: 21s - loss: 0.0823 - acc: 0.9743
 416/1506 [=======>......................] - ETA: 20s - loss: 0.0856 - acc: 0.9739
 448/1506 [=======>......................] - ETA: 20s - loss: 0.0855 - acc: 0.9737
 480/1506 [========>.....................] - ETA: 19s - loss: 0.0848 - acc: 0.9739
 512/1506 [=========>....................] - ETA: 18s - loss: 0.0854 - acc: 0.9735
 544/1506 [=========>....................] - ETA: 18s - loss: 0.0847 - acc: 0.9739
 576/1506 [==========>...................] - ETA: 17s - loss: 0.0868 - acc: 0.9732
 608/1506 [===========>..................] - ETA: 16s - loss: 0.0873 - acc: 0.9734
 640/1506 [===========>..................] - ETA: 16s - loss: 0.0883 - acc: 0.9731
 672/1506 [============>.................] - ETA: 15s - loss: 0.0884 - acc: 0.9730
 704/1506 [=============>................] - ETA: 15s - loss: 0.0886 - acc: 0.9727
 736/1506 [=============>................] - ETA: 14s - loss: 0.0903 - acc: 0.9723
 768/1506 [==============>...............] - ETA: 13s - loss: 0.0902 - acc: 0.9727
 800/1506 [==============>...............] - ETA: 13s - loss: 0.0908 - acc: 0.9723
 832/1506 [===============>..............] - ETA: 12s - loss: 0.0915 - acc: 0.9721
 864/1506 [================>.............] - ETA: 12s - loss: 0.0923 - acc: 0.9718
 896/1506 [================>.............] - ETA: 11s - loss: 0.0910 - acc: 0.9724
 928/1506 [=================>............] - ETA: 10s - loss: 0.0908 - acc: 0.9726
 960/1506 [==================>...........] - ETA: 10s - loss: 0.0912 - acc: 0.9723
 992/1506 [==================>...........] - ETA: 9s - loss: 0.0925 - acc: 0.9722 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.0929 - acc: 0.9722
1056/1506 [====================>.........] - ETA: 8s - loss: 0.0925 - acc: 0.9723
1088/1506 [====================>.........] - ETA: 7s - loss: 0.0925 - acc: 0.9722
1120/1506 [=====================>........] - ETA: 7s - loss: 0.0923 - acc: 0.9723
1152/1506 [=====================>........] - ETA: 6s - loss: 0.0916 - acc: 0.9723
1184/1506 [======================>.......] - ETA: 6s - loss: 0.0910 - acc: 0.9723
1216/1506 [=======================>......] - ETA: 5s - loss: 0.0916 - acc: 0.9720
1248/1506 [=======================>......] - ETA: 4s - loss: 0.0924 - acc: 0.9718
1280/1506 [========================>.....] - ETA: 4s - loss: 0.0931 - acc: 0.9714
1312/1506 [=========================>....] - ETA: 3s - loss: 0.0926 - acc: 0.9714
1344/1506 [=========================>....] - ETA: 3s - loss: 0.0936 - acc: 0.9713
1376/1506 [==========================>...] - ETA: 2s - loss: 0.0934 - acc: 0.9714
1408/1506 [===========================>..] - ETA: 1s - loss: 0.0939 - acc: 0.9713
1440/1506 [===========================>..] - ETA: 1s - loss: 0.0938 - acc: 0.9714
1472/1506 [============================>.] - ETA: 0s - loss: 0.0938 - acc: 0.9716
1504/1506 [============================>.] - ETA: 0s - loss: 0.0938 - acc: 0.9714
1506/1506 [==============================] - 30s 20ms/step - loss: 0.0941 - acc: 0.9713 - val_loss: 0.1763 - val_acc: 0.9429
Computing...
Manual evaluation: (didn't understand why I made this)
True 8182
False 889
True percentage 0.90199536986
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.84      0.86      0.85       438
      B-ORG       0.76      0.70      0.73       296
     I-MISC       0.63      0.26      0.37       154
      B-LOC       0.59      0.85      0.70       218
      I-LOC       0.65      0.84      0.73       141
      I-ORG       0.59      0.60      0.60       151
      I-PER       0.87      0.65      0.74       214
     B-MISC       0.61      0.20      0.30       141

avg / total       0.93      0.90      0.91      9071

F-1 Score:
0.699086354259
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 1674 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 237
OOV word occurences: 324
Padding...
Data padded!
Padding...
Data padded!
Padded until 83 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,992,194
Trainable params: 6,992,194
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1506 samples, validate on 168 samples
Epoch 1/70

  32/1506 [..............................] - ETA: 2:09 - loss: 2.5501 - acc: 0.0075
  64/1506 [>.............................] - ETA: 1:18 - loss: 1.7568 - acc: 0.4215
  96/1506 [>.............................] - ETA: 1:01 - loss: 2.0242 - acc: 0.5543
 128/1506 [=>............................] - ETA: 52s - loss: 1.7637 - acc: 0.6134 
 160/1506 [==>...........................] - ETA: 46s - loss: 1.5567 - acc: 0.6589
 192/1506 [==>...........................] - ETA: 41s - loss: 1.4440 - acc: 0.6806
 224/1506 [===>..........................] - ETA: 38s - loss: 1.3543 - acc: 0.6968
 256/1506 [====>.........................] - ETA: 36s - loss: 1.2747 - acc: 0.7115
 288/1506 [====>.........................] - ETA: 34s - loss: 1.2187 - acc: 0.7202
 320/1506 [=====>........................] - ETA: 32s - loss: 1.1711 - acc: 0.7278
 352/1506 [======>.......................] - ETA: 30s - loss: 1.1194 - acc: 0.7362
 384/1506 [======>.......................] - ETA: 29s - loss: 1.0782 - acc: 0.7420
 416/1506 [=======>......................] - ETA: 27s - loss: 1.0422 - acc: 0.7487
 448/1506 [=======>......................] - ETA: 26s - loss: 1.0109 - acc: 0.7538
 480/1506 [========>.....................] - ETA: 25s - loss: 0.9808 - acc: 0.7590
 512/1506 [=========>....................] - ETA: 24s - loss: 0.9495 - acc: 0.7650
 544/1506 [=========>....................] - ETA: 23s - loss: 0.9221 - acc: 0.7704
 576/1506 [==========>...................] - ETA: 22s - loss: 0.8978 - acc: 0.7748
 608/1506 [===========>..................] - ETA: 21s - loss: 0.8773 - acc: 0.7786
 640/1506 [===========>..................] - ETA: 20s - loss: 0.8610 - acc: 0.7804
 672/1506 [============>.................] - ETA: 19s - loss: 0.8483 - acc: 0.7849
 704/1506 [=============>................] - ETA: 18s - loss: 0.8303 - acc: 0.7885
 736/1506 [=============>................] - ETA: 17s - loss: 0.8157 - acc: 0.7908
 768/1506 [==============>...............] - ETA: 16s - loss: 0.8011 - acc: 0.7941
 800/1506 [==============>...............] - ETA: 16s - loss: 0.7858 - acc: 0.7967
 832/1506 [===============>..............] - ETA: 15s - loss: 0.7727 - acc: 0.7997
 864/1506 [================>.............] - ETA: 14s - loss: 0.7604 - acc: 0.8021
 896/1506 [================>.............] - ETA: 13s - loss: 0.7488 - acc: 0.8044
 928/1506 [=================>............] - ETA: 12s - loss: 0.7372 - acc: 0.8070
 960/1506 [==================>...........] - ETA: 12s - loss: 0.7258 - acc: 0.8092
 992/1506 [==================>...........] - ETA: 11s - loss: 0.7180 - acc: 0.8103
1024/1506 [===================>..........] - ETA: 10s - loss: 0.7088 - acc: 0.8122
1056/1506 [====================>.........] - ETA: 9s - loss: 0.6977 - acc: 0.8145 
1088/1506 [====================>.........] - ETA: 9s - loss: 0.6890 - acc: 0.8166
1120/1506 [=====================>........] - ETA: 8s - loss: 0.6789 - acc: 0.8191
1152/1506 [=====================>........] - ETA: 7s - loss: 0.6702 - acc: 0.8208
1184/1506 [======================>.......] - ETA: 6s - loss: 0.6618 - acc: 0.8226
1216/1506 [=======================>......] - ETA: 6s - loss: 0.6536 - acc: 0.8245
1248/1506 [=======================>......] - ETA: 5s - loss: 0.6452 - acc: 0.8265
1280/1506 [========================>.....] - ETA: 4s - loss: 0.6369 - acc: 0.8284
1312/1506 [=========================>....] - ETA: 4s - loss: 0.6306 - acc: 0.8300
1344/1506 [=========================>....] - ETA: 3s - loss: 0.6241 - acc: 0.8312
1376/1506 [==========================>...] - ETA: 2s - loss: 0.6173 - acc: 0.8331
1408/1506 [===========================>..] - ETA: 2s - loss: 0.6112 - acc: 0.8342
1440/1506 [===========================>..] - ETA: 1s - loss: 0.6064 - acc: 0.8356
1472/1506 [============================>.] - ETA: 0s - loss: 0.5991 - acc: 0.8373
1504/1506 [============================>.] - ETA: 0s - loss: 0.5929 - acc: 0.8385
1506/1506 [==============================] - 33s 22ms/step - loss: 0.5929 - acc: 0.8384 - val_loss: 0.4395 - val_acc: 0.8520
Epoch 2/70

  32/1506 [..............................] - ETA: 27s - loss: 0.4265 - acc: 0.8551
  64/1506 [>.............................] - ETA: 27s - loss: 0.3496 - acc: 0.8862
  96/1506 [>.............................] - ETA: 27s - loss: 0.3465 - acc: 0.8857
 128/1506 [=>............................] - ETA: 26s - loss: 0.3293 - acc: 0.8948
 160/1506 [==>...........................] - ETA: 25s - loss: 0.3245 - acc: 0.8958
 192/1506 [==>...........................] - ETA: 25s - loss: 0.3197 - acc: 0.8968
 224/1506 [===>..........................] - ETA: 24s - loss: 0.3198 - acc: 0.8967
 256/1506 [====>.........................] - ETA: 23s - loss: 0.3081 - acc: 0.9012
 288/1506 [====>.........................] - ETA: 23s - loss: 0.2989 - acc: 0.9038
 320/1506 [=====>........................] - ETA: 22s - loss: 0.2932 - acc: 0.9066
 352/1506 [======>.......................] - ETA: 21s - loss: 0.2945 - acc: 0.9065
 384/1506 [======>.......................] - ETA: 21s - loss: 0.2998 - acc: 0.9054
 416/1506 [=======>......................] - ETA: 20s - loss: 0.2972 - acc: 0.9060
 448/1506 [=======>......................] - ETA: 20s - loss: 0.2945 - acc: 0.9070
 480/1506 [========>.....................] - ETA: 19s - loss: 0.2999 - acc: 0.9048
 512/1506 [=========>....................] - ETA: 18s - loss: 0.2958 - acc: 0.9062
 544/1506 [=========>....................] - ETA: 18s - loss: 0.2912 - acc: 0.9080
 576/1506 [==========>...................] - ETA: 17s - loss: 0.2915 - acc: 0.9081
 608/1506 [===========>..................] - ETA: 17s - loss: 0.2880 - acc: 0.9095
 640/1506 [===========>..................] - ETA: 16s - loss: 0.2882 - acc: 0.9092
 672/1506 [============>.................] - ETA: 15s - loss: 0.2853 - acc: 0.9101
 704/1506 [=============>................] - ETA: 15s - loss: 0.2839 - acc: 0.9108
 736/1506 [=============>................] - ETA: 14s - loss: 0.2835 - acc: 0.9111
 768/1506 [==============>...............] - ETA: 14s - loss: 0.2843 - acc: 0.9108
 800/1506 [==============>...............] - ETA: 13s - loss: 0.2834 - acc: 0.9112
 832/1506 [===============>..............] - ETA: 12s - loss: 0.2807 - acc: 0.9121
 864/1506 [================>.............] - ETA: 12s - loss: 0.2809 - acc: 0.9121
 896/1506 [================>.............] - ETA: 11s - loss: 0.2798 - acc: 0.9130
 928/1506 [=================>............] - ETA: 11s - loss: 0.2785 - acc: 0.9136
 960/1506 [==================>...........] - ETA: 10s - loss: 0.2794 - acc: 0.9133
 992/1506 [==================>...........] - ETA: 9s - loss: 0.2789 - acc: 0.9134 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.2760 - acc: 0.9140
1056/1506 [====================>.........] - ETA: 8s - loss: 0.2737 - acc: 0.9149
1088/1506 [====================>.........] - ETA: 7s - loss: 0.2725 - acc: 0.9154
1120/1506 [=====================>........] - ETA: 7s - loss: 0.2733 - acc: 0.9149
1152/1506 [=====================>........] - ETA: 6s - loss: 0.2730 - acc: 0.9149
1184/1506 [======================>.......] - ETA: 6s - loss: 0.2722 - acc: 0.9151
1216/1506 [=======================>......] - ETA: 5s - loss: 0.2696 - acc: 0.9161
1248/1506 [=======================>......] - ETA: 4s - loss: 0.2682 - acc: 0.9165
1280/1506 [========================>.....] - ETA: 4s - loss: 0.2656 - acc: 0.9174
1312/1506 [=========================>....] - ETA: 3s - loss: 0.2683 - acc: 0.9165
1344/1506 [=========================>....] - ETA: 3s - loss: 0.2659 - acc: 0.9173
1376/1506 [==========================>...] - ETA: 2s - loss: 0.2666 - acc: 0.9171
1408/1506 [===========================>..] - ETA: 1s - loss: 0.2657 - acc: 0.9175
1440/1506 [===========================>..] - ETA: 1s - loss: 0.2649 - acc: 0.9176
1472/1506 [============================>.] - ETA: 0s - loss: 0.2647 - acc: 0.9180
1504/1506 [============================>.] - ETA: 0s - loss: 0.2636 - acc: 0.9183
1506/1506 [==============================] - 30s 20ms/step - loss: 0.2633 - acc: 0.9183 - val_loss: 0.2748 - val_acc: 0.9067
Epoch 3/70

  32/1506 [..............................] - ETA: 27s - loss: 0.2786 - acc: 0.9111
  64/1506 [>.............................] - ETA: 27s - loss: 0.2410 - acc: 0.9201
  96/1506 [>.............................] - ETA: 26s - loss: 0.2568 - acc: 0.9147
 128/1506 [=>............................] - ETA: 25s - loss: 0.2469 - acc: 0.9187
 160/1506 [==>...........................] - ETA: 25s - loss: 0.2387 - acc: 0.9239
 192/1506 [==>...........................] - ETA: 24s - loss: 0.2286 - acc: 0.9291
 224/1506 [===>..........................] - ETA: 24s - loss: 0.2227 - acc: 0.9321
 256/1506 [====>.........................] - ETA: 23s - loss: 0.2209 - acc: 0.9334
 288/1506 [====>.........................] - ETA: 22s - loss: 0.2165 - acc: 0.9343
 320/1506 [=====>........................] - ETA: 22s - loss: 0.2127 - acc: 0.9348
 352/1506 [======>.......................] - ETA: 21s - loss: 0.2138 - acc: 0.9343
 384/1506 [======>.......................] - ETA: 21s - loss: 0.2182 - acc: 0.9315
 416/1506 [=======>......................] - ETA: 20s - loss: 0.2207 - acc: 0.9310
 448/1506 [=======>......................] - ETA: 19s - loss: 0.2180 - acc: 0.9324
 480/1506 [========>.....................] - ETA: 19s - loss: 0.2220 - acc: 0.9319
 512/1506 [=========>....................] - ETA: 18s - loss: 0.2211 - acc: 0.9327
 544/1506 [=========>....................] - ETA: 18s - loss: 0.2197 - acc: 0.9327
 576/1506 [==========>...................] - ETA: 17s - loss: 0.2221 - acc: 0.9321
 608/1506 [===========>..................] - ETA: 16s - loss: 0.2251 - acc: 0.9309
 640/1506 [===========>..................] - ETA: 16s - loss: 0.2257 - acc: 0.9311
 672/1506 [============>.................] - ETA: 15s - loss: 0.2264 - acc: 0.9303
 704/1506 [=============>................] - ETA: 15s - loss: 0.2276 - acc: 0.9299
 736/1506 [=============>................] - ETA: 14s - loss: 0.2276 - acc: 0.9290
 768/1506 [==============>...............] - ETA: 13s - loss: 0.2261 - acc: 0.9298
 800/1506 [==============>...............] - ETA: 13s - loss: 0.2240 - acc: 0.9307
 832/1506 [===============>..............] - ETA: 12s - loss: 0.2218 - acc: 0.9308
 864/1506 [================>.............] - ETA: 12s - loss: 0.2220 - acc: 0.9306
 896/1506 [================>.............] - ETA: 11s - loss: 0.2192 - acc: 0.9314
 928/1506 [=================>............] - ETA: 10s - loss: 0.2189 - acc: 0.9312
 960/1506 [==================>...........] - ETA: 10s - loss: 0.2194 - acc: 0.9305
 992/1506 [==================>...........] - ETA: 9s - loss: 0.2165 - acc: 0.9318 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.2157 - acc: 0.9318
1056/1506 [====================>.........] - ETA: 8s - loss: 0.2164 - acc: 0.9315
1088/1506 [====================>.........] - ETA: 7s - loss: 0.2152 - acc: 0.9317
1120/1506 [=====================>........] - ETA: 7s - loss: 0.2163 - acc: 0.9311
1152/1506 [=====================>........] - ETA: 6s - loss: 0.2159 - acc: 0.9311
1184/1506 [======================>.......] - ETA: 6s - loss: 0.2172 - acc: 0.9310
1216/1506 [=======================>......] - ETA: 5s - loss: 0.2169 - acc: 0.9311
1248/1506 [=======================>......] - ETA: 4s - loss: 0.2175 - acc: 0.9306
1280/1506 [========================>.....] - ETA: 4s - loss: 0.2156 - acc: 0.9312
1312/1506 [=========================>....] - ETA: 3s - loss: 0.2158 - acc: 0.9310
1344/1506 [=========================>....] - ETA: 3s - loss: 0.2148 - acc: 0.9313
1376/1506 [==========================>...] - ETA: 2s - loss: 0.2135 - acc: 0.9319
1408/1506 [===========================>..] - ETA: 1s - loss: 0.2126 - acc: 0.9323
1440/1506 [===========================>..] - ETA: 1s - loss: 0.2130 - acc: 0.9321
1472/1506 [============================>.] - ETA: 0s - loss: 0.2128 - acc: 0.9322
1504/1506 [============================>.] - ETA: 0s - loss: 0.2136 - acc: 0.9320
1506/1506 [==============================] - 30s 20ms/step - loss: 0.2136 - acc: 0.9321 - val_loss: 0.2367 - val_acc: 0.9187
Epoch 4/70

  32/1506 [..............................] - ETA: 27s - loss: 0.1784 - acc: 0.9416
  64/1506 [>.............................] - ETA: 27s - loss: 0.1707 - acc: 0.9401
  96/1506 [>.............................] - ETA: 26s - loss: 0.1678 - acc: 0.9444
 128/1506 [=>............................] - ETA: 26s - loss: 0.1722 - acc: 0.9417
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1762 - acc: 0.9428
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1834 - acc: 0.9381
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1952 - acc: 0.9354
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1937 - acc: 0.9347
 288/1506 [====>.........................] - ETA: 23s - loss: 0.1955 - acc: 0.9343
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1958 - acc: 0.9358
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1995 - acc: 0.9341
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1924 - acc: 0.9363
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1902 - acc: 0.9379
 448/1506 [=======>......................] - ETA: 20s - loss: 0.1907 - acc: 0.9371
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1888 - acc: 0.9378
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1868 - acc: 0.9388
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1855 - acc: 0.9399
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1861 - acc: 0.9401
 608/1506 [===========>..................] - ETA: 17s - loss: 0.1869 - acc: 0.9395
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1897 - acc: 0.9389
 672/1506 [============>.................] - ETA: 15s - loss: 0.1906 - acc: 0.9384
 704/1506 [=============>................] - ETA: 15s - loss: 0.1876 - acc: 0.9392
 736/1506 [=============>................] - ETA: 14s - loss: 0.1888 - acc: 0.9385
 768/1506 [==============>...............] - ETA: 14s - loss: 0.1862 - acc: 0.9395
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1849 - acc: 0.9399
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1843 - acc: 0.9405
 864/1506 [================>.............] - ETA: 12s - loss: 0.1827 - acc: 0.9411
 896/1506 [================>.............] - ETA: 11s - loss: 0.1812 - acc: 0.9416
 928/1506 [=================>............] - ETA: 10s - loss: 0.1795 - acc: 0.9420
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1802 - acc: 0.9416
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1813 - acc: 0.9410 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1813 - acc: 0.9413
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1804 - acc: 0.9415
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1789 - acc: 0.9422
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1783 - acc: 0.9426
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1772 - acc: 0.9431
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1776 - acc: 0.9430
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1784 - acc: 0.9426
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1796 - acc: 0.9426
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1807 - acc: 0.9424
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1798 - acc: 0.9427
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1792 - acc: 0.9430
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1785 - acc: 0.9433
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1797 - acc: 0.9428
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1798 - acc: 0.9427
1472/1506 [============================>.] - ETA: 0s - loss: 0.1806 - acc: 0.9427
1504/1506 [============================>.] - ETA: 0s - loss: 0.1801 - acc: 0.9429
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1799 - acc: 0.9429 - val_loss: 0.1949 - val_acc: 0.9371
Epoch 5/70

  32/1506 [..............................] - ETA: 27s - loss: 0.2377 - acc: 0.9287
  64/1506 [>.............................] - ETA: 27s - loss: 0.2193 - acc: 0.9283
  96/1506 [>.............................] - ETA: 26s - loss: 0.2016 - acc: 0.9346
 128/1506 [=>............................] - ETA: 26s - loss: 0.2027 - acc: 0.9325
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1868 - acc: 0.9379
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1860 - acc: 0.9401
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1872 - acc: 0.9404
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1863 - acc: 0.9413
 288/1506 [====>.........................] - ETA: 23s - loss: 0.1840 - acc: 0.9431
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1819 - acc: 0.9440
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1799 - acc: 0.9439
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1744 - acc: 0.9462
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1710 - acc: 0.9468
 448/1506 [=======>......................] - ETA: 20s - loss: 0.1672 - acc: 0.9478
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1657 - acc: 0.9481
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1694 - acc: 0.9455
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1666 - acc: 0.9463
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1666 - acc: 0.9473
 608/1506 [===========>..................] - ETA: 17s - loss: 0.1656 - acc: 0.9476
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1643 - acc: 0.9473
 672/1506 [============>.................] - ETA: 15s - loss: 0.1619 - acc: 0.9485
 704/1506 [=============>................] - ETA: 15s - loss: 0.1628 - acc: 0.9485
 736/1506 [=============>................] - ETA: 14s - loss: 0.1607 - acc: 0.9491
 768/1506 [==============>...............] - ETA: 14s - loss: 0.1625 - acc: 0.9487
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1619 - acc: 0.9488
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1650 - acc: 0.9477
 864/1506 [================>.............] - ETA: 12s - loss: 0.1653 - acc: 0.9478
 896/1506 [================>.............] - ETA: 11s - loss: 0.1648 - acc: 0.9479
 928/1506 [=================>............] - ETA: 11s - loss: 0.1649 - acc: 0.9480
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1639 - acc: 0.9481
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1647 - acc: 0.9478 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1646 - acc: 0.9481
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1644 - acc: 0.9479
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1640 - acc: 0.9480
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1625 - acc: 0.9484
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1610 - acc: 0.9487
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1622 - acc: 0.9481
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1615 - acc: 0.9484
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1603 - acc: 0.9487
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1619 - acc: 0.9484
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1609 - acc: 0.9486
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1598 - acc: 0.9490
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1592 - acc: 0.9491
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1581 - acc: 0.9496
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1578 - acc: 0.9498
1472/1506 [============================>.] - ETA: 0s - loss: 0.1582 - acc: 0.9496
1504/1506 [============================>.] - ETA: 0s - loss: 0.1580 - acc: 0.9497
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1580 - acc: 0.9496 - val_loss: 0.2839 - val_acc: 0.9048
Epoch 6/70

  32/1506 [..............................] - ETA: 28s - loss: 0.3459 - acc: 0.8859
  64/1506 [>.............................] - ETA: 27s - loss: 0.2750 - acc: 0.9188
  96/1506 [>.............................] - ETA: 27s - loss: 0.2211 - acc: 0.9352
 128/1506 [=>............................] - ETA: 26s - loss: 0.2056 - acc: 0.9402
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1924 - acc: 0.9425
 192/1506 [==>...........................] - ETA: 25s - loss: 0.1849 - acc: 0.9450
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1776 - acc: 0.9472
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1756 - acc: 0.9462
 288/1506 [====>.........................] - ETA: 23s - loss: 0.1743 - acc: 0.9476
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1739 - acc: 0.9470
 352/1506 [======>.......................] - ETA: 22s - loss: 0.1786 - acc: 0.9458
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1724 - acc: 0.9476
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1687 - acc: 0.9488
 448/1506 [=======>......................] - ETA: 20s - loss: 0.1660 - acc: 0.9499
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1677 - acc: 0.9484
 512/1506 [=========>....................] - ETA: 19s - loss: 0.1677 - acc: 0.9485
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1658 - acc: 0.9491
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1627 - acc: 0.9500
 608/1506 [===========>..................] - ETA: 17s - loss: 0.1584 - acc: 0.9510
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1564 - acc: 0.9515
 672/1506 [============>.................] - ETA: 15s - loss: 0.1534 - acc: 0.9526
 704/1506 [=============>................] - ETA: 15s - loss: 0.1536 - acc: 0.9523
 736/1506 [=============>................] - ETA: 14s - loss: 0.1539 - acc: 0.9522
 768/1506 [==============>...............] - ETA: 14s - loss: 0.1546 - acc: 0.9519
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1533 - acc: 0.9523
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1544 - acc: 0.9515
 864/1506 [================>.............] - ETA: 12s - loss: 0.1531 - acc: 0.9521
 896/1506 [================>.............] - ETA: 11s - loss: 0.1525 - acc: 0.9522
 928/1506 [=================>............] - ETA: 11s - loss: 0.1521 - acc: 0.9522
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1510 - acc: 0.9529
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1500 - acc: 0.9532 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1487 - acc: 0.9537
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1485 - acc: 0.9539
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1498 - acc: 0.9531
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1489 - acc: 0.9534
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1480 - acc: 0.9538
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1474 - acc: 0.9541
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1474 - acc: 0.9542
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1461 - acc: 0.9547
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1463 - acc: 0.9547
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1475 - acc: 0.9543
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1470 - acc: 0.9546
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1490 - acc: 0.9540
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1486 - acc: 0.9540
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1485 - acc: 0.9538
1472/1506 [============================>.] - ETA: 0s - loss: 0.1470 - acc: 0.9543
1504/1506 [============================>.] - ETA: 0s - loss: 0.1457 - acc: 0.9546
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1456 - acc: 0.9547 - val_loss: 0.1805 - val_acc: 0.9426
Epoch 7/70

  32/1506 [..............................] - ETA: 28s - loss: 0.1618 - acc: 0.9461
  64/1506 [>.............................] - ETA: 27s - loss: 0.1370 - acc: 0.9556
  96/1506 [>.............................] - ETA: 27s - loss: 0.1338 - acc: 0.9579
 128/1506 [=>............................] - ETA: 26s - loss: 0.1323 - acc: 0.9583
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1445 - acc: 0.9584
 192/1506 [==>...........................] - ETA: 25s - loss: 0.1342 - acc: 0.9621
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1280 - acc: 0.9624
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1298 - acc: 0.9617
 288/1506 [====>.........................] - ETA: 23s - loss: 0.1280 - acc: 0.9618
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1315 - acc: 0.9605
 352/1506 [======>.......................] - ETA: 22s - loss: 0.1296 - acc: 0.9606
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1308 - acc: 0.9605
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1293 - acc: 0.9610
 448/1506 [=======>......................] - ETA: 20s - loss: 0.1296 - acc: 0.9614
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1304 - acc: 0.9605
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1288 - acc: 0.9607
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1296 - acc: 0.9598
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1318 - acc: 0.9588
 608/1506 [===========>..................] - ETA: 17s - loss: 0.1280 - acc: 0.9602
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1286 - acc: 0.9598
 672/1506 [============>.................] - ETA: 15s - loss: 0.1305 - acc: 0.9588
 704/1506 [=============>................] - ETA: 15s - loss: 0.1317 - acc: 0.9586
 736/1506 [=============>................] - ETA: 14s - loss: 0.1332 - acc: 0.9583
 768/1506 [==============>...............] - ETA: 14s - loss: 0.1313 - acc: 0.9588
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1297 - acc: 0.9594
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1288 - acc: 0.9597
 864/1506 [================>.............] - ETA: 12s - loss: 0.1287 - acc: 0.9598
 896/1506 [================>.............] - ETA: 11s - loss: 0.1290 - acc: 0.9599
 928/1506 [=================>............] - ETA: 11s - loss: 0.1300 - acc: 0.9595
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1303 - acc: 0.9593
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1304 - acc: 0.9591 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1312 - acc: 0.9589
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1304 - acc: 0.9591
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1306 - acc: 0.9589
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1304 - acc: 0.9591
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1310 - acc: 0.9590
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1315 - acc: 0.9587
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1322 - acc: 0.9585
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1307 - acc: 0.9590
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1305 - acc: 0.9592
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1297 - acc: 0.9592
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1292 - acc: 0.9592
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1283 - acc: 0.9595
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1281 - acc: 0.9596
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1274 - acc: 0.9599
1472/1506 [============================>.] - ETA: 0s - loss: 0.1274 - acc: 0.9599
1504/1506 [============================>.] - ETA: 0s - loss: 0.1280 - acc: 0.9595
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1281 - acc: 0.9595 - val_loss: 0.1698 - val_acc: 0.9486
Epoch 8/70

  32/1506 [..............................] - ETA: 28s - loss: 0.1273 - acc: 0.9619
  64/1506 [>.............................] - ETA: 27s - loss: 0.1203 - acc: 0.9623
  96/1506 [>.............................] - ETA: 26s - loss: 0.1086 - acc: 0.9679
 128/1506 [=>............................] - ETA: 26s - loss: 0.1164 - acc: 0.9641
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1293 - acc: 0.9599
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1325 - acc: 0.9580
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1276 - acc: 0.9607
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1294 - acc: 0.9609
 288/1506 [====>.........................] - ETA: 23s - loss: 0.1277 - acc: 0.9618
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1255 - acc: 0.9620
 352/1506 [======>.......................] - ETA: 22s - loss: 0.1295 - acc: 0.9608
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1313 - acc: 0.9598
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1298 - acc: 0.9605
 448/1506 [=======>......................] - ETA: 20s - loss: 0.1293 - acc: 0.9608
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1297 - acc: 0.9609
 512/1506 [=========>....................] - ETA: 19s - loss: 0.1259 - acc: 0.9623
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1261 - acc: 0.9618
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1238 - acc: 0.9620
 608/1506 [===========>..................] - ETA: 17s - loss: 0.1240 - acc: 0.9619
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1229 - acc: 0.9625
 672/1506 [============>.................] - ETA: 15s - loss: 0.1222 - acc: 0.9626
 704/1506 [=============>................] - ETA: 15s - loss: 0.1210 - acc: 0.9626
 736/1506 [=============>................] - ETA: 14s - loss: 0.1188 - acc: 0.9631
 768/1506 [==============>...............] - ETA: 14s - loss: 0.1183 - acc: 0.9633
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1213 - acc: 0.9624
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1208 - acc: 0.9627
 864/1506 [================>.............] - ETA: 12s - loss: 0.1202 - acc: 0.9627
 896/1506 [================>.............] - ETA: 11s - loss: 0.1198 - acc: 0.9626
 928/1506 [=================>............] - ETA: 11s - loss: 0.1211 - acc: 0.9622
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1204 - acc: 0.9624
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1197 - acc: 0.9628 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1203 - acc: 0.9626
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1194 - acc: 0.9629
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1196 - acc: 0.9628
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1191 - acc: 0.9629
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1192 - acc: 0.9626
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1187 - acc: 0.9629
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1188 - acc: 0.9628
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1196 - acc: 0.9626
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1196 - acc: 0.9627
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1188 - acc: 0.9629
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1192 - acc: 0.9630
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1190 - acc: 0.9631
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1188 - acc: 0.9632
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1191 - acc: 0.9632
1472/1506 [============================>.] - ETA: 0s - loss: 0.1187 - acc: 0.9634
1504/1506 [============================>.] - ETA: 0s - loss: 0.1181 - acc: 0.9635
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1182 - acc: 0.9634 - val_loss: 0.2558 - val_acc: 0.9231
Epoch 9/70

  32/1506 [..............................] - ETA: 28s - loss: 0.2389 - acc: 0.9241
  64/1506 [>.............................] - ETA: 27s - loss: 0.1727 - acc: 0.9474
  96/1506 [>.............................] - ETA: 26s - loss: 0.1525 - acc: 0.9548
 128/1506 [=>............................] - ETA: 26s - loss: 0.1416 - acc: 0.9576
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1320 - acc: 0.9610
 192/1506 [==>...........................] - ETA: 25s - loss: 0.1334 - acc: 0.9592
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1299 - acc: 0.9598
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1276 - acc: 0.9611
 288/1506 [====>.........................] - ETA: 23s - loss: 0.1281 - acc: 0.9614
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1316 - acc: 0.9591
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1328 - acc: 0.9595
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1300 - acc: 0.9596
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1311 - acc: 0.9588
 448/1506 [=======>......................] - ETA: 20s - loss: 0.1313 - acc: 0.9595
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1300 - acc: 0.9595
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1271 - acc: 0.9599
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1258 - acc: 0.9606
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1257 - acc: 0.9603
 608/1506 [===========>..................] - ETA: 17s - loss: 0.1273 - acc: 0.9597
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1265 - acc: 0.9601
 672/1506 [============>.................] - ETA: 15s - loss: 0.1248 - acc: 0.9608
 704/1506 [=============>................] - ETA: 15s - loss: 0.1222 - acc: 0.9616
 736/1506 [=============>................] - ETA: 14s - loss: 0.1229 - acc: 0.9615
 768/1506 [==============>...............] - ETA: 14s - loss: 0.1215 - acc: 0.9619
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1211 - acc: 0.9622
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1211 - acc: 0.9625
 864/1506 [================>.............] - ETA: 12s - loss: 0.1205 - acc: 0.9625
 896/1506 [================>.............] - ETA: 11s - loss: 0.1185 - acc: 0.9633
 928/1506 [=================>............] - ETA: 11s - loss: 0.1185 - acc: 0.9637
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1177 - acc: 0.9639
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1167 - acc: 0.9643 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1161 - acc: 0.9644
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1158 - acc: 0.9645
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1157 - acc: 0.9645
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1171 - acc: 0.9645
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1161 - acc: 0.9648
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1157 - acc: 0.9648
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1149 - acc: 0.9650
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1136 - acc: 0.9655
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1135 - acc: 0.9654
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1136 - acc: 0.9654
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1139 - acc: 0.9654
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1147 - acc: 0.9649
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1151 - acc: 0.9647
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1151 - acc: 0.9645
1472/1506 [============================>.] - ETA: 0s - loss: 0.1154 - acc: 0.9645
1504/1506 [============================>.] - ETA: 0s - loss: 0.1155 - acc: 0.9644
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1154 - acc: 0.9644 - val_loss: 0.1536 - val_acc: 0.9498
Epoch 10/70

  32/1506 [..............................] - ETA: 27s - loss: 0.1140 - acc: 0.9635
  64/1506 [>.............................] - ETA: 27s - loss: 0.1222 - acc: 0.9659
  96/1506 [>.............................] - ETA: 26s - loss: 0.1164 - acc: 0.9660
 128/1506 [=>............................] - ETA: 26s - loss: 0.1180 - acc: 0.9628
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1144 - acc: 0.9647
 192/1506 [==>...........................] - ETA: 25s - loss: 0.1046 - acc: 0.9676
 224/1506 [===>..........................] - ETA: 24s - loss: 0.0997 - acc: 0.9693
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1027 - acc: 0.9668
 288/1506 [====>.........................] - ETA: 23s - loss: 0.1052 - acc: 0.9662
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1047 - acc: 0.9669
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1057 - acc: 0.9670
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1024 - acc: 0.9684
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1052 - acc: 0.9675
 448/1506 [=======>......................] - ETA: 20s - loss: 0.1085 - acc: 0.9669
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1085 - acc: 0.9670
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1088 - acc: 0.9664
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1085 - acc: 0.9668
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1067 - acc: 0.9674
 608/1506 [===========>..................] - ETA: 17s - loss: 0.1065 - acc: 0.9676
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1093 - acc: 0.9663
 672/1506 [============>.................] - ETA: 15s - loss: 0.1078 - acc: 0.9666
 704/1506 [=============>................] - ETA: 15s - loss: 0.1096 - acc: 0.9656
 736/1506 [=============>................] - ETA: 14s - loss: 0.1089 - acc: 0.9660
 768/1506 [==============>...............] - ETA: 14s - loss: 0.1074 - acc: 0.9666
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1080 - acc: 0.9662
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1079 - acc: 0.9661
 864/1506 [================>.............] - ETA: 12s - loss: 0.1080 - acc: 0.9661
 896/1506 [================>.............] - ETA: 11s - loss: 0.1075 - acc: 0.9664
 928/1506 [=================>............] - ETA: 11s - loss: 0.1065 - acc: 0.9665
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1060 - acc: 0.9669
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1057 - acc: 0.9669 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1063 - acc: 0.9666
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1065 - acc: 0.9665
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1061 - acc: 0.9664
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1058 - acc: 0.9663
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1054 - acc: 0.9664
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1051 - acc: 0.9666
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1054 - acc: 0.9663
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1040 - acc: 0.9667
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1030 - acc: 0.9669
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1042 - acc: 0.9668
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1035 - acc: 0.9671
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1035 - acc: 0.9670
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1038 - acc: 0.9672
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1039 - acc: 0.9672
1472/1506 [============================>.] - ETA: 0s - loss: 0.1032 - acc: 0.9674
1504/1506 [============================>.] - ETA: 0s - loss: 0.1033 - acc: 0.9672
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1032 - acc: 0.9673 - val_loss: 0.1478 - val_acc: 0.9513
Epoch 11/70

  32/1506 [..............................] - ETA: 27s - loss: 0.0688 - acc: 0.9809
  64/1506 [>.............................] - ETA: 27s - loss: 0.0804 - acc: 0.9738
  96/1506 [>.............................] - ETA: 26s - loss: 0.0819 - acc: 0.9752
 128/1506 [=>............................] - ETA: 26s - loss: 0.0815 - acc: 0.9744
 160/1506 [==>...........................] - ETA: 25s - loss: 0.0867 - acc: 0.9734
 192/1506 [==>...........................] - ETA: 25s - loss: 0.0928 - acc: 0.9704
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1010 - acc: 0.9685
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1042 - acc: 0.9668
 288/1506 [====>.........................] - ETA: 23s - loss: 0.0988 - acc: 0.9690
 320/1506 [=====>........................] - ETA: 22s - loss: 0.0976 - acc: 0.9703
 352/1506 [======>.......................] - ETA: 21s - loss: 0.0951 - acc: 0.9704
 384/1506 [======>.......................] - ETA: 21s - loss: 0.0939 - acc: 0.9706
 416/1506 [=======>......................] - ETA: 20s - loss: 0.0921 - acc: 0.9714
 448/1506 [=======>......................] - ETA: 20s - loss: 0.0941 - acc: 0.9703
 480/1506 [========>.....................] - ETA: 19s - loss: 0.0940 - acc: 0.9706
 512/1506 [=========>....................] - ETA: 18s - loss: 0.0936 - acc: 0.9710
 544/1506 [=========>....................] - ETA: 18s - loss: 0.0958 - acc: 0.9701
 576/1506 [==========>...................] - ETA: 17s - loss: 0.0947 - acc: 0.9705
 608/1506 [===========>..................] - ETA: 17s - loss: 0.0939 - acc: 0.9709
 640/1506 [===========>..................] - ETA: 16s - loss: 0.0946 - acc: 0.9705
 672/1506 [============>.................] - ETA: 15s - loss: 0.0941 - acc: 0.9707
 704/1506 [=============>................] - ETA: 15s - loss: 0.0942 - acc: 0.9706
 736/1506 [=============>................] - ETA: 14s - loss: 0.0924 - acc: 0.9713
 768/1506 [==============>...............] - ETA: 14s - loss: 0.0918 - acc: 0.9715
 800/1506 [==============>...............] - ETA: 13s - loss: 0.0933 - acc: 0.9706
 832/1506 [===============>..............] - ETA: 12s - loss: 0.0923 - acc: 0.9710
 864/1506 [================>.............] - ETA: 12s - loss: 0.0924 - acc: 0.9709
 896/1506 [================>.............] - ETA: 11s - loss: 0.0932 - acc: 0.9706
 928/1506 [=================>............] - ETA: 11s - loss: 0.0936 - acc: 0.9708
 960/1506 [==================>...........] - ETA: 10s - loss: 0.0944 - acc: 0.9705
 992/1506 [==================>...........] - ETA: 9s - loss: 0.0932 - acc: 0.9709 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.0938 - acc: 0.9707
1056/1506 [====================>.........] - ETA: 8s - loss: 0.0932 - acc: 0.9709
1088/1506 [====================>.........] - ETA: 7s - loss: 0.0934 - acc: 0.9706
1120/1506 [=====================>........] - ETA: 7s - loss: 0.0933 - acc: 0.9706
1152/1506 [=====================>........] - ETA: 6s - loss: 0.0935 - acc: 0.9708
1184/1506 [======================>.......] - ETA: 6s - loss: 0.0933 - acc: 0.9709
1216/1506 [=======================>......] - ETA: 5s - loss: 0.0929 - acc: 0.9713
1248/1506 [=======================>......] - ETA: 4s - loss: 0.0933 - acc: 0.9714
1280/1506 [========================>.....] - ETA: 4s - loss: 0.0938 - acc: 0.9713
1312/1506 [=========================>....] - ETA: 3s - loss: 0.0952 - acc: 0.9708
1344/1506 [=========================>....] - ETA: 3s - loss: 0.0945 - acc: 0.9710
1376/1506 [==========================>...] - ETA: 2s - loss: 0.0941 - acc: 0.9710
1408/1506 [===========================>..] - ETA: 1s - loss: 0.0947 - acc: 0.9707
1440/1506 [===========================>..] - ETA: 1s - loss: 0.0945 - acc: 0.9706
1472/1506 [============================>.] - ETA: 0s - loss: 0.0950 - acc: 0.9704
1504/1506 [============================>.] - ETA: 0s - loss: 0.0949 - acc: 0.9703
1506/1506 [==============================] - 30s 20ms/step - loss: 0.0951 - acc: 0.9702 - val_loss: 0.2499 - val_acc: 0.9318
Epoch 12/70

  32/1506 [..............................] - ETA: 27s - loss: 0.1897 - acc: 0.9398
  64/1506 [>.............................] - ETA: 27s - loss: 0.1446 - acc: 0.9555
  96/1506 [>.............................] - ETA: 26s - loss: 0.1344 - acc: 0.9558
 128/1506 [=>............................] - ETA: 26s - loss: 0.1270 - acc: 0.9602
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1182 - acc: 0.9642
 192/1506 [==>...........................] - ETA: 25s - loss: 0.1125 - acc: 0.9657
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1143 - acc: 0.9649
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1120 - acc: 0.9657
 288/1506 [====>.........................] - ETA: 23s - loss: 0.1066 - acc: 0.9670
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1035 - acc: 0.9678
 352/1506 [======>.......................] - ETA: 22s - loss: 0.1010 - acc: 0.9684
 384/1506 [======>.......................] - ETA: 21s - loss: 0.0974 - acc: 0.9695
 416/1506 [=======>......................] - ETA: 20s - loss: 0.0949 - acc: 0.9701
 448/1506 [=======>......................] - ETA: 20s - loss: 0.0952 - acc: 0.9698
 480/1506 [========>.....................] - ETA: 19s - loss: 0.0975 - acc: 0.9688
 512/1506 [=========>....................] - ETA: 18s - loss: 0.0936 - acc: 0.9701
 544/1506 [=========>....................] - ETA: 18s - loss: 0.0905 - acc: 0.9709
 576/1506 [==========>...................] - ETA: 17s - loss: 0.0908 - acc: 0.9705
 608/1506 [===========>..................] - ETA: 17s - loss: 0.0924 - acc: 0.9696
 640/1506 [===========>..................] - ETA: 16s - loss: 0.0940 - acc: 0.9690
 672/1506 [============>.................] - ETA: 15s - loss: 0.0955 - acc: 0.9684
 704/1506 [=============>................] - ETA: 15s - loss: 0.0948 - acc: 0.9686
 736/1506 [=============>................] - ETA: 14s - loss: 0.0960 - acc: 0.9683
 768/1506 [==============>...............] - ETA: 14s - loss: 0.0942 - acc: 0.9691
 800/1506 [==============>...............] - ETA: 13s - loss: 0.0957 - acc: 0.9685
 832/1506 [===============>..............] - ETA: 12s - loss: 0.0952 - acc: 0.9688
 864/1506 [================>.............] - ETA: 12s - loss: 0.0948 - acc: 0.9689
 896/1506 [================>.............] - ETA: 11s - loss: 0.0958 - acc: 0.9687
 928/1506 [=================>............] - ETA: 11s - loss: 0.0956 - acc: 0.9691
 960/1506 [==================>...........] - ETA: 10s - loss: 0.0953 - acc: 0.9691
 992/1506 [==================>...........] - ETA: 9s - loss: 0.0951 - acc: 0.9694 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.0947 - acc: 0.9696
1056/1506 [====================>.........] - ETA: 8s - loss: 0.0941 - acc: 0.9699
1088/1506 [====================>.........] - ETA: 7s - loss: 0.0943 - acc: 0.9698
1120/1506 [=====================>........] - ETA: 7s - loss: 0.0939 - acc: 0.9700
1152/1506 [=====================>........] - ETA: 6s - loss: 0.0952 - acc: 0.9699
1184/1506 [======================>.......] - ETA: 6s - loss: 0.0951 - acc: 0.9700
1216/1506 [=======================>......] - ETA: 5s - loss: 0.0945 - acc: 0.9702
1248/1506 [=======================>......] - ETA: 4s - loss: 0.0941 - acc: 0.9702
1280/1506 [========================>.....] - ETA: 4s - loss: 0.0932 - acc: 0.9706
1312/1506 [=========================>....] - ETA: 3s - loss: 0.0953 - acc: 0.9701
1344/1506 [=========================>....] - ETA: 3s - loss: 0.0949 - acc: 0.9702
1376/1506 [==========================>...] - ETA: 2s - loss: 0.0949 - acc: 0.9703
1408/1506 [===========================>..] - ETA: 1s - loss: 0.0942 - acc: 0.9705
1440/1506 [===========================>..] - ETA: 1s - loss: 0.0947 - acc: 0.9705
1472/1506 [============================>.] - ETA: 0s - loss: 0.0945 - acc: 0.9706
1504/1506 [============================>.] - ETA: 0s - loss: 0.0941 - acc: 0.9706
1506/1506 [==============================] - 30s 20ms/step - loss: 0.0942 - acc: 0.9706 - val_loss: 0.3524 - val_acc: 0.8901
Computing...
Manual evaluation: (didn't understand why I made this)
True 7673
False 1398
True percentage 0.845882482637
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.94      0.96      7318
      B-PER       0.95      0.59      0.73       438
      B-LOC       0.83      0.39      0.53       218
      B-ORG       0.84      0.16      0.26       296
      I-PER       0.93      0.53      0.67       214
     B-MISC       0.15      0.72      0.24       141
     I-MISC       0.25      0.78      0.38       154
      I-LOC       0.82      0.53      0.64       141
      I-ORG       0.71      0.11      0.19       151

avg / total       0.95      0.85      0.87      9071

F-1 Score:
0.456798348615
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 1674 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 237
OOV word occurences: 324
Padding...
Data padded!
Padding...
Data padded!
Padded until 83 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,992,194
Trainable params: 6,992,194
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1506 samples, validate on 168 samples
Epoch 1/70

  32/1506 [..............................] - ETA: 2:09 - loss: 2.3833 - acc: 0.0171
  64/1506 [>.............................] - ETA: 1:17 - loss: 1.6434 - acc: 0.4161
  96/1506 [>.............................] - ETA: 1:00 - loss: 1.7464 - acc: 0.5600
 128/1506 [=>............................] - ETA: 50s - loss: 1.5491 - acc: 0.6251 
 160/1506 [==>...........................] - ETA: 45s - loss: 1.4548 - acc: 0.6556
 192/1506 [==>...........................] - ETA: 40s - loss: 1.3583 - acc: 0.6795
 224/1506 [===>..........................] - ETA: 37s - loss: 1.2524 - acc: 0.7028
 256/1506 [====>.........................] - ETA: 35s - loss: 1.1899 - acc: 0.7145
 288/1506 [====>.........................] - ETA: 33s - loss: 1.1362 - acc: 0.7243
 320/1506 [=====>........................] - ETA: 31s - loss: 1.0841 - acc: 0.7345
 352/1506 [======>.......................] - ETA: 30s - loss: 1.0394 - acc: 0.7440
 384/1506 [======>.......................] - ETA: 28s - loss: 1.0106 - acc: 0.7484
 416/1506 [=======>......................] - ETA: 27s - loss: 0.9798 - acc: 0.7531
 448/1506 [=======>......................] - ETA: 26s - loss: 0.9564 - acc: 0.7573
 480/1506 [========>.....................] - ETA: 25s - loss: 0.9254 - acc: 0.7643
 512/1506 [=========>....................] - ETA: 24s - loss: 0.9026 - acc: 0.7682
 544/1506 [=========>....................] - ETA: 23s - loss: 0.8860 - acc: 0.7711
 576/1506 [==========>...................] - ETA: 22s - loss: 0.8635 - acc: 0.7757
 608/1506 [===========>..................] - ETA: 21s - loss: 0.8447 - acc: 0.7793
 640/1506 [===========>..................] - ETA: 20s - loss: 0.8290 - acc: 0.7817
 672/1506 [============>.................] - ETA: 19s - loss: 0.8131 - acc: 0.7863
 704/1506 [=============>................] - ETA: 18s - loss: 0.7960 - acc: 0.7895
 736/1506 [=============>................] - ETA: 17s - loss: 0.7812 - acc: 0.7934
 768/1506 [==============>...............] - ETA: 16s - loss: 0.7711 - acc: 0.7948
 800/1506 [==============>...............] - ETA: 15s - loss: 0.7565 - acc: 0.7981
 832/1506 [===============>..............] - ETA: 15s - loss: 0.7444 - acc: 0.7998
 864/1506 [================>.............] - ETA: 14s - loss: 0.7334 - acc: 0.8025
 896/1506 [================>.............] - ETA: 13s - loss: 0.7205 - acc: 0.8053
 928/1506 [=================>............] - ETA: 12s - loss: 0.7147 - acc: 0.8063
 960/1506 [==================>...........] - ETA: 11s - loss: 0.7046 - acc: 0.8081
 992/1506 [==================>...........] - ETA: 11s - loss: 0.6956 - acc: 0.8106
1024/1506 [===================>..........] - ETA: 10s - loss: 0.6870 - acc: 0.8132
1056/1506 [====================>.........] - ETA: 9s - loss: 0.6782 - acc: 0.8148 
1088/1506 [====================>.........] - ETA: 9s - loss: 0.6693 - acc: 0.8166
1120/1506 [=====================>........] - ETA: 8s - loss: 0.6573 - acc: 0.8198
1152/1506 [=====================>........] - ETA: 7s - loss: 0.6495 - acc: 0.8213
1184/1506 [======================>.......] - ETA: 6s - loss: 0.6436 - acc: 0.8225
1216/1506 [=======================>......] - ETA: 6s - loss: 0.6345 - acc: 0.8248
1248/1506 [=======================>......] - ETA: 5s - loss: 0.6278 - acc: 0.8262
1280/1506 [========================>.....] - ETA: 4s - loss: 0.6206 - acc: 0.8282
1312/1506 [=========================>....] - ETA: 4s - loss: 0.6138 - acc: 0.8299
1344/1506 [=========================>....] - ETA: 3s - loss: 0.6069 - acc: 0.8313
1376/1506 [==========================>...] - ETA: 2s - loss: 0.5996 - acc: 0.8333
1408/1506 [===========================>..] - ETA: 2s - loss: 0.5959 - acc: 0.8340
1440/1506 [===========================>..] - ETA: 1s - loss: 0.5919 - acc: 0.8356
1472/1506 [============================>.] - ETA: 0s - loss: 0.5849 - acc: 0.8375
1504/1506 [============================>.] - ETA: 0s - loss: 0.5804 - acc: 0.8385
1506/1506 [==============================] - 33s 22ms/step - loss: 0.5799 - acc: 0.8386 - val_loss: 0.3153 - val_acc: 0.9030
Epoch 2/70

  32/1506 [..............................] - ETA: 28s - loss: 0.2603 - acc: 0.9177
  64/1506 [>.............................] - ETA: 27s - loss: 0.2653 - acc: 0.9142
  96/1506 [>.............................] - ETA: 26s - loss: 0.2939 - acc: 0.9073
 128/1506 [=>............................] - ETA: 25s - loss: 0.2853 - acc: 0.9121
 160/1506 [==>...........................] - ETA: 25s - loss: 0.2806 - acc: 0.9125
 192/1506 [==>...........................] - ETA: 24s - loss: 0.2837 - acc: 0.9110
 224/1506 [===>..........................] - ETA: 24s - loss: 0.2726 - acc: 0.9164
 256/1506 [====>.........................] - ETA: 23s - loss: 0.2742 - acc: 0.9161
 288/1506 [====>.........................] - ETA: 23s - loss: 0.2742 - acc: 0.9157
 320/1506 [=====>........................] - ETA: 22s - loss: 0.2726 - acc: 0.9151
 352/1506 [======>.......................] - ETA: 21s - loss: 0.2796 - acc: 0.9120
 384/1506 [======>.......................] - ETA: 21s - loss: 0.2849 - acc: 0.9108
 416/1506 [=======>......................] - ETA: 20s - loss: 0.2810 - acc: 0.9124
 448/1506 [=======>......................] - ETA: 20s - loss: 0.2772 - acc: 0.9143
 480/1506 [========>.....................] - ETA: 19s - loss: 0.2768 - acc: 0.9138
 512/1506 [=========>....................] - ETA: 18s - loss: 0.2774 - acc: 0.9136
 544/1506 [=========>....................] - ETA: 18s - loss: 0.2733 - acc: 0.9155
 576/1506 [==========>...................] - ETA: 17s - loss: 0.2735 - acc: 0.9151
 608/1506 [===========>..................] - ETA: 17s - loss: 0.2749 - acc: 0.9133
 640/1506 [===========>..................] - ETA: 16s - loss: 0.2734 - acc: 0.9137
 672/1506 [============>.................] - ETA: 15s - loss: 0.2740 - acc: 0.9141
 704/1506 [=============>................] - ETA: 15s - loss: 0.2767 - acc: 0.9130
 736/1506 [=============>................] - ETA: 14s - loss: 0.2758 - acc: 0.9129
 768/1506 [==============>...............] - ETA: 14s - loss: 0.2743 - acc: 0.9128
 800/1506 [==============>...............] - ETA: 13s - loss: 0.2701 - acc: 0.9141
 832/1506 [===============>..............] - ETA: 12s - loss: 0.2707 - acc: 0.9139
 864/1506 [================>.............] - ETA: 12s - loss: 0.2702 - acc: 0.9140
 896/1506 [================>.............] - ETA: 11s - loss: 0.2702 - acc: 0.9138
 928/1506 [=================>............] - ETA: 11s - loss: 0.2701 - acc: 0.9136
 960/1506 [==================>...........] - ETA: 10s - loss: 0.2696 - acc: 0.9134
 992/1506 [==================>...........] - ETA: 9s - loss: 0.2684 - acc: 0.9142 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.2667 - acc: 0.9143
1056/1506 [====================>.........] - ETA: 8s - loss: 0.2638 - acc: 0.9154
1088/1506 [====================>.........] - ETA: 7s - loss: 0.2637 - acc: 0.9154
1120/1506 [=====================>........] - ETA: 7s - loss: 0.2615 - acc: 0.9159
1152/1506 [=====================>........] - ETA: 6s - loss: 0.2600 - acc: 0.9167
1184/1506 [======================>.......] - ETA: 6s - loss: 0.2591 - acc: 0.9170
1216/1506 [=======================>......] - ETA: 5s - loss: 0.2589 - acc: 0.9172
1248/1506 [=======================>......] - ETA: 4s - loss: 0.2599 - acc: 0.9172
1280/1506 [========================>.....] - ETA: 4s - loss: 0.2587 - acc: 0.9176
1312/1506 [=========================>....] - ETA: 3s - loss: 0.2589 - acc: 0.9175
1344/1506 [=========================>....] - ETA: 3s - loss: 0.2587 - acc: 0.9173
1376/1506 [==========================>...] - ETA: 2s - loss: 0.2578 - acc: 0.9173
1408/1506 [===========================>..] - ETA: 1s - loss: 0.2581 - acc: 0.9175
1440/1506 [===========================>..] - ETA: 1s - loss: 0.2578 - acc: 0.9175
1472/1506 [============================>.] - ETA: 0s - loss: 0.2567 - acc: 0.9177
1504/1506 [============================>.] - ETA: 0s - loss: 0.2554 - acc: 0.9183
1506/1506 [==============================] - 30s 20ms/step - loss: 0.2552 - acc: 0.9184 - val_loss: 0.2599 - val_acc: 0.9206
Epoch 3/70

  32/1506 [..............................] - ETA: 27s - loss: 0.2063 - acc: 0.9297
  64/1506 [>.............................] - ETA: 26s - loss: 0.2010 - acc: 0.9349
  96/1506 [>.............................] - ETA: 26s - loss: 0.2040 - acc: 0.9338
 128/1506 [=>............................] - ETA: 25s - loss: 0.2069 - acc: 0.9335
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1985 - acc: 0.9367
 192/1506 [==>...........................] - ETA: 24s - loss: 0.2005 - acc: 0.9352
 224/1506 [===>..........................] - ETA: 24s - loss: 0.2000 - acc: 0.9364
 256/1506 [====>.........................] - ETA: 23s - loss: 0.2018 - acc: 0.9364
 288/1506 [====>.........................] - ETA: 22s - loss: 0.2047 - acc: 0.9336
 320/1506 [=====>........................] - ETA: 22s - loss: 0.2064 - acc: 0.9329
 352/1506 [======>.......................] - ETA: 21s - loss: 0.2046 - acc: 0.9334
 384/1506 [======>.......................] - ETA: 21s - loss: 0.2078 - acc: 0.9325
 416/1506 [=======>......................] - ETA: 20s - loss: 0.2091 - acc: 0.9327
 448/1506 [=======>......................] - ETA: 19s - loss: 0.2074 - acc: 0.9333
 480/1506 [========>.....................] - ETA: 19s - loss: 0.2076 - acc: 0.9332
 512/1506 [=========>....................] - ETA: 18s - loss: 0.2056 - acc: 0.9335
 544/1506 [=========>....................] - ETA: 18s - loss: 0.2044 - acc: 0.9339
 576/1506 [==========>...................] - ETA: 17s - loss: 0.2062 - acc: 0.9333
 608/1506 [===========>..................] - ETA: 16s - loss: 0.2048 - acc: 0.9341
 640/1506 [===========>..................] - ETA: 16s - loss: 0.2032 - acc: 0.9347
 672/1506 [============>.................] - ETA: 15s - loss: 0.2072 - acc: 0.9339
 704/1506 [=============>................] - ETA: 15s - loss: 0.2069 - acc: 0.9343
 736/1506 [=============>................] - ETA: 14s - loss: 0.2034 - acc: 0.9354
 768/1506 [==============>...............] - ETA: 13s - loss: 0.2020 - acc: 0.9357
 800/1506 [==============>...............] - ETA: 13s - loss: 0.2010 - acc: 0.9360
 832/1506 [===============>..............] - ETA: 12s - loss: 0.2018 - acc: 0.9357
 864/1506 [================>.............] - ETA: 12s - loss: 0.1996 - acc: 0.9362
 896/1506 [================>.............] - ETA: 11s - loss: 0.2021 - acc: 0.9354
 928/1506 [=================>............] - ETA: 10s - loss: 0.2023 - acc: 0.9351
 960/1506 [==================>...........] - ETA: 10s - loss: 0.2023 - acc: 0.9347
 992/1506 [==================>...........] - ETA: 9s - loss: 0.2037 - acc: 0.9346 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.2027 - acc: 0.9349
1056/1506 [====================>.........] - ETA: 8s - loss: 0.2032 - acc: 0.9346
1088/1506 [====================>.........] - ETA: 7s - loss: 0.2036 - acc: 0.9347
1120/1506 [=====================>........] - ETA: 7s - loss: 0.2044 - acc: 0.9347
1152/1506 [=====================>........] - ETA: 6s - loss: 0.2042 - acc: 0.9350
1184/1506 [======================>.......] - ETA: 6s - loss: 0.2035 - acc: 0.9351
1216/1506 [=======================>......] - ETA: 5s - loss: 0.2016 - acc: 0.9356
1248/1506 [=======================>......] - ETA: 4s - loss: 0.2009 - acc: 0.9357
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1994 - acc: 0.9363
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1992 - acc: 0.9364
1344/1506 [=========================>....] - ETA: 3s - loss: 0.2006 - acc: 0.9359
1376/1506 [==========================>...] - ETA: 2s - loss: 0.2032 - acc: 0.9353
1408/1506 [===========================>..] - ETA: 1s - loss: 0.2022 - acc: 0.9355
1440/1506 [===========================>..] - ETA: 1s - loss: 0.2016 - acc: 0.9359
1472/1506 [============================>.] - ETA: 0s - loss: 0.2042 - acc: 0.9354
1504/1506 [============================>.] - ETA: 0s - loss: 0.2039 - acc: 0.9354
1506/1506 [==============================] - 30s 20ms/step - loss: 0.2037 - acc: 0.9355 - val_loss: 0.2213 - val_acc: 0.9317
Epoch 4/70

  32/1506 [..............................] - ETA: 28s - loss: 0.1608 - acc: 0.9468
  64/1506 [>.............................] - ETA: 27s - loss: 0.1897 - acc: 0.9322
  96/1506 [>.............................] - ETA: 27s - loss: 0.1928 - acc: 0.9323
 128/1506 [=>............................] - ETA: 26s - loss: 0.1760 - acc: 0.9406
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1722 - acc: 0.9428
 192/1506 [==>...........................] - ETA: 25s - loss: 0.1675 - acc: 0.9455
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1727 - acc: 0.9441
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1735 - acc: 0.9435
 288/1506 [====>.........................] - ETA: 23s - loss: 0.1744 - acc: 0.9431
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1736 - acc: 0.9437
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1703 - acc: 0.9440
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1690 - acc: 0.9452
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1727 - acc: 0.9439
 448/1506 [=======>......................] - ETA: 20s - loss: 0.1720 - acc: 0.9439
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1715 - acc: 0.9439
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1716 - acc: 0.9436
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1700 - acc: 0.9436
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1718 - acc: 0.9433
 608/1506 [===========>..................] - ETA: 17s - loss: 0.1724 - acc: 0.9435
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1738 - acc: 0.9431
 672/1506 [============>.................] - ETA: 15s - loss: 0.1718 - acc: 0.9441
 704/1506 [=============>................] - ETA: 15s - loss: 0.1712 - acc: 0.9443
 736/1506 [=============>................] - ETA: 14s - loss: 0.1705 - acc: 0.9450
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1717 - acc: 0.9450
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1717 - acc: 0.9449
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1715 - acc: 0.9456
 864/1506 [================>.............] - ETA: 12s - loss: 0.1737 - acc: 0.9449
 896/1506 [================>.............] - ETA: 11s - loss: 0.1732 - acc: 0.9455
 928/1506 [=================>............] - ETA: 10s - loss: 0.1719 - acc: 0.9457
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1706 - acc: 0.9459
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1701 - acc: 0.9461 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1701 - acc: 0.9462
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1703 - acc: 0.9462
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1691 - acc: 0.9464
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1683 - acc: 0.9467
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1687 - acc: 0.9467
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1697 - acc: 0.9466
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1682 - acc: 0.9473
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1703 - acc: 0.9464
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1707 - acc: 0.9464
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1700 - acc: 0.9467
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1690 - acc: 0.9470
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1703 - acc: 0.9466
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1697 - acc: 0.9469
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1713 - acc: 0.9462
1472/1506 [============================>.] - ETA: 0s - loss: 0.1708 - acc: 0.9462
1504/1506 [============================>.] - ETA: 0s - loss: 0.1710 - acc: 0.9460
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1708 - acc: 0.9461 - val_loss: 0.2143 - val_acc: 0.9363
Epoch 5/70

  32/1506 [..............................] - ETA: 27s - loss: 0.1491 - acc: 0.9433
  64/1506 [>.............................] - ETA: 27s - loss: 0.1507 - acc: 0.9503
  96/1506 [>.............................] - ETA: 26s - loss: 0.1472 - acc: 0.9527
 128/1506 [=>............................] - ETA: 26s - loss: 0.1395 - acc: 0.9560
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1374 - acc: 0.9566
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1436 - acc: 0.9543
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1433 - acc: 0.9533
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1389 - acc: 0.9555
 288/1506 [====>.........................] - ETA: 22s - loss: 0.1406 - acc: 0.9545
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1418 - acc: 0.9543
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1401 - acc: 0.9548
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1376 - acc: 0.9558
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1441 - acc: 0.9533
 448/1506 [=======>......................] - ETA: 20s - loss: 0.1456 - acc: 0.9534
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1459 - acc: 0.9535
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1469 - acc: 0.9529
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1452 - acc: 0.9539
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1446 - acc: 0.9544
 608/1506 [===========>..................] - ETA: 16s - loss: 0.1458 - acc: 0.9542
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1442 - acc: 0.9549
 672/1506 [============>.................] - ETA: 15s - loss: 0.1458 - acc: 0.9545
 704/1506 [=============>................] - ETA: 15s - loss: 0.1461 - acc: 0.9539
 736/1506 [=============>................] - ETA: 14s - loss: 0.1461 - acc: 0.9541
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1486 - acc: 0.9532
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1482 - acc: 0.9535
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1471 - acc: 0.9541
 864/1506 [================>.............] - ETA: 12s - loss: 0.1453 - acc: 0.9544
 896/1506 [================>.............] - ETA: 11s - loss: 0.1480 - acc: 0.9535
 928/1506 [=================>............] - ETA: 10s - loss: 0.1487 - acc: 0.9532
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1509 - acc: 0.9526
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1514 - acc: 0.9525 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1519 - acc: 0.9521
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1537 - acc: 0.9515
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1523 - acc: 0.9518
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1526 - acc: 0.9518
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1527 - acc: 0.9517
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1544 - acc: 0.9512
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1552 - acc: 0.9509
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1543 - acc: 0.9511
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1540 - acc: 0.9515
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1525 - acc: 0.9519
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1514 - acc: 0.9525
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1504 - acc: 0.9527
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1517 - acc: 0.9522
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1512 - acc: 0.9523
1472/1506 [============================>.] - ETA: 0s - loss: 0.1526 - acc: 0.9519
1504/1506 [============================>.] - ETA: 0s - loss: 0.1531 - acc: 0.9516
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1531 - acc: 0.9517 - val_loss: 0.1941 - val_acc: 0.9400
Epoch 6/70

  32/1506 [..............................] - ETA: 27s - loss: 0.1883 - acc: 0.9435
  64/1506 [>.............................] - ETA: 26s - loss: 0.1659 - acc: 0.9495
  96/1506 [>.............................] - ETA: 26s - loss: 0.1770 - acc: 0.9483
 128/1506 [=>............................] - ETA: 25s - loss: 0.1658 - acc: 0.9501
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1527 - acc: 0.9545
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1498 - acc: 0.9554
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1471 - acc: 0.9563
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1453 - acc: 0.9568
 288/1506 [====>.........................] - ETA: 22s - loss: 0.1451 - acc: 0.9567
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1485 - acc: 0.9544
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1515 - acc: 0.9543
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1498 - acc: 0.9545
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1464 - acc: 0.9560
 448/1506 [=======>......................] - ETA: 19s - loss: 0.1501 - acc: 0.9546
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1472 - acc: 0.9556
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1467 - acc: 0.9553
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1452 - acc: 0.9561
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1463 - acc: 0.9553
 608/1506 [===========>..................] - ETA: 16s - loss: 0.1462 - acc: 0.9559
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1461 - acc: 0.9562
 672/1506 [============>.................] - ETA: 15s - loss: 0.1446 - acc: 0.9567
 704/1506 [=============>................] - ETA: 15s - loss: 0.1436 - acc: 0.9573
 736/1506 [=============>................] - ETA: 14s - loss: 0.1426 - acc: 0.9574
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1422 - acc: 0.9572
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1422 - acc: 0.9569
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1427 - acc: 0.9568
 864/1506 [================>.............] - ETA: 12s - loss: 0.1433 - acc: 0.9565
 896/1506 [================>.............] - ETA: 11s - loss: 0.1456 - acc: 0.9561
 928/1506 [=================>............] - ETA: 10s - loss: 0.1439 - acc: 0.9569
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1447 - acc: 0.9564
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1431 - acc: 0.9570 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1437 - acc: 0.9567
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1439 - acc: 0.9565
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1429 - acc: 0.9571
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1422 - acc: 0.9573
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1422 - acc: 0.9570
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1410 - acc: 0.9574
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1416 - acc: 0.9573
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1402 - acc: 0.9577
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1406 - acc: 0.9575
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1405 - acc: 0.9574
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1405 - acc: 0.9572
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1399 - acc: 0.9575
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1389 - acc: 0.9577
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1388 - acc: 0.9577
1472/1506 [============================>.] - ETA: 0s - loss: 0.1400 - acc: 0.9576
1504/1506 [============================>.] - ETA: 0s - loss: 0.1394 - acc: 0.9577
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1392 - acc: 0.9577 - val_loss: 0.1806 - val_acc: 0.9463
Epoch 7/70

  32/1506 [..............................] - ETA: 27s - loss: 0.0985 - acc: 0.9745
  64/1506 [>.............................] - ETA: 27s - loss: 0.1075 - acc: 0.9689
  96/1506 [>.............................] - ETA: 26s - loss: 0.1093 - acc: 0.9701
 128/1506 [=>............................] - ETA: 26s - loss: 0.1055 - acc: 0.9712
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1088 - acc: 0.9693
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1116 - acc: 0.9665
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1147 - acc: 0.9655
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1157 - acc: 0.9648
 288/1506 [====>.........................] - ETA: 23s - loss: 0.1187 - acc: 0.9637
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1175 - acc: 0.9644
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1162 - acc: 0.9653
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1160 - acc: 0.9651
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1152 - acc: 0.9659
 448/1506 [=======>......................] - ETA: 20s - loss: 0.1168 - acc: 0.9654
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1180 - acc: 0.9646
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1195 - acc: 0.9633
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1207 - acc: 0.9632
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1230 - acc: 0.9624
 608/1506 [===========>..................] - ETA: 17s - loss: 0.1234 - acc: 0.9624
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1259 - acc: 0.9617
 672/1506 [============>.................] - ETA: 15s - loss: 0.1261 - acc: 0.9617
 704/1506 [=============>................] - ETA: 15s - loss: 0.1280 - acc: 0.9612
 736/1506 [=============>................] - ETA: 14s - loss: 0.1270 - acc: 0.9615
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1273 - acc: 0.9613
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1269 - acc: 0.9611
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1282 - acc: 0.9608
 864/1506 [================>.............] - ETA: 12s - loss: 0.1295 - acc: 0.9605
 896/1506 [================>.............] - ETA: 11s - loss: 0.1291 - acc: 0.9604
 928/1506 [=================>............] - ETA: 10s - loss: 0.1283 - acc: 0.9607
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1285 - acc: 0.9603
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1290 - acc: 0.9604 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1292 - acc: 0.9604
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1291 - acc: 0.9602
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1280 - acc: 0.9607
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1274 - acc: 0.9610
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1270 - acc: 0.9611
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1276 - acc: 0.9609
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1276 - acc: 0.9608
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1275 - acc: 0.9610
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1260 - acc: 0.9615
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1254 - acc: 0.9615
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1245 - acc: 0.9617
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1239 - acc: 0.9619
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1238 - acc: 0.9621
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1237 - acc: 0.9620
1472/1506 [============================>.] - ETA: 0s - loss: 0.1242 - acc: 0.9619
1504/1506 [============================>.] - ETA: 0s - loss: 0.1243 - acc: 0.9618
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1242 - acc: 0.9619 - val_loss: 0.1811 - val_acc: 0.9427
Epoch 8/70

  32/1506 [..............................] - ETA: 27s - loss: 0.0683 - acc: 0.9809
  64/1506 [>.............................] - ETA: 27s - loss: 0.0634 - acc: 0.9789
  96/1506 [>.............................] - ETA: 26s - loss: 0.0699 - acc: 0.9783
 128/1506 [=>............................] - ETA: 25s - loss: 0.0807 - acc: 0.9764
 160/1506 [==>...........................] - ETA: 25s - loss: 0.0879 - acc: 0.9735
 192/1506 [==>...........................] - ETA: 24s - loss: 0.0998 - acc: 0.9674
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1103 - acc: 0.9659
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1053 - acc: 0.9678
 288/1506 [====>.........................] - ETA: 22s - loss: 0.1099 - acc: 0.9653
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1107 - acc: 0.9651
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1062 - acc: 0.9665
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1070 - acc: 0.9658
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1057 - acc: 0.9669
 448/1506 [=======>......................] - ETA: 19s - loss: 0.1056 - acc: 0.9667
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1068 - acc: 0.9661
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1089 - acc: 0.9655
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1089 - acc: 0.9657
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1084 - acc: 0.9658
 608/1506 [===========>..................] - ETA: 16s - loss: 0.1076 - acc: 0.9657
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1087 - acc: 0.9654
 672/1506 [============>.................] - ETA: 15s - loss: 0.1071 - acc: 0.9660
 704/1506 [=============>................] - ETA: 15s - loss: 0.1073 - acc: 0.9660
 736/1506 [=============>................] - ETA: 14s - loss: 0.1080 - acc: 0.9655
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1099 - acc: 0.9649
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1094 - acc: 0.9651
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1117 - acc: 0.9643
 864/1506 [================>.............] - ETA: 12s - loss: 0.1128 - acc: 0.9642
 896/1506 [================>.............] - ETA: 11s - loss: 0.1148 - acc: 0.9636
 928/1506 [=================>............] - ETA: 10s - loss: 0.1162 - acc: 0.9631
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1155 - acc: 0.9633
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1148 - acc: 0.9638 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1140 - acc: 0.9641
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1131 - acc: 0.9643
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1149 - acc: 0.9641
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1149 - acc: 0.9638
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1150 - acc: 0.9639
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1150 - acc: 0.9641
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1144 - acc: 0.9642
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1143 - acc: 0.9642
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1146 - acc: 0.9642
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1141 - acc: 0.9645
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1156 - acc: 0.9639
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1155 - acc: 0.9640
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1161 - acc: 0.9638
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1154 - acc: 0.9640
1472/1506 [============================>.] - ETA: 0s - loss: 0.1146 - acc: 0.9643
1504/1506 [============================>.] - ETA: 0s - loss: 0.1140 - acc: 0.9643
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1139 - acc: 0.9644 - val_loss: 0.1890 - val_acc: 0.9413
Computing...
Manual evaluation: (didn't understand why I made this)
True 8172
False 899
True percentage 0.900892955573
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.65      0.75      0.70       296
      I-ORG       0.43      0.74      0.54       151
      B-PER       0.92      0.82      0.86       438
      B-LOC       0.71      0.77      0.74       218
      I-LOC       0.66      0.81      0.73       141
      I-PER       0.89      0.64      0.74       214
     B-MISC       0.67      0.06      0.10       141
     I-MISC       0.76      0.10      0.18       154

avg / total       0.94      0.90      0.91      9071

F-1 Score:
0.678260869565
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 1674 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 237
OOV word occurences: 324
Padding...
Data padded!
Padding...
Data padded!
Padded until 83 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,992,194
Trainable params: 6,992,194
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1506 samples, validate on 168 samples
Epoch 1/70

  32/1506 [..............................] - ETA: 2:08 - loss: 2.3440 - acc: 0.0163
  64/1506 [>.............................] - ETA: 1:18 - loss: 1.6247 - acc: 0.4126
  96/1506 [>.............................] - ETA: 1:01 - loss: 1.9783 - acc: 0.5372
 128/1506 [=>............................] - ETA: 51s - loss: 1.7079 - acc: 0.6120 
 160/1506 [==>...........................] - ETA: 45s - loss: 1.5596 - acc: 0.6458
 192/1506 [==>...........................] - ETA: 41s - loss: 1.4337 - acc: 0.6722
 224/1506 [===>..........................] - ETA: 38s - loss: 1.3354 - acc: 0.6907
 256/1506 [====>.........................] - ETA: 35s - loss: 1.2611 - acc: 0.7030
 288/1506 [====>.........................] - ETA: 33s - loss: 1.1882 - acc: 0.7176
 320/1506 [=====>........................] - ETA: 32s - loss: 1.1271 - acc: 0.7294
 352/1506 [======>.......................] - ETA: 30s - loss: 1.0912 - acc: 0.7351
 384/1506 [======>.......................] - ETA: 28s - loss: 1.0618 - acc: 0.7384
 416/1506 [=======>......................] - ETA: 27s - loss: 1.0235 - acc: 0.7453
 448/1506 [=======>......................] - ETA: 26s - loss: 0.9896 - acc: 0.7517
 480/1506 [========>.....................] - ETA: 25s - loss: 0.9633 - acc: 0.7550
 512/1506 [=========>....................] - ETA: 24s - loss: 0.9422 - acc: 0.7584
 544/1506 [=========>....................] - ETA: 23s - loss: 0.9216 - acc: 0.7621
 576/1506 [==========>...................] - ETA: 22s - loss: 0.8945 - acc: 0.7676
 608/1506 [===========>..................] - ETA: 21s - loss: 0.8730 - acc: 0.7727
 640/1506 [===========>..................] - ETA: 20s - loss: 0.8517 - acc: 0.7767
 672/1506 [============>.................] - ETA: 19s - loss: 0.8362 - acc: 0.7802
 704/1506 [=============>................] - ETA: 18s - loss: 0.8166 - acc: 0.7840
 736/1506 [=============>................] - ETA: 17s - loss: 0.8001 - acc: 0.7869
 768/1506 [==============>...............] - ETA: 16s - loss: 0.7832 - acc: 0.7900
 800/1506 [==============>...............] - ETA: 15s - loss: 0.7726 - acc: 0.7916
 832/1506 [===============>..............] - ETA: 15s - loss: 0.7596 - acc: 0.7958
 864/1506 [================>.............] - ETA: 14s - loss: 0.7483 - acc: 0.7978
 896/1506 [================>.............] - ETA: 13s - loss: 0.7371 - acc: 0.7999
 928/1506 [=================>............] - ETA: 12s - loss: 0.7225 - acc: 0.8036
 960/1506 [==================>...........] - ETA: 12s - loss: 0.7127 - acc: 0.8055
 992/1506 [==================>...........] - ETA: 11s - loss: 0.7039 - acc: 0.8072
1024/1506 [===================>..........] - ETA: 10s - loss: 0.6917 - acc: 0.8104
1056/1506 [====================>.........] - ETA: 9s - loss: 0.6811 - acc: 0.8131 
1088/1506 [====================>.........] - ETA: 9s - loss: 0.6716 - acc: 0.8155
1120/1506 [=====================>........] - ETA: 8s - loss: 0.6633 - acc: 0.8171
1152/1506 [=====================>........] - ETA: 7s - loss: 0.6539 - acc: 0.8198
1184/1506 [======================>.......] - ETA: 6s - loss: 0.6453 - acc: 0.8217
1216/1506 [=======================>......] - ETA: 6s - loss: 0.6376 - acc: 0.8237
1248/1506 [=======================>......] - ETA: 5s - loss: 0.6319 - acc: 0.8252
1280/1506 [========================>.....] - ETA: 4s - loss: 0.6238 - acc: 0.8276
1312/1506 [=========================>....] - ETA: 4s - loss: 0.6161 - acc: 0.8295
1344/1506 [=========================>....] - ETA: 3s - loss: 0.6115 - acc: 0.8307
1376/1506 [==========================>...] - ETA: 2s - loss: 0.6058 - acc: 0.8318
1408/1506 [===========================>..] - ETA: 2s - loss: 0.5983 - acc: 0.8340
1440/1506 [===========================>..] - ETA: 1s - loss: 0.5937 - acc: 0.8349
1472/1506 [============================>.] - ETA: 0s - loss: 0.5872 - acc: 0.8365
1504/1506 [============================>.] - ETA: 0s - loss: 0.5821 - acc: 0.8376
1506/1506 [==============================] - 33s 22ms/step - loss: 0.5821 - acc: 0.8375 - val_loss: 0.3600 - val_acc: 0.8712
Epoch 2/70

  32/1506 [..............................] - ETA: 27s - loss: 0.4207 - acc: 0.8537
  64/1506 [>.............................] - ETA: 27s - loss: 0.3926 - acc: 0.8684
  96/1506 [>.............................] - ETA: 26s - loss: 0.3496 - acc: 0.8830
 128/1506 [=>............................] - ETA: 25s - loss: 0.3425 - acc: 0.8887
 160/1506 [==>...........................] - ETA: 25s - loss: 0.3321 - acc: 0.8938
 192/1506 [==>...........................] - ETA: 24s - loss: 0.3437 - acc: 0.8899
 224/1506 [===>..........................] - ETA: 24s - loss: 0.3375 - acc: 0.8945
 256/1506 [====>.........................] - ETA: 23s - loss: 0.3219 - acc: 0.8995
 288/1506 [====>.........................] - ETA: 23s - loss: 0.3132 - acc: 0.9023
 320/1506 [=====>........................] - ETA: 22s - loss: 0.3087 - acc: 0.9036
 352/1506 [======>.......................] - ETA: 21s - loss: 0.3125 - acc: 0.9020
 384/1506 [======>.......................] - ETA: 21s - loss: 0.3121 - acc: 0.9004
 416/1506 [=======>......................] - ETA: 20s - loss: 0.3104 - acc: 0.9006
 448/1506 [=======>......................] - ETA: 20s - loss: 0.3151 - acc: 0.8998
 480/1506 [========>.....................] - ETA: 19s - loss: 0.3124 - acc: 0.8999
 512/1506 [=========>....................] - ETA: 18s - loss: 0.3117 - acc: 0.9002
 544/1506 [=========>....................] - ETA: 18s - loss: 0.3025 - acc: 0.9037
 576/1506 [==========>...................] - ETA: 17s - loss: 0.3023 - acc: 0.9040
 608/1506 [===========>..................] - ETA: 17s - loss: 0.3017 - acc: 0.9037
 640/1506 [===========>..................] - ETA: 16s - loss: 0.2963 - acc: 0.9060
 672/1506 [============>.................] - ETA: 15s - loss: 0.2937 - acc: 0.9070
 704/1506 [=============>................] - ETA: 15s - loss: 0.2929 - acc: 0.9075
 736/1506 [=============>................] - ETA: 14s - loss: 0.2929 - acc: 0.9083
 768/1506 [==============>...............] - ETA: 14s - loss: 0.2916 - acc: 0.9086
 800/1506 [==============>...............] - ETA: 13s - loss: 0.2915 - acc: 0.9087
 832/1506 [===============>..............] - ETA: 12s - loss: 0.2912 - acc: 0.9083
 864/1506 [================>.............] - ETA: 12s - loss: 0.2916 - acc: 0.9081
 896/1506 [================>.............] - ETA: 11s - loss: 0.2889 - acc: 0.9097
 928/1506 [=================>............] - ETA: 11s - loss: 0.2874 - acc: 0.9105
 960/1506 [==================>...........] - ETA: 10s - loss: 0.2841 - acc: 0.9118
 992/1506 [==================>...........] - ETA: 9s - loss: 0.2819 - acc: 0.9123 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.2807 - acc: 0.9128
1056/1506 [====================>.........] - ETA: 8s - loss: 0.2811 - acc: 0.9125
1088/1506 [====================>.........] - ETA: 7s - loss: 0.2778 - acc: 0.9136
1120/1506 [=====================>........] - ETA: 7s - loss: 0.2772 - acc: 0.9141
1152/1506 [=====================>........] - ETA: 6s - loss: 0.2755 - acc: 0.9145
1184/1506 [======================>.......] - ETA: 6s - loss: 0.2729 - acc: 0.9153
1216/1506 [=======================>......] - ETA: 5s - loss: 0.2715 - acc: 0.9157
1248/1506 [=======================>......] - ETA: 4s - loss: 0.2702 - acc: 0.9160
1280/1506 [========================>.....] - ETA: 4s - loss: 0.2690 - acc: 0.9162
1312/1506 [=========================>....] - ETA: 3s - loss: 0.2681 - acc: 0.9167
1344/1506 [=========================>....] - ETA: 3s - loss: 0.2685 - acc: 0.9163
1376/1506 [==========================>...] - ETA: 2s - loss: 0.2684 - acc: 0.9165
1408/1506 [===========================>..] - ETA: 1s - loss: 0.2691 - acc: 0.9165
1440/1506 [===========================>..] - ETA: 1s - loss: 0.2676 - acc: 0.9170
1472/1506 [============================>.] - ETA: 0s - loss: 0.2669 - acc: 0.9172
1504/1506 [============================>.] - ETA: 0s - loss: 0.2660 - acc: 0.9176
1506/1506 [==============================] - 30s 20ms/step - loss: 0.2658 - acc: 0.9176 - val_loss: 0.2060 - val_acc: 0.9372
Epoch 3/70

  32/1506 [..............................] - ETA: 28s - loss: 0.1550 - acc: 0.9483
  64/1506 [>.............................] - ETA: 27s - loss: 0.1591 - acc: 0.9528
  96/1506 [>.............................] - ETA: 27s - loss: 0.1706 - acc: 0.9519
 128/1506 [=>............................] - ETA: 26s - loss: 0.1814 - acc: 0.9456
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1964 - acc: 0.9434
 192/1506 [==>...........................] - ETA: 25s - loss: 0.1875 - acc: 0.9452
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1917 - acc: 0.9428
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1831 - acc: 0.9466
 288/1506 [====>.........................] - ETA: 23s - loss: 0.1837 - acc: 0.9455
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1867 - acc: 0.9432
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1942 - acc: 0.9411
 384/1506 [======>.......................] - ETA: 21s - loss: 0.2002 - acc: 0.9377
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1998 - acc: 0.9376
 448/1506 [=======>......................] - ETA: 20s - loss: 0.2002 - acc: 0.9376
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1981 - acc: 0.9380
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1948 - acc: 0.9389
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1977 - acc: 0.9366
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1975 - acc: 0.9362
 608/1506 [===========>..................] - ETA: 16s - loss: 0.2026 - acc: 0.9348
 640/1506 [===========>..................] - ETA: 16s - loss: 0.2001 - acc: 0.9357
 672/1506 [============>.................] - ETA: 15s - loss: 0.1971 - acc: 0.9366
 704/1506 [=============>................] - ETA: 15s - loss: 0.1959 - acc: 0.9369
 736/1506 [=============>................] - ETA: 14s - loss: 0.1961 - acc: 0.9365
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1979 - acc: 0.9359
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1994 - acc: 0.9355
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1992 - acc: 0.9355
 864/1506 [================>.............] - ETA: 12s - loss: 0.1987 - acc: 0.9353
 896/1506 [================>.............] - ETA: 11s - loss: 0.2017 - acc: 0.9344
 928/1506 [=================>............] - ETA: 10s - loss: 0.2019 - acc: 0.9343
 960/1506 [==================>...........] - ETA: 10s - loss: 0.2049 - acc: 0.9335
 992/1506 [==================>...........] - ETA: 9s - loss: 0.2057 - acc: 0.9335 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.2085 - acc: 0.9323
1056/1506 [====================>.........] - ETA: 8s - loss: 0.2087 - acc: 0.9323
1088/1506 [====================>.........] - ETA: 7s - loss: 0.2086 - acc: 0.9325
1120/1506 [=====================>........] - ETA: 7s - loss: 0.2107 - acc: 0.9320
1152/1506 [=====================>........] - ETA: 6s - loss: 0.2101 - acc: 0.9324
1184/1506 [======================>.......] - ETA: 6s - loss: 0.2096 - acc: 0.9326
1216/1506 [=======================>......] - ETA: 5s - loss: 0.2092 - acc: 0.9327
1248/1506 [=======================>......] - ETA: 4s - loss: 0.2123 - acc: 0.9321
1280/1506 [========================>.....] - ETA: 4s - loss: 0.2115 - acc: 0.9322
1312/1506 [=========================>....] - ETA: 3s - loss: 0.2117 - acc: 0.9325
1344/1506 [=========================>....] - ETA: 3s - loss: 0.2115 - acc: 0.9326
1376/1506 [==========================>...] - ETA: 2s - loss: 0.2102 - acc: 0.9331
1408/1506 [===========================>..] - ETA: 1s - loss: 0.2097 - acc: 0.9331
1440/1506 [===========================>..] - ETA: 1s - loss: 0.2105 - acc: 0.9332
1472/1506 [============================>.] - ETA: 0s - loss: 0.2102 - acc: 0.9331
1504/1506 [============================>.] - ETA: 0s - loss: 0.2106 - acc: 0.9330
1506/1506 [==============================] - 30s 20ms/step - loss: 0.2104 - acc: 0.9331 - val_loss: 0.1793 - val_acc: 0.9444
Epoch 4/70

  32/1506 [..............................] - ETA: 27s - loss: 0.1240 - acc: 0.9631
  64/1506 [>.............................] - ETA: 27s - loss: 0.1505 - acc: 0.9522
  96/1506 [>.............................] - ETA: 26s - loss: 0.1603 - acc: 0.9499
 128/1506 [=>............................] - ETA: 25s - loss: 0.1704 - acc: 0.9480
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1720 - acc: 0.9484
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1758 - acc: 0.9470
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1761 - acc: 0.9455
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1712 - acc: 0.9466
 288/1506 [====>.........................] - ETA: 22s - loss: 0.1815 - acc: 0.9431
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1809 - acc: 0.9443
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1831 - acc: 0.9435
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1851 - acc: 0.9421
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1826 - acc: 0.9428
 448/1506 [=======>......................] - ETA: 20s - loss: 0.1778 - acc: 0.9443
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1799 - acc: 0.9439
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1757 - acc: 0.9453
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1769 - acc: 0.9447
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1780 - acc: 0.9440
 608/1506 [===========>..................] - ETA: 16s - loss: 0.1754 - acc: 0.9448
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1775 - acc: 0.9446
 672/1506 [============>.................] - ETA: 15s - loss: 0.1785 - acc: 0.9440
 704/1506 [=============>................] - ETA: 15s - loss: 0.1830 - acc: 0.9421
 736/1506 [=============>................] - ETA: 14s - loss: 0.1830 - acc: 0.9428
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1853 - acc: 0.9424
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1844 - acc: 0.9425
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1843 - acc: 0.9425
 864/1506 [================>.............] - ETA: 12s - loss: 0.1855 - acc: 0.9422
 896/1506 [================>.............] - ETA: 11s - loss: 0.1835 - acc: 0.9429
 928/1506 [=================>............] - ETA: 10s - loss: 0.1844 - acc: 0.9426
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1830 - acc: 0.9431
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1818 - acc: 0.9437 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1821 - acc: 0.9434
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1815 - acc: 0.9434
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1814 - acc: 0.9434
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1819 - acc: 0.9429
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1799 - acc: 0.9437
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1825 - acc: 0.9422
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1823 - acc: 0.9422
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1812 - acc: 0.9423
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1811 - acc: 0.9419
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1804 - acc: 0.9420
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1806 - acc: 0.9424
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1825 - acc: 0.9416
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1826 - acc: 0.9415
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1815 - acc: 0.9421
1472/1506 [============================>.] - ETA: 0s - loss: 0.1824 - acc: 0.9417
1504/1506 [============================>.] - ETA: 0s - loss: 0.1827 - acc: 0.9417
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1825 - acc: 0.9418 - val_loss: 0.1725 - val_acc: 0.9508
Epoch 5/70

  32/1506 [..............................] - ETA: 27s - loss: 0.1604 - acc: 0.9449
  64/1506 [>.............................] - ETA: 26s - loss: 0.1656 - acc: 0.9472
  96/1506 [>.............................] - ETA: 26s - loss: 0.1588 - acc: 0.9500
 128/1506 [=>............................] - ETA: 26s - loss: 0.1555 - acc: 0.9535
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1481 - acc: 0.9548
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1508 - acc: 0.9544
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1532 - acc: 0.9532
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1586 - acc: 0.9518
 288/1506 [====>.........................] - ETA: 23s - loss: 0.1564 - acc: 0.9513
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1612 - acc: 0.9487
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1707 - acc: 0.9445
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1705 - acc: 0.9451
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1686 - acc: 0.9459
 448/1506 [=======>......................] - ETA: 20s - loss: 0.1734 - acc: 0.9451
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1713 - acc: 0.9461
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1684 - acc: 0.9470
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1682 - acc: 0.9473
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1679 - acc: 0.9471
 608/1506 [===========>..................] - ETA: 16s - loss: 0.1694 - acc: 0.9469
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1665 - acc: 0.9475
 672/1506 [============>.................] - ETA: 15s - loss: 0.1673 - acc: 0.9471
 704/1506 [=============>................] - ETA: 15s - loss: 0.1662 - acc: 0.9471
 736/1506 [=============>................] - ETA: 14s - loss: 0.1637 - acc: 0.9481
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1624 - acc: 0.9484
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1604 - acc: 0.9485
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1608 - acc: 0.9484
 864/1506 [================>.............] - ETA: 12s - loss: 0.1593 - acc: 0.9488
 896/1506 [================>.............] - ETA: 11s - loss: 0.1605 - acc: 0.9483
 928/1506 [=================>............] - ETA: 10s - loss: 0.1599 - acc: 0.9486
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1607 - acc: 0.9482
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1610 - acc: 0.9480 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1594 - acc: 0.9486
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1576 - acc: 0.9493
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1578 - acc: 0.9492
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1575 - acc: 0.9495
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1567 - acc: 0.9496
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1563 - acc: 0.9497
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1553 - acc: 0.9500
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1550 - acc: 0.9502
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1545 - acc: 0.9503
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1541 - acc: 0.9507
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1547 - acc: 0.9508
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1555 - acc: 0.9502
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1560 - acc: 0.9503
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1553 - acc: 0.9506
1472/1506 [============================>.] - ETA: 0s - loss: 0.1570 - acc: 0.9497
1504/1506 [============================>.] - ETA: 0s - loss: 0.1584 - acc: 0.9494
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1583 - acc: 0.9494 - val_loss: 0.1500 - val_acc: 0.9561
Epoch 6/70

  32/1506 [..............................] - ETA: 27s - loss: 0.1549 - acc: 0.9535
  64/1506 [>.............................] - ETA: 26s - loss: 0.1271 - acc: 0.9631
  96/1506 [>.............................] - ETA: 26s - loss: 0.1455 - acc: 0.9530
 128/1506 [=>............................] - ETA: 26s - loss: 0.1398 - acc: 0.9539
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1428 - acc: 0.9527
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1539 - acc: 0.9515
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1493 - acc: 0.9526
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1437 - acc: 0.9547
 288/1506 [====>.........................] - ETA: 23s - loss: 0.1473 - acc: 0.9530
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1472 - acc: 0.9532
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1473 - acc: 0.9540
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1497 - acc: 0.9531
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1509 - acc: 0.9529
 448/1506 [=======>......................] - ETA: 20s - loss: 0.1564 - acc: 0.9518
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1523 - acc: 0.9536
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1526 - acc: 0.9537
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1518 - acc: 0.9537
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1500 - acc: 0.9545
 608/1506 [===========>..................] - ETA: 17s - loss: 0.1503 - acc: 0.9538
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1464 - acc: 0.9551
 672/1506 [============>.................] - ETA: 15s - loss: 0.1463 - acc: 0.9553
 704/1506 [=============>................] - ETA: 15s - loss: 0.1489 - acc: 0.9541
 736/1506 [=============>................] - ETA: 14s - loss: 0.1492 - acc: 0.9536
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1479 - acc: 0.9541
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1453 - acc: 0.9549
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1442 - acc: 0.9553
 864/1506 [================>.............] - ETA: 12s - loss: 0.1432 - acc: 0.9557
 896/1506 [================>.............] - ETA: 11s - loss: 0.1425 - acc: 0.9557
 928/1506 [=================>............] - ETA: 10s - loss: 0.1437 - acc: 0.9551
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1429 - acc: 0.9553
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1427 - acc: 0.9554 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1427 - acc: 0.9554
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1428 - acc: 0.9552
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1437 - acc: 0.9546
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1435 - acc: 0.9546
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1435 - acc: 0.9548
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1431 - acc: 0.9550
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1428 - acc: 0.9549
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1436 - acc: 0.9545
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1450 - acc: 0.9539
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1448 - acc: 0.9540
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1438 - acc: 0.9543
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1435 - acc: 0.9546
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1425 - acc: 0.9550
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1430 - acc: 0.9551
1472/1506 [============================>.] - ETA: 0s - loss: 0.1428 - acc: 0.9552
1504/1506 [============================>.] - ETA: 0s - loss: 0.1430 - acc: 0.9550
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1429 - acc: 0.9550 - val_loss: 0.1951 - val_acc: 0.9403
Epoch 7/70

  32/1506 [..............................] - ETA: 28s - loss: 0.1784 - acc: 0.9398
  64/1506 [>.............................] - ETA: 27s - loss: 0.1775 - acc: 0.9432
  96/1506 [>.............................] - ETA: 26s - loss: 0.1699 - acc: 0.9472
 128/1506 [=>............................] - ETA: 26s - loss: 0.1550 - acc: 0.9504
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1514 - acc: 0.9520
 192/1506 [==>...........................] - ETA: 25s - loss: 0.1468 - acc: 0.9547
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1410 - acc: 0.9567
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1465 - acc: 0.9561
 288/1506 [====>.........................] - ETA: 23s - loss: 0.1423 - acc: 0.9577
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1378 - acc: 0.9598
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1312 - acc: 0.9620
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1338 - acc: 0.9611
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1332 - acc: 0.9611
 448/1506 [=======>......................] - ETA: 20s - loss: 0.1343 - acc: 0.9607
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1311 - acc: 0.9615
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1327 - acc: 0.9606
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1314 - acc: 0.9607
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1344 - acc: 0.9598
 608/1506 [===========>..................] - ETA: 17s - loss: 0.1361 - acc: 0.9591
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1351 - acc: 0.9593
 672/1506 [============>.................] - ETA: 15s - loss: 0.1330 - acc: 0.9597
 704/1506 [=============>................] - ETA: 15s - loss: 0.1339 - acc: 0.9594
 736/1506 [=============>................] - ETA: 14s - loss: 0.1323 - acc: 0.9598
 768/1506 [==============>...............] - ETA: 14s - loss: 0.1317 - acc: 0.9598
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1305 - acc: 0.9603
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1295 - acc: 0.9606
 864/1506 [================>.............] - ETA: 12s - loss: 0.1285 - acc: 0.9610
 896/1506 [================>.............] - ETA: 11s - loss: 0.1296 - acc: 0.9608
 928/1506 [=================>............] - ETA: 10s - loss: 0.1280 - acc: 0.9613
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1284 - acc: 0.9611
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1283 - acc: 0.9610 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1282 - acc: 0.9608
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1284 - acc: 0.9607
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1277 - acc: 0.9609
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1287 - acc: 0.9606
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1283 - acc: 0.9605
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1284 - acc: 0.9603
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1284 - acc: 0.9601
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1286 - acc: 0.9598
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1292 - acc: 0.9599
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1297 - acc: 0.9596
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1300 - acc: 0.9594
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1305 - acc: 0.9594
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1305 - acc: 0.9595
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1292 - acc: 0.9599
1472/1506 [============================>.] - ETA: 0s - loss: 0.1291 - acc: 0.9598
1504/1506 [============================>.] - ETA: 0s - loss: 0.1288 - acc: 0.9600
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1288 - acc: 0.9600 - val_loss: 0.1559 - val_acc: 0.9578
Computing...
Manual evaluation: (didn't understand why I made this)
True 8177
False 894
True percentage 0.901444162716
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.79      0.64      0.70       296
      I-ORG       0.64      0.46      0.54       151
     B-MISC       0.69      0.16      0.25       141
     I-MISC       0.61      0.31      0.41       154
      B-PER       0.77      0.87      0.81       438
      B-LOC       0.67      0.77      0.72       218
      I-LOC       0.68      0.76      0.72       141
      I-PER       0.81      0.67      0.74       214

avg / total       0.93      0.90      0.91      9071

F-1 Score:
0.684514755096
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 1674 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 237
OOV word occurences: 324
Padding...
Data padded!
Padding...
Data padded!
Padded until 83 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,992,194
Trainable params: 6,992,194
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1506 samples, validate on 168 samples
Epoch 1/70

  32/1506 [..............................] - ETA: 2:07 - loss: 2.2225 - acc: 0.1420
  64/1506 [>.............................] - ETA: 1:17 - loss: 1.6013 - acc: 0.4714
  96/1506 [>.............................] - ETA: 1:00 - loss: 1.9354 - acc: 0.5769
 128/1506 [=>............................] - ETA: 51s - loss: 1.7120 - acc: 0.6407 
 160/1506 [==>...........................] - ETA: 45s - loss: 1.5581 - acc: 0.6658
 192/1506 [==>...........................] - ETA: 41s - loss: 1.4187 - acc: 0.6913
 224/1506 [===>..........................] - ETA: 38s - loss: 1.3304 - acc: 0.7046
 256/1506 [====>.........................] - ETA: 35s - loss: 1.2535 - acc: 0.7170
 288/1506 [====>.........................] - ETA: 33s - loss: 1.1841 - acc: 0.7281
 320/1506 [=====>........................] - ETA: 31s - loss: 1.1392 - acc: 0.7348
 352/1506 [======>.......................] - ETA: 29s - loss: 1.0965 - acc: 0.7411
 384/1506 [======>.......................] - ETA: 28s - loss: 1.0510 - acc: 0.7480
 416/1506 [=======>......................] - ETA: 27s - loss: 1.0178 - acc: 0.7522
 448/1506 [=======>......................] - ETA: 25s - loss: 0.9938 - acc: 0.7567
 480/1506 [========>.....................] - ETA: 24s - loss: 0.9675 - acc: 0.7607
 512/1506 [=========>....................] - ETA: 23s - loss: 0.9448 - acc: 0.7640
 544/1506 [=========>....................] - ETA: 22s - loss: 0.9248 - acc: 0.7674
 576/1506 [==========>...................] - ETA: 21s - loss: 0.8972 - acc: 0.7719
 608/1506 [===========>..................] - ETA: 20s - loss: 0.8807 - acc: 0.7761
 640/1506 [===========>..................] - ETA: 19s - loss: 0.8609 - acc: 0.7792
 672/1506 [============>.................] - ETA: 19s - loss: 0.8446 - acc: 0.7828
 704/1506 [=============>................] - ETA: 18s - loss: 0.8278 - acc: 0.7858
 736/1506 [=============>................] - ETA: 17s - loss: 0.8191 - acc: 0.7869
 768/1506 [==============>...............] - ETA: 16s - loss: 0.8064 - acc: 0.7893
 800/1506 [==============>...............] - ETA: 15s - loss: 0.7896 - acc: 0.7924
 832/1506 [===============>..............] - ETA: 14s - loss: 0.7770 - acc: 0.7952
 864/1506 [================>.............] - ETA: 14s - loss: 0.7623 - acc: 0.7981
 896/1506 [================>.............] - ETA: 13s - loss: 0.7489 - acc: 0.8015
 928/1506 [=================>............] - ETA: 12s - loss: 0.7363 - acc: 0.8042
 960/1506 [==================>...........] - ETA: 11s - loss: 0.7222 - acc: 0.8077
 992/1506 [==================>...........] - ETA: 11s - loss: 0.7144 - acc: 0.8091
1024/1506 [===================>..........] - ETA: 10s - loss: 0.7073 - acc: 0.8111
1056/1506 [====================>.........] - ETA: 9s - loss: 0.6986 - acc: 0.8125 
1088/1506 [====================>.........] - ETA: 8s - loss: 0.6891 - acc: 0.8151
1120/1506 [=====================>........] - ETA: 8s - loss: 0.6783 - acc: 0.8177
1152/1506 [=====================>........] - ETA: 7s - loss: 0.6678 - acc: 0.8203
1184/1506 [======================>.......] - ETA: 6s - loss: 0.6581 - acc: 0.8226
1216/1506 [=======================>......] - ETA: 6s - loss: 0.6500 - acc: 0.8240
1248/1506 [=======================>......] - ETA: 5s - loss: 0.6430 - acc: 0.8259
1280/1506 [========================>.....] - ETA: 4s - loss: 0.6347 - acc: 0.8278
1312/1506 [=========================>....] - ETA: 4s - loss: 0.6271 - acc: 0.8295
1344/1506 [=========================>....] - ETA: 3s - loss: 0.6190 - acc: 0.8314
1376/1506 [==========================>...] - ETA: 2s - loss: 0.6123 - acc: 0.8329
1408/1506 [===========================>..] - ETA: 2s - loss: 0.6060 - acc: 0.8345
1440/1506 [===========================>..] - ETA: 1s - loss: 0.6008 - acc: 0.8355
1472/1506 [============================>.] - ETA: 0s - loss: 0.5931 - acc: 0.8378
1504/1506 [============================>.] - ETA: 0s - loss: 0.5875 - acc: 0.8393
1506/1506 [==============================] - 33s 22ms/step - loss: 0.5871 - acc: 0.8393 - val_loss: 0.2965 - val_acc: 0.9064
Epoch 2/70

  32/1506 [..............................] - ETA: 27s - loss: 0.2343 - acc: 0.9359
  64/1506 [>.............................] - ETA: 27s - loss: 0.2920 - acc: 0.9099
  96/1506 [>.............................] - ETA: 26s - loss: 0.2615 - acc: 0.9162
 128/1506 [=>............................] - ETA: 26s - loss: 0.2727 - acc: 0.9109
 160/1506 [==>...........................] - ETA: 25s - loss: 0.2842 - acc: 0.9061
 192/1506 [==>...........................] - ETA: 25s - loss: 0.2989 - acc: 0.9028
 224/1506 [===>..........................] - ETA: 24s - loss: 0.3042 - acc: 0.9043
 256/1506 [====>.........................] - ETA: 23s - loss: 0.3025 - acc: 0.9054
 288/1506 [====>.........................] - ETA: 23s - loss: 0.3001 - acc: 0.9058
 320/1506 [=====>........................] - ETA: 22s - loss: 0.2955 - acc: 0.9080
 352/1506 [======>.......................] - ETA: 22s - loss: 0.2944 - acc: 0.9077
 384/1506 [======>.......................] - ETA: 21s - loss: 0.2923 - acc: 0.9085
 416/1506 [=======>......................] - ETA: 20s - loss: 0.2850 - acc: 0.9110
 448/1506 [=======>......................] - ETA: 20s - loss: 0.2848 - acc: 0.9104
 480/1506 [========>.....................] - ETA: 19s - loss: 0.2822 - acc: 0.9114
 512/1506 [=========>....................] - ETA: 18s - loss: 0.2836 - acc: 0.9111
 544/1506 [=========>....................] - ETA: 18s - loss: 0.2832 - acc: 0.9115
 576/1506 [==========>...................] - ETA: 17s - loss: 0.2795 - acc: 0.9132
 608/1506 [===========>..................] - ETA: 17s - loss: 0.2769 - acc: 0.9138
 640/1506 [===========>..................] - ETA: 16s - loss: 0.2783 - acc: 0.9138
 672/1506 [============>.................] - ETA: 15s - loss: 0.2798 - acc: 0.9129
 704/1506 [=============>................] - ETA: 15s - loss: 0.2818 - acc: 0.9134
 736/1506 [=============>................] - ETA: 14s - loss: 0.2811 - acc: 0.9132
 768/1506 [==============>...............] - ETA: 14s - loss: 0.2776 - acc: 0.9142
 800/1506 [==============>...............] - ETA: 13s - loss: 0.2775 - acc: 0.9145
 832/1506 [===============>..............] - ETA: 12s - loss: 0.2755 - acc: 0.9147
 864/1506 [================>.............] - ETA: 12s - loss: 0.2770 - acc: 0.9141
 896/1506 [================>.............] - ETA: 11s - loss: 0.2774 - acc: 0.9139
 928/1506 [=================>............] - ETA: 11s - loss: 0.2748 - acc: 0.9150
 960/1506 [==================>...........] - ETA: 10s - loss: 0.2741 - acc: 0.9147
 992/1506 [==================>...........] - ETA: 9s - loss: 0.2734 - acc: 0.9148 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.2735 - acc: 0.9149
1056/1506 [====================>.........] - ETA: 8s - loss: 0.2775 - acc: 0.9134
1088/1506 [====================>.........] - ETA: 7s - loss: 0.2760 - acc: 0.9139
1120/1506 [=====================>........] - ETA: 7s - loss: 0.2744 - acc: 0.9145
1152/1506 [=====================>........] - ETA: 6s - loss: 0.2720 - acc: 0.9150
1184/1506 [======================>.......] - ETA: 6s - loss: 0.2696 - acc: 0.9153
1216/1506 [=======================>......] - ETA: 5s - loss: 0.2681 - acc: 0.9156
1248/1506 [=======================>......] - ETA: 4s - loss: 0.2677 - acc: 0.9158
1280/1506 [========================>.....] - ETA: 4s - loss: 0.2656 - acc: 0.9169
1312/1506 [=========================>....] - ETA: 3s - loss: 0.2641 - acc: 0.9172
1344/1506 [=========================>....] - ETA: 3s - loss: 0.2637 - acc: 0.9173
1376/1506 [==========================>...] - ETA: 2s - loss: 0.2627 - acc: 0.9175
1408/1506 [===========================>..] - ETA: 1s - loss: 0.2627 - acc: 0.9175
1440/1506 [===========================>..] - ETA: 1s - loss: 0.2627 - acc: 0.9176
1472/1506 [============================>.] - ETA: 0s - loss: 0.2639 - acc: 0.9170
1504/1506 [============================>.] - ETA: 0s - loss: 0.2616 - acc: 0.9178
1506/1506 [==============================] - 30s 20ms/step - loss: 0.2613 - acc: 0.9179 - val_loss: 0.2200 - val_acc: 0.9279
Epoch 3/70

  32/1506 [..............................] - ETA: 27s - loss: 0.1559 - acc: 0.9543
  64/1506 [>.............................] - ETA: 27s - loss: 0.1996 - acc: 0.9393
  96/1506 [>.............................] - ETA: 26s - loss: 0.2071 - acc: 0.9360
 128/1506 [=>............................] - ETA: 25s - loss: 0.2024 - acc: 0.9344
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1988 - acc: 0.9361
 192/1506 [==>...........................] - ETA: 24s - loss: 0.2047 - acc: 0.9318
 224/1506 [===>..........................] - ETA: 24s - loss: 0.2065 - acc: 0.9322
 256/1506 [====>.........................] - ETA: 23s - loss: 0.2111 - acc: 0.9318
 288/1506 [====>.........................] - ETA: 23s - loss: 0.2063 - acc: 0.9329
 320/1506 [=====>........................] - ETA: 22s - loss: 0.2175 - acc: 0.9301
 352/1506 [======>.......................] - ETA: 21s - loss: 0.2173 - acc: 0.9310
 384/1506 [======>.......................] - ETA: 21s - loss: 0.2156 - acc: 0.9311
 416/1506 [=======>......................] - ETA: 20s - loss: 0.2115 - acc: 0.9331
 448/1506 [=======>......................] - ETA: 19s - loss: 0.2116 - acc: 0.9339
 480/1506 [========>.....................] - ETA: 19s - loss: 0.2098 - acc: 0.9349
 512/1506 [=========>....................] - ETA: 18s - loss: 0.2131 - acc: 0.9343
 544/1506 [=========>....................] - ETA: 18s - loss: 0.2101 - acc: 0.9351
 576/1506 [==========>...................] - ETA: 17s - loss: 0.2104 - acc: 0.9348
 608/1506 [===========>..................] - ETA: 16s - loss: 0.2112 - acc: 0.9353
 640/1506 [===========>..................] - ETA: 16s - loss: 0.2133 - acc: 0.9346
 672/1506 [============>.................] - ETA: 15s - loss: 0.2123 - acc: 0.9346
 704/1506 [=============>................] - ETA: 15s - loss: 0.2161 - acc: 0.9332
 736/1506 [=============>................] - ETA: 14s - loss: 0.2143 - acc: 0.9337
 768/1506 [==============>...............] - ETA: 13s - loss: 0.2136 - acc: 0.9339
 800/1506 [==============>...............] - ETA: 13s - loss: 0.2113 - acc: 0.9344
 832/1506 [===============>..............] - ETA: 12s - loss: 0.2124 - acc: 0.9338
 864/1506 [================>.............] - ETA: 12s - loss: 0.2130 - acc: 0.9337
 896/1506 [================>.............] - ETA: 11s - loss: 0.2115 - acc: 0.9345
 928/1506 [=================>............] - ETA: 10s - loss: 0.2128 - acc: 0.9341
 960/1506 [==================>...........] - ETA: 10s - loss: 0.2123 - acc: 0.9344
 992/1506 [==================>...........] - ETA: 9s - loss: 0.2117 - acc: 0.9348 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.2108 - acc: 0.9350
1056/1506 [====================>.........] - ETA: 8s - loss: 0.2104 - acc: 0.9351
1088/1506 [====================>.........] - ETA: 7s - loss: 0.2106 - acc: 0.9350
1120/1506 [=====================>........] - ETA: 7s - loss: 0.2098 - acc: 0.9352
1152/1506 [=====================>........] - ETA: 6s - loss: 0.2078 - acc: 0.9359
1184/1506 [======================>.......] - ETA: 6s - loss: 0.2083 - acc: 0.9358
1216/1506 [=======================>......] - ETA: 5s - loss: 0.2076 - acc: 0.9358
1248/1506 [=======================>......] - ETA: 4s - loss: 0.2080 - acc: 0.9356
1280/1506 [========================>.....] - ETA: 4s - loss: 0.2072 - acc: 0.9358
1312/1506 [=========================>....] - ETA: 3s - loss: 0.2066 - acc: 0.9360
1344/1506 [=========================>....] - ETA: 3s - loss: 0.2057 - acc: 0.9361
1376/1506 [==========================>...] - ETA: 2s - loss: 0.2055 - acc: 0.9362
1408/1506 [===========================>..] - ETA: 1s - loss: 0.2066 - acc: 0.9358
1440/1506 [===========================>..] - ETA: 1s - loss: 0.2061 - acc: 0.9360
1472/1506 [============================>.] - ETA: 0s - loss: 0.2065 - acc: 0.9354
1504/1506 [============================>.] - ETA: 0s - loss: 0.2056 - acc: 0.9356
1506/1506 [==============================] - 30s 20ms/step - loss: 0.2053 - acc: 0.9357 - val_loss: 0.1882 - val_acc: 0.9379
Epoch 4/70

  32/1506 [..............................] - ETA: 28s - loss: 0.1657 - acc: 0.9542
  64/1506 [>.............................] - ETA: 27s - loss: 0.1747 - acc: 0.9503
  96/1506 [>.............................] - ETA: 26s - loss: 0.2054 - acc: 0.9363
 128/1506 [=>............................] - ETA: 26s - loss: 0.2172 - acc: 0.9328
 160/1506 [==>...........................] - ETA: 25s - loss: 0.2109 - acc: 0.9339
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1984 - acc: 0.9384
 224/1506 [===>..........................] - ETA: 24s - loss: 0.2030 - acc: 0.9376
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1912 - acc: 0.9419
 288/1506 [====>.........................] - ETA: 22s - loss: 0.1899 - acc: 0.9418
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1884 - acc: 0.9429
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1877 - acc: 0.9423
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1792 - acc: 0.9449
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1770 - acc: 0.9459
 448/1506 [=======>......................] - ETA: 19s - loss: 0.1789 - acc: 0.9456
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1788 - acc: 0.9453
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1766 - acc: 0.9463
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1765 - acc: 0.9465
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1746 - acc: 0.9471
 608/1506 [===========>..................] - ETA: 16s - loss: 0.1761 - acc: 0.9460
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1807 - acc: 0.9443
 672/1506 [============>.................] - ETA: 15s - loss: 0.1803 - acc: 0.9440
 704/1506 [=============>................] - ETA: 15s - loss: 0.1834 - acc: 0.9435
 736/1506 [=============>................] - ETA: 14s - loss: 0.1849 - acc: 0.9430
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1825 - acc: 0.9439
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1808 - acc: 0.9439
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1798 - acc: 0.9449
 864/1506 [================>.............] - ETA: 12s - loss: 0.1792 - acc: 0.9450
 896/1506 [================>.............] - ETA: 11s - loss: 0.1791 - acc: 0.9449
 928/1506 [=================>............] - ETA: 10s - loss: 0.1790 - acc: 0.9448
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1790 - acc: 0.9449
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1784 - acc: 0.9450 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1780 - acc: 0.9451
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1777 - acc: 0.9450
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1786 - acc: 0.9446
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1793 - acc: 0.9440
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1782 - acc: 0.9446
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1782 - acc: 0.9443
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1785 - acc: 0.9440
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1775 - acc: 0.9443
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1790 - acc: 0.9443
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1773 - acc: 0.9446
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1793 - acc: 0.9442
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1782 - acc: 0.9445
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1788 - acc: 0.9445
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1778 - acc: 0.9449
1472/1506 [============================>.] - ETA: 0s - loss: 0.1768 - acc: 0.9450
1504/1506 [============================>.] - ETA: 0s - loss: 0.1763 - acc: 0.9451
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1761 - acc: 0.9451 - val_loss: 0.1758 - val_acc: 0.9406
Epoch 5/70

  32/1506 [..............................] - ETA: 27s - loss: 0.2198 - acc: 0.9300
  64/1506 [>.............................] - ETA: 27s - loss: 0.2044 - acc: 0.9342
  96/1506 [>.............................] - ETA: 26s - loss: 0.1744 - acc: 0.9427
 128/1506 [=>............................] - ETA: 26s - loss: 0.1671 - acc: 0.9465
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1609 - acc: 0.9498
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1612 - acc: 0.9498
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1614 - acc: 0.9494
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1546 - acc: 0.9520
 288/1506 [====>.........................] - ETA: 23s - loss: 0.1564 - acc: 0.9515
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1546 - acc: 0.9521
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1531 - acc: 0.9525
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1590 - acc: 0.9500
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1565 - acc: 0.9508
 448/1506 [=======>......................] - ETA: 20s - loss: 0.1559 - acc: 0.9507
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1541 - acc: 0.9510
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1556 - acc: 0.9504
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1543 - acc: 0.9510
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1529 - acc: 0.9516
 608/1506 [===========>..................] - ETA: 17s - loss: 0.1536 - acc: 0.9515
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1560 - acc: 0.9513
 672/1506 [============>.................] - ETA: 15s - loss: 0.1577 - acc: 0.9506
 704/1506 [=============>................] - ETA: 15s - loss: 0.1551 - acc: 0.9517
 736/1506 [=============>................] - ETA: 14s - loss: 0.1553 - acc: 0.9516
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1536 - acc: 0.9522
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1531 - acc: 0.9524
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1531 - acc: 0.9523
 864/1506 [================>.............] - ETA: 12s - loss: 0.1533 - acc: 0.9525
 896/1506 [================>.............] - ETA: 11s - loss: 0.1549 - acc: 0.9519
 928/1506 [=================>............] - ETA: 10s - loss: 0.1544 - acc: 0.9517
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1534 - acc: 0.9522
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1540 - acc: 0.9518 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1547 - acc: 0.9518
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1529 - acc: 0.9525
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1528 - acc: 0.9527
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1530 - acc: 0.9523
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1521 - acc: 0.9528
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1524 - acc: 0.9527
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1522 - acc: 0.9528
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1523 - acc: 0.9528
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1516 - acc: 0.9529
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1521 - acc: 0.9529
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1534 - acc: 0.9525
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1547 - acc: 0.9522
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1561 - acc: 0.9517
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1565 - acc: 0.9514
1472/1506 [============================>.] - ETA: 0s - loss: 0.1576 - acc: 0.9514
1504/1506 [============================>.] - ETA: 0s - loss: 0.1577 - acc: 0.9514
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1576 - acc: 0.9515 - val_loss: 0.1819 - val_acc: 0.9402
Epoch 6/70

  32/1506 [..............................] - ETA: 27s - loss: 0.1952 - acc: 0.9210
  64/1506 [>.............................] - ETA: 26s - loss: 0.1763 - acc: 0.9381
  96/1506 [>.............................] - ETA: 26s - loss: 0.1812 - acc: 0.9341
 128/1506 [=>............................] - ETA: 25s - loss: 0.1708 - acc: 0.9410
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1667 - acc: 0.9421
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1591 - acc: 0.9463
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1555 - acc: 0.9488
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1573 - acc: 0.9495
 288/1506 [====>.........................] - ETA: 22s - loss: 0.1533 - acc: 0.9505
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1499 - acc: 0.9513
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1501 - acc: 0.9516
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1532 - acc: 0.9501
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1522 - acc: 0.9505
 448/1506 [=======>......................] - ETA: 19s - loss: 0.1509 - acc: 0.9513
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1475 - acc: 0.9527
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1462 - acc: 0.9530
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1470 - acc: 0.9526
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1464 - acc: 0.9527
 608/1506 [===========>..................] - ETA: 16s - loss: 0.1443 - acc: 0.9535
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1444 - acc: 0.9533
 672/1506 [============>.................] - ETA: 15s - loss: 0.1416 - acc: 0.9544
 704/1506 [=============>................] - ETA: 15s - loss: 0.1440 - acc: 0.9534
 736/1506 [=============>................] - ETA: 14s - loss: 0.1460 - acc: 0.9525
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1449 - acc: 0.9526
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1415 - acc: 0.9539
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1399 - acc: 0.9548
 864/1506 [================>.............] - ETA: 12s - loss: 0.1377 - acc: 0.9554
 896/1506 [================>.............] - ETA: 11s - loss: 0.1377 - acc: 0.9558
 928/1506 [=================>............] - ETA: 10s - loss: 0.1395 - acc: 0.9557
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1385 - acc: 0.9560
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1377 - acc: 0.9563 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1379 - acc: 0.9560
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1380 - acc: 0.9561
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1364 - acc: 0.9565
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1388 - acc: 0.9557
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1380 - acc: 0.9560
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1393 - acc: 0.9553
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1394 - acc: 0.9553
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1398 - acc: 0.9553
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1402 - acc: 0.9552
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1396 - acc: 0.9554
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1389 - acc: 0.9557
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1392 - acc: 0.9558
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1381 - acc: 0.9562
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1401 - acc: 0.9554
1472/1506 [============================>.] - ETA: 0s - loss: 0.1385 - acc: 0.9561
1504/1506 [============================>.] - ETA: 0s - loss: 0.1403 - acc: 0.9552
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1402 - acc: 0.9552 - val_loss: 0.1791 - val_acc: 0.9430
Computing...
Manual evaluation: (didn't understand why I made this)
True 8144
False 927
True percentage 0.897806195568
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.91      0.79      0.85       438
          O       0.98      0.96      0.97      7318
      B-ORG       0.56      0.79      0.66       296
     B-MISC       0.57      0.06      0.10       141
      B-LOC       0.82      0.63      0.71       218
      I-LOC       0.77      0.73      0.75       141
     I-MISC       0.45      0.19      0.27       154
      I-PER       0.85      0.64      0.73       214
      I-ORG       0.50      0.64      0.56       151

avg / total       0.93      0.90      0.91      9071

F-1 Score:
0.917348079299
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 1674 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 237
OOV word occurences: 324
Padding...
Data padded!
Padding...
Data padded!
Padded until 83 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,992,194
Trainable params: 6,992,194
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1506 samples, validate on 168 samples
Epoch 1/70

  32/1506 [..............................] - ETA: 2:11 - loss: 2.3870 - acc: 0.0059
  64/1506 [>.............................] - ETA: 1:20 - loss: 1.6465 - acc: 0.4098
  96/1506 [>.............................] - ETA: 1:01 - loss: 1.9216 - acc: 0.5373
 128/1506 [=>............................] - ETA: 52s - loss: 1.7229 - acc: 0.5992 
 160/1506 [==>...........................] - ETA: 46s - loss: 1.5535 - acc: 0.6389
 192/1506 [==>...........................] - ETA: 41s - loss: 1.4264 - acc: 0.6668
 224/1506 [===>..........................] - ETA: 38s - loss: 1.3319 - acc: 0.6852
 256/1506 [====>.........................] - ETA: 35s - loss: 1.2721 - acc: 0.6966
 288/1506 [====>.........................] - ETA: 33s - loss: 1.2163 - acc: 0.7059
 320/1506 [=====>........................] - ETA: 31s - loss: 1.1702 - acc: 0.7140
 352/1506 [======>.......................] - ETA: 30s - loss: 1.1420 - acc: 0.7175
 384/1506 [======>.......................] - ETA: 28s - loss: 1.0988 - acc: 0.7265
 416/1506 [=======>......................] - ETA: 27s - loss: 1.0610 - acc: 0.7336
 448/1506 [=======>......................] - ETA: 25s - loss: 1.0348 - acc: 0.7372
 480/1506 [========>.....................] - ETA: 24s - loss: 1.0023 - acc: 0.7435
 512/1506 [=========>....................] - ETA: 23s - loss: 0.9748 - acc: 0.7489
 544/1506 [=========>....................] - ETA: 22s - loss: 0.9473 - acc: 0.7544
 576/1506 [==========>...................] - ETA: 21s - loss: 0.9227 - acc: 0.7603
 608/1506 [===========>..................] - ETA: 20s - loss: 0.9036 - acc: 0.7630
 640/1506 [===========>..................] - ETA: 20s - loss: 0.8859 - acc: 0.7681
 672/1506 [============>.................] - ETA: 19s - loss: 0.8682 - acc: 0.7722
 704/1506 [=============>................] - ETA: 18s - loss: 0.8505 - acc: 0.7756
 736/1506 [=============>................] - ETA: 17s - loss: 0.8323 - acc: 0.7791
 768/1506 [==============>...............] - ETA: 16s - loss: 0.8143 - acc: 0.7837
 800/1506 [==============>...............] - ETA: 15s - loss: 0.7997 - acc: 0.7865
 832/1506 [===============>..............] - ETA: 15s - loss: 0.7879 - acc: 0.7895
 864/1506 [================>.............] - ETA: 14s - loss: 0.7731 - acc: 0.7929
 896/1506 [================>.............] - ETA: 13s - loss: 0.7635 - acc: 0.7942
 928/1506 [=================>............] - ETA: 12s - loss: 0.7540 - acc: 0.7971
 960/1506 [==================>...........] - ETA: 11s - loss: 0.7438 - acc: 0.7992
 992/1506 [==================>...........] - ETA: 11s - loss: 0.7325 - acc: 0.8019
1024/1506 [===================>..........] - ETA: 10s - loss: 0.7209 - acc: 0.8044
1056/1506 [====================>.........] - ETA: 9s - loss: 0.7138 - acc: 0.8054 
1088/1506 [====================>.........] - ETA: 9s - loss: 0.7068 - acc: 0.8070
1120/1506 [=====================>........] - ETA: 8s - loss: 0.6974 - acc: 0.8089
1152/1506 [=====================>........] - ETA: 7s - loss: 0.6888 - acc: 0.8111
1184/1506 [======================>.......] - ETA: 6s - loss: 0.6816 - acc: 0.8128
1216/1506 [=======================>......] - ETA: 6s - loss: 0.6757 - acc: 0.8147
1248/1506 [=======================>......] - ETA: 5s - loss: 0.6668 - acc: 0.8167
1280/1506 [========================>.....] - ETA: 4s - loss: 0.6585 - acc: 0.8191
1312/1506 [=========================>....] - ETA: 4s - loss: 0.6488 - acc: 0.8215
1344/1506 [=========================>....] - ETA: 3s - loss: 0.6414 - acc: 0.8233
1376/1506 [==========================>...] - ETA: 2s - loss: 0.6351 - acc: 0.8249
1408/1506 [===========================>..] - ETA: 2s - loss: 0.6307 - acc: 0.8257
1440/1506 [===========================>..] - ETA: 1s - loss: 0.6247 - acc: 0.8272
1472/1506 [============================>.] - ETA: 0s - loss: 0.6184 - acc: 0.8286
1504/1506 [============================>.] - ETA: 0s - loss: 0.6123 - acc: 0.8300
1506/1506 [==============================] - 33s 22ms/step - loss: 0.6118 - acc: 0.8302 - val_loss: 1.4056 - val_acc: 0.8150
Epoch 2/70

  32/1506 [..............................] - ETA: 28s - loss: 1.4558 - acc: 0.7972
  64/1506 [>.............................] - ETA: 27s - loss: 0.9441 - acc: 0.8404
  96/1506 [>.............................] - ETA: 26s - loss: 0.7646 - acc: 0.8539
 128/1506 [=>............................] - ETA: 26s - loss: 0.6730 - acc: 0.8640
 160/1506 [==>...........................] - ETA: 25s - loss: 0.6147 - acc: 0.8698
 192/1506 [==>...........................] - ETA: 24s - loss: 0.5636 - acc: 0.8774
 224/1506 [===>..........................] - ETA: 24s - loss: 0.5380 - acc: 0.8775
 256/1506 [====>.........................] - ETA: 23s - loss: 0.5093 - acc: 0.8818
 288/1506 [====>.........................] - ETA: 23s - loss: 0.4810 - acc: 0.8871
 320/1506 [=====>........................] - ETA: 22s - loss: 0.4622 - acc: 0.8899
 352/1506 [======>.......................] - ETA: 21s - loss: 0.4489 - acc: 0.8921
 384/1506 [======>.......................] - ETA: 21s - loss: 0.4358 - acc: 0.8938
 416/1506 [=======>......................] - ETA: 20s - loss: 0.4262 - acc: 0.8948
 448/1506 [=======>......................] - ETA: 20s - loss: 0.4194 - acc: 0.8952
 480/1506 [========>.....................] - ETA: 19s - loss: 0.4137 - acc: 0.8953
 512/1506 [=========>....................] - ETA: 18s - loss: 0.4006 - acc: 0.8983
 544/1506 [=========>....................] - ETA: 18s - loss: 0.3931 - acc: 0.8995
 576/1506 [==========>...................] - ETA: 17s - loss: 0.3865 - acc: 0.9002
 608/1506 [===========>..................] - ETA: 17s - loss: 0.3799 - acc: 0.9011
 640/1506 [===========>..................] - ETA: 16s - loss: 0.3829 - acc: 0.8996
 672/1506 [============>.................] - ETA: 15s - loss: 0.3790 - acc: 0.9006
 704/1506 [=============>................] - ETA: 15s - loss: 0.3726 - acc: 0.9017
 736/1506 [=============>................] - ETA: 14s - loss: 0.3682 - acc: 0.9023
 768/1506 [==============>...............] - ETA: 14s - loss: 0.3626 - acc: 0.9036
 800/1506 [==============>...............] - ETA: 13s - loss: 0.3586 - acc: 0.9043
 832/1506 [===============>..............] - ETA: 12s - loss: 0.3553 - acc: 0.9050
 864/1506 [================>.............] - ETA: 12s - loss: 0.3535 - acc: 0.9050
 896/1506 [================>.............] - ETA: 11s - loss: 0.3503 - acc: 0.9054
 928/1506 [=================>............] - ETA: 11s - loss: 0.3495 - acc: 0.9049
 960/1506 [==================>...........] - ETA: 10s - loss: 0.3451 - acc: 0.9059
 992/1506 [==================>...........] - ETA: 9s - loss: 0.3427 - acc: 0.9061 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.3411 - acc: 0.9060
1056/1506 [====================>.........] - ETA: 8s - loss: 0.3403 - acc: 0.9062
1088/1506 [====================>.........] - ETA: 7s - loss: 0.3394 - acc: 0.9058
1120/1506 [=====================>........] - ETA: 7s - loss: 0.3348 - acc: 0.9070
1152/1506 [=====================>........] - ETA: 6s - loss: 0.3348 - acc: 0.9065
1184/1506 [======================>.......] - ETA: 6s - loss: 0.3328 - acc: 0.9069
1216/1506 [=======================>......] - ETA: 5s - loss: 0.3304 - acc: 0.9075
1248/1506 [=======================>......] - ETA: 4s - loss: 0.3277 - acc: 0.9082
1280/1506 [========================>.....] - ETA: 4s - loss: 0.3242 - acc: 0.9090
1312/1506 [=========================>....] - ETA: 3s - loss: 0.3238 - acc: 0.9087
1344/1506 [=========================>....] - ETA: 3s - loss: 0.3214 - acc: 0.9091
1376/1506 [==========================>...] - ETA: 2s - loss: 0.3188 - acc: 0.9096
1408/1506 [===========================>..] - ETA: 1s - loss: 0.3192 - acc: 0.9092
1440/1506 [===========================>..] - ETA: 1s - loss: 0.3180 - acc: 0.9095
1472/1506 [============================>.] - ETA: 0s - loss: 0.3160 - acc: 0.9099
1504/1506 [============================>.] - ETA: 0s - loss: 0.3138 - acc: 0.9105
1506/1506 [==============================] - 30s 20ms/step - loss: 0.3143 - acc: 0.9103 - val_loss: 0.2541 - val_acc: 0.9134
Epoch 3/70

  32/1506 [..............................] - ETA: 28s - loss: 0.3394 - acc: 0.8750
  64/1506 [>.............................] - ETA: 27s - loss: 0.2751 - acc: 0.9056
  96/1506 [>.............................] - ETA: 26s - loss: 0.2562 - acc: 0.9153
 128/1506 [=>............................] - ETA: 26s - loss: 0.2378 - acc: 0.9228
 160/1506 [==>...........................] - ETA: 25s - loss: 0.2386 - acc: 0.9228
 192/1506 [==>...........................] - ETA: 24s - loss: 0.2278 - acc: 0.9263
 224/1506 [===>..........................] - ETA: 24s - loss: 0.2411 - acc: 0.9246
 256/1506 [====>.........................] - ETA: 23s - loss: 0.2427 - acc: 0.9253
 288/1506 [====>.........................] - ETA: 22s - loss: 0.2447 - acc: 0.9236
 320/1506 [=====>........................] - ETA: 22s - loss: 0.2413 - acc: 0.9234
 352/1506 [======>.......................] - ETA: 21s - loss: 0.2365 - acc: 0.9252
 384/1506 [======>.......................] - ETA: 21s - loss: 0.2351 - acc: 0.9262
 416/1506 [=======>......................] - ETA: 20s - loss: 0.2315 - acc: 0.9272
 448/1506 [=======>......................] - ETA: 19s - loss: 0.2328 - acc: 0.9264
 480/1506 [========>.....................] - ETA: 19s - loss: 0.2348 - acc: 0.9258
 512/1506 [=========>....................] - ETA: 18s - loss: 0.2309 - acc: 0.9274
 544/1506 [=========>....................] - ETA: 18s - loss: 0.2347 - acc: 0.9261
 576/1506 [==========>...................] - ETA: 17s - loss: 0.2348 - acc: 0.9262
 608/1506 [===========>..................] - ETA: 16s - loss: 0.2341 - acc: 0.9257
 640/1506 [===========>..................] - ETA: 16s - loss: 0.2355 - acc: 0.9248
 672/1506 [============>.................] - ETA: 15s - loss: 0.2362 - acc: 0.9247
 704/1506 [=============>................] - ETA: 15s - loss: 0.2329 - acc: 0.9260
 736/1506 [=============>................] - ETA: 14s - loss: 0.2320 - acc: 0.9270
 768/1506 [==============>...............] - ETA: 13s - loss: 0.2293 - acc: 0.9277
 800/1506 [==============>...............] - ETA: 13s - loss: 0.2301 - acc: 0.9274
 832/1506 [===============>..............] - ETA: 12s - loss: 0.2290 - acc: 0.9280
 864/1506 [================>.............] - ETA: 12s - loss: 0.2273 - acc: 0.9287
 896/1506 [================>.............] - ETA: 11s - loss: 0.2282 - acc: 0.9279
 928/1506 [=================>............] - ETA: 10s - loss: 0.2265 - acc: 0.9287
 960/1506 [==================>...........] - ETA: 10s - loss: 0.2243 - acc: 0.9294
 992/1506 [==================>...........] - ETA: 9s - loss: 0.2239 - acc: 0.9295 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.2256 - acc: 0.9291
1056/1506 [====================>.........] - ETA: 8s - loss: 0.2267 - acc: 0.9289
1088/1506 [====================>.........] - ETA: 7s - loss: 0.2257 - acc: 0.9295
1120/1506 [=====================>........] - ETA: 7s - loss: 0.2250 - acc: 0.9292
1152/1506 [=====================>........] - ETA: 6s - loss: 0.2232 - acc: 0.9301
1184/1506 [======================>.......] - ETA: 6s - loss: 0.2223 - acc: 0.9304
1216/1506 [=======================>......] - ETA: 5s - loss: 0.2228 - acc: 0.9301
1248/1506 [=======================>......] - ETA: 4s - loss: 0.2236 - acc: 0.9299
1280/1506 [========================>.....] - ETA: 4s - loss: 0.2231 - acc: 0.9301
1312/1506 [=========================>....] - ETA: 3s - loss: 0.2215 - acc: 0.9307
1344/1506 [=========================>....] - ETA: 3s - loss: 0.2216 - acc: 0.9306
1376/1506 [==========================>...] - ETA: 2s - loss: 0.2226 - acc: 0.9301
1408/1506 [===========================>..] - ETA: 1s - loss: 0.2215 - acc: 0.9306
1440/1506 [===========================>..] - ETA: 1s - loss: 0.2226 - acc: 0.9299
1472/1506 [============================>.] - ETA: 0s - loss: 0.2220 - acc: 0.9300
1504/1506 [============================>.] - ETA: 0s - loss: 0.2215 - acc: 0.9303
1506/1506 [==============================] - 30s 20ms/step - loss: 0.2214 - acc: 0.9303 - val_loss: 0.1839 - val_acc: 0.9372
Epoch 4/70

  32/1506 [..............................] - ETA: 27s - loss: 0.1858 - acc: 0.9409
  64/1506 [>.............................] - ETA: 27s - loss: 0.2323 - acc: 0.9239
  96/1506 [>.............................] - ETA: 26s - loss: 0.2098 - acc: 0.9313
 128/1506 [=>............................] - ETA: 25s - loss: 0.1967 - acc: 0.9382
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1901 - acc: 0.9407
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1922 - acc: 0.9397
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1928 - acc: 0.9401
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1955 - acc: 0.9385
 288/1506 [====>.........................] - ETA: 22s - loss: 0.1985 - acc: 0.9371
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1985 - acc: 0.9373
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1970 - acc: 0.9393
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1938 - acc: 0.9394
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1928 - acc: 0.9399
 448/1506 [=======>......................] - ETA: 19s - loss: 0.1939 - acc: 0.9395
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1972 - acc: 0.9381
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1987 - acc: 0.9372
 544/1506 [=========>....................] - ETA: 18s - loss: 0.2021 - acc: 0.9364
 576/1506 [==========>...................] - ETA: 17s - loss: 0.2001 - acc: 0.9366
 608/1506 [===========>..................] - ETA: 16s - loss: 0.1996 - acc: 0.9374
 640/1506 [===========>..................] - ETA: 16s - loss: 0.2003 - acc: 0.9371
 672/1506 [============>.................] - ETA: 15s - loss: 0.1998 - acc: 0.9366
 704/1506 [=============>................] - ETA: 15s - loss: 0.2022 - acc: 0.9359
 736/1506 [=============>................] - ETA: 14s - loss: 0.1995 - acc: 0.9370
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1980 - acc: 0.9376
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1944 - acc: 0.9392
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1940 - acc: 0.9390
 864/1506 [================>.............] - ETA: 12s - loss: 0.1977 - acc: 0.9382
 896/1506 [================>.............] - ETA: 11s - loss: 0.1960 - acc: 0.9386
 928/1506 [=================>............] - ETA: 10s - loss: 0.1976 - acc: 0.9383
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1962 - acc: 0.9388
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1944 - acc: 0.9396 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1921 - acc: 0.9403
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1906 - acc: 0.9405
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1910 - acc: 0.9405
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1894 - acc: 0.9406
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1891 - acc: 0.9407
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1896 - acc: 0.9405
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1895 - acc: 0.9407
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1885 - acc: 0.9411
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1875 - acc: 0.9415
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1884 - acc: 0.9409
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1900 - acc: 0.9403
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1893 - acc: 0.9407
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1895 - acc: 0.9407
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1888 - acc: 0.9409
1472/1506 [============================>.] - ETA: 0s - loss: 0.1879 - acc: 0.9413
1504/1506 [============================>.] - ETA: 0s - loss: 0.1880 - acc: 0.9413
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1881 - acc: 0.9412 - val_loss: 0.1674 - val_acc: 0.9462
Epoch 5/70

  32/1506 [..............................] - ETA: 27s - loss: 0.1321 - acc: 0.9600
  64/1506 [>.............................] - ETA: 27s - loss: 0.1626 - acc: 0.9520
  96/1506 [>.............................] - ETA: 26s - loss: 0.1632 - acc: 0.9506
 128/1506 [=>............................] - ETA: 25s - loss: 0.1562 - acc: 0.9502
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1506 - acc: 0.9522
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1520 - acc: 0.9500
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1561 - acc: 0.9501
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1627 - acc: 0.9472
 288/1506 [====>.........................] - ETA: 22s - loss: 0.1662 - acc: 0.9473
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1616 - acc: 0.9498
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1621 - acc: 0.9484
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1611 - acc: 0.9489
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1572 - acc: 0.9500
 448/1506 [=======>......................] - ETA: 19s - loss: 0.1556 - acc: 0.9502
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1638 - acc: 0.9486
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1629 - acc: 0.9487
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1619 - acc: 0.9492
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1637 - acc: 0.9489
 608/1506 [===========>..................] - ETA: 16s - loss: 0.1632 - acc: 0.9495
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1659 - acc: 0.9489
 672/1506 [============>.................] - ETA: 15s - loss: 0.1638 - acc: 0.9497
 704/1506 [=============>................] - ETA: 15s - loss: 0.1655 - acc: 0.9495
 736/1506 [=============>................] - ETA: 14s - loss: 0.1668 - acc: 0.9486
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1649 - acc: 0.9494
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1649 - acc: 0.9494
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1650 - acc: 0.9494
 864/1506 [================>.............] - ETA: 12s - loss: 0.1667 - acc: 0.9489
 896/1506 [================>.............] - ETA: 11s - loss: 0.1673 - acc: 0.9484
 928/1506 [=================>............] - ETA: 10s - loss: 0.1688 - acc: 0.9480
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1688 - acc: 0.9478
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1676 - acc: 0.9479 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1661 - acc: 0.9482
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1653 - acc: 0.9484
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1657 - acc: 0.9484
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1659 - acc: 0.9483
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1663 - acc: 0.9483
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1674 - acc: 0.9479
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1684 - acc: 0.9474
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1676 - acc: 0.9475
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1683 - acc: 0.9470
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1670 - acc: 0.9475
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1663 - acc: 0.9479
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1665 - acc: 0.9477
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1669 - acc: 0.9477
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1681 - acc: 0.9474
1472/1506 [============================>.] - ETA: 0s - loss: 0.1684 - acc: 0.9473
1504/1506 [============================>.] - ETA: 0s - loss: 0.1683 - acc: 0.9471
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1684 - acc: 0.9470 - val_loss: 0.2482 - val_acc: 0.9157
Epoch 6/70

  32/1506 [..............................] - ETA: 28s - loss: 0.2443 - acc: 0.9070
  64/1506 [>.............................] - ETA: 27s - loss: 0.1684 - acc: 0.9426
  96/1506 [>.............................] - ETA: 26s - loss: 0.1705 - acc: 0.9406
 128/1506 [=>............................] - ETA: 25s - loss: 0.1769 - acc: 0.9403
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1647 - acc: 0.9462
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1652 - acc: 0.9474
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1770 - acc: 0.9426
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1677 - acc: 0.9455
 288/1506 [====>.........................] - ETA: 22s - loss: 0.1662 - acc: 0.9454
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1679 - acc: 0.9457
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1641 - acc: 0.9473
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1648 - acc: 0.9470
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1634 - acc: 0.9470
 448/1506 [=======>......................] - ETA: 19s - loss: 0.1617 - acc: 0.9473
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1612 - acc: 0.9467
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1639 - acc: 0.9456
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1639 - acc: 0.9461
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1650 - acc: 0.9454
 608/1506 [===========>..................] - ETA: 16s - loss: 0.1630 - acc: 0.9465
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1624 - acc: 0.9473
 672/1506 [============>.................] - ETA: 15s - loss: 0.1648 - acc: 0.9468
 704/1506 [=============>................] - ETA: 15s - loss: 0.1623 - acc: 0.9475
 736/1506 [=============>................] - ETA: 14s - loss: 0.1622 - acc: 0.9476
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1620 - acc: 0.9478
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1595 - acc: 0.9486
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1592 - acc: 0.9492
 864/1506 [================>.............] - ETA: 12s - loss: 0.1594 - acc: 0.9495
 896/1506 [================>.............] - ETA: 11s - loss: 0.1594 - acc: 0.9494
 928/1506 [=================>............] - ETA: 10s - loss: 0.1577 - acc: 0.9498
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1556 - acc: 0.9506
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1546 - acc: 0.9509 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1551 - acc: 0.9508
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1546 - acc: 0.9511
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1543 - acc: 0.9511
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1546 - acc: 0.9512
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1529 - acc: 0.9518
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1523 - acc: 0.9521
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1537 - acc: 0.9517
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1541 - acc: 0.9513
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1541 - acc: 0.9514
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1536 - acc: 0.9518
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1536 - acc: 0.9519
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1531 - acc: 0.9521
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1540 - acc: 0.9521
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1538 - acc: 0.9522
1472/1506 [============================>.] - ETA: 0s - loss: 0.1532 - acc: 0.9524
1504/1506 [============================>.] - ETA: 0s - loss: 0.1521 - acc: 0.9527
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1520 - acc: 0.9528 - val_loss: 0.2268 - val_acc: 0.9267
Computing...
Manual evaluation: (didn't understand why I made this)
True 7930
False 1141
True percentage 0.87421452982
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.90      0.76      0.82       438
          O       0.98      0.96      0.97      7318
      B-LOC       0.40      0.89      0.55       218
      I-LOC       0.32      0.91      0.47       141
      I-PER       0.90      0.57      0.70       214
      B-ORG       0.88      0.39      0.54       296
      I-ORG       0.62      0.17      0.26       151
     B-MISC       0.23      0.05      0.08       141
     I-MISC       0.42      0.12      0.18       154

avg / total       0.92      0.87      0.88      9071

F-1 Score:
0.893369386316
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 1674 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 237
OOV word occurences: 324
Padding...
Data padded!
Padding...
Data padded!
Padded until 83 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,992,194
Trainable params: 6,992,194
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1506 samples, validate on 168 samples
Epoch 1/70

  32/1506 [..............................] - ETA: 2:10 - loss: 2.4357 - acc: 0.0312
  64/1506 [>.............................] - ETA: 1:19 - loss: 1.6911 - acc: 0.4178
  96/1506 [>.............................] - ETA: 1:01 - loss: 2.1649 - acc: 0.5318
 128/1506 [=>............................] - ETA: 52s - loss: 1.8401 - acc: 0.6117 
 160/1506 [==>...........................] - ETA: 46s - loss: 1.6821 - acc: 0.6430
 192/1506 [==>...........................] - ETA: 41s - loss: 1.5332 - acc: 0.6713
 224/1506 [===>..........................] - ETA: 38s - loss: 1.4248 - acc: 0.6898
 256/1506 [====>.........................] - ETA: 35s - loss: 1.3223 - acc: 0.7096
 288/1506 [====>.........................] - ETA: 33s - loss: 1.2580 - acc: 0.7189
 320/1506 [=====>........................] - ETA: 31s - loss: 1.2019 - acc: 0.7267
 352/1506 [======>.......................] - ETA: 30s - loss: 1.1467 - acc: 0.7358
 384/1506 [======>.......................] - ETA: 28s - loss: 1.0984 - acc: 0.7436
 416/1506 [=======>......................] - ETA: 27s - loss: 1.0602 - acc: 0.7482
 448/1506 [=======>......................] - ETA: 26s - loss: 1.0150 - acc: 0.7576
 480/1506 [========>.....................] - ETA: 25s - loss: 0.9770 - acc: 0.7645
 512/1506 [=========>....................] - ETA: 24s - loss: 0.9529 - acc: 0.7679
 544/1506 [=========>....................] - ETA: 23s - loss: 0.9208 - acc: 0.7746
 576/1506 [==========>...................] - ETA: 22s - loss: 0.8970 - acc: 0.7794
 608/1506 [===========>..................] - ETA: 21s - loss: 0.8791 - acc: 0.7836
 640/1506 [===========>..................] - ETA: 20s - loss: 0.8620 - acc: 0.7865
 672/1506 [============>.................] - ETA: 19s - loss: 0.8484 - acc: 0.7883
 704/1506 [=============>................] - ETA: 18s - loss: 0.8295 - acc: 0.7915
 736/1506 [=============>................] - ETA: 17s - loss: 0.8124 - acc: 0.7945
 768/1506 [==============>...............] - ETA: 16s - loss: 0.7978 - acc: 0.7972
 800/1506 [==============>...............] - ETA: 15s - loss: 0.7798 - acc: 0.8011
 832/1506 [===============>..............] - ETA: 15s - loss: 0.7718 - acc: 0.8018
 864/1506 [================>.............] - ETA: 14s - loss: 0.7589 - acc: 0.8052
 896/1506 [================>.............] - ETA: 13s - loss: 0.7479 - acc: 0.8077
 928/1506 [=================>............] - ETA: 12s - loss: 0.7356 - acc: 0.8103
 960/1506 [==================>...........] - ETA: 12s - loss: 0.7256 - acc: 0.8124
 992/1506 [==================>...........] - ETA: 11s - loss: 0.7139 - acc: 0.8146
1024/1506 [===================>..........] - ETA: 10s - loss: 0.7035 - acc: 0.8175
1056/1506 [====================>.........] - ETA: 9s - loss: 0.6930 - acc: 0.8195 
1088/1506 [====================>.........] - ETA: 9s - loss: 0.6828 - acc: 0.8222
1120/1506 [=====================>........] - ETA: 8s - loss: 0.6771 - acc: 0.8228
1152/1506 [=====================>........] - ETA: 7s - loss: 0.6729 - acc: 0.8233
1184/1506 [======================>.......] - ETA: 6s - loss: 0.6629 - acc: 0.8260
1216/1506 [=======================>......] - ETA: 6s - loss: 0.6546 - acc: 0.8275
1248/1506 [=======================>......] - ETA: 5s - loss: 0.6506 - acc: 0.8273
1280/1506 [========================>.....] - ETA: 4s - loss: 0.6433 - acc: 0.8286
1312/1506 [=========================>....] - ETA: 4s - loss: 0.6348 - acc: 0.8306
1344/1506 [=========================>....] - ETA: 3s - loss: 0.6286 - acc: 0.8317
1376/1506 [==========================>...] - ETA: 2s - loss: 0.6240 - acc: 0.8321
1408/1506 [===========================>..] - ETA: 2s - loss: 0.6164 - acc: 0.8339
1440/1506 [===========================>..] - ETA: 1s - loss: 0.6096 - acc: 0.8354
1472/1506 [============================>.] - ETA: 0s - loss: 0.6024 - acc: 0.8372
1504/1506 [============================>.] - ETA: 0s - loss: 0.5971 - acc: 0.8379
1506/1506 [==============================] - 33s 22ms/step - loss: 0.5966 - acc: 0.8381 - val_loss: 0.3784 - val_acc: 0.8923
Epoch 2/70

  32/1506 [..............................] - ETA: 27s - loss: 0.4352 - acc: 0.8841
  64/1506 [>.............................] - ETA: 27s - loss: 0.3968 - acc: 0.8843
  96/1506 [>.............................] - ETA: 26s - loss: 0.3961 - acc: 0.8855
 128/1506 [=>............................] - ETA: 26s - loss: 0.3784 - acc: 0.8905
 160/1506 [==>...........................] - ETA: 25s - loss: 0.3622 - acc: 0.8949
 192/1506 [==>...........................] - ETA: 25s - loss: 0.3511 - acc: 0.8977
 224/1506 [===>..........................] - ETA: 24s - loss: 0.3386 - acc: 0.9014
 256/1506 [====>.........................] - ETA: 23s - loss: 0.3358 - acc: 0.9025
 288/1506 [====>.........................] - ETA: 23s - loss: 0.3428 - acc: 0.8999
 320/1506 [=====>........................] - ETA: 22s - loss: 0.3372 - acc: 0.9014
 352/1506 [======>.......................] - ETA: 22s - loss: 0.3294 - acc: 0.9039
 384/1506 [======>.......................] - ETA: 21s - loss: 0.3225 - acc: 0.9067
 416/1506 [=======>......................] - ETA: 20s - loss: 0.3219 - acc: 0.9065
 448/1506 [=======>......................] - ETA: 20s - loss: 0.3177 - acc: 0.9076
 480/1506 [========>.....................] - ETA: 19s - loss: 0.3113 - acc: 0.9093
 512/1506 [=========>....................] - ETA: 18s - loss: 0.3076 - acc: 0.9103
 544/1506 [=========>....................] - ETA: 18s - loss: 0.3001 - acc: 0.9120
 576/1506 [==========>...................] - ETA: 17s - loss: 0.3006 - acc: 0.9113
 608/1506 [===========>..................] - ETA: 17s - loss: 0.2976 - acc: 0.9122
 640/1506 [===========>..................] - ETA: 16s - loss: 0.2962 - acc: 0.9131
 672/1506 [============>.................] - ETA: 15s - loss: 0.2930 - acc: 0.9139
 704/1506 [=============>................] - ETA: 15s - loss: 0.2935 - acc: 0.9133
 736/1506 [=============>................] - ETA: 14s - loss: 0.2916 - acc: 0.9138
 768/1506 [==============>...............] - ETA: 14s - loss: 0.2913 - acc: 0.9135
 800/1506 [==============>...............] - ETA: 13s - loss: 0.2927 - acc: 0.9127
 832/1506 [===============>..............] - ETA: 12s - loss: 0.2924 - acc: 0.9128
 864/1506 [================>.............] - ETA: 12s - loss: 0.2928 - acc: 0.9124
 896/1506 [================>.............] - ETA: 11s - loss: 0.2938 - acc: 0.9118
 928/1506 [=================>............] - ETA: 10s - loss: 0.2917 - acc: 0.9125
 960/1506 [==================>...........] - ETA: 10s - loss: 0.2916 - acc: 0.9125
 992/1506 [==================>...........] - ETA: 9s - loss: 0.2907 - acc: 0.9128 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.2887 - acc: 0.9132
1056/1506 [====================>.........] - ETA: 8s - loss: 0.2895 - acc: 0.9134
1088/1506 [====================>.........] - ETA: 7s - loss: 0.2874 - acc: 0.9142
1120/1506 [=====================>........] - ETA: 7s - loss: 0.2850 - acc: 0.9150
1152/1506 [=====================>........] - ETA: 6s - loss: 0.2849 - acc: 0.9146
1184/1506 [======================>.......] - ETA: 6s - loss: 0.2828 - acc: 0.9153
1216/1506 [=======================>......] - ETA: 5s - loss: 0.2810 - acc: 0.9157
1248/1506 [=======================>......] - ETA: 4s - loss: 0.2790 - acc: 0.9162
1280/1506 [========================>.....] - ETA: 4s - loss: 0.2785 - acc: 0.9163
1312/1506 [=========================>....] - ETA: 3s - loss: 0.2775 - acc: 0.9162
1344/1506 [=========================>....] - ETA: 3s - loss: 0.2761 - acc: 0.9166
1376/1506 [==========================>...] - ETA: 2s - loss: 0.2746 - acc: 0.9169
1408/1506 [===========================>..] - ETA: 1s - loss: 0.2733 - acc: 0.9172
1440/1506 [===========================>..] - ETA: 1s - loss: 0.2736 - acc: 0.9171
1472/1506 [============================>.] - ETA: 0s - loss: 0.2725 - acc: 0.9174
1504/1506 [============================>.] - ETA: 0s - loss: 0.2713 - acc: 0.9175
1506/1506 [==============================] - 30s 20ms/step - loss: 0.2716 - acc: 0.9175 - val_loss: 0.5632 - val_acc: 0.8372
Epoch 3/70

  32/1506 [..............................] - ETA: 27s - loss: 0.5182 - acc: 0.8426
  64/1506 [>.............................] - ETA: 27s - loss: 0.3881 - acc: 0.8887
  96/1506 [>.............................] - ETA: 26s - loss: 0.3314 - acc: 0.9050
 128/1506 [=>............................] - ETA: 25s - loss: 0.2919 - acc: 0.9170
 160/1506 [==>...........................] - ETA: 25s - loss: 0.2811 - acc: 0.9180
 192/1506 [==>...........................] - ETA: 24s - loss: 0.2714 - acc: 0.9189
 224/1506 [===>..........................] - ETA: 24s - loss: 0.2662 - acc: 0.9199
 256/1506 [====>.........................] - ETA: 23s - loss: 0.2705 - acc: 0.9202
 288/1506 [====>.........................] - ETA: 23s - loss: 0.2614 - acc: 0.9235
 320/1506 [=====>........................] - ETA: 22s - loss: 0.2533 - acc: 0.9259
 352/1506 [======>.......................] - ETA: 21s - loss: 0.2477 - acc: 0.9264
 384/1506 [======>.......................] - ETA: 21s - loss: 0.2446 - acc: 0.9274
 416/1506 [=======>......................] - ETA: 20s - loss: 0.2398 - acc: 0.9287
 448/1506 [=======>......................] - ETA: 19s - loss: 0.2406 - acc: 0.9281
 480/1506 [========>.....................] - ETA: 19s - loss: 0.2368 - acc: 0.9301
 512/1506 [=========>....................] - ETA: 18s - loss: 0.2421 - acc: 0.9285
 544/1506 [=========>....................] - ETA: 18s - loss: 0.2405 - acc: 0.9287
 576/1506 [==========>...................] - ETA: 17s - loss: 0.2376 - acc: 0.9297
 608/1506 [===========>..................] - ETA: 16s - loss: 0.2345 - acc: 0.9301
 640/1506 [===========>..................] - ETA: 16s - loss: 0.2323 - acc: 0.9305
 672/1506 [============>.................] - ETA: 15s - loss: 0.2339 - acc: 0.9296
 704/1506 [=============>................] - ETA: 15s - loss: 0.2324 - acc: 0.9301
 736/1506 [=============>................] - ETA: 14s - loss: 0.2326 - acc: 0.9302
 768/1506 [==============>...............] - ETA: 13s - loss: 0.2335 - acc: 0.9295
 800/1506 [==============>...............] - ETA: 13s - loss: 0.2322 - acc: 0.9302
 832/1506 [===============>..............] - ETA: 12s - loss: 0.2309 - acc: 0.9301
 864/1506 [================>.............] - ETA: 12s - loss: 0.2297 - acc: 0.9304
 896/1506 [================>.............] - ETA: 11s - loss: 0.2270 - acc: 0.9312
 928/1506 [=================>............] - ETA: 10s - loss: 0.2263 - acc: 0.9313
 960/1506 [==================>...........] - ETA: 10s - loss: 0.2263 - acc: 0.9312
 992/1506 [==================>...........] - ETA: 9s - loss: 0.2247 - acc: 0.9316 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.2239 - acc: 0.9317
1056/1506 [====================>.........] - ETA: 8s - loss: 0.2233 - acc: 0.9318
1088/1506 [====================>.........] - ETA: 7s - loss: 0.2225 - acc: 0.9316
1120/1506 [=====================>........] - ETA: 7s - loss: 0.2212 - acc: 0.9321
1152/1506 [=====================>........] - ETA: 6s - loss: 0.2217 - acc: 0.9315
1184/1506 [======================>.......] - ETA: 6s - loss: 0.2200 - acc: 0.9321
1216/1506 [=======================>......] - ETA: 5s - loss: 0.2190 - acc: 0.9324
1248/1506 [=======================>......] - ETA: 4s - loss: 0.2182 - acc: 0.9323
1280/1506 [========================>.....] - ETA: 4s - loss: 0.2174 - acc: 0.9324
1312/1506 [=========================>....] - ETA: 3s - loss: 0.2152 - acc: 0.9334
1344/1506 [=========================>....] - ETA: 3s - loss: 0.2142 - acc: 0.9337
1376/1506 [==========================>...] - ETA: 2s - loss: 0.2144 - acc: 0.9338
1408/1506 [===========================>..] - ETA: 1s - loss: 0.2143 - acc: 0.9339
1440/1506 [===========================>..] - ETA: 1s - loss: 0.2151 - acc: 0.9340
1472/1506 [============================>.] - ETA: 0s - loss: 0.2136 - acc: 0.9345
1504/1506 [============================>.] - ETA: 0s - loss: 0.2149 - acc: 0.9341
1506/1506 [==============================] - 30s 20ms/step - loss: 0.2146 - acc: 0.9341 - val_loss: 0.2301 - val_acc: 0.9298
Epoch 4/70

  32/1506 [..............................] - ETA: 27s - loss: 0.1910 - acc: 0.9372
  64/1506 [>.............................] - ETA: 27s - loss: 0.1426 - acc: 0.9548
  96/1506 [>.............................] - ETA: 26s - loss: 0.1423 - acc: 0.9561
 128/1506 [=>............................] - ETA: 25s - loss: 0.1713 - acc: 0.9500
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1702 - acc: 0.9477
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1650 - acc: 0.9488
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1680 - acc: 0.9473
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1681 - acc: 0.9474
 288/1506 [====>.........................] - ETA: 23s - loss: 0.1719 - acc: 0.9458
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1729 - acc: 0.9458
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1743 - acc: 0.9456
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1754 - acc: 0.9453
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1806 - acc: 0.9435
 448/1506 [=======>......................] - ETA: 20s - loss: 0.1795 - acc: 0.9445
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1777 - acc: 0.9446
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1801 - acc: 0.9432
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1827 - acc: 0.9428
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1813 - acc: 0.9430
 608/1506 [===========>..................] - ETA: 17s - loss: 0.1811 - acc: 0.9435
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1793 - acc: 0.9442
 672/1506 [============>.................] - ETA: 15s - loss: 0.1774 - acc: 0.9450
 704/1506 [=============>................] - ETA: 15s - loss: 0.1779 - acc: 0.9451
 736/1506 [=============>................] - ETA: 14s - loss: 0.1745 - acc: 0.9464
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1756 - acc: 0.9465
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1765 - acc: 0.9462
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1770 - acc: 0.9462
 864/1506 [================>.............] - ETA: 12s - loss: 0.1775 - acc: 0.9461
 896/1506 [================>.............] - ETA: 11s - loss: 0.1785 - acc: 0.9460
 928/1506 [=================>............] - ETA: 10s - loss: 0.1771 - acc: 0.9467
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1764 - acc: 0.9468
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1771 - acc: 0.9464 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1776 - acc: 0.9460
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1781 - acc: 0.9458
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1802 - acc: 0.9452
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1796 - acc: 0.9453
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1822 - acc: 0.9443
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1818 - acc: 0.9442
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1810 - acc: 0.9442
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1794 - acc: 0.9447
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1797 - acc: 0.9446
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1803 - acc: 0.9441
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1792 - acc: 0.9444
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1795 - acc: 0.9445
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1780 - acc: 0.9450
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1790 - acc: 0.9446
1472/1506 [============================>.] - ETA: 0s - loss: 0.1786 - acc: 0.9446
1504/1506 [============================>.] - ETA: 0s - loss: 0.1789 - acc: 0.9448
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1789 - acc: 0.9447 - val_loss: 0.2285 - val_acc: 0.9296
Epoch 5/70

  32/1506 [..............................] - ETA: 28s - loss: 0.1499 - acc: 0.9384
  64/1506 [>.............................] - ETA: 27s - loss: 0.1671 - acc: 0.9459
  96/1506 [>.............................] - ETA: 26s - loss: 0.1710 - acc: 0.9477
 128/1506 [=>............................] - ETA: 26s - loss: 0.1877 - acc: 0.9445
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1805 - acc: 0.9469
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1866 - acc: 0.9447
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1809 - acc: 0.9458
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1795 - acc: 0.9458
 288/1506 [====>.........................] - ETA: 23s - loss: 0.1698 - acc: 0.9494
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1622 - acc: 0.9516
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1615 - acc: 0.9520
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1575 - acc: 0.9526
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1538 - acc: 0.9535
 448/1506 [=======>......................] - ETA: 20s - loss: 0.1540 - acc: 0.9532
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1535 - acc: 0.9534
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1505 - acc: 0.9545
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1511 - acc: 0.9546
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1497 - acc: 0.9551
 608/1506 [===========>..................] - ETA: 17s - loss: 0.1486 - acc: 0.9553
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1475 - acc: 0.9556
 672/1506 [============>.................] - ETA: 15s - loss: 0.1544 - acc: 0.9534
 704/1506 [=============>................] - ETA: 15s - loss: 0.1536 - acc: 0.9533
 736/1506 [=============>................] - ETA: 14s - loss: 0.1536 - acc: 0.9532
 768/1506 [==============>...............] - ETA: 14s - loss: 0.1557 - acc: 0.9525
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1541 - acc: 0.9529
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1543 - acc: 0.9528
 864/1506 [================>.............] - ETA: 12s - loss: 0.1556 - acc: 0.9523
 896/1506 [================>.............] - ETA: 11s - loss: 0.1568 - acc: 0.9522
 928/1506 [=================>............] - ETA: 10s - loss: 0.1582 - acc: 0.9517
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1576 - acc: 0.9518
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1579 - acc: 0.9515 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1579 - acc: 0.9514
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1580 - acc: 0.9510
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1584 - acc: 0.9510
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1568 - acc: 0.9518
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1581 - acc: 0.9512
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1573 - acc: 0.9513
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1572 - acc: 0.9514
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1560 - acc: 0.9517
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1572 - acc: 0.9514
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1574 - acc: 0.9512
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1565 - acc: 0.9516
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1567 - acc: 0.9517
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1570 - acc: 0.9517
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1565 - acc: 0.9518
1472/1506 [============================>.] - ETA: 0s - loss: 0.1566 - acc: 0.9517
1504/1506 [============================>.] - ETA: 0s - loss: 0.1561 - acc: 0.9520
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1561 - acc: 0.9520 - val_loss: 0.2101 - val_acc: 0.9380
Epoch 6/70

  32/1506 [..............................] - ETA: 27s - loss: 0.1708 - acc: 0.9578
  64/1506 [>.............................] - ETA: 27s - loss: 0.1665 - acc: 0.9526
  96/1506 [>.............................] - ETA: 26s - loss: 0.1499 - acc: 0.9570
 128/1506 [=>............................] - ETA: 26s - loss: 0.1684 - acc: 0.9536
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1668 - acc: 0.9525
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1604 - acc: 0.9535
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1500 - acc: 0.9572
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1551 - acc: 0.9562
 288/1506 [====>.........................] - ETA: 23s - loss: 0.1534 - acc: 0.9562
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1589 - acc: 0.9547
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1561 - acc: 0.9552
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1558 - acc: 0.9549
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1539 - acc: 0.9540
 448/1506 [=======>......................] - ETA: 20s - loss: 0.1525 - acc: 0.9552
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1529 - acc: 0.9546
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1525 - acc: 0.9541
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1503 - acc: 0.9546
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1503 - acc: 0.9552
 608/1506 [===========>..................] - ETA: 16s - loss: 0.1486 - acc: 0.9555
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1513 - acc: 0.9544
 672/1506 [============>.................] - ETA: 15s - loss: 0.1520 - acc: 0.9542
 704/1506 [=============>................] - ETA: 15s - loss: 0.1512 - acc: 0.9543
 736/1506 [=============>................] - ETA: 14s - loss: 0.1497 - acc: 0.9547
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1497 - acc: 0.9544
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1475 - acc: 0.9551
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1491 - acc: 0.9544
 864/1506 [================>.............] - ETA: 12s - loss: 0.1482 - acc: 0.9548
 896/1506 [================>.............] - ETA: 11s - loss: 0.1486 - acc: 0.9544
 928/1506 [=================>............] - ETA: 10s - loss: 0.1462 - acc: 0.9551
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1459 - acc: 0.9551
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1452 - acc: 0.9551 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1437 - acc: 0.9554
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1433 - acc: 0.9559
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1426 - acc: 0.9564
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1427 - acc: 0.9562
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1421 - acc: 0.9563
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1436 - acc: 0.9560
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1439 - acc: 0.9554
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1432 - acc: 0.9555
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1428 - acc: 0.9558
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1411 - acc: 0.9564
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1399 - acc: 0.9567
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1400 - acc: 0.9566
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1389 - acc: 0.9570
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1411 - acc: 0.9561
1472/1506 [============================>.] - ETA: 0s - loss: 0.1404 - acc: 0.9563
1504/1506 [============================>.] - ETA: 0s - loss: 0.1405 - acc: 0.9564
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1404 - acc: 0.9564 - val_loss: 0.2373 - val_acc: 0.9330
Epoch 7/70

  32/1506 [..............................] - ETA: 28s - loss: 0.1549 - acc: 0.9564
  64/1506 [>.............................] - ETA: 27s - loss: 0.1665 - acc: 0.9534
  96/1506 [>.............................] - ETA: 26s - loss: 0.1557 - acc: 0.9577
 128/1506 [=>............................] - ETA: 26s - loss: 0.1463 - acc: 0.9608
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1492 - acc: 0.9583
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1423 - acc: 0.9599
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1354 - acc: 0.9619
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1378 - acc: 0.9594
 288/1506 [====>.........................] - ETA: 23s - loss: 0.1408 - acc: 0.9593
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1353 - acc: 0.9613
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1293 - acc: 0.9636
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1360 - acc: 0.9607
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1342 - acc: 0.9607
 448/1506 [=======>......................] - ETA: 20s - loss: 0.1373 - acc: 0.9589
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1338 - acc: 0.9602
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1343 - acc: 0.9601
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1324 - acc: 0.9608
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1329 - acc: 0.9608
 608/1506 [===========>..................] - ETA: 17s - loss: 0.1321 - acc: 0.9611
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1327 - acc: 0.9604
 672/1506 [============>.................] - ETA: 15s - loss: 0.1320 - acc: 0.9607
 704/1506 [=============>................] - ETA: 15s - loss: 0.1322 - acc: 0.9607
 736/1506 [=============>................] - ETA: 14s - loss: 0.1322 - acc: 0.9607
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1345 - acc: 0.9596
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1341 - acc: 0.9599
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1330 - acc: 0.9602
 864/1506 [================>.............] - ETA: 12s - loss: 0.1329 - acc: 0.9601
 896/1506 [================>.............] - ETA: 11s - loss: 0.1320 - acc: 0.9603
 928/1506 [=================>............] - ETA: 10s - loss: 0.1319 - acc: 0.9601
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1322 - acc: 0.9600
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1313 - acc: 0.9602 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1321 - acc: 0.9602
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1335 - acc: 0.9594
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1343 - acc: 0.9593
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1349 - acc: 0.9589
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1336 - acc: 0.9591
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1336 - acc: 0.9590
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1331 - acc: 0.9593
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1321 - acc: 0.9595
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1323 - acc: 0.9596
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1322 - acc: 0.9598
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1312 - acc: 0.9601
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1308 - acc: 0.9602
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1307 - acc: 0.9602
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1306 - acc: 0.9600
1472/1506 [============================>.] - ETA: 0s - loss: 0.1301 - acc: 0.9602
1504/1506 [============================>.] - ETA: 0s - loss: 0.1293 - acc: 0.9605
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1294 - acc: 0.9605 - val_loss: 0.2232 - val_acc: 0.9383
Computing...
Manual evaluation: (didn't understand why I made this)
True 8081
False 990
True percentage 0.890860985558
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.97      0.96      7318
      B-ORG       0.76      0.65      0.70       296
     B-MISC       0.36      0.03      0.05       141
     I-MISC       0.40      0.19      0.26       154
      B-PER       0.91      0.76      0.83       438
      B-LOC       0.57      0.74      0.64       218
      I-ORG       0.64      0.32      0.43       151
      I-PER       0.97      0.57      0.72       214
      I-LOC       0.69      0.75      0.72       141

avg / total       0.91      0.89      0.90      9071

F-1 Score:
0.643826761474
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 1674 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 237
OOV word occurences: 324
Padding...
Data padded!
Padding...
Data padded!
Padded until 83 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,992,194
Trainable params: 6,992,194
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1506 samples, validate on 168 samples
Epoch 1/70

  32/1506 [..............................] - ETA: 2:12 - loss: 2.1218 - acc: 0.3860
  64/1506 [>.............................] - ETA: 1:20 - loss: 1.5239 - acc: 0.5954
  96/1506 [>.............................] - ETA: 1:02 - loss: 1.2832 - acc: 0.6619
 128/1506 [=>............................] - ETA: 52s - loss: 1.1741 - acc: 0.6884 
 160/1506 [==>...........................] - ETA: 46s - loss: 1.1537 - acc: 0.7087
 192/1506 [==>...........................] - ETA: 42s - loss: 1.1327 - acc: 0.7234
 224/1506 [===>..........................] - ETA: 38s - loss: 1.0770 - acc: 0.7393
 256/1506 [====>.........................] - ETA: 36s - loss: 1.0125 - acc: 0.7510
 288/1506 [====>.........................] - ETA: 33s - loss: 0.9742 - acc: 0.7563
 320/1506 [=====>........................] - ETA: 31s - loss: 0.9380 - acc: 0.7631
 352/1506 [======>.......................] - ETA: 30s - loss: 0.9135 - acc: 0.7655
 384/1506 [======>.......................] - ETA: 28s - loss: 0.8873 - acc: 0.7700
 416/1506 [=======>......................] - ETA: 27s - loss: 0.8687 - acc: 0.7719
 448/1506 [=======>......................] - ETA: 26s - loss: 0.8439 - acc: 0.7763
 480/1506 [========>.....................] - ETA: 25s - loss: 0.8288 - acc: 0.7783
 512/1506 [=========>....................] - ETA: 24s - loss: 0.8064 - acc: 0.7832
 544/1506 [=========>....................] - ETA: 23s - loss: 0.7883 - acc: 0.7862
 576/1506 [==========>...................] - ETA: 22s - loss: 0.7734 - acc: 0.7892
 608/1506 [===========>..................] - ETA: 21s - loss: 0.7537 - acc: 0.7937
 640/1506 [===========>..................] - ETA: 20s - loss: 0.7361 - acc: 0.7981
 672/1506 [============>.................] - ETA: 19s - loss: 0.7217 - acc: 0.8009
 704/1506 [=============>................] - ETA: 18s - loss: 0.7094 - acc: 0.8041
 736/1506 [=============>................] - ETA: 17s - loss: 0.6988 - acc: 0.8063
 768/1506 [==============>...............] - ETA: 16s - loss: 0.6820 - acc: 0.8111
 800/1506 [==============>...............] - ETA: 15s - loss: 0.6724 - acc: 0.8131
 832/1506 [===============>..............] - ETA: 15s - loss: 0.6622 - acc: 0.8156
 864/1506 [================>.............] - ETA: 14s - loss: 0.6522 - acc: 0.8174
 896/1506 [================>.............] - ETA: 13s - loss: 0.6419 - acc: 0.8207
 928/1506 [=================>............] - ETA: 12s - loss: 0.6307 - acc: 0.8235
 960/1506 [==================>...........] - ETA: 12s - loss: 0.6252 - acc: 0.8243
 992/1506 [==================>...........] - ETA: 11s - loss: 0.6165 - acc: 0.8265
1024/1506 [===================>..........] - ETA: 10s - loss: 0.6059 - acc: 0.8293
1056/1506 [====================>.........] - ETA: 9s - loss: 0.5950 - acc: 0.8321 
1088/1506 [====================>.........] - ETA: 9s - loss: 0.5888 - acc: 0.8337
1120/1506 [=====================>........] - ETA: 8s - loss: 0.5818 - acc: 0.8354
1152/1506 [=====================>........] - ETA: 7s - loss: 0.5768 - acc: 0.8364
1184/1506 [======================>.......] - ETA: 6s - loss: 0.5696 - acc: 0.8386
1216/1506 [=======================>......] - ETA: 6s - loss: 0.5613 - acc: 0.8407
1248/1506 [=======================>......] - ETA: 5s - loss: 0.5551 - acc: 0.8420
1280/1506 [========================>.....] - ETA: 4s - loss: 0.5486 - acc: 0.8436
1312/1506 [=========================>....] - ETA: 4s - loss: 0.5447 - acc: 0.8443
1344/1506 [=========================>....] - ETA: 3s - loss: 0.5377 - acc: 0.8462
1376/1506 [==========================>...] - ETA: 2s - loss: 0.5322 - acc: 0.8475
1408/1506 [===========================>..] - ETA: 2s - loss: 0.5281 - acc: 0.8484
1440/1506 [===========================>..] - ETA: 1s - loss: 0.5224 - acc: 0.8501
1472/1506 [============================>.] - ETA: 0s - loss: 0.5173 - acc: 0.8515
1504/1506 [============================>.] - ETA: 0s - loss: 0.5138 - acc: 0.8524
1506/1506 [==============================] - 33s 22ms/step - loss: 0.5133 - acc: 0.8526 - val_loss: 0.3171 - val_acc: 0.9013
Epoch 2/70

  32/1506 [..............................] - ETA: 28s - loss: 0.4019 - acc: 0.8774
  64/1506 [>.............................] - ETA: 27s - loss: 0.3125 - acc: 0.9082
  96/1506 [>.............................] - ETA: 26s - loss: 0.3117 - acc: 0.9046
 128/1506 [=>............................] - ETA: 26s - loss: 0.2906 - acc: 0.9110
 160/1506 [==>...........................] - ETA: 25s - loss: 0.2760 - acc: 0.9145
 192/1506 [==>...........................] - ETA: 25s - loss: 0.2775 - acc: 0.9120
 224/1506 [===>..........................] - ETA: 24s - loss: 0.2799 - acc: 0.9126
 256/1506 [====>.........................] - ETA: 23s - loss: 0.2743 - acc: 0.9145
 288/1506 [====>.........................] - ETA: 23s - loss: 0.2688 - acc: 0.9158
 320/1506 [=====>........................] - ETA: 22s - loss: 0.2712 - acc: 0.9149
 352/1506 [======>.......................] - ETA: 21s - loss: 0.2736 - acc: 0.9138
 384/1506 [======>.......................] - ETA: 21s - loss: 0.2660 - acc: 0.9169
 416/1506 [=======>......................] - ETA: 20s - loss: 0.2627 - acc: 0.9179
 448/1506 [=======>......................] - ETA: 20s - loss: 0.2622 - acc: 0.9176
 480/1506 [========>.....................] - ETA: 19s - loss: 0.2620 - acc: 0.9172
 512/1506 [=========>....................] - ETA: 18s - loss: 0.2602 - acc: 0.9170
 544/1506 [=========>....................] - ETA: 18s - loss: 0.2602 - acc: 0.9173
 576/1506 [==========>...................] - ETA: 17s - loss: 0.2592 - acc: 0.9179
 608/1506 [===========>..................] - ETA: 17s - loss: 0.2590 - acc: 0.9181
 640/1506 [===========>..................] - ETA: 16s - loss: 0.2590 - acc: 0.9177
 672/1506 [============>.................] - ETA: 15s - loss: 0.2583 - acc: 0.9178
 704/1506 [=============>................] - ETA: 15s - loss: 0.2605 - acc: 0.9173
 736/1506 [=============>................] - ETA: 14s - loss: 0.2601 - acc: 0.9173
 768/1506 [==============>...............] - ETA: 13s - loss: 0.2606 - acc: 0.9170
 800/1506 [==============>...............] - ETA: 13s - loss: 0.2597 - acc: 0.9181
 832/1506 [===============>..............] - ETA: 12s - loss: 0.2598 - acc: 0.9183
 864/1506 [================>.............] - ETA: 12s - loss: 0.2593 - acc: 0.9188
 896/1506 [================>.............] - ETA: 11s - loss: 0.2607 - acc: 0.9183
 928/1506 [=================>............] - ETA: 10s - loss: 0.2573 - acc: 0.9198
 960/1506 [==================>...........] - ETA: 10s - loss: 0.2584 - acc: 0.9193
 992/1506 [==================>...........] - ETA: 9s - loss: 0.2587 - acc: 0.9188 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.2576 - acc: 0.9193
1056/1506 [====================>.........] - ETA: 8s - loss: 0.2556 - acc: 0.9201
1088/1506 [====================>.........] - ETA: 7s - loss: 0.2527 - acc: 0.9213
1120/1506 [=====================>........] - ETA: 7s - loss: 0.2509 - acc: 0.9220
1152/1506 [=====================>........] - ETA: 6s - loss: 0.2496 - acc: 0.9223
1184/1506 [======================>.......] - ETA: 6s - loss: 0.2480 - acc: 0.9226
1216/1506 [=======================>......] - ETA: 5s - loss: 0.2492 - acc: 0.9222
1248/1506 [=======================>......] - ETA: 4s - loss: 0.2488 - acc: 0.9224
1280/1506 [========================>.....] - ETA: 4s - loss: 0.2490 - acc: 0.9221
1312/1506 [=========================>....] - ETA: 3s - loss: 0.2479 - acc: 0.9225
1344/1506 [=========================>....] - ETA: 3s - loss: 0.2477 - acc: 0.9226
1376/1506 [==========================>...] - ETA: 2s - loss: 0.2470 - acc: 0.9228
1408/1506 [===========================>..] - ETA: 1s - loss: 0.2458 - acc: 0.9230
1440/1506 [===========================>..] - ETA: 1s - loss: 0.2472 - acc: 0.9222
1472/1506 [============================>.] - ETA: 0s - loss: 0.2476 - acc: 0.9222
1504/1506 [============================>.] - ETA: 0s - loss: 0.2470 - acc: 0.9224
1506/1506 [==============================] - 30s 20ms/step - loss: 0.2470 - acc: 0.9224 - val_loss: 0.2777 - val_acc: 0.9166
Epoch 3/70

  32/1506 [..............................] - ETA: 27s - loss: 0.1699 - acc: 0.9463
  64/1506 [>.............................] - ETA: 27s - loss: 0.2078 - acc: 0.9280
  96/1506 [>.............................] - ETA: 26s - loss: 0.1925 - acc: 0.9365
 128/1506 [=>............................] - ETA: 25s - loss: 0.2101 - acc: 0.9306
 160/1506 [==>...........................] - ETA: 25s - loss: 0.2094 - acc: 0.9322
 192/1506 [==>...........................] - ETA: 24s - loss: 0.2123 - acc: 0.9308
 224/1506 [===>..........................] - ETA: 24s - loss: 0.2208 - acc: 0.9303
 256/1506 [====>.........................] - ETA: 23s - loss: 0.2152 - acc: 0.9330
 288/1506 [====>.........................] - ETA: 22s - loss: 0.2122 - acc: 0.9330
 320/1506 [=====>........................] - ETA: 22s - loss: 0.2122 - acc: 0.9325
 352/1506 [======>.......................] - ETA: 21s - loss: 0.2090 - acc: 0.9333
 384/1506 [======>.......................] - ETA: 21s - loss: 0.2066 - acc: 0.9345
 416/1506 [=======>......................] - ETA: 20s - loss: 0.2073 - acc: 0.9346
 448/1506 [=======>......................] - ETA: 19s - loss: 0.2021 - acc: 0.9361
 480/1506 [========>.....................] - ETA: 19s - loss: 0.2094 - acc: 0.9341
 512/1506 [=========>....................] - ETA: 18s - loss: 0.2124 - acc: 0.9326
 544/1506 [=========>....................] - ETA: 18s - loss: 0.2080 - acc: 0.9341
 576/1506 [==========>...................] - ETA: 17s - loss: 0.2094 - acc: 0.9340
 608/1506 [===========>..................] - ETA: 16s - loss: 0.2089 - acc: 0.9346
 640/1506 [===========>..................] - ETA: 16s - loss: 0.2122 - acc: 0.9335
 672/1506 [============>.................] - ETA: 15s - loss: 0.2129 - acc: 0.9329
 704/1506 [=============>................] - ETA: 15s - loss: 0.2168 - acc: 0.9311
 736/1506 [=============>................] - ETA: 14s - loss: 0.2151 - acc: 0.9315
 768/1506 [==============>...............] - ETA: 13s - loss: 0.2124 - acc: 0.9324
 800/1506 [==============>...............] - ETA: 13s - loss: 0.2112 - acc: 0.9329
 832/1506 [===============>..............] - ETA: 12s - loss: 0.2106 - acc: 0.9329
 864/1506 [================>.............] - ETA: 12s - loss: 0.2091 - acc: 0.9333
 896/1506 [================>.............] - ETA: 11s - loss: 0.2081 - acc: 0.9336
 928/1506 [=================>............] - ETA: 10s - loss: 0.2076 - acc: 0.9340
 960/1506 [==================>...........] - ETA: 10s - loss: 0.2059 - acc: 0.9344
 992/1506 [==================>...........] - ETA: 9s - loss: 0.2042 - acc: 0.9344 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.2029 - acc: 0.9350
1056/1506 [====================>.........] - ETA: 8s - loss: 0.2039 - acc: 0.9348
1088/1506 [====================>.........] - ETA: 7s - loss: 0.2032 - acc: 0.9349
1120/1506 [=====================>........] - ETA: 7s - loss: 0.2026 - acc: 0.9354
1152/1506 [=====================>........] - ETA: 6s - loss: 0.2034 - acc: 0.9350
1184/1506 [======================>.......] - ETA: 6s - loss: 0.2042 - acc: 0.9347
1216/1506 [=======================>......] - ETA: 5s - loss: 0.2043 - acc: 0.9351
1248/1506 [=======================>......] - ETA: 4s - loss: 0.2045 - acc: 0.9349
1280/1506 [========================>.....] - ETA: 4s - loss: 0.2031 - acc: 0.9354
1312/1506 [=========================>....] - ETA: 3s - loss: 0.2030 - acc: 0.9357
1344/1506 [=========================>....] - ETA: 3s - loss: 0.2025 - acc: 0.9360
1376/1506 [==========================>...] - ETA: 2s - loss: 0.2036 - acc: 0.9355
1408/1506 [===========================>..] - ETA: 1s - loss: 0.2037 - acc: 0.9354
1440/1506 [===========================>..] - ETA: 1s - loss: 0.2036 - acc: 0.9354
1472/1506 [============================>.] - ETA: 0s - loss: 0.2026 - acc: 0.9359
1504/1506 [============================>.] - ETA: 0s - loss: 0.2016 - acc: 0.9361
1506/1506 [==============================] - 30s 20ms/step - loss: 0.2013 - acc: 0.9362 - val_loss: 0.1976 - val_acc: 0.9392
Epoch 4/70

  32/1506 [..............................] - ETA: 27s - loss: 0.1862 - acc: 0.9443
  64/1506 [>.............................] - ETA: 27s - loss: 0.1694 - acc: 0.9483
  96/1506 [>.............................] - ETA: 26s - loss: 0.1728 - acc: 0.9505
 128/1506 [=>............................] - ETA: 26s - loss: 0.1758 - acc: 0.9483
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1753 - acc: 0.9503
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1829 - acc: 0.9470
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1822 - acc: 0.9466
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1713 - acc: 0.9500
 288/1506 [====>.........................] - ETA: 22s - loss: 0.1673 - acc: 0.9505
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1720 - acc: 0.9480
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1683 - acc: 0.9494
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1650 - acc: 0.9502
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1632 - acc: 0.9502
 448/1506 [=======>......................] - ETA: 19s - loss: 0.1642 - acc: 0.9499
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1616 - acc: 0.9504
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1643 - acc: 0.9500
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1672 - acc: 0.9485
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1652 - acc: 0.9491
 608/1506 [===========>..................] - ETA: 16s - loss: 0.1625 - acc: 0.9498
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1641 - acc: 0.9491
 672/1506 [============>.................] - ETA: 15s - loss: 0.1636 - acc: 0.9493
 704/1506 [=============>................] - ETA: 15s - loss: 0.1630 - acc: 0.9494
 736/1506 [=============>................] - ETA: 14s - loss: 0.1683 - acc: 0.9479
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1683 - acc: 0.9481
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1705 - acc: 0.9471
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1717 - acc: 0.9467
 864/1506 [================>.............] - ETA: 12s - loss: 0.1736 - acc: 0.9460
 896/1506 [================>.............] - ETA: 11s - loss: 0.1738 - acc: 0.9458
 928/1506 [=================>............] - ETA: 10s - loss: 0.1742 - acc: 0.9457
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1727 - acc: 0.9462
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1739 - acc: 0.9455 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1739 - acc: 0.9458
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1738 - acc: 0.9458
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1724 - acc: 0.9463
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1721 - acc: 0.9466
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1704 - acc: 0.9470
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1722 - acc: 0.9467
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1737 - acc: 0.9458
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1744 - acc: 0.9457
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1734 - acc: 0.9459
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1719 - acc: 0.9465
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1721 - acc: 0.9463
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1707 - acc: 0.9465
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1710 - acc: 0.9464
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1699 - acc: 0.9468
1472/1506 [============================>.] - ETA: 0s - loss: 0.1702 - acc: 0.9469
1504/1506 [============================>.] - ETA: 0s - loss: 0.1709 - acc: 0.9466
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1713 - acc: 0.9465 - val_loss: 0.3154 - val_acc: 0.9041
Epoch 5/70

  32/1506 [..............................] - ETA: 28s - loss: 0.2731 - acc: 0.9128
  64/1506 [>.............................] - ETA: 27s - loss: 0.2277 - acc: 0.9256
  96/1506 [>.............................] - ETA: 26s - loss: 0.1822 - acc: 0.9424
 128/1506 [=>............................] - ETA: 26s - loss: 0.1955 - acc: 0.9341
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1809 - acc: 0.9394
 192/1506 [==>...........................] - ETA: 25s - loss: 0.1672 - acc: 0.9449
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1645 - acc: 0.9459
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1627 - acc: 0.9458
 288/1506 [====>.........................] - ETA: 23s - loss: 0.1636 - acc: 0.9454
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1620 - acc: 0.9467
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1568 - acc: 0.9487
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1674 - acc: 0.9437
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1665 - acc: 0.9443
 448/1506 [=======>......................] - ETA: 20s - loss: 0.1672 - acc: 0.9439
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1670 - acc: 0.9436
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1650 - acc: 0.9451
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1622 - acc: 0.9464
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1573 - acc: 0.9483
 608/1506 [===========>..................] - ETA: 17s - loss: 0.1601 - acc: 0.9472
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1589 - acc: 0.9475
 672/1506 [============>.................] - ETA: 15s - loss: 0.1613 - acc: 0.9468
 704/1506 [=============>................] - ETA: 15s - loss: 0.1617 - acc: 0.9471
 736/1506 [=============>................] - ETA: 14s - loss: 0.1612 - acc: 0.9471
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1607 - acc: 0.9478
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1588 - acc: 0.9488
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1619 - acc: 0.9481
 864/1506 [================>.............] - ETA: 12s - loss: 0.1602 - acc: 0.9484
 896/1506 [================>.............] - ETA: 11s - loss: 0.1599 - acc: 0.9485
 928/1506 [=================>............] - ETA: 10s - loss: 0.1598 - acc: 0.9483
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1591 - acc: 0.9484
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1593 - acc: 0.9486 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1597 - acc: 0.9490
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1597 - acc: 0.9488
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1588 - acc: 0.9490
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1589 - acc: 0.9491
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1594 - acc: 0.9489
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1592 - acc: 0.9490
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1607 - acc: 0.9490
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1602 - acc: 0.9493
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1603 - acc: 0.9493
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1594 - acc: 0.9496
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1586 - acc: 0.9499
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1574 - acc: 0.9503
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1560 - acc: 0.9504
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1554 - acc: 0.9507
1472/1506 [============================>.] - ETA: 0s - loss: 0.1563 - acc: 0.9506
1504/1506 [============================>.] - ETA: 0s - loss: 0.1565 - acc: 0.9509
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1563 - acc: 0.9510 - val_loss: 0.1679 - val_acc: 0.9508
Epoch 6/70

  32/1506 [..............................] - ETA: 28s - loss: 0.2083 - acc: 0.9292
  64/1506 [>.............................] - ETA: 27s - loss: 0.1777 - acc: 0.9440
  96/1506 [>.............................] - ETA: 26s - loss: 0.1612 - acc: 0.9487
 128/1506 [=>............................] - ETA: 25s - loss: 0.1516 - acc: 0.9525
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1420 - acc: 0.9562
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1361 - acc: 0.9584
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1398 - acc: 0.9574
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1379 - acc: 0.9575
 288/1506 [====>.........................] - ETA: 22s - loss: 0.1368 - acc: 0.9570
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1337 - acc: 0.9584
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1331 - acc: 0.9583
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1352 - acc: 0.9579
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1356 - acc: 0.9578
 448/1506 [=======>......................] - ETA: 19s - loss: 0.1314 - acc: 0.9588
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1321 - acc: 0.9588
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1318 - acc: 0.9584
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1314 - acc: 0.9587
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1298 - acc: 0.9592
 608/1506 [===========>..................] - ETA: 16s - loss: 0.1310 - acc: 0.9589
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1296 - acc: 0.9592
 672/1506 [============>.................] - ETA: 15s - loss: 0.1293 - acc: 0.9593
 704/1506 [=============>................] - ETA: 15s - loss: 0.1332 - acc: 0.9576
 736/1506 [=============>................] - ETA: 14s - loss: 0.1333 - acc: 0.9579
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1322 - acc: 0.9581
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1335 - acc: 0.9576
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1338 - acc: 0.9573
 864/1506 [================>.............] - ETA: 12s - loss: 0.1339 - acc: 0.9573
 896/1506 [================>.............] - ETA: 11s - loss: 0.1331 - acc: 0.9578
 928/1506 [=================>............] - ETA: 10s - loss: 0.1339 - acc: 0.9578
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1331 - acc: 0.9581
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1315 - acc: 0.9588 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1331 - acc: 0.9582
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1332 - acc: 0.9579
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1333 - acc: 0.9578
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1328 - acc: 0.9580
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1324 - acc: 0.9583
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1320 - acc: 0.9585
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1329 - acc: 0.9581
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1317 - acc: 0.9585
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1325 - acc: 0.9584
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1328 - acc: 0.9583
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1333 - acc: 0.9583
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1336 - acc: 0.9584
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1330 - acc: 0.9586
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1327 - acc: 0.9585
1472/1506 [============================>.] - ETA: 0s - loss: 0.1331 - acc: 0.9585
1504/1506 [============================>.] - ETA: 0s - loss: 0.1330 - acc: 0.9587
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1330 - acc: 0.9587 - val_loss: 0.1728 - val_acc: 0.9466
Epoch 7/70

  32/1506 [..............................] - ETA: 28s - loss: 0.1444 - acc: 0.9566
  64/1506 [>.............................] - ETA: 27s - loss: 0.1418 - acc: 0.9575
  96/1506 [>.............................] - ETA: 26s - loss: 0.1423 - acc: 0.9586
 128/1506 [=>............................] - ETA: 26s - loss: 0.1440 - acc: 0.9592
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1526 - acc: 0.9574
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1456 - acc: 0.9584
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1434 - acc: 0.9575
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1385 - acc: 0.9592
 288/1506 [====>.........................] - ETA: 23s - loss: 0.1415 - acc: 0.9581
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1351 - acc: 0.9600
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1295 - acc: 0.9615
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1306 - acc: 0.9606
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1316 - acc: 0.9604
 448/1506 [=======>......................] - ETA: 20s - loss: 0.1300 - acc: 0.9603
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1340 - acc: 0.9591
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1323 - acc: 0.9597
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1300 - acc: 0.9611
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1293 - acc: 0.9612
 608/1506 [===========>..................] - ETA: 16s - loss: 0.1280 - acc: 0.9619
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1262 - acc: 0.9627
 672/1506 [============>.................] - ETA: 15s - loss: 0.1276 - acc: 0.9620
 704/1506 [=============>................] - ETA: 15s - loss: 0.1280 - acc: 0.9620
 736/1506 [=============>................] - ETA: 14s - loss: 0.1293 - acc: 0.9615
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1287 - acc: 0.9615
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1262 - acc: 0.9626
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1279 - acc: 0.9618
 864/1506 [================>.............] - ETA: 12s - loss: 0.1270 - acc: 0.9622
 896/1506 [================>.............] - ETA: 11s - loss: 0.1271 - acc: 0.9618
 928/1506 [=================>............] - ETA: 10s - loss: 0.1263 - acc: 0.9621
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1266 - acc: 0.9620
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1259 - acc: 0.9621 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1258 - acc: 0.9621
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1252 - acc: 0.9622
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1240 - acc: 0.9623
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1232 - acc: 0.9624
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1222 - acc: 0.9628
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1209 - acc: 0.9633
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1215 - acc: 0.9633
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1206 - acc: 0.9637
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1205 - acc: 0.9639
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1211 - acc: 0.9636
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1216 - acc: 0.9634
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1219 - acc: 0.9633
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1213 - acc: 0.9635
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1219 - acc: 0.9632
1472/1506 [============================>.] - ETA: 0s - loss: 0.1227 - acc: 0.9630
1504/1506 [============================>.] - ETA: 0s - loss: 0.1226 - acc: 0.9629
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1228 - acc: 0.9629 - val_loss: 0.1821 - val_acc: 0.9460
Computing...
Manual evaluation: (didn't understand why I made this)
True 8137
False 934
True percentage 0.897034505567
Sklearn evaluation:
             precision    recall  f1-score   support

     B-MISC       0.39      0.17      0.24       141
     I-MISC       0.50      0.41      0.45       154
          O       0.95      0.97      0.96      7318
      B-PER       0.91      0.76      0.83       438
      I-PER       0.91      0.63      0.74       214
      B-ORG       0.87      0.51      0.64       296
      B-LOC       0.76      0.72      0.74       218
      I-ORG       0.69      0.44      0.53       151
      I-LOC       0.84      0.71      0.77       141

avg / total       0.92      0.90      0.91      9071

F-1 Score:
0.921094459582
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 1674 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 237
OOV word occurences: 324
Padding...
Data padded!
Padding...
Data padded!
Padded until 83 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,992,194
Trainable params: 6,992,194
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1506 samples, validate on 168 samples
Epoch 1/70

  32/1506 [..............................] - ETA: 2:10 - loss: 2.3747 - acc: 0.0149
  64/1506 [>.............................] - ETA: 1:19 - loss: 1.6679 - acc: 0.3971
  96/1506 [>.............................] - ETA: 1:01 - loss: 1.5579 - acc: 0.5183
 128/1506 [=>............................] - ETA: 52s - loss: 1.5779 - acc: 0.5486 
 160/1506 [==>...........................] - ETA: 46s - loss: 1.4368 - acc: 0.6029
 192/1506 [==>...........................] - ETA: 42s - loss: 1.3101 - acc: 0.6407
 224/1506 [===>..........................] - ETA: 38s - loss: 1.2418 - acc: 0.6603
 256/1506 [====>.........................] - ETA: 36s - loss: 1.1815 - acc: 0.6764
 288/1506 [====>.........................] - ETA: 34s - loss: 1.1241 - acc: 0.6921
 320/1506 [=====>........................] - ETA: 32s - loss: 1.0698 - acc: 0.7065
 352/1506 [======>.......................] - ETA: 30s - loss: 1.0412 - acc: 0.7124
 384/1506 [======>.......................] - ETA: 29s - loss: 1.0057 - acc: 0.7228
 416/1506 [=======>......................] - ETA: 28s - loss: 0.9769 - acc: 0.7283
 448/1506 [=======>......................] - ETA: 26s - loss: 0.9438 - acc: 0.7366
 480/1506 [========>.....................] - ETA: 25s - loss: 0.9274 - acc: 0.7391
 512/1506 [=========>....................] - ETA: 24s - loss: 0.9084 - acc: 0.7436
 544/1506 [=========>....................] - ETA: 23s - loss: 0.8830 - acc: 0.7504
 576/1506 [==========>...................] - ETA: 22s - loss: 0.8646 - acc: 0.7550
 608/1506 [===========>..................] - ETA: 21s - loss: 0.8465 - acc: 0.7596
 640/1506 [===========>..................] - ETA: 20s - loss: 0.8267 - acc: 0.7641
 672/1506 [============>.................] - ETA: 19s - loss: 0.8097 - acc: 0.7682
 704/1506 [=============>................] - ETA: 18s - loss: 0.7947 - acc: 0.7713
 736/1506 [=============>................] - ETA: 17s - loss: 0.7767 - acc: 0.7766
 768/1506 [==============>...............] - ETA: 16s - loss: 0.7783 - acc: 0.7781
 800/1506 [==============>...............] - ETA: 16s - loss: 0.7826 - acc: 0.7788
 832/1506 [===============>..............] - ETA: 15s - loss: 0.7696 - acc: 0.7833
 864/1506 [================>.............] - ETA: 14s - loss: 0.7536 - acc: 0.7876
 896/1506 [================>.............] - ETA: 13s - loss: 0.7453 - acc: 0.7891
 928/1506 [=================>............] - ETA: 12s - loss: 0.7361 - acc: 0.7917
 960/1506 [==================>...........] - ETA: 12s - loss: 0.7274 - acc: 0.7938
 992/1506 [==================>...........] - ETA: 11s - loss: 0.7150 - acc: 0.7971
1024/1506 [===================>..........] - ETA: 10s - loss: 0.7053 - acc: 0.7994
1056/1506 [====================>.........] - ETA: 9s - loss: 0.6937 - acc: 0.8028 
1088/1506 [====================>.........] - ETA: 9s - loss: 0.6871 - acc: 0.8045
1120/1506 [=====================>........] - ETA: 8s - loss: 0.6794 - acc: 0.8064
1152/1506 [=====================>........] - ETA: 7s - loss: 0.6721 - acc: 0.8082
1184/1506 [======================>.......] - ETA: 6s - loss: 0.6637 - acc: 0.8104
1216/1506 [=======================>......] - ETA: 6s - loss: 0.6544 - acc: 0.8128
1248/1506 [=======================>......] - ETA: 5s - loss: 0.6481 - acc: 0.8144
1280/1506 [========================>.....] - ETA: 4s - loss: 0.6415 - acc: 0.8163
1312/1506 [=========================>....] - ETA: 4s - loss: 0.6343 - acc: 0.8184
1344/1506 [=========================>....] - ETA: 3s - loss: 0.6263 - acc: 0.8205
1376/1506 [==========================>...] - ETA: 2s - loss: 0.6202 - acc: 0.8222
1408/1506 [===========================>..] - ETA: 2s - loss: 0.6135 - acc: 0.8241
1440/1506 [===========================>..] - ETA: 1s - loss: 0.6068 - acc: 0.8260
1472/1506 [============================>.] - ETA: 0s - loss: 0.6013 - acc: 0.8270
1504/1506 [============================>.] - ETA: 0s - loss: 0.5940 - acc: 0.8290
1506/1506 [==============================] - 33s 22ms/step - loss: 0.5935 - acc: 0.8291 - val_loss: 0.2907 - val_acc: 0.9068
Epoch 2/70

  32/1506 [..............................] - ETA: 28s - loss: 0.4121 - acc: 0.8748
  64/1506 [>.............................] - ETA: 27s - loss: 0.4104 - acc: 0.8699
  96/1506 [>.............................] - ETA: 26s - loss: 0.3530 - acc: 0.8901
 128/1506 [=>............................] - ETA: 26s - loss: 0.3457 - acc: 0.8935
 160/1506 [==>...........................] - ETA: 25s - loss: 0.3375 - acc: 0.8962
 192/1506 [==>...........................] - ETA: 25s - loss: 0.3318 - acc: 0.8985
 224/1506 [===>..........................] - ETA: 24s - loss: 0.3296 - acc: 0.8998
 256/1506 [====>.........................] - ETA: 23s - loss: 0.3316 - acc: 0.8994
 288/1506 [====>.........................] - ETA: 23s - loss: 0.3280 - acc: 0.8999
 320/1506 [=====>........................] - ETA: 22s - loss: 0.3273 - acc: 0.8998
 352/1506 [======>.......................] - ETA: 21s - loss: 0.3280 - acc: 0.8998
 384/1506 [======>.......................] - ETA: 21s - loss: 0.3279 - acc: 0.8988
 416/1506 [=======>......................] - ETA: 20s - loss: 0.3235 - acc: 0.9000
 448/1506 [=======>......................] - ETA: 20s - loss: 0.3220 - acc: 0.8998
 480/1506 [========>.....................] - ETA: 19s - loss: 0.3223 - acc: 0.8989
 512/1506 [=========>....................] - ETA: 18s - loss: 0.3227 - acc: 0.8988
 544/1506 [=========>....................] - ETA: 18s - loss: 0.3198 - acc: 0.9000
 576/1506 [==========>...................] - ETA: 17s - loss: 0.3184 - acc: 0.9003
 608/1506 [===========>..................] - ETA: 17s - loss: 0.3176 - acc: 0.9000
 640/1506 [===========>..................] - ETA: 16s - loss: 0.3173 - acc: 0.8997
 672/1506 [============>.................] - ETA: 15s - loss: 0.3143 - acc: 0.9013
 704/1506 [=============>................] - ETA: 15s - loss: 0.3092 - acc: 0.9032
 736/1506 [=============>................] - ETA: 14s - loss: 0.3040 - acc: 0.9051
 768/1506 [==============>...............] - ETA: 14s - loss: 0.3031 - acc: 0.9050
 800/1506 [==============>...............] - ETA: 13s - loss: 0.3017 - acc: 0.9057
 832/1506 [===============>..............] - ETA: 12s - loss: 0.3000 - acc: 0.9065
 864/1506 [================>.............] - ETA: 12s - loss: 0.2982 - acc: 0.9066
 896/1506 [================>.............] - ETA: 11s - loss: 0.2987 - acc: 0.9067
 928/1506 [=================>............] - ETA: 10s - loss: 0.2953 - acc: 0.9076
 960/1506 [==================>...........] - ETA: 10s - loss: 0.2927 - acc: 0.9082
 992/1506 [==================>...........] - ETA: 9s - loss: 0.2919 - acc: 0.9082 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.2921 - acc: 0.9075
1056/1506 [====================>.........] - ETA: 8s - loss: 0.2918 - acc: 0.9074
1088/1506 [====================>.........] - ETA: 7s - loss: 0.2906 - acc: 0.9080
1120/1506 [=====================>........] - ETA: 7s - loss: 0.2883 - acc: 0.9087
1152/1506 [=====================>........] - ETA: 6s - loss: 0.2882 - acc: 0.9085
1184/1506 [======================>.......] - ETA: 6s - loss: 0.2880 - acc: 0.9093
1216/1506 [=======================>......] - ETA: 5s - loss: 0.2869 - acc: 0.9097
1248/1506 [=======================>......] - ETA: 4s - loss: 0.2849 - acc: 0.9103
1280/1506 [========================>.....] - ETA: 4s - loss: 0.2817 - acc: 0.9114
1312/1506 [=========================>....] - ETA: 3s - loss: 0.2812 - acc: 0.9114
1344/1506 [=========================>....] - ETA: 3s - loss: 0.2798 - acc: 0.9120
1376/1506 [==========================>...] - ETA: 2s - loss: 0.2789 - acc: 0.9122
1408/1506 [===========================>..] - ETA: 1s - loss: 0.2781 - acc: 0.9126
1440/1506 [===========================>..] - ETA: 1s - loss: 0.2790 - acc: 0.9123
1472/1506 [============================>.] - ETA: 0s - loss: 0.2779 - acc: 0.9128
1504/1506 [============================>.] - ETA: 0s - loss: 0.2765 - acc: 0.9132
1506/1506 [==============================] - 30s 20ms/step - loss: 0.2766 - acc: 0.9132 - val_loss: 0.2200 - val_acc: 0.9323
Epoch 3/70

  32/1506 [..............................] - ETA: 28s - loss: 0.1917 - acc: 0.9361
  64/1506 [>.............................] - ETA: 27s - loss: 0.2227 - acc: 0.9240
  96/1506 [>.............................] - ETA: 26s - loss: 0.2380 - acc: 0.9189
 128/1506 [=>............................] - ETA: 26s - loss: 0.2369 - acc: 0.9196
 160/1506 [==>...........................] - ETA: 25s - loss: 0.2360 - acc: 0.9204
 192/1506 [==>...........................] - ETA: 24s - loss: 0.2258 - acc: 0.9250
 224/1506 [===>..........................] - ETA: 24s - loss: 0.2361 - acc: 0.9231
 256/1506 [====>.........................] - ETA: 23s - loss: 0.2335 - acc: 0.9241
 288/1506 [====>.........................] - ETA: 23s - loss: 0.2367 - acc: 0.9234
 320/1506 [=====>........................] - ETA: 22s - loss: 0.2397 - acc: 0.9221
 352/1506 [======>.......................] - ETA: 21s - loss: 0.2394 - acc: 0.9224
 384/1506 [======>.......................] - ETA: 21s - loss: 0.2423 - acc: 0.9217
 416/1506 [=======>......................] - ETA: 20s - loss: 0.2374 - acc: 0.9240
 448/1506 [=======>......................] - ETA: 20s - loss: 0.2336 - acc: 0.9250
 480/1506 [========>.....................] - ETA: 19s - loss: 0.2380 - acc: 0.9235
 512/1506 [=========>....................] - ETA: 18s - loss: 0.2378 - acc: 0.9232
 544/1506 [=========>....................] - ETA: 18s - loss: 0.2369 - acc: 0.9236
 576/1506 [==========>...................] - ETA: 17s - loss: 0.2352 - acc: 0.9243
 608/1506 [===========>..................] - ETA: 16s - loss: 0.2328 - acc: 0.9257
 640/1506 [===========>..................] - ETA: 16s - loss: 0.2363 - acc: 0.9247
 672/1506 [============>.................] - ETA: 15s - loss: 0.2372 - acc: 0.9241
 704/1506 [=============>................] - ETA: 15s - loss: 0.2329 - acc: 0.9253
 736/1506 [=============>................] - ETA: 14s - loss: 0.2320 - acc: 0.9256
 768/1506 [==============>...............] - ETA: 13s - loss: 0.2305 - acc: 0.9266
 800/1506 [==============>...............] - ETA: 13s - loss: 0.2285 - acc: 0.9271
 832/1506 [===============>..............] - ETA: 12s - loss: 0.2266 - acc: 0.9275
 864/1506 [================>.............] - ETA: 12s - loss: 0.2251 - acc: 0.9279
 896/1506 [================>.............] - ETA: 11s - loss: 0.2233 - acc: 0.9285
 928/1506 [=================>............] - ETA: 10s - loss: 0.2226 - acc: 0.9286
 960/1506 [==================>...........] - ETA: 10s - loss: 0.2223 - acc: 0.9287
 992/1506 [==================>...........] - ETA: 9s - loss: 0.2231 - acc: 0.9286 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.2233 - acc: 0.9286
1056/1506 [====================>.........] - ETA: 8s - loss: 0.2213 - acc: 0.9292
1088/1506 [====================>.........] - ETA: 7s - loss: 0.2211 - acc: 0.9290
1120/1506 [=====================>........] - ETA: 7s - loss: 0.2227 - acc: 0.9285
1152/1506 [=====================>........] - ETA: 6s - loss: 0.2214 - acc: 0.9291
1184/1506 [======================>.......] - ETA: 6s - loss: 0.2216 - acc: 0.9293
1216/1506 [=======================>......] - ETA: 5s - loss: 0.2223 - acc: 0.9291
1248/1506 [=======================>......] - ETA: 4s - loss: 0.2224 - acc: 0.9289
1280/1506 [========================>.....] - ETA: 4s - loss: 0.2216 - acc: 0.9292
1312/1506 [=========================>....] - ETA: 3s - loss: 0.2234 - acc: 0.9284
1344/1506 [=========================>....] - ETA: 3s - loss: 0.2219 - acc: 0.9286
1376/1506 [==========================>...] - ETA: 2s - loss: 0.2224 - acc: 0.9287
1408/1506 [===========================>..] - ETA: 1s - loss: 0.2217 - acc: 0.9289
1440/1506 [===========================>..] - ETA: 1s - loss: 0.2214 - acc: 0.9291
1472/1506 [============================>.] - ETA: 0s - loss: 0.2204 - acc: 0.9293
1504/1506 [============================>.] - ETA: 0s - loss: 0.2201 - acc: 0.9294
1506/1506 [==============================] - 30s 20ms/step - loss: 0.2199 - acc: 0.9295 - val_loss: 0.1818 - val_acc: 0.9406
Epoch 4/70

  32/1506 [..............................] - ETA: 27s - loss: 0.2419 - acc: 0.9155
  64/1506 [>.............................] - ETA: 27s - loss: 0.2361 - acc: 0.9183
  96/1506 [>.............................] - ETA: 26s - loss: 0.2561 - acc: 0.9210
 128/1506 [=>............................] - ETA: 26s - loss: 0.2384 - acc: 0.9291
 160/1506 [==>...........................] - ETA: 25s - loss: 0.2194 - acc: 0.9356
 192/1506 [==>...........................] - ETA: 24s - loss: 0.2217 - acc: 0.9320
 224/1506 [===>..........................] - ETA: 24s - loss: 0.2156 - acc: 0.9328
 256/1506 [====>.........................] - ETA: 23s - loss: 0.2059 - acc: 0.9368
 288/1506 [====>.........................] - ETA: 23s - loss: 0.2062 - acc: 0.9367
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1997 - acc: 0.9384
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1978 - acc: 0.9385
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1931 - acc: 0.9402
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1934 - acc: 0.9410
 448/1506 [=======>......................] - ETA: 20s - loss: 0.1918 - acc: 0.9414
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1946 - acc: 0.9402
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1947 - acc: 0.9404
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1963 - acc: 0.9409
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1959 - acc: 0.9409
 608/1506 [===========>..................] - ETA: 17s - loss: 0.1951 - acc: 0.9409
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1908 - acc: 0.9422
 672/1506 [============>.................] - ETA: 15s - loss: 0.1921 - acc: 0.9414
 704/1506 [=============>................] - ETA: 15s - loss: 0.1946 - acc: 0.9406
 736/1506 [=============>................] - ETA: 14s - loss: 0.1946 - acc: 0.9404
 768/1506 [==============>...............] - ETA: 14s - loss: 0.1933 - acc: 0.9402
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1939 - acc: 0.9397
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1919 - acc: 0.9404
 864/1506 [================>.............] - ETA: 12s - loss: 0.1916 - acc: 0.9404
 896/1506 [================>.............] - ETA: 11s - loss: 0.1910 - acc: 0.9406
 928/1506 [=================>............] - ETA: 10s - loss: 0.1909 - acc: 0.9405
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1906 - acc: 0.9404
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1895 - acc: 0.9407 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1873 - acc: 0.9411
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1877 - acc: 0.9410
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1881 - acc: 0.9408
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1871 - acc: 0.9411
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1869 - acc: 0.9409
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1870 - acc: 0.9407
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1868 - acc: 0.9406
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1866 - acc: 0.9406
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1864 - acc: 0.9407
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1876 - acc: 0.9405
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1868 - acc: 0.9408
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1877 - acc: 0.9403
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1878 - acc: 0.9404
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1873 - acc: 0.9403
1472/1506 [============================>.] - ETA: 0s - loss: 0.1870 - acc: 0.9404
1504/1506 [============================>.] - ETA: 0s - loss: 0.1878 - acc: 0.9402
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1877 - acc: 0.9402 - val_loss: 0.1788 - val_acc: 0.9417
Epoch 5/70

  32/1506 [..............................] - ETA: 28s - loss: 0.1578 - acc: 0.9498
  64/1506 [>.............................] - ETA: 27s - loss: 0.1594 - acc: 0.9438
  96/1506 [>.............................] - ETA: 26s - loss: 0.1823 - acc: 0.9375
 128/1506 [=>............................] - ETA: 26s - loss: 0.1771 - acc: 0.9419
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1892 - acc: 0.9410
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1984 - acc: 0.9383
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1862 - acc: 0.9417
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1887 - acc: 0.9408
 288/1506 [====>.........................] - ETA: 23s - loss: 0.1839 - acc: 0.9428
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1842 - acc: 0.9421
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1806 - acc: 0.9437
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1749 - acc: 0.9459
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1742 - acc: 0.9453
 448/1506 [=======>......................] - ETA: 20s - loss: 0.1729 - acc: 0.9458
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1744 - acc: 0.9452
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1729 - acc: 0.9451
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1716 - acc: 0.9448
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1696 - acc: 0.9456
 608/1506 [===========>..................] - ETA: 17s - loss: 0.1672 - acc: 0.9465
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1668 - acc: 0.9461
 672/1506 [============>.................] - ETA: 15s - loss: 0.1665 - acc: 0.9466
 704/1506 [=============>................] - ETA: 15s - loss: 0.1648 - acc: 0.9470
 736/1506 [=============>................] - ETA: 14s - loss: 0.1642 - acc: 0.9470
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1670 - acc: 0.9450
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1699 - acc: 0.9442
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1707 - acc: 0.9440
 864/1506 [================>.............] - ETA: 12s - loss: 0.1714 - acc: 0.9436
 896/1506 [================>.............] - ETA: 11s - loss: 0.1721 - acc: 0.9437
 928/1506 [=================>............] - ETA: 10s - loss: 0.1691 - acc: 0.9451
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1682 - acc: 0.9455
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1675 - acc: 0.9460 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1678 - acc: 0.9458
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1684 - acc: 0.9456
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1682 - acc: 0.9457
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1671 - acc: 0.9460
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1666 - acc: 0.9460
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1654 - acc: 0.9464
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1657 - acc: 0.9464
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1647 - acc: 0.9469
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1673 - acc: 0.9460
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1677 - acc: 0.9459
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1671 - acc: 0.9460
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1674 - acc: 0.9461
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1682 - acc: 0.9460
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1677 - acc: 0.9462
1472/1506 [============================>.] - ETA: 0s - loss: 0.1675 - acc: 0.9465
1504/1506 [============================>.] - ETA: 0s - loss: 0.1675 - acc: 0.9467
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1675 - acc: 0.9466 - val_loss: 0.2820 - val_acc: 0.9155
Epoch 6/70

  32/1506 [..............................] - ETA: 27s - loss: 0.2858 - acc: 0.9062
  64/1506 [>.............................] - ETA: 26s - loss: 0.2127 - acc: 0.9298
  96/1506 [>.............................] - ETA: 26s - loss: 0.1807 - acc: 0.9426
 128/1506 [=>............................] - ETA: 25s - loss: 0.1744 - acc: 0.9446
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1614 - acc: 0.9481
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1692 - acc: 0.9452
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1639 - acc: 0.9468
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1708 - acc: 0.9479
 288/1506 [====>.........................] - ETA: 23s - loss: 0.1710 - acc: 0.9477
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1739 - acc: 0.9461
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1728 - acc: 0.9461
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1675 - acc: 0.9481
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1654 - acc: 0.9484
 448/1506 [=======>......................] - ETA: 20s - loss: 0.1637 - acc: 0.9490
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1628 - acc: 0.9489
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1631 - acc: 0.9488
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1620 - acc: 0.9490
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1619 - acc: 0.9491
 608/1506 [===========>..................] - ETA: 16s - loss: 0.1597 - acc: 0.9501
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1579 - acc: 0.9505
 672/1506 [============>.................] - ETA: 15s - loss: 0.1568 - acc: 0.9505
 704/1506 [=============>................] - ETA: 15s - loss: 0.1596 - acc: 0.9497
 736/1506 [=============>................] - ETA: 14s - loss: 0.1594 - acc: 0.9494
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1593 - acc: 0.9492
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1570 - acc: 0.9499
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1569 - acc: 0.9497
 864/1506 [================>.............] - ETA: 12s - loss: 0.1551 - acc: 0.9504
 896/1506 [================>.............] - ETA: 11s - loss: 0.1568 - acc: 0.9498
 928/1506 [=================>............] - ETA: 10s - loss: 0.1564 - acc: 0.9499
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1569 - acc: 0.9499
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1558 - acc: 0.9503 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1556 - acc: 0.9502
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1556 - acc: 0.9501
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1563 - acc: 0.9499
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1578 - acc: 0.9492
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1577 - acc: 0.9493
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1584 - acc: 0.9493
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1580 - acc: 0.9493
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1578 - acc: 0.9492
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1562 - acc: 0.9496
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1566 - acc: 0.9496
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1551 - acc: 0.9501
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1542 - acc: 0.9504
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1538 - acc: 0.9507
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1534 - acc: 0.9508
1472/1506 [============================>.] - ETA: 0s - loss: 0.1535 - acc: 0.9505
1504/1506 [============================>.] - ETA: 0s - loss: 0.1532 - acc: 0.9506
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1533 - acc: 0.9505 - val_loss: 0.1915 - val_acc: 0.9395
Computing...
Manual evaluation: (didn't understand why I made this)
True 8029
False 1042
True percentage 0.885128431264
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.75      0.81      0.78       438
      B-ORG       0.65      0.64      0.64       296
     B-MISC       0.50      0.02      0.04       141
     I-MISC       0.57      0.05      0.10       154
      I-ORG       0.36      0.54      0.43       151
      B-LOC       0.72      0.67      0.70       218
      I-LOC       0.76      0.46      0.58       141
      I-PER       0.60      0.68      0.64       214

avg / total       0.91      0.89      0.89      9071

F-1 Score:
0.603155339806
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 1674 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 237
OOV word occurences: 324
Padding...
Data padded!
Padding...
Data padded!
Padded until 83 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,992,194
Trainable params: 6,992,194
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1506 samples, validate on 168 samples
Epoch 1/70

  32/1506 [..............................] - ETA: 2:07 - loss: 2.2967 - acc: 0.0179
  64/1506 [>.............................] - ETA: 1:18 - loss: 1.6174 - acc: 0.4133
  96/1506 [>.............................] - ETA: 1:01 - loss: 1.7289 - acc: 0.5549
 128/1506 [=>............................] - ETA: 52s - loss: 1.5516 - acc: 0.6167 
 160/1506 [==>...........................] - ETA: 46s - loss: 1.3934 - acc: 0.6586
 192/1506 [==>...........................] - ETA: 41s - loss: 1.2906 - acc: 0.6827
 224/1506 [===>..........................] - ETA: 38s - loss: 1.2079 - acc: 0.7029
 256/1506 [====>.........................] - ETA: 35s - loss: 1.1348 - acc: 0.7194
 288/1506 [====>.........................] - ETA: 33s - loss: 1.0991 - acc: 0.7261
 320/1506 [=====>........................] - ETA: 31s - loss: 1.0516 - acc: 0.7374
 352/1506 [======>.......................] - ETA: 30s - loss: 1.0188 - acc: 0.7432
 384/1506 [======>.......................] - ETA: 28s - loss: 0.9858 - acc: 0.7493
 416/1506 [=======>......................] - ETA: 27s - loss: 0.9687 - acc: 0.7511
 448/1506 [=======>......................] - ETA: 25s - loss: 0.9406 - acc: 0.7576
 480/1506 [========>.....................] - ETA: 25s - loss: 0.9194 - acc: 0.7611
 512/1506 [=========>....................] - ETA: 24s - loss: 0.8938 - acc: 0.7665
 544/1506 [=========>....................] - ETA: 23s - loss: 0.8637 - acc: 0.7725
 576/1506 [==========>...................] - ETA: 22s - loss: 0.8395 - acc: 0.7787
 608/1506 [===========>..................] - ETA: 21s - loss: 0.8214 - acc: 0.7821
 640/1506 [===========>..................] - ETA: 20s - loss: 0.8050 - acc: 0.7850
 672/1506 [============>.................] - ETA: 19s - loss: 0.7864 - acc: 0.7897
 704/1506 [=============>................] - ETA: 18s - loss: 0.7686 - acc: 0.7937
 736/1506 [=============>................] - ETA: 17s - loss: 0.7563 - acc: 0.7962
 768/1506 [==============>...............] - ETA: 16s - loss: 0.7498 - acc: 0.7981
 800/1506 [==============>...............] - ETA: 15s - loss: 0.7402 - acc: 0.7991
 832/1506 [===============>..............] - ETA: 15s - loss: 0.7302 - acc: 0.8019
 864/1506 [================>.............] - ETA: 14s - loss: 0.7200 - acc: 0.8037
 896/1506 [================>.............] - ETA: 13s - loss: 0.7099 - acc: 0.8063
 928/1506 [=================>............] - ETA: 12s - loss: 0.7004 - acc: 0.8085
 960/1506 [==================>...........] - ETA: 12s - loss: 0.6885 - acc: 0.8111
 992/1506 [==================>...........] - ETA: 11s - loss: 0.6785 - acc: 0.8138
1024/1506 [===================>..........] - ETA: 10s - loss: 0.6692 - acc: 0.8161
1056/1506 [====================>.........] - ETA: 9s - loss: 0.6599 - acc: 0.8184 
1088/1506 [====================>.........] - ETA: 9s - loss: 0.6503 - acc: 0.8204
1120/1506 [=====================>........] - ETA: 8s - loss: 0.6409 - acc: 0.8223
1152/1506 [=====================>........] - ETA: 7s - loss: 0.6320 - acc: 0.8247
1184/1506 [======================>.......] - ETA: 6s - loss: 0.6253 - acc: 0.8261
1216/1506 [=======================>......] - ETA: 6s - loss: 0.6202 - acc: 0.8277
1248/1506 [=======================>......] - ETA: 5s - loss: 0.6128 - acc: 0.8294
1280/1506 [========================>.....] - ETA: 4s - loss: 0.6073 - acc: 0.8308
1312/1506 [=========================>....] - ETA: 4s - loss: 0.5994 - acc: 0.8329
1344/1506 [=========================>....] - ETA: 3s - loss: 0.5920 - acc: 0.8346
1376/1506 [==========================>...] - ETA: 2s - loss: 0.5858 - acc: 0.8364
1408/1506 [===========================>..] - ETA: 2s - loss: 0.5802 - acc: 0.8377
1440/1506 [===========================>..] - ETA: 1s - loss: 0.5748 - acc: 0.8389
1472/1506 [============================>.] - ETA: 0s - loss: 0.5717 - acc: 0.8397
1504/1506 [============================>.] - ETA: 0s - loss: 0.5677 - acc: 0.8405
1506/1506 [==============================] - 33s 22ms/step - loss: 0.5670 - acc: 0.8406 - val_loss: 0.3558 - val_acc: 0.8803
Epoch 2/70

  32/1506 [..............................] - ETA: 28s - loss: 0.2770 - acc: 0.9098
  64/1506 [>.............................] - ETA: 27s - loss: 0.2985 - acc: 0.9041
  96/1506 [>.............................] - ETA: 26s - loss: 0.2973 - acc: 0.9078
 128/1506 [=>............................] - ETA: 26s - loss: 0.2943 - acc: 0.9086
 160/1506 [==>...........................] - ETA: 25s - loss: 0.2908 - acc: 0.9112
 192/1506 [==>...........................] - ETA: 25s - loss: 0.3020 - acc: 0.9072
 224/1506 [===>..........................] - ETA: 24s - loss: 0.2827 - acc: 0.9142
 256/1506 [====>.........................] - ETA: 23s - loss: 0.2840 - acc: 0.9146
 288/1506 [====>.........................] - ETA: 23s - loss: 0.2956 - acc: 0.9098
 320/1506 [=====>........................] - ETA: 22s - loss: 0.2839 - acc: 0.9130
 352/1506 [======>.......................] - ETA: 22s - loss: 0.2889 - acc: 0.9109
 384/1506 [======>.......................] - ETA: 21s - loss: 0.2886 - acc: 0.9112
 416/1506 [=======>......................] - ETA: 20s - loss: 0.2832 - acc: 0.9129
 448/1506 [=======>......................] - ETA: 20s - loss: 0.2772 - acc: 0.9141
 480/1506 [========>.....................] - ETA: 19s - loss: 0.2782 - acc: 0.9139
 512/1506 [=========>....................] - ETA: 18s - loss: 0.2764 - acc: 0.9145
 544/1506 [=========>....................] - ETA: 18s - loss: 0.2756 - acc: 0.9147
 576/1506 [==========>...................] - ETA: 17s - loss: 0.2739 - acc: 0.9149
 608/1506 [===========>..................] - ETA: 17s - loss: 0.2722 - acc: 0.9155
 640/1506 [===========>..................] - ETA: 16s - loss: 0.2727 - acc: 0.9153
 672/1506 [============>.................] - ETA: 15s - loss: 0.2732 - acc: 0.9153
 704/1506 [=============>................] - ETA: 15s - loss: 0.2748 - acc: 0.9152
 736/1506 [=============>................] - ETA: 14s - loss: 0.2700 - acc: 0.9168
 768/1506 [==============>...............] - ETA: 14s - loss: 0.2732 - acc: 0.9156
 800/1506 [==============>...............] - ETA: 13s - loss: 0.2722 - acc: 0.9160
 832/1506 [===============>..............] - ETA: 12s - loss: 0.2722 - acc: 0.9157
 864/1506 [================>.............] - ETA: 12s - loss: 0.2730 - acc: 0.9154
 896/1506 [================>.............] - ETA: 11s - loss: 0.2748 - acc: 0.9153
 928/1506 [=================>............] - ETA: 11s - loss: 0.2728 - acc: 0.9159
 960/1506 [==================>...........] - ETA: 10s - loss: 0.2695 - acc: 0.9168
 992/1506 [==================>...........] - ETA: 9s - loss: 0.2688 - acc: 0.9165 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.2668 - acc: 0.9172
1056/1506 [====================>.........] - ETA: 8s - loss: 0.2657 - acc: 0.9176
1088/1506 [====================>.........] - ETA: 7s - loss: 0.2643 - acc: 0.9179
1120/1506 [=====================>........] - ETA: 7s - loss: 0.2625 - acc: 0.9185
1152/1506 [=====================>........] - ETA: 6s - loss: 0.2605 - acc: 0.9190
1184/1506 [======================>.......] - ETA: 6s - loss: 0.2590 - acc: 0.9197
1216/1506 [=======================>......] - ETA: 5s - loss: 0.2595 - acc: 0.9194
1248/1506 [=======================>......] - ETA: 4s - loss: 0.2610 - acc: 0.9191
1280/1506 [========================>.....] - ETA: 4s - loss: 0.2619 - acc: 0.9187
1312/1506 [=========================>....] - ETA: 3s - loss: 0.2608 - acc: 0.9193
1344/1506 [=========================>....] - ETA: 3s - loss: 0.2603 - acc: 0.9196
1376/1506 [==========================>...] - ETA: 2s - loss: 0.2595 - acc: 0.9198
1408/1506 [===========================>..] - ETA: 1s - loss: 0.2583 - acc: 0.9202
1440/1506 [===========================>..] - ETA: 1s - loss: 0.2575 - acc: 0.9204
1472/1506 [============================>.] - ETA: 0s - loss: 0.2573 - acc: 0.9203
1504/1506 [============================>.] - ETA: 0s - loss: 0.2558 - acc: 0.9208
1506/1506 [==============================] - 30s 20ms/step - loss: 0.2558 - acc: 0.9208 - val_loss: 0.3410 - val_acc: 0.8928
Epoch 3/70

  32/1506 [..............................] - ETA: 27s - loss: 0.3345 - acc: 0.8846
  64/1506 [>.............................] - ETA: 27s - loss: 0.3107 - acc: 0.9002
  96/1506 [>.............................] - ETA: 26s - loss: 0.2772 - acc: 0.9153
 128/1506 [=>............................] - ETA: 25s - loss: 0.2541 - acc: 0.9224
 160/1506 [==>...........................] - ETA: 25s - loss: 0.2575 - acc: 0.9210
 192/1506 [==>...........................] - ETA: 24s - loss: 0.2512 - acc: 0.9240
 224/1506 [===>..........................] - ETA: 24s - loss: 0.2510 - acc: 0.9249
 256/1506 [====>.........................] - ETA: 23s - loss: 0.2482 - acc: 0.9246
 288/1506 [====>.........................] - ETA: 22s - loss: 0.2430 - acc: 0.9260
 320/1506 [=====>........................] - ETA: 22s - loss: 0.2404 - acc: 0.9265
 352/1506 [======>.......................] - ETA: 21s - loss: 0.2384 - acc: 0.9261
 384/1506 [======>.......................] - ETA: 21s - loss: 0.2362 - acc: 0.9269
 416/1506 [=======>......................] - ETA: 20s - loss: 0.2352 - acc: 0.9271
 448/1506 [=======>......................] - ETA: 19s - loss: 0.2302 - acc: 0.9293
 480/1506 [========>.....................] - ETA: 19s - loss: 0.2260 - acc: 0.9304
 512/1506 [=========>....................] - ETA: 18s - loss: 0.2237 - acc: 0.9314
 544/1506 [=========>....................] - ETA: 18s - loss: 0.2249 - acc: 0.9298
 576/1506 [==========>...................] - ETA: 17s - loss: 0.2264 - acc: 0.9291
 608/1506 [===========>..................] - ETA: 16s - loss: 0.2219 - acc: 0.9311
 640/1506 [===========>..................] - ETA: 16s - loss: 0.2226 - acc: 0.9300
 672/1506 [============>.................] - ETA: 15s - loss: 0.2218 - acc: 0.9299
 704/1506 [=============>................] - ETA: 15s - loss: 0.2208 - acc: 0.9304
 736/1506 [=============>................] - ETA: 14s - loss: 0.2208 - acc: 0.9305
 768/1506 [==============>...............] - ETA: 13s - loss: 0.2196 - acc: 0.9309
 800/1506 [==============>...............] - ETA: 13s - loss: 0.2199 - acc: 0.9306
 832/1506 [===============>..............] - ETA: 12s - loss: 0.2192 - acc: 0.9304
 864/1506 [================>.............] - ETA: 12s - loss: 0.2181 - acc: 0.9307
 896/1506 [================>.............] - ETA: 11s - loss: 0.2179 - acc: 0.9307
 928/1506 [=================>............] - ETA: 10s - loss: 0.2175 - acc: 0.9308
 960/1506 [==================>...........] - ETA: 10s - loss: 0.2180 - acc: 0.9311
 992/1506 [==================>...........] - ETA: 9s - loss: 0.2158 - acc: 0.9321 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.2153 - acc: 0.9326
1056/1506 [====================>.........] - ETA: 8s - loss: 0.2135 - acc: 0.9335
1088/1506 [====================>.........] - ETA: 7s - loss: 0.2126 - acc: 0.9337
1120/1506 [=====================>........] - ETA: 7s - loss: 0.2115 - acc: 0.9341
1152/1506 [=====================>........] - ETA: 6s - loss: 0.2116 - acc: 0.9339
1184/1506 [======================>.......] - ETA: 6s - loss: 0.2110 - acc: 0.9341
1216/1506 [=======================>......] - ETA: 5s - loss: 0.2109 - acc: 0.9339
1248/1506 [=======================>......] - ETA: 4s - loss: 0.2101 - acc: 0.9339
1280/1506 [========================>.....] - ETA: 4s - loss: 0.2113 - acc: 0.9334
1312/1506 [=========================>....] - ETA: 3s - loss: 0.2111 - acc: 0.9334
1344/1506 [=========================>....] - ETA: 3s - loss: 0.2102 - acc: 0.9338
1376/1506 [==========================>...] - ETA: 2s - loss: 0.2088 - acc: 0.9342
1408/1506 [===========================>..] - ETA: 1s - loss: 0.2082 - acc: 0.9342
1440/1506 [===========================>..] - ETA: 1s - loss: 0.2069 - acc: 0.9347
1472/1506 [============================>.] - ETA: 0s - loss: 0.2060 - acc: 0.9350
1504/1506 [============================>.] - ETA: 0s - loss: 0.2053 - acc: 0.9351
1506/1506 [==============================] - 30s 20ms/step - loss: 0.2054 - acc: 0.9351 - val_loss: 0.2318 - val_acc: 0.9286
Epoch 4/70

  32/1506 [..............................] - ETA: 28s - loss: 0.2483 - acc: 0.9153
  64/1506 [>.............................] - ETA: 27s - loss: 0.2208 - acc: 0.9304
  96/1506 [>.............................] - ETA: 26s - loss: 0.2139 - acc: 0.9339
 128/1506 [=>............................] - ETA: 25s - loss: 0.1886 - acc: 0.9418
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1873 - acc: 0.9437
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1914 - acc: 0.9403
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1894 - acc: 0.9415
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1832 - acc: 0.9440
 288/1506 [====>.........................] - ETA: 23s - loss: 0.1858 - acc: 0.9422
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1855 - acc: 0.9418
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1884 - acc: 0.9416
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1870 - acc: 0.9413
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1875 - acc: 0.9418
 448/1506 [=======>......................] - ETA: 20s - loss: 0.1843 - acc: 0.9430
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1861 - acc: 0.9409
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1853 - acc: 0.9418
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1813 - acc: 0.9435
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1802 - acc: 0.9438
 608/1506 [===========>..................] - ETA: 16s - loss: 0.1841 - acc: 0.9426
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1835 - acc: 0.9433
 672/1506 [============>.................] - ETA: 15s - loss: 0.1853 - acc: 0.9428
 704/1506 [=============>................] - ETA: 15s - loss: 0.1840 - acc: 0.9430
 736/1506 [=============>................] - ETA: 14s - loss: 0.1825 - acc: 0.9434
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1887 - acc: 0.9417
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1884 - acc: 0.9418
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1877 - acc: 0.9416
 864/1506 [================>.............] - ETA: 12s - loss: 0.1869 - acc: 0.9421
 896/1506 [================>.............] - ETA: 11s - loss: 0.1865 - acc: 0.9422
 928/1506 [=================>............] - ETA: 10s - loss: 0.1843 - acc: 0.9432
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1836 - acc: 0.9432
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1837 - acc: 0.9429 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1816 - acc: 0.9434
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1804 - acc: 0.9437
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1792 - acc: 0.9441
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1810 - acc: 0.9432
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1808 - acc: 0.9432
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1810 - acc: 0.9435
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1805 - acc: 0.9437
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1803 - acc: 0.9437
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1785 - acc: 0.9442
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1787 - acc: 0.9439
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1767 - acc: 0.9448
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1771 - acc: 0.9448
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1766 - acc: 0.9451
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1762 - acc: 0.9453
1472/1506 [============================>.] - ETA: 0s - loss: 0.1761 - acc: 0.9451
1504/1506 [============================>.] - ETA: 0s - loss: 0.1753 - acc: 0.9455
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1751 - acc: 0.9456 - val_loss: 0.2465 - val_acc: 0.9301
Epoch 5/70

  32/1506 [..............................] - ETA: 27s - loss: 0.2550 - acc: 0.9147
  64/1506 [>.............................] - ETA: 26s - loss: 0.1947 - acc: 0.9383
  96/1506 [>.............................] - ETA: 26s - loss: 0.1753 - acc: 0.9436
 128/1506 [=>............................] - ETA: 26s - loss: 0.1659 - acc: 0.9466
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1551 - acc: 0.9512
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1551 - acc: 0.9518
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1480 - acc: 0.9538
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1553 - acc: 0.9516
 288/1506 [====>.........................] - ETA: 22s - loss: 0.1574 - acc: 0.9515
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1590 - acc: 0.9510
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1563 - acc: 0.9520
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1552 - acc: 0.9528
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1560 - acc: 0.9525
 448/1506 [=======>......................] - ETA: 20s - loss: 0.1542 - acc: 0.9529
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1542 - acc: 0.9527
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1579 - acc: 0.9513
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1550 - acc: 0.9523
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1590 - acc: 0.9508
 608/1506 [===========>..................] - ETA: 17s - loss: 0.1587 - acc: 0.9512
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1606 - acc: 0.9502
 672/1506 [============>.................] - ETA: 15s - loss: 0.1590 - acc: 0.9505
 704/1506 [=============>................] - ETA: 15s - loss: 0.1561 - acc: 0.9515
 736/1506 [=============>................] - ETA: 14s - loss: 0.1585 - acc: 0.9507
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1597 - acc: 0.9500
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1586 - acc: 0.9508
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1569 - acc: 0.9513
 864/1506 [================>.............] - ETA: 12s - loss: 0.1577 - acc: 0.9511
 896/1506 [================>.............] - ETA: 11s - loss: 0.1579 - acc: 0.9506
 928/1506 [=================>............] - ETA: 10s - loss: 0.1571 - acc: 0.9507
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1555 - acc: 0.9512
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1543 - acc: 0.9517 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1535 - acc: 0.9520
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1547 - acc: 0.9517
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1537 - acc: 0.9519
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1533 - acc: 0.9518
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1540 - acc: 0.9514
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1546 - acc: 0.9511
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1536 - acc: 0.9512
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1526 - acc: 0.9515
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1523 - acc: 0.9518
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1524 - acc: 0.9518
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1531 - acc: 0.9517
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1526 - acc: 0.9519
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1526 - acc: 0.9518
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1521 - acc: 0.9520
1472/1506 [============================>.] - ETA: 0s - loss: 0.1531 - acc: 0.9518
1504/1506 [============================>.] - ETA: 0s - loss: 0.1518 - acc: 0.9521
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1518 - acc: 0.9520 - val_loss: 0.2115 - val_acc: 0.9345
Epoch 6/70

  32/1506 [..............................] - ETA: 28s - loss: 0.1716 - acc: 0.9445
  64/1506 [>.............................] - ETA: 27s - loss: 0.1471 - acc: 0.9551
  96/1506 [>.............................] - ETA: 26s - loss: 0.1431 - acc: 0.9567
 128/1506 [=>............................] - ETA: 26s - loss: 0.1390 - acc: 0.9585
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1359 - acc: 0.9578
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1324 - acc: 0.9593
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1435 - acc: 0.9544
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1398 - acc: 0.9560
 288/1506 [====>.........................] - ETA: 22s - loss: 0.1383 - acc: 0.9556
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1357 - acc: 0.9560
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1352 - acc: 0.9556
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1349 - acc: 0.9564
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1409 - acc: 0.9545
 448/1506 [=======>......................] - ETA: 19s - loss: 0.1413 - acc: 0.9546
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1401 - acc: 0.9556
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1377 - acc: 0.9567
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1404 - acc: 0.9567
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1381 - acc: 0.9576
 608/1506 [===========>..................] - ETA: 16s - loss: 0.1366 - acc: 0.9581
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1402 - acc: 0.9572
 672/1506 [============>.................] - ETA: 15s - loss: 0.1382 - acc: 0.9580
 704/1506 [=============>................] - ETA: 15s - loss: 0.1386 - acc: 0.9575
 736/1506 [=============>................] - ETA: 14s - loss: 0.1375 - acc: 0.9579
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1344 - acc: 0.9588
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1325 - acc: 0.9596
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1336 - acc: 0.9592
 864/1506 [================>.............] - ETA: 12s - loss: 0.1326 - acc: 0.9594
 896/1506 [================>.............] - ETA: 11s - loss: 0.1313 - acc: 0.9597
 928/1506 [=================>............] - ETA: 10s - loss: 0.1326 - acc: 0.9591
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1327 - acc: 0.9589
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1327 - acc: 0.9592 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1341 - acc: 0.9587
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1334 - acc: 0.9590
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1334 - acc: 0.9589
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1340 - acc: 0.9588
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1341 - acc: 0.9586
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1360 - acc: 0.9576
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1378 - acc: 0.9569
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1378 - acc: 0.9569
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1375 - acc: 0.9571
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1365 - acc: 0.9576
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1366 - acc: 0.9575
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1359 - acc: 0.9579
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1371 - acc: 0.9575
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1371 - acc: 0.9573
1472/1506 [============================>.] - ETA: 0s - loss: 0.1368 - acc: 0.9573
1504/1506 [============================>.] - ETA: 0s - loss: 0.1372 - acc: 0.9571
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1371 - acc: 0.9571 - val_loss: 0.2338 - val_acc: 0.9328
Epoch 7/70

  32/1506 [..............................] - ETA: 27s - loss: 0.1466 - acc: 0.9577
  64/1506 [>.............................] - ETA: 26s - loss: 0.1421 - acc: 0.9588
  96/1506 [>.............................] - ETA: 26s - loss: 0.1453 - acc: 0.9568
 128/1506 [=>............................] - ETA: 25s - loss: 0.1401 - acc: 0.9564
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1394 - acc: 0.9554
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1383 - acc: 0.9556
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1293 - acc: 0.9591
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1304 - acc: 0.9595
 288/1506 [====>.........................] - ETA: 23s - loss: 0.1327 - acc: 0.9580
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1296 - acc: 0.9595
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1288 - acc: 0.9597
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1239 - acc: 0.9609
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1250 - acc: 0.9606
 448/1506 [=======>......................] - ETA: 20s - loss: 0.1266 - acc: 0.9599
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1248 - acc: 0.9607
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1231 - acc: 0.9610
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1240 - acc: 0.9608
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1234 - acc: 0.9610
 608/1506 [===========>..................] - ETA: 16s - loss: 0.1206 - acc: 0.9619
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1208 - acc: 0.9620
 672/1506 [============>.................] - ETA: 15s - loss: 0.1186 - acc: 0.9626
 704/1506 [=============>................] - ETA: 15s - loss: 0.1200 - acc: 0.9621
 736/1506 [=============>................] - ETA: 14s - loss: 0.1208 - acc: 0.9619
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1216 - acc: 0.9618
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1221 - acc: 0.9619
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1211 - acc: 0.9623
 864/1506 [================>.............] - ETA: 12s - loss: 0.1221 - acc: 0.9622
 896/1506 [================>.............] - ETA: 11s - loss: 0.1211 - acc: 0.9625
 928/1506 [=================>............] - ETA: 10s - loss: 0.1205 - acc: 0.9628
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1218 - acc: 0.9626
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1239 - acc: 0.9622 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1236 - acc: 0.9622
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1235 - acc: 0.9622
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1249 - acc: 0.9614
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1252 - acc: 0.9610
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1256 - acc: 0.9606
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1251 - acc: 0.9607
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1240 - acc: 0.9609
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1237 - acc: 0.9609
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1230 - acc: 0.9611
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1221 - acc: 0.9613
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1237 - acc: 0.9611
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1229 - acc: 0.9613
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1223 - acc: 0.9617
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1230 - acc: 0.9617
1472/1506 [============================>.] - ETA: 0s - loss: 0.1221 - acc: 0.9620
1504/1506 [============================>.] - ETA: 0s - loss: 0.1216 - acc: 0.9623
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1218 - acc: 0.9623 - val_loss: 0.1839 - val_acc: 0.9456
Epoch 8/70

  32/1506 [..............................] - ETA: 28s - loss: 0.1286 - acc: 0.9636
  64/1506 [>.............................] - ETA: 27s - loss: 0.1453 - acc: 0.9597
  96/1506 [>.............................] - ETA: 26s - loss: 0.1369 - acc: 0.9635
 128/1506 [=>............................] - ETA: 25s - loss: 0.1316 - acc: 0.9642
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1326 - acc: 0.9638
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1355 - acc: 0.9617
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1272 - acc: 0.9636
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1273 - acc: 0.9631
 288/1506 [====>.........................] - ETA: 23s - loss: 0.1248 - acc: 0.9642
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1254 - acc: 0.9636
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1256 - acc: 0.9632
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1262 - acc: 0.9631
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1301 - acc: 0.9617
 448/1506 [=======>......................] - ETA: 20s - loss: 0.1278 - acc: 0.9623
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1268 - acc: 0.9629
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1240 - acc: 0.9637
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1209 - acc: 0.9643
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1189 - acc: 0.9646
 608/1506 [===========>..................] - ETA: 17s - loss: 0.1165 - acc: 0.9653
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1151 - acc: 0.9657
 672/1506 [============>.................] - ETA: 15s - loss: 0.1137 - acc: 0.9664
 704/1506 [=============>................] - ETA: 15s - loss: 0.1142 - acc: 0.9664
 736/1506 [=============>................] - ETA: 14s - loss: 0.1138 - acc: 0.9662
 768/1506 [==============>...............] - ETA: 14s - loss: 0.1121 - acc: 0.9671
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1114 - acc: 0.9672
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1137 - acc: 0.9659
 864/1506 [================>.............] - ETA: 12s - loss: 0.1136 - acc: 0.9657
 896/1506 [================>.............] - ETA: 11s - loss: 0.1156 - acc: 0.9647
 928/1506 [=================>............] - ETA: 10s - loss: 0.1175 - acc: 0.9644
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1171 - acc: 0.9644
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1190 - acc: 0.9638 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1194 - acc: 0.9638
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1193 - acc: 0.9638
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1187 - acc: 0.9640
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1180 - acc: 0.9641
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1177 - acc: 0.9641
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1172 - acc: 0.9644
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1178 - acc: 0.9641
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1177 - acc: 0.9643
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1172 - acc: 0.9644
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1164 - acc: 0.9644
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1159 - acc: 0.9645
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1152 - acc: 0.9646
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1144 - acc: 0.9650
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1139 - acc: 0.9652
1472/1506 [============================>.] - ETA: 0s - loss: 0.1143 - acc: 0.9650
1504/1506 [============================>.] - ETA: 0s - loss: 0.1144 - acc: 0.9650
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1143 - acc: 0.9650 - val_loss: 0.1731 - val_acc: 0.9506
Epoch 9/70

  32/1506 [..............................] - ETA: 28s - loss: 0.1353 - acc: 0.9548
  64/1506 [>.............................] - ETA: 27s - loss: 0.1126 - acc: 0.9614
  96/1506 [>.............................] - ETA: 26s - loss: 0.1103 - acc: 0.9652
 128/1506 [=>............................] - ETA: 26s - loss: 0.1096 - acc: 0.9639
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1037 - acc: 0.9668
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1101 - acc: 0.9650
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1109 - acc: 0.9632
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1113 - acc: 0.9629
 288/1506 [====>.........................] - ETA: 23s - loss: 0.1113 - acc: 0.9631
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1102 - acc: 0.9641
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1153 - acc: 0.9626
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1168 - acc: 0.9618
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1175 - acc: 0.9621
 448/1506 [=======>......................] - ETA: 20s - loss: 0.1155 - acc: 0.9628
 480/1506 [========>.....................] - ETA: 19s - loss: 0.1144 - acc: 0.9633
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1120 - acc: 0.9639
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1110 - acc: 0.9644
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1092 - acc: 0.9651
 608/1506 [===========>..................] - ETA: 16s - loss: 0.1093 - acc: 0.9649
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1087 - acc: 0.9650
 672/1506 [============>.................] - ETA: 15s - loss: 0.1087 - acc: 0.9653
 704/1506 [=============>................] - ETA: 15s - loss: 0.1076 - acc: 0.9658
 736/1506 [=============>................] - ETA: 14s - loss: 0.1071 - acc: 0.9659
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1081 - acc: 0.9655
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1067 - acc: 0.9661
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1054 - acc: 0.9667
 864/1506 [================>.............] - ETA: 12s - loss: 0.1049 - acc: 0.9667
 896/1506 [================>.............] - ETA: 11s - loss: 0.1035 - acc: 0.9672
 928/1506 [=================>............] - ETA: 10s - loss: 0.1021 - acc: 0.9676
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1026 - acc: 0.9676
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1018 - acc: 0.9677 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1012 - acc: 0.9679
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1012 - acc: 0.9681
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1012 - acc: 0.9680
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1027 - acc: 0.9675
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1026 - acc: 0.9675
1184/1506 [======================>.......] - ETA: 6s - loss: 0.1024 - acc: 0.9675
1216/1506 [=======================>......] - ETA: 5s - loss: 0.1023 - acc: 0.9676
1248/1506 [=======================>......] - ETA: 4s - loss: 0.1022 - acc: 0.9675
1280/1506 [========================>.....] - ETA: 4s - loss: 0.1015 - acc: 0.9677
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1012 - acc: 0.9676
1344/1506 [=========================>....] - ETA: 3s - loss: 0.1012 - acc: 0.9674
1376/1506 [==========================>...] - ETA: 2s - loss: 0.1007 - acc: 0.9675
1408/1506 [===========================>..] - ETA: 1s - loss: 0.1005 - acc: 0.9675
1440/1506 [===========================>..] - ETA: 1s - loss: 0.1015 - acc: 0.9671
1472/1506 [============================>.] - ETA: 0s - loss: 0.1028 - acc: 0.9665
1504/1506 [============================>.] - ETA: 0s - loss: 0.1031 - acc: 0.9665
1506/1506 [==============================] - 30s 20ms/step - loss: 0.1032 - acc: 0.9665 - val_loss: 0.2279 - val_acc: 0.9358
Epoch 10/70

  32/1506 [..............................] - ETA: 27s - loss: 0.1575 - acc: 0.9469
  64/1506 [>.............................] - ETA: 27s - loss: 0.1376 - acc: 0.9552
  96/1506 [>.............................] - ETA: 26s - loss: 0.1340 - acc: 0.9564
 128/1506 [=>............................] - ETA: 25s - loss: 0.1241 - acc: 0.9595
 160/1506 [==>...........................] - ETA: 25s - loss: 0.1240 - acc: 0.9605
 192/1506 [==>...........................] - ETA: 24s - loss: 0.1231 - acc: 0.9606
 224/1506 [===>..........................] - ETA: 24s - loss: 0.1206 - acc: 0.9615
 256/1506 [====>.........................] - ETA: 23s - loss: 0.1166 - acc: 0.9631
 288/1506 [====>.........................] - ETA: 23s - loss: 0.1106 - acc: 0.9662
 320/1506 [=====>........................] - ETA: 22s - loss: 0.1066 - acc: 0.9673
 352/1506 [======>.......................] - ETA: 21s - loss: 0.1021 - acc: 0.9688
 384/1506 [======>.......................] - ETA: 21s - loss: 0.1029 - acc: 0.9684
 416/1506 [=======>......................] - ETA: 20s - loss: 0.1031 - acc: 0.9684
 448/1506 [=======>......................] - ETA: 20s - loss: 0.0998 - acc: 0.9693
 480/1506 [========>.....................] - ETA: 19s - loss: 0.0999 - acc: 0.9690
 512/1506 [=========>....................] - ETA: 18s - loss: 0.1017 - acc: 0.9685
 544/1506 [=========>....................] - ETA: 18s - loss: 0.1001 - acc: 0.9687
 576/1506 [==========>...................] - ETA: 17s - loss: 0.1029 - acc: 0.9674
 608/1506 [===========>..................] - ETA: 17s - loss: 0.1033 - acc: 0.9674
 640/1506 [===========>..................] - ETA: 16s - loss: 0.1030 - acc: 0.9677
 672/1506 [============>.................] - ETA: 15s - loss: 0.1044 - acc: 0.9669
 704/1506 [=============>................] - ETA: 15s - loss: 0.1010 - acc: 0.9682
 736/1506 [=============>................] - ETA: 14s - loss: 0.1007 - acc: 0.9683
 768/1506 [==============>...............] - ETA: 13s - loss: 0.1013 - acc: 0.9681
 800/1506 [==============>...............] - ETA: 13s - loss: 0.1007 - acc: 0.9684
 832/1506 [===============>..............] - ETA: 12s - loss: 0.1013 - acc: 0.9682
 864/1506 [================>.............] - ETA: 12s - loss: 0.1004 - acc: 0.9688
 896/1506 [================>.............] - ETA: 11s - loss: 0.1008 - acc: 0.9688
 928/1506 [=================>............] - ETA: 10s - loss: 0.1021 - acc: 0.9683
 960/1506 [==================>...........] - ETA: 10s - loss: 0.1012 - acc: 0.9686
 992/1506 [==================>...........] - ETA: 9s - loss: 0.1009 - acc: 0.9687 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.1016 - acc: 0.9685
1056/1506 [====================>.........] - ETA: 8s - loss: 0.1016 - acc: 0.9686
1088/1506 [====================>.........] - ETA: 7s - loss: 0.1015 - acc: 0.9688
1120/1506 [=====================>........] - ETA: 7s - loss: 0.1016 - acc: 0.9688
1152/1506 [=====================>........] - ETA: 6s - loss: 0.1013 - acc: 0.9690
1184/1506 [======================>.......] - ETA: 6s - loss: 0.0998 - acc: 0.9695
1216/1506 [=======================>......] - ETA: 5s - loss: 0.0999 - acc: 0.9695
1248/1506 [=======================>......] - ETA: 4s - loss: 0.0993 - acc: 0.9697
1280/1506 [========================>.....] - ETA: 4s - loss: 0.0998 - acc: 0.9696
1312/1506 [=========================>....] - ETA: 3s - loss: 0.1001 - acc: 0.9696
1344/1506 [=========================>....] - ETA: 3s - loss: 0.0997 - acc: 0.9696
1376/1506 [==========================>...] - ETA: 2s - loss: 0.0989 - acc: 0.9699
1408/1506 [===========================>..] - ETA: 1s - loss: 0.0987 - acc: 0.9699
1440/1506 [===========================>..] - ETA: 1s - loss: 0.0989 - acc: 0.9698
1472/1506 [============================>.] - ETA: 0s - loss: 0.0979 - acc: 0.9700
1504/1506 [============================>.] - ETA: 0s - loss: 0.0985 - acc: 0.9696
1506/1506 [==============================] - 30s 20ms/step - loss: 0.0984 - acc: 0.9696 - val_loss: 0.1716 - val_acc: 0.9524
Epoch 11/70

  32/1506 [..............................] - ETA: 27s - loss: 0.1272 - acc: 0.9676
  64/1506 [>.............................] - ETA: 27s - loss: 0.0950 - acc: 0.9714
  96/1506 [>.............................] - ETA: 26s - loss: 0.0916 - acc: 0.9695
 128/1506 [=>............................] - ETA: 26s - loss: 0.0818 - acc: 0.9732
 160/1506 [==>...........................] - ETA: 25s - loss: 0.0797 - acc: 0.9741
 192/1506 [==>...........................] - ETA: 24s - loss: 0.0739 - acc: 0.9761
 224/1506 [===>..........................] - ETA: 24s - loss: 0.0743 - acc: 0.9761
 256/1506 [====>.........................] - ETA: 23s - loss: 0.0788 - acc: 0.9753
 288/1506 [====>.........................] - ETA: 23s - loss: 0.0799 - acc: 0.9758
 320/1506 [=====>........................] - ETA: 22s - loss: 0.0807 - acc: 0.9755
 352/1506 [======>.......................] - ETA: 21s - loss: 0.0831 - acc: 0.9738
 384/1506 [======>.......................] - ETA: 21s - loss: 0.0836 - acc: 0.9743
 416/1506 [=======>......................] - ETA: 20s - loss: 0.0872 - acc: 0.9729
 448/1506 [=======>......................] - ETA: 20s - loss: 0.0863 - acc: 0.9729
 480/1506 [========>.....................] - ETA: 19s - loss: 0.0886 - acc: 0.9722
 512/1506 [=========>....................] - ETA: 18s - loss: 0.0877 - acc: 0.9725
 544/1506 [=========>....................] - ETA: 18s - loss: 0.0865 - acc: 0.9729
 576/1506 [==========>...................] - ETA: 17s - loss: 0.0881 - acc: 0.9727
 608/1506 [===========>..................] - ETA: 16s - loss: 0.0876 - acc: 0.9728
 640/1506 [===========>..................] - ETA: 16s - loss: 0.0888 - acc: 0.9729
 672/1506 [============>.................] - ETA: 15s - loss: 0.0886 - acc: 0.9727
 704/1506 [=============>................] - ETA: 15s - loss: 0.0887 - acc: 0.9728
 736/1506 [=============>................] - ETA: 14s - loss: 0.0876 - acc: 0.9731
 768/1506 [==============>...............] - ETA: 13s - loss: 0.0872 - acc: 0.9730
 800/1506 [==============>...............] - ETA: 13s - loss: 0.0856 - acc: 0.9736
 832/1506 [===============>..............] - ETA: 12s - loss: 0.0872 - acc: 0.9733
 864/1506 [================>.............] - ETA: 12s - loss: 0.0882 - acc: 0.9727
 896/1506 [================>.............] - ETA: 11s - loss: 0.0887 - acc: 0.9725
 928/1506 [=================>............] - ETA: 10s - loss: 0.0886 - acc: 0.9724
 960/1506 [==================>...........] - ETA: 10s - loss: 0.0891 - acc: 0.9724
 992/1506 [==================>...........] - ETA: 9s - loss: 0.0889 - acc: 0.9723 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.0887 - acc: 0.9723
1056/1506 [====================>.........] - ETA: 8s - loss: 0.0888 - acc: 0.9722
1088/1506 [====================>.........] - ETA: 7s - loss: 0.0894 - acc: 0.9722
1120/1506 [=====================>........] - ETA: 7s - loss: 0.0902 - acc: 0.9720
1152/1506 [=====================>........] - ETA: 6s - loss: 0.0910 - acc: 0.9717
1184/1506 [======================>.......] - ETA: 6s - loss: 0.0903 - acc: 0.9717
1216/1506 [=======================>......] - ETA: 5s - loss: 0.0896 - acc: 0.9720
1248/1506 [=======================>......] - ETA: 4s - loss: 0.0901 - acc: 0.9719
1280/1506 [========================>.....] - ETA: 4s - loss: 0.0906 - acc: 0.9719
1312/1506 [=========================>....] - ETA: 3s - loss: 0.0902 - acc: 0.9720
1344/1506 [=========================>....] - ETA: 3s - loss: 0.0898 - acc: 0.9721
1376/1506 [==========================>...] - ETA: 2s - loss: 0.0905 - acc: 0.9718
1408/1506 [===========================>..] - ETA: 1s - loss: 0.0903 - acc: 0.9718
1440/1506 [===========================>..] - ETA: 1s - loss: 0.0911 - acc: 0.9716
1472/1506 [============================>.] - ETA: 0s - loss: 0.0906 - acc: 0.9717
1504/1506 [============================>.] - ETA: 0s - loss: 0.0916 - acc: 0.9716
1506/1506 [==============================] - 30s 20ms/step - loss: 0.0915 - acc: 0.9716 - val_loss: 0.1571 - val_acc: 0.9558
Epoch 12/70

  32/1506 [..............................] - ETA: 27s - loss: 0.0845 - acc: 0.9777
  64/1506 [>.............................] - ETA: 27s - loss: 0.0981 - acc: 0.9751
  96/1506 [>.............................] - ETA: 26s - loss: 0.0842 - acc: 0.9783
 128/1506 [=>............................] - ETA: 25s - loss: 0.0808 - acc: 0.9789
 160/1506 [==>...........................] - ETA: 25s - loss: 0.0759 - acc: 0.9802
 192/1506 [==>...........................] - ETA: 24s - loss: 0.0816 - acc: 0.9794
 224/1506 [===>..........................] - ETA: 24s - loss: 0.0786 - acc: 0.9797
 256/1506 [====>.........................] - ETA: 23s - loss: 0.0788 - acc: 0.9786
 288/1506 [====>.........................] - ETA: 22s - loss: 0.0803 - acc: 0.9784
 320/1506 [=====>........................] - ETA: 22s - loss: 0.0828 - acc: 0.9764
 352/1506 [======>.......................] - ETA: 21s - loss: 0.0799 - acc: 0.9773
 384/1506 [======>.......................] - ETA: 21s - loss: 0.0787 - acc: 0.9776
 416/1506 [=======>......................] - ETA: 20s - loss: 0.0786 - acc: 0.9769
 448/1506 [=======>......................] - ETA: 19s - loss: 0.0783 - acc: 0.9766
 480/1506 [========>.....................] - ETA: 19s - loss: 0.0782 - acc: 0.9764
 512/1506 [=========>....................] - ETA: 18s - loss: 0.0779 - acc: 0.9764
 544/1506 [=========>....................] - ETA: 18s - loss: 0.0787 - acc: 0.9764
 576/1506 [==========>...................] - ETA: 17s - loss: 0.0772 - acc: 0.9769
 608/1506 [===========>..................] - ETA: 16s - loss: 0.0787 - acc: 0.9762
 640/1506 [===========>..................] - ETA: 16s - loss: 0.0787 - acc: 0.9761
 672/1506 [============>.................] - ETA: 15s - loss: 0.0776 - acc: 0.9764
 704/1506 [=============>................] - ETA: 15s - loss: 0.0770 - acc: 0.9764
 736/1506 [=============>................] - ETA: 14s - loss: 0.0786 - acc: 0.9760
 768/1506 [==============>...............] - ETA: 13s - loss: 0.0776 - acc: 0.9764
 800/1506 [==============>...............] - ETA: 13s - loss: 0.0769 - acc: 0.9768
 832/1506 [===============>..............] - ETA: 12s - loss: 0.0776 - acc: 0.9766
 864/1506 [================>.............] - ETA: 12s - loss: 0.0771 - acc: 0.9768
 896/1506 [================>.............] - ETA: 11s - loss: 0.0778 - acc: 0.9764
 928/1506 [=================>............] - ETA: 10s - loss: 0.0788 - acc: 0.9761
 960/1506 [==================>...........] - ETA: 10s - loss: 0.0794 - acc: 0.9759
 992/1506 [==================>...........] - ETA: 9s - loss: 0.0798 - acc: 0.9756 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.0795 - acc: 0.9755
1056/1506 [====================>.........] - ETA: 8s - loss: 0.0802 - acc: 0.9751
1088/1506 [====================>.........] - ETA: 7s - loss: 0.0798 - acc: 0.9753
1120/1506 [=====================>........] - ETA: 7s - loss: 0.0790 - acc: 0.9756
1152/1506 [=====================>........] - ETA: 6s - loss: 0.0784 - acc: 0.9758
1184/1506 [======================>.......] - ETA: 6s - loss: 0.0791 - acc: 0.9755
1216/1506 [=======================>......] - ETA: 5s - loss: 0.0803 - acc: 0.9753
1248/1506 [=======================>......] - ETA: 4s - loss: 0.0827 - acc: 0.9747
1280/1506 [========================>.....] - ETA: 4s - loss: 0.0820 - acc: 0.9750
1312/1506 [=========================>....] - ETA: 3s - loss: 0.0827 - acc: 0.9749
1344/1506 [=========================>....] - ETA: 3s - loss: 0.0829 - acc: 0.9747
1376/1506 [==========================>...] - ETA: 2s - loss: 0.0830 - acc: 0.9747
1408/1506 [===========================>..] - ETA: 1s - loss: 0.0834 - acc: 0.9748
1440/1506 [===========================>..] - ETA: 1s - loss: 0.0839 - acc: 0.9745
1472/1506 [============================>.] - ETA: 0s - loss: 0.0830 - acc: 0.9748
1504/1506 [============================>.] - ETA: 0s - loss: 0.0829 - acc: 0.9747
1506/1506 [==============================] - 30s 20ms/step - loss: 0.0830 - acc: 0.9747 - val_loss: 0.1812 - val_acc: 0.9483
Epoch 13/70

  32/1506 [..............................] - ETA: 27s - loss: 0.1125 - acc: 0.9558
  64/1506 [>.............................] - ETA: 26s - loss: 0.0992 - acc: 0.9636
  96/1506 [>.............................] - ETA: 26s - loss: 0.0906 - acc: 0.9679
 128/1506 [=>............................] - ETA: 25s - loss: 0.0935 - acc: 0.9668
 160/1506 [==>...........................] - ETA: 25s - loss: 0.0909 - acc: 0.9687
 192/1506 [==>...........................] - ETA: 24s - loss: 0.0863 - acc: 0.9710
 224/1506 [===>..........................] - ETA: 24s - loss: 0.0869 - acc: 0.9714
 256/1506 [====>.........................] - ETA: 23s - loss: 0.0830 - acc: 0.9725
 288/1506 [====>.........................] - ETA: 23s - loss: 0.0841 - acc: 0.9724
 320/1506 [=====>........................] - ETA: 22s - loss: 0.0872 - acc: 0.9718
 352/1506 [======>.......................] - ETA: 21s - loss: 0.0836 - acc: 0.9732
 384/1506 [======>.......................] - ETA: 21s - loss: 0.0845 - acc: 0.9734
 416/1506 [=======>......................] - ETA: 20s - loss: 0.0840 - acc: 0.9734
 448/1506 [=======>......................] - ETA: 19s - loss: 0.0851 - acc: 0.9734
 480/1506 [========>.....................] - ETA: 19s - loss: 0.0826 - acc: 0.9741
 512/1506 [=========>....................] - ETA: 18s - loss: 0.0833 - acc: 0.9737
 544/1506 [=========>....................] - ETA: 18s - loss: 0.0839 - acc: 0.9733
 576/1506 [==========>...................] - ETA: 17s - loss: 0.0837 - acc: 0.9737
 608/1506 [===========>..................] - ETA: 17s - loss: 0.0812 - acc: 0.9748
 640/1506 [===========>..................] - ETA: 16s - loss: 0.0799 - acc: 0.9755
 672/1506 [============>.................] - ETA: 15s - loss: 0.0808 - acc: 0.9752
 704/1506 [=============>................] - ETA: 15s - loss: 0.0806 - acc: 0.9753
 736/1506 [=============>................] - ETA: 14s - loss: 0.0790 - acc: 0.9760
 768/1506 [==============>...............] - ETA: 13s - loss: 0.0793 - acc: 0.9759
 800/1506 [==============>...............] - ETA: 13s - loss: 0.0804 - acc: 0.9755
 832/1506 [===============>..............] - ETA: 12s - loss: 0.0795 - acc: 0.9759
 864/1506 [================>.............] - ETA: 12s - loss: 0.0795 - acc: 0.9759
 896/1506 [================>.............] - ETA: 11s - loss: 0.0797 - acc: 0.9758
 928/1506 [=================>............] - ETA: 10s - loss: 0.0794 - acc: 0.9759
 960/1506 [==================>...........] - ETA: 10s - loss: 0.0788 - acc: 0.9761
 992/1506 [==================>...........] - ETA: 9s - loss: 0.0781 - acc: 0.9763 
1024/1506 [===================>..........] - ETA: 9s - loss: 0.0790 - acc: 0.9762
1056/1506 [====================>.........] - ETA: 8s - loss: 0.0796 - acc: 0.9760
1088/1506 [====================>.........] - ETA: 7s - loss: 0.0786 - acc: 0.9762
1120/1506 [=====================>........] - ETA: 7s - loss: 0.0785 - acc: 0.9761
1152/1506 [=====================>........] - ETA: 6s - loss: 0.0780 - acc: 0.9762
1184/1506 [======================>.......] - ETA: 6s - loss: 0.0775 - acc: 0.9763
1216/1506 [=======================>......] - ETA: 5s - loss: 0.0787 - acc: 0.9760
1248/1506 [=======================>......] - ETA: 4s - loss: 0.0788 - acc: 0.9758
1280/1506 [========================>.....] - ETA: 4s - loss: 0.0791 - acc: 0.9756
1312/1506 [=========================>....] - ETA: 3s - loss: 0.0796 - acc: 0.9754
1344/1506 [=========================>....] - ETA: 3s - loss: 0.0796 - acc: 0.9755
1376/1506 [==========================>...] - ETA: 2s - loss: 0.0788 - acc: 0.9757
1408/1506 [===========================>..] - ETA: 1s - loss: 0.0796 - acc: 0.9755
1440/1506 [===========================>..] - ETA: 1s - loss: 0.0794 - acc: 0.9756
1472/1506 [============================>.] - ETA: 0s - loss: 0.0793 - acc: 0.9754
1504/1506 [============================>.] - ETA: 0s - loss: 0.0793 - acc: 0.9753
1506/1506 [==============================] - 30s 20ms/step - loss: 0.0795 - acc: 0.9753 - val_loss: 0.1673 - val_acc: 0.9551
Computing...
Manual evaluation: (didn't understand why I made this)
True 8229
False 842
True percentage 0.90717671701
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
      B-ORG       0.78      0.66      0.71       296
      I-ORG       0.67      0.54      0.60       151
      B-PER       0.92      0.86      0.89       438
     B-MISC       0.35      0.39      0.37       141
     I-MISC       0.57      0.36      0.44       154
      B-LOC       0.66      0.79      0.72       218
      I-LOC       0.70      0.82      0.76       141
      I-PER       0.91      0.65      0.76       214

avg / total       0.94      0.91      0.92      9071

F-1 Score:
0.708680142687
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 837 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100846 unique words.
Found 94 unique chars.
Found 9 unique labels.
842 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 257
OOV word occurences: 384
Padding...
Data padded!
Padding...
Data padded!
Padded until 83 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6454208     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,957,314
Trainable params: 6,957,314
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 753 samples, validate on 84 samples
Epoch 1/70

 32/753 [>.............................] - ETA: 1:11 - loss: 2.1249 - acc: 0.2640
 64/753 [=>............................] - ETA: 41s - loss: 1.5595 - acc: 0.5247 
 96/753 [==>...........................] - ETA: 31s - loss: 1.8810 - acc: 0.6129
128/753 [====>.........................] - ETA: 25s - loss: 1.6889 - acc: 0.6570
160/753 [=====>........................] - ETA: 21s - loss: 1.5004 - acc: 0.6884
192/753 [======>.......................] - ETA: 19s - loss: 1.3901 - acc: 0.7020
224/753 [=======>......................] - ETA: 17s - loss: 1.2792 - acc: 0.7208
256/753 [=========>....................] - ETA: 15s - loss: 1.2216 - acc: 0.7277
288/753 [==========>...................] - ETA: 13s - loss: 1.1640 - acc: 0.7358
320/753 [===========>..................] - ETA: 12s - loss: 1.1123 - acc: 0.7430
352/753 [=============>................] - ETA: 11s - loss: 1.0727 - acc: 0.7480
384/753 [==============>...............] - ETA: 10s - loss: 1.0316 - acc: 0.7549
416/753 [===============>..............] - ETA: 8s - loss: 1.0043 - acc: 0.7570 
448/753 [================>.............] - ETA: 7s - loss: 0.9719 - acc: 0.7633
480/753 [==================>...........] - ETA: 7s - loss: 0.9418 - acc: 0.7689
512/753 [===================>..........] - ETA: 6s - loss: 0.9181 - acc: 0.7727
544/753 [====================>.........] - ETA: 5s - loss: 0.8934 - acc: 0.7765
576/753 [=====================>........] - ETA: 4s - loss: 0.8659 - acc: 0.7826
608/753 [=======================>......] - ETA: 3s - loss: 0.8858 - acc: 0.7845
640/753 [========================>.....] - ETA: 2s - loss: 0.8805 - acc: 0.7857
672/753 [=========================>....] - ETA: 1s - loss: 0.8618 - acc: 0.7898
704/753 [===========================>..] - ETA: 1s - loss: 0.8447 - acc: 0.7926
736/753 [============================>.] - ETA: 0s - loss: 0.8307 - acc: 0.7947
753/753 [==============================] - 19s 25ms/step - loss: 0.8274 - acc: 0.7939 - val_loss: 0.4674 - val_acc: 0.8811
Epoch 2/70

 32/753 [>.............................] - ETA: 13s - loss: 0.4063 - acc: 0.9035
 64/753 [=>............................] - ETA: 13s - loss: 0.4336 - acc: 0.8863
 96/753 [==>...........................] - ETA: 12s - loss: 0.4272 - acc: 0.8774
128/753 [====>.........................] - ETA: 12s - loss: 0.4127 - acc: 0.8788
160/753 [=====>........................] - ETA: 11s - loss: 0.3959 - acc: 0.8822
192/753 [======>.......................] - ETA: 10s - loss: 0.3911 - acc: 0.8822
224/753 [=======>......................] - ETA: 10s - loss: 0.3895 - acc: 0.8827
256/753 [=========>....................] - ETA: 9s - loss: 0.3841 - acc: 0.8837 
288/753 [==========>...................] - ETA: 8s - loss: 0.3790 - acc: 0.8853
320/753 [===========>..................] - ETA: 8s - loss: 0.3691 - acc: 0.8888
352/753 [=============>................] - ETA: 7s - loss: 0.3718 - acc: 0.8869
384/753 [==============>...............] - ETA: 7s - loss: 0.3734 - acc: 0.8872
416/753 [===============>..............] - ETA: 6s - loss: 0.3795 - acc: 0.8852
448/753 [================>.............] - ETA: 5s - loss: 0.3775 - acc: 0.8856
480/753 [==================>...........] - ETA: 5s - loss: 0.3794 - acc: 0.8845
512/753 [===================>..........] - ETA: 4s - loss: 0.3773 - acc: 0.8852
544/753 [====================>.........] - ETA: 4s - loss: 0.3807 - acc: 0.8844
576/753 [=====================>........] - ETA: 3s - loss: 0.3811 - acc: 0.8836
608/753 [=======================>......] - ETA: 2s - loss: 0.3804 - acc: 0.8831
640/753 [========================>.....] - ETA: 2s - loss: 0.3806 - acc: 0.8828
672/753 [=========================>....] - ETA: 1s - loss: 0.3781 - acc: 0.8835
704/753 [===========================>..] - ETA: 0s - loss: 0.3772 - acc: 0.8834
736/753 [============================>.] - ETA: 0s - loss: 0.3747 - acc: 0.8846
753/753 [==============================] - 15s 20ms/step - loss: 0.3740 - acc: 0.8845 - val_loss: 0.3524 - val_acc: 0.8857
Epoch 3/70

 32/753 [>.............................] - ETA: 13s - loss: 0.4448 - acc: 0.8613
 64/753 [=>............................] - ETA: 13s - loss: 0.3775 - acc: 0.8798
 96/753 [==>...........................] - ETA: 12s - loss: 0.3725 - acc: 0.8876
128/753 [====>.........................] - ETA: 11s - loss: 0.3676 - acc: 0.8873
160/753 [=====>........................] - ETA: 11s - loss: 0.3514 - acc: 0.8917
192/753 [======>.......................] - ETA: 10s - loss: 0.3285 - acc: 0.8996
224/753 [=======>......................] - ETA: 10s - loss: 0.3157 - acc: 0.9041
256/753 [=========>....................] - ETA: 9s - loss: 0.3070 - acc: 0.9058 
288/753 [==========>...................] - ETA: 8s - loss: 0.3009 - acc: 0.9078
320/753 [===========>..................] - ETA: 8s - loss: 0.3040 - acc: 0.9065
352/753 [=============>................] - ETA: 7s - loss: 0.2979 - acc: 0.9090
384/753 [==============>...............] - ETA: 7s - loss: 0.2945 - acc: 0.9100
416/753 [===============>..............] - ETA: 6s - loss: 0.2937 - acc: 0.9093
448/753 [================>.............] - ETA: 5s - loss: 0.2907 - acc: 0.9101
480/753 [==================>...........] - ETA: 5s - loss: 0.2890 - acc: 0.9104
512/753 [===================>..........] - ETA: 4s - loss: 0.2873 - acc: 0.9110
544/753 [====================>.........] - ETA: 3s - loss: 0.2833 - acc: 0.9124
576/753 [=====================>........] - ETA: 3s - loss: 0.2851 - acc: 0.9114
608/753 [=======================>......] - ETA: 2s - loss: 0.2857 - acc: 0.9108
640/753 [========================>.....] - ETA: 2s - loss: 0.2849 - acc: 0.9117
672/753 [=========================>....] - ETA: 1s - loss: 0.2874 - acc: 0.9105
704/753 [===========================>..] - ETA: 0s - loss: 0.2857 - acc: 0.9114
736/753 [============================>.] - ETA: 0s - loss: 0.2863 - acc: 0.9106
753/753 [==============================] - 15s 20ms/step - loss: 0.2857 - acc: 0.9112 - val_loss: 0.2623 - val_acc: 0.9135
Epoch 4/70

 32/753 [>.............................] - ETA: 13s - loss: 0.2205 - acc: 0.9183
 64/753 [=>............................] - ETA: 13s - loss: 0.2287 - acc: 0.9246
 96/753 [==>...........................] - ETA: 12s - loss: 0.2442 - acc: 0.9183
128/753 [====>.........................] - ETA: 11s - loss: 0.2400 - acc: 0.9222
160/753 [=====>........................] - ETA: 11s - loss: 0.2368 - acc: 0.9249
192/753 [======>.......................] - ETA: 10s - loss: 0.2293 - acc: 0.9296
224/753 [=======>......................] - ETA: 10s - loss: 0.2256 - acc: 0.9299
256/753 [=========>....................] - ETA: 9s - loss: 0.2277 - acc: 0.9290 
288/753 [==========>...................] - ETA: 8s - loss: 0.2205 - acc: 0.9325
320/753 [===========>..................] - ETA: 8s - loss: 0.2197 - acc: 0.9328
352/753 [=============>................] - ETA: 7s - loss: 0.2218 - acc: 0.9322
384/753 [==============>...............] - ETA: 7s - loss: 0.2277 - acc: 0.9309
416/753 [===============>..............] - ETA: 6s - loss: 0.2309 - acc: 0.9304
448/753 [================>.............] - ETA: 5s - loss: 0.2286 - acc: 0.9320
480/753 [==================>...........] - ETA: 5s - loss: 0.2313 - acc: 0.9313
512/753 [===================>..........] - ETA: 4s - loss: 0.2384 - acc: 0.9290
544/753 [====================>.........] - ETA: 3s - loss: 0.2365 - acc: 0.9295
576/753 [=====================>........] - ETA: 3s - loss: 0.2342 - acc: 0.9298
608/753 [=======================>......] - ETA: 2s - loss: 0.2390 - acc: 0.9273
640/753 [========================>.....] - ETA: 2s - loss: 0.2400 - acc: 0.9268
672/753 [=========================>....] - ETA: 1s - loss: 0.2417 - acc: 0.9257
704/753 [===========================>..] - ETA: 0s - loss: 0.2420 - acc: 0.9249
736/753 [============================>.] - ETA: 0s - loss: 0.2405 - acc: 0.9255
753/753 [==============================] - 15s 20ms/step - loss: 0.2389 - acc: 0.9262 - val_loss: 0.2215 - val_acc: 0.9260
Epoch 5/70

 32/753 [>.............................] - ETA: 13s - loss: 0.1661 - acc: 0.9478
 64/753 [=>............................] - ETA: 13s - loss: 0.1734 - acc: 0.9450
 96/753 [==>...........................] - ETA: 12s - loss: 0.2127 - acc: 0.9301
128/753 [====>.........................] - ETA: 11s - loss: 0.2101 - acc: 0.9320
160/753 [=====>........................] - ETA: 11s - loss: 0.2108 - acc: 0.9308
192/753 [======>.......................] - ETA: 10s - loss: 0.2097 - acc: 0.9312
224/753 [=======>......................] - ETA: 10s - loss: 0.1991 - acc: 0.9355
256/753 [=========>....................] - ETA: 9s - loss: 0.1964 - acc: 0.9374 
288/753 [==========>...................] - ETA: 8s - loss: 0.1898 - acc: 0.9395
320/753 [===========>..................] - ETA: 8s - loss: 0.1886 - acc: 0.9401
352/753 [=============>................] - ETA: 7s - loss: 0.1895 - acc: 0.9398
384/753 [==============>...............] - ETA: 6s - loss: 0.1986 - acc: 0.9364
416/753 [===============>..............] - ETA: 6s - loss: 0.2018 - acc: 0.9361
448/753 [================>.............] - ETA: 5s - loss: 0.2024 - acc: 0.9356
480/753 [==================>...........] - ETA: 5s - loss: 0.2093 - acc: 0.9337
512/753 [===================>..........] - ETA: 4s - loss: 0.2065 - acc: 0.9353
544/753 [====================>.........] - ETA: 3s - loss: 0.2051 - acc: 0.9353
576/753 [=====================>........] - ETA: 3s - loss: 0.2053 - acc: 0.9351
608/753 [=======================>......] - ETA: 2s - loss: 0.2087 - acc: 0.9341
640/753 [========================>.....] - ETA: 2s - loss: 0.2083 - acc: 0.9342
672/753 [=========================>....] - ETA: 1s - loss: 0.2073 - acc: 0.9342
704/753 [===========================>..] - ETA: 0s - loss: 0.2054 - acc: 0.9351
736/753 [============================>.] - ETA: 0s - loss: 0.2042 - acc: 0.9357
753/753 [==============================] - 15s 20ms/step - loss: 0.2041 - acc: 0.9355 - val_loss: 0.2110 - val_acc: 0.9345
Epoch 6/70

 32/753 [>.............................] - ETA: 13s - loss: 0.2190 - acc: 0.9309
 64/753 [=>............................] - ETA: 13s - loss: 0.2122 - acc: 0.9342
 96/753 [==>...........................] - ETA: 12s - loss: 0.1872 - acc: 0.9438
128/753 [====>.........................] - ETA: 11s - loss: 0.1755 - acc: 0.9466
160/753 [=====>........................] - ETA: 11s - loss: 0.1821 - acc: 0.9459
192/753 [======>.......................] - ETA: 10s - loss: 0.1787 - acc: 0.9459
224/753 [=======>......................] - ETA: 10s - loss: 0.1779 - acc: 0.9456
256/753 [=========>....................] - ETA: 9s - loss: 0.1834 - acc: 0.9440 
288/753 [==========>...................] - ETA: 8s - loss: 0.2002 - acc: 0.9382
320/753 [===========>..................] - ETA: 8s - loss: 0.1945 - acc: 0.9408
352/753 [=============>................] - ETA: 7s - loss: 0.1985 - acc: 0.9380
384/753 [==============>...............] - ETA: 7s - loss: 0.2008 - acc: 0.9376
416/753 [===============>..............] - ETA: 6s - loss: 0.1979 - acc: 0.9382
448/753 [================>.............] - ETA: 5s - loss: 0.1949 - acc: 0.9385
480/753 [==================>...........] - ETA: 5s - loss: 0.1930 - acc: 0.9392
512/753 [===================>..........] - ETA: 4s - loss: 0.1889 - acc: 0.9405
544/753 [====================>.........] - ETA: 3s - loss: 0.1907 - acc: 0.9394
576/753 [=====================>........] - ETA: 3s - loss: 0.1895 - acc: 0.9405
608/753 [=======================>......] - ETA: 2s - loss: 0.1875 - acc: 0.9408
640/753 [========================>.....] - ETA: 2s - loss: 0.1902 - acc: 0.9398
672/753 [=========================>....] - ETA: 1s - loss: 0.1888 - acc: 0.9400
704/753 [===========================>..] - ETA: 0s - loss: 0.1872 - acc: 0.9409
736/753 [============================>.] - ETA: 0s - loss: 0.1854 - acc: 0.9416
753/753 [==============================] - 15s 20ms/step - loss: 0.1864 - acc: 0.9414 - val_loss: 0.2115 - val_acc: 0.9289
Epoch 7/70

 32/753 [>.............................] - ETA: 13s - loss: 0.1283 - acc: 0.9584
 64/753 [=>............................] - ETA: 13s - loss: 0.1627 - acc: 0.9489
 96/753 [==>...........................] - ETA: 12s - loss: 0.1568 - acc: 0.9516
128/753 [====>.........................] - ETA: 11s - loss: 0.1599 - acc: 0.9491
160/753 [=====>........................] - ETA: 11s - loss: 0.1528 - acc: 0.9511
192/753 [======>.......................] - ETA: 10s - loss: 0.1469 - acc: 0.9533
224/753 [=======>......................] - ETA: 10s - loss: 0.1578 - acc: 0.9495
256/753 [=========>....................] - ETA: 9s - loss: 0.1590 - acc: 0.9499 
288/753 [==========>...................] - ETA: 8s - loss: 0.1614 - acc: 0.9482
320/753 [===========>..................] - ETA: 8s - loss: 0.1573 - acc: 0.9493
352/753 [=============>................] - ETA: 7s - loss: 0.1556 - acc: 0.9503
384/753 [==============>...............] - ETA: 6s - loss: 0.1656 - acc: 0.9478
416/753 [===============>..............] - ETA: 6s - loss: 0.1656 - acc: 0.9484
448/753 [================>.............] - ETA: 5s - loss: 0.1636 - acc: 0.9482
480/753 [==================>...........] - ETA: 5s - loss: 0.1634 - acc: 0.9484
512/753 [===================>..........] - ETA: 4s - loss: 0.1636 - acc: 0.9484
544/753 [====================>.........] - ETA: 3s - loss: 0.1625 - acc: 0.9491
576/753 [=====================>........] - ETA: 3s - loss: 0.1647 - acc: 0.9483
608/753 [=======================>......] - ETA: 2s - loss: 0.1663 - acc: 0.9479
640/753 [========================>.....] - ETA: 2s - loss: 0.1674 - acc: 0.9476
672/753 [=========================>....] - ETA: 1s - loss: 0.1660 - acc: 0.9479
704/753 [===========================>..] - ETA: 0s - loss: 0.1665 - acc: 0.9480
736/753 [============================>.] - ETA: 0s - loss: 0.1657 - acc: 0.9483
753/753 [==============================] - 15s 20ms/step - loss: 0.1653 - acc: 0.9484 - val_loss: 0.1872 - val_acc: 0.9366
Epoch 8/70

 32/753 [>.............................] - ETA: 13s - loss: 0.1505 - acc: 0.9517
 64/753 [=>............................] - ETA: 13s - loss: 0.1607 - acc: 0.9499
 96/753 [==>...........................] - ETA: 12s - loss: 0.1570 - acc: 0.9545
128/753 [====>.........................] - ETA: 11s - loss: 0.1603 - acc: 0.9510
160/753 [=====>........................] - ETA: 11s - loss: 0.1609 - acc: 0.9515
192/753 [======>.......................] - ETA: 10s - loss: 0.1523 - acc: 0.9532
224/753 [=======>......................] - ETA: 10s - loss: 0.1591 - acc: 0.9520
256/753 [=========>....................] - ETA: 9s - loss: 0.1571 - acc: 0.9533 
288/753 [==========>...................] - ETA: 8s - loss: 0.1520 - acc: 0.9538
320/753 [===========>..................] - ETA: 8s - loss: 0.1545 - acc: 0.9524
352/753 [=============>................] - ETA: 7s - loss: 0.1602 - acc: 0.9481
384/753 [==============>...............] - ETA: 7s - loss: 0.1589 - acc: 0.9481
416/753 [===============>..............] - ETA: 6s - loss: 0.1558 - acc: 0.9500
448/753 [================>.............] - ETA: 5s - loss: 0.1527 - acc: 0.9508
480/753 [==================>...........] - ETA: 5s - loss: 0.1506 - acc: 0.9513
512/753 [===================>..........] - ETA: 4s - loss: 0.1509 - acc: 0.9510
544/753 [====================>.........] - ETA: 3s - loss: 0.1491 - acc: 0.9516
576/753 [=====================>........] - ETA: 3s - loss: 0.1483 - acc: 0.9519
608/753 [=======================>......] - ETA: 2s - loss: 0.1472 - acc: 0.9523
640/753 [========================>.....] - ETA: 2s - loss: 0.1469 - acc: 0.9523
672/753 [=========================>....] - ETA: 1s - loss: 0.1441 - acc: 0.9535
704/753 [===========================>..] - ETA: 0s - loss: 0.1467 - acc: 0.9529
736/753 [============================>.] - ETA: 0s - loss: 0.1482 - acc: 0.9530
753/753 [==============================] - 15s 20ms/step - loss: 0.1492 - acc: 0.9525 - val_loss: 0.1825 - val_acc: 0.9415
Epoch 9/70

 32/753 [>.............................] - ETA: 13s - loss: 0.2085 - acc: 0.9462
 64/753 [=>............................] - ETA: 13s - loss: 0.1605 - acc: 0.9548
 96/753 [==>...........................] - ETA: 12s - loss: 0.1573 - acc: 0.9504
128/753 [====>.........................] - ETA: 12s - loss: 0.1596 - acc: 0.9514
160/753 [=====>........................] - ETA: 11s - loss: 0.1540 - acc: 0.9546
192/753 [======>.......................] - ETA: 10s - loss: 0.1431 - acc: 0.9575
224/753 [=======>......................] - ETA: 10s - loss: 0.1390 - acc: 0.9591
256/753 [=========>....................] - ETA: 9s - loss: 0.1350 - acc: 0.9609 
288/753 [==========>...................] - ETA: 8s - loss: 0.1362 - acc: 0.9585
320/753 [===========>..................] - ETA: 8s - loss: 0.1347 - acc: 0.9593
352/753 [=============>................] - ETA: 7s - loss: 0.1325 - acc: 0.9599
384/753 [==============>...............] - ETA: 7s - loss: 0.1321 - acc: 0.9607
416/753 [===============>..............] - ETA: 6s - loss: 0.1317 - acc: 0.9613
448/753 [================>.............] - ETA: 5s - loss: 0.1314 - acc: 0.9621
480/753 [==================>...........] - ETA: 5s - loss: 0.1312 - acc: 0.9624
512/753 [===================>..........] - ETA: 4s - loss: 0.1318 - acc: 0.9619
544/753 [====================>.........] - ETA: 3s - loss: 0.1325 - acc: 0.9616
576/753 [=====================>........] - ETA: 3s - loss: 0.1319 - acc: 0.9617
608/753 [=======================>......] - ETA: 2s - loss: 0.1320 - acc: 0.9616
640/753 [========================>.....] - ETA: 2s - loss: 0.1337 - acc: 0.9613
672/753 [=========================>....] - ETA: 1s - loss: 0.1317 - acc: 0.9621
704/753 [===========================>..] - ETA: 0s - loss: 0.1321 - acc: 0.9617
736/753 [============================>.] - ETA: 0s - loss: 0.1338 - acc: 0.9613
753/753 [==============================] - 15s 20ms/step - loss: 0.1332 - acc: 0.9614 - val_loss: 0.1966 - val_acc: 0.9313
Epoch 10/70

 32/753 [>.............................] - ETA: 13s - loss: 0.1229 - acc: 0.9623
 64/753 [=>............................] - ETA: 13s - loss: 0.1303 - acc: 0.9560
 96/753 [==>...........................] - ETA: 12s - loss: 0.1151 - acc: 0.9622
128/753 [====>.........................] - ETA: 11s - loss: 0.1208 - acc: 0.9634
160/753 [=====>........................] - ETA: 11s - loss: 0.1194 - acc: 0.9646
192/753 [======>.......................] - ETA: 10s - loss: 0.1305 - acc: 0.9623
224/753 [=======>......................] - ETA: 10s - loss: 0.1296 - acc: 0.9634
256/753 [=========>....................] - ETA: 9s - loss: 0.1286 - acc: 0.9635 
288/753 [==========>...................] - ETA: 8s - loss: 0.1338 - acc: 0.9610
320/753 [===========>..................] - ETA: 8s - loss: 0.1303 - acc: 0.9615
352/753 [=============>................] - ETA: 7s - loss: 0.1291 - acc: 0.9619
384/753 [==============>...............] - ETA: 7s - loss: 0.1272 - acc: 0.9620
416/753 [===============>..............] - ETA: 6s - loss: 0.1304 - acc: 0.9605
448/753 [================>.............] - ETA: 5s - loss: 0.1314 - acc: 0.9611
480/753 [==================>...........] - ETA: 5s - loss: 0.1342 - acc: 0.9606
512/753 [===================>..........] - ETA: 4s - loss: 0.1311 - acc: 0.9613
544/753 [====================>.........] - ETA: 3s - loss: 0.1299 - acc: 0.9614
576/753 [=====================>........] - ETA: 3s - loss: 0.1275 - acc: 0.9619
608/753 [=======================>......] - ETA: 2s - loss: 0.1276 - acc: 0.9614
640/753 [========================>.....] - ETA: 2s - loss: 0.1277 - acc: 0.9612
672/753 [=========================>....] - ETA: 1s - loss: 0.1282 - acc: 0.9607
704/753 [===========================>..] - ETA: 0s - loss: 0.1275 - acc: 0.9609
736/753 [============================>.] - ETA: 0s - loss: 0.1281 - acc: 0.9605
753/753 [==============================] - 15s 20ms/step - loss: 0.1269 - acc: 0.9608 - val_loss: 0.1860 - val_acc: 0.9385
Computing...
Manual evaluation: (didn't understand why I made this)
True 8059
False 1012
True percentage 0.888435674126
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.96      0.97      7318
      B-PER       0.90      0.74      0.81       438
      B-LOC       0.70      0.74      0.72       218
      B-ORG       0.71      0.64      0.67       296
      I-ORG       0.59      0.34      0.43       151
      I-PER       0.91      0.59      0.71       214
      I-LOC       0.66      0.76      0.71       141
     B-MISC       0.31      0.11      0.16       141
     I-MISC       0.40      0.42      0.41       154

avg / total       0.92      0.89      0.90      9071

F-1 Score:
0.645443196005
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 837 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100833 unique words.
Found 94 unique chars.
Found 9 unique labels.
829 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 254
OOV word occurences: 364
Padding...
Data padded!
Padding...
Data padded!
Padded until 83 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6453376     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,956,482
Trainable params: 6,956,482
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 753 samples, validate on 84 samples
Epoch 1/70

 32/753 [>.............................] - ETA: 1:11 - loss: 2.2380 - acc: 0.0395
 64/753 [=>............................] - ETA: 41s - loss: 1.6397 - acc: 0.4104 
 96/753 [==>...........................] - ETA: 30s - loss: 1.9283 - acc: 0.5428
128/753 [====>.........................] - ETA: 25s - loss: 1.6923 - acc: 0.6125
160/753 [=====>........................] - ETA: 21s - loss: 1.4968 - acc: 0.6561
192/753 [======>.......................] - ETA: 19s - loss: 1.3864 - acc: 0.6787
224/753 [=======>......................] - ETA: 16s - loss: 1.2869 - acc: 0.6999
256/753 [=========>....................] - ETA: 15s - loss: 1.2037 - acc: 0.7157
288/753 [==========>...................] - ETA: 13s - loss: 1.1572 - acc: 0.7233
320/753 [===========>..................] - ETA: 12s - loss: 1.1166 - acc: 0.7295
352/753 [=============>................] - ETA: 11s - loss: 1.0650 - acc: 0.7383
384/753 [==============>...............] - ETA: 10s - loss: 1.0278 - acc: 0.7439
416/753 [===============>..............] - ETA: 8s - loss: 0.9951 - acc: 0.7492 
448/753 [================>.............] - ETA: 7s - loss: 0.9708 - acc: 0.7515
480/753 [==================>...........] - ETA: 6s - loss: 0.9357 - acc: 0.7595
512/753 [===================>..........] - ETA: 6s - loss: 0.9061 - acc: 0.7654
544/753 [====================>.........] - ETA: 5s - loss: 0.8871 - acc: 0.7704
576/753 [=====================>........] - ETA: 4s - loss: 0.8654 - acc: 0.7750
608/753 [=======================>......] - ETA: 3s - loss: 0.8523 - acc: 0.7765
640/753 [========================>.....] - ETA: 2s - loss: 0.8442 - acc: 0.7775
672/753 [=========================>....] - ETA: 1s - loss: 0.8293 - acc: 0.7799
704/753 [===========================>..] - ETA: 1s - loss: 0.8145 - acc: 0.7845
736/753 [============================>.] - ETA: 0s - loss: 0.8053 - acc: 0.7865
753/753 [==============================] - 19s 25ms/step - loss: 0.8037 - acc: 0.7870 - val_loss: 0.4442 - val_acc: 0.8694
Epoch 2/70

 32/753 [>.............................] - ETA: 14s - loss: 0.4507 - acc: 0.8648
 64/753 [=>............................] - ETA: 13s - loss: 0.3959 - acc: 0.8831
 96/753 [==>...........................] - ETA: 12s - loss: 0.3771 - acc: 0.8880
128/753 [====>.........................] - ETA: 12s - loss: 0.3654 - acc: 0.8952
160/753 [=====>........................] - ETA: 11s - loss: 0.3714 - acc: 0.8916
192/753 [======>.......................] - ETA: 10s - loss: 0.3931 - acc: 0.8845
224/753 [=======>......................] - ETA: 10s - loss: 0.3917 - acc: 0.8849
256/753 [=========>....................] - ETA: 9s - loss: 0.3876 - acc: 0.8860 
288/753 [==========>...................] - ETA: 8s - loss: 0.3875 - acc: 0.8866
320/753 [===========>..................] - ETA: 8s - loss: 0.3892 - acc: 0.8846
352/753 [=============>................] - ETA: 7s - loss: 0.3857 - acc: 0.8844
384/753 [==============>...............] - ETA: 7s - loss: 0.3817 - acc: 0.8853
416/753 [===============>..............] - ETA: 6s - loss: 0.3766 - acc: 0.8863
448/753 [================>.............] - ETA: 5s - loss: 0.3721 - acc: 0.8881
480/753 [==================>...........] - ETA: 5s - loss: 0.3710 - acc: 0.8886
512/753 [===================>..........] - ETA: 4s - loss: 0.3719 - acc: 0.8878
544/753 [====================>.........] - ETA: 4s - loss: 0.3738 - acc: 0.8867
576/753 [=====================>........] - ETA: 3s - loss: 0.3762 - acc: 0.8851
608/753 [=======================>......] - ETA: 2s - loss: 0.3745 - acc: 0.8850
640/753 [========================>.....] - ETA: 2s - loss: 0.3699 - acc: 0.8868
672/753 [=========================>....] - ETA: 1s - loss: 0.3674 - acc: 0.8874
704/753 [===========================>..] - ETA: 0s - loss: 0.3663 - acc: 0.8879
736/753 [============================>.] - ETA: 0s - loss: 0.3609 - acc: 0.8898
753/753 [==============================] - 15s 20ms/step - loss: 0.3587 - acc: 0.8904 - val_loss: 0.3129 - val_acc: 0.9064
Epoch 3/70

 32/753 [>.............................] - ETA: 13s - loss: 0.3333 - acc: 0.9085
 64/753 [=>............................] - ETA: 12s - loss: 0.2907 - acc: 0.9115
 96/753 [==>...........................] - ETA: 12s - loss: 0.2735 - acc: 0.9145
128/753 [====>.........................] - ETA: 11s - loss: 0.2706 - acc: 0.9139
160/753 [=====>........................] - ETA: 11s - loss: 0.2871 - acc: 0.9097
192/753 [======>.......................] - ETA: 10s - loss: 0.3037 - acc: 0.9046
224/753 [=======>......................] - ETA: 10s - loss: 0.3046 - acc: 0.9020
256/753 [=========>....................] - ETA: 9s - loss: 0.3032 - acc: 0.9025 
288/753 [==========>...................] - ETA: 8s - loss: 0.3033 - acc: 0.9018
320/753 [===========>..................] - ETA: 8s - loss: 0.3039 - acc: 0.9024
352/753 [=============>................] - ETA: 7s - loss: 0.3029 - acc: 0.9044
384/753 [==============>...............] - ETA: 7s - loss: 0.2982 - acc: 0.9062
416/753 [===============>..............] - ETA: 6s - loss: 0.2992 - acc: 0.9044
448/753 [================>.............] - ETA: 5s - loss: 0.2967 - acc: 0.9052
480/753 [==================>...........] - ETA: 5s - loss: 0.2957 - acc: 0.9056
512/753 [===================>..........] - ETA: 4s - loss: 0.2924 - acc: 0.9067
544/753 [====================>.........] - ETA: 3s - loss: 0.2892 - acc: 0.9075
576/753 [=====================>........] - ETA: 3s - loss: 0.2835 - acc: 0.9095
608/753 [=======================>......] - ETA: 2s - loss: 0.2802 - acc: 0.9107
640/753 [========================>.....] - ETA: 2s - loss: 0.2780 - acc: 0.9115
672/753 [=========================>....] - ETA: 1s - loss: 0.2746 - acc: 0.9127
704/753 [===========================>..] - ETA: 0s - loss: 0.2716 - acc: 0.9139
736/753 [============================>.] - ETA: 0s - loss: 0.2687 - acc: 0.9151
753/753 [==============================] - 15s 20ms/step - loss: 0.2691 - acc: 0.9150 - val_loss: 0.2765 - val_acc: 0.9125
Epoch 4/70

 32/753 [>.............................] - ETA: 13s - loss: 0.2151 - acc: 0.9382
 64/753 [=>............................] - ETA: 13s - loss: 0.2219 - acc: 0.9331
 96/753 [==>...........................] - ETA: 12s - loss: 0.2243 - acc: 0.9294
128/753 [====>.........................] - ETA: 11s - loss: 0.2188 - acc: 0.9300
160/753 [=====>........................] - ETA: 11s - loss: 0.2225 - acc: 0.9294
192/753 [======>.......................] - ETA: 10s - loss: 0.2451 - acc: 0.9195
224/753 [=======>......................] - ETA: 10s - loss: 0.2441 - acc: 0.9206
256/753 [=========>....................] - ETA: 9s - loss: 0.2381 - acc: 0.9240 
288/753 [==========>...................] - ETA: 8s - loss: 0.2409 - acc: 0.9245
320/753 [===========>..................] - ETA: 8s - loss: 0.2333 - acc: 0.9274
352/753 [=============>................] - ETA: 7s - loss: 0.2215 - acc: 0.9313
384/753 [==============>...............] - ETA: 7s - loss: 0.2219 - acc: 0.9313
416/753 [===============>..............] - ETA: 6s - loss: 0.2207 - acc: 0.9313
448/753 [================>.............] - ETA: 5s - loss: 0.2210 - acc: 0.9309
480/753 [==================>...........] - ETA: 5s - loss: 0.2210 - acc: 0.9298
512/753 [===================>..........] - ETA: 4s - loss: 0.2169 - acc: 0.9314
544/753 [====================>.........] - ETA: 3s - loss: 0.2195 - acc: 0.9312
576/753 [=====================>........] - ETA: 3s - loss: 0.2212 - acc: 0.9310
608/753 [=======================>......] - ETA: 2s - loss: 0.2253 - acc: 0.9292
640/753 [========================>.....] - ETA: 2s - loss: 0.2247 - acc: 0.9292
672/753 [=========================>....] - ETA: 1s - loss: 0.2254 - acc: 0.9290
704/753 [===========================>..] - ETA: 0s - loss: 0.2256 - acc: 0.9291
736/753 [============================>.] - ETA: 0s - loss: 0.2241 - acc: 0.9298
753/753 [==============================] - 15s 20ms/step - loss: 0.2240 - acc: 0.9297 - val_loss: 0.2713 - val_acc: 0.9156
Epoch 5/70

 32/753 [>.............................] - ETA: 13s - loss: 0.1633 - acc: 0.9501
 64/753 [=>............................] - ETA: 12s - loss: 0.1795 - acc: 0.9492
 96/753 [==>...........................] - ETA: 12s - loss: 0.1855 - acc: 0.9424
128/753 [====>.........................] - ETA: 11s - loss: 0.1807 - acc: 0.9438
160/753 [=====>........................] - ETA: 11s - loss: 0.1964 - acc: 0.9413
192/753 [======>.......................] - ETA: 10s - loss: 0.1981 - acc: 0.9406
224/753 [=======>......................] - ETA: 10s - loss: 0.1907 - acc: 0.9451
256/753 [=========>....................] - ETA: 9s - loss: 0.1875 - acc: 0.9457 
288/753 [==========>...................] - ETA: 8s - loss: 0.1857 - acc: 0.9450
320/753 [===========>..................] - ETA: 8s - loss: 0.1879 - acc: 0.9438
352/753 [=============>................] - ETA: 7s - loss: 0.1907 - acc: 0.9425
384/753 [==============>...............] - ETA: 7s - loss: 0.1908 - acc: 0.9421
416/753 [===============>..............] - ETA: 6s - loss: 0.1959 - acc: 0.9407
448/753 [================>.............] - ETA: 5s - loss: 0.1991 - acc: 0.9389
480/753 [==================>...........] - ETA: 5s - loss: 0.1984 - acc: 0.9393
512/753 [===================>..........] - ETA: 4s - loss: 0.1978 - acc: 0.9389
544/753 [====================>.........] - ETA: 3s - loss: 0.1991 - acc: 0.9379
576/753 [=====================>........] - ETA: 3s - loss: 0.1979 - acc: 0.9382
608/753 [=======================>......] - ETA: 2s - loss: 0.1984 - acc: 0.9382
640/753 [========================>.....] - ETA: 2s - loss: 0.1986 - acc: 0.9377
672/753 [=========================>....] - ETA: 1s - loss: 0.1956 - acc: 0.9390
704/753 [===========================>..] - ETA: 0s - loss: 0.1971 - acc: 0.9385
736/753 [============================>.] - ETA: 0s - loss: 0.1984 - acc: 0.9380
753/753 [==============================] - 15s 20ms/step - loss: 0.1978 - acc: 0.9382 - val_loss: 0.2519 - val_acc: 0.9253
Epoch 6/70

 32/753 [>.............................] - ETA: 13s - loss: 0.1498 - acc: 0.9539
 64/753 [=>............................] - ETA: 13s - loss: 0.1409 - acc: 0.9571
 96/753 [==>...........................] - ETA: 12s - loss: 0.1567 - acc: 0.9497
128/753 [====>.........................] - ETA: 11s - loss: 0.1466 - acc: 0.9554
160/753 [=====>........................] - ETA: 11s - loss: 0.1487 - acc: 0.9548
192/753 [======>.......................] - ETA: 10s - loss: 0.1518 - acc: 0.9534
224/753 [=======>......................] - ETA: 10s - loss: 0.1533 - acc: 0.9539
256/753 [=========>....................] - ETA: 9s - loss: 0.1641 - acc: 0.9511 
288/753 [==========>...................] - ETA: 8s - loss: 0.1610 - acc: 0.9519
320/753 [===========>..................] - ETA: 8s - loss: 0.1606 - acc: 0.9516
352/753 [=============>................] - ETA: 7s - loss: 0.1614 - acc: 0.9515
384/753 [==============>...............] - ETA: 7s - loss: 0.1649 - acc: 0.9501
416/753 [===============>..............] - ETA: 6s - loss: 0.1735 - acc: 0.9460
448/753 [================>.............] - ETA: 5s - loss: 0.1759 - acc: 0.9455
480/753 [==================>...........] - ETA: 5s - loss: 0.1728 - acc: 0.9464
512/753 [===================>..........] - ETA: 4s - loss: 0.1734 - acc: 0.9467
544/753 [====================>.........] - ETA: 3s - loss: 0.1732 - acc: 0.9467
576/753 [=====================>........] - ETA: 3s - loss: 0.1721 - acc: 0.9472
608/753 [=======================>......] - ETA: 2s - loss: 0.1745 - acc: 0.9463
640/753 [========================>.....] - ETA: 2s - loss: 0.1748 - acc: 0.9465
672/753 [=========================>....] - ETA: 1s - loss: 0.1757 - acc: 0.9463
704/753 [===========================>..] - ETA: 0s - loss: 0.1759 - acc: 0.9459
736/753 [============================>.] - ETA: 0s - loss: 0.1743 - acc: 0.9464
753/753 [==============================] - 15s 20ms/step - loss: 0.1722 - acc: 0.9472 - val_loss: 0.2317 - val_acc: 0.9296
Epoch 7/70

 32/753 [>.............................] - ETA: 13s - loss: 0.2206 - acc: 0.9373
 64/753 [=>............................] - ETA: 13s - loss: 0.1899 - acc: 0.9415
 96/753 [==>...........................] - ETA: 12s - loss: 0.1866 - acc: 0.9427
128/753 [====>.........................] - ETA: 11s - loss: 0.1742 - acc: 0.9462
160/753 [=====>........................] - ETA: 11s - loss: 0.1721 - acc: 0.9490
192/753 [======>.......................] - ETA: 10s - loss: 0.1656 - acc: 0.9511
224/753 [=======>......................] - ETA: 10s - loss: 0.1664 - acc: 0.9510
256/753 [=========>....................] - ETA: 9s - loss: 0.1683 - acc: 0.9511 
288/753 [==========>...................] - ETA: 8s - loss: 0.1669 - acc: 0.9514
320/753 [===========>..................] - ETA: 8s - loss: 0.1614 - acc: 0.9525
352/753 [=============>................] - ETA: 7s - loss: 0.1557 - acc: 0.9537
384/753 [==============>...............] - ETA: 7s - loss: 0.1525 - acc: 0.9539
416/753 [===============>..............] - ETA: 6s - loss: 0.1478 - acc: 0.9552
448/753 [================>.............] - ETA: 5s - loss: 0.1469 - acc: 0.9550
480/753 [==================>...........] - ETA: 5s - loss: 0.1448 - acc: 0.9552
512/753 [===================>..........] - ETA: 4s - loss: 0.1443 - acc: 0.9548
544/753 [====================>.........] - ETA: 3s - loss: 0.1434 - acc: 0.9550
576/753 [=====================>........] - ETA: 3s - loss: 0.1428 - acc: 0.9553
608/753 [=======================>......] - ETA: 2s - loss: 0.1427 - acc: 0.9555
640/753 [========================>.....] - ETA: 2s - loss: 0.1423 - acc: 0.9562
672/753 [=========================>....] - ETA: 1s - loss: 0.1423 - acc: 0.9560
704/753 [===========================>..] - ETA: 0s - loss: 0.1418 - acc: 0.9559
736/753 [============================>.] - ETA: 0s - loss: 0.1464 - acc: 0.9546
753/753 [==============================] - 15s 20ms/step - loss: 0.1477 - acc: 0.9542 - val_loss: 0.2282 - val_acc: 0.9289
Epoch 8/70

 32/753 [>.............................] - ETA: 13s - loss: 0.2182 - acc: 0.9313
 64/753 [=>............................] - ETA: 13s - loss: 0.1837 - acc: 0.9443
 96/753 [==>...........................] - ETA: 12s - loss: 0.1734 - acc: 0.9474
128/753 [====>.........................] - ETA: 11s - loss: 0.1539 - acc: 0.9519
160/753 [=====>........................] - ETA: 11s - loss: 0.1505 - acc: 0.9529
192/753 [======>.......................] - ETA: 10s - loss: 0.1491 - acc: 0.9530
224/753 [=======>......................] - ETA: 10s - loss: 0.1550 - acc: 0.9516
256/753 [=========>....................] - ETA: 9s - loss: 0.1572 - acc: 0.9499 
288/753 [==========>...................] - ETA: 8s - loss: 0.1584 - acc: 0.9481
320/753 [===========>..................] - ETA: 8s - loss: 0.1571 - acc: 0.9486
352/753 [=============>................] - ETA: 7s - loss: 0.1561 - acc: 0.9498
384/753 [==============>...............] - ETA: 7s - loss: 0.1553 - acc: 0.9505
416/753 [===============>..............] - ETA: 6s - loss: 0.1495 - acc: 0.9520
448/753 [================>.............] - ETA: 5s - loss: 0.1478 - acc: 0.9524
480/753 [==================>...........] - ETA: 5s - loss: 0.1460 - acc: 0.9534
512/753 [===================>..........] - ETA: 4s - loss: 0.1460 - acc: 0.9532
544/753 [====================>.........] - ETA: 3s - loss: 0.1434 - acc: 0.9541
576/753 [=====================>........] - ETA: 3s - loss: 0.1431 - acc: 0.9544
608/753 [=======================>......] - ETA: 2s - loss: 0.1429 - acc: 0.9538
640/753 [========================>.....] - ETA: 2s - loss: 0.1443 - acc: 0.9531
672/753 [=========================>....] - ETA: 1s - loss: 0.1427 - acc: 0.9536
704/753 [===========================>..] - ETA: 0s - loss: 0.1429 - acc: 0.9533
736/753 [============================>.] - ETA: 0s - loss: 0.1430 - acc: 0.9535
753/753 [==============================] - 15s 20ms/step - loss: 0.1426 - acc: 0.9537 - val_loss: 0.2244 - val_acc: 0.9270
Epoch 9/70

 32/753 [>.............................] - ETA: 13s - loss: 0.1133 - acc: 0.9632
 64/753 [=>............................] - ETA: 13s - loss: 0.1198 - acc: 0.9613
 96/753 [==>...........................] - ETA: 12s - loss: 0.1147 - acc: 0.9620
128/753 [====>.........................] - ETA: 11s - loss: 0.1213 - acc: 0.9620
160/753 [=====>........................] - ETA: 11s - loss: 0.1085 - acc: 0.9668
192/753 [======>.......................] - ETA: 10s - loss: 0.1108 - acc: 0.9652
224/753 [=======>......................] - ETA: 10s - loss: 0.1069 - acc: 0.9671
256/753 [=========>....................] - ETA: 9s - loss: 0.1056 - acc: 0.9672 
288/753 [==========>...................] - ETA: 8s - loss: 0.1046 - acc: 0.9670
320/753 [===========>..................] - ETA: 8s - loss: 0.1069 - acc: 0.9665
352/753 [=============>................] - ETA: 7s - loss: 0.1063 - acc: 0.9668
384/753 [==============>...............] - ETA: 7s - loss: 0.1085 - acc: 0.9659
416/753 [===============>..............] - ETA: 6s - loss: 0.1099 - acc: 0.9658
448/753 [================>.............] - ETA: 5s - loss: 0.1104 - acc: 0.9653
480/753 [==================>...........] - ETA: 5s - loss: 0.1117 - acc: 0.9650
512/753 [===================>..........] - ETA: 4s - loss: 0.1110 - acc: 0.9655
544/753 [====================>.........] - ETA: 3s - loss: 0.1132 - acc: 0.9647
576/753 [=====================>........] - ETA: 3s - loss: 0.1142 - acc: 0.9641
608/753 [=======================>......] - ETA: 2s - loss: 0.1160 - acc: 0.9637
640/753 [========================>.....] - ETA: 2s - loss: 0.1180 - acc: 0.9626
672/753 [=========================>....] - ETA: 1s - loss: 0.1196 - acc: 0.9623
704/753 [===========================>..] - ETA: 0s - loss: 0.1221 - acc: 0.9611
736/753 [============================>.] - ETA: 0s - loss: 0.1220 - acc: 0.9610
753/753 [==============================] - 15s 20ms/step - loss: 0.1225 - acc: 0.9606 - val_loss: 0.2216 - val_acc: 0.9280
Epoch 10/70

 32/753 [>.............................] - ETA: 13s - loss: 0.1007 - acc: 0.9807
 64/753 [=>............................] - ETA: 13s - loss: 0.1174 - acc: 0.9673
 96/753 [==>...........................] - ETA: 12s - loss: 0.1052 - acc: 0.9693
128/753 [====>.........................] - ETA: 11s - loss: 0.1151 - acc: 0.9667
160/753 [=====>........................] - ETA: 11s - loss: 0.1224 - acc: 0.9653
192/753 [======>.......................] - ETA: 10s - loss: 0.1204 - acc: 0.9663
224/753 [=======>......................] - ETA: 10s - loss: 0.1224 - acc: 0.9649
256/753 [=========>....................] - ETA: 9s - loss: 0.1207 - acc: 0.9655 
288/753 [==========>...................] - ETA: 8s - loss: 0.1192 - acc: 0.9658
320/753 [===========>..................] - ETA: 8s - loss: 0.1199 - acc: 0.9646
352/753 [=============>................] - ETA: 7s - loss: 0.1216 - acc: 0.9631
384/753 [==============>...............] - ETA: 7s - loss: 0.1187 - acc: 0.9633
416/753 [===============>..............] - ETA: 6s - loss: 0.1154 - acc: 0.9646
448/753 [================>.............] - ETA: 5s - loss: 0.1155 - acc: 0.9645
480/753 [==================>...........] - ETA: 5s - loss: 0.1150 - acc: 0.9648
512/753 [===================>..........] - ETA: 4s - loss: 0.1161 - acc: 0.9647
544/753 [====================>.........] - ETA: 3s - loss: 0.1154 - acc: 0.9645
576/753 [=====================>........] - ETA: 3s - loss: 0.1173 - acc: 0.9640
608/753 [=======================>......] - ETA: 2s - loss: 0.1165 - acc: 0.9642
640/753 [========================>.....] - ETA: 2s - loss: 0.1172 - acc: 0.9639
672/753 [=========================>....] - ETA: 1s - loss: 0.1146 - acc: 0.9649
704/753 [===========================>..] - ETA: 0s - loss: 0.1135 - acc: 0.9652
736/753 [============================>.] - ETA: 0s - loss: 0.1121 - acc: 0.9658
753/753 [==============================] - 15s 20ms/step - loss: 0.1129 - acc: 0.9656 - val_loss: 0.2188 - val_acc: 0.9294
Epoch 11/70

 32/753 [>.............................] - ETA: 13s - loss: 0.1115 - acc: 0.9717
 64/753 [=>............................] - ETA: 13s - loss: 0.0975 - acc: 0.9705
 96/753 [==>...........................] - ETA: 12s - loss: 0.1040 - acc: 0.9708
128/753 [====>.........................] - ETA: 11s - loss: 0.1023 - acc: 0.9695
160/753 [=====>........................] - ETA: 11s - loss: 0.1020 - acc: 0.9686
192/753 [======>.......................] - ETA: 10s - loss: 0.0964 - acc: 0.9708
224/753 [=======>......................] - ETA: 10s - loss: 0.0956 - acc: 0.9723
256/753 [=========>....................] - ETA: 9s - loss: 0.0975 - acc: 0.9721 
288/753 [==========>...................] - ETA: 8s - loss: 0.0991 - acc: 0.9720
320/753 [===========>..................] - ETA: 8s - loss: 0.0957 - acc: 0.9729
352/753 [=============>................] - ETA: 7s - loss: 0.0996 - acc: 0.9718
384/753 [==============>...............] - ETA: 7s - loss: 0.0992 - acc: 0.9721
416/753 [===============>..............] - ETA: 6s - loss: 0.0984 - acc: 0.9724
448/753 [================>.............] - ETA: 5s - loss: 0.1004 - acc: 0.9714
480/753 [==================>...........] - ETA: 5s - loss: 0.1035 - acc: 0.9701
512/753 [===================>..........] - ETA: 4s - loss: 0.1042 - acc: 0.9701
544/753 [====================>.........] - ETA: 3s - loss: 0.1069 - acc: 0.9688
576/753 [=====================>........] - ETA: 3s - loss: 0.1092 - acc: 0.9677
608/753 [=======================>......] - ETA: 2s - loss: 0.1090 - acc: 0.9676
640/753 [========================>.....] - ETA: 2s - loss: 0.1098 - acc: 0.9669
672/753 [=========================>....] - ETA: 1s - loss: 0.1103 - acc: 0.9670
704/753 [===========================>..] - ETA: 0s - loss: 0.1083 - acc: 0.9677
736/753 [============================>.] - ETA: 0s - loss: 0.1084 - acc: 0.9673
753/753 [==============================] - 15s 20ms/step - loss: 0.1083 - acc: 0.9674 - val_loss: 0.2214 - val_acc: 0.9338
Epoch 12/70

 32/753 [>.............................] - ETA: 13s - loss: 0.0701 - acc: 0.9802
 64/753 [=>............................] - ETA: 13s - loss: 0.0995 - acc: 0.9693
 96/753 [==>...........................] - ETA: 12s - loss: 0.0950 - acc: 0.9729
128/753 [====>.........................] - ETA: 11s - loss: 0.1028 - acc: 0.9679
160/753 [=====>........................] - ETA: 11s - loss: 0.0983 - acc: 0.9690
192/753 [======>.......................] - ETA: 10s - loss: 0.0934 - acc: 0.9715
224/753 [=======>......................] - ETA: 10s - loss: 0.0889 - acc: 0.9729
256/753 [=========>....................] - ETA: 9s - loss: 0.0928 - acc: 0.9727 
288/753 [==========>...................] - ETA: 8s - loss: 0.0919 - acc: 0.9733
320/753 [===========>..................] - ETA: 8s - loss: 0.0928 - acc: 0.9725
352/753 [=============>................] - ETA: 7s - loss: 0.0936 - acc: 0.9721
384/753 [==============>...............] - ETA: 6s - loss: 0.0918 - acc: 0.9726
416/753 [===============>..............] - ETA: 6s - loss: 0.0939 - acc: 0.9721
448/753 [================>.............] - ETA: 5s - loss: 0.0942 - acc: 0.9715
480/753 [==================>...........] - ETA: 5s - loss: 0.0917 - acc: 0.9727
512/753 [===================>..........] - ETA: 4s - loss: 0.0915 - acc: 0.9725
544/753 [====================>.........] - ETA: 3s - loss: 0.0915 - acc: 0.9724
576/753 [=====================>........] - ETA: 3s - loss: 0.0929 - acc: 0.9720
608/753 [=======================>......] - ETA: 2s - loss: 0.0959 - acc: 0.9710
640/753 [========================>.....] - ETA: 2s - loss: 0.0959 - acc: 0.9707
672/753 [=========================>....] - ETA: 1s - loss: 0.0967 - acc: 0.9703
704/753 [===========================>..] - ETA: 0s - loss: 0.0960 - acc: 0.9704
736/753 [============================>.] - ETA: 0s - loss: 0.0968 - acc: 0.9696
753/753 [==============================] - 15s 20ms/step - loss: 0.0970 - acc: 0.9696 - val_loss: 0.2242 - val_acc: 0.9335
Computing...
Manual evaluation: (didn't understand why I made this)
True 8097
False 974
True percentage 0.892624848418
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.78      0.57      0.66       296
      B-LOC       0.72      0.72      0.72       218
      I-ORG       0.67      0.29      0.41       151
     B-MISC       0.32      0.28      0.30       141
     I-MISC       0.37      0.49      0.42       154
      B-PER       0.91      0.80      0.85       438
      I-PER       0.86      0.61      0.72       214
      I-LOC       0.79      0.75      0.77       141

avg / total       0.93      0.89      0.91      9071

F-1 Score:
0.659502609764
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 837 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100816 unique words.
Found 94 unique chars.
Found 9 unique labels.
812 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 260
OOV word occurences: 365
Padding...
Data padded!
Padding...
Data padded!
Padded until 83 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6452288     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,955,394
Trainable params: 6,955,394
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 753 samples, validate on 84 samples
Epoch 1/70

 32/753 [>.............................] - ETA: 1:10 - loss: 2.3868 - acc: 0.0243
 64/753 [=>............................] - ETA: 41s - loss: 1.7141 - acc: 0.3918 
 96/753 [==>...........................] - ETA: 30s - loss: 1.5085 - acc: 0.5311
128/753 [====>.........................] - ETA: 25s - loss: 1.5392 - acc: 0.5317
160/753 [=====>........................] - ETA: 21s - loss: 1.3783 - acc: 0.5927
192/753 [======>.......................] - ETA: 18s - loss: 1.2856 - acc: 0.6245
224/753 [=======>......................] - ETA: 16s - loss: 1.2056 - acc: 0.6492
256/753 [=========>....................] - ETA: 14s - loss: 1.1296 - acc: 0.6724
288/753 [==========>...................] - ETA: 13s - loss: 1.0838 - acc: 0.6855
320/753 [===========>..................] - ETA: 12s - loss: 1.0400 - acc: 0.6979
352/753 [=============>................] - ETA: 10s - loss: 1.0008 - acc: 0.7075
384/753 [==============>...............] - ETA: 9s - loss: 0.9807 - acc: 0.7135 
416/753 [===============>..............] - ETA: 8s - loss: 0.9505 - acc: 0.7217
448/753 [================>.............] - ETA: 7s - loss: 0.9283 - acc: 0.7283
480/753 [==================>...........] - ETA: 6s - loss: 0.8976 - acc: 0.7381
512/753 [===================>..........] - ETA: 5s - loss: 0.8771 - acc: 0.7434
544/753 [====================>.........] - ETA: 5s - loss: 0.8638 - acc: 0.7480
576/753 [=====================>........] - ETA: 4s - loss: 0.8421 - acc: 0.7538
608/753 [=======================>......] - ETA: 3s - loss: 0.8217 - acc: 0.7592
640/753 [========================>.....] - ETA: 2s - loss: 0.8041 - acc: 0.7638
672/753 [=========================>....] - ETA: 1s - loss: 0.7854 - acc: 0.7694
704/753 [===========================>..] - ETA: 1s - loss: 0.7685 - acc: 0.7737
736/753 [============================>.] - ETA: 0s - loss: 0.7560 - acc: 0.7763
753/753 [==============================] - 18s 24ms/step - loss: 0.7500 - acc: 0.7784 - val_loss: 0.4193 - val_acc: 0.8611
Epoch 2/70

 32/753 [>.............................] - ETA: 13s - loss: 0.4870 - acc: 0.8290
 64/753 [=>............................] - ETA: 13s - loss: 0.4689 - acc: 0.8421
 96/753 [==>...........................] - ETA: 12s - loss: 0.4418 - acc: 0.8560
128/753 [====>.........................] - ETA: 11s - loss: 0.4506 - acc: 0.8559
160/753 [=====>........................] - ETA: 11s - loss: 0.4529 - acc: 0.8566
192/753 [======>.......................] - ETA: 10s - loss: 0.4326 - acc: 0.8624
224/753 [=======>......................] - ETA: 10s - loss: 0.4261 - acc: 0.8664
256/753 [=========>....................] - ETA: 9s - loss: 0.4173 - acc: 0.8687 
288/753 [==========>...................] - ETA: 8s - loss: 0.4083 - acc: 0.8715
320/753 [===========>..................] - ETA: 8s - loss: 0.4067 - acc: 0.8719
352/753 [=============>................] - ETA: 7s - loss: 0.3956 - acc: 0.8760
384/753 [==============>...............] - ETA: 7s - loss: 0.3866 - acc: 0.8790
416/753 [===============>..............] - ETA: 6s - loss: 0.3825 - acc: 0.8804
448/753 [================>.............] - ETA: 5s - loss: 0.3783 - acc: 0.8815
480/753 [==================>...........] - ETA: 5s - loss: 0.3718 - acc: 0.8848
512/753 [===================>..........] - ETA: 4s - loss: 0.3703 - acc: 0.8857
544/753 [====================>.........] - ETA: 4s - loss: 0.3719 - acc: 0.8857
576/753 [=====================>........] - ETA: 3s - loss: 0.3674 - acc: 0.8871
608/753 [=======================>......] - ETA: 2s - loss: 0.3596 - acc: 0.8898
640/753 [========================>.....] - ETA: 2s - loss: 0.3575 - acc: 0.8905
672/753 [=========================>....] - ETA: 1s - loss: 0.3560 - acc: 0.8914
704/753 [===========================>..] - ETA: 0s - loss: 0.3568 - acc: 0.8909
736/753 [============================>.] - ETA: 0s - loss: 0.3582 - acc: 0.8909
753/753 [==============================] - 15s 20ms/step - loss: 0.3573 - acc: 0.8910 - val_loss: 0.2798 - val_acc: 0.9200
Epoch 3/70

 32/753 [>.............................] - ETA: 13s - loss: 0.2750 - acc: 0.9218
 64/753 [=>............................] - ETA: 13s - loss: 0.3082 - acc: 0.9147
 96/753 [==>...........................] - ETA: 12s - loss: 0.3230 - acc: 0.9067
128/753 [====>.........................] - ETA: 11s - loss: 0.3198 - acc: 0.9094
160/753 [=====>........................] - ETA: 11s - loss: 0.3054 - acc: 0.9122
192/753 [======>.......................] - ETA: 10s - loss: 0.3015 - acc: 0.9113
224/753 [=======>......................] - ETA: 10s - loss: 0.2936 - acc: 0.9136
256/753 [=========>....................] - ETA: 9s - loss: 0.2870 - acc: 0.9156 
288/753 [==========>...................] - ETA: 8s - loss: 0.2943 - acc: 0.9127
320/753 [===========>..................] - ETA: 8s - loss: 0.2931 - acc: 0.9126
352/753 [=============>................] - ETA: 7s - loss: 0.2853 - acc: 0.9146
384/753 [==============>...............] - ETA: 7s - loss: 0.2825 - acc: 0.9162
416/753 [===============>..............] - ETA: 6s - loss: 0.2838 - acc: 0.9146
448/753 [================>.............] - ETA: 5s - loss: 0.2821 - acc: 0.9153
480/753 [==================>...........] - ETA: 5s - loss: 0.2826 - acc: 0.9146
512/753 [===================>..........] - ETA: 4s - loss: 0.2810 - acc: 0.9156
544/753 [====================>.........] - ETA: 3s - loss: 0.2789 - acc: 0.9167
576/753 [=====================>........] - ETA: 3s - loss: 0.2748 - acc: 0.9175
608/753 [=======================>......] - ETA: 2s - loss: 0.2776 - acc: 0.9168
640/753 [========================>.....] - ETA: 2s - loss: 0.2807 - acc: 0.9157
672/753 [=========================>....] - ETA: 1s - loss: 0.2784 - acc: 0.9163
704/753 [===========================>..] - ETA: 0s - loss: 0.2783 - acc: 0.9162
736/753 [============================>.] - ETA: 0s - loss: 0.2770 - acc: 0.9168
753/753 [==============================] - 15s 20ms/step - loss: 0.2749 - acc: 0.9174 - val_loss: 0.2232 - val_acc: 0.9331
Epoch 4/70

 32/753 [>.............................] - ETA: 13s - loss: 0.2482 - acc: 0.9157
 64/753 [=>............................] - ETA: 13s - loss: 0.2437 - acc: 0.9192
 96/753 [==>...........................] - ETA: 12s - loss: 0.2411 - acc: 0.9218
128/753 [====>.........................] - ETA: 11s - loss: 0.2502 - acc: 0.9217
160/753 [=====>........................] - ETA: 11s - loss: 0.2417 - acc: 0.9272
192/753 [======>.......................] - ETA: 10s - loss: 0.2317 - acc: 0.9287
224/753 [=======>......................] - ETA: 10s - loss: 0.2288 - acc: 0.9289
256/753 [=========>....................] - ETA: 9s - loss: 0.2232 - acc: 0.9304 
288/753 [==========>...................] - ETA: 8s - loss: 0.2232 - acc: 0.9310
320/753 [===========>..................] - ETA: 8s - loss: 0.2275 - acc: 0.9295
352/753 [=============>................] - ETA: 7s - loss: 0.2342 - acc: 0.9278
384/753 [==============>...............] - ETA: 7s - loss: 0.2359 - acc: 0.9265
416/753 [===============>..............] - ETA: 6s - loss: 0.2316 - acc: 0.9271
448/753 [================>.............] - ETA: 5s - loss: 0.2268 - acc: 0.9283
480/753 [==================>...........] - ETA: 5s - loss: 0.2277 - acc: 0.9275
512/753 [===================>..........] - ETA: 4s - loss: 0.2318 - acc: 0.9254
544/753 [====================>.........] - ETA: 3s - loss: 0.2301 - acc: 0.9265
576/753 [=====================>........] - ETA: 3s - loss: 0.2272 - acc: 0.9273
608/753 [=======================>......] - ETA: 2s - loss: 0.2282 - acc: 0.9276
640/753 [========================>.....] - ETA: 2s - loss: 0.2262 - acc: 0.9286
672/753 [=========================>....] - ETA: 1s - loss: 0.2271 - acc: 0.9288
704/753 [===========================>..] - ETA: 0s - loss: 0.2271 - acc: 0.9284
736/753 [============================>.] - ETA: 0s - loss: 0.2255 - acc: 0.9289
753/753 [==============================] - 15s 20ms/step - loss: 0.2245 - acc: 0.9293 - val_loss: 0.1888 - val_acc: 0.9398
Epoch 5/70

 32/753 [>.............................] - ETA: 13s - loss: 0.1289 - acc: 0.9663
 64/753 [=>............................] - ETA: 12s - loss: 0.1784 - acc: 0.9408
 96/753 [==>...........................] - ETA: 12s - loss: 0.2144 - acc: 0.9341
128/753 [====>.........................] - ETA: 11s - loss: 0.2096 - acc: 0.9397
160/753 [=====>........................] - ETA: 11s - loss: 0.1959 - acc: 0.9439
192/753 [======>.......................] - ETA: 10s - loss: 0.1966 - acc: 0.9427
224/753 [=======>......................] - ETA: 9s - loss: 0.1920 - acc: 0.9415 
256/753 [=========>....................] - ETA: 9s - loss: 0.1910 - acc: 0.9409
288/753 [==========>...................] - ETA: 8s - loss: 0.1994 - acc: 0.9373
320/753 [===========>..................] - ETA: 8s - loss: 0.2030 - acc: 0.9360
352/753 [=============>................] - ETA: 7s - loss: 0.2015 - acc: 0.9368
384/753 [==============>...............] - ETA: 6s - loss: 0.2016 - acc: 0.9362
416/753 [===============>..............] - ETA: 6s - loss: 0.1989 - acc: 0.9369
448/753 [================>.............] - ETA: 5s - loss: 0.2011 - acc: 0.9367
480/753 [==================>...........] - ETA: 5s - loss: 0.1972 - acc: 0.9378
512/753 [===================>..........] - ETA: 4s - loss: 0.1998 - acc: 0.9375
544/753 [====================>.........] - ETA: 3s - loss: 0.1973 - acc: 0.9378
576/753 [=====================>........] - ETA: 3s - loss: 0.1994 - acc: 0.9373
608/753 [=======================>......] - ETA: 2s - loss: 0.1978 - acc: 0.9380
640/753 [========================>.....] - ETA: 2s - loss: 0.1970 - acc: 0.9386
672/753 [=========================>....] - ETA: 1s - loss: 0.1986 - acc: 0.9381
704/753 [===========================>..] - ETA: 0s - loss: 0.1958 - acc: 0.9393
736/753 [============================>.] - ETA: 0s - loss: 0.1971 - acc: 0.9389
753/753 [==============================] - 15s 20ms/step - loss: 0.1966 - acc: 0.9392 - val_loss: 0.1890 - val_acc: 0.9387
Epoch 6/70

 32/753 [>.............................] - ETA: 13s - loss: 0.2310 - acc: 0.9385
 64/753 [=>............................] - ETA: 12s - loss: 0.2125 - acc: 0.9437
 96/753 [==>...........................] - ETA: 12s - loss: 0.2067 - acc: 0.9445
128/753 [====>.........................] - ETA: 11s - loss: 0.2153 - acc: 0.9383
160/753 [=====>........................] - ETA: 11s - loss: 0.2072 - acc: 0.9405
192/753 [======>.......................] - ETA: 10s - loss: 0.2050 - acc: 0.9402
224/753 [=======>......................] - ETA: 9s - loss: 0.1978 - acc: 0.9426 
256/753 [=========>....................] - ETA: 9s - loss: 0.1954 - acc: 0.9436
288/753 [==========>...................] - ETA: 8s - loss: 0.1923 - acc: 0.9435
320/753 [===========>..................] - ETA: 8s - loss: 0.1883 - acc: 0.9454
352/753 [=============>................] - ETA: 7s - loss: 0.1868 - acc: 0.9451
384/753 [==============>...............] - ETA: 6s - loss: 0.1831 - acc: 0.9460
416/753 [===============>..............] - ETA: 6s - loss: 0.1790 - acc: 0.9472
448/753 [================>.............] - ETA: 5s - loss: 0.1748 - acc: 0.9487
480/753 [==================>...........] - ETA: 5s - loss: 0.1719 - acc: 0.9494
512/753 [===================>..........] - ETA: 4s - loss: 0.1745 - acc: 0.9485
544/753 [====================>.........] - ETA: 3s - loss: 0.1752 - acc: 0.9478
576/753 [=====================>........] - ETA: 3s - loss: 0.1751 - acc: 0.9471
608/753 [=======================>......] - ETA: 2s - loss: 0.1768 - acc: 0.9468
640/753 [========================>.....] - ETA: 2s - loss: 0.1770 - acc: 0.9462
672/753 [=========================>....] - ETA: 1s - loss: 0.1759 - acc: 0.9464
704/753 [===========================>..] - ETA: 0s - loss: 0.1764 - acc: 0.9464
736/753 [============================>.] - ETA: 0s - loss: 0.1780 - acc: 0.9459
753/753 [==============================] - 15s 20ms/step - loss: 0.1778 - acc: 0.9462 - val_loss: 0.1720 - val_acc: 0.9385
Epoch 7/70

 32/753 [>.............................] - ETA: 13s - loss: 0.1891 - acc: 0.9438
 64/753 [=>............................] - ETA: 12s - loss: 0.1804 - acc: 0.9392
 96/753 [==>...........................] - ETA: 12s - loss: 0.1745 - acc: 0.9423
128/753 [====>.........................] - ETA: 11s - loss: 0.1764 - acc: 0.9412
160/753 [=====>........................] - ETA: 11s - loss: 0.1741 - acc: 0.9428
192/753 [======>.......................] - ETA: 10s - loss: 0.1851 - acc: 0.9383
224/753 [=======>......................] - ETA: 9s - loss: 0.1804 - acc: 0.9390 
256/753 [=========>....................] - ETA: 9s - loss: 0.1718 - acc: 0.9429
288/753 [==========>...................] - ETA: 8s - loss: 0.1693 - acc: 0.9431
320/753 [===========>..................] - ETA: 8s - loss: 0.1667 - acc: 0.9445
352/753 [=============>................] - ETA: 7s - loss: 0.1623 - acc: 0.9463
384/753 [==============>...............] - ETA: 6s - loss: 0.1691 - acc: 0.9442
416/753 [===============>..............] - ETA: 6s - loss: 0.1688 - acc: 0.9448
448/753 [================>.............] - ETA: 5s - loss: 0.1657 - acc: 0.9456
480/753 [==================>...........] - ETA: 5s - loss: 0.1635 - acc: 0.9467
512/753 [===================>..........] - ETA: 4s - loss: 0.1627 - acc: 0.9473
544/753 [====================>.........] - ETA: 3s - loss: 0.1633 - acc: 0.9475
576/753 [=====================>........] - ETA: 3s - loss: 0.1631 - acc: 0.9473
608/753 [=======================>......] - ETA: 2s - loss: 0.1611 - acc: 0.9482
640/753 [========================>.....] - ETA: 2s - loss: 0.1599 - acc: 0.9487
672/753 [=========================>....] - ETA: 1s - loss: 0.1597 - acc: 0.9488
704/753 [===========================>..] - ETA: 0s - loss: 0.1595 - acc: 0.9490
736/753 [============================>.] - ETA: 0s - loss: 0.1589 - acc: 0.9491
753/753 [==============================] - 15s 20ms/step - loss: 0.1593 - acc: 0.9488 - val_loss: 0.1656 - val_acc: 0.9467
Epoch 8/70

 32/753 [>.............................] - ETA: 13s - loss: 0.1273 - acc: 0.9602
 64/753 [=>............................] - ETA: 12s - loss: 0.1304 - acc: 0.9589
 96/753 [==>...........................] - ETA: 12s - loss: 0.1337 - acc: 0.9569
128/753 [====>.........................] - ETA: 11s - loss: 0.1295 - acc: 0.9564
160/753 [=====>........................] - ETA: 11s - loss: 0.1364 - acc: 0.9539
192/753 [======>.......................] - ETA: 10s - loss: 0.1368 - acc: 0.9526
224/753 [=======>......................] - ETA: 10s - loss: 0.1312 - acc: 0.9557
256/753 [=========>....................] - ETA: 9s - loss: 0.1355 - acc: 0.9556 
288/753 [==========>...................] - ETA: 8s - loss: 0.1391 - acc: 0.9546
320/753 [===========>..................] - ETA: 8s - loss: 0.1463 - acc: 0.9542
352/753 [=============>................] - ETA: 7s - loss: 0.1443 - acc: 0.9550
384/753 [==============>...............] - ETA: 6s - loss: 0.1447 - acc: 0.9547
416/753 [===============>..............] - ETA: 6s - loss: 0.1478 - acc: 0.9537
448/753 [================>.............] - ETA: 5s - loss: 0.1457 - acc: 0.9545
480/753 [==================>...........] - ETA: 5s - loss: 0.1478 - acc: 0.9535
512/753 [===================>..........] - ETA: 4s - loss: 0.1482 - acc: 0.9532
544/753 [====================>.........] - ETA: 3s - loss: 0.1490 - acc: 0.9533
576/753 [=====================>........] - ETA: 3s - loss: 0.1493 - acc: 0.9534
608/753 [=======================>......] - ETA: 2s - loss: 0.1492 - acc: 0.9529
640/753 [========================>.....] - ETA: 2s - loss: 0.1491 - acc: 0.9531
672/753 [=========================>....] - ETA: 1s - loss: 0.1491 - acc: 0.9527
704/753 [===========================>..] - ETA: 0s - loss: 0.1483 - acc: 0.9528
736/753 [============================>.] - ETA: 0s - loss: 0.1485 - acc: 0.9530
753/753 [==============================] - 15s 20ms/step - loss: 0.1480 - acc: 0.9533 - val_loss: 0.1527 - val_acc: 0.9522
Epoch 9/70

 32/753 [>.............................] - ETA: 13s - loss: 0.1560 - acc: 0.9478
 64/753 [=>............................] - ETA: 12s - loss: 0.1412 - acc: 0.9529
 96/753 [==>...........................] - ETA: 12s - loss: 0.1255 - acc: 0.9586
128/753 [====>.........................] - ETA: 11s - loss: 0.1264 - acc: 0.9615
160/753 [=====>........................] - ETA: 11s - loss: 0.1228 - acc: 0.9629
192/753 [======>.......................] - ETA: 10s - loss: 0.1237 - acc: 0.9607
224/753 [=======>......................] - ETA: 10s - loss: 0.1232 - acc: 0.9618
256/753 [=========>....................] - ETA: 9s - loss: 0.1206 - acc: 0.9631 
288/753 [==========>...................] - ETA: 8s - loss: 0.1214 - acc: 0.9628
320/753 [===========>..................] - ETA: 8s - loss: 0.1267 - acc: 0.9606
352/753 [=============>................] - ETA: 7s - loss: 0.1277 - acc: 0.9597
384/753 [==============>...............] - ETA: 6s - loss: 0.1291 - acc: 0.9588
416/753 [===============>..............] - ETA: 6s - loss: 0.1276 - acc: 0.9597
448/753 [================>.............] - ETA: 5s - loss: 0.1294 - acc: 0.9589
480/753 [==================>...........] - ETA: 5s - loss: 0.1284 - acc: 0.9597
512/753 [===================>..........] - ETA: 4s - loss: 0.1304 - acc: 0.9594
544/753 [====================>.........] - ETA: 3s - loss: 0.1309 - acc: 0.9589
576/753 [=====================>........] - ETA: 3s - loss: 0.1315 - acc: 0.9593
608/753 [=======================>......] - ETA: 2s - loss: 0.1313 - acc: 0.9593
640/753 [========================>.....] - ETA: 2s - loss: 0.1288 - acc: 0.9602
672/753 [=========================>....] - ETA: 1s - loss: 0.1284 - acc: 0.9601
704/753 [===========================>..] - ETA: 0s - loss: 0.1290 - acc: 0.9600
736/753 [============================>.] - ETA: 0s - loss: 0.1276 - acc: 0.9607
753/753 [==============================] - 15s 20ms/step - loss: 0.1269 - acc: 0.9608 - val_loss: 0.1619 - val_acc: 0.9540
Epoch 10/70

 32/753 [>.............................] - ETA: 13s - loss: 0.1240 - acc: 0.9653
 64/753 [=>............................] - ETA: 12s - loss: 0.1112 - acc: 0.9653
 96/753 [==>...........................] - ETA: 12s - loss: 0.1023 - acc: 0.9671
128/753 [====>.........................] - ETA: 11s - loss: 0.1061 - acc: 0.9648
160/753 [=====>........................] - ETA: 11s - loss: 0.1028 - acc: 0.9649
192/753 [======>.......................] - ETA: 10s - loss: 0.1039 - acc: 0.9646
224/753 [=======>......................] - ETA: 10s - loss: 0.1075 - acc: 0.9635
256/753 [=========>....................] - ETA: 9s - loss: 0.1057 - acc: 0.9645 
288/753 [==========>...................] - ETA: 8s - loss: 0.1088 - acc: 0.9640
320/753 [===========>..................] - ETA: 8s - loss: 0.1082 - acc: 0.9652
352/753 [=============>................] - ETA: 7s - loss: 0.1089 - acc: 0.9653
384/753 [==============>...............] - ETA: 6s - loss: 0.1129 - acc: 0.9647
416/753 [===============>..............] - ETA: 6s - loss: 0.1158 - acc: 0.9645
448/753 [================>.............] - ETA: 5s - loss: 0.1182 - acc: 0.9630
480/753 [==================>...........] - ETA: 5s - loss: 0.1194 - acc: 0.9622
512/753 [===================>..........] - ETA: 4s - loss: 0.1171 - acc: 0.9632
544/753 [====================>.........] - ETA: 3s - loss: 0.1203 - acc: 0.9623
576/753 [=====================>........] - ETA: 3s - loss: 0.1191 - acc: 0.9633
608/753 [=======================>......] - ETA: 2s - loss: 0.1209 - acc: 0.9628
640/753 [========================>.....] - ETA: 2s - loss: 0.1201 - acc: 0.9628
672/753 [=========================>....] - ETA: 1s - loss: 0.1193 - acc: 0.9630
704/753 [===========================>..] - ETA: 0s - loss: 0.1175 - acc: 0.9634
736/753 [============================>.] - ETA: 0s - loss: 0.1180 - acc: 0.9634
753/753 [==============================] - 15s 20ms/step - loss: 0.1208 - acc: 0.9631 - val_loss: 0.1548 - val_acc: 0.9517
Computing...
Manual evaluation: (didn't understand why I made this)
True 8108
False 963
True percentage 0.893837504134
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.97      7318
      B-PER       0.88      0.82      0.85       438
      B-ORG       0.78      0.70      0.74       296
      I-ORG       0.56      0.55      0.56       151
      I-PER       0.88      0.60      0.71       214
      B-LOC       0.66      0.69      0.67       218
      I-LOC       0.72      0.74      0.73       141
     B-MISC       0.37      0.29      0.33       141
     I-MISC       0.44      0.32      0.37       154

avg / total       0.93      0.89      0.91      9071

F-1 Score:
0.675903614458
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 837 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100806 unique words.
Found 94 unique chars.
Found 9 unique labels.
802 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 259
OOV word occurences: 368
Padding...
Data padded!
Padding...
Data padded!
Padded until 58 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 58, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 58)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 58, 64)       6451648     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 58, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 58, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 58, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 58, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 58, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,954,754
Trainable params: 6,954,754
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 753 samples, validate on 84 samples
Epoch 1/70

 32/753 [>.............................] - ETA: 1:02 - loss: 2.4299 - acc: 0.0213
 64/753 [=>............................] - ETA: 35s - loss: 1.6278 - acc: 0.4252 
 96/753 [==>...........................] - ETA: 25s - loss: 1.8101 - acc: 0.5594
128/753 [====>.........................] - ETA: 20s - loss: 1.6525 - acc: 0.6043
160/753 [=====>........................] - ETA: 17s - loss: 1.4955 - acc: 0.6428
192/753 [======>.......................] - ETA: 15s - loss: 1.4006 - acc: 0.6623
224/753 [=======>......................] - ETA: 13s - loss: 1.2886 - acc: 0.6871
256/753 [=========>....................] - ETA: 11s - loss: 1.2163 - acc: 0.7018
288/753 [==========>...................] - ETA: 10s - loss: 1.1574 - acc: 0.7133
320/753 [===========>..................] - ETA: 9s - loss: 1.1113 - acc: 0.7213 
352/753 [=============>................] - ETA: 8s - loss: 1.0650 - acc: 0.7316
384/753 [==============>...............] - ETA: 7s - loss: 1.0340 - acc: 0.7358
416/753 [===============>..............] - ETA: 6s - loss: 1.0067 - acc: 0.7409
448/753 [================>.............] - ETA: 6s - loss: 0.9771 - acc: 0.7471
480/753 [==================>...........] - ETA: 5s - loss: 0.9509 - acc: 0.7522
512/753 [===================>..........] - ETA: 4s - loss: 0.9265 - acc: 0.7573
544/753 [====================>.........] - ETA: 4s - loss: 0.9072 - acc: 0.7599
576/753 [=====================>........] - ETA: 3s - loss: 0.8838 - acc: 0.7659
608/753 [=======================>......] - ETA: 2s - loss: 0.8665 - acc: 0.7691
640/753 [========================>.....] - ETA: 2s - loss: 0.8441 - acc: 0.7765
672/753 [=========================>....] - ETA: 1s - loss: 0.8269 - acc: 0.7800
704/753 [===========================>..] - ETA: 0s - loss: 0.8124 - acc: 0.7842
736/753 [============================>.] - ETA: 0s - loss: 0.7913 - acc: 0.7893
753/753 [==============================] - 14s 19ms/step - loss: 0.7849 - acc: 0.7902 - val_loss: 0.4211 - val_acc: 0.8656
Epoch 2/70

 32/753 [>.............................] - ETA: 10s - loss: 0.4453 - acc: 0.8714
 64/753 [=>............................] - ETA: 10s - loss: 0.4098 - acc: 0.8767
 96/753 [==>...........................] - ETA: 9s - loss: 0.4046 - acc: 0.8816 
128/753 [====>.........................] - ETA: 9s - loss: 0.4344 - acc: 0.8702
160/753 [=====>........................] - ETA: 8s - loss: 0.4403 - acc: 0.8666
192/753 [======>.......................] - ETA: 8s - loss: 0.4245 - acc: 0.8707
224/753 [=======>......................] - ETA: 7s - loss: 0.4133 - acc: 0.8727
256/753 [=========>....................] - ETA: 7s - loss: 0.4065 - acc: 0.8751
288/753 [==========>...................] - ETA: 6s - loss: 0.3969 - acc: 0.8785
320/753 [===========>..................] - ETA: 6s - loss: 0.4081 - acc: 0.8726
352/753 [=============>................] - ETA: 5s - loss: 0.3983 - acc: 0.8770
384/753 [==============>...............] - ETA: 5s - loss: 0.3916 - acc: 0.8785
416/753 [===============>..............] - ETA: 4s - loss: 0.3879 - acc: 0.8793
448/753 [================>.............] - ETA: 4s - loss: 0.3832 - acc: 0.8805
480/753 [==================>...........] - ETA: 3s - loss: 0.3755 - acc: 0.8833
512/753 [===================>..........] - ETA: 3s - loss: 0.3706 - acc: 0.8845
544/753 [====================>.........] - ETA: 3s - loss: 0.3717 - acc: 0.8834
576/753 [=====================>........] - ETA: 2s - loss: 0.3693 - acc: 0.8849
608/753 [=======================>......] - ETA: 2s - loss: 0.3706 - acc: 0.8839
640/753 [========================>.....] - ETA: 1s - loss: 0.3705 - acc: 0.8842
672/753 [=========================>....] - ETA: 1s - loss: 0.3667 - acc: 0.8850
704/753 [===========================>..] - ETA: 0s - loss: 0.3626 - acc: 0.8864
736/753 [============================>.] - ETA: 0s - loss: 0.3610 - acc: 0.8877
753/753 [==============================] - 11s 15ms/step - loss: 0.3593 - acc: 0.8884 - val_loss: 0.3068 - val_acc: 0.9028
Epoch 3/70

 32/753 [>.............................] - ETA: 10s - loss: 0.2791 - acc: 0.9190
 64/753 [=>............................] - ETA: 9s - loss: 0.2539 - acc: 0.9241 
 96/753 [==>...........................] - ETA: 9s - loss: 0.2440 - acc: 0.9278
128/753 [====>.........................] - ETA: 8s - loss: 0.2536 - acc: 0.9230
160/753 [=====>........................] - ETA: 8s - loss: 0.2547 - acc: 0.9227
192/753 [======>.......................] - ETA: 8s - loss: 0.2602 - acc: 0.9207
224/753 [=======>......................] - ETA: 7s - loss: 0.2542 - acc: 0.9240
256/753 [=========>....................] - ETA: 7s - loss: 0.2576 - acc: 0.9233
288/753 [==========>...................] - ETA: 6s - loss: 0.2576 - acc: 0.9228
320/753 [===========>..................] - ETA: 6s - loss: 0.2631 - acc: 0.9217
352/753 [=============>................] - ETA: 5s - loss: 0.2711 - acc: 0.9193
384/753 [==============>...............] - ETA: 5s - loss: 0.2756 - acc: 0.9178
416/753 [===============>..............] - ETA: 4s - loss: 0.2713 - acc: 0.9197
448/753 [================>.............] - ETA: 4s - loss: 0.2679 - acc: 0.9207
480/753 [==================>...........] - ETA: 3s - loss: 0.2646 - acc: 0.9219
512/753 [===================>..........] - ETA: 3s - loss: 0.2668 - acc: 0.9200
544/753 [====================>.........] - ETA: 3s - loss: 0.2735 - acc: 0.9184
576/753 [=====================>........] - ETA: 2s - loss: 0.2763 - acc: 0.9172
608/753 [=======================>......] - ETA: 2s - loss: 0.2780 - acc: 0.9167
640/753 [========================>.....] - ETA: 1s - loss: 0.2768 - acc: 0.9165
672/753 [=========================>....] - ETA: 1s - loss: 0.2768 - acc: 0.9162
704/753 [===========================>..] - ETA: 0s - loss: 0.2788 - acc: 0.9150
736/753 [============================>.] - ETA: 0s - loss: 0.2779 - acc: 0.9156
753/753 [==============================] - 11s 15ms/step - loss: 0.2760 - acc: 0.9162 - val_loss: 0.2521 - val_acc: 0.9209
Epoch 4/70

 32/753 [>.............................] - ETA: 10s - loss: 0.2131 - acc: 0.9330
 64/753 [=>............................] - ETA: 9s - loss: 0.2049 - acc: 0.9342 
 96/753 [==>...........................] - ETA: 9s - loss: 0.2125 - acc: 0.9324
128/753 [====>.........................] - ETA: 8s - loss: 0.2148 - acc: 0.9327
160/753 [=====>........................] - ETA: 8s - loss: 0.2172 - acc: 0.9339
192/753 [======>.......................] - ETA: 8s - loss: 0.2102 - acc: 0.9375
224/753 [=======>......................] - ETA: 7s - loss: 0.2129 - acc: 0.9370
256/753 [=========>....................] - ETA: 7s - loss: 0.2157 - acc: 0.9364
288/753 [==========>...................] - ETA: 6s - loss: 0.2134 - acc: 0.9368
320/753 [===========>..................] - ETA: 6s - loss: 0.2141 - acc: 0.9359
352/753 [=============>................] - ETA: 5s - loss: 0.2154 - acc: 0.9351
384/753 [==============>...............] - ETA: 5s - loss: 0.2134 - acc: 0.9351
416/753 [===============>..............] - ETA: 4s - loss: 0.2180 - acc: 0.9331
448/753 [================>.............] - ETA: 4s - loss: 0.2188 - acc: 0.9327
480/753 [==================>...........] - ETA: 3s - loss: 0.2155 - acc: 0.9340
512/753 [===================>..........] - ETA: 3s - loss: 0.2185 - acc: 0.9329
544/753 [====================>.........] - ETA: 3s - loss: 0.2205 - acc: 0.9319
576/753 [=====================>........] - ETA: 2s - loss: 0.2211 - acc: 0.9318
608/753 [=======================>......] - ETA: 2s - loss: 0.2199 - acc: 0.9324
640/753 [========================>.....] - ETA: 1s - loss: 0.2253 - acc: 0.9302
672/753 [=========================>....] - ETA: 1s - loss: 0.2239 - acc: 0.9307
704/753 [===========================>..] - ETA: 0s - loss: 0.2221 - acc: 0.9310
736/753 [============================>.] - ETA: 0s - loss: 0.2197 - acc: 0.9321
753/753 [==============================] - 11s 15ms/step - loss: 0.2195 - acc: 0.9323 - val_loss: 0.2282 - val_acc: 0.9335
Epoch 5/70

 32/753 [>.............................] - ETA: 10s - loss: 0.2530 - acc: 0.9171
 64/753 [=>............................] - ETA: 9s - loss: 0.2369 - acc: 0.9184 
 96/753 [==>...........................] - ETA: 9s - loss: 0.2244 - acc: 0.9224
128/753 [====>.........................] - ETA: 8s - loss: 0.2183 - acc: 0.9265
160/753 [=====>........................] - ETA: 8s - loss: 0.2256 - acc: 0.9234
192/753 [======>.......................] - ETA: 8s - loss: 0.2175 - acc: 0.9270
224/753 [=======>......................] - ETA: 7s - loss: 0.2114 - acc: 0.9309
256/753 [=========>....................] - ETA: 7s - loss: 0.2054 - acc: 0.9317
288/753 [==========>...................] - ETA: 6s - loss: 0.2094 - acc: 0.9308
320/753 [===========>..................] - ETA: 6s - loss: 0.2033 - acc: 0.9336
352/753 [=============>................] - ETA: 5s - loss: 0.2004 - acc: 0.9342
384/753 [==============>...............] - ETA: 5s - loss: 0.1989 - acc: 0.9356
416/753 [===============>..............] - ETA: 4s - loss: 0.1950 - acc: 0.9377
448/753 [================>.............] - ETA: 4s - loss: 0.1918 - acc: 0.9389
480/753 [==================>...........] - ETA: 3s - loss: 0.1906 - acc: 0.9393
512/753 [===================>..........] - ETA: 3s - loss: 0.1888 - acc: 0.9400
544/753 [====================>.........] - ETA: 2s - loss: 0.1895 - acc: 0.9397
576/753 [=====================>........] - ETA: 2s - loss: 0.1875 - acc: 0.9403
608/753 [=======================>......] - ETA: 2s - loss: 0.1886 - acc: 0.9395
640/753 [========================>.....] - ETA: 1s - loss: 0.1866 - acc: 0.9404
672/753 [=========================>....] - ETA: 1s - loss: 0.1911 - acc: 0.9387
704/753 [===========================>..] - ETA: 0s - loss: 0.1910 - acc: 0.9390
736/753 [============================>.] - ETA: 0s - loss: 0.1893 - acc: 0.9399
753/753 [==============================] - 11s 15ms/step - loss: 0.1881 - acc: 0.9403 - val_loss: 0.2064 - val_acc: 0.9373
Epoch 6/70

 32/753 [>.............................] - ETA: 10s - loss: 0.1330 - acc: 0.9616
 64/753 [=>............................] - ETA: 9s - loss: 0.2097 - acc: 0.9289 
 96/753 [==>...........................] - ETA: 9s - loss: 0.1882 - acc: 0.9383
128/753 [====>.........................] - ETA: 9s - loss: 0.1753 - acc: 0.9436
160/753 [=====>........................] - ETA: 8s - loss: 0.1741 - acc: 0.9459
192/753 [======>.......................] - ETA: 8s - loss: 0.1769 - acc: 0.9431
224/753 [=======>......................] - ETA: 7s - loss: 0.1672 - acc: 0.9472
256/753 [=========>....................] - ETA: 7s - loss: 0.1670 - acc: 0.9464
288/753 [==========>...................] - ETA: 6s - loss: 0.1681 - acc: 0.9459
320/753 [===========>..................] - ETA: 6s - loss: 0.1727 - acc: 0.9449
352/753 [=============>................] - ETA: 5s - loss: 0.1670 - acc: 0.9477
384/753 [==============>...............] - ETA: 5s - loss: 0.1645 - acc: 0.9489
416/753 [===============>..............] - ETA: 4s - loss: 0.1600 - acc: 0.9503
448/753 [================>.............] - ETA: 4s - loss: 0.1612 - acc: 0.9499
480/753 [==================>...........] - ETA: 3s - loss: 0.1600 - acc: 0.9504
512/753 [===================>..........] - ETA: 3s - loss: 0.1583 - acc: 0.9511
544/753 [====================>.........] - ETA: 3s - loss: 0.1603 - acc: 0.9505
576/753 [=====================>........] - ETA: 2s - loss: 0.1600 - acc: 0.9506
608/753 [=======================>......] - ETA: 2s - loss: 0.1573 - acc: 0.9516
640/753 [========================>.....] - ETA: 1s - loss: 0.1577 - acc: 0.9511
672/753 [=========================>....] - ETA: 1s - loss: 0.1604 - acc: 0.9503
704/753 [===========================>..] - ETA: 0s - loss: 0.1636 - acc: 0.9490
736/753 [============================>.] - ETA: 0s - loss: 0.1663 - acc: 0.9483
753/753 [==============================] - 11s 15ms/step - loss: 0.1669 - acc: 0.9480 - val_loss: 0.2001 - val_acc: 0.9366
Epoch 7/70

 32/753 [>.............................] - ETA: 10s - loss: 0.1146 - acc: 0.9634
 64/753 [=>............................] - ETA: 10s - loss: 0.1270 - acc: 0.9576
 96/753 [==>...........................] - ETA: 9s - loss: 0.1148 - acc: 0.9645 
128/753 [====>.........................] - ETA: 9s - loss: 0.1317 - acc: 0.9587
160/753 [=====>........................] - ETA: 8s - loss: 0.1310 - acc: 0.9600
192/753 [======>.......................] - ETA: 8s - loss: 0.1404 - acc: 0.9559
224/753 [=======>......................] - ETA: 7s - loss: 0.1425 - acc: 0.9553
256/753 [=========>....................] - ETA: 7s - loss: 0.1380 - acc: 0.9570
288/753 [==========>...................] - ETA: 6s - loss: 0.1439 - acc: 0.9555
320/753 [===========>..................] - ETA: 6s - loss: 0.1423 - acc: 0.9568
352/753 [=============>................] - ETA: 5s - loss: 0.1499 - acc: 0.9546
384/753 [==============>...............] - ETA: 5s - loss: 0.1498 - acc: 0.9541
416/753 [===============>..............] - ETA: 4s - loss: 0.1480 - acc: 0.9542
448/753 [================>.............] - ETA: 4s - loss: 0.1515 - acc: 0.9520
480/753 [==================>...........] - ETA: 3s - loss: 0.1513 - acc: 0.9527
512/753 [===================>..........] - ETA: 3s - loss: 0.1520 - acc: 0.9526
544/753 [====================>.........] - ETA: 3s - loss: 0.1541 - acc: 0.9516
576/753 [=====================>........] - ETA: 2s - loss: 0.1560 - acc: 0.9513
608/753 [=======================>......] - ETA: 2s - loss: 0.1582 - acc: 0.9508
640/753 [========================>.....] - ETA: 1s - loss: 0.1563 - acc: 0.9514
672/753 [=========================>....] - ETA: 1s - loss: 0.1561 - acc: 0.9514
704/753 [===========================>..] - ETA: 0s - loss: 0.1555 - acc: 0.9513
736/753 [============================>.] - ETA: 0s - loss: 0.1536 - acc: 0.9520
753/753 [==============================] - 11s 15ms/step - loss: 0.1523 - acc: 0.9524 - val_loss: 0.2076 - val_acc: 0.9389
Epoch 8/70

 32/753 [>.............................] - ETA: 10s - loss: 0.1688 - acc: 0.9442
 64/753 [=>............................] - ETA: 9s - loss: 0.1727 - acc: 0.9398 
 96/753 [==>...........................] - ETA: 9s - loss: 0.1648 - acc: 0.9466
128/753 [====>.........................] - ETA: 8s - loss: 0.1510 - acc: 0.9510
160/753 [=====>........................] - ETA: 8s - loss: 0.1479 - acc: 0.9514
192/753 [======>.......................] - ETA: 8s - loss: 0.1532 - acc: 0.9492
224/753 [=======>......................] - ETA: 7s - loss: 0.1472 - acc: 0.9505
256/753 [=========>....................] - ETA: 7s - loss: 0.1390 - acc: 0.9542
288/753 [==========>...................] - ETA: 6s - loss: 0.1383 - acc: 0.9549
320/753 [===========>..................] - ETA: 6s - loss: 0.1386 - acc: 0.9552
352/753 [=============>................] - ETA: 5s - loss: 0.1365 - acc: 0.9565
384/753 [==============>...............] - ETA: 5s - loss: 0.1362 - acc: 0.9562
416/753 [===============>..............] - ETA: 4s - loss: 0.1338 - acc: 0.9570
448/753 [================>.............] - ETA: 4s - loss: 0.1368 - acc: 0.9559
480/753 [==================>...........] - ETA: 3s - loss: 0.1358 - acc: 0.9564
512/753 [===================>..........] - ETA: 3s - loss: 0.1339 - acc: 0.9567
544/753 [====================>.........] - ETA: 3s - loss: 0.1327 - acc: 0.9574
576/753 [=====================>........] - ETA: 2s - loss: 0.1356 - acc: 0.9565
608/753 [=======================>......] - ETA: 2s - loss: 0.1360 - acc: 0.9570
640/753 [========================>.....] - ETA: 1s - loss: 0.1350 - acc: 0.9577
672/753 [=========================>....] - ETA: 1s - loss: 0.1349 - acc: 0.9577
704/753 [===========================>..] - ETA: 0s - loss: 0.1350 - acc: 0.9574
736/753 [============================>.] - ETA: 0s - loss: 0.1357 - acc: 0.9572
753/753 [==============================] - 11s 15ms/step - loss: 0.1365 - acc: 0.9567 - val_loss: 0.1962 - val_acc: 0.9405
Epoch 9/70

 32/753 [>.............................] - ETA: 10s - loss: 0.1178 - acc: 0.9634
 64/753 [=>............................] - ETA: 9s - loss: 0.1229 - acc: 0.9599 
 96/753 [==>...........................] - ETA: 9s - loss: 0.1177 - acc: 0.9599
128/753 [====>.........................] - ETA: 8s - loss: 0.1089 - acc: 0.9645
160/753 [=====>........................] - ETA: 8s - loss: 0.1142 - acc: 0.9637
192/753 [======>.......................] - ETA: 8s - loss: 0.1123 - acc: 0.9655
224/753 [=======>......................] - ETA: 7s - loss: 0.1107 - acc: 0.9665
256/753 [=========>....................] - ETA: 7s - loss: 0.1176 - acc: 0.9637
288/753 [==========>...................] - ETA: 6s - loss: 0.1225 - acc: 0.9621
320/753 [===========>..................] - ETA: 6s - loss: 0.1218 - acc: 0.9623
352/753 [=============>................] - ETA: 5s - loss: 0.1258 - acc: 0.9610
384/753 [==============>...............] - ETA: 5s - loss: 0.1249 - acc: 0.9612
416/753 [===============>..............] - ETA: 4s - loss: 0.1245 - acc: 0.9614
448/753 [================>.............] - ETA: 4s - loss: 0.1261 - acc: 0.9610
480/753 [==================>...........] - ETA: 3s - loss: 0.1259 - acc: 0.9612
512/753 [===================>..........] - ETA: 3s - loss: 0.1280 - acc: 0.9599
544/753 [====================>.........] - ETA: 3s - loss: 0.1267 - acc: 0.9599
576/753 [=====================>........] - ETA: 2s - loss: 0.1253 - acc: 0.9602
608/753 [=======================>......] - ETA: 2s - loss: 0.1275 - acc: 0.9592
640/753 [========================>.....] - ETA: 1s - loss: 0.1265 - acc: 0.9596
672/753 [=========================>....] - ETA: 1s - loss: 0.1276 - acc: 0.9595
704/753 [===========================>..] - ETA: 0s - loss: 0.1263 - acc: 0.9602
736/753 [============================>.] - ETA: 0s - loss: 0.1264 - acc: 0.9603
753/753 [==============================] - 11s 15ms/step - loss: 0.1266 - acc: 0.9605 - val_loss: 0.1789 - val_acc: 0.9404
Epoch 10/70

 32/753 [>.............................] - ETA: 10s - loss: 0.0840 - acc: 0.9747
 64/753 [=>............................] - ETA: 9s - loss: 0.0912 - acc: 0.9714 
 96/753 [==>...........................] - ETA: 9s - loss: 0.0963 - acc: 0.9711
128/753 [====>.........................] - ETA: 8s - loss: 0.0983 - acc: 0.9703
160/753 [=====>........................] - ETA: 8s - loss: 0.1009 - acc: 0.9691
192/753 [======>.......................] - ETA: 7s - loss: 0.0985 - acc: 0.9698
224/753 [=======>......................] - ETA: 7s - loss: 0.0967 - acc: 0.9711
256/753 [=========>....................] - ETA: 7s - loss: 0.0981 - acc: 0.9700
288/753 [==========>...................] - ETA: 6s - loss: 0.1029 - acc: 0.9684
320/753 [===========>..................] - ETA: 6s - loss: 0.1014 - acc: 0.9691
352/753 [=============>................] - ETA: 5s - loss: 0.1040 - acc: 0.9688
384/753 [==============>...............] - ETA: 5s - loss: 0.1058 - acc: 0.9677
416/753 [===============>..............] - ETA: 4s - loss: 0.1054 - acc: 0.9683
448/753 [================>.............] - ETA: 4s - loss: 0.1068 - acc: 0.9679
480/753 [==================>...........] - ETA: 3s - loss: 0.1093 - acc: 0.9672
512/753 [===================>..........] - ETA: 3s - loss: 0.1136 - acc: 0.9658
544/753 [====================>.........] - ETA: 2s - loss: 0.1145 - acc: 0.9655
576/753 [=====================>........] - ETA: 2s - loss: 0.1125 - acc: 0.9661
608/753 [=======================>......] - ETA: 2s - loss: 0.1122 - acc: 0.9660
640/753 [========================>.....] - ETA: 1s - loss: 0.1152 - acc: 0.9653
672/753 [=========================>....] - ETA: 1s - loss: 0.1149 - acc: 0.9650
704/753 [===========================>..] - ETA: 0s - loss: 0.1140 - acc: 0.9655
736/753 [============================>.] - ETA: 0s - loss: 0.1131 - acc: 0.9657
753/753 [==============================] - 11s 15ms/step - loss: 0.1142 - acc: 0.9653 - val_loss: 0.1802 - val_acc: 0.9441
Epoch 11/70

 32/753 [>.............................] - ETA: 10s - loss: 0.0805 - acc: 0.9670
 64/753 [=>............................] - ETA: 9s - loss: 0.0907 - acc: 0.9668 
 96/753 [==>...........................] - ETA: 9s - loss: 0.0778 - acc: 0.9751
128/753 [====>.........................] - ETA: 8s - loss: 0.0775 - acc: 0.9758
160/753 [=====>........................] - ETA: 8s - loss: 0.0849 - acc: 0.9722
192/753 [======>.......................] - ETA: 7s - loss: 0.0916 - acc: 0.9692
224/753 [=======>......................] - ETA: 7s - loss: 0.0879 - acc: 0.9710
256/753 [=========>....................] - ETA: 7s - loss: 0.0864 - acc: 0.9722
288/753 [==========>...................] - ETA: 6s - loss: 0.0948 - acc: 0.9702
320/753 [===========>..................] - ETA: 6s - loss: 0.0963 - acc: 0.9701
352/753 [=============>................] - ETA: 5s - loss: 0.1015 - acc: 0.9687
384/753 [==============>...............] - ETA: 5s - loss: 0.1011 - acc: 0.9685
416/753 [===============>..............] - ETA: 4s - loss: 0.1034 - acc: 0.9683
448/753 [================>.............] - ETA: 4s - loss: 0.1028 - acc: 0.9683
480/753 [==================>...........] - ETA: 3s - loss: 0.1034 - acc: 0.9675
512/753 [===================>..........] - ETA: 3s - loss: 0.1086 - acc: 0.9661
544/753 [====================>.........] - ETA: 3s - loss: 0.1073 - acc: 0.9667
576/753 [=====================>........] - ETA: 2s - loss: 0.1079 - acc: 0.9664
608/753 [=======================>......] - ETA: 2s - loss: 0.1064 - acc: 0.9670
640/753 [========================>.....] - ETA: 1s - loss: 0.1060 - acc: 0.9673
672/753 [=========================>....] - ETA: 1s - loss: 0.1061 - acc: 0.9672
704/753 [===========================>..] - ETA: 0s - loss: 0.1063 - acc: 0.9671
736/753 [============================>.] - ETA: 0s - loss: 0.1041 - acc: 0.9680
753/753 [==============================] - 11s 15ms/step - loss: 0.1048 - acc: 0.9679 - val_loss: 0.1868 - val_acc: 0.9455
Computing...
Manual evaluation: (didn't understand why I made this)
True 8087
False 984
True percentage 0.891522434131
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.96      0.97      7318
     B-MISC       0.33      0.21      0.25       141
     I-MISC       0.45      0.40      0.42       154
      B-ORG       0.78      0.60      0.68       296
      I-ORG       0.62      0.37      0.46       151
      B-PER       0.93      0.71      0.80       438
      I-PER       0.89      0.62      0.73       214
      B-LOC       0.70      0.75      0.72       218
      I-LOC       0.65      0.79      0.71       141

avg / total       0.92      0.89      0.90      9071

F-1 Score:
0.653483992467
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 837 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100790 unique words.
Found 94 unique chars.
Found 9 unique labels.
786 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 259
OOV word occurences: 392
Padding...
Data padded!
Padding...
Data padded!
Padded until 67 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 67, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 67)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 67, 64)       6450624     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 67, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 67, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 67, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 67, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 67, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,953,730
Trainable params: 6,953,730
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 753 samples, validate on 84 samples
Epoch 1/70

 32/753 [>.............................] - ETA: 1:03 - loss: 2.5395 - acc: 0.0281
 64/753 [=>............................] - ETA: 36s - loss: 1.7694 - acc: 0.4198 
 96/753 [==>...........................] - ETA: 26s - loss: 1.9994 - acc: 0.5504
128/753 [====>.........................] - ETA: 21s - loss: 1.7391 - acc: 0.6114
160/753 [=====>........................] - ETA: 18s - loss: 1.5739 - acc: 0.6544
192/753 [======>.......................] - ETA: 16s - loss: 1.4669 - acc: 0.6745
224/753 [=======>......................] - ETA: 14s - loss: 1.3868 - acc: 0.6868
256/753 [=========>....................] - ETA: 12s - loss: 1.2978 - acc: 0.7041
288/753 [==========>...................] - ETA: 11s - loss: 1.2353 - acc: 0.7134
320/753 [===========>..................] - ETA: 10s - loss: 1.1807 - acc: 0.7225
352/753 [=============>................] - ETA: 9s - loss: 1.1382 - acc: 0.7287 
384/753 [==============>...............] - ETA: 8s - loss: 1.1039 - acc: 0.7340
416/753 [===============>..............] - ETA: 7s - loss: 1.0716 - acc: 0.7386
448/753 [================>.............] - ETA: 6s - loss: 1.0380 - acc: 0.7449
480/753 [==================>...........] - ETA: 5s - loss: 1.0072 - acc: 0.7500
512/753 [===================>..........] - ETA: 5s - loss: 0.9784 - acc: 0.7550
544/753 [====================>.........] - ETA: 4s - loss: 0.9562 - acc: 0.7579
576/753 [=====================>........] - ETA: 3s - loss: 0.9276 - acc: 0.7647
608/753 [=======================>......] - ETA: 2s - loss: 0.9107 - acc: 0.7672
640/753 [========================>.....] - ETA: 2s - loss: 0.8953 - acc: 0.7716
672/753 [=========================>....] - ETA: 1s - loss: 0.8729 - acc: 0.7762
704/753 [===========================>..] - ETA: 0s - loss: 0.8576 - acc: 0.7788
736/753 [============================>.] - ETA: 0s - loss: 0.8392 - acc: 0.7830
753/753 [==============================] - 16s 21ms/step - loss: 0.8318 - acc: 0.7846 - val_loss: 0.4378 - val_acc: 0.8669
Epoch 2/70

 32/753 [>.............................] - ETA: 11s - loss: 0.4206 - acc: 0.8806
 64/753 [=>............................] - ETA: 11s - loss: 0.4118 - acc: 0.8730
 96/753 [==>...........................] - ETA: 10s - loss: 0.3992 - acc: 0.8756
128/753 [====>.........................] - ETA: 10s - loss: 0.4101 - acc: 0.8705
160/753 [=====>........................] - ETA: 9s - loss: 0.4086 - acc: 0.8717 
192/753 [======>.......................] - ETA: 9s - loss: 0.4065 - acc: 0.8722
224/753 [=======>......................] - ETA: 8s - loss: 0.4052 - acc: 0.8716
256/753 [=========>....................] - ETA: 8s - loss: 0.3997 - acc: 0.8753
288/753 [==========>...................] - ETA: 7s - loss: 0.4000 - acc: 0.8745
320/753 [===========>..................] - ETA: 7s - loss: 0.3934 - acc: 0.8798
352/753 [=============>................] - ETA: 6s - loss: 0.3940 - acc: 0.8805
384/753 [==============>...............] - ETA: 6s - loss: 0.3908 - acc: 0.8803
416/753 [===============>..............] - ETA: 5s - loss: 0.3888 - acc: 0.8807
448/753 [================>.............] - ETA: 5s - loss: 0.3852 - acc: 0.8817
480/753 [==================>...........] - ETA: 4s - loss: 0.3866 - acc: 0.8830
512/753 [===================>..........] - ETA: 3s - loss: 0.3924 - acc: 0.8801
544/753 [====================>.........] - ETA: 3s - loss: 0.3882 - acc: 0.8812
576/753 [=====================>........] - ETA: 2s - loss: 0.3863 - acc: 0.8813
608/753 [=======================>......] - ETA: 2s - loss: 0.3819 - acc: 0.8829
640/753 [========================>.....] - ETA: 1s - loss: 0.3805 - acc: 0.8831
672/753 [=========================>....] - ETA: 1s - loss: 0.3805 - acc: 0.8829
704/753 [===========================>..] - ETA: 0s - loss: 0.3775 - acc: 0.8841
736/753 [============================>.] - ETA: 0s - loss: 0.3754 - acc: 0.8844
753/753 [==============================] - 13s 17ms/step - loss: 0.3726 - acc: 0.8856 - val_loss: 0.3072 - val_acc: 0.8994
Epoch 3/70

 32/753 [>.............................] - ETA: 11s - loss: 0.3025 - acc: 0.9034
 64/753 [=>............................] - ETA: 11s - loss: 0.3013 - acc: 0.9125
 96/753 [==>...........................] - ETA: 10s - loss: 0.2788 - acc: 0.9174
128/753 [====>.........................] - ETA: 10s - loss: 0.2848 - acc: 0.9158
160/753 [=====>........................] - ETA: 9s - loss: 0.3004 - acc: 0.9106 
192/753 [======>.......................] - ETA: 9s - loss: 0.3053 - acc: 0.9081
224/753 [=======>......................] - ETA: 8s - loss: 0.3013 - acc: 0.9072
256/753 [=========>....................] - ETA: 8s - loss: 0.2951 - acc: 0.9083
288/753 [==========>...................] - ETA: 7s - loss: 0.2964 - acc: 0.9076
320/753 [===========>..................] - ETA: 7s - loss: 0.2917 - acc: 0.9086
352/753 [=============>................] - ETA: 6s - loss: 0.2855 - acc: 0.9116
384/753 [==============>...............] - ETA: 6s - loss: 0.2877 - acc: 0.9101
416/753 [===============>..............] - ETA: 5s - loss: 0.2845 - acc: 0.9119
448/753 [================>.............] - ETA: 5s - loss: 0.2820 - acc: 0.9128
480/753 [==================>...........] - ETA: 4s - loss: 0.2775 - acc: 0.9144
512/753 [===================>..........] - ETA: 3s - loss: 0.2815 - acc: 0.9138
544/753 [====================>.........] - ETA: 3s - loss: 0.2800 - acc: 0.9151
576/753 [=====================>........] - ETA: 2s - loss: 0.2785 - acc: 0.9156
608/753 [=======================>......] - ETA: 2s - loss: 0.2748 - acc: 0.9169
640/753 [========================>.....] - ETA: 1s - loss: 0.2709 - acc: 0.9177
672/753 [=========================>....] - ETA: 1s - loss: 0.2722 - acc: 0.9174
704/753 [===========================>..] - ETA: 0s - loss: 0.2738 - acc: 0.9170
736/753 [============================>.] - ETA: 0s - loss: 0.2728 - acc: 0.9178
753/753 [==============================] - 13s 17ms/step - loss: 0.2707 - acc: 0.9186 - val_loss: 0.2504 - val_acc: 0.9213
Epoch 4/70

 32/753 [>.............................] - ETA: 11s - loss: 0.2524 - acc: 0.9201
 64/753 [=>............................] - ETA: 11s - loss: 0.2159 - acc: 0.9362
 96/753 [==>...........................] - ETA: 10s - loss: 0.2329 - acc: 0.9313
128/753 [====>.........................] - ETA: 10s - loss: 0.2215 - acc: 0.9343
160/753 [=====>........................] - ETA: 9s - loss: 0.2138 - acc: 0.9363 
192/753 [======>.......................] - ETA: 9s - loss: 0.2177 - acc: 0.9347
224/753 [=======>......................] - ETA: 8s - loss: 0.2125 - acc: 0.9353
256/753 [=========>....................] - ETA: 8s - loss: 0.2083 - acc: 0.9365
288/753 [==========>...................] - ETA: 7s - loss: 0.2205 - acc: 0.9305
320/753 [===========>..................] - ETA: 7s - loss: 0.2251 - acc: 0.9303
352/753 [=============>................] - ETA: 6s - loss: 0.2228 - acc: 0.9306
384/753 [==============>...............] - ETA: 6s - loss: 0.2210 - acc: 0.9309
416/753 [===============>..............] - ETA: 5s - loss: 0.2201 - acc: 0.9314
448/753 [================>.............] - ETA: 5s - loss: 0.2252 - acc: 0.9293
480/753 [==================>...........] - ETA: 4s - loss: 0.2229 - acc: 0.9305
512/753 [===================>..........] - ETA: 3s - loss: 0.2216 - acc: 0.9309
544/753 [====================>.........] - ETA: 3s - loss: 0.2193 - acc: 0.9316
576/753 [=====================>........] - ETA: 2s - loss: 0.2178 - acc: 0.9318
608/753 [=======================>......] - ETA: 2s - loss: 0.2176 - acc: 0.9315
640/753 [========================>.....] - ETA: 1s - loss: 0.2173 - acc: 0.9312
672/753 [=========================>....] - ETA: 1s - loss: 0.2225 - acc: 0.9300
704/753 [===========================>..] - ETA: 0s - loss: 0.2255 - acc: 0.9288
736/753 [============================>.] - ETA: 0s - loss: 0.2254 - acc: 0.9288
753/753 [==============================] - 13s 17ms/step - loss: 0.2251 - acc: 0.9289 - val_loss: 0.2329 - val_acc: 0.9310
Epoch 5/70

 32/753 [>.............................] - ETA: 11s - loss: 0.2347 - acc: 0.9221
 64/753 [=>............................] - ETA: 11s - loss: 0.2193 - acc: 0.9348
 96/753 [==>...........................] - ETA: 10s - loss: 0.1990 - acc: 0.9415
128/753 [====>.........................] - ETA: 10s - loss: 0.2122 - acc: 0.9344
160/753 [=====>........................] - ETA: 9s - loss: 0.2116 - acc: 0.9333 
192/753 [======>.......................] - ETA: 9s - loss: 0.2118 - acc: 0.9330
224/753 [=======>......................] - ETA: 8s - loss: 0.2048 - acc: 0.9353
256/753 [=========>....................] - ETA: 8s - loss: 0.2040 - acc: 0.9351
288/753 [==========>...................] - ETA: 7s - loss: 0.2020 - acc: 0.9365
320/753 [===========>..................] - ETA: 7s - loss: 0.2006 - acc: 0.9376
352/753 [=============>................] - ETA: 6s - loss: 0.1997 - acc: 0.9374
384/753 [==============>...............] - ETA: 6s - loss: 0.2006 - acc: 0.9373
416/753 [===============>..............] - ETA: 5s - loss: 0.2021 - acc: 0.9365
448/753 [================>.............] - ETA: 4s - loss: 0.2016 - acc: 0.9369
480/753 [==================>...........] - ETA: 4s - loss: 0.1975 - acc: 0.9386
512/753 [===================>..........] - ETA: 3s - loss: 0.1989 - acc: 0.9381
544/753 [====================>.........] - ETA: 3s - loss: 0.1958 - acc: 0.9392
576/753 [=====================>........] - ETA: 2s - loss: 0.1950 - acc: 0.9389
608/753 [=======================>......] - ETA: 2s - loss: 0.1937 - acc: 0.9392
640/753 [========================>.....] - ETA: 1s - loss: 0.1938 - acc: 0.9387
672/753 [=========================>....] - ETA: 1s - loss: 0.1954 - acc: 0.9392
704/753 [===========================>..] - ETA: 0s - loss: 0.1941 - acc: 0.9396
736/753 [============================>.] - ETA: 0s - loss: 0.1924 - acc: 0.9403
753/753 [==============================] - 13s 17ms/step - loss: 0.1934 - acc: 0.9400 - val_loss: 0.2158 - val_acc: 0.9337
Epoch 6/70

 32/753 [>.............................] - ETA: 11s - loss: 0.1979 - acc: 0.9279
 64/753 [=>............................] - ETA: 11s - loss: 0.1565 - acc: 0.9490
 96/753 [==>...........................] - ETA: 10s - loss: 0.1619 - acc: 0.9435
128/753 [====>.........................] - ETA: 10s - loss: 0.1565 - acc: 0.9494
160/753 [=====>........................] - ETA: 9s - loss: 0.1523 - acc: 0.9505 
192/753 [======>.......................] - ETA: 9s - loss: 0.1578 - acc: 0.9491
224/753 [=======>......................] - ETA: 8s - loss: 0.1565 - acc: 0.9486
256/753 [=========>....................] - ETA: 8s - loss: 0.1599 - acc: 0.9468
288/753 [==========>...................] - ETA: 7s - loss: 0.1682 - acc: 0.9459
320/753 [===========>..................] - ETA: 7s - loss: 0.1693 - acc: 0.9457
352/753 [=============>................] - ETA: 6s - loss: 0.1692 - acc: 0.9462
384/753 [==============>...............] - ETA: 6s - loss: 0.1739 - acc: 0.9446
416/753 [===============>..............] - ETA: 5s - loss: 0.1689 - acc: 0.9468
448/753 [================>.............] - ETA: 4s - loss: 0.1656 - acc: 0.9480
480/753 [==================>...........] - ETA: 4s - loss: 0.1657 - acc: 0.9476
512/753 [===================>..........] - ETA: 3s - loss: 0.1647 - acc: 0.9485
544/753 [====================>.........] - ETA: 3s - loss: 0.1661 - acc: 0.9482
576/753 [=====================>........] - ETA: 2s - loss: 0.1659 - acc: 0.9479
608/753 [=======================>......] - ETA: 2s - loss: 0.1666 - acc: 0.9479
640/753 [========================>.....] - ETA: 1s - loss: 0.1683 - acc: 0.9469
672/753 [=========================>....] - ETA: 1s - loss: 0.1707 - acc: 0.9457
704/753 [===========================>..] - ETA: 0s - loss: 0.1677 - acc: 0.9470
736/753 [============================>.] - ETA: 0s - loss: 0.1674 - acc: 0.9471
753/753 [==============================] - 13s 17ms/step - loss: 0.1674 - acc: 0.9472 - val_loss: 0.2143 - val_acc: 0.9393
Epoch 7/70

 32/753 [>.............................] - ETA: 11s - loss: 0.1681 - acc: 0.9374
 64/753 [=>............................] - ETA: 11s - loss: 0.1858 - acc: 0.9436
 96/753 [==>...........................] - ETA: 10s - loss: 0.1899 - acc: 0.9385
128/753 [====>.........................] - ETA: 10s - loss: 0.1859 - acc: 0.9382
160/753 [=====>........................] - ETA: 9s - loss: 0.1721 - acc: 0.9437 
192/753 [======>.......................] - ETA: 9s - loss: 0.1608 - acc: 0.9476
224/753 [=======>......................] - ETA: 8s - loss: 0.1602 - acc: 0.9488
256/753 [=========>....................] - ETA: 8s - loss: 0.1641 - acc: 0.9476
288/753 [==========>...................] - ETA: 7s - loss: 0.1558 - acc: 0.9498
320/753 [===========>..................] - ETA: 7s - loss: 0.1536 - acc: 0.9506
352/753 [=============>................] - ETA: 6s - loss: 0.1509 - acc: 0.9515
384/753 [==============>...............] - ETA: 5s - loss: 0.1503 - acc: 0.9512
416/753 [===============>..............] - ETA: 5s - loss: 0.1484 - acc: 0.9520
448/753 [================>.............] - ETA: 4s - loss: 0.1473 - acc: 0.9523
480/753 [==================>...........] - ETA: 4s - loss: 0.1499 - acc: 0.9513
512/753 [===================>..........] - ETA: 3s - loss: 0.1480 - acc: 0.9523
544/753 [====================>.........] - ETA: 3s - loss: 0.1506 - acc: 0.9508
576/753 [=====================>........] - ETA: 2s - loss: 0.1523 - acc: 0.9497
608/753 [=======================>......] - ETA: 2s - loss: 0.1523 - acc: 0.9496
640/753 [========================>.....] - ETA: 1s - loss: 0.1490 - acc: 0.9511
672/753 [=========================>....] - ETA: 1s - loss: 0.1493 - acc: 0.9509
704/753 [===========================>..] - ETA: 0s - loss: 0.1531 - acc: 0.9500
736/753 [============================>.] - ETA: 0s - loss: 0.1512 - acc: 0.9507
753/753 [==============================] - 13s 17ms/step - loss: 0.1508 - acc: 0.9509 - val_loss: 0.2179 - val_acc: 0.9367
Epoch 8/70

 32/753 [>.............................] - ETA: 11s - loss: 0.1339 - acc: 0.9593
 64/753 [=>............................] - ETA: 11s - loss: 0.1327 - acc: 0.9591
 96/753 [==>...........................] - ETA: 10s - loss: 0.1373 - acc: 0.9597
128/753 [====>.........................] - ETA: 10s - loss: 0.1370 - acc: 0.9567
160/753 [=====>........................] - ETA: 9s - loss: 0.1308 - acc: 0.9604 
192/753 [======>.......................] - ETA: 9s - loss: 0.1309 - acc: 0.9596
224/753 [=======>......................] - ETA: 8s - loss: 0.1345 - acc: 0.9596
256/753 [=========>....................] - ETA: 8s - loss: 0.1294 - acc: 0.9603
288/753 [==========>...................] - ETA: 7s - loss: 0.1260 - acc: 0.9609
320/753 [===========>..................] - ETA: 7s - loss: 0.1238 - acc: 0.9613
352/753 [=============>................] - ETA: 6s - loss: 0.1227 - acc: 0.9615
384/753 [==============>...............] - ETA: 6s - loss: 0.1238 - acc: 0.9617
416/753 [===============>..............] - ETA: 5s - loss: 0.1240 - acc: 0.9613
448/753 [================>.............] - ETA: 4s - loss: 0.1288 - acc: 0.9606
480/753 [==================>...........] - ETA: 4s - loss: 0.1251 - acc: 0.9620
512/753 [===================>..........] - ETA: 3s - loss: 0.1259 - acc: 0.9618
544/753 [====================>.........] - ETA: 3s - loss: 0.1270 - acc: 0.9612
576/753 [=====================>........] - ETA: 2s - loss: 0.1286 - acc: 0.9604
608/753 [=======================>......] - ETA: 2s - loss: 0.1287 - acc: 0.9605
640/753 [========================>.....] - ETA: 1s - loss: 0.1306 - acc: 0.9598
672/753 [=========================>....] - ETA: 1s - loss: 0.1366 - acc: 0.9577
704/753 [===========================>..] - ETA: 0s - loss: 0.1370 - acc: 0.9577
736/753 [============================>.] - ETA: 0s - loss: 0.1376 - acc: 0.9572
753/753 [==============================] - 13s 17ms/step - loss: 0.1366 - acc: 0.9576 - val_loss: 0.2028 - val_acc: 0.9414
Epoch 9/70

 32/753 [>.............................] - ETA: 11s - loss: 0.1206 - acc: 0.9652
 64/753 [=>............................] - ETA: 11s - loss: 0.1231 - acc: 0.9618
 96/753 [==>...........................] - ETA: 10s - loss: 0.1288 - acc: 0.9597
128/753 [====>.........................] - ETA: 10s - loss: 0.1290 - acc: 0.9564
160/753 [=====>........................] - ETA: 9s - loss: 0.1357 - acc: 0.9546 
192/753 [======>.......................] - ETA: 9s - loss: 0.1332 - acc: 0.9562
224/753 [=======>......................] - ETA: 8s - loss: 0.1342 - acc: 0.9566
256/753 [=========>....................] - ETA: 8s - loss: 0.1266 - acc: 0.9589
288/753 [==========>...................] - ETA: 7s - loss: 0.1255 - acc: 0.9597
320/753 [===========>..................] - ETA: 7s - loss: 0.1269 - acc: 0.9599
352/753 [=============>................] - ETA: 6s - loss: 0.1244 - acc: 0.9614
384/753 [==============>...............] - ETA: 5s - loss: 0.1270 - acc: 0.9611
416/753 [===============>..............] - ETA: 5s - loss: 0.1243 - acc: 0.9618
448/753 [================>.............] - ETA: 4s - loss: 0.1260 - acc: 0.9608
480/753 [==================>...........] - ETA: 4s - loss: 0.1255 - acc: 0.9608
512/753 [===================>..........] - ETA: 3s - loss: 0.1228 - acc: 0.9620
544/753 [====================>.........] - ETA: 3s - loss: 0.1272 - acc: 0.9606
576/753 [=====================>........] - ETA: 2s - loss: 0.1278 - acc: 0.9606
608/753 [=======================>......] - ETA: 2s - loss: 0.1263 - acc: 0.9612
640/753 [========================>.....] - ETA: 1s - loss: 0.1246 - acc: 0.9618
672/753 [=========================>....] - ETA: 1s - loss: 0.1254 - acc: 0.9616
704/753 [===========================>..] - ETA: 0s - loss: 0.1256 - acc: 0.9617
736/753 [============================>.] - ETA: 0s - loss: 0.1243 - acc: 0.9622
753/753 [==============================] - 13s 17ms/step - loss: 0.1243 - acc: 0.9622 - val_loss: 0.2095 - val_acc: 0.9361
Epoch 10/70

 32/753 [>.............................] - ETA: 11s - loss: 0.0956 - acc: 0.9585
 64/753 [=>............................] - ETA: 11s - loss: 0.1137 - acc: 0.9574
 96/753 [==>...........................] - ETA: 10s - loss: 0.1255 - acc: 0.9522
128/753 [====>.........................] - ETA: 10s - loss: 0.1293 - acc: 0.9506
160/753 [=====>........................] - ETA: 9s - loss: 0.1249 - acc: 0.9545 
192/753 [======>.......................] - ETA: 9s - loss: 0.1272 - acc: 0.9541
224/753 [=======>......................] - ETA: 8s - loss: 0.1213 - acc: 0.9561
256/753 [=========>....................] - ETA: 8s - loss: 0.1219 - acc: 0.9570
288/753 [==========>...................] - ETA: 7s - loss: 0.1215 - acc: 0.9573
320/753 [===========>..................] - ETA: 7s - loss: 0.1225 - acc: 0.9576
352/753 [=============>................] - ETA: 6s - loss: 0.1199 - acc: 0.9590
384/753 [==============>...............] - ETA: 6s - loss: 0.1187 - acc: 0.9601
416/753 [===============>..............] - ETA: 5s - loss: 0.1186 - acc: 0.9607
448/753 [================>.............] - ETA: 4s - loss: 0.1202 - acc: 0.9602
480/753 [==================>...........] - ETA: 4s - loss: 0.1186 - acc: 0.9611
512/753 [===================>..........] - ETA: 3s - loss: 0.1207 - acc: 0.9605
544/753 [====================>.........] - ETA: 3s - loss: 0.1215 - acc: 0.9605
576/753 [=====================>........] - ETA: 2s - loss: 0.1204 - acc: 0.9606
608/753 [=======================>......] - ETA: 2s - loss: 0.1180 - acc: 0.9612
640/753 [========================>.....] - ETA: 1s - loss: 0.1170 - acc: 0.9616
672/753 [=========================>....] - ETA: 1s - loss: 0.1163 - acc: 0.9618
704/753 [===========================>..] - ETA: 0s - loss: 0.1157 - acc: 0.9618
736/753 [============================>.] - ETA: 0s - loss: 0.1159 - acc: 0.9616
753/753 [==============================] - 13s 17ms/step - loss: 0.1149 - acc: 0.9620 - val_loss: 0.1974 - val_acc: 0.9447
Epoch 11/70

 32/753 [>.............................] - ETA: 11s - loss: 0.1198 - acc: 0.9632
 64/753 [=>............................] - ETA: 11s - loss: 0.0959 - acc: 0.9738
 96/753 [==>...........................] - ETA: 10s - loss: 0.0970 - acc: 0.9697
128/753 [====>.........................] - ETA: 10s - loss: 0.0969 - acc: 0.9690
160/753 [=====>........................] - ETA: 9s - loss: 0.0952 - acc: 0.9693 
192/753 [======>.......................] - ETA: 9s - loss: 0.0943 - acc: 0.9710
224/753 [=======>......................] - ETA: 8s - loss: 0.0929 - acc: 0.9712
256/753 [=========>....................] - ETA: 8s - loss: 0.0942 - acc: 0.9706
288/753 [==========>...................] - ETA: 7s - loss: 0.0994 - acc: 0.9690
320/753 [===========>..................] - ETA: 7s - loss: 0.1008 - acc: 0.9680
352/753 [=============>................] - ETA: 6s - loss: 0.1024 - acc: 0.9675
384/753 [==============>...............] - ETA: 6s - loss: 0.1036 - acc: 0.9672
416/753 [===============>..............] - ETA: 5s - loss: 0.1048 - acc: 0.9668
448/753 [================>.............] - ETA: 4s - loss: 0.1058 - acc: 0.9662
480/753 [==================>...........] - ETA: 4s - loss: 0.1052 - acc: 0.9665
512/753 [===================>..........] - ETA: 3s - loss: 0.1033 - acc: 0.9672
544/753 [====================>.........] - ETA: 3s - loss: 0.1027 - acc: 0.9673
576/753 [=====================>........] - ETA: 2s - loss: 0.1015 - acc: 0.9676
608/753 [=======================>......] - ETA: 2s - loss: 0.1019 - acc: 0.9676
640/753 [========================>.....] - ETA: 1s - loss: 0.1019 - acc: 0.9677
672/753 [=========================>....] - ETA: 1s - loss: 0.1012 - acc: 0.9677
704/753 [===========================>..] - ETA: 0s - loss: 0.1010 - acc: 0.9678
736/753 [============================>.] - ETA: 0s - loss: 0.1012 - acc: 0.9678
753/753 [==============================] - 13s 17ms/step - loss: 0.1023 - acc: 0.9676 - val_loss: 0.1925 - val_acc: 0.9429
Epoch 12/70

 32/753 [>.............................] - ETA: 11s - loss: 0.1104 - acc: 0.9656
 64/753 [=>............................] - ETA: 11s - loss: 0.0989 - acc: 0.9685
 96/753 [==>...........................] - ETA: 10s - loss: 0.0856 - acc: 0.9722
128/753 [====>.........................] - ETA: 10s - loss: 0.0920 - acc: 0.9721
160/753 [=====>........................] - ETA: 9s - loss: 0.1001 - acc: 0.9710 
192/753 [======>.......................] - ETA: 9s - loss: 0.1021 - acc: 0.9707
224/753 [=======>......................] - ETA: 8s - loss: 0.1019 - acc: 0.9705
256/753 [=========>....................] - ETA: 8s - loss: 0.1007 - acc: 0.9715
288/753 [==========>...................] - ETA: 7s - loss: 0.0989 - acc: 0.9719
320/753 [===========>..................] - ETA: 7s - loss: 0.0979 - acc: 0.9728
352/753 [=============>................] - ETA: 6s - loss: 0.0984 - acc: 0.9732
384/753 [==============>...............] - ETA: 6s - loss: 0.0998 - acc: 0.9720
416/753 [===============>..............] - ETA: 5s - loss: 0.1016 - acc: 0.9702
448/753 [================>.............] - ETA: 4s - loss: 0.1008 - acc: 0.9701
480/753 [==================>...........] - ETA: 4s - loss: 0.0987 - acc: 0.9709
512/753 [===================>..........] - ETA: 3s - loss: 0.0962 - acc: 0.9718
544/753 [====================>.........] - ETA: 3s - loss: 0.0954 - acc: 0.9720
576/753 [=====================>........] - ETA: 2s - loss: 0.0954 - acc: 0.9721
608/753 [=======================>......] - ETA: 2s - loss: 0.0956 - acc: 0.9716
640/753 [========================>.....] - ETA: 1s - loss: 0.0947 - acc: 0.9716
672/753 [=========================>....] - ETA: 1s - loss: 0.0938 - acc: 0.9720
704/753 [===========================>..] - ETA: 0s - loss: 0.0957 - acc: 0.9714
736/753 [============================>.] - ETA: 0s - loss: 0.0956 - acc: 0.9714
753/753 [==============================] - 13s 17ms/step - loss: 0.0951 - acc: 0.9715 - val_loss: 0.1899 - val_acc: 0.9468
Epoch 13/70

 32/753 [>.............................] - ETA: 11s - loss: 0.0895 - acc: 0.9740
 64/753 [=>............................] - ETA: 11s - loss: 0.0865 - acc: 0.9742
 96/753 [==>...........................] - ETA: 10s - loss: 0.0956 - acc: 0.9685
128/753 [====>.........................] - ETA: 10s - loss: 0.1008 - acc: 0.9666
160/753 [=====>........................] - ETA: 9s - loss: 0.0946 - acc: 0.9698 
192/753 [======>.......................] - ETA: 9s - loss: 0.0983 - acc: 0.9688
224/753 [=======>......................] - ETA: 8s - loss: 0.0930 - acc: 0.9714
256/753 [=========>....................] - ETA: 8s - loss: 0.0967 - acc: 0.9701
288/753 [==========>...................] - ETA: 7s - loss: 0.0948 - acc: 0.9711
320/753 [===========>..................] - ETA: 7s - loss: 0.0946 - acc: 0.9716
352/753 [=============>................] - ETA: 6s - loss: 0.0971 - acc: 0.9710
384/753 [==============>...............] - ETA: 6s - loss: 0.0953 - acc: 0.9712
416/753 [===============>..............] - ETA: 5s - loss: 0.0961 - acc: 0.9709
448/753 [================>.............] - ETA: 4s - loss: 0.0924 - acc: 0.9721
480/753 [==================>...........] - ETA: 4s - loss: 0.0922 - acc: 0.9720
512/753 [===================>..........] - ETA: 3s - loss: 0.0924 - acc: 0.9715
544/753 [====================>.........] - ETA: 3s - loss: 0.0907 - acc: 0.9723
576/753 [=====================>........] - ETA: 2s - loss: 0.0915 - acc: 0.9720
608/753 [=======================>......] - ETA: 2s - loss: 0.0923 - acc: 0.9718
640/753 [========================>.....] - ETA: 1s - loss: 0.0912 - acc: 0.9722
672/753 [=========================>....] - ETA: 1s - loss: 0.0917 - acc: 0.9718
704/753 [===========================>..] - ETA: 0s - loss: 0.0920 - acc: 0.9717
736/753 [============================>.] - ETA: 0s - loss: 0.0914 - acc: 0.9717
753/753 [==============================] - 13s 17ms/step - loss: 0.0914 - acc: 0.9717 - val_loss: 0.1922 - val_acc: 0.9464
Epoch 14/70

 32/753 [>.............................] - ETA: 11s - loss: 0.0816 - acc: 0.9771
 64/753 [=>............................] - ETA: 11s - loss: 0.0682 - acc: 0.9829
 96/753 [==>...........................] - ETA: 10s - loss: 0.0727 - acc: 0.9813
128/753 [====>.........................] - ETA: 10s - loss: 0.0754 - acc: 0.9786
160/753 [=====>........................] - ETA: 9s - loss: 0.0839 - acc: 0.9767 
192/753 [======>.......................] - ETA: 9s - loss: 0.0818 - acc: 0.9760
224/753 [=======>......................] - ETA: 8s - loss: 0.0756 - acc: 0.9782
256/753 [=========>....................] - ETA: 8s - loss: 0.0737 - acc: 0.9789
288/753 [==========>...................] - ETA: 7s - loss: 0.0728 - acc: 0.9791
320/753 [===========>..................] - ETA: 7s - loss: 0.0733 - acc: 0.9786
352/753 [=============>................] - ETA: 6s - loss: 0.0729 - acc: 0.9784
384/753 [==============>...............] - ETA: 5s - loss: 0.0790 - acc: 0.9770
416/753 [===============>..............] - ETA: 5s - loss: 0.0792 - acc: 0.9766
448/753 [================>.............] - ETA: 4s - loss: 0.0808 - acc: 0.9759
480/753 [==================>...........] - ETA: 4s - loss: 0.0817 - acc: 0.9751
512/753 [===================>..........] - ETA: 3s - loss: 0.0825 - acc: 0.9746
544/753 [====================>.........] - ETA: 3s - loss: 0.0842 - acc: 0.9743
576/753 [=====================>........] - ETA: 2s - loss: 0.0840 - acc: 0.9742
608/753 [=======================>......] - ETA: 2s - loss: 0.0826 - acc: 0.9748
640/753 [========================>.....] - ETA: 1s - loss: 0.0828 - acc: 0.9744
672/753 [=========================>....] - ETA: 1s - loss: 0.0816 - acc: 0.9750
704/753 [===========================>..] - ETA: 0s - loss: 0.0816 - acc: 0.9751
736/753 [============================>.] - ETA: 0s - loss: 0.0818 - acc: 0.9753
753/753 [==============================] - 13s 17ms/step - loss: 0.0810 - acc: 0.9756 - val_loss: 0.1924 - val_acc: 0.9458
Computing...
Manual evaluation: (didn't understand why I made this)
True 8086
False 985
True percentage 0.891412192702
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.96      0.97      7318
      B-ORG       0.71      0.71      0.71       296
      B-LOC       0.72      0.69      0.71       218
      B-PER       0.88      0.74      0.80       438
      I-PER       0.90      0.61      0.73       214
     B-MISC       0.39      0.12      0.18       141
      I-ORG       0.51      0.70      0.59       151
      I-LOC       0.74      0.71      0.72       141
     I-MISC       0.37      0.09      0.15       154

avg / total       0.92      0.89      0.90      9071

F-1 Score:
0.657886484791
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 837 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100764 unique words.
Found 94 unique chars.
Found 9 unique labels.
760 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 254
OOV word occurences: 352
Padding...
Data padded!
Padding...
Data padded!
Padded until 67 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 67, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 67)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 67, 64)       6448960     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 67, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 67, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 67, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 67, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 67, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,952,066
Trainable params: 6,952,066
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 753 samples, validate on 84 samples
Epoch 1/70

 32/753 [>.............................] - ETA: 1:03 - loss: 2.4774 - acc: 0.0442
 64/753 [=>............................] - ETA: 36s - loss: 1.6824 - acc: 0.4286 
 96/753 [==>...........................] - ETA: 26s - loss: 1.9308 - acc: 0.5580
128/753 [====>.........................] - ETA: 21s - loss: 1.7083 - acc: 0.6119
160/753 [=====>........................] - ETA: 18s - loss: 1.5524 - acc: 0.6441
192/753 [======>.......................] - ETA: 16s - loss: 1.4331 - acc: 0.6701
224/753 [=======>......................] - ETA: 14s - loss: 1.3215 - acc: 0.6932
256/753 [=========>....................] - ETA: 12s - loss: 1.2502 - acc: 0.7049
288/753 [==========>...................] - ETA: 11s - loss: 1.1879 - acc: 0.7147
320/753 [===========>..................] - ETA: 10s - loss: 1.1412 - acc: 0.7224
352/753 [=============>................] - ETA: 9s - loss: 1.1021 - acc: 0.7279 
384/753 [==============>...............] - ETA: 8s - loss: 1.0559 - acc: 0.7377
416/753 [===============>..............] - ETA: 7s - loss: 1.0205 - acc: 0.7436
448/753 [================>.............] - ETA: 6s - loss: 1.0018 - acc: 0.7472
480/753 [==================>...........] - ETA: 5s - loss: 0.9747 - acc: 0.7509
512/753 [===================>..........] - ETA: 5s - loss: 0.9513 - acc: 0.7554
544/753 [====================>.........] - ETA: 4s - loss: 0.9229 - acc: 0.7615
576/753 [=====================>........] - ETA: 3s - loss: 0.8973 - acc: 0.7674
608/753 [=======================>......] - ETA: 2s - loss: 0.8709 - acc: 0.7736
640/753 [========================>.....] - ETA: 2s - loss: 0.8515 - acc: 0.7776
672/753 [=========================>....] - ETA: 1s - loss: 0.8314 - acc: 0.7831
704/753 [===========================>..] - ETA: 0s - loss: 0.8164 - acc: 0.7850
736/753 [============================>.] - ETA: 0s - loss: 0.8058 - acc: 0.7877
753/753 [==============================] - 16s 21ms/step - loss: 0.8001 - acc: 0.7884 - val_loss: 0.3845 - val_acc: 0.8949
Epoch 2/70

 32/753 [>.............................] - ETA: 12s - loss: 0.2758 - acc: 0.9275
 64/753 [=>............................] - ETA: 11s - loss: 0.3506 - acc: 0.8969
 96/753 [==>...........................] - ETA: 10s - loss: 0.3864 - acc: 0.8898
128/753 [====>.........................] - ETA: 10s - loss: 0.4156 - acc: 0.8768
160/753 [=====>........................] - ETA: 9s - loss: 0.3878 - acc: 0.8846 
192/753 [======>.......................] - ETA: 9s - loss: 0.3980 - acc: 0.8812
224/753 [=======>......................] - ETA: 8s - loss: 0.3930 - acc: 0.8802
256/753 [=========>....................] - ETA: 8s - loss: 0.3835 - acc: 0.8839
288/753 [==========>...................] - ETA: 7s - loss: 0.3685 - acc: 0.8887
320/753 [===========>..................] - ETA: 7s - loss: 0.3652 - acc: 0.8901
352/753 [=============>................] - ETA: 6s - loss: 0.3574 - acc: 0.8925
384/753 [==============>...............] - ETA: 6s - loss: 0.3540 - acc: 0.8929
416/753 [===============>..............] - ETA: 5s - loss: 0.3490 - acc: 0.8940
448/753 [================>.............] - ETA: 5s - loss: 0.3652 - acc: 0.8906
480/753 [==================>...........] - ETA: 4s - loss: 0.3655 - acc: 0.8899
512/753 [===================>..........] - ETA: 4s - loss: 0.3710 - acc: 0.8884
544/753 [====================>.........] - ETA: 3s - loss: 0.3680 - acc: 0.8899
576/753 [=====================>........] - ETA: 2s - loss: 0.3621 - acc: 0.8917
608/753 [=======================>......] - ETA: 2s - loss: 0.3594 - acc: 0.8924
640/753 [========================>.....] - ETA: 1s - loss: 0.3581 - acc: 0.8929
672/753 [=========================>....] - ETA: 1s - loss: 0.3553 - acc: 0.8932
704/753 [===========================>..] - ETA: 0s - loss: 0.3519 - acc: 0.8943
736/753 [============================>.] - ETA: 0s - loss: 0.3508 - acc: 0.8947
753/753 [==============================] - 13s 17ms/step - loss: 0.3503 - acc: 0.8948 - val_loss: 0.2639 - val_acc: 0.9100
Epoch 3/70

 32/753 [>.............................] - ETA: 12s - loss: 0.4238 - acc: 0.8718
 64/753 [=>............................] - ETA: 11s - loss: 0.3296 - acc: 0.8995
 96/753 [==>...........................] - ETA: 11s - loss: 0.2871 - acc: 0.9153
128/753 [====>.........................] - ETA: 10s - loss: 0.2717 - acc: 0.9176
160/753 [=====>........................] - ETA: 9s - loss: 0.2897 - acc: 0.9118 
192/753 [======>.......................] - ETA: 9s - loss: 0.2809 - acc: 0.9151
224/753 [=======>......................] - ETA: 8s - loss: 0.2780 - acc: 0.9160
256/753 [=========>....................] - ETA: 8s - loss: 0.2722 - acc: 0.9188
288/753 [==========>...................] - ETA: 7s - loss: 0.2666 - acc: 0.9211
320/753 [===========>..................] - ETA: 7s - loss: 0.2674 - acc: 0.9205
352/753 [=============>................] - ETA: 6s - loss: 0.2642 - acc: 0.9213
384/753 [==============>...............] - ETA: 6s - loss: 0.2742 - acc: 0.9174
416/753 [===============>..............] - ETA: 5s - loss: 0.2757 - acc: 0.9177
448/753 [================>.............] - ETA: 5s - loss: 0.2765 - acc: 0.9176
480/753 [==================>...........] - ETA: 4s - loss: 0.2708 - acc: 0.9190
512/753 [===================>..........] - ETA: 3s - loss: 0.2675 - acc: 0.9196
544/753 [====================>.........] - ETA: 3s - loss: 0.2662 - acc: 0.9198
576/753 [=====================>........] - ETA: 2s - loss: 0.2617 - acc: 0.9212
608/753 [=======================>......] - ETA: 2s - loss: 0.2595 - acc: 0.9222
640/753 [========================>.....] - ETA: 1s - loss: 0.2599 - acc: 0.9219
672/753 [=========================>....] - ETA: 1s - loss: 0.2604 - acc: 0.9211
704/753 [===========================>..] - ETA: 0s - loss: 0.2610 - acc: 0.9208
736/753 [============================>.] - ETA: 0s - loss: 0.2597 - acc: 0.9207
753/753 [==============================] - 13s 17ms/step - loss: 0.2602 - acc: 0.9207 - val_loss: 0.2013 - val_acc: 0.9401
Epoch 4/70

 32/753 [>.............................] - ETA: 11s - loss: 0.2431 - acc: 0.9290
 64/753 [=>............................] - ETA: 11s - loss: 0.2144 - acc: 0.9329
 96/753 [==>...........................] - ETA: 10s - loss: 0.2244 - acc: 0.9289
128/753 [====>.........................] - ETA: 10s - loss: 0.2139 - acc: 0.9350
160/753 [=====>........................] - ETA: 9s - loss: 0.1964 - acc: 0.9395 
192/753 [======>.......................] - ETA: 9s - loss: 0.2070 - acc: 0.9362
224/753 [=======>......................] - ETA: 8s - loss: 0.2130 - acc: 0.9335
256/753 [=========>....................] - ETA: 8s - loss: 0.2237 - acc: 0.9313
288/753 [==========>...................] - ETA: 7s - loss: 0.2352 - acc: 0.9270
320/753 [===========>..................] - ETA: 7s - loss: 0.2419 - acc: 0.9248
352/753 [=============>................] - ETA: 6s - loss: 0.2410 - acc: 0.9252
384/753 [==============>...............] - ETA: 6s - loss: 0.2326 - acc: 0.9287
416/753 [===============>..............] - ETA: 5s - loss: 0.2295 - acc: 0.9298
448/753 [================>.............] - ETA: 5s - loss: 0.2318 - acc: 0.9282
480/753 [==================>...........] - ETA: 4s - loss: 0.2283 - acc: 0.9292
512/753 [===================>..........] - ETA: 3s - loss: 0.2260 - acc: 0.9302
544/753 [====================>.........] - ETA: 3s - loss: 0.2205 - acc: 0.9321
576/753 [=====================>........] - ETA: 2s - loss: 0.2224 - acc: 0.9317
608/753 [=======================>......] - ETA: 2s - loss: 0.2220 - acc: 0.9318
640/753 [========================>.....] - ETA: 1s - loss: 0.2216 - acc: 0.9319
672/753 [=========================>....] - ETA: 1s - loss: 0.2237 - acc: 0.9311
704/753 [===========================>..] - ETA: 0s - loss: 0.2203 - acc: 0.9322
736/753 [============================>.] - ETA: 0s - loss: 0.2182 - acc: 0.9328
753/753 [==============================] - 13s 17ms/step - loss: 0.2187 - acc: 0.9326 - val_loss: 0.1750 - val_acc: 0.9454
Epoch 5/70

 32/753 [>.............................] - ETA: 11s - loss: 0.1318 - acc: 0.9640
 64/753 [=>............................] - ETA: 11s - loss: 0.1926 - acc: 0.9424
 96/753 [==>...........................] - ETA: 10s - loss: 0.2009 - acc: 0.9345
128/753 [====>.........................] - ETA: 10s - loss: 0.2083 - acc: 0.9355
160/753 [=====>........................] - ETA: 9s - loss: 0.2266 - acc: 0.9292 
192/753 [======>.......................] - ETA: 9s - loss: 0.2250 - acc: 0.9274
224/753 [=======>......................] - ETA: 8s - loss: 0.2109 - acc: 0.9326
256/753 [=========>....................] - ETA: 8s - loss: 0.2084 - acc: 0.9320
288/753 [==========>...................] - ETA: 7s - loss: 0.2136 - acc: 0.9309
320/753 [===========>..................] - ETA: 7s - loss: 0.2112 - acc: 0.9324
352/753 [=============>................] - ETA: 6s - loss: 0.2095 - acc: 0.9332
384/753 [==============>...............] - ETA: 6s - loss: 0.2128 - acc: 0.9309
416/753 [===============>..............] - ETA: 5s - loss: 0.2073 - acc: 0.9330
448/753 [================>.............] - ETA: 4s - loss: 0.2040 - acc: 0.9350
480/753 [==================>...........] - ETA: 4s - loss: 0.2053 - acc: 0.9346
512/753 [===================>..........] - ETA: 3s - loss: 0.2080 - acc: 0.9339
544/753 [====================>.........] - ETA: 3s - loss: 0.2059 - acc: 0.9344
576/753 [=====================>........] - ETA: 2s - loss: 0.2011 - acc: 0.9363
608/753 [=======================>......] - ETA: 2s - loss: 0.1979 - acc: 0.9377
640/753 [========================>.....] - ETA: 1s - loss: 0.1954 - acc: 0.9384
672/753 [=========================>....] - ETA: 1s - loss: 0.1929 - acc: 0.9392
704/753 [===========================>..] - ETA: 0s - loss: 0.1920 - acc: 0.9392
736/753 [============================>.] - ETA: 0s - loss: 0.1933 - acc: 0.9387
753/753 [==============================] - 13s 17ms/step - loss: 0.1923 - acc: 0.9389 - val_loss: 0.1501 - val_acc: 0.9413
Epoch 6/70

 32/753 [>.............................] - ETA: 11s - loss: 0.1270 - acc: 0.9608
 64/753 [=>............................] - ETA: 11s - loss: 0.1621 - acc: 0.9487
 96/753 [==>...........................] - ETA: 10s - loss: 0.1450 - acc: 0.9538
128/753 [====>.........................] - ETA: 10s - loss: 0.1593 - acc: 0.9473
160/753 [=====>........................] - ETA: 9s - loss: 0.1708 - acc: 0.9438 
192/753 [======>.......................] - ETA: 9s - loss: 0.1684 - acc: 0.9465
224/753 [=======>......................] - ETA: 8s - loss: 0.1705 - acc: 0.9449
256/753 [=========>....................] - ETA: 8s - loss: 0.1668 - acc: 0.9468
288/753 [==========>...................] - ETA: 7s - loss: 0.1657 - acc: 0.9473
320/753 [===========>..................] - ETA: 7s - loss: 0.1652 - acc: 0.9482
352/753 [=============>................] - ETA: 6s - loss: 0.1697 - acc: 0.9457
384/753 [==============>...............] - ETA: 6s - loss: 0.1653 - acc: 0.9472
416/753 [===============>..............] - ETA: 5s - loss: 0.1644 - acc: 0.9478
448/753 [================>.............] - ETA: 4s - loss: 0.1611 - acc: 0.9492
480/753 [==================>...........] - ETA: 4s - loss: 0.1626 - acc: 0.9483
512/753 [===================>..........] - ETA: 3s - loss: 0.1611 - acc: 0.9483
544/753 [====================>.........] - ETA: 3s - loss: 0.1614 - acc: 0.9480
576/753 [=====================>........] - ETA: 2s - loss: 0.1667 - acc: 0.9464
608/753 [=======================>......] - ETA: 2s - loss: 0.1681 - acc: 0.9460
640/753 [========================>.....] - ETA: 1s - loss: 0.1685 - acc: 0.9454
672/753 [=========================>....] - ETA: 1s - loss: 0.1670 - acc: 0.9461
704/753 [===========================>..] - ETA: 0s - loss: 0.1664 - acc: 0.9465
736/753 [============================>.] - ETA: 0s - loss: 0.1669 - acc: 0.9463
753/753 [==============================] - 13s 17ms/step - loss: 0.1654 - acc: 0.9468 - val_loss: 0.1451 - val_acc: 0.9512
Epoch 7/70

 32/753 [>.............................] - ETA: 12s - loss: 0.1837 - acc: 0.9373
 64/753 [=>............................] - ETA: 11s - loss: 0.1796 - acc: 0.9386
 96/753 [==>...........................] - ETA: 10s - loss: 0.1696 - acc: 0.9446
128/753 [====>.........................] - ETA: 10s - loss: 0.1770 - acc: 0.9418
160/753 [=====>........................] - ETA: 9s - loss: 0.1729 - acc: 0.9410 
192/753 [======>.......................] - ETA: 9s - loss: 0.1695 - acc: 0.9426
224/753 [=======>......................] - ETA: 8s - loss: 0.1674 - acc: 0.9444
256/753 [=========>....................] - ETA: 8s - loss: 0.1627 - acc: 0.9474
288/753 [==========>...................] - ETA: 7s - loss: 0.1579 - acc: 0.9498
320/753 [===========>..................] - ETA: 7s - loss: 0.1619 - acc: 0.9483
352/753 [=============>................] - ETA: 6s - loss: 0.1614 - acc: 0.9486
384/753 [==============>...............] - ETA: 6s - loss: 0.1626 - acc: 0.9484
416/753 [===============>..............] - ETA: 5s - loss: 0.1636 - acc: 0.9479
448/753 [================>.............] - ETA: 4s - loss: 0.1612 - acc: 0.9488
480/753 [==================>...........] - ETA: 4s - loss: 0.1638 - acc: 0.9476
512/753 [===================>..........] - ETA: 3s - loss: 0.1605 - acc: 0.9484
544/753 [====================>.........] - ETA: 3s - loss: 0.1591 - acc: 0.9496
576/753 [=====================>........] - ETA: 2s - loss: 0.1594 - acc: 0.9495
608/753 [=======================>......] - ETA: 2s - loss: 0.1576 - acc: 0.9500
640/753 [========================>.....] - ETA: 1s - loss: 0.1559 - acc: 0.9506
672/753 [=========================>....] - ETA: 1s - loss: 0.1571 - acc: 0.9505
704/753 [===========================>..] - ETA: 0s - loss: 0.1575 - acc: 0.9502
736/753 [============================>.] - ETA: 0s - loss: 0.1566 - acc: 0.9502
753/753 [==============================] - 13s 17ms/step - loss: 0.1548 - acc: 0.9508 - val_loss: 0.1372 - val_acc: 0.9512
Epoch 8/70

 32/753 [>.............................] - ETA: 11s - loss: 0.1691 - acc: 0.9531
 64/753 [=>............................] - ETA: 11s - loss: 0.1786 - acc: 0.9471
 96/753 [==>...........................] - ETA: 10s - loss: 0.1750 - acc: 0.9491
128/753 [====>.........................] - ETA: 10s - loss: 0.1594 - acc: 0.9541
160/753 [=====>........................] - ETA: 9s - loss: 0.1634 - acc: 0.9498 
192/753 [======>.......................] - ETA: 9s - loss: 0.1603 - acc: 0.9513
224/753 [=======>......................] - ETA: 8s - loss: 0.1550 - acc: 0.9521
256/753 [=========>....................] - ETA: 8s - loss: 0.1538 - acc: 0.9523
288/753 [==========>...................] - ETA: 7s - loss: 0.1528 - acc: 0.9521
320/753 [===========>..................] - ETA: 7s - loss: 0.1514 - acc: 0.9521
352/753 [=============>................] - ETA: 6s - loss: 0.1466 - acc: 0.9541
384/753 [==============>...............] - ETA: 6s - loss: 0.1511 - acc: 0.9523
416/753 [===============>..............] - ETA: 5s - loss: 0.1454 - acc: 0.9540
448/753 [================>.............] - ETA: 5s - loss: 0.1468 - acc: 0.9538
480/753 [==================>...........] - ETA: 4s - loss: 0.1444 - acc: 0.9544
512/753 [===================>..........] - ETA: 3s - loss: 0.1413 - acc: 0.9553
544/753 [====================>.........] - ETA: 3s - loss: 0.1412 - acc: 0.9552
576/753 [=====================>........] - ETA: 2s - loss: 0.1407 - acc: 0.9557
608/753 [=======================>......] - ETA: 2s - loss: 0.1385 - acc: 0.9564
640/753 [========================>.....] - ETA: 1s - loss: 0.1396 - acc: 0.9562
672/753 [=========================>....] - ETA: 1s - loss: 0.1392 - acc: 0.9565
704/753 [===========================>..] - ETA: 0s - loss: 0.1392 - acc: 0.9568
736/753 [============================>.] - ETA: 0s - loss: 0.1371 - acc: 0.9576
753/753 [==============================] - 13s 17ms/step - loss: 0.1376 - acc: 0.9575 - val_loss: 0.1345 - val_acc: 0.9506
Epoch 9/70

 32/753 [>.............................] - ETA: 11s - loss: 0.1186 - acc: 0.9747
 64/753 [=>............................] - ETA: 11s - loss: 0.1298 - acc: 0.9642
 96/753 [==>...........................] - ETA: 10s - loss: 0.1276 - acc: 0.9631
128/753 [====>.........................] - ETA: 10s - loss: 0.1237 - acc: 0.9626
160/753 [=====>........................] - ETA: 9s - loss: 0.1159 - acc: 0.9641 
192/753 [======>.......................] - ETA: 9s - loss: 0.1164 - acc: 0.9630
224/753 [=======>......................] - ETA: 8s - loss: 0.1121 - acc: 0.9642
256/753 [=========>....................] - ETA: 8s - loss: 0.1080 - acc: 0.9650
288/753 [==========>...................] - ETA: 7s - loss: 0.1053 - acc: 0.9665
320/753 [===========>..................] - ETA: 7s - loss: 0.1127 - acc: 0.9624
352/753 [=============>................] - ETA: 6s - loss: 0.1204 - acc: 0.9594
384/753 [==============>...............] - ETA: 6s - loss: 0.1210 - acc: 0.9594
416/753 [===============>..............] - ETA: 5s - loss: 0.1221 - acc: 0.9594
448/753 [================>.............] - ETA: 4s - loss: 0.1220 - acc: 0.9596
480/753 [==================>...........] - ETA: 4s - loss: 0.1246 - acc: 0.9582
512/753 [===================>..........] - ETA: 3s - loss: 0.1210 - acc: 0.9599
544/753 [====================>.........] - ETA: 3s - loss: 0.1212 - acc: 0.9597
576/753 [=====================>........] - ETA: 2s - loss: 0.1213 - acc: 0.9600
608/753 [=======================>......] - ETA: 2s - loss: 0.1256 - acc: 0.9589
640/753 [========================>.....] - ETA: 1s - loss: 0.1257 - acc: 0.9593
672/753 [=========================>....] - ETA: 1s - loss: 0.1249 - acc: 0.9596
704/753 [===========================>..] - ETA: 0s - loss: 0.1249 - acc: 0.9600
736/753 [============================>.] - ETA: 0s - loss: 0.1247 - acc: 0.9602
753/753 [==============================] - 13s 17ms/step - loss: 0.1261 - acc: 0.9600 - val_loss: 0.1320 - val_acc: 0.9547
Epoch 10/70

 32/753 [>.............................] - ETA: 11s - loss: 0.0940 - acc: 0.9794
 64/753 [=>............................] - ETA: 11s - loss: 0.0930 - acc: 0.9730
 96/753 [==>...........................] - ETA: 10s - loss: 0.1016 - acc: 0.9682
128/753 [====>.........................] - ETA: 10s - loss: 0.1100 - acc: 0.9671
160/753 [=====>........................] - ETA: 9s - loss: 0.1072 - acc: 0.9682 
192/753 [======>.......................] - ETA: 9s - loss: 0.1041 - acc: 0.9677
224/753 [=======>......................] - ETA: 8s - loss: 0.1088 - acc: 0.9658
256/753 [=========>....................] - ETA: 8s - loss: 0.1026 - acc: 0.9682
288/753 [==========>...................] - ETA: 7s - loss: 0.1081 - acc: 0.9673
320/753 [===========>..................] - ETA: 7s - loss: 0.1057 - acc: 0.9684
352/753 [=============>................] - ETA: 6s - loss: 0.1066 - acc: 0.9685
384/753 [==============>...............] - ETA: 6s - loss: 0.1088 - acc: 0.9678
416/753 [===============>..............] - ETA: 5s - loss: 0.1097 - acc: 0.9675
448/753 [================>.............] - ETA: 4s - loss: 0.1130 - acc: 0.9660
480/753 [==================>...........] - ETA: 4s - loss: 0.1141 - acc: 0.9658
512/753 [===================>..........] - ETA: 3s - loss: 0.1163 - acc: 0.9650
544/753 [====================>.........] - ETA: 3s - loss: 0.1163 - acc: 0.9645
576/753 [=====================>........] - ETA: 2s - loss: 0.1143 - acc: 0.9650
608/753 [=======================>......] - ETA: 2s - loss: 0.1148 - acc: 0.9649
640/753 [========================>.....] - ETA: 1s - loss: 0.1146 - acc: 0.9650
672/753 [=========================>....] - ETA: 1s - loss: 0.1135 - acc: 0.9652
704/753 [===========================>..] - ETA: 0s - loss: 0.1161 - acc: 0.9644
736/753 [============================>.] - ETA: 0s - loss: 0.1163 - acc: 0.9646
753/753 [==============================] - 13s 17ms/step - loss: 0.1164 - acc: 0.9646 - val_loss: 0.1253 - val_acc: 0.9570
Epoch 11/70

 32/753 [>.............................] - ETA: 11s - loss: 0.1040 - acc: 0.9722
 64/753 [=>............................] - ETA: 11s - loss: 0.0985 - acc: 0.9736
 96/753 [==>...........................] - ETA: 10s - loss: 0.1057 - acc: 0.9697
128/753 [====>.........................] - ETA: 10s - loss: 0.1162 - acc: 0.9656
160/753 [=====>........................] - ETA: 9s - loss: 0.1061 - acc: 0.9700 
192/753 [======>.......................] - ETA: 9s - loss: 0.1100 - acc: 0.9675
224/753 [=======>......................] - ETA: 8s - loss: 0.1200 - acc: 0.9655
256/753 [=========>....................] - ETA: 8s - loss: 0.1174 - acc: 0.9657
288/753 [==========>...................] - ETA: 7s - loss: 0.1157 - acc: 0.9657
320/753 [===========>..................] - ETA: 7s - loss: 0.1187 - acc: 0.9650
352/753 [=============>................] - ETA: 6s - loss: 0.1188 - acc: 0.9650
384/753 [==============>...............] - ETA: 6s - loss: 0.1164 - acc: 0.9657
416/753 [===============>..............] - ETA: 5s - loss: 0.1133 - acc: 0.9665
448/753 [================>.............] - ETA: 4s - loss: 0.1139 - acc: 0.9664
480/753 [==================>...........] - ETA: 4s - loss: 0.1138 - acc: 0.9668
512/753 [===================>..........] - ETA: 3s - loss: 0.1123 - acc: 0.9672
544/753 [====================>.........] - ETA: 3s - loss: 0.1126 - acc: 0.9669
576/753 [=====================>........] - ETA: 2s - loss: 0.1146 - acc: 0.9661
608/753 [=======================>......] - ETA: 2s - loss: 0.1143 - acc: 0.9661
640/753 [========================>.....] - ETA: 1s - loss: 0.1134 - acc: 0.9661
672/753 [=========================>....] - ETA: 1s - loss: 0.1108 - acc: 0.9668
704/753 [===========================>..] - ETA: 0s - loss: 0.1102 - acc: 0.9669
736/753 [============================>.] - ETA: 0s - loss: 0.1100 - acc: 0.9668
753/753 [==============================] - 13s 17ms/step - loss: 0.1092 - acc: 0.9667 - val_loss: 0.1170 - val_acc: 0.9616
Epoch 12/70

 32/753 [>.............................] - ETA: 11s - loss: 0.1121 - acc: 0.9622
 64/753 [=>............................] - ETA: 11s - loss: 0.1051 - acc: 0.9641
 96/753 [==>...........................] - ETA: 10s - loss: 0.1069 - acc: 0.9649
128/753 [====>.........................] - ETA: 10s - loss: 0.1122 - acc: 0.9643
160/753 [=====>........................] - ETA: 9s - loss: 0.1059 - acc: 0.9668 
192/753 [======>.......................] - ETA: 9s - loss: 0.1008 - acc: 0.9674
224/753 [=======>......................] - ETA: 8s - loss: 0.0977 - acc: 0.9686
256/753 [=========>....................] - ETA: 8s - loss: 0.0944 - acc: 0.9702
288/753 [==========>...................] - ETA: 7s - loss: 0.0931 - acc: 0.9705
320/753 [===========>..................] - ETA: 7s - loss: 0.0950 - acc: 0.9697
352/753 [=============>................] - ETA: 6s - loss: 0.0982 - acc: 0.9686
384/753 [==============>...............] - ETA: 6s - loss: 0.0987 - acc: 0.9681
416/753 [===============>..............] - ETA: 5s - loss: 0.0980 - acc: 0.9678
448/753 [================>.............] - ETA: 4s - loss: 0.1008 - acc: 0.9669
480/753 [==================>...........] - ETA: 4s - loss: 0.1008 - acc: 0.9675
512/753 [===================>..........] - ETA: 3s - loss: 0.0998 - acc: 0.9677
544/753 [====================>.........] - ETA: 3s - loss: 0.1017 - acc: 0.9669
576/753 [=====================>........] - ETA: 2s - loss: 0.1017 - acc: 0.9668
608/753 [=======================>......] - ETA: 2s - loss: 0.1015 - acc: 0.9667
640/753 [========================>.....] - ETA: 1s - loss: 0.1024 - acc: 0.9665
672/753 [=========================>....] - ETA: 1s - loss: 0.1042 - acc: 0.9659
704/753 [===========================>..] - ETA: 0s - loss: 0.1035 - acc: 0.9664
736/753 [============================>.] - ETA: 0s - loss: 0.1021 - acc: 0.9672
753/753 [==============================] - 13s 17ms/step - loss: 0.1024 - acc: 0.9672 - val_loss: 0.1256 - val_acc: 0.9576
Epoch 13/70

 32/753 [>.............................] - ETA: 11s - loss: 0.1476 - acc: 0.9468
 64/753 [=>............................] - ETA: 11s - loss: 0.1171 - acc: 0.9602
 96/753 [==>...........................] - ETA: 10s - loss: 0.1103 - acc: 0.9634
128/753 [====>.........................] - ETA: 10s - loss: 0.0988 - acc: 0.9676
160/753 [=====>........................] - ETA: 9s - loss: 0.0891 - acc: 0.9711 
192/753 [======>.......................] - ETA: 9s - loss: 0.0881 - acc: 0.9714
224/753 [=======>......................] - ETA: 8s - loss: 0.0898 - acc: 0.9712
256/753 [=========>....................] - ETA: 8s - loss: 0.0873 - acc: 0.9722
288/753 [==========>...................] - ETA: 7s - loss: 0.0897 - acc: 0.9724
320/753 [===========>..................] - ETA: 7s - loss: 0.0886 - acc: 0.9727
352/753 [=============>................] - ETA: 6s - loss: 0.0907 - acc: 0.9717
384/753 [==============>...............] - ETA: 6s - loss: 0.0900 - acc: 0.9720
416/753 [===============>..............] - ETA: 5s - loss: 0.0877 - acc: 0.9731
448/753 [================>.............] - ETA: 4s - loss: 0.0881 - acc: 0.9728
480/753 [==================>...........] - ETA: 4s - loss: 0.0881 - acc: 0.9727
512/753 [===================>..........] - ETA: 3s - loss: 0.0961 - acc: 0.9701
544/753 [====================>.........] - ETA: 3s - loss: 0.0976 - acc: 0.9695
576/753 [=====================>........] - ETA: 2s - loss: 0.0964 - acc: 0.9701
608/753 [=======================>......] - ETA: 2s - loss: 0.0948 - acc: 0.9703
640/753 [========================>.....] - ETA: 1s - loss: 0.0948 - acc: 0.9706
672/753 [=========================>....] - ETA: 1s - loss: 0.0949 - acc: 0.9705
704/753 [===========================>..] - ETA: 0s - loss: 0.0956 - acc: 0.9704
736/753 [============================>.] - ETA: 0s - loss: 0.0959 - acc: 0.9702
753/753 [==============================] - 13s 17ms/step - loss: 0.0950 - acc: 0.9706 - val_loss: 0.1191 - val_acc: 0.9599
Computing...
Manual evaluation: (didn't understand why I made this)
True 8166
False 905
True percentage 0.900231507
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.90      0.82      0.86       438
      B-ORG       0.71      0.72      0.71       296
     I-MISC       0.39      0.31      0.35       154
      B-LOC       0.70      0.78      0.74       218
      I-LOC       0.78      0.78      0.78       141
      I-ORG       0.54      0.61      0.57       151
      I-PER       0.91      0.61      0.73       214
     B-MISC       0.46      0.16      0.23       141

avg / total       0.93      0.90      0.91      9071

F-1 Score:
0.688327316486
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 837 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100794 unique words.
Found 94 unique chars.
Found 9 unique labels.
790 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 258
OOV word occurences: 395
Padding...
Data padded!
Padding...
Data padded!
Padded until 67 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 67, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 67)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 67, 64)       6450880     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 67, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 67, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 67, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 67, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 67, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,953,986
Trainable params: 6,953,986
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 753 samples, validate on 84 samples
Epoch 1/70

 32/753 [>.............................] - ETA: 1:02 - loss: 2.4129 - acc: 0.0357
 64/753 [=>............................] - ETA: 36s - loss: 1.6684 - acc: 0.4197 
 96/753 [==>...........................] - ETA: 26s - loss: 2.0997 - acc: 0.5423
128/753 [====>.........................] - ETA: 21s - loss: 1.8114 - acc: 0.6080
160/753 [=====>........................] - ETA: 18s - loss: 1.6099 - acc: 0.6497
192/753 [======>.......................] - ETA: 15s - loss: 1.4911 - acc: 0.6683
224/753 [=======>......................] - ETA: 14s - loss: 1.3866 - acc: 0.6872
256/753 [=========>....................] - ETA: 12s - loss: 1.3129 - acc: 0.6978
288/753 [==========>...................] - ETA: 11s - loss: 1.2516 - acc: 0.7077
320/753 [===========>..................] - ETA: 10s - loss: 1.1981 - acc: 0.7162
352/753 [=============>................] - ETA: 9s - loss: 1.1362 - acc: 0.7288 
384/753 [==============>...............] - ETA: 8s - loss: 1.0921 - acc: 0.7349
416/753 [===============>..............] - ETA: 7s - loss: 1.0474 - acc: 0.7431
448/753 [================>.............] - ETA: 6s - loss: 1.0152 - acc: 0.7478
480/753 [==================>...........] - ETA: 5s - loss: 0.9826 - acc: 0.7547
512/753 [===================>..........] - ETA: 5s - loss: 0.9541 - acc: 0.7598
544/753 [====================>.........] - ETA: 4s - loss: 0.9320 - acc: 0.7632
576/753 [=====================>........] - ETA: 3s - loss: 0.9076 - acc: 0.7673
608/753 [=======================>......] - ETA: 2s - loss: 0.8879 - acc: 0.7725
640/753 [========================>.....] - ETA: 2s - loss: 0.8687 - acc: 0.7764
672/753 [=========================>....] - ETA: 1s - loss: 0.8533 - acc: 0.7801
704/753 [===========================>..] - ETA: 0s - loss: 0.8360 - acc: 0.7834
736/753 [============================>.] - ETA: 0s - loss: 0.8194 - acc: 0.7874
753/753 [==============================] - 16s 21ms/step - loss: 0.8096 - acc: 0.7894 - val_loss: 0.4122 - val_acc: 0.8728
Epoch 2/70

 32/753 [>.............................] - ETA: 11s - loss: 0.3802 - acc: 0.8886
 64/753 [=>............................] - ETA: 11s - loss: 0.3823 - acc: 0.8842
 96/753 [==>...........................] - ETA: 11s - loss: 0.3746 - acc: 0.8861
128/753 [====>.........................] - ETA: 10s - loss: 0.3885 - acc: 0.8808
160/753 [=====>........................] - ETA: 10s - loss: 0.3931 - acc: 0.8799
192/753 [======>.......................] - ETA: 9s - loss: 0.3953 - acc: 0.8818 
224/753 [=======>......................] - ETA: 8s - loss: 0.4090 - acc: 0.8761
256/753 [=========>....................] - ETA: 8s - loss: 0.4210 - acc: 0.8761
288/753 [==========>...................] - ETA: 7s - loss: 0.4200 - acc: 0.8740
320/753 [===========>..................] - ETA: 7s - loss: 0.4147 - acc: 0.8752
352/753 [=============>................] - ETA: 6s - loss: 0.4070 - acc: 0.8789
384/753 [==============>...............] - ETA: 6s - loss: 0.3972 - acc: 0.8825
416/753 [===============>..............] - ETA: 5s - loss: 0.3969 - acc: 0.8825
448/753 [================>.............] - ETA: 5s - loss: 0.3945 - acc: 0.8820
480/753 [==================>...........] - ETA: 4s - loss: 0.3957 - acc: 0.8819
512/753 [===================>..........] - ETA: 4s - loss: 0.3885 - acc: 0.8842
544/753 [====================>.........] - ETA: 3s - loss: 0.3870 - acc: 0.8834
576/753 [=====================>........] - ETA: 2s - loss: 0.3785 - acc: 0.8863
608/753 [=======================>......] - ETA: 2s - loss: 0.3766 - acc: 0.8861
640/753 [========================>.....] - ETA: 1s - loss: 0.3738 - acc: 0.8870
672/753 [=========================>....] - ETA: 1s - loss: 0.3688 - acc: 0.8883
704/753 [===========================>..] - ETA: 0s - loss: 0.3658 - acc: 0.8888
736/753 [============================>.] - ETA: 0s - loss: 0.3628 - acc: 0.8896
753/753 [==============================] - 13s 17ms/step - loss: 0.3643 - acc: 0.8889 - val_loss: 0.3973 - val_acc: 0.8825
Epoch 3/70

 32/753 [>.............................] - ETA: 11s - loss: 0.4058 - acc: 0.8848
 64/753 [=>............................] - ETA: 11s - loss: 0.3872 - acc: 0.8860
 96/753 [==>...........................] - ETA: 10s - loss: 0.3440 - acc: 0.9009
128/753 [====>.........................] - ETA: 10s - loss: 0.3266 - acc: 0.9014
160/753 [=====>........................] - ETA: 9s - loss: 0.3058 - acc: 0.9096 
192/753 [======>.......................] - ETA: 9s - loss: 0.3209 - acc: 0.9018
224/753 [=======>......................] - ETA: 8s - loss: 0.3081 - acc: 0.9063
256/753 [=========>....................] - ETA: 8s - loss: 0.3067 - acc: 0.9062
288/753 [==========>...................] - ETA: 7s - loss: 0.3043 - acc: 0.9069
320/753 [===========>..................] - ETA: 7s - loss: 0.3034 - acc: 0.9063
352/753 [=============>................] - ETA: 6s - loss: 0.2973 - acc: 0.9085
384/753 [==============>...............] - ETA: 6s - loss: 0.2975 - acc: 0.9089
416/753 [===============>..............] - ETA: 5s - loss: 0.2927 - acc: 0.9097
448/753 [================>.............] - ETA: 4s - loss: 0.2912 - acc: 0.9105
480/753 [==================>...........] - ETA: 4s - loss: 0.2905 - acc: 0.9104
512/753 [===================>..........] - ETA: 3s - loss: 0.2862 - acc: 0.9115
544/753 [====================>.........] - ETA: 3s - loss: 0.2831 - acc: 0.9130
576/753 [=====================>........] - ETA: 2s - loss: 0.2790 - acc: 0.9144
608/753 [=======================>......] - ETA: 2s - loss: 0.2748 - acc: 0.9157
640/753 [========================>.....] - ETA: 1s - loss: 0.2735 - acc: 0.9158
672/753 [=========================>....] - ETA: 1s - loss: 0.2712 - acc: 0.9162
704/753 [===========================>..] - ETA: 0s - loss: 0.2721 - acc: 0.9158
736/753 [============================>.] - ETA: 0s - loss: 0.2726 - acc: 0.9152
753/753 [==============================] - 13s 17ms/step - loss: 0.2749 - acc: 0.9139 - val_loss: 0.2518 - val_acc: 0.9270
Epoch 4/70

 32/753 [>.............................] - ETA: 11s - loss: 0.2177 - acc: 0.9330
 64/753 [=>............................] - ETA: 11s - loss: 0.2285 - acc: 0.9292
 96/753 [==>...........................] - ETA: 10s - loss: 0.2372 - acc: 0.9281
128/753 [====>.........................] - ETA: 10s - loss: 0.2477 - acc: 0.9228
160/753 [=====>........................] - ETA: 9s - loss: 0.2518 - acc: 0.9231 
192/753 [======>.......................] - ETA: 9s - loss: 0.2426 - acc: 0.9269
224/753 [=======>......................] - ETA: 8s - loss: 0.2355 - acc: 0.9285
256/753 [=========>....................] - ETA: 8s - loss: 0.2302 - acc: 0.9304
288/753 [==========>...................] - ETA: 7s - loss: 0.2236 - acc: 0.9326
320/753 [===========>..................] - ETA: 7s - loss: 0.2225 - acc: 0.9327
352/753 [=============>................] - ETA: 6s - loss: 0.2248 - acc: 0.9319
384/753 [==============>...............] - ETA: 6s - loss: 0.2237 - acc: 0.9319
416/753 [===============>..............] - ETA: 5s - loss: 0.2193 - acc: 0.9343
448/753 [================>.............] - ETA: 5s - loss: 0.2216 - acc: 0.9335
480/753 [==================>...........] - ETA: 4s - loss: 0.2210 - acc: 0.9330
512/753 [===================>..........] - ETA: 3s - loss: 0.2208 - acc: 0.9328
544/753 [====================>.........] - ETA: 3s - loss: 0.2207 - acc: 0.9324
576/753 [=====================>........] - ETA: 2s - loss: 0.2209 - acc: 0.9329
608/753 [=======================>......] - ETA: 2s - loss: 0.2196 - acc: 0.9335
640/753 [========================>.....] - ETA: 1s - loss: 0.2197 - acc: 0.9330
672/753 [=========================>....] - ETA: 1s - loss: 0.2202 - acc: 0.9327
704/753 [===========================>..] - ETA: 0s - loss: 0.2189 - acc: 0.9332
736/753 [============================>.] - ETA: 0s - loss: 0.2187 - acc: 0.9331
753/753 [==============================] - 13s 17ms/step - loss: 0.2201 - acc: 0.9328 - val_loss: 0.2439 - val_acc: 0.9228
Epoch 5/70

 32/753 [>.............................] - ETA: 11s - loss: 0.2211 - acc: 0.9242
 64/753 [=>............................] - ETA: 11s - loss: 0.2457 - acc: 0.9164
 96/753 [==>...........................] - ETA: 10s - loss: 0.2091 - acc: 0.9308
128/753 [====>.........................] - ETA: 10s - loss: 0.2106 - acc: 0.9286
160/753 [=====>........................] - ETA: 9s - loss: 0.2019 - acc: 0.9329 
192/753 [======>.......................] - ETA: 9s - loss: 0.2108 - acc: 0.9295
224/753 [=======>......................] - ETA: 8s - loss: 0.2176 - acc: 0.9295
256/753 [=========>....................] - ETA: 8s - loss: 0.2094 - acc: 0.9318
288/753 [==========>...................] - ETA: 7s - loss: 0.2091 - acc: 0.9319
320/753 [===========>..................] - ETA: 7s - loss: 0.2059 - acc: 0.9337
352/753 [=============>................] - ETA: 6s - loss: 0.2008 - acc: 0.9348
384/753 [==============>...............] - ETA: 6s - loss: 0.1993 - acc: 0.9356
416/753 [===============>..............] - ETA: 5s - loss: 0.1974 - acc: 0.9363
448/753 [================>.............] - ETA: 4s - loss: 0.2012 - acc: 0.9341
480/753 [==================>...........] - ETA: 4s - loss: 0.2010 - acc: 0.9352
512/753 [===================>..........] - ETA: 3s - loss: 0.1980 - acc: 0.9367
544/753 [====================>.........] - ETA: 3s - loss: 0.1987 - acc: 0.9364
576/753 [=====================>........] - ETA: 2s - loss: 0.1984 - acc: 0.9364
608/753 [=======================>......] - ETA: 2s - loss: 0.1974 - acc: 0.9369
640/753 [========================>.....] - ETA: 1s - loss: 0.1981 - acc: 0.9364
672/753 [=========================>....] - ETA: 1s - loss: 0.1973 - acc: 0.9370
704/753 [===========================>..] - ETA: 0s - loss: 0.1961 - acc: 0.9378
736/753 [============================>.] - ETA: 0s - loss: 0.1950 - acc: 0.9386
753/753 [==============================] - 13s 17ms/step - loss: 0.1947 - acc: 0.9387 - val_loss: 0.2107 - val_acc: 0.9344
Epoch 6/70

 32/753 [>.............................] - ETA: 11s - loss: 0.1593 - acc: 0.9452
 64/753 [=>............................] - ETA: 11s - loss: 0.1705 - acc: 0.9420
 96/753 [==>...........................] - ETA: 10s - loss: 0.1683 - acc: 0.9470
128/753 [====>.........................] - ETA: 10s - loss: 0.1693 - acc: 0.9475
160/753 [=====>........................] - ETA: 9s - loss: 0.1687 - acc: 0.9470 
192/753 [======>.......................] - ETA: 9s - loss: 0.1760 - acc: 0.9473
224/753 [=======>......................] - ETA: 8s - loss: 0.1711 - acc: 0.9484
256/753 [=========>....................] - ETA: 8s - loss: 0.1753 - acc: 0.9471
288/753 [==========>...................] - ETA: 7s - loss: 0.1721 - acc: 0.9473
320/753 [===========>..................] - ETA: 7s - loss: 0.1728 - acc: 0.9475
352/753 [=============>................] - ETA: 6s - loss: 0.1717 - acc: 0.9476
384/753 [==============>...............] - ETA: 6s - loss: 0.1711 - acc: 0.9471
416/753 [===============>..............] - ETA: 5s - loss: 0.1727 - acc: 0.9468
448/753 [================>.............] - ETA: 4s - loss: 0.1720 - acc: 0.9474
480/753 [==================>...........] - ETA: 4s - loss: 0.1728 - acc: 0.9465
512/753 [===================>..........] - ETA: 3s - loss: 0.1701 - acc: 0.9478
544/753 [====================>.........] - ETA: 3s - loss: 0.1688 - acc: 0.9483
576/753 [=====================>........] - ETA: 2s - loss: 0.1689 - acc: 0.9479
608/753 [=======================>......] - ETA: 2s - loss: 0.1686 - acc: 0.9485
640/753 [========================>.....] - ETA: 1s - loss: 0.1687 - acc: 0.9482
672/753 [=========================>....] - ETA: 1s - loss: 0.1699 - acc: 0.9476
704/753 [===========================>..] - ETA: 0s - loss: 0.1708 - acc: 0.9475
736/753 [============================>.] - ETA: 0s - loss: 0.1702 - acc: 0.9475
753/753 [==============================] - 13s 17ms/step - loss: 0.1698 - acc: 0.9476 - val_loss: 0.1952 - val_acc: 0.9396
Epoch 7/70

 32/753 [>.............................] - ETA: 11s - loss: 0.1480 - acc: 0.9523
 64/753 [=>............................] - ETA: 11s - loss: 0.1364 - acc: 0.9572
 96/753 [==>...........................] - ETA: 10s - loss: 0.1333 - acc: 0.9612
128/753 [====>.........................] - ETA: 10s - loss: 0.1345 - acc: 0.9596
160/753 [=====>........................] - ETA: 9s - loss: 0.1418 - acc: 0.9558 
192/753 [======>.......................] - ETA: 9s - loss: 0.1403 - acc: 0.9571
224/753 [=======>......................] - ETA: 8s - loss: 0.1410 - acc: 0.9568
256/753 [=========>....................] - ETA: 8s - loss: 0.1369 - acc: 0.9581
288/753 [==========>...................] - ETA: 7s - loss: 0.1362 - acc: 0.9588
320/753 [===========>..................] - ETA: 7s - loss: 0.1391 - acc: 0.9588
352/753 [=============>................] - ETA: 6s - loss: 0.1411 - acc: 0.9578
384/753 [==============>...............] - ETA: 6s - loss: 0.1437 - acc: 0.9572
416/753 [===============>..............] - ETA: 5s - loss: 0.1460 - acc: 0.9562
448/753 [================>.............] - ETA: 4s - loss: 0.1473 - acc: 0.9565
480/753 [==================>...........] - ETA: 4s - loss: 0.1466 - acc: 0.9578
512/753 [===================>..........] - ETA: 3s - loss: 0.1477 - acc: 0.9569
544/753 [====================>.........] - ETA: 3s - loss: 0.1467 - acc: 0.9575
576/753 [=====================>........] - ETA: 2s - loss: 0.1495 - acc: 0.9563
608/753 [=======================>......] - ETA: 2s - loss: 0.1478 - acc: 0.9567
640/753 [========================>.....] - ETA: 1s - loss: 0.1484 - acc: 0.9565
672/753 [=========================>....] - ETA: 1s - loss: 0.1497 - acc: 0.9558
704/753 [===========================>..] - ETA: 0s - loss: 0.1484 - acc: 0.9560
736/753 [============================>.] - ETA: 0s - loss: 0.1491 - acc: 0.9556
753/753 [==============================] - 13s 17ms/step - loss: 0.1497 - acc: 0.9555 - val_loss: 0.1897 - val_acc: 0.9450
Epoch 8/70

 32/753 [>.............................] - ETA: 11s - loss: 0.1726 - acc: 0.9571
 64/753 [=>............................] - ETA: 11s - loss: 0.1630 - acc: 0.9540
 96/753 [==>...........................] - ETA: 10s - loss: 0.1601 - acc: 0.9528
128/753 [====>.........................] - ETA: 10s - loss: 0.1515 - acc: 0.9550
160/753 [=====>........................] - ETA: 9s - loss: 0.1465 - acc: 0.9568 
192/753 [======>.......................] - ETA: 9s - loss: 0.1373 - acc: 0.9590
224/753 [=======>......................] - ETA: 8s - loss: 0.1383 - acc: 0.9575
256/753 [=========>....................] - ETA: 8s - loss: 0.1467 - acc: 0.9539
288/753 [==========>...................] - ETA: 7s - loss: 0.1459 - acc: 0.9550
320/753 [===========>..................] - ETA: 7s - loss: 0.1413 - acc: 0.9567
352/753 [=============>................] - ETA: 6s - loss: 0.1410 - acc: 0.9569
384/753 [==============>...............] - ETA: 6s - loss: 0.1418 - acc: 0.9568
416/753 [===============>..............] - ETA: 5s - loss: 0.1400 - acc: 0.9578
448/753 [================>.............] - ETA: 4s - loss: 0.1365 - acc: 0.9591
480/753 [==================>...........] - ETA: 4s - loss: 0.1368 - acc: 0.9594
512/753 [===================>..........] - ETA: 3s - loss: 0.1342 - acc: 0.9603
544/753 [====================>.........] - ETA: 3s - loss: 0.1360 - acc: 0.9590
576/753 [=====================>........] - ETA: 2s - loss: 0.1354 - acc: 0.9591
608/753 [=======================>......] - ETA: 2s - loss: 0.1334 - acc: 0.9604
640/753 [========================>.....] - ETA: 1s - loss: 0.1335 - acc: 0.9603
672/753 [=========================>....] - ETA: 1s - loss: 0.1331 - acc: 0.9606
704/753 [===========================>..] - ETA: 0s - loss: 0.1366 - acc: 0.9588
736/753 [============================>.] - ETA: 0s - loss: 0.1374 - acc: 0.9584
753/753 [==============================] - 13s 17ms/step - loss: 0.1363 - acc: 0.9587 - val_loss: 0.1832 - val_acc: 0.9422
Epoch 9/70

 32/753 [>.............................] - ETA: 12s - loss: 0.1185 - acc: 0.9645
 64/753 [=>............................] - ETA: 11s - loss: 0.1187 - acc: 0.9650
 96/753 [==>...........................] - ETA: 10s - loss: 0.1261 - acc: 0.9584
128/753 [====>.........................] - ETA: 10s - loss: 0.1276 - acc: 0.9592
160/753 [=====>........................] - ETA: 9s - loss: 0.1315 - acc: 0.9584 
192/753 [======>.......................] - ETA: 9s - loss: 0.1308 - acc: 0.9600
224/753 [=======>......................] - ETA: 8s - loss: 0.1320 - acc: 0.9611
256/753 [=========>....................] - ETA: 8s - loss: 0.1369 - acc: 0.9594
288/753 [==========>...................] - ETA: 7s - loss: 0.1345 - acc: 0.9599
320/753 [===========>..................] - ETA: 7s - loss: 0.1333 - acc: 0.9601
352/753 [=============>................] - ETA: 6s - loss: 0.1306 - acc: 0.9608
384/753 [==============>...............] - ETA: 6s - loss: 0.1335 - acc: 0.9595
416/753 [===============>..............] - ETA: 5s - loss: 0.1339 - acc: 0.9595
448/753 [================>.............] - ETA: 5s - loss: 0.1312 - acc: 0.9609
480/753 [==================>...........] - ETA: 4s - loss: 0.1283 - acc: 0.9621
512/753 [===================>..........] - ETA: 3s - loss: 0.1305 - acc: 0.9618
544/753 [====================>.........] - ETA: 3s - loss: 0.1307 - acc: 0.9619
576/753 [=====================>........] - ETA: 2s - loss: 0.1302 - acc: 0.9619
608/753 [=======================>......] - ETA: 2s - loss: 0.1298 - acc: 0.9623
640/753 [========================>.....] - ETA: 1s - loss: 0.1288 - acc: 0.9629
672/753 [=========================>....] - ETA: 1s - loss: 0.1272 - acc: 0.9635
704/753 [===========================>..] - ETA: 0s - loss: 0.1256 - acc: 0.9639
736/753 [============================>.] - ETA: 0s - loss: 0.1273 - acc: 0.9635
753/753 [==============================] - 13s 17ms/step - loss: 0.1278 - acc: 0.9631 - val_loss: 0.1955 - val_acc: 0.9387
Epoch 10/70

 32/753 [>.............................] - ETA: 11s - loss: 0.0717 - acc: 0.9810
 64/753 [=>............................] - ETA: 11s - loss: 0.1001 - acc: 0.9719
 96/753 [==>...........................] - ETA: 10s - loss: 0.0921 - acc: 0.9741
128/753 [====>.........................] - ETA: 10s - loss: 0.0998 - acc: 0.9718
160/753 [=====>........................] - ETA: 9s - loss: 0.1135 - acc: 0.9670 
192/753 [======>.......................] - ETA: 9s - loss: 0.1135 - acc: 0.9661
224/753 [=======>......................] - ETA: 8s - loss: 0.1164 - acc: 0.9655
256/753 [=========>....................] - ETA: 8s - loss: 0.1191 - acc: 0.9640
288/753 [==========>...................] - ETA: 7s - loss: 0.1165 - acc: 0.9652
320/753 [===========>..................] - ETA: 7s - loss: 0.1112 - acc: 0.9668
352/753 [=============>................] - ETA: 6s - loss: 0.1075 - acc: 0.9677
384/753 [==============>...............] - ETA: 6s - loss: 0.1073 - acc: 0.9675
416/753 [===============>..............] - ETA: 5s - loss: 0.1082 - acc: 0.9672
448/753 [================>.............] - ETA: 4s - loss: 0.1114 - acc: 0.9658
480/753 [==================>...........] - ETA: 4s - loss: 0.1136 - acc: 0.9650
512/753 [===================>..........] - ETA: 3s - loss: 0.1133 - acc: 0.9654
544/753 [====================>.........] - ETA: 3s - loss: 0.1183 - acc: 0.9642
576/753 [=====================>........] - ETA: 2s - loss: 0.1218 - acc: 0.9631
608/753 [=======================>......] - ETA: 2s - loss: 0.1222 - acc: 0.9628
640/753 [========================>.....] - ETA: 1s - loss: 0.1229 - acc: 0.9624
672/753 [=========================>....] - ETA: 1s - loss: 0.1220 - acc: 0.9627
704/753 [===========================>..] - ETA: 0s - loss: 0.1226 - acc: 0.9627
736/753 [============================>.] - ETA: 0s - loss: 0.1207 - acc: 0.9633
753/753 [==============================] - 13s 17ms/step - loss: 0.1199 - acc: 0.9636 - val_loss: 0.1812 - val_acc: 0.9448
Epoch 11/70

 32/753 [>.............................] - ETA: 11s - loss: 0.1036 - acc: 0.9685
 64/753 [=>............................] - ETA: 11s - loss: 0.0949 - acc: 0.9708
 96/753 [==>...........................] - ETA: 10s - loss: 0.1031 - acc: 0.9657
128/753 [====>.........................] - ETA: 10s - loss: 0.1083 - acc: 0.9617
160/753 [=====>........................] - ETA: 9s - loss: 0.1031 - acc: 0.9638 
192/753 [======>.......................] - ETA: 9s - loss: 0.1026 - acc: 0.9636
224/753 [=======>......................] - ETA: 8s - loss: 0.1016 - acc: 0.9656
256/753 [=========>....................] - ETA: 8s - loss: 0.1015 - acc: 0.9658
288/753 [==========>...................] - ETA: 7s - loss: 0.1025 - acc: 0.9660
320/753 [===========>..................] - ETA: 7s - loss: 0.1049 - acc: 0.9661
352/753 [=============>................] - ETA: 6s - loss: 0.1034 - acc: 0.9666
384/753 [==============>...............] - ETA: 6s - loss: 0.1021 - acc: 0.9671
416/753 [===============>..............] - ETA: 5s - loss: 0.1069 - acc: 0.9654
448/753 [================>.............] - ETA: 4s - loss: 0.1046 - acc: 0.9667
480/753 [==================>...........] - ETA: 4s - loss: 0.1045 - acc: 0.9660
512/753 [===================>..........] - ETA: 3s - loss: 0.1052 - acc: 0.9659
544/753 [====================>.........] - ETA: 3s - loss: 0.1037 - acc: 0.9667
576/753 [=====================>........] - ETA: 2s - loss: 0.1037 - acc: 0.9672
608/753 [=======================>......] - ETA: 2s - loss: 0.1045 - acc: 0.9671
640/753 [========================>.....] - ETA: 1s - loss: 0.1057 - acc: 0.9667
672/753 [=========================>....] - ETA: 1s - loss: 0.1048 - acc: 0.9670
704/753 [===========================>..] - ETA: 0s - loss: 0.1053 - acc: 0.9669
736/753 [============================>.] - ETA: 0s - loss: 0.1065 - acc: 0.9667
753/753 [==============================] - 13s 17ms/step - loss: 0.1060 - acc: 0.9669 - val_loss: 0.1787 - val_acc: 0.9464
Epoch 12/70

 32/753 [>.............................] - ETA: 11s - loss: 0.0814 - acc: 0.9747
 64/753 [=>............................] - ETA: 11s - loss: 0.0768 - acc: 0.9795
 96/753 [==>...........................] - ETA: 10s - loss: 0.0799 - acc: 0.9792
128/753 [====>.........................] - ETA: 10s - loss: 0.0872 - acc: 0.9745
160/753 [=====>........................] - ETA: 9s - loss: 0.0924 - acc: 0.9730 
192/753 [======>.......................] - ETA: 9s - loss: 0.0906 - acc: 0.9716
224/753 [=======>......................] - ETA: 8s - loss: 0.0916 - acc: 0.9711
256/753 [=========>....................] - ETA: 8s - loss: 0.0937 - acc: 0.9718
288/753 [==========>...................] - ETA: 7s - loss: 0.0930 - acc: 0.9730
320/753 [===========>..................] - ETA: 7s - loss: 0.0933 - acc: 0.9723
352/753 [=============>................] - ETA: 6s - loss: 0.0919 - acc: 0.9730
384/753 [==============>...............] - ETA: 6s - loss: 0.0916 - acc: 0.9725
416/753 [===============>..............] - ETA: 5s - loss: 0.0950 - acc: 0.9716
448/753 [================>.............] - ETA: 4s - loss: 0.0958 - acc: 0.9709
480/753 [==================>...........] - ETA: 4s - loss: 0.0966 - acc: 0.9708
512/753 [===================>..........] - ETA: 3s - loss: 0.0964 - acc: 0.9710
544/753 [====================>.........] - ETA: 3s - loss: 0.0984 - acc: 0.9707
576/753 [=====================>........] - ETA: 2s - loss: 0.0979 - acc: 0.9711
608/753 [=======================>......] - ETA: 2s - loss: 0.0957 - acc: 0.9719
640/753 [========================>.....] - ETA: 1s - loss: 0.0971 - acc: 0.9714
672/753 [=========================>....] - ETA: 1s - loss: 0.0961 - acc: 0.9718
704/753 [===========================>..] - ETA: 0s - loss: 0.0959 - acc: 0.9719
736/753 [============================>.] - ETA: 0s - loss: 0.0949 - acc: 0.9722
753/753 [==============================] - 13s 17ms/step - loss: 0.0943 - acc: 0.9725 - val_loss: 0.1739 - val_acc: 0.9474
Epoch 13/70

 32/753 [>.............................] - ETA: 12s - loss: 0.0892 - acc: 0.9736
 64/753 [=>............................] - ETA: 11s - loss: 0.0768 - acc: 0.9762
 96/753 [==>...........................] - ETA: 10s - loss: 0.0843 - acc: 0.9728
128/753 [====>.........................] - ETA: 10s - loss: 0.0864 - acc: 0.9730
160/753 [=====>........................] - ETA: 9s - loss: 0.0868 - acc: 0.9736 
192/753 [======>.......................] - ETA: 9s - loss: 0.0876 - acc: 0.9736
224/753 [=======>......................] - ETA: 8s - loss: 0.0913 - acc: 0.9728
256/753 [=========>....................] - ETA: 8s - loss: 0.0935 - acc: 0.9733
288/753 [==========>...................] - ETA: 7s - loss: 0.0944 - acc: 0.9730
320/753 [===========>..................] - ETA: 7s - loss: 0.0960 - acc: 0.9720
352/753 [=============>................] - ETA: 6s - loss: 0.0936 - acc: 0.9723
384/753 [==============>...............] - ETA: 6s - loss: 0.0915 - acc: 0.9727
416/753 [===============>..............] - ETA: 5s - loss: 0.0903 - acc: 0.9735
448/753 [================>.............] - ETA: 4s - loss: 0.0936 - acc: 0.9724
480/753 [==================>...........] - ETA: 4s - loss: 0.0929 - acc: 0.9723
512/753 [===================>..........] - ETA: 3s - loss: 0.0945 - acc: 0.9716
544/753 [====================>.........] - ETA: 3s - loss: 0.0971 - acc: 0.9713
576/753 [=====================>........] - ETA: 2s - loss: 0.0959 - acc: 0.9718
608/753 [=======================>......] - ETA: 2s - loss: 0.0957 - acc: 0.9722
640/753 [========================>.....] - ETA: 1s - loss: 0.0954 - acc: 0.9725
672/753 [=========================>....] - ETA: 1s - loss: 0.0953 - acc: 0.9724
704/753 [===========================>..] - ETA: 0s - loss: 0.0947 - acc: 0.9723
736/753 [============================>.] - ETA: 0s - loss: 0.0935 - acc: 0.9726
753/753 [==============================] - 13s 17ms/step - loss: 0.0930 - acc: 0.9726 - val_loss: 0.1764 - val_acc: 0.9491
Epoch 14/70

 32/753 [>.............................] - ETA: 11s - loss: 0.0787 - acc: 0.9780
 64/753 [=>............................] - ETA: 11s - loss: 0.0696 - acc: 0.9821
 96/753 [==>...........................] - ETA: 10s - loss: 0.0737 - acc: 0.9806
128/753 [====>.........................] - ETA: 10s - loss: 0.0716 - acc: 0.9806
160/753 [=====>........................] - ETA: 9s - loss: 0.0772 - acc: 0.9792 
192/753 [======>.......................] - ETA: 9s - loss: 0.0791 - acc: 0.9799
224/753 [=======>......................] - ETA: 8s - loss: 0.0840 - acc: 0.9777
256/753 [=========>....................] - ETA: 8s - loss: 0.0860 - acc: 0.9766
288/753 [==========>...................] - ETA: 7s - loss: 0.0831 - acc: 0.9777
320/753 [===========>..................] - ETA: 7s - loss: 0.0844 - acc: 0.9765
352/753 [=============>................] - ETA: 6s - loss: 0.0805 - acc: 0.9781
384/753 [==============>...............] - ETA: 6s - loss: 0.0813 - acc: 0.9767
416/753 [===============>..............] - ETA: 5s - loss: 0.0829 - acc: 0.9765
448/753 [================>.............] - ETA: 4s - loss: 0.0820 - acc: 0.9769
480/753 [==================>...........] - ETA: 4s - loss: 0.0839 - acc: 0.9768
512/753 [===================>..........] - ETA: 3s - loss: 0.0836 - acc: 0.9768
544/753 [====================>.........] - ETA: 3s - loss: 0.0838 - acc: 0.9767
576/753 [=====================>........] - ETA: 2s - loss: 0.0844 - acc: 0.9762
608/753 [=======================>......] - ETA: 2s - loss: 0.0843 - acc: 0.9764
640/753 [========================>.....] - ETA: 1s - loss: 0.0834 - acc: 0.9769
672/753 [=========================>....] - ETA: 1s - loss: 0.0838 - acc: 0.9768
704/753 [===========================>..] - ETA: 0s - loss: 0.0853 - acc: 0.9763
736/753 [============================>.] - ETA: 0s - loss: 0.0858 - acc: 0.9759
753/753 [==============================] - 13s 17ms/step - loss: 0.0860 - acc: 0.9759 - val_loss: 0.1754 - val_acc: 0.9458
Computing...
Manual evaluation: (didn't understand why I made this)
True 8096
False 975
True percentage 0.892514606989
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.88      0.72      0.79       438
      B-LOC       0.72      0.71      0.72       218
      B-ORG       0.69      0.69      0.69       296
      I-PER       0.80      0.64      0.72       214
     B-MISC       0.49      0.29      0.37       141
     I-MISC       0.51      0.34      0.41       154
      I-LOC       0.72      0.74      0.73       141
      I-ORG       0.50      0.64      0.56       151

avg / total       0.93      0.89      0.91      9071

F-1 Score:
0.667270531401
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 837 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100798 unique words.
Found 94 unique chars.
Found 9 unique labels.
794 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 259
OOV word occurences: 391
Padding...
Data padded!
Padding...
Data padded!
Padded until 58 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 58, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 58)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 58, 64)       6451136     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 58, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 58, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 58, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 58, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 58, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,954,242
Trainable params: 6,954,242
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 753 samples, validate on 84 samples
Epoch 1/70

 32/753 [>.............................] - ETA: 1:02 - loss: 2.4594 - acc: 0.0095
 64/753 [=>............................] - ETA: 35s - loss: 1.8040 - acc: 0.4095 
 96/753 [==>...........................] - ETA: 25s - loss: 2.3139 - acc: 0.5239
128/753 [====>.........................] - ETA: 20s - loss: 1.9739 - acc: 0.5969
160/753 [=====>........................] - ETA: 17s - loss: 1.7984 - acc: 0.6340
192/753 [======>.......................] - ETA: 15s - loss: 1.6659 - acc: 0.6592
224/753 [=======>......................] - ETA: 13s - loss: 1.5252 - acc: 0.6850
256/753 [=========>....................] - ETA: 11s - loss: 1.4323 - acc: 0.7000
288/753 [==========>...................] - ETA: 10s - loss: 1.3497 - acc: 0.7125
320/753 [===========>..................] - ETA: 9s - loss: 1.2746 - acc: 0.7248 
352/753 [=============>................] - ETA: 8s - loss: 1.2192 - acc: 0.7333
384/753 [==============>...............] - ETA: 7s - loss: 1.1726 - acc: 0.7396
416/753 [===============>..............] - ETA: 6s - loss: 1.1384 - acc: 0.7416
448/753 [================>.............] - ETA: 6s - loss: 1.1034 - acc: 0.7455
480/753 [==================>...........] - ETA: 5s - loss: 1.0741 - acc: 0.7480
512/753 [===================>..........] - ETA: 4s - loss: 1.0410 - acc: 0.7533
544/753 [====================>.........] - ETA: 3s - loss: 1.0090 - acc: 0.7583
576/753 [=====================>........] - ETA: 3s - loss: 0.9809 - acc: 0.7626
608/753 [=======================>......] - ETA: 2s - loss: 0.9575 - acc: 0.7664
640/753 [========================>.....] - ETA: 2s - loss: 0.9324 - acc: 0.7717
672/753 [=========================>....] - ETA: 1s - loss: 0.9114 - acc: 0.7747
704/753 [===========================>..] - ETA: 0s - loss: 0.8913 - acc: 0.7793
736/753 [============================>.] - ETA: 0s - loss: 0.8736 - acc: 0.7826
753/753 [==============================] - 14s 19ms/step - loss: 0.8619 - acc: 0.7855 - val_loss: 0.3802 - val_acc: 0.8697
Epoch 2/70

 32/753 [>.............................] - ETA: 11s - loss: 0.4416 - acc: 0.8444
 64/753 [=>............................] - ETA: 10s - loss: 0.4171 - acc: 0.8602
 96/753 [==>...........................] - ETA: 9s - loss: 0.4250 - acc: 0.8578 
128/753 [====>.........................] - ETA: 9s - loss: 0.4459 - acc: 0.8533
160/753 [=====>........................] - ETA: 8s - loss: 0.4658 - acc: 0.8466
192/753 [======>.......................] - ETA: 8s - loss: 0.4589 - acc: 0.8560
224/753 [=======>......................] - ETA: 7s - loss: 0.4626 - acc: 0.8527
256/753 [=========>....................] - ETA: 7s - loss: 0.4573 - acc: 0.8549
288/753 [==========>...................] - ETA: 6s - loss: 0.4433 - acc: 0.8587
320/753 [===========>..................] - ETA: 6s - loss: 0.4357 - acc: 0.8610
352/753 [=============>................] - ETA: 5s - loss: 0.4303 - acc: 0.8642
384/753 [==============>...............] - ETA: 5s - loss: 0.4174 - acc: 0.8684
416/753 [===============>..............] - ETA: 4s - loss: 0.4078 - acc: 0.8716
448/753 [================>.............] - ETA: 4s - loss: 0.4037 - acc: 0.8723
480/753 [==================>...........] - ETA: 3s - loss: 0.3993 - acc: 0.8744
512/753 [===================>..........] - ETA: 3s - loss: 0.3905 - acc: 0.8773
544/753 [====================>.........] - ETA: 3s - loss: 0.3908 - acc: 0.8772
576/753 [=====================>........] - ETA: 2s - loss: 0.3840 - acc: 0.8795
608/753 [=======================>......] - ETA: 2s - loss: 0.3802 - acc: 0.8813
640/753 [========================>.....] - ETA: 1s - loss: 0.3817 - acc: 0.8810
672/753 [=========================>....] - ETA: 1s - loss: 0.3778 - acc: 0.8824
704/753 [===========================>..] - ETA: 0s - loss: 0.3727 - acc: 0.8841
736/753 [============================>.] - ETA: 0s - loss: 0.3705 - acc: 0.8845
753/753 [==============================] - 11s 15ms/step - loss: 0.3705 - acc: 0.8845 - val_loss: 0.2808 - val_acc: 0.9137
Epoch 3/70

 32/753 [>.............................] - ETA: 10s - loss: 0.3148 - acc: 0.8939
 64/753 [=>............................] - ETA: 9s - loss: 0.3063 - acc: 0.8986 
 96/753 [==>...........................] - ETA: 9s - loss: 0.2988 - acc: 0.9076
128/753 [====>.........................] - ETA: 8s - loss: 0.2879 - acc: 0.9099
160/753 [=====>........................] - ETA: 8s - loss: 0.2950 - acc: 0.9068
192/753 [======>.......................] - ETA: 8s - loss: 0.2874 - acc: 0.9092
224/753 [=======>......................] - ETA: 7s - loss: 0.2872 - acc: 0.9084
256/753 [=========>....................] - ETA: 7s - loss: 0.2819 - acc: 0.9103
288/753 [==========>...................] - ETA: 6s - loss: 0.2855 - acc: 0.9098
320/753 [===========>..................] - ETA: 6s - loss: 0.2877 - acc: 0.9091
352/753 [=============>................] - ETA: 5s - loss: 0.2872 - acc: 0.9098
384/753 [==============>...............] - ETA: 5s - loss: 0.2866 - acc: 0.9093
416/753 [===============>..............] - ETA: 4s - loss: 0.2831 - acc: 0.9115
448/753 [================>.............] - ETA: 4s - loss: 0.2779 - acc: 0.9141
480/753 [==================>...........] - ETA: 3s - loss: 0.2762 - acc: 0.9147
512/753 [===================>..........] - ETA: 3s - loss: 0.2762 - acc: 0.9148
544/753 [====================>.........] - ETA: 3s - loss: 0.2761 - acc: 0.9146
576/753 [=====================>........] - ETA: 2s - loss: 0.2777 - acc: 0.9134
608/753 [=======================>......] - ETA: 2s - loss: 0.2771 - acc: 0.9137
640/753 [========================>.....] - ETA: 1s - loss: 0.2737 - acc: 0.9144
672/753 [=========================>....] - ETA: 1s - loss: 0.2706 - acc: 0.9153
704/753 [===========================>..] - ETA: 0s - loss: 0.2703 - acc: 0.9153
736/753 [============================>.] - ETA: 0s - loss: 0.2701 - acc: 0.9152
753/753 [==============================] - 11s 15ms/step - loss: 0.2697 - acc: 0.9150 - val_loss: 0.1957 - val_acc: 0.9401
Epoch 4/70

 32/753 [>.............................] - ETA: 10s - loss: 0.2554 - acc: 0.9153
 64/753 [=>............................] - ETA: 9s - loss: 0.2351 - acc: 0.9271 
 96/753 [==>...........................] - ETA: 9s - loss: 0.2277 - acc: 0.9309
128/753 [====>.........................] - ETA: 8s - loss: 0.2269 - acc: 0.9333
160/753 [=====>........................] - ETA: 8s - loss: 0.2240 - acc: 0.9334
192/753 [======>.......................] - ETA: 8s - loss: 0.2332 - acc: 0.9283
224/753 [=======>......................] - ETA: 7s - loss: 0.2264 - acc: 0.9306
256/753 [=========>....................] - ETA: 7s - loss: 0.2244 - acc: 0.9314
288/753 [==========>...................] - ETA: 6s - loss: 0.2295 - acc: 0.9294
320/753 [===========>..................] - ETA: 6s - loss: 0.2328 - acc: 0.9280
352/753 [=============>................] - ETA: 5s - loss: 0.2328 - acc: 0.9285
384/753 [==============>...............] - ETA: 5s - loss: 0.2303 - acc: 0.9289
416/753 [===============>..............] - ETA: 4s - loss: 0.2312 - acc: 0.9285
448/753 [================>.............] - ETA: 4s - loss: 0.2294 - acc: 0.9286
480/753 [==================>...........] - ETA: 3s - loss: 0.2307 - acc: 0.9287
512/753 [===================>..........] - ETA: 3s - loss: 0.2310 - acc: 0.9283
544/753 [====================>.........] - ETA: 3s - loss: 0.2303 - acc: 0.9283
576/753 [=====================>........] - ETA: 2s - loss: 0.2274 - acc: 0.9293
608/753 [=======================>......] - ETA: 2s - loss: 0.2261 - acc: 0.9301
640/753 [========================>.....] - ETA: 1s - loss: 0.2271 - acc: 0.9294
672/753 [=========================>....] - ETA: 1s - loss: 0.2263 - acc: 0.9295
704/753 [===========================>..] - ETA: 0s - loss: 0.2271 - acc: 0.9296
736/753 [============================>.] - ETA: 0s - loss: 0.2264 - acc: 0.9298
753/753 [==============================] - 11s 15ms/step - loss: 0.2271 - acc: 0.9292 - val_loss: 0.1807 - val_acc: 0.9487
Epoch 5/70

 32/753 [>.............................] - ETA: 10s - loss: 0.1803 - acc: 0.9480
 64/753 [=>............................] - ETA: 9s - loss: 0.2242 - acc: 0.9227 
 96/753 [==>...........................] - ETA: 9s - loss: 0.2201 - acc: 0.9279
128/753 [====>.........................] - ETA: 8s - loss: 0.2312 - acc: 0.9230
160/753 [=====>........................] - ETA: 8s - loss: 0.2218 - acc: 0.9268
192/753 [======>.......................] - ETA: 8s - loss: 0.2209 - acc: 0.9288
224/753 [=======>......................] - ETA: 7s - loss: 0.2122 - acc: 0.9307
256/753 [=========>....................] - ETA: 7s - loss: 0.2088 - acc: 0.9322
288/753 [==========>...................] - ETA: 6s - loss: 0.2086 - acc: 0.9331
320/753 [===========>..................] - ETA: 6s - loss: 0.2045 - acc: 0.9356
352/753 [=============>................] - ETA: 5s - loss: 0.1994 - acc: 0.9369
384/753 [==============>...............] - ETA: 5s - loss: 0.1981 - acc: 0.9380
416/753 [===============>..............] - ETA: 4s - loss: 0.1980 - acc: 0.9374
448/753 [================>.............] - ETA: 4s - loss: 0.1998 - acc: 0.9372
480/753 [==================>...........] - ETA: 3s - loss: 0.2011 - acc: 0.9358
512/753 [===================>..........] - ETA: 3s - loss: 0.2016 - acc: 0.9353
544/753 [====================>.........] - ETA: 2s - loss: 0.2000 - acc: 0.9360
576/753 [=====================>........] - ETA: 2s - loss: 0.1957 - acc: 0.9374
608/753 [=======================>......] - ETA: 2s - loss: 0.1942 - acc: 0.9379
640/753 [========================>.....] - ETA: 1s - loss: 0.1962 - acc: 0.9376
672/753 [=========================>....] - ETA: 1s - loss: 0.1946 - acc: 0.9386
704/753 [===========================>..] - ETA: 0s - loss: 0.1940 - acc: 0.9392
736/753 [============================>.] - ETA: 0s - loss: 0.1948 - acc: 0.9392
753/753 [==============================] - 11s 15ms/step - loss: 0.1945 - acc: 0.9394 - val_loss: 0.1496 - val_acc: 0.9563
Epoch 6/70

 32/753 [>.............................] - ETA: 10s - loss: 0.1768 - acc: 0.9439
 64/753 [=>............................] - ETA: 9s - loss: 0.1839 - acc: 0.9484 
 96/753 [==>...........................] - ETA: 9s - loss: 0.1736 - acc: 0.9543
128/753 [====>.........................] - ETA: 8s - loss: 0.1812 - acc: 0.9502
160/753 [=====>........................] - ETA: 8s - loss: 0.1777 - acc: 0.9495
192/753 [======>.......................] - ETA: 7s - loss: 0.1790 - acc: 0.9490
224/753 [=======>......................] - ETA: 7s - loss: 0.1773 - acc: 0.9481
256/753 [=========>....................] - ETA: 7s - loss: 0.1757 - acc: 0.9496
288/753 [==========>...................] - ETA: 6s - loss: 0.1785 - acc: 0.9483
320/753 [===========>..................] - ETA: 6s - loss: 0.1747 - acc: 0.9492
352/753 [=============>................] - ETA: 5s - loss: 0.1725 - acc: 0.9486
384/753 [==============>...............] - ETA: 5s - loss: 0.1735 - acc: 0.9479
416/753 [===============>..............] - ETA: 4s - loss: 0.1751 - acc: 0.9472
448/753 [================>.............] - ETA: 4s - loss: 0.1774 - acc: 0.9460
480/753 [==================>...........] - ETA: 3s - loss: 0.1789 - acc: 0.9452
512/753 [===================>..........] - ETA: 3s - loss: 0.1764 - acc: 0.9460
544/753 [====================>.........] - ETA: 2s - loss: 0.1756 - acc: 0.9462
576/753 [=====================>........] - ETA: 2s - loss: 0.1794 - acc: 0.9451
608/753 [=======================>......] - ETA: 2s - loss: 0.1805 - acc: 0.9447
640/753 [========================>.....] - ETA: 1s - loss: 0.1779 - acc: 0.9456
672/753 [=========================>....] - ETA: 1s - loss: 0.1767 - acc: 0.9460
704/753 [===========================>..] - ETA: 0s - loss: 0.1725 - acc: 0.9473
736/753 [============================>.] - ETA: 0s - loss: 0.1714 - acc: 0.9481
753/753 [==============================] - 11s 15ms/step - loss: 0.1716 - acc: 0.9483 - val_loss: 0.1515 - val_acc: 0.9533
Epoch 7/70

 32/753 [>.............................] - ETA: 10s - loss: 0.2294 - acc: 0.9214
 64/753 [=>............................] - ETA: 9s - loss: 0.1802 - acc: 0.9457 
 96/753 [==>...........................] - ETA: 9s - loss: 0.1746 - acc: 0.9488
128/753 [====>.........................] - ETA: 8s - loss: 0.1607 - acc: 0.9504
160/753 [=====>........................] - ETA: 8s - loss: 0.1602 - acc: 0.9505
192/753 [======>.......................] - ETA: 8s - loss: 0.1583 - acc: 0.9500
224/753 [=======>......................] - ETA: 7s - loss: 0.1531 - acc: 0.9516
256/753 [=========>....................] - ETA: 7s - loss: 0.1564 - acc: 0.9498
288/753 [==========>...................] - ETA: 6s - loss: 0.1598 - acc: 0.9492
320/753 [===========>..................] - ETA: 6s - loss: 0.1569 - acc: 0.9502
352/753 [=============>................] - ETA: 5s - loss: 0.1548 - acc: 0.9517
384/753 [==============>...............] - ETA: 5s - loss: 0.1552 - acc: 0.9517
416/753 [===============>..............] - ETA: 4s - loss: 0.1533 - acc: 0.9528
448/753 [================>.............] - ETA: 4s - loss: 0.1522 - acc: 0.9529
480/753 [==================>...........] - ETA: 3s - loss: 0.1568 - acc: 0.9517
512/753 [===================>..........] - ETA: 3s - loss: 0.1579 - acc: 0.9510
544/753 [====================>.........] - ETA: 2s - loss: 0.1573 - acc: 0.9506
576/753 [=====================>........] - ETA: 2s - loss: 0.1594 - acc: 0.9494
608/753 [=======================>......] - ETA: 2s - loss: 0.1594 - acc: 0.9493
640/753 [========================>.....] - ETA: 1s - loss: 0.1596 - acc: 0.9487
672/753 [=========================>....] - ETA: 1s - loss: 0.1594 - acc: 0.9492
704/753 [===========================>..] - ETA: 0s - loss: 0.1602 - acc: 0.9488
736/753 [============================>.] - ETA: 0s - loss: 0.1589 - acc: 0.9494
753/753 [==============================] - 11s 15ms/step - loss: 0.1593 - acc: 0.9494 - val_loss: 0.1384 - val_acc: 0.9599
Epoch 8/70

 32/753 [>.............................] - ETA: 10s - loss: 0.1528 - acc: 0.9458
 64/753 [=>............................] - ETA: 9s - loss: 0.1651 - acc: 0.9485 
 96/753 [==>...........................] - ETA: 9s - loss: 0.1666 - acc: 0.9495
128/753 [====>.........................] - ETA: 8s - loss: 0.1518 - acc: 0.9527
160/753 [=====>........................] - ETA: 8s - loss: 0.1562 - acc: 0.9524
192/753 [======>.......................] - ETA: 7s - loss: 0.1557 - acc: 0.9513
224/753 [=======>......................] - ETA: 7s - loss: 0.1533 - acc: 0.9526
256/753 [=========>....................] - ETA: 7s - loss: 0.1508 - acc: 0.9532
288/753 [==========>...................] - ETA: 6s - loss: 0.1447 - acc: 0.9551
320/753 [===========>..................] - ETA: 6s - loss: 0.1399 - acc: 0.9559
352/753 [=============>................] - ETA: 5s - loss: 0.1407 - acc: 0.9560
384/753 [==============>...............] - ETA: 5s - loss: 0.1403 - acc: 0.9566
416/753 [===============>..............] - ETA: 4s - loss: 0.1375 - acc: 0.9575
448/753 [================>.............] - ETA: 4s - loss: 0.1347 - acc: 0.9588
480/753 [==================>...........] - ETA: 3s - loss: 0.1368 - acc: 0.9583
512/753 [===================>..........] - ETA: 3s - loss: 0.1354 - acc: 0.9588
544/753 [====================>.........] - ETA: 3s - loss: 0.1359 - acc: 0.9591
576/753 [=====================>........] - ETA: 2s - loss: 0.1430 - acc: 0.9573
608/753 [=======================>......] - ETA: 2s - loss: 0.1444 - acc: 0.9566
640/753 [========================>.....] - ETA: 1s - loss: 0.1446 - acc: 0.9560
672/753 [=========================>....] - ETA: 1s - loss: 0.1428 - acc: 0.9565
704/753 [===========================>..] - ETA: 0s - loss: 0.1419 - acc: 0.9567
736/753 [============================>.] - ETA: 0s - loss: 0.1408 - acc: 0.9573
753/753 [==============================] - 11s 15ms/step - loss: 0.1406 - acc: 0.9575 - val_loss: 0.1286 - val_acc: 0.9645
Epoch 9/70

 32/753 [>.............................] - ETA: 10s - loss: 0.1735 - acc: 0.9544
 64/753 [=>............................] - ETA: 9s - loss: 0.1351 - acc: 0.9608 
 96/753 [==>...........................] - ETA: 9s - loss: 0.1229 - acc: 0.9650
128/753 [====>.........................] - ETA: 8s - loss: 0.1194 - acc: 0.9649
160/753 [=====>........................] - ETA: 8s - loss: 0.1172 - acc: 0.9649
192/753 [======>.......................] - ETA: 8s - loss: 0.1132 - acc: 0.9662
224/753 [=======>......................] - ETA: 7s - loss: 0.1127 - acc: 0.9667
256/753 [=========>....................] - ETA: 7s - loss: 0.1124 - acc: 0.9659
288/753 [==========>...................] - ETA: 6s - loss: 0.1166 - acc: 0.9638
320/753 [===========>..................] - ETA: 6s - loss: 0.1243 - acc: 0.9615
352/753 [=============>................] - ETA: 5s - loss: 0.1252 - acc: 0.9610
384/753 [==============>...............] - ETA: 5s - loss: 0.1276 - acc: 0.9602
416/753 [===============>..............] - ETA: 4s - loss: 0.1288 - acc: 0.9601
448/753 [================>.............] - ETA: 4s - loss: 0.1282 - acc: 0.9602
480/753 [==================>...........] - ETA: 3s - loss: 0.1271 - acc: 0.9603
512/753 [===================>..........] - ETA: 3s - loss: 0.1256 - acc: 0.9610
544/753 [====================>.........] - ETA: 2s - loss: 0.1267 - acc: 0.9604
576/753 [=====================>........] - ETA: 2s - loss: 0.1254 - acc: 0.9605
608/753 [=======================>......] - ETA: 2s - loss: 0.1252 - acc: 0.9607
640/753 [========================>.....] - ETA: 1s - loss: 0.1236 - acc: 0.9615
672/753 [=========================>....] - ETA: 1s - loss: 0.1253 - acc: 0.9614
704/753 [===========================>..] - ETA: 0s - loss: 0.1254 - acc: 0.9614
736/753 [============================>.] - ETA: 0s - loss: 0.1282 - acc: 0.9604
753/753 [==============================] - 11s 15ms/step - loss: 0.1287 - acc: 0.9602 - val_loss: 0.1348 - val_acc: 0.9605
Epoch 10/70

 32/753 [>.............................] - ETA: 10s - loss: 0.1615 - acc: 0.9547
 64/753 [=>............................] - ETA: 9s - loss: 0.1307 - acc: 0.9619 
 96/753 [==>...........................] - ETA: 9s - loss: 0.1221 - acc: 0.9658
128/753 [====>.........................] - ETA: 8s - loss: 0.1219 - acc: 0.9628
160/753 [=====>........................] - ETA: 8s - loss: 0.1204 - acc: 0.9636
192/753 [======>.......................] - ETA: 8s - loss: 0.1169 - acc: 0.9642
224/753 [=======>......................] - ETA: 7s - loss: 0.1118 - acc: 0.9659
256/753 [=========>....................] - ETA: 7s - loss: 0.1152 - acc: 0.9647
288/753 [==========>...................] - ETA: 6s - loss: 0.1154 - acc: 0.9655
320/753 [===========>..................] - ETA: 6s - loss: 0.1137 - acc: 0.9667
352/753 [=============>................] - ETA: 5s - loss: 0.1182 - acc: 0.9645
384/753 [==============>...............] - ETA: 5s - loss: 0.1237 - acc: 0.9622
416/753 [===============>..............] - ETA: 4s - loss: 0.1243 - acc: 0.9621
448/753 [================>.............] - ETA: 4s - loss: 0.1242 - acc: 0.9621
480/753 [==================>...........] - ETA: 3s - loss: 0.1236 - acc: 0.9618
512/753 [===================>..........] - ETA: 3s - loss: 0.1205 - acc: 0.9628
544/753 [====================>.........] - ETA: 2s - loss: 0.1234 - acc: 0.9618
576/753 [=====================>........] - ETA: 2s - loss: 0.1233 - acc: 0.9620
608/753 [=======================>......] - ETA: 2s - loss: 0.1216 - acc: 0.9625
640/753 [========================>.....] - ETA: 1s - loss: 0.1216 - acc: 0.9625
672/753 [=========================>....] - ETA: 1s - loss: 0.1219 - acc: 0.9623
704/753 [===========================>..] - ETA: 0s - loss: 0.1221 - acc: 0.9618
736/753 [============================>.] - ETA: 0s - loss: 0.1219 - acc: 0.9619
753/753 [==============================] - 11s 15ms/step - loss: 0.1223 - acc: 0.9617 - val_loss: 0.1254 - val_acc: 0.9589
Epoch 11/70

 32/753 [>.............................] - ETA: 10s - loss: 0.1145 - acc: 0.9601
 64/753 [=>............................] - ETA: 9s - loss: 0.0971 - acc: 0.9720 
 96/753 [==>...........................] - ETA: 9s - loss: 0.1111 - acc: 0.9667
128/753 [====>.........................] - ETA: 8s - loss: 0.1104 - acc: 0.9680
160/753 [=====>........................] - ETA: 8s - loss: 0.1008 - acc: 0.9713
192/753 [======>.......................] - ETA: 7s - loss: 0.1075 - acc: 0.9666
224/753 [=======>......................] - ETA: 7s - loss: 0.1066 - acc: 0.9653
256/753 [=========>....................] - ETA: 7s - loss: 0.1007 - acc: 0.9676
288/753 [==========>...................] - ETA: 6s - loss: 0.1015 - acc: 0.9678
320/753 [===========>..................] - ETA: 6s - loss: 0.1016 - acc: 0.9685
352/753 [=============>................] - ETA: 5s - loss: 0.1028 - acc: 0.9676
384/753 [==============>...............] - ETA: 5s - loss: 0.0998 - acc: 0.9687
416/753 [===============>..............] - ETA: 4s - loss: 0.1037 - acc: 0.9678
448/753 [================>.............] - ETA: 4s - loss: 0.1043 - acc: 0.9673
480/753 [==================>...........] - ETA: 3s - loss: 0.1031 - acc: 0.9680
512/753 [===================>..........] - ETA: 3s - loss: 0.1010 - acc: 0.9687
544/753 [====================>.........] - ETA: 2s - loss: 0.1006 - acc: 0.9689
576/753 [=====================>........] - ETA: 2s - loss: 0.1027 - acc: 0.9681
608/753 [=======================>......] - ETA: 2s - loss: 0.1017 - acc: 0.9687
640/753 [========================>.....] - ETA: 1s - loss: 0.1025 - acc: 0.9686
672/753 [=========================>....] - ETA: 1s - loss: 0.1020 - acc: 0.9686
704/753 [===========================>..] - ETA: 0s - loss: 0.1064 - acc: 0.9675
736/753 [============================>.] - ETA: 0s - loss: 0.1081 - acc: 0.9673
753/753 [==============================] - 11s 15ms/step - loss: 0.1096 - acc: 0.9670 - val_loss: 0.1420 - val_acc: 0.9572
Epoch 12/70

 32/753 [>.............................] - ETA: 10s - loss: 0.1240 - acc: 0.9738
 64/753 [=>............................] - ETA: 9s - loss: 0.1446 - acc: 0.9596 
 96/753 [==>...........................] - ETA: 9s - loss: 0.1365 - acc: 0.9624
128/753 [====>.........................] - ETA: 8s - loss: 0.1315 - acc: 0.9635
160/753 [=====>........................] - ETA: 8s - loss: 0.1202 - acc: 0.9664
192/753 [======>.......................] - ETA: 8s - loss: 0.1198 - acc: 0.9648
224/753 [=======>......................] - ETA: 7s - loss: 0.1195 - acc: 0.9637
256/753 [=========>....................] - ETA: 7s - loss: 0.1210 - acc: 0.9629
288/753 [==========>...................] - ETA: 6s - loss: 0.1145 - acc: 0.9659
320/753 [===========>..................] - ETA: 6s - loss: 0.1121 - acc: 0.9658
352/753 [=============>................] - ETA: 5s - loss: 0.1138 - acc: 0.9658
384/753 [==============>...............] - ETA: 5s - loss: 0.1123 - acc: 0.9671
416/753 [===============>..............] - ETA: 4s - loss: 0.1104 - acc: 0.9672
448/753 [================>.............] - ETA: 4s - loss: 0.1084 - acc: 0.9678
480/753 [==================>...........] - ETA: 3s - loss: 0.1081 - acc: 0.9680
512/753 [===================>..........] - ETA: 3s - loss: 0.1050 - acc: 0.9688
544/753 [====================>.........] - ETA: 2s - loss: 0.1034 - acc: 0.9691
576/753 [=====================>........] - ETA: 2s - loss: 0.1022 - acc: 0.9698
608/753 [=======================>......] - ETA: 2s - loss: 0.1019 - acc: 0.9699
640/753 [========================>.....] - ETA: 1s - loss: 0.1032 - acc: 0.9698
672/753 [=========================>....] - ETA: 1s - loss: 0.1037 - acc: 0.9693
704/753 [===========================>..] - ETA: 0s - loss: 0.1046 - acc: 0.9690
736/753 [============================>.] - ETA: 0s - loss: 0.1032 - acc: 0.9694
753/753 [==============================] - 11s 15ms/step - loss: 0.1025 - acc: 0.9694 - val_loss: 0.1133 - val_acc: 0.9668
Epoch 13/70

 32/753 [>.............................] - ETA: 10s - loss: 0.0732 - acc: 0.9761
 64/753 [=>............................] - ETA: 9s - loss: 0.0619 - acc: 0.9809 
 96/753 [==>...........................] - ETA: 9s - loss: 0.0839 - acc: 0.9740
128/753 [====>.........................] - ETA: 8s - loss: 0.0942 - acc: 0.9710
160/753 [=====>........................] - ETA: 8s - loss: 0.1028 - acc: 0.9673
192/753 [======>.......................] - ETA: 8s - loss: 0.1041 - acc: 0.9677
224/753 [=======>......................] - ETA: 7s - loss: 0.1074 - acc: 0.9674
256/753 [=========>....................] - ETA: 7s - loss: 0.1039 - acc: 0.9683
288/753 [==========>...................] - ETA: 6s - loss: 0.1021 - acc: 0.9685
320/753 [===========>..................] - ETA: 6s - loss: 0.1013 - acc: 0.9694
352/753 [=============>................] - ETA: 5s - loss: 0.1016 - acc: 0.9694
384/753 [==============>...............] - ETA: 5s - loss: 0.0999 - acc: 0.9697
416/753 [===============>..............] - ETA: 4s - loss: 0.0979 - acc: 0.9703
448/753 [================>.............] - ETA: 4s - loss: 0.0979 - acc: 0.9700
480/753 [==================>...........] - ETA: 3s - loss: 0.0986 - acc: 0.9700
512/753 [===================>..........] - ETA: 3s - loss: 0.0984 - acc: 0.9704
544/753 [====================>.........] - ETA: 2s - loss: 0.0977 - acc: 0.9706
576/753 [=====================>........] - ETA: 2s - loss: 0.0967 - acc: 0.9711
608/753 [=======================>......] - ETA: 2s - loss: 0.0960 - acc: 0.9709
640/753 [========================>.....] - ETA: 1s - loss: 0.0959 - acc: 0.9706
672/753 [=========================>....] - ETA: 1s - loss: 0.0963 - acc: 0.9706
704/753 [===========================>..] - ETA: 0s - loss: 0.0964 - acc: 0.9700
736/753 [============================>.] - ETA: 0s - loss: 0.0964 - acc: 0.9705
753/753 [==============================] - 11s 15ms/step - loss: 0.0952 - acc: 0.9710 - val_loss: 0.1167 - val_acc: 0.9646
Epoch 14/70

 32/753 [>.............................] - ETA: 10s - loss: 0.0804 - acc: 0.9738
 64/753 [=>............................] - ETA: 9s - loss: 0.0710 - acc: 0.9792 
 96/753 [==>...........................] - ETA: 9s - loss: 0.0697 - acc: 0.9785
128/753 [====>.........................] - ETA: 8s - loss: 0.0796 - acc: 0.9751
160/753 [=====>........................] - ETA: 8s - loss: 0.0781 - acc: 0.9770
192/753 [======>.......................] - ETA: 7s - loss: 0.0753 - acc: 0.9784
224/753 [=======>......................] - ETA: 7s - loss: 0.0787 - acc: 0.9764
256/753 [=========>....................] - ETA: 7s - loss: 0.0825 - acc: 0.9750
288/753 [==========>...................] - ETA: 6s - loss: 0.0859 - acc: 0.9731
320/753 [===========>..................] - ETA: 6s - loss: 0.0845 - acc: 0.9732
352/753 [=============>................] - ETA: 5s - loss: 0.0833 - acc: 0.9733
384/753 [==============>...............] - ETA: 5s - loss: 0.0860 - acc: 0.9724
416/753 [===============>..............] - ETA: 4s - loss: 0.0843 - acc: 0.9729
448/753 [================>.............] - ETA: 4s - loss: 0.0825 - acc: 0.9733
480/753 [==================>...........] - ETA: 3s - loss: 0.0827 - acc: 0.9731
512/753 [===================>..........] - ETA: 3s - loss: 0.0827 - acc: 0.9733
544/753 [====================>.........] - ETA: 2s - loss: 0.0847 - acc: 0.9731
576/753 [=====================>........] - ETA: 2s - loss: 0.0865 - acc: 0.9728
608/753 [=======================>......] - ETA: 2s - loss: 0.0885 - acc: 0.9724
640/753 [========================>.....] - ETA: 1s - loss: 0.0886 - acc: 0.9727
672/753 [=========================>....] - ETA: 1s - loss: 0.0903 - acc: 0.9720
704/753 [===========================>..] - ETA: 0s - loss: 0.0907 - acc: 0.9719
736/753 [============================>.] - ETA: 0s - loss: 0.0910 - acc: 0.9717
753/753 [==============================] - 11s 15ms/step - loss: 0.0912 - acc: 0.9716 - val_loss: 0.1192 - val_acc: 0.9657
Computing...
Manual evaluation: (didn't understand why I made this)
True 8059
False 1012
True percentage 0.888435674126
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.79      0.60      0.68       296
      I-ORG       0.57      0.35      0.43       151
      B-PER       0.89      0.73      0.80       438
      B-LOC       0.80      0.66      0.72       218
      I-LOC       0.73      0.74      0.74       141
      I-PER       0.91      0.57      0.70       214
     B-MISC       0.26      0.38      0.31       141
     I-MISC       0.40      0.42      0.41       154

avg / total       0.93      0.89      0.91      9071

F-1 Score:
0.63781461019
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 837 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100807 unique words.
Found 94 unique chars.
Found 9 unique labels.
803 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 256
OOV word occurences: 360
Padding...
Data padded!
Padding...
Data padded!
Padded until 83 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6451712     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,954,818
Trainable params: 6,954,818
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 753 samples, validate on 84 samples
Epoch 1/70

 32/753 [>.............................] - ETA: 1:11 - loss: 2.1125 - acc: 0.2342
 64/753 [=>............................] - ETA: 41s - loss: 1.4317 - acc: 0.5385 
 96/753 [==>...........................] - ETA: 30s - loss: 1.3099 - acc: 0.6301
128/753 [====>.........................] - ETA: 25s - loss: 1.3314 - acc: 0.6505
160/753 [=====>........................] - ETA: 21s - loss: 1.2239 - acc: 0.6806
192/753 [======>.......................] - ETA: 19s - loss: 1.1474 - acc: 0.6989
224/753 [=======>......................] - ETA: 16s - loss: 1.0865 - acc: 0.7121
256/753 [=========>....................] - ETA: 15s - loss: 1.0369 - acc: 0.7243
288/753 [==========>...................] - ETA: 13s - loss: 0.9831 - acc: 0.7373
320/753 [===========>..................] - ETA: 12s - loss: 0.9602 - acc: 0.7412
352/753 [=============>................] - ETA: 11s - loss: 0.9257 - acc: 0.7496
384/753 [==============>...............] - ETA: 9s - loss: 0.8988 - acc: 0.7544 
416/753 [===============>..............] - ETA: 8s - loss: 0.8711 - acc: 0.7622
448/753 [================>.............] - ETA: 7s - loss: 0.8519 - acc: 0.7653
480/753 [==================>...........] - ETA: 6s - loss: 0.8333 - acc: 0.7706
512/753 [===================>..........] - ETA: 6s - loss: 0.8241 - acc: 0.7716
544/753 [====================>.........] - ETA: 5s - loss: 0.8093 - acc: 0.7759
576/753 [=====================>........] - ETA: 4s - loss: 0.7944 - acc: 0.7783
608/753 [=======================>......] - ETA: 3s - loss: 0.7749 - acc: 0.7833
640/753 [========================>.....] - ETA: 2s - loss: 0.7574 - acc: 0.7873
672/753 [=========================>....] - ETA: 1s - loss: 0.7406 - acc: 0.7918
704/753 [===========================>..] - ETA: 1s - loss: 0.7252 - acc: 0.7954
736/753 [============================>.] - ETA: 0s - loss: 0.7135 - acc: 0.7991
753/753 [==============================] - 19s 25ms/step - loss: 0.7045 - acc: 0.8013 - val_loss: 0.4120 - val_acc: 0.8793
Epoch 2/70

 32/753 [>.............................] - ETA: 14s - loss: 0.4765 - acc: 0.8695
 64/753 [=>............................] - ETA: 13s - loss: 0.4628 - acc: 0.8644
 96/753 [==>...........................] - ETA: 12s - loss: 0.4451 - acc: 0.8674
128/753 [====>.........................] - ETA: 12s - loss: 0.4114 - acc: 0.8775
160/753 [=====>........................] - ETA: 11s - loss: 0.4044 - acc: 0.8791
192/753 [======>.......................] - ETA: 10s - loss: 0.3893 - acc: 0.8838
224/753 [=======>......................] - ETA: 10s - loss: 0.4081 - acc: 0.8763
256/753 [=========>....................] - ETA: 9s - loss: 0.4079 - acc: 0.8799 
288/753 [==========>...................] - ETA: 8s - loss: 0.4069 - acc: 0.8805
320/753 [===========>..................] - ETA: 8s - loss: 0.4100 - acc: 0.8796
352/753 [=============>................] - ETA: 7s - loss: 0.4137 - acc: 0.8774
384/753 [==============>...............] - ETA: 7s - loss: 0.4034 - acc: 0.8815
416/753 [===============>..............] - ETA: 6s - loss: 0.4047 - acc: 0.8796
448/753 [================>.............] - ETA: 5s - loss: 0.3970 - acc: 0.8819
480/753 [==================>...........] - ETA: 5s - loss: 0.3865 - acc: 0.8850
512/753 [===================>..........] - ETA: 4s - loss: 0.3815 - acc: 0.8859
544/753 [====================>.........] - ETA: 4s - loss: 0.3745 - acc: 0.8876
576/753 [=====================>........] - ETA: 3s - loss: 0.3708 - acc: 0.8883
608/753 [=======================>......] - ETA: 2s - loss: 0.3653 - acc: 0.8900
640/753 [========================>.....] - ETA: 2s - loss: 0.3571 - acc: 0.8926
672/753 [=========================>....] - ETA: 1s - loss: 0.3576 - acc: 0.8918
704/753 [===========================>..] - ETA: 0s - loss: 0.3529 - acc: 0.8936
736/753 [============================>.] - ETA: 0s - loss: 0.3502 - acc: 0.8940
753/753 [==============================] - 15s 20ms/step - loss: 0.3507 - acc: 0.8939 - val_loss: 0.2751 - val_acc: 0.9239
Epoch 3/70

 32/753 [>.............................] - ETA: 13s - loss: 0.2856 - acc: 0.9167
 64/753 [=>............................] - ETA: 12s - loss: 0.2567 - acc: 0.9271
 96/753 [==>...........................] - ETA: 12s - loss: 0.2554 - acc: 0.9245
128/753 [====>.........................] - ETA: 11s - loss: 0.2640 - acc: 0.9188
160/753 [=====>........................] - ETA: 11s - loss: 0.2697 - acc: 0.9160
192/753 [======>.......................] - ETA: 10s - loss: 0.2642 - acc: 0.9177
224/753 [=======>......................] - ETA: 10s - loss: 0.2618 - acc: 0.9179
256/753 [=========>....................] - ETA: 9s - loss: 0.2593 - acc: 0.9197 
288/753 [==========>...................] - ETA: 8s - loss: 0.2568 - acc: 0.9211
320/753 [===========>..................] - ETA: 8s - loss: 0.2559 - acc: 0.9214
352/753 [=============>................] - ETA: 7s - loss: 0.2619 - acc: 0.9193
384/753 [==============>...............] - ETA: 7s - loss: 0.2637 - acc: 0.9185
416/753 [===============>..............] - ETA: 6s - loss: 0.2628 - acc: 0.9185
448/753 [================>.............] - ETA: 5s - loss: 0.2614 - acc: 0.9196
480/753 [==================>...........] - ETA: 5s - loss: 0.2592 - acc: 0.9200
512/753 [===================>..........] - ETA: 4s - loss: 0.2562 - acc: 0.9214
544/753 [====================>.........] - ETA: 3s - loss: 0.2583 - acc: 0.9208
576/753 [=====================>........] - ETA: 3s - loss: 0.2590 - acc: 0.9206
608/753 [=======================>......] - ETA: 2s - loss: 0.2598 - acc: 0.9207
640/753 [========================>.....] - ETA: 2s - loss: 0.2598 - acc: 0.9198
672/753 [=========================>....] - ETA: 1s - loss: 0.2568 - acc: 0.9211
704/753 [===========================>..] - ETA: 0s - loss: 0.2570 - acc: 0.9211
736/753 [============================>.] - ETA: 0s - loss: 0.2572 - acc: 0.9206
753/753 [==============================] - 15s 20ms/step - loss: 0.2575 - acc: 0.9200 - val_loss: 0.2317 - val_acc: 0.9315
Epoch 4/70

 32/753 [>.............................] - ETA: 13s - loss: 0.2398 - acc: 0.9297
 64/753 [=>............................] - ETA: 13s - loss: 0.2373 - acc: 0.9228
 96/753 [==>...........................] - ETA: 12s - loss: 0.2245 - acc: 0.9279
128/753 [====>.........................] - ETA: 11s - loss: 0.2178 - acc: 0.9289
160/753 [=====>........................] - ETA: 11s - loss: 0.2162 - acc: 0.9303
192/753 [======>.......................] - ETA: 10s - loss: 0.2150 - acc: 0.9309
224/753 [=======>......................] - ETA: 10s - loss: 0.2124 - acc: 0.9308
256/753 [=========>....................] - ETA: 9s - loss: 0.2201 - acc: 0.9280 
288/753 [==========>...................] - ETA: 8s - loss: 0.2142 - acc: 0.9310
320/753 [===========>..................] - ETA: 8s - loss: 0.2081 - acc: 0.9337
352/753 [=============>................] - ETA: 7s - loss: 0.2063 - acc: 0.9339
384/753 [==============>...............] - ETA: 6s - loss: 0.2022 - acc: 0.9349
416/753 [===============>..............] - ETA: 6s - loss: 0.2032 - acc: 0.9343
448/753 [================>.............] - ETA: 5s - loss: 0.2044 - acc: 0.9338
480/753 [==================>...........] - ETA: 5s - loss: 0.2031 - acc: 0.9337
512/753 [===================>..........] - ETA: 4s - loss: 0.2041 - acc: 0.9332
544/753 [====================>.........] - ETA: 3s - loss: 0.2094 - acc: 0.9321
576/753 [=====================>........] - ETA: 3s - loss: 0.2090 - acc: 0.9326
608/753 [=======================>......] - ETA: 2s - loss: 0.2090 - acc: 0.9327
640/753 [========================>.....] - ETA: 2s - loss: 0.2083 - acc: 0.9330
672/753 [=========================>....] - ETA: 1s - loss: 0.2074 - acc: 0.9329
704/753 [===========================>..] - ETA: 0s - loss: 0.2054 - acc: 0.9336
736/753 [============================>.] - ETA: 0s - loss: 0.2062 - acc: 0.9331
753/753 [==============================] - 15s 20ms/step - loss: 0.2065 - acc: 0.9330 - val_loss: 0.2182 - val_acc: 0.9354
Epoch 5/70

 32/753 [>.............................] - ETA: 13s - loss: 0.2063 - acc: 0.9246
 64/753 [=>............................] - ETA: 12s - loss: 0.2052 - acc: 0.9319
 96/753 [==>...........................] - ETA: 12s - loss: 0.1994 - acc: 0.9379
128/753 [====>.........................] - ETA: 11s - loss: 0.1915 - acc: 0.9382
160/753 [=====>........................] - ETA: 11s - loss: 0.1873 - acc: 0.9397
192/753 [======>.......................] - ETA: 10s - loss: 0.1837 - acc: 0.9426
224/753 [=======>......................] - ETA: 9s - loss: 0.1823 - acc: 0.9424 
256/753 [=========>....................] - ETA: 9s - loss: 0.1836 - acc: 0.9422
288/753 [==========>...................] - ETA: 8s - loss: 0.1791 - acc: 0.9443
320/753 [===========>..................] - ETA: 8s - loss: 0.1729 - acc: 0.9464
352/753 [=============>................] - ETA: 7s - loss: 0.1714 - acc: 0.9469
384/753 [==============>...............] - ETA: 6s - loss: 0.1733 - acc: 0.9465
416/753 [===============>..............] - ETA: 6s - loss: 0.1770 - acc: 0.9453
448/753 [================>.............] - ETA: 5s - loss: 0.1751 - acc: 0.9458
480/753 [==================>...........] - ETA: 5s - loss: 0.1798 - acc: 0.9434
512/753 [===================>..........] - ETA: 4s - loss: 0.1802 - acc: 0.9432
544/753 [====================>.........] - ETA: 3s - loss: 0.1812 - acc: 0.9429
576/753 [=====================>........] - ETA: 3s - loss: 0.1815 - acc: 0.9435
608/753 [=======================>......] - ETA: 2s - loss: 0.1858 - acc: 0.9418
640/753 [========================>.....] - ETA: 2s - loss: 0.1854 - acc: 0.9417
672/753 [=========================>....] - ETA: 1s - loss: 0.1853 - acc: 0.9421
704/753 [===========================>..] - ETA: 0s - loss: 0.1847 - acc: 0.9423
736/753 [============================>.] - ETA: 0s - loss: 0.1822 - acc: 0.9430
753/753 [==============================] - 15s 20ms/step - loss: 0.1806 - acc: 0.9436 - val_loss: 0.2036 - val_acc: 0.9440
Epoch 6/70

 32/753 [>.............................] - ETA: 13s - loss: 0.1521 - acc: 0.9572
 64/753 [=>............................] - ETA: 13s - loss: 0.1579 - acc: 0.9511
 96/753 [==>...........................] - ETA: 12s - loss: 0.1429 - acc: 0.9541
128/753 [====>.........................] - ETA: 11s - loss: 0.1372 - acc: 0.9566
160/753 [=====>........................] - ETA: 11s - loss: 0.1459 - acc: 0.9531
192/753 [======>.......................] - ETA: 10s - loss: 0.1442 - acc: 0.9535
224/753 [=======>......................] - ETA: 9s - loss: 0.1434 - acc: 0.9543 
256/753 [=========>....................] - ETA: 9s - loss: 0.1385 - acc: 0.9564
288/753 [==========>...................] - ETA: 8s - loss: 0.1405 - acc: 0.9549
320/753 [===========>..................] - ETA: 8s - loss: 0.1396 - acc: 0.9554
352/753 [=============>................] - ETA: 7s - loss: 0.1450 - acc: 0.9535
384/753 [==============>...............] - ETA: 6s - loss: 0.1525 - acc: 0.9517
416/753 [===============>..............] - ETA: 6s - loss: 0.1515 - acc: 0.9528
448/753 [================>.............] - ETA: 5s - loss: 0.1509 - acc: 0.9530
480/753 [==================>...........] - ETA: 5s - loss: 0.1497 - acc: 0.9530
512/753 [===================>..........] - ETA: 4s - loss: 0.1503 - acc: 0.9533
544/753 [====================>.........] - ETA: 3s - loss: 0.1508 - acc: 0.9525
576/753 [=====================>........] - ETA: 3s - loss: 0.1545 - acc: 0.9509
608/753 [=======================>......] - ETA: 2s - loss: 0.1564 - acc: 0.9510
640/753 [========================>.....] - ETA: 2s - loss: 0.1607 - acc: 0.9492
672/753 [=========================>....] - ETA: 1s - loss: 0.1639 - acc: 0.9480
704/753 [===========================>..] - ETA: 0s - loss: 0.1654 - acc: 0.9477
736/753 [============================>.] - ETA: 0s - loss: 0.1630 - acc: 0.9485
753/753 [==============================] - 15s 20ms/step - loss: 0.1633 - acc: 0.9484 - val_loss: 0.2040 - val_acc: 0.9376
Epoch 7/70

 32/753 [>.............................] - ETA: 13s - loss: 0.1017 - acc: 0.9644
 64/753 [=>............................] - ETA: 12s - loss: 0.1474 - acc: 0.9567
 96/753 [==>...........................] - ETA: 12s - loss: 0.1479 - acc: 0.9564
128/753 [====>.........................] - ETA: 11s - loss: 0.1498 - acc: 0.9542
160/753 [=====>........................] - ETA: 11s - loss: 0.1399 - acc: 0.9563
192/753 [======>.......................] - ETA: 10s - loss: 0.1508 - acc: 0.9525
224/753 [=======>......................] - ETA: 9s - loss: 0.1504 - acc: 0.9523 
256/753 [=========>....................] - ETA: 9s - loss: 0.1476 - acc: 0.9523
288/753 [==========>...................] - ETA: 8s - loss: 0.1460 - acc: 0.9532
320/753 [===========>..................] - ETA: 8s - loss: 0.1470 - acc: 0.9530
352/753 [=============>................] - ETA: 7s - loss: 0.1499 - acc: 0.9534
384/753 [==============>...............] - ETA: 7s - loss: 0.1504 - acc: 0.9524
416/753 [===============>..............] - ETA: 6s - loss: 0.1463 - acc: 0.9538
448/753 [================>.............] - ETA: 5s - loss: 0.1474 - acc: 0.9528
480/753 [==================>...........] - ETA: 5s - loss: 0.1458 - acc: 0.9529
512/753 [===================>..........] - ETA: 4s - loss: 0.1416 - acc: 0.9542
544/753 [====================>.........] - ETA: 3s - loss: 0.1377 - acc: 0.9554
576/753 [=====================>........] - ETA: 3s - loss: 0.1395 - acc: 0.9553
608/753 [=======================>......] - ETA: 2s - loss: 0.1395 - acc: 0.9553
640/753 [========================>.....] - ETA: 2s - loss: 0.1425 - acc: 0.9550
672/753 [=========================>....] - ETA: 1s - loss: 0.1465 - acc: 0.9540
704/753 [===========================>..] - ETA: 0s - loss: 0.1452 - acc: 0.9542
736/753 [============================>.] - ETA: 0s - loss: 0.1458 - acc: 0.9543
753/753 [==============================] - 15s 20ms/step - loss: 0.1463 - acc: 0.9542 - val_loss: 0.1841 - val_acc: 0.9489
Epoch 8/70

 32/753 [>.............................] - ETA: 13s - loss: 0.1376 - acc: 0.9550
 64/753 [=>............................] - ETA: 13s - loss: 0.1186 - acc: 0.9611
 96/753 [==>...........................] - ETA: 12s - loss: 0.1173 - acc: 0.9629
128/753 [====>.........................] - ETA: 11s - loss: 0.1272 - acc: 0.9620
160/753 [=====>........................] - ETA: 11s - loss: 0.1204 - acc: 0.9631
192/753 [======>.......................] - ETA: 10s - loss: 0.1229 - acc: 0.9614
224/753 [=======>......................] - ETA: 9s - loss: 0.1238 - acc: 0.9612 
256/753 [=========>....................] - ETA: 9s - loss: 0.1245 - acc: 0.9613
288/753 [==========>...................] - ETA: 8s - loss: 0.1287 - acc: 0.9610
320/753 [===========>..................] - ETA: 8s - loss: 0.1267 - acc: 0.9609
352/753 [=============>................] - ETA: 7s - loss: 0.1240 - acc: 0.9615
384/753 [==============>...............] - ETA: 6s - loss: 0.1255 - acc: 0.9610
416/753 [===============>..............] - ETA: 6s - loss: 0.1242 - acc: 0.9620
448/753 [================>.............] - ETA: 5s - loss: 0.1251 - acc: 0.9617
480/753 [==================>...........] - ETA: 5s - loss: 0.1284 - acc: 0.9612
512/753 [===================>..........] - ETA: 4s - loss: 0.1289 - acc: 0.9613
544/753 [====================>.........] - ETA: 3s - loss: 0.1290 - acc: 0.9609
576/753 [=====================>........] - ETA: 3s - loss: 0.1301 - acc: 0.9604
608/753 [=======================>......] - ETA: 2s - loss: 0.1311 - acc: 0.9603
640/753 [========================>.....] - ETA: 2s - loss: 0.1295 - acc: 0.9604
672/753 [=========================>....] - ETA: 1s - loss: 0.1327 - acc: 0.9597
704/753 [===========================>..] - ETA: 0s - loss: 0.1315 - acc: 0.9599
736/753 [============================>.] - ETA: 0s - loss: 0.1334 - acc: 0.9594
753/753 [==============================] - 15s 20ms/step - loss: 0.1333 - acc: 0.9596 - val_loss: 0.1861 - val_acc: 0.9522
Epoch 9/70

 32/753 [>.............................] - ETA: 13s - loss: 0.0769 - acc: 0.9781
 64/753 [=>............................] - ETA: 12s - loss: 0.0908 - acc: 0.9750
 96/753 [==>...........................] - ETA: 12s - loss: 0.1026 - acc: 0.9669
128/753 [====>.........................] - ETA: 11s - loss: 0.0997 - acc: 0.9682
160/753 [=====>........................] - ETA: 11s - loss: 0.0949 - acc: 0.9705
192/753 [======>.......................] - ETA: 10s - loss: 0.1036 - acc: 0.9695
224/753 [=======>......................] - ETA: 9s - loss: 0.1019 - acc: 0.9697 
256/753 [=========>....................] - ETA: 9s - loss: 0.1063 - acc: 0.9684
288/753 [==========>...................] - ETA: 8s - loss: 0.1075 - acc: 0.9679
320/753 [===========>..................] - ETA: 8s - loss: 0.1092 - acc: 0.9675
352/753 [=============>................] - ETA: 7s - loss: 0.1114 - acc: 0.9666
384/753 [==============>...............] - ETA: 6s - loss: 0.1119 - acc: 0.9666
416/753 [===============>..............] - ETA: 6s - loss: 0.1110 - acc: 0.9669
448/753 [================>.............] - ETA: 5s - loss: 0.1147 - acc: 0.9651
480/753 [==================>...........] - ETA: 5s - loss: 0.1155 - acc: 0.9650
512/753 [===================>..........] - ETA: 4s - loss: 0.1144 - acc: 0.9654
544/753 [====================>.........] - ETA: 3s - loss: 0.1171 - acc: 0.9645
576/753 [=====================>........] - ETA: 3s - loss: 0.1154 - acc: 0.9654
608/753 [=======================>......] - ETA: 2s - loss: 0.1168 - acc: 0.9647
640/753 [========================>.....] - ETA: 2s - loss: 0.1218 - acc: 0.9637
672/753 [=========================>....] - ETA: 1s - loss: 0.1218 - acc: 0.9636
704/753 [===========================>..] - ETA: 0s - loss: 0.1201 - acc: 0.9644
736/753 [============================>.] - ETA: 0s - loss: 0.1212 - acc: 0.9632
753/753 [==============================] - 15s 20ms/step - loss: 0.1203 - acc: 0.9636 - val_loss: 0.1758 - val_acc: 0.9478
Epoch 10/70

 32/753 [>.............................] - ETA: 13s - loss: 0.0960 - acc: 0.9711
 64/753 [=>............................] - ETA: 12s - loss: 0.1039 - acc: 0.9659
 96/753 [==>...........................] - ETA: 12s - loss: 0.1114 - acc: 0.9640
128/753 [====>.........................] - ETA: 11s - loss: 0.1130 - acc: 0.9650
160/753 [=====>........................] - ETA: 11s - loss: 0.1165 - acc: 0.9624
192/753 [======>.......................] - ETA: 10s - loss: 0.1212 - acc: 0.9633
224/753 [=======>......................] - ETA: 10s - loss: 0.1162 - acc: 0.9658
256/753 [=========>....................] - ETA: 9s - loss: 0.1198 - acc: 0.9652 
288/753 [==========>...................] - ETA: 8s - loss: 0.1178 - acc: 0.9652
320/753 [===========>..................] - ETA: 8s - loss: 0.1171 - acc: 0.9661
352/753 [=============>................] - ETA: 7s - loss: 0.1138 - acc: 0.9667
384/753 [==============>...............] - ETA: 6s - loss: 0.1122 - acc: 0.9670
416/753 [===============>..............] - ETA: 6s - loss: 0.1113 - acc: 0.9672
448/753 [================>.............] - ETA: 5s - loss: 0.1098 - acc: 0.9677
480/753 [==================>...........] - ETA: 5s - loss: 0.1110 - acc: 0.9670
512/753 [===================>..........] - ETA: 4s - loss: 0.1095 - acc: 0.9676
544/753 [====================>.........] - ETA: 3s - loss: 0.1118 - acc: 0.9662
576/753 [=====================>........] - ETA: 3s - loss: 0.1115 - acc: 0.9662
608/753 [=======================>......] - ETA: 2s - loss: 0.1129 - acc: 0.9661
640/753 [========================>.....] - ETA: 2s - loss: 0.1118 - acc: 0.9665
672/753 [=========================>....] - ETA: 1s - loss: 0.1098 - acc: 0.9671
704/753 [===========================>..] - ETA: 0s - loss: 0.1086 - acc: 0.9677
736/753 [============================>.] - ETA: 0s - loss: 0.1087 - acc: 0.9678
753/753 [==============================] - 15s 20ms/step - loss: 0.1090 - acc: 0.9676 - val_loss: 0.1762 - val_acc: 0.9462
Epoch 11/70

 32/753 [>.............................] - ETA: 13s - loss: 0.1258 - acc: 0.9627
 64/753 [=>............................] - ETA: 12s - loss: 0.1092 - acc: 0.9719
 96/753 [==>...........................] - ETA: 12s - loss: 0.1102 - acc: 0.9686
128/753 [====>.........................] - ETA: 11s - loss: 0.1150 - acc: 0.9648
160/753 [=====>........................] - ETA: 11s - loss: 0.1134 - acc: 0.9666
192/753 [======>.......................] - ETA: 10s - loss: 0.1085 - acc: 0.9677
224/753 [=======>......................] - ETA: 9s - loss: 0.1001 - acc: 0.9710 
256/753 [=========>....................] - ETA: 9s - loss: 0.0989 - acc: 0.9714
288/753 [==========>...................] - ETA: 8s - loss: 0.0974 - acc: 0.9720
320/753 [===========>..................] - ETA: 8s - loss: 0.0961 - acc: 0.9719
352/753 [=============>................] - ETA: 7s - loss: 0.0949 - acc: 0.9729
384/753 [==============>...............] - ETA: 6s - loss: 0.0948 - acc: 0.9727
416/753 [===============>..............] - ETA: 6s - loss: 0.0958 - acc: 0.9718
448/753 [================>.............] - ETA: 5s - loss: 0.0949 - acc: 0.9722
480/753 [==================>...........] - ETA: 5s - loss: 0.0964 - acc: 0.9716
512/753 [===================>..........] - ETA: 4s - loss: 0.0971 - acc: 0.9714
544/753 [====================>.........] - ETA: 3s - loss: 0.0990 - acc: 0.9700
576/753 [=====================>........] - ETA: 3s - loss: 0.0971 - acc: 0.9707
608/753 [=======================>......] - ETA: 2s - loss: 0.1002 - acc: 0.9700
640/753 [========================>.....] - ETA: 2s - loss: 0.1002 - acc: 0.9695
672/753 [=========================>....] - ETA: 1s - loss: 0.1010 - acc: 0.9689
704/753 [===========================>..] - ETA: 0s - loss: 0.1007 - acc: 0.9693
736/753 [============================>.] - ETA: 0s - loss: 0.1013 - acc: 0.9692
753/753 [==============================] - 15s 20ms/step - loss: 0.1017 - acc: 0.9691 - val_loss: 0.1769 - val_acc: 0.9479
Computing...
Manual evaluation: (didn't understand why I made this)
True 8122
False 949
True percentage 0.895380884136
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.96      0.97      7318
      B-ORG       0.83      0.65      0.73       296
      I-ORG       0.72      0.25      0.37       151
     B-MISC       0.43      0.30      0.36       141
     I-MISC       0.41      0.50      0.45       154
      B-PER       0.87      0.77      0.82       438
      B-LOC       0.76      0.70      0.73       218
      I-LOC       0.68      0.72      0.70       141
      I-PER       0.86      0.62      0.72       214

avg / total       0.93      0.90      0.91      9071

F-1 Score:
0.668118195956
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 837 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100814 unique words.
Found 94 unique chars.
Found 9 unique labels.
810 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 255
OOV word occurences: 357
Padding...
Data padded!
Padding...
Data padded!
Padded until 67 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 67, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 67)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 67, 64)       6452160     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 67, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 67, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 67, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 67, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 67, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,955,266
Trainable params: 6,955,266
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 753 samples, validate on 84 samples
Epoch 1/70

 32/753 [>.............................] - ETA: 1:04 - loss: 2.5057 - acc: 0.0189
 64/753 [=>............................] - ETA: 36s - loss: 1.6736 - acc: 0.4205 
 96/753 [==>...........................] - ETA: 26s - loss: 1.8429 - acc: 0.5558
128/753 [====>.........................] - ETA: 21s - loss: 1.6562 - acc: 0.6196
160/753 [=====>........................] - ETA: 18s - loss: 1.5201 - acc: 0.6477
192/753 [======>.......................] - ETA: 16s - loss: 1.4168 - acc: 0.6673
224/753 [=======>......................] - ETA: 14s - loss: 1.3060 - acc: 0.6903
256/753 [=========>....................] - ETA: 12s - loss: 1.2462 - acc: 0.7011
288/753 [==========>...................] - ETA: 11s - loss: 1.1859 - acc: 0.7128
320/753 [===========>..................] - ETA: 10s - loss: 1.1444 - acc: 0.7187
352/753 [=============>................] - ETA: 9s - loss: 1.0968 - acc: 0.7286 
384/753 [==============>...............] - ETA: 8s - loss: 1.0556 - acc: 0.7360
416/753 [===============>..............] - ETA: 7s - loss: 1.0123 - acc: 0.7450
448/753 [================>.............] - ETA: 6s - loss: 0.9826 - acc: 0.7495
480/753 [==================>...........] - ETA: 5s - loss: 0.9621 - acc: 0.7527
512/753 [===================>..........] - ETA: 5s - loss: 0.9319 - acc: 0.7592
544/753 [====================>.........] - ETA: 4s - loss: 0.9140 - acc: 0.7619
576/753 [=====================>........] - ETA: 3s - loss: 0.8896 - acc: 0.7671
608/753 [=======================>......] - ETA: 2s - loss: 0.8639 - acc: 0.7728
640/753 [========================>.....] - ETA: 2s - loss: 0.8471 - acc: 0.7774
672/753 [=========================>....] - ETA: 1s - loss: 0.8303 - acc: 0.7802
704/753 [===========================>..] - ETA: 0s - loss: 0.8172 - acc: 0.7825
736/753 [============================>.] - ETA: 0s - loss: 0.8015 - acc: 0.7859
753/753 [==============================] - 16s 21ms/step - loss: 0.7947 - acc: 0.7873 - val_loss: 0.3613 - val_acc: 0.8937
Epoch 2/70

 32/753 [>.............................] - ETA: 11s - loss: 0.4299 - acc: 0.8695
 64/753 [=>............................] - ETA: 11s - loss: 0.4071 - acc: 0.8760
 96/753 [==>...........................] - ETA: 10s - loss: 0.4315 - acc: 0.8693
128/753 [====>.........................] - ETA: 10s - loss: 0.4220 - acc: 0.8734
160/753 [=====>........................] - ETA: 9s - loss: 0.4046 - acc: 0.8786 
192/753 [======>.......................] - ETA: 9s - loss: 0.3863 - acc: 0.8837
224/753 [=======>......................] - ETA: 8s - loss: 0.3759 - acc: 0.8864
256/753 [=========>....................] - ETA: 8s - loss: 0.3849 - acc: 0.8820
288/753 [==========>...................] - ETA: 7s - loss: 0.3807 - acc: 0.8825
320/753 [===========>..................] - ETA: 7s - loss: 0.3858 - acc: 0.8824
352/753 [=============>................] - ETA: 6s - loss: 0.3785 - acc: 0.8837
384/753 [==============>...............] - ETA: 6s - loss: 0.3753 - acc: 0.8859
416/753 [===============>..............] - ETA: 5s - loss: 0.3770 - acc: 0.8854
448/753 [================>.............] - ETA: 5s - loss: 0.3716 - acc: 0.8871
480/753 [==================>...........] - ETA: 4s - loss: 0.3679 - acc: 0.8879
512/753 [===================>..........] - ETA: 3s - loss: 0.3690 - acc: 0.8868
544/753 [====================>.........] - ETA: 3s - loss: 0.3665 - acc: 0.8875
576/753 [=====================>........] - ETA: 2s - loss: 0.3634 - acc: 0.8890
608/753 [=======================>......] - ETA: 2s - loss: 0.3635 - acc: 0.8902
640/753 [========================>.....] - ETA: 1s - loss: 0.3629 - acc: 0.8907
672/753 [=========================>....] - ETA: 1s - loss: 0.3606 - acc: 0.8915
704/753 [===========================>..] - ETA: 0s - loss: 0.3589 - acc: 0.8911
736/753 [============================>.] - ETA: 0s - loss: 0.3596 - acc: 0.8906
753/753 [==============================] - 13s 17ms/step - loss: 0.3580 - acc: 0.8912 - val_loss: 0.2621 - val_acc: 0.9205
Epoch 3/70

 32/753 [>.............................] - ETA: 11s - loss: 0.3489 - acc: 0.8896
 64/753 [=>............................] - ETA: 11s - loss: 0.2924 - acc: 0.9115
 96/753 [==>...........................] - ETA: 10s - loss: 0.2933 - acc: 0.9071
128/753 [====>.........................] - ETA: 10s - loss: 0.3105 - acc: 0.9017
160/753 [=====>........................] - ETA: 9s - loss: 0.3031 - acc: 0.9033 
192/753 [======>.......................] - ETA: 9s - loss: 0.3041 - acc: 0.9038
224/753 [=======>......................] - ETA: 8s - loss: 0.3033 - acc: 0.9033
256/753 [=========>....................] - ETA: 8s - loss: 0.2904 - acc: 0.9080
288/753 [==========>...................] - ETA: 7s - loss: 0.2798 - acc: 0.9127
320/753 [===========>..................] - ETA: 7s - loss: 0.2795 - acc: 0.9130
352/753 [=============>................] - ETA: 6s - loss: 0.2777 - acc: 0.9137
384/753 [==============>...............] - ETA: 6s - loss: 0.2784 - acc: 0.9125
416/753 [===============>..............] - ETA: 5s - loss: 0.2794 - acc: 0.9116
448/753 [================>.............] - ETA: 4s - loss: 0.2801 - acc: 0.9117
480/753 [==================>...........] - ETA: 4s - loss: 0.2826 - acc: 0.9117
512/753 [===================>..........] - ETA: 3s - loss: 0.2803 - acc: 0.9123
544/753 [====================>.........] - ETA: 3s - loss: 0.2786 - acc: 0.9134
576/753 [=====================>........] - ETA: 2s - loss: 0.2761 - acc: 0.9140
608/753 [=======================>......] - ETA: 2s - loss: 0.2782 - acc: 0.9134
640/753 [========================>.....] - ETA: 1s - loss: 0.2761 - acc: 0.9143
672/753 [=========================>....] - ETA: 1s - loss: 0.2733 - acc: 0.9159
704/753 [===========================>..] - ETA: 0s - loss: 0.2704 - acc: 0.9166
736/753 [============================>.] - ETA: 0s - loss: 0.2685 - acc: 0.9169
753/753 [==============================] - 13s 17ms/step - loss: 0.2684 - acc: 0.9171 - val_loss: 0.2190 - val_acc: 0.9340
Epoch 4/70

 32/753 [>.............................] - ETA: 12s - loss: 0.2581 - acc: 0.9342
 64/753 [=>............................] - ETA: 11s - loss: 0.2526 - acc: 0.9275
 96/753 [==>...........................] - ETA: 10s - loss: 0.2426 - acc: 0.9257
128/753 [====>.........................] - ETA: 10s - loss: 0.2301 - acc: 0.9313
160/753 [=====>........................] - ETA: 9s - loss: 0.2211 - acc: 0.9333 
192/753 [======>.......................] - ETA: 9s - loss: 0.2083 - acc: 0.9351
224/753 [=======>......................] - ETA: 8s - loss: 0.2170 - acc: 0.9317
256/753 [=========>....................] - ETA: 8s - loss: 0.2159 - acc: 0.9322
288/753 [==========>...................] - ETA: 7s - loss: 0.2236 - acc: 0.9295
320/753 [===========>..................] - ETA: 7s - loss: 0.2270 - acc: 0.9277
352/753 [=============>................] - ETA: 6s - loss: 0.2183 - acc: 0.9308
384/753 [==============>...............] - ETA: 6s - loss: 0.2230 - acc: 0.9280
416/753 [===============>..............] - ETA: 5s - loss: 0.2205 - acc: 0.9293
448/753 [================>.............] - ETA: 4s - loss: 0.2234 - acc: 0.9282
480/753 [==================>...........] - ETA: 4s - loss: 0.2240 - acc: 0.9287
512/753 [===================>..........] - ETA: 3s - loss: 0.2215 - acc: 0.9296
544/753 [====================>.........] - ETA: 3s - loss: 0.2226 - acc: 0.9300
576/753 [=====================>........] - ETA: 2s - loss: 0.2240 - acc: 0.9293
608/753 [=======================>......] - ETA: 2s - loss: 0.2228 - acc: 0.9291
640/753 [========================>.....] - ETA: 1s - loss: 0.2204 - acc: 0.9305
672/753 [=========================>....] - ETA: 1s - loss: 0.2175 - acc: 0.9313
704/753 [===========================>..] - ETA: 0s - loss: 0.2184 - acc: 0.9313
736/753 [============================>.] - ETA: 0s - loss: 0.2182 - acc: 0.9317
753/753 [==============================] - 13s 17ms/step - loss: 0.2196 - acc: 0.9311 - val_loss: 0.2227 - val_acc: 0.9303
Epoch 5/70

 32/753 [>.............................] - ETA: 11s - loss: 0.1804 - acc: 0.9385
 64/753 [=>............................] - ETA: 11s - loss: 0.1713 - acc: 0.9412
 96/753 [==>...........................] - ETA: 10s - loss: 0.1908 - acc: 0.9377
128/753 [====>.........................] - ETA: 10s - loss: 0.2013 - acc: 0.9356
160/753 [=====>........................] - ETA: 9s - loss: 0.1918 - acc: 0.9402 
192/753 [======>.......................] - ETA: 9s - loss: 0.1916 - acc: 0.9395
224/753 [=======>......................] - ETA: 8s - loss: 0.1983 - acc: 0.9379
256/753 [=========>....................] - ETA: 8s - loss: 0.1921 - acc: 0.9404
288/753 [==========>...................] - ETA: 7s - loss: 0.1916 - acc: 0.9401
320/753 [===========>..................] - ETA: 7s - loss: 0.1941 - acc: 0.9393
352/753 [=============>................] - ETA: 6s - loss: 0.1963 - acc: 0.9382
384/753 [==============>...............] - ETA: 5s - loss: 0.1945 - acc: 0.9398
416/753 [===============>..............] - ETA: 5s - loss: 0.1952 - acc: 0.9401
448/753 [================>.............] - ETA: 4s - loss: 0.1959 - acc: 0.9397
480/753 [==================>...........] - ETA: 4s - loss: 0.1943 - acc: 0.9410
512/753 [===================>..........] - ETA: 3s - loss: 0.1977 - acc: 0.9402
544/753 [====================>.........] - ETA: 3s - loss: 0.1980 - acc: 0.9397
576/753 [=====================>........] - ETA: 2s - loss: 0.1988 - acc: 0.9395
608/753 [=======================>......] - ETA: 2s - loss: 0.1964 - acc: 0.9405
640/753 [========================>.....] - ETA: 1s - loss: 0.1930 - acc: 0.9413
672/753 [=========================>....] - ETA: 1s - loss: 0.1962 - acc: 0.9405
704/753 [===========================>..] - ETA: 0s - loss: 0.1943 - acc: 0.9406
736/753 [============================>.] - ETA: 0s - loss: 0.1932 - acc: 0.9407
753/753 [==============================] - 13s 17ms/step - loss: 0.1929 - acc: 0.9409 - val_loss: 0.2030 - val_acc: 0.9330
Epoch 6/70

 32/753 [>.............................] - ETA: 11s - loss: 0.2314 - acc: 0.9288
 64/753 [=>............................] - ETA: 11s - loss: 0.2056 - acc: 0.9376
 96/753 [==>...........................] - ETA: 10s - loss: 0.1984 - acc: 0.9400
128/753 [====>.........................] - ETA: 10s - loss: 0.1905 - acc: 0.9403
160/753 [=====>........................] - ETA: 9s - loss: 0.1928 - acc: 0.9414 
192/753 [======>.......................] - ETA: 9s - loss: 0.1892 - acc: 0.9430
224/753 [=======>......................] - ETA: 8s - loss: 0.1887 - acc: 0.9425
256/753 [=========>....................] - ETA: 8s - loss: 0.1823 - acc: 0.9443
288/753 [==========>...................] - ETA: 7s - loss: 0.1752 - acc: 0.9459
320/753 [===========>..................] - ETA: 7s - loss: 0.1783 - acc: 0.9443
352/753 [=============>................] - ETA: 6s - loss: 0.1738 - acc: 0.9460
384/753 [==============>...............] - ETA: 6s - loss: 0.1725 - acc: 0.9461
416/753 [===============>..............] - ETA: 5s - loss: 0.1733 - acc: 0.9460
448/753 [================>.............] - ETA: 4s - loss: 0.1736 - acc: 0.9462
480/753 [==================>...........] - ETA: 4s - loss: 0.1741 - acc: 0.9471
512/753 [===================>..........] - ETA: 3s - loss: 0.1740 - acc: 0.9477
544/753 [====================>.........] - ETA: 3s - loss: 0.1704 - acc: 0.9486
576/753 [=====================>........] - ETA: 2s - loss: 0.1678 - acc: 0.9490
608/753 [=======================>......] - ETA: 2s - loss: 0.1682 - acc: 0.9491
640/753 [========================>.....] - ETA: 1s - loss: 0.1662 - acc: 0.9496
672/753 [=========================>....] - ETA: 1s - loss: 0.1653 - acc: 0.9491
704/753 [===========================>..] - ETA: 0s - loss: 0.1681 - acc: 0.9482
736/753 [============================>.] - ETA: 0s - loss: 0.1707 - acc: 0.9478
753/753 [==============================] - 13s 17ms/step - loss: 0.1702 - acc: 0.9477 - val_loss: 0.1963 - val_acc: 0.9383
Epoch 7/70

 32/753 [>.............................] - ETA: 11s - loss: 0.1994 - acc: 0.9427
 64/753 [=>............................] - ETA: 11s - loss: 0.1570 - acc: 0.9578
 96/753 [==>...........................] - ETA: 10s - loss: 0.1639 - acc: 0.9523
128/753 [====>.........................] - ETA: 10s - loss: 0.1628 - acc: 0.9509
160/753 [=====>........................] - ETA: 9s - loss: 0.1668 - acc: 0.9509 
192/753 [======>.......................] - ETA: 9s - loss: 0.1586 - acc: 0.9531
224/753 [=======>......................] - ETA: 8s - loss: 0.1615 - acc: 0.9517
256/753 [=========>....................] - ETA: 8s - loss: 0.1579 - acc: 0.9530
288/753 [==========>...................] - ETA: 7s - loss: 0.1555 - acc: 0.9540
320/753 [===========>..................] - ETA: 7s - loss: 0.1569 - acc: 0.9536
352/753 [=============>................] - ETA: 6s - loss: 0.1537 - acc: 0.9546
384/753 [==============>...............] - ETA: 5s - loss: 0.1531 - acc: 0.9543
416/753 [===============>..............] - ETA: 5s - loss: 0.1507 - acc: 0.9548
448/753 [================>.............] - ETA: 4s - loss: 0.1471 - acc: 0.9561
480/753 [==================>...........] - ETA: 4s - loss: 0.1477 - acc: 0.9552
512/753 [===================>..........] - ETA: 3s - loss: 0.1487 - acc: 0.9549
544/753 [====================>.........] - ETA: 3s - loss: 0.1509 - acc: 0.9539
576/753 [=====================>........] - ETA: 2s - loss: 0.1497 - acc: 0.9547
608/753 [=======================>......] - ETA: 2s - loss: 0.1498 - acc: 0.9547
640/753 [========================>.....] - ETA: 1s - loss: 0.1498 - acc: 0.9548
672/753 [=========================>....] - ETA: 1s - loss: 0.1492 - acc: 0.9549
704/753 [===========================>..] - ETA: 0s - loss: 0.1512 - acc: 0.9539
736/753 [============================>.] - ETA: 0s - loss: 0.1506 - acc: 0.9541
753/753 [==============================] - 13s 17ms/step - loss: 0.1503 - acc: 0.9541 - val_loss: 0.1905 - val_acc: 0.9428
Epoch 8/70

 32/753 [>.............................] - ETA: 11s - loss: 0.1717 - acc: 0.9450
 64/753 [=>............................] - ETA: 11s - loss: 0.1586 - acc: 0.9485
 96/753 [==>...........................] - ETA: 10s - loss: 0.1481 - acc: 0.9547
128/753 [====>.........................] - ETA: 10s - loss: 0.1415 - acc: 0.9557
160/753 [=====>........................] - ETA: 9s - loss: 0.1419 - acc: 0.9553 
192/753 [======>.......................] - ETA: 9s - loss: 0.1410 - acc: 0.9553
224/753 [=======>......................] - ETA: 8s - loss: 0.1347 - acc: 0.9580
256/753 [=========>....................] - ETA: 8s - loss: 0.1329 - acc: 0.9576
288/753 [==========>...................] - ETA: 7s - loss: 0.1398 - acc: 0.9554
320/753 [===========>..................] - ETA: 7s - loss: 0.1378 - acc: 0.9564
352/753 [=============>................] - ETA: 6s - loss: 0.1404 - acc: 0.9552
384/753 [==============>...............] - ETA: 5s - loss: 0.1375 - acc: 0.9563
416/753 [===============>..............] - ETA: 5s - loss: 0.1403 - acc: 0.9556
448/753 [================>.............] - ETA: 4s - loss: 0.1447 - acc: 0.9545
480/753 [==================>...........] - ETA: 4s - loss: 0.1469 - acc: 0.9536
512/753 [===================>..........] - ETA: 3s - loss: 0.1435 - acc: 0.9556
544/753 [====================>.........] - ETA: 3s - loss: 0.1429 - acc: 0.9555
576/753 [=====================>........] - ETA: 2s - loss: 0.1438 - acc: 0.9557
608/753 [=======================>......] - ETA: 2s - loss: 0.1449 - acc: 0.9556
640/753 [========================>.....] - ETA: 1s - loss: 0.1425 - acc: 0.9560
672/753 [=========================>....] - ETA: 1s - loss: 0.1445 - acc: 0.9556
704/753 [===========================>..] - ETA: 0s - loss: 0.1436 - acc: 0.9561
736/753 [============================>.] - ETA: 0s - loss: 0.1414 - acc: 0.9568
753/753 [==============================] - 13s 17ms/step - loss: 0.1410 - acc: 0.9568 - val_loss: 0.1804 - val_acc: 0.9476
Epoch 9/70

 32/753 [>.............................] - ETA: 11s - loss: 0.2011 - acc: 0.9428
 64/753 [=>............................] - ETA: 11s - loss: 0.1666 - acc: 0.9512
 96/753 [==>...........................] - ETA: 10s - loss: 0.1509 - acc: 0.9544
128/753 [====>.........................] - ETA: 10s - loss: 0.1407 - acc: 0.9575
160/753 [=====>........................] - ETA: 9s - loss: 0.1440 - acc: 0.9555 
192/753 [======>.......................] - ETA: 9s - loss: 0.1470 - acc: 0.9558
224/753 [=======>......................] - ETA: 8s - loss: 0.1431 - acc: 0.9566
256/753 [=========>....................] - ETA: 8s - loss: 0.1381 - acc: 0.9576
288/753 [==========>...................] - ETA: 7s - loss: 0.1410 - acc: 0.9573
320/753 [===========>..................] - ETA: 7s - loss: 0.1363 - acc: 0.9583
352/753 [=============>................] - ETA: 6s - loss: 0.1339 - acc: 0.9593
384/753 [==============>...............] - ETA: 5s - loss: 0.1314 - acc: 0.9600
416/753 [===============>..............] - ETA: 5s - loss: 0.1356 - acc: 0.9592
448/753 [================>.............] - ETA: 4s - loss: 0.1330 - acc: 0.9601
480/753 [==================>...........] - ETA: 4s - loss: 0.1286 - acc: 0.9620
512/753 [===================>..........] - ETA: 3s - loss: 0.1283 - acc: 0.9617
544/753 [====================>.........] - ETA: 3s - loss: 0.1271 - acc: 0.9618
576/753 [=====================>........] - ETA: 2s - loss: 0.1298 - acc: 0.9607
608/753 [=======================>......] - ETA: 2s - loss: 0.1284 - acc: 0.9614
640/753 [========================>.....] - ETA: 1s - loss: 0.1301 - acc: 0.9613
672/753 [=========================>....] - ETA: 1s - loss: 0.1282 - acc: 0.9621
704/753 [===========================>..] - ETA: 0s - loss: 0.1291 - acc: 0.9616
736/753 [============================>.] - ETA: 0s - loss: 0.1279 - acc: 0.9617
753/753 [==============================] - 13s 17ms/step - loss: 0.1272 - acc: 0.9616 - val_loss: 0.1764 - val_acc: 0.9482
Epoch 10/70

 32/753 [>.............................] - ETA: 11s - loss: 0.1080 - acc: 0.9706
 64/753 [=>............................] - ETA: 11s - loss: 0.1011 - acc: 0.9734
 96/753 [==>...........................] - ETA: 10s - loss: 0.0943 - acc: 0.9774
128/753 [====>.........................] - ETA: 10s - loss: 0.1048 - acc: 0.9715
160/753 [=====>........................] - ETA: 9s - loss: 0.1095 - acc: 0.9711 
192/753 [======>.......................] - ETA: 9s - loss: 0.1081 - acc: 0.9716
224/753 [=======>......................] - ETA: 8s - loss: 0.1133 - acc: 0.9697
256/753 [=========>....................] - ETA: 8s - loss: 0.1145 - acc: 0.9684
288/753 [==========>...................] - ETA: 7s - loss: 0.1162 - acc: 0.9676
320/753 [===========>..................] - ETA: 7s - loss: 0.1153 - acc: 0.9673
352/753 [=============>................] - ETA: 6s - loss: 0.1174 - acc: 0.9662
384/753 [==============>...............] - ETA: 6s - loss: 0.1203 - acc: 0.9650
416/753 [===============>..............] - ETA: 5s - loss: 0.1195 - acc: 0.9649
448/753 [================>.............] - ETA: 4s - loss: 0.1190 - acc: 0.9654
480/753 [==================>...........] - ETA: 4s - loss: 0.1175 - acc: 0.9658
512/753 [===================>..........] - ETA: 3s - loss: 0.1157 - acc: 0.9658
544/753 [====================>.........] - ETA: 3s - loss: 0.1137 - acc: 0.9665
576/753 [=====================>........] - ETA: 2s - loss: 0.1143 - acc: 0.9658
608/753 [=======================>......] - ETA: 2s - loss: 0.1155 - acc: 0.9656
640/753 [========================>.....] - ETA: 1s - loss: 0.1150 - acc: 0.9658
672/753 [=========================>....] - ETA: 1s - loss: 0.1174 - acc: 0.9651
704/753 [===========================>..] - ETA: 0s - loss: 0.1152 - acc: 0.9656
736/753 [============================>.] - ETA: 0s - loss: 0.1150 - acc: 0.9659
753/753 [==============================] - 13s 17ms/step - loss: 0.1143 - acc: 0.9663 - val_loss: 0.1777 - val_acc: 0.9449
Epoch 11/70

 32/753 [>.............................] - ETA: 11s - loss: 0.0918 - acc: 0.9726
 64/753 [=>............................] - ETA: 11s - loss: 0.0997 - acc: 0.9657
 96/753 [==>...........................] - ETA: 10s - loss: 0.0939 - acc: 0.9677
128/753 [====>.........................] - ETA: 10s - loss: 0.0952 - acc: 0.9696
160/753 [=====>........................] - ETA: 9s - loss: 0.0908 - acc: 0.9722 
192/753 [======>.......................] - ETA: 9s - loss: 0.1004 - acc: 0.9705
224/753 [=======>......................] - ETA: 8s - loss: 0.1111 - acc: 0.9672
256/753 [=========>....................] - ETA: 8s - loss: 0.1084 - acc: 0.9684
288/753 [==========>...................] - ETA: 7s - loss: 0.1069 - acc: 0.9684
320/753 [===========>..................] - ETA: 7s - loss: 0.1099 - acc: 0.9672
352/753 [=============>................] - ETA: 6s - loss: 0.1073 - acc: 0.9680
384/753 [==============>...............] - ETA: 6s - loss: 0.1058 - acc: 0.9688
416/753 [===============>..............] - ETA: 5s - loss: 0.1080 - acc: 0.9682
448/753 [================>.............] - ETA: 4s - loss: 0.1112 - acc: 0.9667
480/753 [==================>...........] - ETA: 4s - loss: 0.1091 - acc: 0.9674
512/753 [===================>..........] - ETA: 3s - loss: 0.1083 - acc: 0.9675
544/753 [====================>.........] - ETA: 3s - loss: 0.1089 - acc: 0.9672
576/753 [=====================>........] - ETA: 2s - loss: 0.1061 - acc: 0.9683
608/753 [=======================>......] - ETA: 2s - loss: 0.1073 - acc: 0.9681
640/753 [========================>.....] - ETA: 1s - loss: 0.1069 - acc: 0.9680
672/753 [=========================>....] - ETA: 1s - loss: 0.1076 - acc: 0.9678
704/753 [===========================>..] - ETA: 0s - loss: 0.1059 - acc: 0.9685
736/753 [============================>.] - ETA: 0s - loss: 0.1051 - acc: 0.9687
753/753 [==============================] - 13s 17ms/step - loss: 0.1046 - acc: 0.9685 - val_loss: 0.1927 - val_acc: 0.9449
Computing...
Manual evaluation: (didn't understand why I made this)
True 8044
False 1027
True percentage 0.886782052695
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.91      0.76      0.83       438
          O       0.98      0.96      0.97      7318
      B-ORG       0.75      0.49      0.60       296
     B-MISC       0.27      0.33      0.30       141
      B-LOC       0.68      0.74      0.71       218
      I-LOC       0.67      0.73      0.70       141
     I-MISC       0.35      0.42      0.38       154
      I-PER       0.90      0.59      0.71       214
      I-ORG       0.57      0.31      0.40       151

avg / total       0.92      0.89      0.90      9071

F-1 Score:
0.908191508156
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 837 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100785 unique words.
Found 94 unique chars.
Found 9 unique labels.
781 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 253
OOV word occurences: 351
Padding...
Data padded!
Padding...
Data padded!
Padded until 67 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 67, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 67)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 67, 64)       6450304     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 67, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 67, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 67, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 67, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 67, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,953,410
Trainable params: 6,953,410
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 753 samples, validate on 84 samples
Epoch 1/70

 32/753 [>.............................] - ETA: 1:18 - loss: 2.1872 - acc: 0.0393
 64/753 [=>............................] - ETA: 43s - loss: 1.5682 - acc: 0.4123 
 96/753 [==>...........................] - ETA: 31s - loss: 1.4512 - acc: 0.5472
128/753 [====>.........................] - ETA: 25s - loss: 1.3721 - acc: 0.6054
160/753 [=====>........................] - ETA: 21s - loss: 1.2909 - acc: 0.6424
192/753 [======>.......................] - ETA: 18s - loss: 1.2222 - acc: 0.6637
224/753 [=======>......................] - ETA: 15s - loss: 1.1504 - acc: 0.6836
256/753 [=========>....................] - ETA: 14s - loss: 1.1079 - acc: 0.6936
288/753 [==========>...................] - ETA: 12s - loss: 1.0458 - acc: 0.7101
320/753 [===========>..................] - ETA: 11s - loss: 1.0072 - acc: 0.7186
352/753 [=============>................] - ETA: 10s - loss: 0.9717 - acc: 0.7274
384/753 [==============>...............] - ETA: 8s - loss: 0.9270 - acc: 0.7389 
416/753 [===============>..............] - ETA: 8s - loss: 0.9018 - acc: 0.7452
448/753 [================>.............] - ETA: 7s - loss: 0.8702 - acc: 0.7544
480/753 [==================>...........] - ETA: 6s - loss: 0.8520 - acc: 0.7579
512/753 [===================>..........] - ETA: 5s - loss: 0.8371 - acc: 0.7609
544/753 [====================>.........] - ETA: 4s - loss: 0.8273 - acc: 0.7625
576/753 [=====================>........] - ETA: 3s - loss: 0.8105 - acc: 0.7674
608/753 [=======================>......] - ETA: 3s - loss: 0.7949 - acc: 0.7710
640/753 [========================>.....] - ETA: 2s - loss: 0.7830 - acc: 0.7759
672/753 [=========================>....] - ETA: 1s - loss: 0.7698 - acc: 0.7784
704/753 [===========================>..] - ETA: 1s - loss: 0.7563 - acc: 0.7815
736/753 [============================>.] - ETA: 0s - loss: 0.7438 - acc: 0.7846
753/753 [==============================] - 16s 22ms/step - loss: 0.7364 - acc: 0.7864 - val_loss: 0.3856 - val_acc: 0.8839
Epoch 2/70

 32/753 [>.............................] - ETA: 11s - loss: 0.3949 - acc: 0.8598
 64/753 [=>............................] - ETA: 11s - loss: 0.4190 - acc: 0.8716
 96/753 [==>...........................] - ETA: 10s - loss: 0.4416 - acc: 0.8592
128/753 [====>.........................] - ETA: 10s - loss: 0.4164 - acc: 0.8670
160/753 [=====>........................] - ETA: 9s - loss: 0.4057 - acc: 0.8713 
192/753 [======>.......................] - ETA: 9s - loss: 0.4174 - acc: 0.8715
224/753 [=======>......................] - ETA: 8s - loss: 0.4106 - acc: 0.8750
256/753 [=========>....................] - ETA: 8s - loss: 0.4071 - acc: 0.8768
288/753 [==========>...................] - ETA: 7s - loss: 0.4155 - acc: 0.8734
320/753 [===========>..................] - ETA: 7s - loss: 0.4170 - acc: 0.8725
352/753 [=============>................] - ETA: 6s - loss: 0.4049 - acc: 0.8758
384/753 [==============>...............] - ETA: 6s - loss: 0.4001 - acc: 0.8766
416/753 [===============>..............] - ETA: 5s - loss: 0.4028 - acc: 0.8751
448/753 [================>.............] - ETA: 5s - loss: 0.3990 - acc: 0.8764
480/753 [==================>...........] - ETA: 4s - loss: 0.3902 - acc: 0.8790
512/753 [===================>..........] - ETA: 3s - loss: 0.3867 - acc: 0.8804
544/753 [====================>.........] - ETA: 3s - loss: 0.3825 - acc: 0.8809
576/753 [=====================>........] - ETA: 2s - loss: 0.3781 - acc: 0.8827
608/753 [=======================>......] - ETA: 2s - loss: 0.3738 - acc: 0.8843
640/753 [========================>.....] - ETA: 1s - loss: 0.3697 - acc: 0.8858
672/753 [=========================>....] - ETA: 1s - loss: 0.3681 - acc: 0.8854
704/753 [===========================>..] - ETA: 0s - loss: 0.3653 - acc: 0.8859
736/753 [============================>.] - ETA: 0s - loss: 0.3637 - acc: 0.8860
753/753 [==============================] - 13s 17ms/step - loss: 0.3645 - acc: 0.8858 - val_loss: 0.2616 - val_acc: 0.9329
Epoch 3/70

 32/753 [>.............................] - ETA: 12s - loss: 0.2620 - acc: 0.9092
 64/753 [=>............................] - ETA: 11s - loss: 0.2921 - acc: 0.9105
 96/753 [==>...........................] - ETA: 10s - loss: 0.2835 - acc: 0.9105
128/753 [====>.........................] - ETA: 10s - loss: 0.2852 - acc: 0.9095
160/753 [=====>........................] - ETA: 9s - loss: 0.2781 - acc: 0.9129 
192/753 [======>.......................] - ETA: 9s - loss: 0.2762 - acc: 0.9144
224/753 [=======>......................] - ETA: 8s - loss: 0.2693 - acc: 0.9176
256/753 [=========>....................] - ETA: 8s - loss: 0.2807 - acc: 0.9157
288/753 [==========>...................] - ETA: 7s - loss: 0.2859 - acc: 0.9136
320/753 [===========>..................] - ETA: 7s - loss: 0.2790 - acc: 0.9161
352/753 [=============>................] - ETA: 6s - loss: 0.2832 - acc: 0.9150
384/753 [==============>...............] - ETA: 6s - loss: 0.2802 - acc: 0.9160
416/753 [===============>..............] - ETA: 5s - loss: 0.2813 - acc: 0.9145
448/753 [================>.............] - ETA: 4s - loss: 0.2873 - acc: 0.9130
480/753 [==================>...........] - ETA: 4s - loss: 0.2876 - acc: 0.9123
512/753 [===================>..........] - ETA: 3s - loss: 0.2824 - acc: 0.9144
544/753 [====================>.........] - ETA: 3s - loss: 0.2831 - acc: 0.9132
576/753 [=====================>........] - ETA: 2s - loss: 0.2770 - acc: 0.9151
608/753 [=======================>......] - ETA: 2s - loss: 0.2773 - acc: 0.9148
640/753 [========================>.....] - ETA: 1s - loss: 0.2790 - acc: 0.9133
672/753 [=========================>....] - ETA: 1s - loss: 0.2765 - acc: 0.9139
704/753 [===========================>..] - ETA: 0s - loss: 0.2771 - acc: 0.9135
736/753 [============================>.] - ETA: 0s - loss: 0.2741 - acc: 0.9146
753/753 [==============================] - 13s 17ms/step - loss: 0.2751 - acc: 0.9147 - val_loss: 0.2226 - val_acc: 0.9354
Epoch 4/70

 32/753 [>.............................] - ETA: 11s - loss: 0.2512 - acc: 0.9250
 64/753 [=>............................] - ETA: 11s - loss: 0.2078 - acc: 0.9398
 96/753 [==>...........................] - ETA: 10s - loss: 0.2104 - acc: 0.9368
128/753 [====>.........................] - ETA: 10s - loss: 0.2120 - acc: 0.9379
160/753 [=====>........................] - ETA: 9s - loss: 0.2087 - acc: 0.9368 
192/753 [======>.......................] - ETA: 9s - loss: 0.2065 - acc: 0.9375
224/753 [=======>......................] - ETA: 8s - loss: 0.2246 - acc: 0.9323
256/753 [=========>....................] - ETA: 8s - loss: 0.2328 - acc: 0.9292
288/753 [==========>...................] - ETA: 7s - loss: 0.2408 - acc: 0.9255
320/753 [===========>..................] - ETA: 7s - loss: 0.2385 - acc: 0.9275
352/753 [=============>................] - ETA: 6s - loss: 0.2362 - acc: 0.9271
384/753 [==============>...............] - ETA: 6s - loss: 0.2444 - acc: 0.9242
416/753 [===============>..............] - ETA: 5s - loss: 0.2450 - acc: 0.9240
448/753 [================>.............] - ETA: 4s - loss: 0.2445 - acc: 0.9249
480/753 [==================>...........] - ETA: 4s - loss: 0.2383 - acc: 0.9269
512/753 [===================>..........] - ETA: 3s - loss: 0.2388 - acc: 0.9265
544/753 [====================>.........] - ETA: 3s - loss: 0.2430 - acc: 0.9243
576/753 [=====================>........] - ETA: 2s - loss: 0.2437 - acc: 0.9241
608/753 [=======================>......] - ETA: 2s - loss: 0.2418 - acc: 0.9250
640/753 [========================>.....] - ETA: 1s - loss: 0.2411 - acc: 0.9247
672/753 [=========================>....] - ETA: 1s - loss: 0.2385 - acc: 0.9253
704/753 [===========================>..] - ETA: 0s - loss: 0.2389 - acc: 0.9248
736/753 [============================>.] - ETA: 0s - loss: 0.2370 - acc: 0.9249
753/753 [==============================] - 13s 17ms/step - loss: 0.2360 - acc: 0.9255 - val_loss: 0.1967 - val_acc: 0.9453
Epoch 5/70

 32/753 [>.............................] - ETA: 11s - loss: 0.1730 - acc: 0.9423
 64/753 [=>............................] - ETA: 11s - loss: 0.1726 - acc: 0.9418
 96/753 [==>...........................] - ETA: 10s - loss: 0.1863 - acc: 0.9393
128/753 [====>.........................] - ETA: 10s - loss: 0.2135 - acc: 0.9283
160/753 [=====>........................] - ETA: 9s - loss: 0.2211 - acc: 0.9277 
192/753 [======>.......................] - ETA: 9s - loss: 0.2119 - acc: 0.9330
224/753 [=======>......................] - ETA: 8s - loss: 0.2085 - acc: 0.9334
256/753 [=========>....................] - ETA: 8s - loss: 0.2115 - acc: 0.9319
288/753 [==========>...................] - ETA: 7s - loss: 0.2106 - acc: 0.9329
320/753 [===========>..................] - ETA: 7s - loss: 0.2128 - acc: 0.9331
352/753 [=============>................] - ETA: 6s - loss: 0.2142 - acc: 0.9317
384/753 [==============>...............] - ETA: 6s - loss: 0.2176 - acc: 0.9315
416/753 [===============>..............] - ETA: 5s - loss: 0.2182 - acc: 0.9322
448/753 [================>.............] - ETA: 4s - loss: 0.2163 - acc: 0.9321
480/753 [==================>...........] - ETA: 4s - loss: 0.2121 - acc: 0.9334
512/753 [===================>..........] - ETA: 3s - loss: 0.2120 - acc: 0.9328
544/753 [====================>.........] - ETA: 3s - loss: 0.2102 - acc: 0.9334
576/753 [=====================>........] - ETA: 2s - loss: 0.2051 - acc: 0.9351
608/753 [=======================>......] - ETA: 2s - loss: 0.2084 - acc: 0.9345
640/753 [========================>.....] - ETA: 1s - loss: 0.2075 - acc: 0.9344
672/753 [=========================>....] - ETA: 1s - loss: 0.2061 - acc: 0.9352
704/753 [===========================>..] - ETA: 0s - loss: 0.2030 - acc: 0.9361
736/753 [============================>.] - ETA: 0s - loss: 0.2024 - acc: 0.9359
753/753 [==============================] - 13s 17ms/step - loss: 0.2019 - acc: 0.9358 - val_loss: 0.1998 - val_acc: 0.9452
Epoch 6/70

 32/753 [>.............................] - ETA: 11s - loss: 0.1748 - acc: 0.9448
 64/753 [=>............................] - ETA: 11s - loss: 0.1807 - acc: 0.9386
 96/753 [==>...........................] - ETA: 10s - loss: 0.1709 - acc: 0.9462
128/753 [====>.........................] - ETA: 10s - loss: 0.1724 - acc: 0.9480
160/753 [=====>........................] - ETA: 9s - loss: 0.1677 - acc: 0.9483 
192/753 [======>.......................] - ETA: 9s - loss: 0.1828 - acc: 0.9436
224/753 [=======>......................] - ETA: 8s - loss: 0.1865 - acc: 0.9420
256/753 [=========>....................] - ETA: 8s - loss: 0.1960 - acc: 0.9392
288/753 [==========>...................] - ETA: 7s - loss: 0.1934 - acc: 0.9411
320/753 [===========>..................] - ETA: 7s - loss: 0.1907 - acc: 0.9413
352/753 [=============>................] - ETA: 6s - loss: 0.1853 - acc: 0.9426
384/753 [==============>...............] - ETA: 6s - loss: 0.1842 - acc: 0.9436
416/753 [===============>..............] - ETA: 5s - loss: 0.1847 - acc: 0.9435
448/753 [================>.............] - ETA: 4s - loss: 0.1890 - acc: 0.9409
480/753 [==================>...........] - ETA: 4s - loss: 0.1864 - acc: 0.9418
512/753 [===================>..........] - ETA: 3s - loss: 0.1872 - acc: 0.9423
544/753 [====================>.........] - ETA: 3s - loss: 0.1860 - acc: 0.9423
576/753 [=====================>........] - ETA: 2s - loss: 0.1872 - acc: 0.9422
608/753 [=======================>......] - ETA: 2s - loss: 0.1869 - acc: 0.9427
640/753 [========================>.....] - ETA: 1s - loss: 0.1849 - acc: 0.9428
672/753 [=========================>....] - ETA: 1s - loss: 0.1837 - acc: 0.9433
704/753 [===========================>..] - ETA: 0s - loss: 0.1817 - acc: 0.9435
736/753 [============================>.] - ETA: 0s - loss: 0.1806 - acc: 0.9436
753/753 [==============================] - 13s 17ms/step - loss: 0.1807 - acc: 0.9438 - val_loss: 0.1781 - val_acc: 0.9499
Epoch 7/70

 32/753 [>.............................] - ETA: 11s - loss: 0.1278 - acc: 0.9574
 64/753 [=>............................] - ETA: 11s - loss: 0.1530 - acc: 0.9461
 96/753 [==>...........................] - ETA: 10s - loss: 0.1421 - acc: 0.9517
128/753 [====>.........................] - ETA: 10s - loss: 0.1392 - acc: 0.9550
160/753 [=====>........................] - ETA: 9s - loss: 0.1374 - acc: 0.9542 
192/753 [======>.......................] - ETA: 9s - loss: 0.1527 - acc: 0.9504
224/753 [=======>......................] - ETA: 8s - loss: 0.1607 - acc: 0.9481
256/753 [=========>....................] - ETA: 8s - loss: 0.1620 - acc: 0.9481
288/753 [==========>...................] - ETA: 7s - loss: 0.1634 - acc: 0.9480
320/753 [===========>..................] - ETA: 7s - loss: 0.1609 - acc: 0.9486
352/753 [=============>................] - ETA: 6s - loss: 0.1567 - acc: 0.9500
384/753 [==============>...............] - ETA: 5s - loss: 0.1585 - acc: 0.9492
416/753 [===============>..............] - ETA: 5s - loss: 0.1592 - acc: 0.9490
448/753 [================>.............] - ETA: 4s - loss: 0.1573 - acc: 0.9498
480/753 [==================>...........] - ETA: 4s - loss: 0.1553 - acc: 0.9508
512/753 [===================>..........] - ETA: 3s - loss: 0.1551 - acc: 0.9507
544/753 [====================>.........] - ETA: 3s - loss: 0.1541 - acc: 0.9511
576/753 [=====================>........] - ETA: 2s - loss: 0.1550 - acc: 0.9501
608/753 [=======================>......] - ETA: 2s - loss: 0.1543 - acc: 0.9506
640/753 [========================>.....] - ETA: 1s - loss: 0.1563 - acc: 0.9506
672/753 [=========================>....] - ETA: 1s - loss: 0.1558 - acc: 0.9506
704/753 [===========================>..] - ETA: 0s - loss: 0.1552 - acc: 0.9509
736/753 [============================>.] - ETA: 0s - loss: 0.1553 - acc: 0.9505
753/753 [==============================] - 13s 17ms/step - loss: 0.1565 - acc: 0.9501 - val_loss: 0.1893 - val_acc: 0.9469
Epoch 8/70

 32/753 [>.............................] - ETA: 11s - loss: 0.1381 - acc: 0.9527
 64/753 [=>............................] - ETA: 11s - loss: 0.1456 - acc: 0.9524
 96/753 [==>...........................] - ETA: 10s - loss: 0.1466 - acc: 0.9526
128/753 [====>.........................] - ETA: 10s - loss: 0.1392 - acc: 0.9548
160/753 [=====>........................] - ETA: 9s - loss: 0.1430 - acc: 0.9544 
192/753 [======>.......................] - ETA: 9s - loss: 0.1458 - acc: 0.9551
224/753 [=======>......................] - ETA: 8s - loss: 0.1443 - acc: 0.9548
256/753 [=========>....................] - ETA: 8s - loss: 0.1440 - acc: 0.9556
288/753 [==========>...................] - ETA: 7s - loss: 0.1457 - acc: 0.9553
320/753 [===========>..................] - ETA: 7s - loss: 0.1412 - acc: 0.9571
352/753 [=============>................] - ETA: 6s - loss: 0.1411 - acc: 0.9563
384/753 [==============>...............] - ETA: 6s - loss: 0.1406 - acc: 0.9565
416/753 [===============>..............] - ETA: 5s - loss: 0.1393 - acc: 0.9567
448/753 [================>.............] - ETA: 4s - loss: 0.1401 - acc: 0.9567
480/753 [==================>...........] - ETA: 4s - loss: 0.1402 - acc: 0.9562
512/753 [===================>..........] - ETA: 3s - loss: 0.1394 - acc: 0.9566
544/753 [====================>.........] - ETA: 3s - loss: 0.1416 - acc: 0.9558
576/753 [=====================>........] - ETA: 2s - loss: 0.1429 - acc: 0.9554
608/753 [=======================>......] - ETA: 2s - loss: 0.1423 - acc: 0.9556
640/753 [========================>.....] - ETA: 1s - loss: 0.1416 - acc: 0.9561
672/753 [=========================>....] - ETA: 1s - loss: 0.1419 - acc: 0.9559
704/753 [===========================>..] - ETA: 0s - loss: 0.1406 - acc: 0.9561
736/753 [============================>.] - ETA: 0s - loss: 0.1436 - acc: 0.9552
753/753 [==============================] - 13s 17ms/step - loss: 0.1429 - acc: 0.9554 - val_loss: 0.1882 - val_acc: 0.9485
Computing...
Manual evaluation: (didn't understand why I made this)
True 8085
False 986
True percentage 0.891301951273
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.92      0.74      0.82       438
          O       0.99      0.95      0.97      7318
      B-LOC       0.74      0.63      0.68       218
      I-LOC       0.79      0.66      0.72       141
      I-PER       0.85      0.57      0.68       214
      B-ORG       0.59      0.76      0.67       296
      I-ORG       0.43      0.72      0.54       151
     B-MISC       0.44      0.29      0.35       141
     I-MISC       0.46      0.33      0.38       154

avg / total       0.93      0.89      0.91      9071

F-1 Score:
0.913132976534
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 837 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100820 unique words.
Found 94 unique chars.
Found 9 unique labels.
816 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 252
OOV word occurences: 360
Padding...
Data padded!
Padding...
Data padded!
Padded until 83 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6452544     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,955,650
Trainable params: 6,955,650
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 753 samples, validate on 84 samples
Epoch 1/70

 32/753 [>.............................] - ETA: 1:11 - loss: 1.8716 - acc: 0.7878
 64/753 [=>............................] - ETA: 41s - loss: 1.3963 - acc: 0.7878 
 96/753 [==>...........................] - ETA: 31s - loss: 1.2289 - acc: 0.8062
128/753 [====>.........................] - ETA: 25s - loss: 1.2644 - acc: 0.8011
160/753 [=====>........................] - ETA: 21s - loss: 1.1940 - acc: 0.8013
192/753 [======>.......................] - ETA: 19s - loss: 1.1235 - acc: 0.8009
224/753 [=======>......................] - ETA: 17s - loss: 1.0627 - acc: 0.8024
256/753 [=========>....................] - ETA: 15s - loss: 1.0090 - acc: 0.8050
288/753 [==========>...................] - ETA: 13s - loss: 0.9724 - acc: 0.8035
320/753 [===========>..................] - ETA: 12s - loss: 0.9362 - acc: 0.8057
352/753 [=============>................] - ETA: 11s - loss: 0.8915 - acc: 0.8110
384/753 [==============>...............] - ETA: 10s - loss: 0.8643 - acc: 0.8126
416/753 [===============>..............] - ETA: 8s - loss: 0.8436 - acc: 0.8141 
448/753 [================>.............] - ETA: 7s - loss: 0.8239 - acc: 0.8140
480/753 [==================>...........] - ETA: 7s - loss: 0.8015 - acc: 0.8174
512/753 [===================>..........] - ETA: 6s - loss: 0.7877 - acc: 0.8171
544/753 [====================>.........] - ETA: 5s - loss: 0.7704 - acc: 0.8200
576/753 [=====================>........] - ETA: 4s - loss: 0.7572 - acc: 0.8201
608/753 [=======================>......] - ETA: 3s - loss: 0.7478 - acc: 0.8213
640/753 [========================>.....] - ETA: 2s - loss: 0.7330 - acc: 0.8225
672/753 [=========================>....] - ETA: 1s - loss: 0.7242 - acc: 0.8231
704/753 [===========================>..] - ETA: 1s - loss: 0.7117 - acc: 0.8251
736/753 [============================>.] - ETA: 0s - loss: 0.6972 - acc: 0.8274
753/753 [==============================] - 19s 25ms/step - loss: 0.6911 - acc: 0.8284 - val_loss: 0.3790 - val_acc: 0.8692
Epoch 2/70

 32/753 [>.............................] - ETA: 13s - loss: 0.4474 - acc: 0.8524
 64/753 [=>............................] - ETA: 13s - loss: 0.4302 - acc: 0.8648
 96/753 [==>...........................] - ETA: 12s - loss: 0.4148 - acc: 0.8683
128/753 [====>.........................] - ETA: 12s - loss: 0.4006 - acc: 0.8747
160/753 [=====>........................] - ETA: 11s - loss: 0.3808 - acc: 0.8775
192/753 [======>.......................] - ETA: 10s - loss: 0.3753 - acc: 0.8780
224/753 [=======>......................] - ETA: 10s - loss: 0.3610 - acc: 0.8841
256/753 [=========>....................] - ETA: 9s - loss: 0.3634 - acc: 0.8834 
288/753 [==========>...................] - ETA: 8s - loss: 0.3607 - acc: 0.8852
320/753 [===========>..................] - ETA: 8s - loss: 0.3558 - acc: 0.8878
352/753 [=============>................] - ETA: 7s - loss: 0.3545 - acc: 0.8886
384/753 [==============>...............] - ETA: 7s - loss: 0.3518 - acc: 0.8896
416/753 [===============>..............] - ETA: 6s - loss: 0.3489 - acc: 0.8900
448/753 [================>.............] - ETA: 5s - loss: 0.3470 - acc: 0.8907
480/753 [==================>...........] - ETA: 5s - loss: 0.3453 - acc: 0.8915
512/753 [===================>..........] - ETA: 4s - loss: 0.3397 - acc: 0.8935
544/753 [====================>.........] - ETA: 4s - loss: 0.3389 - acc: 0.8936
576/753 [=====================>........] - ETA: 3s - loss: 0.3366 - acc: 0.8947
608/753 [=======================>......] - ETA: 2s - loss: 0.3319 - acc: 0.8958
640/753 [========================>.....] - ETA: 2s - loss: 0.3295 - acc: 0.8969
672/753 [=========================>....] - ETA: 1s - loss: 0.3332 - acc: 0.8964
704/753 [===========================>..] - ETA: 0s - loss: 0.3364 - acc: 0.8959
736/753 [============================>.] - ETA: 0s - loss: 0.3348 - acc: 0.8960
753/753 [==============================] - 15s 20ms/step - loss: 0.3337 - acc: 0.8966 - val_loss: 0.2435 - val_acc: 0.9295
Epoch 3/70

 32/753 [>.............................] - ETA: 13s - loss: 0.2604 - acc: 0.9235
 64/753 [=>............................] - ETA: 13s - loss: 0.2620 - acc: 0.9206
 96/753 [==>...........................] - ETA: 12s - loss: 0.2476 - acc: 0.9217
128/753 [====>.........................] - ETA: 11s - loss: 0.2702 - acc: 0.9094
160/753 [=====>........................] - ETA: 11s - loss: 0.2623 - acc: 0.9134
192/753 [======>.......................] - ETA: 10s - loss: 0.2595 - acc: 0.9168
224/753 [=======>......................] - ETA: 10s - loss: 0.2563 - acc: 0.9196
256/753 [=========>....................] - ETA: 9s - loss: 0.2635 - acc: 0.9165 
288/753 [==========>...................] - ETA: 8s - loss: 0.2610 - acc: 0.9186
320/753 [===========>..................] - ETA: 8s - loss: 0.2550 - acc: 0.9196
352/753 [=============>................] - ETA: 7s - loss: 0.2588 - acc: 0.9175
384/753 [==============>...............] - ETA: 7s - loss: 0.2569 - acc: 0.9185
416/753 [===============>..............] - ETA: 6s - loss: 0.2528 - acc: 0.9190
448/753 [================>.............] - ETA: 5s - loss: 0.2518 - acc: 0.9201
480/753 [==================>...........] - ETA: 5s - loss: 0.2494 - acc: 0.9211
512/753 [===================>..........] - ETA: 4s - loss: 0.2546 - acc: 0.9193
544/753 [====================>.........] - ETA: 3s - loss: 0.2551 - acc: 0.9193
576/753 [=====================>........] - ETA: 3s - loss: 0.2536 - acc: 0.9197
608/753 [=======================>......] - ETA: 2s - loss: 0.2539 - acc: 0.9199
640/753 [========================>.....] - ETA: 2s - loss: 0.2544 - acc: 0.9204
672/753 [=========================>....] - ETA: 1s - loss: 0.2493 - acc: 0.9221
704/753 [===========================>..] - ETA: 0s - loss: 0.2496 - acc: 0.9224
736/753 [============================>.] - ETA: 0s - loss: 0.2484 - acc: 0.9229
753/753 [==============================] - 15s 20ms/step - loss: 0.2491 - acc: 0.9224 - val_loss: 0.2146 - val_acc: 0.9312
Epoch 4/70

 32/753 [>.............................] - ETA: 13s - loss: 0.2317 - acc: 0.9198
 64/753 [=>............................] - ETA: 13s - loss: 0.2067 - acc: 0.9330
 96/753 [==>...........................] - ETA: 12s - loss: 0.2002 - acc: 0.9355
128/753 [====>.........................] - ETA: 11s - loss: 0.1887 - acc: 0.9402
160/753 [=====>........................] - ETA: 11s - loss: 0.1855 - acc: 0.9422
192/753 [======>.......................] - ETA: 10s - loss: 0.1896 - acc: 0.9409
224/753 [=======>......................] - ETA: 10s - loss: 0.1944 - acc: 0.9396
256/753 [=========>....................] - ETA: 9s - loss: 0.1952 - acc: 0.9398 
288/753 [==========>...................] - ETA: 8s - loss: 0.2004 - acc: 0.9369
320/753 [===========>..................] - ETA: 8s - loss: 0.2121 - acc: 0.9339
352/753 [=============>................] - ETA: 7s - loss: 0.2108 - acc: 0.9343
384/753 [==============>...............] - ETA: 7s - loss: 0.2126 - acc: 0.9335
416/753 [===============>..............] - ETA: 6s - loss: 0.2112 - acc: 0.9341
448/753 [================>.............] - ETA: 5s - loss: 0.2103 - acc: 0.9337
480/753 [==================>...........] - ETA: 5s - loss: 0.2096 - acc: 0.9340
512/753 [===================>..........] - ETA: 4s - loss: 0.2129 - acc: 0.9329
544/753 [====================>.........] - ETA: 3s - loss: 0.2127 - acc: 0.9329
576/753 [=====================>........] - ETA: 3s - loss: 0.2099 - acc: 0.9341
608/753 [=======================>......] - ETA: 2s - loss: 0.2124 - acc: 0.9329
640/753 [========================>.....] - ETA: 2s - loss: 0.2097 - acc: 0.9341
672/753 [=========================>....] - ETA: 1s - loss: 0.2076 - acc: 0.9352
704/753 [===========================>..] - ETA: 0s - loss: 0.2076 - acc: 0.9346
736/753 [============================>.] - ETA: 0s - loss: 0.2109 - acc: 0.9335
753/753 [==============================] - 15s 20ms/step - loss: 0.2111 - acc: 0.9337 - val_loss: 0.1921 - val_acc: 0.9391
Epoch 5/70

 32/753 [>.............................] - ETA: 13s - loss: 0.1589 - acc: 0.9491
 64/753 [=>............................] - ETA: 12s - loss: 0.1841 - acc: 0.9334
 96/753 [==>...........................] - ETA: 12s - loss: 0.2058 - acc: 0.9259
128/753 [====>.........................] - ETA: 11s - loss: 0.2084 - acc: 0.9292
160/753 [=====>........................] - ETA: 11s - loss: 0.2076 - acc: 0.9311
192/753 [======>.......................] - ETA: 10s - loss: 0.1945 - acc: 0.9368
224/753 [=======>......................] - ETA: 9s - loss: 0.1908 - acc: 0.9372 
256/753 [=========>....................] - ETA: 9s - loss: 0.1948 - acc: 0.9354
288/753 [==========>...................] - ETA: 8s - loss: 0.1883 - acc: 0.9385
320/753 [===========>..................] - ETA: 8s - loss: 0.1867 - acc: 0.9397
352/753 [=============>................] - ETA: 7s - loss: 0.1854 - acc: 0.9394
384/753 [==============>...............] - ETA: 6s - loss: 0.1835 - acc: 0.9408
416/753 [===============>..............] - ETA: 6s - loss: 0.1821 - acc: 0.9414
448/753 [================>.............] - ETA: 5s - loss: 0.1788 - acc: 0.9429
480/753 [==================>...........] - ETA: 5s - loss: 0.1788 - acc: 0.9430
512/753 [===================>..........] - ETA: 4s - loss: 0.1766 - acc: 0.9435
544/753 [====================>.........] - ETA: 3s - loss: 0.1776 - acc: 0.9435
576/753 [=====================>........] - ETA: 3s - loss: 0.1757 - acc: 0.9440
608/753 [=======================>......] - ETA: 2s - loss: 0.1756 - acc: 0.9444
640/753 [========================>.....] - ETA: 2s - loss: 0.1724 - acc: 0.9453
672/753 [=========================>....] - ETA: 1s - loss: 0.1710 - acc: 0.9459
704/753 [===========================>..] - ETA: 0s - loss: 0.1748 - acc: 0.9446
736/753 [============================>.] - ETA: 0s - loss: 0.1769 - acc: 0.9440
753/753 [==============================] - 15s 20ms/step - loss: 0.1773 - acc: 0.9437 - val_loss: 0.1694 - val_acc: 0.9425
Epoch 6/70

 32/753 [>.............................] - ETA: 13s - loss: 0.0920 - acc: 0.9722
 64/753 [=>............................] - ETA: 13s - loss: 0.1301 - acc: 0.9606
 96/753 [==>...........................] - ETA: 12s - loss: 0.1408 - acc: 0.9554
128/753 [====>.........................] - ETA: 11s - loss: 0.1416 - acc: 0.9545
160/753 [=====>........................] - ETA: 11s - loss: 0.1556 - acc: 0.9518
192/753 [======>.......................] - ETA: 10s - loss: 0.1553 - acc: 0.9515
224/753 [=======>......................] - ETA: 10s - loss: 0.1565 - acc: 0.9503
256/753 [=========>....................] - ETA: 9s - loss: 0.1629 - acc: 0.9470 
288/753 [==========>...................] - ETA: 8s - loss: 0.1630 - acc: 0.9476
320/753 [===========>..................] - ETA: 8s - loss: 0.1593 - acc: 0.9484
352/753 [=============>................] - ETA: 7s - loss: 0.1606 - acc: 0.9478
384/753 [==============>...............] - ETA: 6s - loss: 0.1646 - acc: 0.9467
416/753 [===============>..............] - ETA: 6s - loss: 0.1661 - acc: 0.9454
448/753 [================>.............] - ETA: 5s - loss: 0.1680 - acc: 0.9458
480/753 [==================>...........] - ETA: 5s - loss: 0.1685 - acc: 0.9455
512/753 [===================>..........] - ETA: 4s - loss: 0.1707 - acc: 0.9448
544/753 [====================>.........] - ETA: 3s - loss: 0.1684 - acc: 0.9450
576/753 [=====================>........] - ETA: 3s - loss: 0.1693 - acc: 0.9445
608/753 [=======================>......] - ETA: 2s - loss: 0.1673 - acc: 0.9455
640/753 [========================>.....] - ETA: 2s - loss: 0.1689 - acc: 0.9451
672/753 [=========================>....] - ETA: 1s - loss: 0.1661 - acc: 0.9462
704/753 [===========================>..] - ETA: 0s - loss: 0.1640 - acc: 0.9474
736/753 [============================>.] - ETA: 0s - loss: 0.1641 - acc: 0.9471
753/753 [==============================] - 15s 20ms/step - loss: 0.1621 - acc: 0.9478 - val_loss: 0.1584 - val_acc: 0.9486
Epoch 7/70

 32/753 [>.............................] - ETA: 14s - loss: 0.1260 - acc: 0.9655
 64/753 [=>............................] - ETA: 13s - loss: 0.1406 - acc: 0.9610
 96/753 [==>...........................] - ETA: 12s - loss: 0.1477 - acc: 0.9594
128/753 [====>.........................] - ETA: 11s - loss: 0.1518 - acc: 0.9575
160/753 [=====>........................] - ETA: 11s - loss: 0.1459 - acc: 0.9591
192/753 [======>.......................] - ETA: 10s - loss: 0.1530 - acc: 0.9559
224/753 [=======>......................] - ETA: 10s - loss: 0.1469 - acc: 0.9560
256/753 [=========>....................] - ETA: 9s - loss: 0.1524 - acc: 0.9536 
288/753 [==========>...................] - ETA: 8s - loss: 0.1517 - acc: 0.9548
320/753 [===========>..................] - ETA: 8s - loss: 0.1498 - acc: 0.9546
352/753 [=============>................] - ETA: 7s - loss: 0.1489 - acc: 0.9541
384/753 [==============>...............] - ETA: 7s - loss: 0.1479 - acc: 0.9544
416/753 [===============>..............] - ETA: 6s - loss: 0.1467 - acc: 0.9543
448/753 [================>.............] - ETA: 5s - loss: 0.1451 - acc: 0.9547
480/753 [==================>...........] - ETA: 5s - loss: 0.1441 - acc: 0.9551
512/753 [===================>..........] - ETA: 4s - loss: 0.1443 - acc: 0.9554
544/753 [====================>.........] - ETA: 3s - loss: 0.1458 - acc: 0.9543
576/753 [=====================>........] - ETA: 3s - loss: 0.1476 - acc: 0.9540
608/753 [=======================>......] - ETA: 2s - loss: 0.1480 - acc: 0.9542
640/753 [========================>.....] - ETA: 2s - loss: 0.1472 - acc: 0.9543
672/753 [=========================>....] - ETA: 1s - loss: 0.1472 - acc: 0.9545
704/753 [===========================>..] - ETA: 0s - loss: 0.1453 - acc: 0.9552
736/753 [============================>.] - ETA: 0s - loss: 0.1450 - acc: 0.9552
753/753 [==============================] - 15s 20ms/step - loss: 0.1458 - acc: 0.9549 - val_loss: 0.1545 - val_acc: 0.9461
Epoch 8/70

 32/753 [>.............................] - ETA: 13s - loss: 0.0972 - acc: 0.9686
 64/753 [=>............................] - ETA: 13s - loss: 0.1236 - acc: 0.9594
 96/753 [==>...........................] - ETA: 12s - loss: 0.1149 - acc: 0.9635
128/753 [====>.........................] - ETA: 11s - loss: 0.1179 - acc: 0.9631
160/753 [=====>........................] - ETA: 11s - loss: 0.1330 - acc: 0.9566
192/753 [======>.......................] - ETA: 10s - loss: 0.1314 - acc: 0.9570
224/753 [=======>......................] - ETA: 10s - loss: 0.1281 - acc: 0.9573
256/753 [=========>....................] - ETA: 9s - loss: 0.1303 - acc: 0.9564 
288/753 [==========>...................] - ETA: 8s - loss: 0.1351 - acc: 0.9557
320/753 [===========>..................] - ETA: 8s - loss: 0.1413 - acc: 0.9535
352/753 [=============>................] - ETA: 7s - loss: 0.1387 - acc: 0.9548
384/753 [==============>...............] - ETA: 7s - loss: 0.1388 - acc: 0.9549
416/753 [===============>..............] - ETA: 6s - loss: 0.1350 - acc: 0.9569
448/753 [================>.............] - ETA: 5s - loss: 0.1321 - acc: 0.9576
480/753 [==================>...........] - ETA: 5s - loss: 0.1309 - acc: 0.9579
512/753 [===================>..........] - ETA: 4s - loss: 0.1318 - acc: 0.9580
544/753 [====================>.........] - ETA: 3s - loss: 0.1338 - acc: 0.9577
576/753 [=====================>........] - ETA: 3s - loss: 0.1346 - acc: 0.9577
608/753 [=======================>......] - ETA: 2s - loss: 0.1326 - acc: 0.9586
640/753 [========================>.....] - ETA: 2s - loss: 0.1312 - acc: 0.9591
672/753 [=========================>....] - ETA: 1s - loss: 0.1325 - acc: 0.9590
704/753 [===========================>..] - ETA: 0s - loss: 0.1312 - acc: 0.9594
736/753 [============================>.] - ETA: 0s - loss: 0.1312 - acc: 0.9593
753/753 [==============================] - 15s 20ms/step - loss: 0.1331 - acc: 0.9585 - val_loss: 0.1688 - val_acc: 0.9402
Epoch 9/70

 32/753 [>.............................] - ETA: 13s - loss: 0.2089 - acc: 0.9187
 64/753 [=>............................] - ETA: 13s - loss: 0.1625 - acc: 0.9432
 96/753 [==>...........................] - ETA: 12s - loss: 0.1464 - acc: 0.9463
128/753 [====>.........................] - ETA: 11s - loss: 0.1433 - acc: 0.9479
160/753 [=====>........................] - ETA: 11s - loss: 0.1368 - acc: 0.9499
192/753 [======>.......................] - ETA: 10s - loss: 0.1332 - acc: 0.9527
224/753 [=======>......................] - ETA: 10s - loss: 0.1327 - acc: 0.9529
256/753 [=========>....................] - ETA: 9s - loss: 0.1268 - acc: 0.9557 
288/753 [==========>...................] - ETA: 8s - loss: 0.1275 - acc: 0.9571
320/753 [===========>..................] - ETA: 8s - loss: 0.1276 - acc: 0.9570
352/753 [=============>................] - ETA: 7s - loss: 0.1280 - acc: 0.9559
384/753 [==============>...............] - ETA: 7s - loss: 0.1255 - acc: 0.9579
416/753 [===============>..............] - ETA: 6s - loss: 0.1216 - acc: 0.9592
448/753 [================>.............] - ETA: 5s - loss: 0.1216 - acc: 0.9593
480/753 [==================>...........] - ETA: 5s - loss: 0.1226 - acc: 0.9589
512/753 [===================>..........] - ETA: 4s - loss: 0.1212 - acc: 0.9594
544/753 [====================>.........] - ETA: 3s - loss: 0.1177 - acc: 0.9608
576/753 [=====================>........] - ETA: 3s - loss: 0.1178 - acc: 0.9608
608/753 [=======================>......] - ETA: 2s - loss: 0.1160 - acc: 0.9618
640/753 [========================>.....] - ETA: 2s - loss: 0.1187 - acc: 0.9610
672/753 [=========================>....] - ETA: 1s - loss: 0.1195 - acc: 0.9608
704/753 [===========================>..] - ETA: 0s - loss: 0.1212 - acc: 0.9609
736/753 [============================>.] - ETA: 0s - loss: 0.1216 - acc: 0.9608
753/753 [==============================] - 15s 20ms/step - loss: 0.1201 - acc: 0.9614 - val_loss: 0.1400 - val_acc: 0.9551
Epoch 10/70

 32/753 [>.............................] - ETA: 13s - loss: 0.1081 - acc: 0.9684
 64/753 [=>............................] - ETA: 13s - loss: 0.1075 - acc: 0.9654
 96/753 [==>...........................] - ETA: 12s - loss: 0.0979 - acc: 0.9694
128/753 [====>.........................] - ETA: 11s - loss: 0.0976 - acc: 0.9698
160/753 [=====>........................] - ETA: 11s - loss: 0.1031 - acc: 0.9674
192/753 [======>.......................] - ETA: 10s - loss: 0.1030 - acc: 0.9676
224/753 [=======>......................] - ETA: 10s - loss: 0.1051 - acc: 0.9657
256/753 [=========>....................] - ETA: 9s - loss: 0.1090 - acc: 0.9658 
288/753 [==========>...................] - ETA: 8s - loss: 0.1120 - acc: 0.9649
320/753 [===========>..................] - ETA: 8s - loss: 0.1104 - acc: 0.9649
352/753 [=============>................] - ETA: 7s - loss: 0.1069 - acc: 0.9661
384/753 [==============>...............] - ETA: 6s - loss: 0.1096 - acc: 0.9654
416/753 [===============>..............] - ETA: 6s - loss: 0.1091 - acc: 0.9658
448/753 [================>.............] - ETA: 5s - loss: 0.1105 - acc: 0.9652
480/753 [==================>...........] - ETA: 5s - loss: 0.1138 - acc: 0.9640
512/753 [===================>..........] - ETA: 4s - loss: 0.1134 - acc: 0.9644
544/753 [====================>.........] - ETA: 3s - loss: 0.1124 - acc: 0.9649
576/753 [=====================>........] - ETA: 3s - loss: 0.1127 - acc: 0.9649
608/753 [=======================>......] - ETA: 2s - loss: 0.1126 - acc: 0.9644
640/753 [========================>.....] - ETA: 2s - loss: 0.1116 - acc: 0.9649
672/753 [=========================>....] - ETA: 1s - loss: 0.1120 - acc: 0.9642
704/753 [===========================>..] - ETA: 0s - loss: 0.1119 - acc: 0.9645
736/753 [============================>.] - ETA: 0s - loss: 0.1120 - acc: 0.9641
753/753 [==============================] - 15s 20ms/step - loss: 0.1103 - acc: 0.9648 - val_loss: 0.1364 - val_acc: 0.9563
Epoch 11/70

 32/753 [>.............................] - ETA: 13s - loss: 0.1119 - acc: 0.9619
 64/753 [=>............................] - ETA: 13s - loss: 0.0972 - acc: 0.9687
 96/753 [==>...........................] - ETA: 12s - loss: 0.0918 - acc: 0.9717
128/753 [====>.........................] - ETA: 11s - loss: 0.0966 - acc: 0.9690
160/753 [=====>........................] - ETA: 11s - loss: 0.0972 - acc: 0.9697
192/753 [======>.......................] - ETA: 10s - loss: 0.0924 - acc: 0.9724
224/753 [=======>......................] - ETA: 10s - loss: 0.0975 - acc: 0.9702
256/753 [=========>....................] - ETA: 9s - loss: 0.0931 - acc: 0.9710 
288/753 [==========>...................] - ETA: 8s - loss: 0.0953 - acc: 0.9708
320/753 [===========>..................] - ETA: 8s - loss: 0.0983 - acc: 0.9700
352/753 [=============>................] - ETA: 7s - loss: 0.0949 - acc: 0.9711
384/753 [==============>...............] - ETA: 6s - loss: 0.0941 - acc: 0.9717
416/753 [===============>..............] - ETA: 6s - loss: 0.0938 - acc: 0.9718
448/753 [================>.............] - ETA: 5s - loss: 0.0931 - acc: 0.9716
480/753 [==================>...........] - ETA: 5s - loss: 0.0935 - acc: 0.9718
512/753 [===================>..........] - ETA: 4s - loss: 0.0990 - acc: 0.9696
544/753 [====================>.........] - ETA: 3s - loss: 0.1011 - acc: 0.9689
576/753 [=====================>........] - ETA: 3s - loss: 0.0993 - acc: 0.9695
608/753 [=======================>......] - ETA: 2s - loss: 0.0971 - acc: 0.9702
640/753 [========================>.....] - ETA: 2s - loss: 0.0980 - acc: 0.9697
672/753 [=========================>....] - ETA: 1s - loss: 0.0993 - acc: 0.9694
704/753 [===========================>..] - ETA: 0s - loss: 0.1013 - acc: 0.9684
736/753 [============================>.] - ETA: 0s - loss: 0.1014 - acc: 0.9686
753/753 [==============================] - 15s 20ms/step - loss: 0.1021 - acc: 0.9686 - val_loss: 0.1385 - val_acc: 0.9599
Epoch 12/70

 32/753 [>.............................] - ETA: 13s - loss: 0.0865 - acc: 0.9760
 64/753 [=>............................] - ETA: 13s - loss: 0.0772 - acc: 0.9773
 96/753 [==>...........................] - ETA: 12s - loss: 0.0973 - acc: 0.9691
128/753 [====>.........................] - ETA: 11s - loss: 0.0894 - acc: 0.9719
160/753 [=====>........................] - ETA: 11s - loss: 0.0856 - acc: 0.9745
192/753 [======>.......................] - ETA: 10s - loss: 0.0822 - acc: 0.9758
224/753 [=======>......................] - ETA: 10s - loss: 0.0813 - acc: 0.9748
256/753 [=========>....................] - ETA: 9s - loss: 0.0808 - acc: 0.9752 
288/753 [==========>...................] - ETA: 8s - loss: 0.0800 - acc: 0.9758
320/753 [===========>..................] - ETA: 8s - loss: 0.0808 - acc: 0.9741
352/753 [=============>................] - ETA: 7s - loss: 0.0844 - acc: 0.9726
384/753 [==============>...............] - ETA: 6s - loss: 0.0859 - acc: 0.9720
416/753 [===============>..............] - ETA: 6s - loss: 0.0890 - acc: 0.9711
448/753 [================>.............] - ETA: 5s - loss: 0.0914 - acc: 0.9705
480/753 [==================>...........] - ETA: 5s - loss: 0.0967 - acc: 0.9695
512/753 [===================>..........] - ETA: 4s - loss: 0.0948 - acc: 0.9705
544/753 [====================>.........] - ETA: 3s - loss: 0.0934 - acc: 0.9710
576/753 [=====================>........] - ETA: 3s - loss: 0.0942 - acc: 0.9708
608/753 [=======================>......] - ETA: 2s - loss: 0.0940 - acc: 0.9709
640/753 [========================>.....] - ETA: 2s - loss: 0.0924 - acc: 0.9716
672/753 [=========================>....] - ETA: 1s - loss: 0.0932 - acc: 0.9715
704/753 [===========================>..] - ETA: 0s - loss: 0.0949 - acc: 0.9704
736/753 [============================>.] - ETA: 0s - loss: 0.0956 - acc: 0.9703
753/753 [==============================] - 15s 20ms/step - loss: 0.0947 - acc: 0.9707 - val_loss: 0.1371 - val_acc: 0.9550
Computing...
Manual evaluation: (didn't understand why I made this)
True 8146
False 925
True percentage 0.898026678426
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.96      0.97      7318
      B-ORG       0.77      0.62      0.69       296
     B-MISC       0.40      0.32      0.36       141
     I-MISC       0.56      0.37      0.45       154
      B-PER       0.88      0.80      0.84       438
      B-LOC       0.74      0.68      0.71       218
      I-ORG       0.56      0.56      0.56       151
      I-PER       0.88      0.63      0.73       214
      I-LOC       0.83      0.71      0.77       141

avg / total       0.93      0.90      0.91      9071

F-1 Score:
0.683591331269
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 837 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100804 unique words.
Found 94 unique chars.
Found 9 unique labels.
800 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 258
OOV word occurences: 365
Padding...
Data padded!
Padding...
Data padded!
Padded until 63 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 63 tokens.
Padded until 24 chars.
Padded until 63 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 63, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 63)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 63, 64)       6451520     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 63, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 63, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 63, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 63, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 63, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,954,626
Trainable params: 6,954,626
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 753 samples, validate on 84 samples
Epoch 1/70

 32/753 [>.............................] - ETA: 1:02 - loss: 2.2313 - acc: 0.1029
 64/753 [=>............................] - ETA: 35s - loss: 1.5534 - acc: 0.4501 
 96/753 [==>...........................] - ETA: 26s - loss: 1.3773 - acc: 0.5695
128/753 [====>.........................] - ETA: 21s - loss: 1.5048 - acc: 0.6159
160/753 [=====>........................] - ETA: 17s - loss: 1.4149 - acc: 0.6452
192/753 [======>.......................] - ETA: 15s - loss: 1.3040 - acc: 0.6710
224/753 [=======>......................] - ETA: 13s - loss: 1.2246 - acc: 0.6879
256/753 [=========>....................] - ETA: 12s - loss: 1.1461 - acc: 0.7062
288/753 [==========>...................] - ETA: 11s - loss: 1.0981 - acc: 0.7159
320/753 [===========>..................] - ETA: 9s - loss: 1.0595 - acc: 0.7234 
352/753 [=============>................] - ETA: 8s - loss: 1.0271 - acc: 0.7293
384/753 [==============>...............] - ETA: 8s - loss: 0.9939 - acc: 0.7368
416/753 [===============>..............] - ETA: 7s - loss: 0.9642 - acc: 0.7425
448/753 [================>.............] - ETA: 6s - loss: 0.9342 - acc: 0.7498
480/753 [==================>...........] - ETA: 5s - loss: 0.9062 - acc: 0.7551
512/753 [===================>..........] - ETA: 4s - loss: 0.8820 - acc: 0.7602
544/753 [====================>.........] - ETA: 4s - loss: 0.8628 - acc: 0.7636
576/753 [=====================>........] - ETA: 3s - loss: 0.8443 - acc: 0.7675
608/753 [=======================>......] - ETA: 2s - loss: 0.8224 - acc: 0.7726
640/753 [========================>.....] - ETA: 2s - loss: 0.8111 - acc: 0.7746
672/753 [=========================>....] - ETA: 1s - loss: 0.7966 - acc: 0.7785
704/753 [===========================>..] - ETA: 0s - loss: 0.7828 - acc: 0.7812
736/753 [============================>.] - ETA: 0s - loss: 0.7676 - acc: 0.7858
753/753 [==============================] - 15s 20ms/step - loss: 0.7631 - acc: 0.7867 - val_loss: 0.4013 - val_acc: 0.8861
Epoch 2/70

 32/753 [>.............................] - ETA: 10s - loss: 0.4515 - acc: 0.8638
 64/753 [=>............................] - ETA: 10s - loss: 0.4210 - acc: 0.8759
 96/753 [==>...........................] - ETA: 10s - loss: 0.4067 - acc: 0.8803
128/753 [====>.........................] - ETA: 9s - loss: 0.3943 - acc: 0.8805 
160/753 [=====>........................] - ETA: 9s - loss: 0.4091 - acc: 0.8757
192/753 [======>.......................] - ETA: 8s - loss: 0.3951 - acc: 0.8772
224/753 [=======>......................] - ETA: 8s - loss: 0.3941 - acc: 0.8787
256/753 [=========>....................] - ETA: 7s - loss: 0.3851 - acc: 0.8830
288/753 [==========>...................] - ETA: 7s - loss: 0.3933 - acc: 0.8784
320/753 [===========>..................] - ETA: 6s - loss: 0.3947 - acc: 0.8791
352/753 [=============>................] - ETA: 6s - loss: 0.3956 - acc: 0.8779
384/753 [==============>...............] - ETA: 5s - loss: 0.3968 - acc: 0.8799
416/753 [===============>..............] - ETA: 5s - loss: 0.3942 - acc: 0.8809
448/753 [================>.............] - ETA: 4s - loss: 0.3984 - acc: 0.8784
480/753 [==================>...........] - ETA: 4s - loss: 0.3960 - acc: 0.8795
512/753 [===================>..........] - ETA: 3s - loss: 0.3944 - acc: 0.8806
544/753 [====================>.........] - ETA: 3s - loss: 0.3914 - acc: 0.8820
576/753 [=====================>........] - ETA: 2s - loss: 0.3856 - acc: 0.8843
608/753 [=======================>......] - ETA: 2s - loss: 0.3815 - acc: 0.8857
640/753 [========================>.....] - ETA: 1s - loss: 0.3792 - acc: 0.8861
672/753 [=========================>....] - ETA: 1s - loss: 0.3730 - acc: 0.8881
704/753 [===========================>..] - ETA: 0s - loss: 0.3700 - acc: 0.8884
736/753 [============================>.] - ETA: 0s - loss: 0.3686 - acc: 0.8887
753/753 [==============================] - 12s 16ms/step - loss: 0.3669 - acc: 0.8889 - val_loss: 0.3046 - val_acc: 0.9159
Epoch 3/70

 32/753 [>.............................] - ETA: 11s - loss: 0.3567 - acc: 0.8908
 64/753 [=>............................] - ETA: 10s - loss: 0.3682 - acc: 0.8843
 96/753 [==>...........................] - ETA: 10s - loss: 0.3381 - acc: 0.8963
128/753 [====>.........................] - ETA: 9s - loss: 0.3529 - acc: 0.8897 
160/753 [=====>........................] - ETA: 9s - loss: 0.3331 - acc: 0.8968
192/753 [======>.......................] - ETA: 8s - loss: 0.3236 - acc: 0.8984
224/753 [=======>......................] - ETA: 8s - loss: 0.3085 - acc: 0.9019
256/753 [=========>....................] - ETA: 7s - loss: 0.3072 - acc: 0.9025
288/753 [==========>...................] - ETA: 7s - loss: 0.3012 - acc: 0.9044
320/753 [===========>..................] - ETA: 6s - loss: 0.2936 - acc: 0.9066
352/753 [=============>................] - ETA: 6s - loss: 0.2894 - acc: 0.9072
384/753 [==============>...............] - ETA: 5s - loss: 0.2832 - acc: 0.9098
416/753 [===============>..............] - ETA: 5s - loss: 0.2811 - acc: 0.9104
448/753 [================>.............] - ETA: 4s - loss: 0.2770 - acc: 0.9116
480/753 [==================>...........] - ETA: 4s - loss: 0.2723 - acc: 0.9136
512/753 [===================>..........] - ETA: 3s - loss: 0.2711 - acc: 0.9139
544/753 [====================>.........] - ETA: 3s - loss: 0.2707 - acc: 0.9144
576/753 [=====================>........] - ETA: 2s - loss: 0.2752 - acc: 0.9127
608/753 [=======================>......] - ETA: 2s - loss: 0.2749 - acc: 0.9132
640/753 [========================>.....] - ETA: 1s - loss: 0.2731 - acc: 0.9137
672/753 [=========================>....] - ETA: 1s - loss: 0.2708 - acc: 0.9148
704/753 [===========================>..] - ETA: 0s - loss: 0.2693 - acc: 0.9155
736/753 [============================>.] - ETA: 0s - loss: 0.2699 - acc: 0.9154
753/753 [==============================] - 12s 16ms/step - loss: 0.2721 - acc: 0.9146 - val_loss: 0.2583 - val_acc: 0.9245
Epoch 4/70

 32/753 [>.............................] - ETA: 11s - loss: 0.2389 - acc: 0.9306
 64/753 [=>............................] - ETA: 10s - loss: 0.2928 - acc: 0.9104
 96/753 [==>...........................] - ETA: 10s - loss: 0.2668 - acc: 0.9183
128/753 [====>.........................] - ETA: 9s - loss: 0.2754 - acc: 0.9158 
160/753 [=====>........................] - ETA: 9s - loss: 0.2761 - acc: 0.9137
192/753 [======>.......................] - ETA: 8s - loss: 0.2663 - acc: 0.9160
224/753 [=======>......................] - ETA: 8s - loss: 0.2522 - acc: 0.9234
256/753 [=========>....................] - ETA: 7s - loss: 0.2499 - acc: 0.9236
288/753 [==========>...................] - ETA: 7s - loss: 0.2439 - acc: 0.9249
320/753 [===========>..................] - ETA: 6s - loss: 0.2456 - acc: 0.9235
352/753 [=============>................] - ETA: 6s - loss: 0.2432 - acc: 0.9241
384/753 [==============>...............] - ETA: 5s - loss: 0.2401 - acc: 0.9254
416/753 [===============>..............] - ETA: 5s - loss: 0.2375 - acc: 0.9258
448/753 [================>.............] - ETA: 4s - loss: 0.2313 - acc: 0.9278
480/753 [==================>...........] - ETA: 4s - loss: 0.2264 - acc: 0.9294
512/753 [===================>..........] - ETA: 3s - loss: 0.2267 - acc: 0.9294
544/753 [====================>.........] - ETA: 3s - loss: 0.2261 - acc: 0.9291
576/753 [=====================>........] - ETA: 2s - loss: 0.2260 - acc: 0.9294
608/753 [=======================>......] - ETA: 2s - loss: 0.2290 - acc: 0.9283
640/753 [========================>.....] - ETA: 1s - loss: 0.2274 - acc: 0.9289
672/753 [=========================>....] - ETA: 1s - loss: 0.2267 - acc: 0.9286
704/753 [===========================>..] - ETA: 0s - loss: 0.2245 - acc: 0.9296
736/753 [============================>.] - ETA: 0s - loss: 0.2243 - acc: 0.9295
753/753 [==============================] - 12s 16ms/step - loss: 0.2246 - acc: 0.9295 - val_loss: 0.2331 - val_acc: 0.9359
Epoch 5/70

 32/753 [>.............................] - ETA: 11s - loss: 0.2225 - acc: 0.9273
 64/753 [=>............................] - ETA: 10s - loss: 0.1893 - acc: 0.9417
 96/753 [==>...........................] - ETA: 10s - loss: 0.1889 - acc: 0.9446
128/753 [====>.........................] - ETA: 9s - loss: 0.2021 - acc: 0.9383 
160/753 [=====>........................] - ETA: 9s - loss: 0.1974 - acc: 0.9424
192/753 [======>.......................] - ETA: 8s - loss: 0.2014 - acc: 0.9398
224/753 [=======>......................] - ETA: 8s - loss: 0.2017 - acc: 0.9392
256/753 [=========>....................] - ETA: 7s - loss: 0.2092 - acc: 0.9359
288/753 [==========>...................] - ETA: 7s - loss: 0.2079 - acc: 0.9351
320/753 [===========>..................] - ETA: 6s - loss: 0.2107 - acc: 0.9332
352/753 [=============>................] - ETA: 6s - loss: 0.2093 - acc: 0.9339
384/753 [==============>...............] - ETA: 5s - loss: 0.2084 - acc: 0.9340
416/753 [===============>..............] - ETA: 5s - loss: 0.2038 - acc: 0.9361
448/753 [================>.............] - ETA: 4s - loss: 0.2034 - acc: 0.9367
480/753 [==================>...........] - ETA: 4s - loss: 0.2012 - acc: 0.9379
512/753 [===================>..........] - ETA: 3s - loss: 0.2032 - acc: 0.9378
544/753 [====================>.........] - ETA: 3s - loss: 0.1989 - acc: 0.9390
576/753 [=====================>........] - ETA: 2s - loss: 0.1965 - acc: 0.9393
608/753 [=======================>......] - ETA: 2s - loss: 0.1941 - acc: 0.9401
640/753 [========================>.....] - ETA: 1s - loss: 0.1932 - acc: 0.9401
672/753 [=========================>....] - ETA: 1s - loss: 0.1940 - acc: 0.9400
704/753 [===========================>..] - ETA: 0s - loss: 0.1962 - acc: 0.9392
736/753 [============================>.] - ETA: 0s - loss: 0.1958 - acc: 0.9392
753/753 [==============================] - 12s 16ms/step - loss: 0.1955 - acc: 0.9390 - val_loss: 0.2373 - val_acc: 0.9358
Epoch 6/70

 32/753 [>.............................] - ETA: 10s - loss: 0.1242 - acc: 0.9601
 64/753 [=>............................] - ETA: 10s - loss: 0.1500 - acc: 0.9506
 96/753 [==>...........................] - ETA: 9s - loss: 0.1649 - acc: 0.9442 
128/753 [====>.........................] - ETA: 9s - loss: 0.1754 - acc: 0.9431
160/753 [=====>........................] - ETA: 9s - loss: 0.1737 - acc: 0.9431
192/753 [======>.......................] - ETA: 8s - loss: 0.1760 - acc: 0.9426
224/753 [=======>......................] - ETA: 8s - loss: 0.1698 - acc: 0.9452
256/753 [=========>....................] - ETA: 7s - loss: 0.1617 - acc: 0.9474
288/753 [==========>...................] - ETA: 7s - loss: 0.1621 - acc: 0.9465
320/753 [===========>..................] - ETA: 6s - loss: 0.1677 - acc: 0.9455
352/753 [=============>................] - ETA: 6s - loss: 0.1690 - acc: 0.9442
384/753 [==============>...............] - ETA: 5s - loss: 0.1669 - acc: 0.9448
416/753 [===============>..............] - ETA: 5s - loss: 0.1688 - acc: 0.9454
448/753 [================>.............] - ETA: 4s - loss: 0.1683 - acc: 0.9456
480/753 [==================>...........] - ETA: 4s - loss: 0.1677 - acc: 0.9461
512/753 [===================>..........] - ETA: 3s - loss: 0.1677 - acc: 0.9458
544/753 [====================>.........] - ETA: 3s - loss: 0.1676 - acc: 0.9460
576/753 [=====================>........] - ETA: 2s - loss: 0.1684 - acc: 0.9455
608/753 [=======================>......] - ETA: 2s - loss: 0.1691 - acc: 0.9451
640/753 [========================>.....] - ETA: 1s - loss: 0.1685 - acc: 0.9457
672/753 [=========================>....] - ETA: 1s - loss: 0.1689 - acc: 0.9453
704/753 [===========================>..] - ETA: 0s - loss: 0.1703 - acc: 0.9451
736/753 [============================>.] - ETA: 0s - loss: 0.1706 - acc: 0.9447
753/753 [==============================] - 12s 16ms/step - loss: 0.1706 - acc: 0.9445 - val_loss: 0.2295 - val_acc: 0.9311
Epoch 7/70

 32/753 [>.............................] - ETA: 11s - loss: 0.1324 - acc: 0.9545
 64/753 [=>............................] - ETA: 10s - loss: 0.1387 - acc: 0.9537
 96/753 [==>...........................] - ETA: 10s - loss: 0.1456 - acc: 0.9522
128/753 [====>.........................] - ETA: 9s - loss: 0.1377 - acc: 0.9559 
160/753 [=====>........................] - ETA: 9s - loss: 0.1408 - acc: 0.9556
192/753 [======>.......................] - ETA: 8s - loss: 0.1380 - acc: 0.9568
224/753 [=======>......................] - ETA: 8s - loss: 0.1420 - acc: 0.9559
256/753 [=========>....................] - ETA: 7s - loss: 0.1428 - acc: 0.9554
288/753 [==========>...................] - ETA: 7s - loss: 0.1492 - acc: 0.9528
320/753 [===========>..................] - ETA: 6s - loss: 0.1486 - acc: 0.9533
352/753 [=============>................] - ETA: 6s - loss: 0.1475 - acc: 0.9528
384/753 [==============>...............] - ETA: 5s - loss: 0.1492 - acc: 0.9535
416/753 [===============>..............] - ETA: 5s - loss: 0.1526 - acc: 0.9521
448/753 [================>.............] - ETA: 4s - loss: 0.1541 - acc: 0.9517
480/753 [==================>...........] - ETA: 4s - loss: 0.1603 - acc: 0.9503
512/753 [===================>..........] - ETA: 3s - loss: 0.1588 - acc: 0.9506
544/753 [====================>.........] - ETA: 3s - loss: 0.1610 - acc: 0.9497
576/753 [=====================>........] - ETA: 2s - loss: 0.1588 - acc: 0.9504
608/753 [=======================>......] - ETA: 2s - loss: 0.1617 - acc: 0.9487
640/753 [========================>.....] - ETA: 1s - loss: 0.1603 - acc: 0.9493
672/753 [=========================>....] - ETA: 1s - loss: 0.1612 - acc: 0.9489
704/753 [===========================>..] - ETA: 0s - loss: 0.1580 - acc: 0.9498
736/753 [============================>.] - ETA: 0s - loss: 0.1588 - acc: 0.9499
753/753 [==============================] - 12s 16ms/step - loss: 0.1586 - acc: 0.9497 - val_loss: 0.2197 - val_acc: 0.9419
Epoch 8/70

 32/753 [>.............................] - ETA: 11s - loss: 0.1710 - acc: 0.9594
 64/753 [=>............................] - ETA: 10s - loss: 0.1840 - acc: 0.9492
 96/753 [==>...........................] - ETA: 10s - loss: 0.1717 - acc: 0.9512
128/753 [====>.........................] - ETA: 9s - loss: 0.1535 - acc: 0.9553 
160/753 [=====>........................] - ETA: 9s - loss: 0.1397 - acc: 0.9587
192/753 [======>.......................] - ETA: 8s - loss: 0.1435 - acc: 0.9584
224/753 [=======>......................] - ETA: 8s - loss: 0.1503 - acc: 0.9554
256/753 [=========>....................] - ETA: 7s - loss: 0.1481 - acc: 0.9545
288/753 [==========>...................] - ETA: 7s - loss: 0.1462 - acc: 0.9548
320/753 [===========>..................] - ETA: 6s - loss: 0.1426 - acc: 0.9564
352/753 [=============>................] - ETA: 6s - loss: 0.1406 - acc: 0.9566
384/753 [==============>...............] - ETA: 5s - loss: 0.1407 - acc: 0.9560
416/753 [===============>..............] - ETA: 5s - loss: 0.1412 - acc: 0.9559
448/753 [================>.............] - ETA: 4s - loss: 0.1406 - acc: 0.9555
480/753 [==================>...........] - ETA: 4s - loss: 0.1417 - acc: 0.9545
512/753 [===================>..........] - ETA: 3s - loss: 0.1420 - acc: 0.9546
544/753 [====================>.........] - ETA: 3s - loss: 0.1409 - acc: 0.9542
576/753 [=====================>........] - ETA: 2s - loss: 0.1406 - acc: 0.9546
608/753 [=======================>......] - ETA: 2s - loss: 0.1388 - acc: 0.9553
640/753 [========================>.....] - ETA: 1s - loss: 0.1372 - acc: 0.9557
672/753 [=========================>....] - ETA: 1s - loss: 0.1391 - acc: 0.9554
704/753 [===========================>..] - ETA: 0s - loss: 0.1427 - acc: 0.9543
736/753 [============================>.] - ETA: 0s - loss: 0.1428 - acc: 0.9543
753/753 [==============================] - 12s 16ms/step - loss: 0.1425 - acc: 0.9545 - val_loss: 0.2144 - val_acc: 0.9400
Epoch 9/70

 32/753 [>.............................] - ETA: 11s - loss: 0.1191 - acc: 0.9676
 64/753 [=>............................] - ETA: 10s - loss: 0.1084 - acc: 0.9680
 96/753 [==>...........................] - ETA: 10s - loss: 0.1081 - acc: 0.9689
128/753 [====>.........................] - ETA: 9s - loss: 0.1191 - acc: 0.9647 
160/753 [=====>........................] - ETA: 9s - loss: 0.1229 - acc: 0.9622
192/753 [======>.......................] - ETA: 8s - loss: 0.1257 - acc: 0.9601
224/753 [=======>......................] - ETA: 8s - loss: 0.1226 - acc: 0.9598
256/753 [=========>....................] - ETA: 7s - loss: 0.1266 - acc: 0.9588
288/753 [==========>...................] - ETA: 7s - loss: 0.1203 - acc: 0.9619
320/753 [===========>..................] - ETA: 6s - loss: 0.1226 - acc: 0.9609
352/753 [=============>................] - ETA: 6s - loss: 0.1235 - acc: 0.9602
384/753 [==============>...............] - ETA: 5s - loss: 0.1238 - acc: 0.9612
416/753 [===============>..............] - ETA: 5s - loss: 0.1216 - acc: 0.9622
448/753 [================>.............] - ETA: 4s - loss: 0.1227 - acc: 0.9620
480/753 [==================>...........] - ETA: 4s - loss: 0.1210 - acc: 0.9627
512/753 [===================>..........] - ETA: 3s - loss: 0.1224 - acc: 0.9626
544/753 [====================>.........] - ETA: 3s - loss: 0.1248 - acc: 0.9617
576/753 [=====================>........] - ETA: 2s - loss: 0.1263 - acc: 0.9611
608/753 [=======================>......] - ETA: 2s - loss: 0.1249 - acc: 0.9619
640/753 [========================>.....] - ETA: 1s - loss: 0.1264 - acc: 0.9614
672/753 [=========================>....] - ETA: 1s - loss: 0.1267 - acc: 0.9614
704/753 [===========================>..] - ETA: 0s - loss: 0.1267 - acc: 0.9607
736/753 [============================>.] - ETA: 0s - loss: 0.1278 - acc: 0.9601
753/753 [==============================] - 12s 16ms/step - loss: 0.1279 - acc: 0.9601 - val_loss: 0.2146 - val_acc: 0.9418
Epoch 10/70

 32/753 [>.............................] - ETA: 11s - loss: 0.1671 - acc: 0.9537
 64/753 [=>............................] - ETA: 10s - loss: 0.1836 - acc: 0.9500
 96/753 [==>...........................] - ETA: 10s - loss: 0.1509 - acc: 0.9592
128/753 [====>.........................] - ETA: 9s - loss: 0.1454 - acc: 0.9575 
160/753 [=====>........................] - ETA: 9s - loss: 0.1422 - acc: 0.9578
192/753 [======>.......................] - ETA: 8s - loss: 0.1354 - acc: 0.9591
224/753 [=======>......................] - ETA: 8s - loss: 0.1319 - acc: 0.9590
256/753 [=========>....................] - ETA: 7s - loss: 0.1358 - acc: 0.9573
288/753 [==========>...................] - ETA: 7s - loss: 0.1331 - acc: 0.9577
320/753 [===========>..................] - ETA: 6s - loss: 0.1312 - acc: 0.9578
352/753 [=============>................] - ETA: 6s - loss: 0.1250 - acc: 0.9599
384/753 [==============>...............] - ETA: 5s - loss: 0.1223 - acc: 0.9612
416/753 [===============>..............] - ETA: 5s - loss: 0.1217 - acc: 0.9612
448/753 [================>.............] - ETA: 4s - loss: 0.1201 - acc: 0.9614
480/753 [==================>...........] - ETA: 4s - loss: 0.1185 - acc: 0.9621
512/753 [===================>..........] - ETA: 3s - loss: 0.1194 - acc: 0.9615
544/753 [====================>.........] - ETA: 3s - loss: 0.1198 - acc: 0.9618
576/753 [=====================>........] - ETA: 2s - loss: 0.1195 - acc: 0.9620
608/753 [=======================>......] - ETA: 2s - loss: 0.1193 - acc: 0.9625
640/753 [========================>.....] - ETA: 1s - loss: 0.1189 - acc: 0.9630
672/753 [=========================>....] - ETA: 1s - loss: 0.1185 - acc: 0.9627
704/753 [===========================>..] - ETA: 0s - loss: 0.1194 - acc: 0.9623
736/753 [============================>.] - ETA: 0s - loss: 0.1203 - acc: 0.9623
753/753 [==============================] - 12s 16ms/step - loss: 0.1204 - acc: 0.9623 - val_loss: 0.2126 - val_acc: 0.9424
Epoch 11/70

 32/753 [>.............................] - ETA: 11s - loss: 0.1422 - acc: 0.9565
 64/753 [=>............................] - ETA: 10s - loss: 0.1395 - acc: 0.9598
 96/753 [==>...........................] - ETA: 10s - loss: 0.1298 - acc: 0.9620
128/753 [====>.........................] - ETA: 9s - loss: 0.1193 - acc: 0.9641 
160/753 [=====>........................] - ETA: 9s - loss: 0.1253 - acc: 0.9621
192/753 [======>.......................] - ETA: 8s - loss: 0.1200 - acc: 0.9637
224/753 [=======>......................] - ETA: 8s - loss: 0.1249 - acc: 0.9603
256/753 [=========>....................] - ETA: 7s - loss: 0.1199 - acc: 0.9619
288/753 [==========>...................] - ETA: 7s - loss: 0.1181 - acc: 0.9623
320/753 [===========>..................] - ETA: 6s - loss: 0.1180 - acc: 0.9628
352/753 [=============>................] - ETA: 6s - loss: 0.1141 - acc: 0.9644
384/753 [==============>...............] - ETA: 5s - loss: 0.1144 - acc: 0.9640
416/753 [===============>..............] - ETA: 5s - loss: 0.1176 - acc: 0.9634
448/753 [================>.............] - ETA: 4s - loss: 0.1178 - acc: 0.9638
480/753 [==================>...........] - ETA: 4s - loss: 0.1156 - acc: 0.9640
512/753 [===================>..........] - ETA: 3s - loss: 0.1132 - acc: 0.9651
544/753 [====================>.........] - ETA: 3s - loss: 0.1129 - acc: 0.9652
576/753 [=====================>........] - ETA: 2s - loss: 0.1148 - acc: 0.9645
608/753 [=======================>......] - ETA: 2s - loss: 0.1124 - acc: 0.9651
640/753 [========================>.....] - ETA: 1s - loss: 0.1109 - acc: 0.9655
672/753 [=========================>....] - ETA: 1s - loss: 0.1104 - acc: 0.9657
704/753 [===========================>..] - ETA: 0s - loss: 0.1102 - acc: 0.9655
736/753 [============================>.] - ETA: 0s - loss: 0.1101 - acc: 0.9653
753/753 [==============================] - 12s 16ms/step - loss: 0.1092 - acc: 0.9658 - val_loss: 0.2148 - val_acc: 0.9436
Epoch 12/70

 32/753 [>.............................] - ETA: 11s - loss: 0.1263 - acc: 0.9551
 64/753 [=>............................] - ETA: 10s - loss: 0.1249 - acc: 0.9612
 96/753 [==>...........................] - ETA: 10s - loss: 0.1133 - acc: 0.9653
128/753 [====>.........................] - ETA: 9s - loss: 0.1148 - acc: 0.9638 
160/753 [=====>........................] - ETA: 9s - loss: 0.1038 - acc: 0.9666
192/753 [======>.......................] - ETA: 8s - loss: 0.1133 - acc: 0.9622
224/753 [=======>......................] - ETA: 8s - loss: 0.1124 - acc: 0.9629
256/753 [=========>....................] - ETA: 7s - loss: 0.1124 - acc: 0.9639
288/753 [==========>...................] - ETA: 7s - loss: 0.1071 - acc: 0.9651
320/753 [===========>..................] - ETA: 6s - loss: 0.1109 - acc: 0.9640
352/753 [=============>................] - ETA: 6s - loss: 0.1119 - acc: 0.9646
384/753 [==============>...............] - ETA: 5s - loss: 0.1092 - acc: 0.9664
416/753 [===============>..............] - ETA: 5s - loss: 0.1086 - acc: 0.9666
448/753 [================>.............] - ETA: 4s - loss: 0.1093 - acc: 0.9668
480/753 [==================>...........] - ETA: 4s - loss: 0.1071 - acc: 0.9674
512/753 [===================>..........] - ETA: 3s - loss: 0.1076 - acc: 0.9674
544/753 [====================>.........] - ETA: 3s - loss: 0.1058 - acc: 0.9679
576/753 [=====================>........] - ETA: 2s - loss: 0.1024 - acc: 0.9691
608/753 [=======================>......] - ETA: 2s - loss: 0.1015 - acc: 0.9694
640/753 [========================>.....] - ETA: 1s - loss: 0.1042 - acc: 0.9686
672/753 [=========================>....] - ETA: 1s - loss: 0.1036 - acc: 0.9687
704/753 [===========================>..] - ETA: 0s - loss: 0.1026 - acc: 0.9691
736/753 [============================>.] - ETA: 0s - loss: 0.1037 - acc: 0.9685
753/753 [==============================] - 12s 16ms/step - loss: 0.1035 - acc: 0.9685 - val_loss: 0.2080 - val_acc: 0.9453
Epoch 13/70

 32/753 [>.............................] - ETA: 11s - loss: 0.0785 - acc: 0.9778
 64/753 [=>............................] - ETA: 10s - loss: 0.0757 - acc: 0.9800
 96/753 [==>...........................] - ETA: 10s - loss: 0.0872 - acc: 0.9754
128/753 [====>.........................] - ETA: 9s - loss: 0.0873 - acc: 0.9758 
160/753 [=====>........................] - ETA: 9s - loss: 0.0834 - acc: 0.9760
192/753 [======>.......................] - ETA: 8s - loss: 0.0868 - acc: 0.9754
224/753 [=======>......................] - ETA: 8s - loss: 0.0844 - acc: 0.9755
256/753 [=========>....................] - ETA: 7s - loss: 0.0872 - acc: 0.9740
288/753 [==========>...................] - ETA: 7s - loss: 0.0904 - acc: 0.9732
320/753 [===========>..................] - ETA: 6s - loss: 0.0899 - acc: 0.9731
352/753 [=============>................] - ETA: 6s - loss: 0.0921 - acc: 0.9719
384/753 [==============>...............] - ETA: 5s - loss: 0.0914 - acc: 0.9721
416/753 [===============>..............] - ETA: 5s - loss: 0.0892 - acc: 0.9729
448/753 [================>.............] - ETA: 4s - loss: 0.0898 - acc: 0.9726
480/753 [==================>...........] - ETA: 4s - loss: 0.0916 - acc: 0.9729
512/753 [===================>..........] - ETA: 3s - loss: 0.0913 - acc: 0.9728
544/753 [====================>.........] - ETA: 3s - loss: 0.0916 - acc: 0.9726
576/753 [=====================>........] - ETA: 2s - loss: 0.0905 - acc: 0.9726
608/753 [=======================>......] - ETA: 2s - loss: 0.0903 - acc: 0.9726
640/753 [========================>.....] - ETA: 1s - loss: 0.0889 - acc: 0.9729
672/753 [=========================>....] - ETA: 1s - loss: 0.0893 - acc: 0.9728
704/753 [===========================>..] - ETA: 0s - loss: 0.0908 - acc: 0.9724
736/753 [============================>.] - ETA: 0s - loss: 0.0909 - acc: 0.9724
753/753 [==============================] - 12s 16ms/step - loss: 0.0913 - acc: 0.9724 - val_loss: 0.2101 - val_acc: 0.9430
Epoch 14/70

 32/753 [>.............................] - ETA: 11s - loss: 0.0835 - acc: 0.9818
 64/753 [=>............................] - ETA: 10s - loss: 0.1001 - acc: 0.9765
 96/753 [==>...........................] - ETA: 10s - loss: 0.0925 - acc: 0.9770
128/753 [====>.........................] - ETA: 9s - loss: 0.0915 - acc: 0.9773 
160/753 [=====>........................] - ETA: 9s - loss: 0.0872 - acc: 0.9777
192/753 [======>.......................] - ETA: 8s - loss: 0.0894 - acc: 0.9764
224/753 [=======>......................] - ETA: 8s - loss: 0.0893 - acc: 0.9757
256/753 [=========>....................] - ETA: 7s - loss: 0.0892 - acc: 0.9755
288/753 [==========>...................] - ETA: 7s - loss: 0.0926 - acc: 0.9736
320/753 [===========>..................] - ETA: 6s - loss: 0.0947 - acc: 0.9727
352/753 [=============>................] - ETA: 6s - loss: 0.0927 - acc: 0.9736
384/753 [==============>...............] - ETA: 5s - loss: 0.0943 - acc: 0.9726
416/753 [===============>..............] - ETA: 5s - loss: 0.0924 - acc: 0.9729
448/753 [================>.............] - ETA: 4s - loss: 0.0916 - acc: 0.9730
480/753 [==================>...........] - ETA: 4s - loss: 0.0919 - acc: 0.9728
512/753 [===================>..........] - ETA: 3s - loss: 0.0934 - acc: 0.9718
544/753 [====================>.........] - ETA: 3s - loss: 0.0960 - acc: 0.9711
576/753 [=====================>........] - ETA: 2s - loss: 0.0957 - acc: 0.9713
608/753 [=======================>......] - ETA: 2s - loss: 0.0931 - acc: 0.9721
640/753 [========================>.....] - ETA: 1s - loss: 0.0926 - acc: 0.9720
672/753 [=========================>....] - ETA: 1s - loss: 0.0911 - acc: 0.9728
704/753 [===========================>..] - ETA: 0s - loss: 0.0906 - acc: 0.9730
736/753 [============================>.] - ETA: 0s - loss: 0.0898 - acc: 0.9733
753/753 [==============================] - 12s 16ms/step - loss: 0.0909 - acc: 0.9731 - val_loss: 0.2144 - val_acc: 0.9430
Computing...
Manual evaluation: (didn't understand why I made this)
True 8131
False 940
True percentage 0.896373056995
Sklearn evaluation:
             precision    recall  f1-score   support

     B-MISC       0.43      0.26      0.32       141
     I-MISC       0.49      0.33      0.39       154
          O       0.98      0.96      0.97      7318
      B-PER       0.89      0.83      0.86       438
      I-PER       0.88      0.64      0.74       214
      B-ORG       0.71      0.68      0.69       296
      B-LOC       0.71      0.71      0.71       218
      I-ORG       0.52      0.49      0.50       151
      I-LOC       0.71      0.74      0.72       141

avg / total       0.93      0.90      0.91      9071

F-1 Score:
0.922402005469
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 837 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100790 unique words.
Found 94 unique chars.
Found 9 unique labels.
786 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 257
OOV word occurences: 381
Padding...
Data padded!
Padding...
Data padded!
Padded until 67 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 67, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 67)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 67, 64)       6450624     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 67, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 67, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 67, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 67, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 67, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,953,730
Trainable params: 6,953,730
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 753 samples, validate on 84 samples
Epoch 1/70

 32/753 [>.............................] - ETA: 1:06 - loss: 2.4463 - acc: 0.0189
 64/753 [=>............................] - ETA: 37s - loss: 1.6794 - acc: 0.4137 
 96/753 [==>...........................] - ETA: 27s - loss: 1.9873 - acc: 0.5356
128/753 [====>.........................] - ETA: 22s - loss: 1.7799 - acc: 0.6030
160/753 [=====>........................] - ETA: 19s - loss: 1.6045 - acc: 0.6406
192/753 [======>.......................] - ETA: 16s - loss: 1.4769 - acc: 0.6664
224/753 [=======>......................] - ETA: 14s - loss: 1.3763 - acc: 0.6849
256/753 [=========>....................] - ETA: 13s - loss: 1.2902 - acc: 0.7016
288/753 [==========>...................] - ETA: 11s - loss: 1.2274 - acc: 0.7132
320/753 [===========>..................] - ETA: 10s - loss: 1.1698 - acc: 0.7234
352/753 [=============>................] - ETA: 9s - loss: 1.1249 - acc: 0.7305 
384/753 [==============>...............] - ETA: 8s - loss: 1.0860 - acc: 0.7371
416/753 [===============>..............] - ETA: 7s - loss: 1.0475 - acc: 0.7441
448/753 [================>.............] - ETA: 6s - loss: 1.0278 - acc: 0.7452
480/753 [==================>...........] - ETA: 5s - loss: 0.9974 - acc: 0.7519
512/753 [===================>..........] - ETA: 5s - loss: 0.9770 - acc: 0.7543
544/753 [====================>.........] - ETA: 4s - loss: 0.9556 - acc: 0.7580
576/753 [=====================>........] - ETA: 3s - loss: 0.9363 - acc: 0.7608
608/753 [=======================>......] - ETA: 3s - loss: 0.9198 - acc: 0.7631
640/753 [========================>.....] - ETA: 2s - loss: 0.8963 - acc: 0.7683
672/753 [=========================>....] - ETA: 1s - loss: 0.8757 - acc: 0.7718
704/753 [===========================>..] - ETA: 0s - loss: 0.8524 - acc: 0.7770
736/753 [============================>.] - ETA: 0s - loss: 0.8349 - acc: 0.7807
753/753 [==============================] - 16s 21ms/step - loss: 0.8285 - acc: 0.7823 - val_loss: 0.4300 - val_acc: 0.8520
Epoch 2/70

 32/753 [>.............................] - ETA: 11s - loss: 0.4794 - acc: 0.8387
 64/753 [=>............................] - ETA: 11s - loss: 0.4731 - acc: 0.8515
 96/753 [==>...........................] - ETA: 10s - loss: 0.4603 - acc: 0.8525
128/753 [====>.........................] - ETA: 10s - loss: 0.4294 - acc: 0.8647
160/753 [=====>........................] - ETA: 9s - loss: 0.4077 - acc: 0.8710 
192/753 [======>.......................] - ETA: 9s - loss: 0.4037 - acc: 0.8718
224/753 [=======>......................] - ETA: 8s - loss: 0.4058 - acc: 0.8730
256/753 [=========>....................] - ETA: 8s - loss: 0.4127 - acc: 0.8743
288/753 [==========>...................] - ETA: 7s - loss: 0.4119 - acc: 0.8749
320/753 [===========>..................] - ETA: 7s - loss: 0.4157 - acc: 0.8731
352/753 [=============>................] - ETA: 6s - loss: 0.4062 - acc: 0.8756
384/753 [==============>...............] - ETA: 6s - loss: 0.3991 - acc: 0.8763
416/753 [===============>..............] - ETA: 5s - loss: 0.4042 - acc: 0.8755
448/753 [================>.............] - ETA: 5s - loss: 0.3978 - acc: 0.8781
480/753 [==================>...........] - ETA: 4s - loss: 0.3979 - acc: 0.8784
512/753 [===================>..........] - ETA: 4s - loss: 0.3990 - acc: 0.8773
544/753 [====================>.........] - ETA: 3s - loss: 0.3908 - acc: 0.8799
576/753 [=====================>........] - ETA: 2s - loss: 0.3874 - acc: 0.8811
608/753 [=======================>......] - ETA: 2s - loss: 0.3841 - acc: 0.8825
640/753 [========================>.....] - ETA: 1s - loss: 0.3828 - acc: 0.8828
672/753 [=========================>....] - ETA: 1s - loss: 0.3807 - acc: 0.8837
704/753 [===========================>..] - ETA: 0s - loss: 0.3814 - acc: 0.8838
736/753 [============================>.] - ETA: 0s - loss: 0.3758 - acc: 0.8862
753/753 [==============================] - 13s 17ms/step - loss: 0.3762 - acc: 0.8858 - val_loss: 0.2758 - val_acc: 0.9139
Epoch 3/70

 32/753 [>.............................] - ETA: 11s - loss: 0.2861 - acc: 0.9160
 64/753 [=>............................] - ETA: 11s - loss: 0.3230 - acc: 0.9032
 96/753 [==>...........................] - ETA: 10s - loss: 0.3218 - acc: 0.9018
128/753 [====>.........................] - ETA: 10s - loss: 0.3189 - acc: 0.8995
160/753 [=====>........................] - ETA: 9s - loss: 0.3046 - acc: 0.9064 
192/753 [======>.......................] - ETA: 9s - loss: 0.2935 - acc: 0.9091
224/753 [=======>......................] - ETA: 8s - loss: 0.2860 - acc: 0.9113
256/753 [=========>....................] - ETA: 8s - loss: 0.2816 - acc: 0.9120
288/753 [==========>...................] - ETA: 7s - loss: 0.2780 - acc: 0.9122
320/753 [===========>..................] - ETA: 7s - loss: 0.2819 - acc: 0.9118
352/753 [=============>................] - ETA: 6s - loss: 0.2756 - acc: 0.9152
384/753 [==============>...............] - ETA: 6s - loss: 0.2825 - acc: 0.9131
416/753 [===============>..............] - ETA: 5s - loss: 0.2833 - acc: 0.9122
448/753 [================>.............] - ETA: 5s - loss: 0.2848 - acc: 0.9116
480/753 [==================>...........] - ETA: 4s - loss: 0.2845 - acc: 0.9114
512/753 [===================>..........] - ETA: 4s - loss: 0.2850 - acc: 0.9115
544/753 [====================>.........] - ETA: 3s - loss: 0.2819 - acc: 0.9136
576/753 [=====================>........] - ETA: 2s - loss: 0.2814 - acc: 0.9136
608/753 [=======================>......] - ETA: 2s - loss: 0.2811 - acc: 0.9139
640/753 [========================>.....] - ETA: 1s - loss: 0.2816 - acc: 0.9132
672/753 [=========================>....] - ETA: 1s - loss: 0.2798 - acc: 0.9138
704/753 [===========================>..] - ETA: 0s - loss: 0.2785 - acc: 0.9141
736/753 [============================>.] - ETA: 0s - loss: 0.2764 - acc: 0.9153
753/753 [==============================] - 13s 17ms/step - loss: 0.2755 - acc: 0.9156 - val_loss: 0.2491 - val_acc: 0.9160
Epoch 4/70

 32/753 [>.............................] - ETA: 11s - loss: 0.1965 - acc: 0.9429
 64/753 [=>............................] - ETA: 11s - loss: 0.2236 - acc: 0.9357
 96/753 [==>...........................] - ETA: 10s - loss: 0.2427 - acc: 0.9284
128/753 [====>.........................] - ETA: 10s - loss: 0.2394 - acc: 0.9318
160/753 [=====>........................] - ETA: 9s - loss: 0.2350 - acc: 0.9324 
192/753 [======>.......................] - ETA: 9s - loss: 0.2353 - acc: 0.9313
224/753 [=======>......................] - ETA: 8s - loss: 0.2312 - acc: 0.9320
256/753 [=========>....................] - ETA: 8s - loss: 0.2377 - acc: 0.9284
288/753 [==========>...................] - ETA: 7s - loss: 0.2444 - acc: 0.9259
320/753 [===========>..................] - ETA: 7s - loss: 0.2456 - acc: 0.9263
352/753 [=============>................] - ETA: 6s - loss: 0.2449 - acc: 0.9256
384/753 [==============>...............] - ETA: 6s - loss: 0.2388 - acc: 0.9275
416/753 [===============>..............] - ETA: 5s - loss: 0.2338 - acc: 0.9289
448/753 [================>.............] - ETA: 5s - loss: 0.2348 - acc: 0.9286
480/753 [==================>...........] - ETA: 4s - loss: 0.2314 - acc: 0.9295
512/753 [===================>..........] - ETA: 3s - loss: 0.2314 - acc: 0.9293
544/753 [====================>.........] - ETA: 3s - loss: 0.2313 - acc: 0.9298
576/753 [=====================>........] - ETA: 2s - loss: 0.2315 - acc: 0.9295
608/753 [=======================>......] - ETA: 2s - loss: 0.2275 - acc: 0.9310
640/753 [========================>.....] - ETA: 1s - loss: 0.2306 - acc: 0.9301
672/753 [=========================>....] - ETA: 1s - loss: 0.2305 - acc: 0.9303
704/753 [===========================>..] - ETA: 0s - loss: 0.2285 - acc: 0.9302
736/753 [============================>.] - ETA: 0s - loss: 0.2298 - acc: 0.9298
753/753 [==============================] - 13s 17ms/step - loss: 0.2296 - acc: 0.9298 - val_loss: 0.2120 - val_acc: 0.9353
Epoch 5/70

 32/753 [>.............................] - ETA: 12s - loss: 0.1132 - acc: 0.9566
 64/753 [=>............................] - ETA: 11s - loss: 0.1589 - acc: 0.9408
 96/753 [==>...........................] - ETA: 10s - loss: 0.1817 - acc: 0.9348
128/753 [====>.........................] - ETA: 10s - loss: 0.1901 - acc: 0.9332
160/753 [=====>........................] - ETA: 9s - loss: 0.2034 - acc: 0.9335 
192/753 [======>.......................] - ETA: 9s - loss: 0.2126 - acc: 0.9301
224/753 [=======>......................] - ETA: 8s - loss: 0.2119 - acc: 0.9305
256/753 [=========>....................] - ETA: 8s - loss: 0.2138 - acc: 0.9306
288/753 [==========>...................] - ETA: 7s - loss: 0.2105 - acc: 0.9324
320/753 [===========>..................] - ETA: 7s - loss: 0.2093 - acc: 0.9327
352/753 [=============>................] - ETA: 6s - loss: 0.2100 - acc: 0.9319
384/753 [==============>...............] - ETA: 6s - loss: 0.2103 - acc: 0.9323
416/753 [===============>..............] - ETA: 5s - loss: 0.2102 - acc: 0.9334
448/753 [================>.............] - ETA: 5s - loss: 0.2094 - acc: 0.9333
480/753 [==================>...........] - ETA: 4s - loss: 0.2064 - acc: 0.9340
512/753 [===================>..........] - ETA: 3s - loss: 0.2080 - acc: 0.9337
544/753 [====================>.........] - ETA: 3s - loss: 0.2071 - acc: 0.9342
576/753 [=====================>........] - ETA: 2s - loss: 0.2045 - acc: 0.9353
608/753 [=======================>......] - ETA: 2s - loss: 0.2050 - acc: 0.9349
640/753 [========================>.....] - ETA: 1s - loss: 0.2015 - acc: 0.9363
672/753 [=========================>....] - ETA: 1s - loss: 0.2015 - acc: 0.9365
704/753 [===========================>..] - ETA: 0s - loss: 0.2014 - acc: 0.9366
736/753 [============================>.] - ETA: 0s - loss: 0.2000 - acc: 0.9371
753/753 [==============================] - 13s 17ms/step - loss: 0.1993 - acc: 0.9372 - val_loss: 0.2207 - val_acc: 0.9292
Epoch 6/70

 32/753 [>.............................] - ETA: 11s - loss: 0.2230 - acc: 0.9305
 64/753 [=>............................] - ETA: 11s - loss: 0.2004 - acc: 0.9328
 96/753 [==>...........................] - ETA: 10s - loss: 0.2042 - acc: 0.9316
128/753 [====>.........................] - ETA: 10s - loss: 0.1872 - acc: 0.9385
160/753 [=====>........................] - ETA: 9s - loss: 0.1918 - acc: 0.9378 
192/753 [======>.......................] - ETA: 9s - loss: 0.1866 - acc: 0.9408
224/753 [=======>......................] - ETA: 8s - loss: 0.1818 - acc: 0.9411
256/753 [=========>....................] - ETA: 8s - loss: 0.1837 - acc: 0.9403
288/753 [==========>...................] - ETA: 7s - loss: 0.1816 - acc: 0.9418
320/753 [===========>..................] - ETA: 7s - loss: 0.1857 - acc: 0.9402
352/753 [=============>................] - ETA: 6s - loss: 0.1862 - acc: 0.9405
384/753 [==============>...............] - ETA: 6s - loss: 0.1867 - acc: 0.9409
416/753 [===============>..............] - ETA: 5s - loss: 0.1837 - acc: 0.9426
448/753 [================>.............] - ETA: 5s - loss: 0.1841 - acc: 0.9422
480/753 [==================>...........] - ETA: 4s - loss: 0.1816 - acc: 0.9436
512/753 [===================>..........] - ETA: 3s - loss: 0.1816 - acc: 0.9431
544/753 [====================>.........] - ETA: 3s - loss: 0.1809 - acc: 0.9437
576/753 [=====================>........] - ETA: 2s - loss: 0.1841 - acc: 0.9421
608/753 [=======================>......] - ETA: 2s - loss: 0.1825 - acc: 0.9429
640/753 [========================>.....] - ETA: 1s - loss: 0.1797 - acc: 0.9441
672/753 [=========================>....] - ETA: 1s - loss: 0.1792 - acc: 0.9439
704/753 [===========================>..] - ETA: 0s - loss: 0.1784 - acc: 0.9441
736/753 [============================>.] - ETA: 0s - loss: 0.1767 - acc: 0.9444
753/753 [==============================] - 13s 17ms/step - loss: 0.1771 - acc: 0.9444 - val_loss: 0.2034 - val_acc: 0.9362
Epoch 7/70

 32/753 [>.............................] - ETA: 11s - loss: 0.1767 - acc: 0.9384
 64/753 [=>............................] - ETA: 11s - loss: 0.1921 - acc: 0.9365
 96/753 [==>...........................] - ETA: 10s - loss: 0.1804 - acc: 0.9413
128/753 [====>.........................] - ETA: 10s - loss: 0.1653 - acc: 0.9499
160/753 [=====>........................] - ETA: 9s - loss: 0.1700 - acc: 0.9477 
192/753 [======>.......................] - ETA: 9s - loss: 0.1617 - acc: 0.9496
224/753 [=======>......................] - ETA: 8s - loss: 0.1616 - acc: 0.9481
256/753 [=========>....................] - ETA: 8s - loss: 0.1644 - acc: 0.9466
288/753 [==========>...................] - ETA: 7s - loss: 0.1597 - acc: 0.9481
320/753 [===========>..................] - ETA: 7s - loss: 0.1571 - acc: 0.9496
352/753 [=============>................] - ETA: 6s - loss: 0.1563 - acc: 0.9503
384/753 [==============>...............] - ETA: 6s - loss: 0.1567 - acc: 0.9511
416/753 [===============>..............] - ETA: 5s - loss: 0.1590 - acc: 0.9505
448/753 [================>.............] - ETA: 4s - loss: 0.1556 - acc: 0.9513
480/753 [==================>...........] - ETA: 4s - loss: 0.1540 - acc: 0.9520
512/753 [===================>..........] - ETA: 3s - loss: 0.1538 - acc: 0.9525
544/753 [====================>.........] - ETA: 3s - loss: 0.1542 - acc: 0.9520
576/753 [=====================>........] - ETA: 2s - loss: 0.1517 - acc: 0.9532
608/753 [=======================>......] - ETA: 2s - loss: 0.1514 - acc: 0.9539
640/753 [========================>.....] - ETA: 1s - loss: 0.1536 - acc: 0.9532
672/753 [=========================>....] - ETA: 1s - loss: 0.1546 - acc: 0.9529
704/753 [===========================>..] - ETA: 0s - loss: 0.1526 - acc: 0.9535
736/753 [============================>.] - ETA: 0s - loss: 0.1562 - acc: 0.9526
753/753 [==============================] - 13s 17ms/step - loss: 0.1562 - acc: 0.9524 - val_loss: 0.1896 - val_acc: 0.9425
Epoch 8/70

 32/753 [>.............................] - ETA: 11s - loss: 0.1168 - acc: 0.9563
 64/753 [=>............................] - ETA: 11s - loss: 0.1525 - acc: 0.9468
 96/753 [==>...........................] - ETA: 10s - loss: 0.1542 - acc: 0.9440
128/753 [====>.........................] - ETA: 10s - loss: 0.1470 - acc: 0.9492
160/753 [=====>........................] - ETA: 9s - loss: 0.1463 - acc: 0.9516 
192/753 [======>.......................] - ETA: 9s - loss: 0.1530 - acc: 0.9510
224/753 [=======>......................] - ETA: 8s - loss: 0.1454 - acc: 0.9540
256/753 [=========>....................] - ETA: 8s - loss: 0.1474 - acc: 0.9526
288/753 [==========>...................] - ETA: 7s - loss: 0.1448 - acc: 0.9537
320/753 [===========>..................] - ETA: 7s - loss: 0.1500 - acc: 0.9522
352/753 [=============>................] - ETA: 6s - loss: 0.1475 - acc: 0.9525
384/753 [==============>...............] - ETA: 6s - loss: 0.1482 - acc: 0.9524
416/753 [===============>..............] - ETA: 5s - loss: 0.1465 - acc: 0.9530
448/753 [================>.............] - ETA: 4s - loss: 0.1433 - acc: 0.9537
480/753 [==================>...........] - ETA: 4s - loss: 0.1410 - acc: 0.9550
512/753 [===================>..........] - ETA: 3s - loss: 0.1400 - acc: 0.9554
544/753 [====================>.........] - ETA: 3s - loss: 0.1411 - acc: 0.9547
576/753 [=====================>........] - ETA: 2s - loss: 0.1412 - acc: 0.9547
608/753 [=======================>......] - ETA: 2s - loss: 0.1432 - acc: 0.9542
640/753 [========================>.....] - ETA: 1s - loss: 0.1441 - acc: 0.9541
672/753 [=========================>....] - ETA: 1s - loss: 0.1433 - acc: 0.9543
704/753 [===========================>..] - ETA: 0s - loss: 0.1445 - acc: 0.9543
736/753 [============================>.] - ETA: 0s - loss: 0.1462 - acc: 0.9536
753/753 [==============================] - 13s 17ms/step - loss: 0.1469 - acc: 0.9532 - val_loss: 0.1923 - val_acc: 0.9407
Epoch 9/70

 32/753 [>.............................] - ETA: 12s - loss: 0.1437 - acc: 0.9541
 64/753 [=>............................] - ETA: 11s - loss: 0.1270 - acc: 0.9663
 96/753 [==>...........................] - ETA: 11s - loss: 0.1247 - acc: 0.9642
128/753 [====>.........................] - ETA: 10s - loss: 0.1179 - acc: 0.9651
160/753 [=====>........................] - ETA: 9s - loss: 0.1281 - acc: 0.9595 
192/753 [======>.......................] - ETA: 9s - loss: 0.1304 - acc: 0.9606
224/753 [=======>......................] - ETA: 8s - loss: 0.1291 - acc: 0.9614
256/753 [=========>....................] - ETA: 8s - loss: 0.1297 - acc: 0.9607
288/753 [==========>...................] - ETA: 7s - loss: 0.1358 - acc: 0.9592
320/753 [===========>..................] - ETA: 7s - loss: 0.1365 - acc: 0.9599
352/753 [=============>................] - ETA: 6s - loss: 0.1338 - acc: 0.9595
384/753 [==============>...............] - ETA: 6s - loss: 0.1417 - acc: 0.9567
416/753 [===============>..............] - ETA: 5s - loss: 0.1393 - acc: 0.9581
448/753 [================>.............] - ETA: 5s - loss: 0.1391 - acc: 0.9582
480/753 [==================>...........] - ETA: 4s - loss: 0.1395 - acc: 0.9578
512/753 [===================>..........] - ETA: 3s - loss: 0.1403 - acc: 0.9581
544/753 [====================>.........] - ETA: 3s - loss: 0.1406 - acc: 0.9578
576/753 [=====================>........] - ETA: 2s - loss: 0.1392 - acc: 0.9580
608/753 [=======================>......] - ETA: 2s - loss: 0.1360 - acc: 0.9591
640/753 [========================>.....] - ETA: 1s - loss: 0.1385 - acc: 0.9582
672/753 [=========================>....] - ETA: 1s - loss: 0.1393 - acc: 0.9580
704/753 [===========================>..] - ETA: 0s - loss: 0.1388 - acc: 0.9582
736/753 [============================>.] - ETA: 0s - loss: 0.1358 - acc: 0.9591
753/753 [==============================] - 13s 17ms/step - loss: 0.1360 - acc: 0.9588 - val_loss: 0.1893 - val_acc: 0.9418
Epoch 10/70

 32/753 [>.............................] - ETA: 11s - loss: 0.1124 - acc: 0.9668
 64/753 [=>............................] - ETA: 11s - loss: 0.1076 - acc: 0.9689
 96/753 [==>...........................] - ETA: 10s - loss: 0.1225 - acc: 0.9665
128/753 [====>.........................] - ETA: 10s - loss: 0.1251 - acc: 0.9623
160/753 [=====>........................] - ETA: 9s - loss: 0.1240 - acc: 0.9628 
192/753 [======>.......................] - ETA: 9s - loss: 0.1153 - acc: 0.9650
224/753 [=======>......................] - ETA: 8s - loss: 0.1207 - acc: 0.9637
256/753 [=========>....................] - ETA: 8s - loss: 0.1222 - acc: 0.9638
288/753 [==========>...................] - ETA: 7s - loss: 0.1175 - acc: 0.9653
320/753 [===========>..................] - ETA: 7s - loss: 0.1191 - acc: 0.9647
352/753 [=============>................] - ETA: 6s - loss: 0.1170 - acc: 0.9652
384/753 [==============>...............] - ETA: 6s - loss: 0.1166 - acc: 0.9655
416/753 [===============>..............] - ETA: 5s - loss: 0.1233 - acc: 0.9646
448/753 [================>.............] - ETA: 4s - loss: 0.1264 - acc: 0.9634
480/753 [==================>...........] - ETA: 4s - loss: 0.1243 - acc: 0.9635
512/753 [===================>..........] - ETA: 3s - loss: 0.1249 - acc: 0.9631
544/753 [====================>.........] - ETA: 3s - loss: 0.1221 - acc: 0.9640
576/753 [=====================>........] - ETA: 2s - loss: 0.1219 - acc: 0.9640
608/753 [=======================>......] - ETA: 2s - loss: 0.1216 - acc: 0.9637
640/753 [========================>.....] - ETA: 1s - loss: 0.1202 - acc: 0.9642
672/753 [=========================>....] - ETA: 1s - loss: 0.1189 - acc: 0.9643
704/753 [===========================>..] - ETA: 0s - loss: 0.1173 - acc: 0.9646
736/753 [============================>.] - ETA: 0s - loss: 0.1204 - acc: 0.9642
753/753 [==============================] - 13s 17ms/step - loss: 0.1207 - acc: 0.9641 - val_loss: 0.1852 - val_acc: 0.9465
Epoch 11/70

 32/753 [>.............................] - ETA: 11s - loss: 0.1638 - acc: 0.9488
 64/753 [=>............................] - ETA: 11s - loss: 0.1499 - acc: 0.9565
 96/753 [==>...........................] - ETA: 10s - loss: 0.1392 - acc: 0.9586
128/753 [====>.........................] - ETA: 10s - loss: 0.1297 - acc: 0.9590
160/753 [=====>........................] - ETA: 9s - loss: 0.1264 - acc: 0.9612 
192/753 [======>.......................] - ETA: 9s - loss: 0.1244 - acc: 0.9608
224/753 [=======>......................] - ETA: 8s - loss: 0.1210 - acc: 0.9619
256/753 [=========>....................] - ETA: 8s - loss: 0.1164 - acc: 0.9638
288/753 [==========>...................] - ETA: 7s - loss: 0.1134 - acc: 0.9646
320/753 [===========>..................] - ETA: 7s - loss: 0.1114 - acc: 0.9657
352/753 [=============>................] - ETA: 6s - loss: 0.1126 - acc: 0.9655
384/753 [==============>...............] - ETA: 6s - loss: 0.1116 - acc: 0.9661
416/753 [===============>..............] - ETA: 5s - loss: 0.1091 - acc: 0.9669
448/753 [================>.............] - ETA: 4s - loss: 0.1124 - acc: 0.9659
480/753 [==================>...........] - ETA: 4s - loss: 0.1152 - acc: 0.9650
512/753 [===================>..........] - ETA: 3s - loss: 0.1139 - acc: 0.9650
544/753 [====================>.........] - ETA: 3s - loss: 0.1131 - acc: 0.9657
576/753 [=====================>........] - ETA: 2s - loss: 0.1135 - acc: 0.9654
608/753 [=======================>......] - ETA: 2s - loss: 0.1136 - acc: 0.9656
640/753 [========================>.....] - ETA: 1s - loss: 0.1161 - acc: 0.9646
672/753 [=========================>....] - ETA: 1s - loss: 0.1159 - acc: 0.9647
704/753 [===========================>..] - ETA: 0s - loss: 0.1145 - acc: 0.9650
736/753 [============================>.] - ETA: 0s - loss: 0.1144 - acc: 0.9646
753/753 [==============================] - 13s 17ms/step - loss: 0.1135 - acc: 0.9649 - val_loss: 0.1814 - val_acc: 0.9499
Epoch 12/70

 32/753 [>.............................] - ETA: 12s - loss: 0.0792 - acc: 0.9734
 64/753 [=>............................] - ETA: 11s - loss: 0.0832 - acc: 0.9709
 96/753 [==>...........................] - ETA: 10s - loss: 0.1092 - acc: 0.9675
128/753 [====>.........................] - ETA: 10s - loss: 0.1108 - acc: 0.9678
160/753 [=====>........................] - ETA: 9s - loss: 0.1132 - acc: 0.9677 
192/753 [======>.......................] - ETA: 9s - loss: 0.1112 - acc: 0.9669
224/753 [=======>......................] - ETA: 8s - loss: 0.1069 - acc: 0.9685
256/753 [=========>....................] - ETA: 8s - loss: 0.1033 - acc: 0.9697
288/753 [==========>...................] - ETA: 7s - loss: 0.1031 - acc: 0.9696
320/753 [===========>..................] - ETA: 7s - loss: 0.1063 - acc: 0.9681
352/753 [=============>................] - ETA: 6s - loss: 0.1059 - acc: 0.9677
384/753 [==============>...............] - ETA: 6s - loss: 0.1054 - acc: 0.9679
416/753 [===============>..............] - ETA: 5s - loss: 0.1045 - acc: 0.9681
448/753 [================>.............] - ETA: 5s - loss: 0.1025 - acc: 0.9684
480/753 [==================>...........] - ETA: 4s - loss: 0.1018 - acc: 0.9689
512/753 [===================>..........] - ETA: 3s - loss: 0.1026 - acc: 0.9683
544/753 [====================>.........] - ETA: 3s - loss: 0.1006 - acc: 0.9696
576/753 [=====================>........] - ETA: 2s - loss: 0.1015 - acc: 0.9692
608/753 [=======================>......] - ETA: 2s - loss: 0.1005 - acc: 0.9694
640/753 [========================>.....] - ETA: 1s - loss: 0.0995 - acc: 0.9697
672/753 [=========================>....] - ETA: 1s - loss: 0.0988 - acc: 0.9701
704/753 [===========================>..] - ETA: 0s - loss: 0.0993 - acc: 0.9703
736/753 [============================>.] - ETA: 0s - loss: 0.1006 - acc: 0.9698
753/753 [==============================] - 13s 17ms/step - loss: 0.1000 - acc: 0.9701 - val_loss: 0.1760 - val_acc: 0.9528
Epoch 13/70

 32/753 [>.............................] - ETA: 11s - loss: 0.0971 - acc: 0.9773
 64/753 [=>............................] - ETA: 11s - loss: 0.0965 - acc: 0.9776
 96/753 [==>...........................] - ETA: 10s - loss: 0.0824 - acc: 0.9787
128/753 [====>.........................] - ETA: 10s - loss: 0.0838 - acc: 0.9780
160/753 [=====>........................] - ETA: 9s - loss: 0.0798 - acc: 0.9784 
192/753 [======>.......................] - ETA: 9s - loss: 0.0777 - acc: 0.9798
224/753 [=======>......................] - ETA: 8s - loss: 0.0764 - acc: 0.9806
256/753 [=========>....................] - ETA: 8s - loss: 0.0776 - acc: 0.9801
288/753 [==========>...................] - ETA: 7s - loss: 0.0838 - acc: 0.9766
320/753 [===========>..................] - ETA: 7s - loss: 0.0881 - acc: 0.9756
352/753 [=============>................] - ETA: 6s - loss: 0.0871 - acc: 0.9760
384/753 [==============>...............] - ETA: 6s - loss: 0.0880 - acc: 0.9755
416/753 [===============>..............] - ETA: 5s - loss: 0.0873 - acc: 0.9756
448/753 [================>.............] - ETA: 5s - loss: 0.0880 - acc: 0.9748
480/753 [==================>...........] - ETA: 4s - loss: 0.0882 - acc: 0.9748
512/753 [===================>..........] - ETA: 3s - loss: 0.0891 - acc: 0.9740
544/753 [====================>.........] - ETA: 3s - loss: 0.0906 - acc: 0.9737
576/753 [=====================>........] - ETA: 2s - loss: 0.0913 - acc: 0.9734
608/753 [=======================>......] - ETA: 2s - loss: 0.0940 - acc: 0.9722
640/753 [========================>.....] - ETA: 1s - loss: 0.0948 - acc: 0.9720
672/753 [=========================>....] - ETA: 1s - loss: 0.0938 - acc: 0.9723
704/753 [===========================>..] - ETA: 0s - loss: 0.0931 - acc: 0.9724
736/753 [============================>.] - ETA: 0s - loss: 0.0942 - acc: 0.9720
753/753 [==============================] - 13s 17ms/step - loss: 0.0955 - acc: 0.9717 - val_loss: 0.1827 - val_acc: 0.9444
Epoch 14/70

 32/753 [>.............................] - ETA: 11s - loss: 0.1172 - acc: 0.9717
 64/753 [=>............................] - ETA: 11s - loss: 0.0948 - acc: 0.9728
 96/753 [==>...........................] - ETA: 10s - loss: 0.0941 - acc: 0.9715
128/753 [====>.........................] - ETA: 10s - loss: 0.0973 - acc: 0.9710
160/753 [=====>........................] - ETA: 9s - loss: 0.0921 - acc: 0.9725 
192/753 [======>.......................] - ETA: 9s - loss: 0.0894 - acc: 0.9725
224/753 [=======>......................] - ETA: 8s - loss: 0.0914 - acc: 0.9711
256/753 [=========>....................] - ETA: 8s - loss: 0.0894 - acc: 0.9719
288/753 [==========>...................] - ETA: 7s - loss: 0.0896 - acc: 0.9718
320/753 [===========>..................] - ETA: 7s - loss: 0.0891 - acc: 0.9720
352/753 [=============>................] - ETA: 6s - loss: 0.0860 - acc: 0.9729
384/753 [==============>...............] - ETA: 6s - loss: 0.0889 - acc: 0.9726
416/753 [===============>..............] - ETA: 5s - loss: 0.0861 - acc: 0.9735
448/753 [================>.............] - ETA: 4s - loss: 0.0831 - acc: 0.9745
480/753 [==================>...........] - ETA: 4s - loss: 0.0871 - acc: 0.9731
512/753 [===================>..........] - ETA: 3s - loss: 0.0868 - acc: 0.9729
544/753 [====================>.........] - ETA: 3s - loss: 0.0870 - acc: 0.9728
576/753 [=====================>........] - ETA: 2s - loss: 0.0895 - acc: 0.9721
608/753 [=======================>......] - ETA: 2s - loss: 0.0883 - acc: 0.9726
640/753 [========================>.....] - ETA: 1s - loss: 0.0893 - acc: 0.9721
672/753 [=========================>....] - ETA: 1s - loss: 0.0906 - acc: 0.9717
704/753 [===========================>..] - ETA: 0s - loss: 0.0892 - acc: 0.9723
736/753 [============================>.] - ETA: 0s - loss: 0.0885 - acc: 0.9722
753/753 [==============================] - 13s 17ms/step - loss: 0.0880 - acc: 0.9725 - val_loss: 0.1819 - val_acc: 0.9495
Computing...
Manual evaluation: (didn't understand why I made this)
True 8105
False 966
True percentage 0.893506779848
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
      B-PER       0.90      0.75      0.82       438
      B-ORG       0.75      0.67      0.71       296
     B-MISC       0.41      0.30      0.35       141
     I-MISC       0.45      0.22      0.30       154
      I-ORG       0.53      0.54      0.54       151
      B-LOC       0.60      0.81      0.69       218
      I-LOC       0.59      0.82      0.69       141
      I-PER       0.87      0.64      0.73       214

avg / total       0.93      0.89      0.91      9071

F-1 Score:
0.664088069027
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 837 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100796 unique words.
Found 94 unique chars.
Found 9 unique labels.
792 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 253
OOV word occurences: 368
Padding...
Data padded!
Padding...
Data padded!
Padded until 67 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 67, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 67)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 67, 64)       6451008     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 67, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 67, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 67, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 67, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 67, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,954,114
Trainable params: 6,954,114
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 753 samples, validate on 84 samples
Epoch 1/70

 32/753 [>.............................] - ETA: 1:06 - loss: 2.1497 - acc: 0.1834
 64/753 [=>............................] - ETA: 37s - loss: 1.4549 - acc: 0.5071 
 96/753 [==>...........................] - ETA: 27s - loss: 1.5086 - acc: 0.6079
128/753 [====>.........................] - ETA: 22s - loss: 1.4981 - acc: 0.6501
160/753 [=====>........................] - ETA: 18s - loss: 1.3548 - acc: 0.6829
192/753 [======>.......................] - ETA: 16s - loss: 1.2522 - acc: 0.7017
224/753 [=======>......................] - ETA: 14s - loss: 1.1834 - acc: 0.7134
256/753 [=========>....................] - ETA: 12s - loss: 1.1286 - acc: 0.7226
288/753 [==========>...................] - ETA: 11s - loss: 1.0707 - acc: 0.7331
320/753 [===========>..................] - ETA: 10s - loss: 1.0237 - acc: 0.7417
352/753 [=============>................] - ETA: 9s - loss: 0.9948 - acc: 0.7465 
384/753 [==============>...............] - ETA: 8s - loss: 0.9632 - acc: 0.7526
416/753 [===============>..............] - ETA: 7s - loss: 0.9336 - acc: 0.7577
448/753 [================>.............] - ETA: 6s - loss: 0.9075 - acc: 0.7629
480/753 [==================>...........] - ETA: 5s - loss: 0.8784 - acc: 0.7700
512/753 [===================>..........] - ETA: 5s - loss: 0.8629 - acc: 0.7721
544/753 [====================>.........] - ETA: 4s - loss: 0.8546 - acc: 0.7747
576/753 [=====================>........] - ETA: 3s - loss: 0.8365 - acc: 0.7786
608/753 [=======================>......] - ETA: 3s - loss: 0.8192 - acc: 0.7824
640/753 [========================>.....] - ETA: 2s - loss: 0.7988 - acc: 0.7876
672/753 [=========================>....] - ETA: 1s - loss: 0.7828 - acc: 0.7909
704/753 [===========================>..] - ETA: 0s - loss: 0.7659 - acc: 0.7944
736/753 [============================>.] - ETA: 0s - loss: 0.7552 - acc: 0.7961
753/753 [==============================] - 16s 21ms/step - loss: 0.7466 - acc: 0.7982 - val_loss: 0.4419 - val_acc: 0.8550
Epoch 2/70

 32/753 [>.............................] - ETA: 11s - loss: 0.3209 - acc: 0.8994
 64/753 [=>............................] - ETA: 11s - loss: 0.3858 - acc: 0.8772
 96/753 [==>...........................] - ETA: 11s - loss: 0.4433 - acc: 0.8601
128/753 [====>.........................] - ETA: 10s - loss: 0.4097 - acc: 0.8709
160/753 [=====>........................] - ETA: 9s - loss: 0.3950 - acc: 0.8751 
192/753 [======>.......................] - ETA: 9s - loss: 0.3933 - acc: 0.8780
224/753 [=======>......................] - ETA: 8s - loss: 0.3835 - acc: 0.8807
256/753 [=========>....................] - ETA: 8s - loss: 0.3758 - acc: 0.8835
288/753 [==========>...................] - ETA: 7s - loss: 0.3719 - acc: 0.8846
320/753 [===========>..................] - ETA: 7s - loss: 0.3685 - acc: 0.8858
352/753 [=============>................] - ETA: 6s - loss: 0.3662 - acc: 0.8866
384/753 [==============>...............] - ETA: 6s - loss: 0.3622 - acc: 0.8885
416/753 [===============>..............] - ETA: 5s - loss: 0.3566 - acc: 0.8894
448/753 [================>.............] - ETA: 5s - loss: 0.3611 - acc: 0.8867
480/753 [==================>...........] - ETA: 4s - loss: 0.3593 - acc: 0.8875
512/753 [===================>..........] - ETA: 4s - loss: 0.3532 - acc: 0.8889
544/753 [====================>.........] - ETA: 3s - loss: 0.3526 - acc: 0.8904
576/753 [=====================>........] - ETA: 2s - loss: 0.3491 - acc: 0.8908
608/753 [=======================>......] - ETA: 2s - loss: 0.3460 - acc: 0.8923
640/753 [========================>.....] - ETA: 1s - loss: 0.3502 - acc: 0.8902
672/753 [=========================>....] - ETA: 1s - loss: 0.3493 - acc: 0.8907
704/753 [===========================>..] - ETA: 0s - loss: 0.3477 - acc: 0.8912
736/753 [============================>.] - ETA: 0s - loss: 0.3451 - acc: 0.8930
753/753 [==============================] - 13s 17ms/step - loss: 0.3454 - acc: 0.8926 - val_loss: 0.3090 - val_acc: 0.9010
Epoch 3/70

 32/753 [>.............................] - ETA: 11s - loss: 0.2939 - acc: 0.9137
 64/753 [=>............................] - ETA: 11s - loss: 0.3206 - acc: 0.8989
 96/753 [==>...........................] - ETA: 10s - loss: 0.2908 - acc: 0.9145
128/753 [====>.........................] - ETA: 10s - loss: 0.2711 - acc: 0.9170
160/753 [=====>........................] - ETA: 9s - loss: 0.2775 - acc: 0.9151 
192/753 [======>.......................] - ETA: 9s - loss: 0.2691 - acc: 0.9177
224/753 [=======>......................] - ETA: 8s - loss: 0.2662 - acc: 0.9192
256/753 [=========>....................] - ETA: 8s - loss: 0.2655 - acc: 0.9189
288/753 [==========>...................] - ETA: 7s - loss: 0.2670 - acc: 0.9179
320/753 [===========>..................] - ETA: 7s - loss: 0.2634 - acc: 0.9177
352/753 [=============>................] - ETA: 6s - loss: 0.2571 - acc: 0.9198
384/753 [==============>...............] - ETA: 6s - loss: 0.2556 - acc: 0.9197
416/753 [===============>..............] - ETA: 5s - loss: 0.2556 - acc: 0.9197
448/753 [================>.............] - ETA: 4s - loss: 0.2516 - acc: 0.9207
480/753 [==================>...........] - ETA: 4s - loss: 0.2545 - acc: 0.9190
512/753 [===================>..........] - ETA: 3s - loss: 0.2543 - acc: 0.9199
544/753 [====================>.........] - ETA: 3s - loss: 0.2534 - acc: 0.9199
576/753 [=====================>........] - ETA: 2s - loss: 0.2549 - acc: 0.9198
608/753 [=======================>......] - ETA: 2s - loss: 0.2537 - acc: 0.9206
640/753 [========================>.....] - ETA: 1s - loss: 0.2532 - acc: 0.9211
672/753 [=========================>....] - ETA: 1s - loss: 0.2512 - acc: 0.9223
704/753 [===========================>..] - ETA: 0s - loss: 0.2500 - acc: 0.9224
736/753 [============================>.] - ETA: 0s - loss: 0.2535 - acc: 0.9212
753/753 [==============================] - 13s 17ms/step - loss: 0.2559 - acc: 0.9205 - val_loss: 0.2753 - val_acc: 0.9061
Epoch 4/70

 32/753 [>.............................] - ETA: 11s - loss: 0.2536 - acc: 0.9174
 64/753 [=>............................] - ETA: 11s - loss: 0.2384 - acc: 0.9214
 96/753 [==>...........................] - ETA: 10s - loss: 0.2355 - acc: 0.9255
128/753 [====>.........................] - ETA: 10s - loss: 0.2258 - acc: 0.9285
160/753 [=====>........................] - ETA: 9s - loss: 0.2203 - acc: 0.9302 
192/753 [======>.......................] - ETA: 9s - loss: 0.2141 - acc: 0.9315
224/753 [=======>......................] - ETA: 8s - loss: 0.2279 - acc: 0.9266
256/753 [=========>....................] - ETA: 8s - loss: 0.2301 - acc: 0.9253
288/753 [==========>...................] - ETA: 7s - loss: 0.2254 - acc: 0.9275
320/753 [===========>..................] - ETA: 7s - loss: 0.2204 - acc: 0.9304
352/753 [=============>................] - ETA: 6s - loss: 0.2180 - acc: 0.9308
384/753 [==============>...............] - ETA: 6s - loss: 0.2176 - acc: 0.9311
416/753 [===============>..............] - ETA: 5s - loss: 0.2189 - acc: 0.9312
448/753 [================>.............] - ETA: 4s - loss: 0.2218 - acc: 0.9299
480/753 [==================>...........] - ETA: 4s - loss: 0.2227 - acc: 0.9295
512/753 [===================>..........] - ETA: 3s - loss: 0.2235 - acc: 0.9293
544/753 [====================>.........] - ETA: 3s - loss: 0.2192 - acc: 0.9306
576/753 [=====================>........] - ETA: 2s - loss: 0.2213 - acc: 0.9299
608/753 [=======================>......] - ETA: 2s - loss: 0.2174 - acc: 0.9310
640/753 [========================>.....] - ETA: 1s - loss: 0.2143 - acc: 0.9324
672/753 [=========================>....] - ETA: 1s - loss: 0.2114 - acc: 0.9336
704/753 [===========================>..] - ETA: 0s - loss: 0.2128 - acc: 0.9330
736/753 [============================>.] - ETA: 0s - loss: 0.2119 - acc: 0.9330
753/753 [==============================] - 13s 17ms/step - loss: 0.2101 - acc: 0.9335 - val_loss: 0.2453 - val_acc: 0.9155
Epoch 5/70

 32/753 [>.............................] - ETA: 11s - loss: 0.2353 - acc: 0.9259
 64/753 [=>............................] - ETA: 11s - loss: 0.1817 - acc: 0.9458
 96/753 [==>...........................] - ETA: 10s - loss: 0.1901 - acc: 0.9406
128/753 [====>.........................] - ETA: 10s - loss: 0.1953 - acc: 0.9401
160/753 [=====>........................] - ETA: 9s - loss: 0.1911 - acc: 0.9409 
192/753 [======>.......................] - ETA: 9s - loss: 0.1829 - acc: 0.9431
224/753 [=======>......................] - ETA: 8s - loss: 0.1732 - acc: 0.9455
256/753 [=========>....................] - ETA: 8s - loss: 0.1703 - acc: 0.9459
288/753 [==========>...................] - ETA: 7s - loss: 0.1725 - acc: 0.9461
320/753 [===========>..................] - ETA: 7s - loss: 0.1739 - acc: 0.9456
352/753 [=============>................] - ETA: 6s - loss: 0.1756 - acc: 0.9459
384/753 [==============>...............] - ETA: 6s - loss: 0.1764 - acc: 0.9446
416/753 [===============>..............] - ETA: 5s - loss: 0.1804 - acc: 0.9428
448/753 [================>.............] - ETA: 4s - loss: 0.1766 - acc: 0.9442
480/753 [==================>...........] - ETA: 4s - loss: 0.1790 - acc: 0.9440
512/753 [===================>..........] - ETA: 3s - loss: 0.1789 - acc: 0.9444
544/753 [====================>.........] - ETA: 3s - loss: 0.1789 - acc: 0.9450
576/753 [=====================>........] - ETA: 2s - loss: 0.1772 - acc: 0.9453
608/753 [=======================>......] - ETA: 2s - loss: 0.1762 - acc: 0.9459
640/753 [========================>.....] - ETA: 1s - loss: 0.1757 - acc: 0.9458
672/753 [=========================>....] - ETA: 1s - loss: 0.1774 - acc: 0.9453
704/753 [===========================>..] - ETA: 0s - loss: 0.1776 - acc: 0.9451
736/753 [============================>.] - ETA: 0s - loss: 0.1789 - acc: 0.9448
753/753 [==============================] - 13s 17ms/step - loss: 0.1792 - acc: 0.9446 - val_loss: 0.2114 - val_acc: 0.9337
Epoch 6/70

 32/753 [>.............................] - ETA: 11s - loss: 0.1955 - acc: 0.9467
 64/753 [=>............................] - ETA: 11s - loss: 0.1756 - acc: 0.9524
 96/753 [==>...........................] - ETA: 10s - loss: 0.1901 - acc: 0.9484
128/753 [====>.........................] - ETA: 10s - loss: 0.1889 - acc: 0.9491
160/753 [=====>........................] - ETA: 9s - loss: 0.1783 - acc: 0.9500 
192/753 [======>.......................] - ETA: 9s - loss: 0.1767 - acc: 0.9499
224/753 [=======>......................] - ETA: 8s - loss: 0.1723 - acc: 0.9505
256/753 [=========>....................] - ETA: 8s - loss: 0.1699 - acc: 0.9515
288/753 [==========>...................] - ETA: 7s - loss: 0.1721 - acc: 0.9492
320/753 [===========>..................] - ETA: 7s - loss: 0.1732 - acc: 0.9488
352/753 [=============>................] - ETA: 6s - loss: 0.1694 - acc: 0.9496
384/753 [==============>...............] - ETA: 6s - loss: 0.1671 - acc: 0.9490
416/753 [===============>..............] - ETA: 5s - loss: 0.1650 - acc: 0.9495
448/753 [================>.............] - ETA: 4s - loss: 0.1671 - acc: 0.9490
480/753 [==================>...........] - ETA: 4s - loss: 0.1651 - acc: 0.9500
512/753 [===================>..........] - ETA: 3s - loss: 0.1653 - acc: 0.9497
544/753 [====================>.........] - ETA: 3s - loss: 0.1634 - acc: 0.9499
576/753 [=====================>........] - ETA: 2s - loss: 0.1603 - acc: 0.9508
608/753 [=======================>......] - ETA: 2s - loss: 0.1586 - acc: 0.9516
640/753 [========================>.....] - ETA: 1s - loss: 0.1567 - acc: 0.9518
672/753 [=========================>....] - ETA: 1s - loss: 0.1568 - acc: 0.9518
704/753 [===========================>..] - ETA: 0s - loss: 0.1583 - acc: 0.9514
736/753 [============================>.] - ETA: 0s - loss: 0.1582 - acc: 0.9515
753/753 [==============================] - 13s 17ms/step - loss: 0.1574 - acc: 0.9517 - val_loss: 0.2164 - val_acc: 0.9333
Epoch 7/70

 32/753 [>.............................] - ETA: 11s - loss: 0.1793 - acc: 0.9438
 64/753 [=>............................] - ETA: 11s - loss: 0.1608 - acc: 0.9524
 96/753 [==>...........................] - ETA: 10s - loss: 0.1636 - acc: 0.9538
128/753 [====>.........................] - ETA: 10s - loss: 0.1644 - acc: 0.9509
160/753 [=====>........................] - ETA: 9s - loss: 0.1521 - acc: 0.9554 
192/753 [======>.......................] - ETA: 9s - loss: 0.1550 - acc: 0.9535
224/753 [=======>......................] - ETA: 8s - loss: 0.1471 - acc: 0.9564
256/753 [=========>....................] - ETA: 8s - loss: 0.1478 - acc: 0.9560
288/753 [==========>...................] - ETA: 7s - loss: 0.1483 - acc: 0.9547
320/753 [===========>..................] - ETA: 7s - loss: 0.1453 - acc: 0.9556
352/753 [=============>................] - ETA: 6s - loss: 0.1422 - acc: 0.9564
384/753 [==============>...............] - ETA: 6s - loss: 0.1416 - acc: 0.9564
416/753 [===============>..............] - ETA: 5s - loss: 0.1433 - acc: 0.9542
448/753 [================>.............] - ETA: 4s - loss: 0.1428 - acc: 0.9550
480/753 [==================>...........] - ETA: 4s - loss: 0.1395 - acc: 0.9562
512/753 [===================>..........] - ETA: 3s - loss: 0.1414 - acc: 0.9555
544/753 [====================>.........] - ETA: 3s - loss: 0.1432 - acc: 0.9551
576/753 [=====================>........] - ETA: 2s - loss: 0.1421 - acc: 0.9560
608/753 [=======================>......] - ETA: 2s - loss: 0.1423 - acc: 0.9557
640/753 [========================>.....] - ETA: 1s - loss: 0.1423 - acc: 0.9552
672/753 [=========================>....] - ETA: 1s - loss: 0.1448 - acc: 0.9546
704/753 [===========================>..] - ETA: 0s - loss: 0.1466 - acc: 0.9539
736/753 [============================>.] - ETA: 0s - loss: 0.1446 - acc: 0.9549
753/753 [==============================] - 13s 17ms/step - loss: 0.1456 - acc: 0.9548 - val_loss: 0.2155 - val_acc: 0.9346
Computing...
Manual evaluation: (didn't understand why I made this)
True 8056
False 1015
True percentage 0.88810494984
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.96      0.96      7318
      B-ORG       0.59      0.67      0.62       296
      I-ORG       0.45      0.52      0.48       151
      B-PER       0.90      0.76      0.82       438
     B-MISC       0.41      0.06      0.11       141
     I-MISC       0.36      0.12      0.18       154
      B-LOC       0.82      0.65      0.72       218
      I-LOC       0.79      0.71      0.75       141
      I-PER       0.86      0.61      0.72       214

avg / total       0.91      0.89      0.90      9071

F-1 Score:
0.638351822504
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 334 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100358 unique words.
Found 94 unique chars.
Found 9 unique labels.
354 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 287
OOV word occurences: 458
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6422976     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,926,082
Trainable params: 6,926,082
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 300 samples, validate on 34 samples
Epoch 1/70

 32/300 [==>...........................] - ETA: 22s - loss: 2.2196 - acc: 0.1212
 64/300 [=====>........................] - ETA: 11s - loss: 1.5624 - acc: 0.4614
 96/300 [========>.....................] - ETA: 7s - loss: 1.4982 - acc: 0.5651 
128/300 [===========>..................] - ETA: 5s - loss: 1.5324 - acc: 0.6009
160/300 [===============>..............] - ETA: 4s - loss: 1.3979 - acc: 0.6445
192/300 [==================>...........] - ETA: 2s - loss: 1.3030 - acc: 0.6673
224/300 [=====================>........] - ETA: 1s - loss: 1.2397 - acc: 0.6803
256/300 [========================>.....] - ETA: 1s - loss: 1.1791 - acc: 0.6945
288/300 [===========================>..] - ETA: 0s - loss: 1.1301 - acc: 0.7033
300/300 [==============================] - 7s 24ms/step - loss: 1.1112 - acc: 0.7065 - val_loss: 0.5648 - val_acc: 0.8157
Epoch 2/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.6557 - acc: 0.7960
 64/300 [=====>........................] - ETA: 3s - loss: 0.6339 - acc: 0.8013
 96/300 [========>.....................] - ETA: 2s - loss: 0.6035 - acc: 0.8123
128/300 [===========>..................] - ETA: 2s - loss: 0.5944 - acc: 0.8118
160/300 [===============>..............] - ETA: 2s - loss: 0.5830 - acc: 0.8219
192/300 [==================>...........] - ETA: 1s - loss: 0.5876 - acc: 0.8180
224/300 [=====================>........] - ETA: 1s - loss: 0.5918 - acc: 0.8211
256/300 [========================>.....] - ETA: 0s - loss: 0.5985 - acc: 0.8168
288/300 [===========================>..] - ETA: 0s - loss: 0.5859 - acc: 0.8214
300/300 [==============================] - 5s 15ms/step - loss: 0.5770 - acc: 0.8246 - val_loss: 0.3956 - val_acc: 0.8819
Epoch 3/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.4380 - acc: 0.8702
 64/300 [=====>........................] - ETA: 3s - loss: 0.4637 - acc: 0.8517
 96/300 [========>.....................] - ETA: 2s - loss: 0.4601 - acc: 0.8588
128/300 [===========>..................] - ETA: 2s - loss: 0.4648 - acc: 0.8545
160/300 [===============>..............] - ETA: 2s - loss: 0.4544 - acc: 0.8597
192/300 [==================>...........] - ETA: 1s - loss: 0.4449 - acc: 0.8612
224/300 [=====================>........] - ETA: 1s - loss: 0.4431 - acc: 0.8602
256/300 [========================>.....] - ETA: 0s - loss: 0.4365 - acc: 0.8630
288/300 [===========================>..] - ETA: 0s - loss: 0.4279 - acc: 0.8649
300/300 [==============================] - 5s 15ms/step - loss: 0.4216 - acc: 0.8669 - val_loss: 0.3112 - val_acc: 0.8956
Epoch 4/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.2669 - acc: 0.9207
 64/300 [=====>........................] - ETA: 3s - loss: 0.2943 - acc: 0.9120
 96/300 [========>.....................] - ETA: 2s - loss: 0.4449 - acc: 0.8748
128/300 [===========>..................] - ETA: 2s - loss: 0.5074 - acc: 0.8591
160/300 [===============>..............] - ETA: 2s - loss: 0.4911 - acc: 0.8646
192/300 [==================>...........] - ETA: 1s - loss: 0.4836 - acc: 0.8625
224/300 [=====================>........] - ETA: 1s - loss: 0.4625 - acc: 0.8676
256/300 [========================>.....] - ETA: 0s - loss: 0.4420 - acc: 0.8715
288/300 [===========================>..] - ETA: 0s - loss: 0.4291 - acc: 0.8746
300/300 [==============================] - 5s 15ms/step - loss: 0.4277 - acc: 0.8747 - val_loss: 0.2985 - val_acc: 0.9079
Epoch 5/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.3874 - acc: 0.8700
 64/300 [=====>........................] - ETA: 3s - loss: 0.3621 - acc: 0.8885
 96/300 [========>.....................] - ETA: 2s - loss: 0.3343 - acc: 0.8981
128/300 [===========>..................] - ETA: 2s - loss: 0.3384 - acc: 0.8957
160/300 [===============>..............] - ETA: 2s - loss: 0.3345 - acc: 0.8952
192/300 [==================>...........] - ETA: 1s - loss: 0.3317 - acc: 0.8957
224/300 [=====================>........] - ETA: 1s - loss: 0.3244 - acc: 0.8994
256/300 [========================>.....] - ETA: 0s - loss: 0.3117 - acc: 0.9044
288/300 [===========================>..] - ETA: 0s - loss: 0.3063 - acc: 0.9049
300/300 [==============================] - 5s 15ms/step - loss: 0.3058 - acc: 0.9046 - val_loss: 0.2952 - val_acc: 0.9202
Epoch 6/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.2803 - acc: 0.9285
 64/300 [=====>........................] - ETA: 3s - loss: 0.3022 - acc: 0.9145
 96/300 [========>.....................] - ETA: 3s - loss: 0.2924 - acc: 0.9112
128/300 [===========>..................] - ETA: 2s - loss: 0.2742 - acc: 0.9181
160/300 [===============>..............] - ETA: 2s - loss: 0.2830 - acc: 0.9164
192/300 [==================>...........] - ETA: 1s - loss: 0.2797 - acc: 0.9190
224/300 [=====================>........] - ETA: 1s - loss: 0.2715 - acc: 0.9199
256/300 [========================>.....] - ETA: 0s - loss: 0.2633 - acc: 0.9224
288/300 [===========================>..] - ETA: 0s - loss: 0.2597 - acc: 0.9224
300/300 [==============================] - 5s 15ms/step - loss: 0.2587 - acc: 0.9230 - val_loss: 0.2563 - val_acc: 0.9212
Epoch 7/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.2377 - acc: 0.9237
 64/300 [=====>........................] - ETA: 3s - loss: 0.2013 - acc: 0.9399
 96/300 [========>.....................] - ETA: 2s - loss: 0.2378 - acc: 0.9247
128/300 [===========>..................] - ETA: 2s - loss: 0.2405 - acc: 0.9253
160/300 [===============>..............] - ETA: 1s - loss: 0.2376 - acc: 0.9257
192/300 [==================>...........] - ETA: 1s - loss: 0.2344 - acc: 0.9264
224/300 [=====================>........] - ETA: 1s - loss: 0.2318 - acc: 0.9263
256/300 [========================>.....] - ETA: 0s - loss: 0.2381 - acc: 0.9242
288/300 [===========================>..] - ETA: 0s - loss: 0.2306 - acc: 0.9277
300/300 [==============================] - 4s 15ms/step - loss: 0.2287 - acc: 0.9278 - val_loss: 0.2546 - val_acc: 0.9202
Epoch 8/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.1963 - acc: 0.9320
 64/300 [=====>........................] - ETA: 3s - loss: 0.1868 - acc: 0.9387
 96/300 [========>.....................] - ETA: 2s - loss: 0.2099 - acc: 0.9342
128/300 [===========>..................] - ETA: 2s - loss: 0.2139 - acc: 0.9318
160/300 [===============>..............] - ETA: 1s - loss: 0.2090 - acc: 0.9336
192/300 [==================>...........] - ETA: 1s - loss: 0.2076 - acc: 0.9339
224/300 [=====================>........] - ETA: 1s - loss: 0.2050 - acc: 0.9366
256/300 [========================>.....] - ETA: 0s - loss: 0.2042 - acc: 0.9361
288/300 [===========================>..] - ETA: 0s - loss: 0.2083 - acc: 0.9332
300/300 [==============================] - 5s 15ms/step - loss: 0.2094 - acc: 0.9327 - val_loss: 0.2933 - val_acc: 0.9042
Epoch 9/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.1996 - acc: 0.9323
 64/300 [=====>........................] - ETA: 3s - loss: 0.1857 - acc: 0.9406
 96/300 [========>.....................] - ETA: 2s - loss: 0.1695 - acc: 0.9444
128/300 [===========>..................] - ETA: 2s - loss: 0.1656 - acc: 0.9453
160/300 [===============>..............] - ETA: 1s - loss: 0.1808 - acc: 0.9420
192/300 [==================>...........] - ETA: 1s - loss: 0.1873 - acc: 0.9398
224/300 [=====================>........] - ETA: 1s - loss: 0.1878 - acc: 0.9405
256/300 [========================>.....] - ETA: 0s - loss: 0.1869 - acc: 0.9405
288/300 [===========================>..] - ETA: 0s - loss: 0.1911 - acc: 0.9402
300/300 [==============================] - 5s 15ms/step - loss: 0.1916 - acc: 0.9397 - val_loss: 0.2320 - val_acc: 0.9277
Epoch 10/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.1196 - acc: 0.9583
 64/300 [=====>........................] - ETA: 3s - loss: 0.1453 - acc: 0.9574
 96/300 [========>.....................] - ETA: 2s - loss: 0.1683 - acc: 0.9449
128/300 [===========>..................] - ETA: 2s - loss: 0.1810 - acc: 0.9419
160/300 [===============>..............] - ETA: 1s - loss: 0.1833 - acc: 0.9417
192/300 [==================>...........] - ETA: 1s - loss: 0.1832 - acc: 0.9416
224/300 [=====================>........] - ETA: 1s - loss: 0.1808 - acc: 0.9434
256/300 [========================>.....] - ETA: 0s - loss: 0.1823 - acc: 0.9432
288/300 [===========================>..] - ETA: 0s - loss: 0.1791 - acc: 0.9436
300/300 [==============================] - 5s 15ms/step - loss: 0.1773 - acc: 0.9447 - val_loss: 0.2288 - val_acc: 0.9301
Epoch 11/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.1580 - acc: 0.9507
 64/300 [=====>........................] - ETA: 3s - loss: 0.1716 - acc: 0.9484
 96/300 [========>.....................] - ETA: 2s - loss: 0.1723 - acc: 0.9476
128/300 [===========>..................] - ETA: 2s - loss: 0.1703 - acc: 0.9477
160/300 [===============>..............] - ETA: 1s - loss: 0.1707 - acc: 0.9471
192/300 [==================>...........] - ETA: 1s - loss: 0.1679 - acc: 0.9486
224/300 [=====================>........] - ETA: 1s - loss: 0.1611 - acc: 0.9520
256/300 [========================>.....] - ETA: 0s - loss: 0.1579 - acc: 0.9542
288/300 [===========================>..] - ETA: 0s - loss: 0.1589 - acc: 0.9538
300/300 [==============================] - 5s 15ms/step - loss: 0.1611 - acc: 0.9531 - val_loss: 0.2633 - val_acc: 0.9141
Epoch 12/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.1837 - acc: 0.9393
 64/300 [=====>........................] - ETA: 3s - loss: 0.1842 - acc: 0.9396
 96/300 [========>.....................] - ETA: 2s - loss: 0.1655 - acc: 0.9485
128/300 [===========>..................] - ETA: 2s - loss: 0.1580 - acc: 0.9512
160/300 [===============>..............] - ETA: 1s - loss: 0.1522 - acc: 0.9542
192/300 [==================>...........] - ETA: 1s - loss: 0.1514 - acc: 0.9549
224/300 [=====================>........] - ETA: 1s - loss: 0.1523 - acc: 0.9532
256/300 [========================>.....] - ETA: 0s - loss: 0.1504 - acc: 0.9544
288/300 [===========================>..] - ETA: 0s - loss: 0.1502 - acc: 0.9542
300/300 [==============================] - 4s 15ms/step - loss: 0.1494 - acc: 0.9544 - val_loss: 0.2414 - val_acc: 0.9254
Computing...
Manual evaluation: (didn't understand why I made this)
True 7874
False 1197
True percentage 0.868041009811
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-PER       0.87      0.68      0.77       438
      B-LOC       0.65      0.61      0.63       218
      B-ORG       0.69      0.54      0.61       296
      I-ORG       0.37      0.19      0.25       151
      I-PER       0.84      0.54      0.66       214
      I-LOC       0.71      0.60      0.65       141
     B-MISC       0.24      0.21      0.22       141
     I-MISC       0.28      0.41      0.33       154

avg / total       0.91      0.87      0.89      9071

F-1 Score:
0.568847352025
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 334 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100395 unique words.
Found 94 unique chars.
Found 9 unique labels.
391 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 281
OOV word occurences: 416
Padding...
Data padded!
Padding...
Data padded!
Padded until 58 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 58, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 58)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 58, 64)       6425344     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 58, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 58, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 58, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 58, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 58, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,928,450
Trainable params: 6,928,450
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 300 samples, validate on 34 samples
Epoch 1/70

 32/300 [==>...........................] - ETA: 21s - loss: 2.5785 - acc: 0.0267
 64/300 [=====>........................] - ETA: 11s - loss: 1.7171 - acc: 0.4288
 96/300 [========>.....................] - ETA: 7s - loss: 1.9943 - acc: 0.5484 
128/300 [===========>..................] - ETA: 5s - loss: 1.7961 - acc: 0.6072
160/300 [===============>..............] - ETA: 3s - loss: 1.6213 - acc: 0.6435
192/300 [==================>...........] - ETA: 2s - loss: 1.4849 - acc: 0.6721
224/300 [=====================>........] - ETA: 1s - loss: 1.3732 - acc: 0.6908
256/300 [========================>.....] - ETA: 1s - loss: 1.3009 - acc: 0.7037
288/300 [===========================>..] - ETA: 0s - loss: 1.2379 - acc: 0.7134
300/300 [==============================] - 7s 24ms/step - loss: 1.2170 - acc: 0.7170 - val_loss: 0.7012 - val_acc: 0.7985
Epoch 2/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.6720 - acc: 0.8006
 64/300 [=====>........................] - ETA: 3s - loss: 0.6182 - acc: 0.8184
 96/300 [========>.....................] - ETA: 3s - loss: 0.6392 - acc: 0.8079
128/300 [===========>..................] - ETA: 2s - loss: 0.6198 - acc: 0.8164
160/300 [===============>..............] - ETA: 2s - loss: 0.6200 - acc: 0.8167
192/300 [==================>...........] - ETA: 1s - loss: 0.6086 - acc: 0.8185
224/300 [=====================>........] - ETA: 1s - loss: 0.5923 - acc: 0.8210
256/300 [========================>.....] - ETA: 0s - loss: 0.5858 - acc: 0.8238
288/300 [===========================>..] - ETA: 0s - loss: 0.5697 - acc: 0.8265
300/300 [==============================] - 5s 16ms/step - loss: 0.5709 - acc: 0.8263 - val_loss: 0.6132 - val_acc: 0.8274
Epoch 3/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.5827 - acc: 0.8453
 64/300 [=====>........................] - ETA: 3s - loss: 0.5971 - acc: 0.8398
 96/300 [========>.....................] - ETA: 2s - loss: 0.5945 - acc: 0.8499
128/300 [===========>..................] - ETA: 2s - loss: 0.5471 - acc: 0.8580
160/300 [===============>..............] - ETA: 2s - loss: 0.5328 - acc: 0.8528
192/300 [==================>...........] - ETA: 1s - loss: 0.5124 - acc: 0.8577
224/300 [=====================>........] - ETA: 1s - loss: 0.5043 - acc: 0.8576
256/300 [========================>.....] - ETA: 0s - loss: 0.5052 - acc: 0.8552
288/300 [===========================>..] - ETA: 0s - loss: 0.4919 - acc: 0.8604
300/300 [==============================] - 5s 16ms/step - loss: 0.4873 - acc: 0.8616 - val_loss: 0.4652 - val_acc: 0.8545
Epoch 4/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.3897 - acc: 0.8864
 64/300 [=====>........................] - ETA: 3s - loss: 0.4125 - acc: 0.8767
 96/300 [========>.....................] - ETA: 2s - loss: 0.3906 - acc: 0.8874
128/300 [===========>..................] - ETA: 2s - loss: 0.3763 - acc: 0.8880
160/300 [===============>..............] - ETA: 2s - loss: 0.3590 - acc: 0.8948
192/300 [==================>...........] - ETA: 1s - loss: 0.3576 - acc: 0.8975
224/300 [=====================>........] - ETA: 1s - loss: 0.3520 - acc: 0.8992
256/300 [========================>.....] - ETA: 0s - loss: 0.3426 - acc: 0.9028
288/300 [===========================>..] - ETA: 0s - loss: 0.3453 - acc: 0.9008
300/300 [==============================] - 5s 16ms/step - loss: 0.3434 - acc: 0.9015 - val_loss: 0.3954 - val_acc: 0.8725
Epoch 5/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.3532 - acc: 0.8863
 64/300 [=====>........................] - ETA: 3s - loss: 0.3336 - acc: 0.9017
 96/300 [========>.....................] - ETA: 2s - loss: 0.3010 - acc: 0.9127
128/300 [===========>..................] - ETA: 2s - loss: 0.2941 - acc: 0.9148
160/300 [===============>..............] - ETA: 2s - loss: 0.2990 - acc: 0.9123
192/300 [==================>...........] - ETA: 1s - loss: 0.2859 - acc: 0.9174
224/300 [=====================>........] - ETA: 1s - loss: 0.2800 - acc: 0.9175
256/300 [========================>.....] - ETA: 0s - loss: 0.2779 - acc: 0.9190
288/300 [===========================>..] - ETA: 0s - loss: 0.2822 - acc: 0.9178
300/300 [==============================] - 5s 16ms/step - loss: 0.2808 - acc: 0.9179 - val_loss: 0.3331 - val_acc: 0.8901
Epoch 6/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.2382 - acc: 0.9308
 64/300 [=====>........................] - ETA: 3s - loss: 0.2402 - acc: 0.9374
 96/300 [========>.....................] - ETA: 2s - loss: 0.2386 - acc: 0.9344
128/300 [===========>..................] - ETA: 2s - loss: 0.2374 - acc: 0.9319
160/300 [===============>..............] - ETA: 2s - loss: 0.2420 - acc: 0.9311
192/300 [==================>...........] - ETA: 1s - loss: 0.2434 - acc: 0.9298
224/300 [=====================>........] - ETA: 1s - loss: 0.2459 - acc: 0.9292
256/300 [========================>.....] - ETA: 0s - loss: 0.2446 - acc: 0.9295
288/300 [===========================>..] - ETA: 0s - loss: 0.2423 - acc: 0.9298
300/300 [==============================] - 5s 15ms/step - loss: 0.2473 - acc: 0.9275 - val_loss: 0.3829 - val_acc: 0.8885
Epoch 7/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.3381 - acc: 0.8920
 64/300 [=====>........................] - ETA: 3s - loss: 0.3016 - acc: 0.8992
 96/300 [========>.....................] - ETA: 2s - loss: 0.2793 - acc: 0.9080
128/300 [===========>..................] - ETA: 2s - loss: 0.2676 - acc: 0.9145
160/300 [===============>..............] - ETA: 2s - loss: 0.2524 - acc: 0.9201
192/300 [==================>...........] - ETA: 1s - loss: 0.2509 - acc: 0.9201
224/300 [=====================>........] - ETA: 1s - loss: 0.2392 - acc: 0.9249
256/300 [========================>.....] - ETA: 0s - loss: 0.2350 - acc: 0.9281
288/300 [===========================>..] - ETA: 0s - loss: 0.2279 - acc: 0.9306
300/300 [==============================] - 5s 15ms/step - loss: 0.2294 - acc: 0.9298 - val_loss: 0.3067 - val_acc: 0.9123
Epoch 8/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.2127 - acc: 0.9419
 64/300 [=====>........................] - ETA: 3s - loss: 0.1943 - acc: 0.9462
 96/300 [========>.....................] - ETA: 2s - loss: 0.1811 - acc: 0.9478
128/300 [===========>..................] - ETA: 2s - loss: 0.1818 - acc: 0.9452
160/300 [===============>..............] - ETA: 2s - loss: 0.1770 - acc: 0.9463
192/300 [==================>...........] - ETA: 1s - loss: 0.1869 - acc: 0.9431
224/300 [=====================>........] - ETA: 1s - loss: 0.1929 - acc: 0.9398
256/300 [========================>.....] - ETA: 0s - loss: 0.1912 - acc: 0.9426
288/300 [===========================>..] - ETA: 0s - loss: 0.1884 - acc: 0.9435
300/300 [==============================] - 5s 15ms/step - loss: 0.1963 - acc: 0.9413 - val_loss: 0.3066 - val_acc: 0.9095
Epoch 9/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.2380 - acc: 0.9325
 64/300 [=====>........................] - ETA: 3s - loss: 0.2089 - acc: 0.9410
 96/300 [========>.....................] - ETA: 2s - loss: 0.1994 - acc: 0.9433
128/300 [===========>..................] - ETA: 2s - loss: 0.1906 - acc: 0.9431
160/300 [===============>..............] - ETA: 2s - loss: 0.1853 - acc: 0.9440
192/300 [==================>...........] - ETA: 1s - loss: 0.1837 - acc: 0.9436
224/300 [=====================>........] - ETA: 1s - loss: 0.1813 - acc: 0.9444
256/300 [========================>.....] - ETA: 0s - loss: 0.1809 - acc: 0.9452
288/300 [===========================>..] - ETA: 0s - loss: 0.1798 - acc: 0.9445
300/300 [==============================] - 5s 15ms/step - loss: 0.1761 - acc: 0.9460 - val_loss: 0.2747 - val_acc: 0.9040
Epoch 10/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.2540 - acc: 0.9242
 64/300 [=====>........................] - ETA: 3s - loss: 0.2167 - acc: 0.9322
 96/300 [========>.....................] - ETA: 2s - loss: 0.2148 - acc: 0.9359
128/300 [===========>..................] - ETA: 2s - loss: 0.1973 - acc: 0.9438
160/300 [===============>..............] - ETA: 1s - loss: 0.1908 - acc: 0.9446
192/300 [==================>...........] - ETA: 1s - loss: 0.1867 - acc: 0.9457
224/300 [=====================>........] - ETA: 1s - loss: 0.1777 - acc: 0.9486
256/300 [========================>.....] - ETA: 0s - loss: 0.1702 - acc: 0.9507
288/300 [===========================>..] - ETA: 0s - loss: 0.1642 - acc: 0.9527
300/300 [==============================] - 5s 15ms/step - loss: 0.1633 - acc: 0.9528 - val_loss: 0.3155 - val_acc: 0.9024
Epoch 11/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.1031 - acc: 0.9728
 64/300 [=====>........................] - ETA: 3s - loss: 0.1139 - acc: 0.9686
 96/300 [========>.....................] - ETA: 2s - loss: 0.1129 - acc: 0.9682
128/300 [===========>..................] - ETA: 2s - loss: 0.1185 - acc: 0.9643
160/300 [===============>..............] - ETA: 1s - loss: 0.1282 - acc: 0.9595
192/300 [==================>...........] - ETA: 1s - loss: 0.1330 - acc: 0.9574
224/300 [=====================>........] - ETA: 1s - loss: 0.1328 - acc: 0.9590
256/300 [========================>.....] - ETA: 0s - loss: 0.1339 - acc: 0.9578
288/300 [===========================>..] - ETA: 0s - loss: 0.1397 - acc: 0.9564
300/300 [==============================] - 5s 15ms/step - loss: 0.1412 - acc: 0.9561 - val_loss: 0.2576 - val_acc: 0.9055
Epoch 12/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.1144 - acc: 0.9687
 64/300 [=====>........................] - ETA: 3s - loss: 0.1193 - acc: 0.9698
 96/300 [========>.....................] - ETA: 2s - loss: 0.1133 - acc: 0.9683
128/300 [===========>..................] - ETA: 2s - loss: 0.1241 - acc: 0.9630
160/300 [===============>..............] - ETA: 2s - loss: 0.1140 - acc: 0.9663
192/300 [==================>...........] - ETA: 1s - loss: 0.1263 - acc: 0.9616
224/300 [=====================>........] - ETA: 1s - loss: 0.1331 - acc: 0.9604
256/300 [========================>.....] - ETA: 0s - loss: 0.1335 - acc: 0.9603
288/300 [===========================>..] - ETA: 0s - loss: 0.1296 - acc: 0.9611
300/300 [==============================] - 5s 15ms/step - loss: 0.1331 - acc: 0.9593 - val_loss: 0.2927 - val_acc: 0.8970
Epoch 13/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.1279 - acc: 0.9582
 64/300 [=====>........................] - ETA: 3s - loss: 0.1301 - acc: 0.9546
 96/300 [========>.....................] - ETA: 2s - loss: 0.1247 - acc: 0.9573
128/300 [===========>..................] - ETA: 2s - loss: 0.1226 - acc: 0.9621
160/300 [===============>..............] - ETA: 1s - loss: 0.1211 - acc: 0.9624
192/300 [==================>...........] - ETA: 1s - loss: 0.1172 - acc: 0.9647
224/300 [=====================>........] - ETA: 1s - loss: 0.1143 - acc: 0.9648
256/300 [========================>.....] - ETA: 0s - loss: 0.1160 - acc: 0.9650
288/300 [===========================>..] - ETA: 0s - loss: 0.1216 - acc: 0.9633
300/300 [==============================] - 5s 15ms/step - loss: 0.1202 - acc: 0.9637 - val_loss: 0.2661 - val_acc: 0.9097
Computing...
Manual evaluation: (didn't understand why I made this)
True 7961
False 1110
True percentage 0.877632014111
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-ORG       0.66      0.63      0.64       296
      B-LOC       0.68      0.69      0.68       218
      I-ORG       0.41      0.40      0.41       151
     B-MISC       0.21      0.09      0.12       141
     I-MISC       0.30      0.11      0.16       154
      B-PER       0.85      0.79      0.82       438
      I-PER       0.88      0.56      0.68       214
      I-LOC       0.62      0.80      0.70       141

avg / total       0.91      0.88      0.89      9071

F-1 Score:
0.618607516944
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 334 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100363 unique words.
Found 94 unique chars.
Found 9 unique labels.
359 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 287
OOV word occurences: 450
Padding...
Data padded!
Padding...
Data padded!
Padded until 66 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 66 tokens.
Padded until 24 chars.
Padded until 66 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 66, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 66)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 66, 64)       6423296     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 66, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 66, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 66, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 66, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 66, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,926,402
Trainable params: 6,926,402
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 300 samples, validate on 34 samples
Epoch 1/70

 32/300 [==>...........................] - ETA: 22s - loss: 2.0282 - acc: 0.2108
 64/300 [=====>........................] - ETA: 12s - loss: 1.4767 - acc: 0.5032
 96/300 [========>.....................] - ETA: 8s - loss: 1.2756 - acc: 0.6089 
128/300 [===========>..................] - ETA: 5s - loss: 1.2974 - acc: 0.6621
160/300 [===============>..............] - ETA: 4s - loss: 1.2314 - acc: 0.6843
192/300 [==================>...........] - ETA: 3s - loss: 1.1518 - acc: 0.7036
224/300 [=====================>........] - ETA: 2s - loss: 1.0842 - acc: 0.7203
256/300 [========================>.....] - ETA: 1s - loss: 1.0269 - acc: 0.7339
288/300 [===========================>..] - ETA: 0s - loss: 0.9891 - acc: 0.7424
300/300 [==============================] - 8s 26ms/step - loss: 0.9694 - acc: 0.7471 - val_loss: 0.6182 - val_acc: 0.8022
Epoch 2/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.5345 - acc: 0.8452
 64/300 [=====>........................] - ETA: 3s - loss: 0.5817 - acc: 0.8227
 96/300 [========>.....................] - ETA: 3s - loss: 0.5630 - acc: 0.8281
128/300 [===========>..................] - ETA: 2s - loss: 0.5348 - acc: 0.8364
160/300 [===============>..............] - ETA: 2s - loss: 0.5266 - acc: 0.8380
192/300 [==================>...........] - ETA: 1s - loss: 0.5253 - acc: 0.8362
224/300 [=====================>........] - ETA: 1s - loss: 0.5204 - acc: 0.8376
256/300 [========================>.....] - ETA: 0s - loss: 0.5082 - acc: 0.8413
288/300 [===========================>..] - ETA: 0s - loss: 0.5058 - acc: 0.8466
300/300 [==============================] - 5s 18ms/step - loss: 0.5106 - acc: 0.8451 - val_loss: 0.5066 - val_acc: 0.8816
Epoch 3/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.5038 - acc: 0.8884
 64/300 [=====>........................] - ETA: 3s - loss: 0.4537 - acc: 0.8801
 96/300 [========>.....................] - ETA: 3s - loss: 0.4488 - acc: 0.8765
128/300 [===========>..................] - ETA: 2s - loss: 0.4266 - acc: 0.8798
160/300 [===============>..............] - ETA: 2s - loss: 0.4297 - acc: 0.8750
192/300 [==================>...........] - ETA: 1s - loss: 0.4168 - acc: 0.8770
224/300 [=====================>........] - ETA: 1s - loss: 0.4086 - acc: 0.8795
256/300 [========================>.....] - ETA: 0s - loss: 0.4082 - acc: 0.8792
288/300 [===========================>..] - ETA: 0s - loss: 0.3987 - acc: 0.8812
300/300 [==============================] - 5s 17ms/step - loss: 0.3941 - acc: 0.8825 - val_loss: 0.3808 - val_acc: 0.8830
Epoch 4/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.3854 - acc: 0.8812
 64/300 [=====>........................] - ETA: 3s - loss: 0.3388 - acc: 0.8912
 96/300 [========>.....................] - ETA: 3s - loss: 0.3309 - acc: 0.9003
128/300 [===========>..................] - ETA: 2s - loss: 0.3344 - acc: 0.8967
160/300 [===============>..............] - ETA: 2s - loss: 0.3246 - acc: 0.9005
192/300 [==================>...........] - ETA: 1s - loss: 0.3244 - acc: 0.9013
224/300 [=====================>........] - ETA: 1s - loss: 0.3218 - acc: 0.9031
256/300 [========================>.....] - ETA: 0s - loss: 0.3189 - acc: 0.9041
288/300 [===========================>..] - ETA: 0s - loss: 0.3085 - acc: 0.9070
300/300 [==============================] - 5s 17ms/step - loss: 0.3056 - acc: 0.9080 - val_loss: 0.3026 - val_acc: 0.9067
Epoch 5/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.2854 - acc: 0.9188
 64/300 [=====>........................] - ETA: 3s - loss: 0.2959 - acc: 0.9044
 96/300 [========>.....................] - ETA: 3s - loss: 0.2922 - acc: 0.9078
128/300 [===========>..................] - ETA: 2s - loss: 0.2935 - acc: 0.9047
160/300 [===============>..............] - ETA: 2s - loss: 0.2834 - acc: 0.9098
192/300 [==================>...........] - ETA: 1s - loss: 0.2772 - acc: 0.9122
224/300 [=====================>........] - ETA: 1s - loss: 0.2759 - acc: 0.9126
256/300 [========================>.....] - ETA: 0s - loss: 0.2708 - acc: 0.9151
288/300 [===========================>..] - ETA: 0s - loss: 0.2632 - acc: 0.9184
300/300 [==============================] - 5s 17ms/step - loss: 0.2606 - acc: 0.9187 - val_loss: 0.2937 - val_acc: 0.8974
Epoch 6/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.2346 - acc: 0.9195
 64/300 [=====>........................] - ETA: 3s - loss: 0.2310 - acc: 0.9180
 96/300 [========>.....................] - ETA: 3s - loss: 0.2292 - acc: 0.9208
128/300 [===========>..................] - ETA: 2s - loss: 0.2421 - acc: 0.9172
160/300 [===============>..............] - ETA: 2s - loss: 0.2298 - acc: 0.9256
192/300 [==================>...........] - ETA: 1s - loss: 0.2318 - acc: 0.9259
224/300 [=====================>........] - ETA: 1s - loss: 0.2323 - acc: 0.9249
256/300 [========================>.....] - ETA: 0s - loss: 0.2300 - acc: 0.9241
288/300 [===========================>..] - ETA: 0s - loss: 0.2291 - acc: 0.9246
300/300 [==============================] - 5s 17ms/step - loss: 0.2301 - acc: 0.9245 - val_loss: 0.3410 - val_acc: 0.8915
Epoch 7/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.1723 - acc: 0.9409
 64/300 [=====>........................] - ETA: 3s - loss: 0.1967 - acc: 0.9362
 96/300 [========>.....................] - ETA: 3s - loss: 0.2070 - acc: 0.9339
128/300 [===========>..................] - ETA: 2s - loss: 0.1964 - acc: 0.9368
160/300 [===============>..............] - ETA: 2s - loss: 0.1946 - acc: 0.9401
192/300 [==================>...........] - ETA: 1s - loss: 0.2034 - acc: 0.9374
224/300 [=====================>........] - ETA: 1s - loss: 0.2026 - acc: 0.9370
256/300 [========================>.....] - ETA: 0s - loss: 0.2024 - acc: 0.9374
288/300 [===========================>..] - ETA: 0s - loss: 0.1982 - acc: 0.9382
300/300 [==============================] - 5s 17ms/step - loss: 0.1971 - acc: 0.9377 - val_loss: 0.3538 - val_acc: 0.8889
Computing...
Manual evaluation: (didn't understand why I made this)
True 7713
False 1358
True percentage 0.850292139786
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.96      0.95      7318
      B-PER       0.82      0.65      0.73       438
      B-ORG       0.62      0.45      0.52       296
      I-ORG       0.27      0.26      0.27       151
      I-PER       0.93      0.37      0.53       214
      B-LOC       0.90      0.34      0.49       218
      I-LOC       1.00      0.21      0.35       141
     B-MISC       0.18      0.19      0.18       141
     I-MISC       0.21      0.10      0.14       154

avg / total       0.89      0.85      0.86      9071

F-1 Score:
0.474740484429
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 334 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100362 unique words.
Found 94 unique chars.
Found 9 unique labels.
358 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 281
OOV word occurences: 425
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6423232     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,926,338
Trainable params: 6,926,338
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 300 samples, validate on 34 samples
Epoch 1/70

 32/300 [==>...........................] - ETA: 22s - loss: 2.1473 - acc: 0.2942
 64/300 [=====>........................] - ETA: 11s - loss: 1.4707 - acc: 0.5624
 96/300 [========>.....................] - ETA: 7s - loss: 1.4828 - acc: 0.6416 
128/300 [===========>..................] - ETA: 5s - loss: 1.4690 - acc: 0.6751
160/300 [===============>..............] - ETA: 3s - loss: 1.3426 - acc: 0.7017
192/300 [==================>...........] - ETA: 2s - loss: 1.2408 - acc: 0.7215
224/300 [=====================>........] - ETA: 1s - loss: 1.1614 - acc: 0.7356
256/300 [========================>.....] - ETA: 1s - loss: 1.1055 - acc: 0.7437
288/300 [===========================>..] - ETA: 0s - loss: 1.0430 - acc: 0.7551
300/300 [==============================] - 7s 24ms/step - loss: 1.0270 - acc: 0.7573 - val_loss: 0.5981 - val_acc: 0.8155
Epoch 2/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.6007 - acc: 0.8230
 64/300 [=====>........................] - ETA: 3s - loss: 0.6593 - acc: 0.8050
 96/300 [========>.....................] - ETA: 2s - loss: 0.6335 - acc: 0.8145
128/300 [===========>..................] - ETA: 2s - loss: 0.6244 - acc: 0.8156
160/300 [===============>..............] - ETA: 2s - loss: 0.6095 - acc: 0.8179
192/300 [==================>...........] - ETA: 1s - loss: 0.5734 - acc: 0.8271
224/300 [=====================>........] - ETA: 1s - loss: 0.5589 - acc: 0.8293
256/300 [========================>.....] - ETA: 0s - loss: 0.5527 - acc: 0.8329
288/300 [===========================>..] - ETA: 0s - loss: 0.5304 - acc: 0.8393
300/300 [==============================] - 5s 15ms/step - loss: 0.5301 - acc: 0.8382 - val_loss: 0.4423 - val_acc: 0.8757
Epoch 3/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.3914 - acc: 0.8796
 64/300 [=====>........................] - ETA: 3s - loss: 0.4914 - acc: 0.8451
 96/300 [========>.....................] - ETA: 2s - loss: 0.5221 - acc: 0.8529
128/300 [===========>..................] - ETA: 2s - loss: 0.4980 - acc: 0.8583
160/300 [===============>..............] - ETA: 2s - loss: 0.4859 - acc: 0.8591
192/300 [==================>...........] - ETA: 1s - loss: 0.4706 - acc: 0.8600
224/300 [=====================>........] - ETA: 1s - loss: 0.4624 - acc: 0.8622
256/300 [========================>.....] - ETA: 0s - loss: 0.4493 - acc: 0.8655
288/300 [===========================>..] - ETA: 0s - loss: 0.4322 - acc: 0.8709
300/300 [==============================] - 5s 15ms/step - loss: 0.4302 - acc: 0.8703 - val_loss: 0.3855 - val_acc: 0.8947
Epoch 4/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.4554 - acc: 0.8647
 64/300 [=====>........................] - ETA: 3s - loss: 0.4160 - acc: 0.8781
 96/300 [========>.....................] - ETA: 2s - loss: 0.3768 - acc: 0.8847
128/300 [===========>..................] - ETA: 2s - loss: 0.3577 - acc: 0.8916
160/300 [===============>..............] - ETA: 2s - loss: 0.3477 - acc: 0.8947
192/300 [==================>...........] - ETA: 1s - loss: 0.3454 - acc: 0.8938
224/300 [=====================>........] - ETA: 1s - loss: 0.3387 - acc: 0.8962
256/300 [========================>.....] - ETA: 0s - loss: 0.3284 - acc: 0.8996
288/300 [===========================>..] - ETA: 0s - loss: 0.3168 - acc: 0.9033
300/300 [==============================] - 5s 15ms/step - loss: 0.3188 - acc: 0.9032 - val_loss: 0.3404 - val_acc: 0.8952
Epoch 5/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.2929 - acc: 0.9106
 64/300 [=====>........................] - ETA: 3s - loss: 0.2973 - acc: 0.9066
 96/300 [========>.....................] - ETA: 2s - loss: 0.2751 - acc: 0.9186
128/300 [===========>..................] - ETA: 2s - loss: 0.2972 - acc: 0.9053
160/300 [===============>..............] - ETA: 1s - loss: 0.2895 - acc: 0.9089
192/300 [==================>...........] - ETA: 1s - loss: 0.2810 - acc: 0.9109
224/300 [=====================>........] - ETA: 1s - loss: 0.2815 - acc: 0.9101
256/300 [========================>.....] - ETA: 0s - loss: 0.2802 - acc: 0.9112
288/300 [===========================>..] - ETA: 0s - loss: 0.2793 - acc: 0.9107
300/300 [==============================] - 5s 15ms/step - loss: 0.2784 - acc: 0.9113 - val_loss: 0.3080 - val_acc: 0.9075
Epoch 6/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.2449 - acc: 0.9370
 64/300 [=====>........................] - ETA: 3s - loss: 0.2167 - acc: 0.9387
 96/300 [========>.....................] - ETA: 2s - loss: 0.2380 - acc: 0.9272
128/300 [===========>..................] - ETA: 2s - loss: 0.2413 - acc: 0.9226
160/300 [===============>..............] - ETA: 1s - loss: 0.2467 - acc: 0.9254
192/300 [==================>...........] - ETA: 1s - loss: 0.2333 - acc: 0.9278
224/300 [=====================>........] - ETA: 1s - loss: 0.2323 - acc: 0.9273
256/300 [========================>.....] - ETA: 0s - loss: 0.2349 - acc: 0.9283
288/300 [===========================>..] - ETA: 0s - loss: 0.2336 - acc: 0.9279
300/300 [==============================] - 5s 15ms/step - loss: 0.2350 - acc: 0.9273 - val_loss: 0.2827 - val_acc: 0.9071
Epoch 7/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.2222 - acc: 0.9317
 64/300 [=====>........................] - ETA: 3s - loss: 0.2306 - acc: 0.9294
 96/300 [========>.....................] - ETA: 2s - loss: 0.2139 - acc: 0.9321
128/300 [===========>..................] - ETA: 2s - loss: 0.2082 - acc: 0.9359
160/300 [===============>..............] - ETA: 1s - loss: 0.2072 - acc: 0.9355
192/300 [==================>...........] - ETA: 1s - loss: 0.2039 - acc: 0.9380
224/300 [=====================>........] - ETA: 1s - loss: 0.2048 - acc: 0.9384
256/300 [========================>.....] - ETA: 0s - loss: 0.1999 - acc: 0.9401
288/300 [===========================>..] - ETA: 0s - loss: 0.1995 - acc: 0.9401
300/300 [==============================] - 5s 15ms/step - loss: 0.2025 - acc: 0.9388 - val_loss: 0.2742 - val_acc: 0.9164
Epoch 8/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.1785 - acc: 0.9497
 64/300 [=====>........................] - ETA: 3s - loss: 0.1655 - acc: 0.9545
 96/300 [========>.....................] - ETA: 2s - loss: 0.1977 - acc: 0.9428
128/300 [===========>..................] - ETA: 2s - loss: 0.1978 - acc: 0.9447
160/300 [===============>..............] - ETA: 1s - loss: 0.1921 - acc: 0.9441
192/300 [==================>...........] - ETA: 1s - loss: 0.1936 - acc: 0.9437
224/300 [=====================>........] - ETA: 1s - loss: 0.1901 - acc: 0.9450
256/300 [========================>.....] - ETA: 0s - loss: 0.1855 - acc: 0.9467
288/300 [===========================>..] - ETA: 0s - loss: 0.1866 - acc: 0.9449
300/300 [==============================] - 5s 15ms/step - loss: 0.1882 - acc: 0.9437 - val_loss: 0.2621 - val_acc: 0.9151
Epoch 9/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.1304 - acc: 0.9591
 64/300 [=====>........................] - ETA: 3s - loss: 0.1324 - acc: 0.9558
 96/300 [========>.....................] - ETA: 2s - loss: 0.1499 - acc: 0.9498
128/300 [===========>..................] - ETA: 2s - loss: 0.1621 - acc: 0.9473
160/300 [===============>..............] - ETA: 1s - loss: 0.1697 - acc: 0.9458
192/300 [==================>...........] - ETA: 1s - loss: 0.1762 - acc: 0.9443
224/300 [=====================>........] - ETA: 1s - loss: 0.1780 - acc: 0.9437
256/300 [========================>.....] - ETA: 0s - loss: 0.1707 - acc: 0.9464
288/300 [===========================>..] - ETA: 0s - loss: 0.1731 - acc: 0.9461
300/300 [==============================] - 5s 15ms/step - loss: 0.1703 - acc: 0.9475 - val_loss: 0.2860 - val_acc: 0.9208
Epoch 10/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.1965 - acc: 0.9428
 64/300 [=====>........................] - ETA: 3s - loss: 0.1815 - acc: 0.9517
 96/300 [========>.....................] - ETA: 2s - loss: 0.1614 - acc: 0.9546
128/300 [===========>..................] - ETA: 2s - loss: 0.1570 - acc: 0.9560
160/300 [===============>..............] - ETA: 1s - loss: 0.1560 - acc: 0.9540
192/300 [==================>...........] - ETA: 1s - loss: 0.1567 - acc: 0.9543
224/300 [=====================>........] - ETA: 1s - loss: 0.1549 - acc: 0.9555
256/300 [========================>.....] - ETA: 0s - loss: 0.1546 - acc: 0.9550
288/300 [===========================>..] - ETA: 0s - loss: 0.1526 - acc: 0.9560
300/300 [==============================] - 5s 15ms/step - loss: 0.1529 - acc: 0.9559 - val_loss: 0.2675 - val_acc: 0.9213
Computing...
Manual evaluation: (didn't understand why I made this)
True 7950
False 1121
True percentage 0.876419358395
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.96      0.96      7318
     B-MISC       0.14      0.01      0.01       141
     I-MISC       0.35      0.07      0.12       154
      B-ORG       0.61      0.60      0.61       296
      I-ORG       0.49      0.35      0.41       151
      B-PER       0.84      0.74      0.79       438
      I-PER       0.78      0.57      0.66       214
      B-LOC       0.62      0.71      0.67       218
      I-LOC       0.67      0.78      0.72       141

avg / total       0.90      0.88      0.88      9071

F-1 Score:
0.606870229008
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 334 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100380 unique words.
Found 94 unique chars.
Found 9 unique labels.
376 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 282
OOV word occurences: 438
Padding...
Data padded!
Padding...
Data padded!
Padded until 63 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 63 tokens.
Padded until 24 chars.
Padded until 63 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 63, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 63)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 63, 64)       6424384     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 63, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 63, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 63, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 63, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 63, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,927,490
Trainable params: 6,927,490
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 300 samples, validate on 34 samples
Epoch 1/70

 32/300 [==>...........................] - ETA: 22s - loss: 2.0438 - acc: 0.6121
 64/300 [=====>........................] - ETA: 11s - loss: 1.5112 - acc: 0.7024
 96/300 [========>.....................] - ETA: 7s - loss: 1.6490 - acc: 0.7264 
128/300 [===========>..................] - ETA: 5s - loss: 1.5582 - acc: 0.7474
160/300 [===============>..............] - ETA: 4s - loss: 1.4256 - acc: 0.7556
192/300 [==================>...........] - ETA: 2s - loss: 1.2954 - acc: 0.7710
224/300 [=====================>........] - ETA: 1s - loss: 1.2487 - acc: 0.7677
256/300 [========================>.....] - ETA: 1s - loss: 1.1933 - acc: 0.7713
288/300 [===========================>..] - ETA: 0s - loss: 1.1259 - acc: 0.7780
300/300 [==============================] - 8s 25ms/step - loss: 1.1092 - acc: 0.7784 - val_loss: 0.5605 - val_acc: 0.8342
Epoch 2/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.5351 - acc: 0.8489
 64/300 [=====>........................] - ETA: 3s - loss: 0.5853 - acc: 0.8264
 96/300 [========>.....................] - ETA: 3s - loss: 0.6217 - acc: 0.8084
128/300 [===========>..................] - ETA: 2s - loss: 0.6055 - acc: 0.8132
160/300 [===============>..............] - ETA: 2s - loss: 0.5934 - acc: 0.8164
192/300 [==================>...........] - ETA: 1s - loss: 0.5949 - acc: 0.8146
224/300 [=====================>........] - ETA: 1s - loss: 0.5750 - acc: 0.8207
256/300 [========================>.....] - ETA: 0s - loss: 0.5697 - acc: 0.8212
288/300 [===========================>..] - ETA: 0s - loss: 0.5534 - acc: 0.8251
300/300 [==============================] - 5s 17ms/step - loss: 0.5539 - acc: 0.8241 - val_loss: 0.4468 - val_acc: 0.8907
Epoch 3/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.4965 - acc: 0.8734
 64/300 [=====>........................] - ETA: 3s - loss: 2.0955 - acc: 0.8200
 96/300 [========>.....................] - ETA: 3s - loss: 1.5621 - acc: 0.8290
128/300 [===========>..................] - ETA: 2s - loss: 1.2876 - acc: 0.8366
160/300 [===============>..............] - ETA: 2s - loss: 1.1359 - acc: 0.8330
192/300 [==================>...........] - ETA: 1s - loss: 1.0136 - acc: 0.8428
224/300 [=====================>........] - ETA: 1s - loss: 0.9150 - acc: 0.8498
256/300 [========================>.....] - ETA: 0s - loss: 0.8473 - acc: 0.8555
288/300 [===========================>..] - ETA: 0s - loss: 0.7952 - acc: 0.8601
300/300 [==============================] - 5s 17ms/step - loss: 0.7752 - acc: 0.8613 - val_loss: 0.3833 - val_acc: 0.8763
Epoch 4/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.4550 - acc: 0.8514
 64/300 [=====>........................] - ETA: 3s - loss: 0.4903 - acc: 0.8347
 96/300 [========>.....................] - ETA: 3s - loss: 0.4685 - acc: 0.8602
128/300 [===========>..................] - ETA: 2s - loss: 0.4268 - acc: 0.8747
160/300 [===============>..............] - ETA: 2s - loss: 0.4010 - acc: 0.8813
192/300 [==================>...........] - ETA: 1s - loss: 0.3941 - acc: 0.8835
224/300 [=====================>........] - ETA: 1s - loss: 0.3857 - acc: 0.8869
256/300 [========================>.....] - ETA: 0s - loss: 0.3730 - acc: 0.8895
288/300 [===========================>..] - ETA: 0s - loss: 0.3687 - acc: 0.8908
300/300 [==============================] - 5s 17ms/step - loss: 0.3659 - acc: 0.8914 - val_loss: 0.2935 - val_acc: 0.9043
Epoch 5/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.2582 - acc: 0.9252
 64/300 [=====>........................] - ETA: 3s - loss: 0.2959 - acc: 0.9104
 96/300 [========>.....................] - ETA: 3s - loss: 0.2940 - acc: 0.9109
128/300 [===========>..................] - ETA: 2s - loss: 0.2896 - acc: 0.9125
160/300 [===============>..............] - ETA: 2s - loss: 0.2868 - acc: 0.9122
192/300 [==================>...........] - ETA: 1s - loss: 0.2835 - acc: 0.9152
224/300 [=====================>........] - ETA: 1s - loss: 0.2909 - acc: 0.9129
256/300 [========================>.....] - ETA: 0s - loss: 0.2946 - acc: 0.9124
288/300 [===========================>..] - ETA: 0s - loss: 0.2958 - acc: 0.9123
300/300 [==============================] - 5s 16ms/step - loss: 0.2904 - acc: 0.9142 - val_loss: 0.2554 - val_acc: 0.9208
Epoch 6/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.2534 - acc: 0.8995
 64/300 [=====>........................] - ETA: 3s - loss: 0.2371 - acc: 0.9202
 96/300 [========>.....................] - ETA: 3s - loss: 0.2501 - acc: 0.9194
128/300 [===========>..................] - ETA: 2s - loss: 0.2365 - acc: 0.9215
160/300 [===============>..............] - ETA: 2s - loss: 0.2368 - acc: 0.9231
192/300 [==================>...........] - ETA: 1s - loss: 0.2422 - acc: 0.9228
224/300 [=====================>........] - ETA: 1s - loss: 0.2380 - acc: 0.9253
256/300 [========================>.....] - ETA: 0s - loss: 0.2431 - acc: 0.9238
288/300 [===========================>..] - ETA: 0s - loss: 0.2459 - acc: 0.9226
300/300 [==============================] - 5s 16ms/step - loss: 0.2484 - acc: 0.9211 - val_loss: 0.2552 - val_acc: 0.9232
Epoch 7/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.2532 - acc: 0.9272
 64/300 [=====>........................] - ETA: 3s - loss: 0.2375 - acc: 0.9238
 96/300 [========>.....................] - ETA: 3s - loss: 0.2289 - acc: 0.9301
128/300 [===========>..................] - ETA: 2s - loss: 0.2163 - acc: 0.9357
160/300 [===============>..............] - ETA: 2s - loss: 0.2220 - acc: 0.9352
192/300 [==================>...........] - ETA: 1s - loss: 0.2347 - acc: 0.9319
224/300 [=====================>........] - ETA: 1s - loss: 0.2338 - acc: 0.9289
256/300 [========================>.....] - ETA: 0s - loss: 0.2269 - acc: 0.9313
288/300 [===========================>..] - ETA: 0s - loss: 0.2291 - acc: 0.9301
300/300 [==============================] - 5s 16ms/step - loss: 0.2244 - acc: 0.9321 - val_loss: 0.2197 - val_acc: 0.9368
Epoch 8/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.2040 - acc: 0.9322
 64/300 [=====>........................] - ETA: 3s - loss: 0.2232 - acc: 0.9329
 96/300 [========>.....................] - ETA: 3s - loss: 0.2342 - acc: 0.9307
128/300 [===========>..................] - ETA: 2s - loss: 0.2267 - acc: 0.9317
160/300 [===============>..............] - ETA: 2s - loss: 0.2240 - acc: 0.9311
192/300 [==================>...........] - ETA: 1s - loss: 0.2158 - acc: 0.9339
224/300 [=====================>........] - ETA: 1s - loss: 0.2078 - acc: 0.9363
256/300 [========================>.....] - ETA: 0s - loss: 0.2028 - acc: 0.9385
288/300 [===========================>..] - ETA: 0s - loss: 0.2003 - acc: 0.9395
300/300 [==============================] - 5s 16ms/step - loss: 0.1994 - acc: 0.9396 - val_loss: 0.2144 - val_acc: 0.9398
Epoch 9/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.1604 - acc: 0.9580
 64/300 [=====>........................] - ETA: 3s - loss: 0.1643 - acc: 0.9510
 96/300 [========>.....................] - ETA: 3s - loss: 0.1728 - acc: 0.9476
128/300 [===========>..................] - ETA: 2s - loss: 0.1905 - acc: 0.9422
160/300 [===============>..............] - ETA: 2s - loss: 0.1857 - acc: 0.9438
192/300 [==================>...........] - ETA: 1s - loss: 0.1806 - acc: 0.9459
224/300 [=====================>........] - ETA: 1s - loss: 0.1785 - acc: 0.9454
256/300 [========================>.....] - ETA: 0s - loss: 0.1810 - acc: 0.9452
288/300 [===========================>..] - ETA: 0s - loss: 0.1837 - acc: 0.9442
300/300 [==============================] - 5s 16ms/step - loss: 0.1858 - acc: 0.9434 - val_loss: 0.2987 - val_acc: 0.9112
Epoch 10/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.3390 - acc: 0.8925
 64/300 [=====>........................] - ETA: 3s - loss: 0.2711 - acc: 0.9139
 96/300 [========>.....................] - ETA: 3s - loss: 0.2344 - acc: 0.9279
128/300 [===========>..................] - ETA: 2s - loss: 0.2140 - acc: 0.9350
160/300 [===============>..............] - ETA: 2s - loss: 0.2039 - acc: 0.9385
192/300 [==================>...........] - ETA: 1s - loss: 0.1966 - acc: 0.9408
224/300 [=====================>........] - ETA: 1s - loss: 0.1910 - acc: 0.9417
256/300 [========================>.....] - ETA: 0s - loss: 0.1900 - acc: 0.9419
288/300 [===========================>..] - ETA: 0s - loss: 0.1846 - acc: 0.9442
300/300 [==============================] - 5s 16ms/step - loss: 0.1842 - acc: 0.9443 - val_loss: 0.2024 - val_acc: 0.9413
Epoch 11/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.2139 - acc: 0.9381
 64/300 [=====>........................] - ETA: 3s - loss: 0.1745 - acc: 0.9490
 96/300 [========>.....................] - ETA: 3s - loss: 0.1677 - acc: 0.9500
128/300 [===========>..................] - ETA: 2s - loss: 0.1524 - acc: 0.9567
160/300 [===============>..............] - ETA: 2s - loss: 0.1476 - acc: 0.9576
192/300 [==================>...........] - ETA: 1s - loss: 0.1500 - acc: 0.9569
224/300 [=====================>........] - ETA: 1s - loss: 0.1581 - acc: 0.9545
256/300 [========================>.....] - ETA: 0s - loss: 0.1550 - acc: 0.9547
288/300 [===========================>..] - ETA: 0s - loss: 0.1502 - acc: 0.9569
300/300 [==============================] - 5s 16ms/step - loss: 0.1487 - acc: 0.9576 - val_loss: 0.2051 - val_acc: 0.9398
Epoch 12/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.1737 - acc: 0.9526
 64/300 [=====>........................] - ETA: 3s - loss: 0.1646 - acc: 0.9497
 96/300 [========>.....................] - ETA: 3s - loss: 0.1501 - acc: 0.9546
128/300 [===========>..................] - ETA: 2s - loss: 0.1459 - acc: 0.9559
160/300 [===============>..............] - ETA: 2s - loss: 0.1474 - acc: 0.9560
192/300 [==================>...........] - ETA: 1s - loss: 0.1434 - acc: 0.9587
224/300 [=====================>........] - ETA: 1s - loss: 0.1408 - acc: 0.9592
256/300 [========================>.....] - ETA: 0s - loss: 0.1393 - acc: 0.9594
288/300 [===========================>..] - ETA: 0s - loss: 0.1361 - acc: 0.9605
300/300 [==============================] - 5s 16ms/step - loss: 0.1380 - acc: 0.9596 - val_loss: 0.2438 - val_acc: 0.9202
Computing...
Manual evaluation: (didn't understand why I made this)
True 7859
False 1212
True percentage 0.866387388381
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-ORG       0.44      0.65      0.53       296
      B-LOC       0.81      0.55      0.66       218
      B-PER       0.86      0.68      0.76       438
      I-PER       0.82      0.59      0.68       214
     B-MISC       0.33      0.01      0.01       141
      I-ORG       0.30      0.78      0.43       151
      I-LOC       0.84      0.55      0.66       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.91      0.87      0.88      9071

F-1 Score:
0.560528687293
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 334 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100354 unique words.
Found 94 unique chars.
Found 9 unique labels.
350 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 286
OOV word occurences: 421
Padding...
Data padded!
Padding...
Data padded!
Padded until 58 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 58, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 58)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 58, 64)       6422720     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 58, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 58, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 58, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 58, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 58, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,925,826
Trainable params: 6,925,826
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 300 samples, validate on 34 samples
Epoch 1/70

 32/300 [==>...........................] - ETA: 21s - loss: 2.2181 - acc: 0.1291
 64/300 [=====>........................] - ETA: 11s - loss: 1.5487 - acc: 0.4659
 96/300 [========>.....................] - ETA: 7s - loss: 1.9387 - acc: 0.5735 
128/300 [===========>..................] - ETA: 5s - loss: 1.7170 - acc: 0.6356
160/300 [===============>..............] - ETA: 4s - loss: 1.5604 - acc: 0.6630
192/300 [==================>...........] - ETA: 2s - loss: 1.4555 - acc: 0.6769
224/300 [=====================>........] - ETA: 1s - loss: 1.3566 - acc: 0.6932
256/300 [========================>.....] - ETA: 1s - loss: 1.2682 - acc: 0.7093
288/300 [===========================>..] - ETA: 0s - loss: 1.2153 - acc: 0.7174
300/300 [==============================] - 7s 24ms/step - loss: 1.1843 - acc: 0.7242 - val_loss: 0.6781 - val_acc: 0.7926
Epoch 2/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.7217 - acc: 0.7935
 64/300 [=====>........................] - ETA: 3s - loss: 0.7154 - acc: 0.7927
 96/300 [========>.....................] - ETA: 2s - loss: 0.6656 - acc: 0.8055
128/300 [===========>..................] - ETA: 2s - loss: 0.6571 - acc: 0.8017
160/300 [===============>..............] - ETA: 2s - loss: 0.6302 - acc: 0.8123
192/300 [==================>...........] - ETA: 1s - loss: 0.6109 - acc: 0.8166
224/300 [=====================>........] - ETA: 1s - loss: 0.5996 - acc: 0.8192
256/300 [========================>.....] - ETA: 0s - loss: 0.5869 - acc: 0.8233
288/300 [===========================>..] - ETA: 0s - loss: 0.5812 - acc: 0.8238
300/300 [==============================] - 5s 16ms/step - loss: 0.5790 - acc: 0.8248 - val_loss: 0.4733 - val_acc: 0.8359
Epoch 3/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.3443 - acc: 0.8981
 64/300 [=====>........................] - ETA: 3s - loss: 0.3534 - acc: 0.8944
 96/300 [========>.....................] - ETA: 3s - loss: 0.3880 - acc: 0.8777
128/300 [===========>..................] - ETA: 2s - loss: 0.3832 - acc: 0.8810
160/300 [===============>..............] - ETA: 2s - loss: 0.4094 - acc: 0.8723
192/300 [==================>...........] - ETA: 1s - loss: 0.4335 - acc: 0.8650
224/300 [=====================>........] - ETA: 1s - loss: 0.4324 - acc: 0.8654
256/300 [========================>.....] - ETA: 0s - loss: 0.4346 - acc: 0.8640
288/300 [===========================>..] - ETA: 0s - loss: 0.4283 - acc: 0.8704
300/300 [==============================] - 5s 16ms/step - loss: 0.4280 - acc: 0.8707 - val_loss: 0.3678 - val_acc: 0.8945
Epoch 4/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.3352 - acc: 0.9106
 64/300 [=====>........................] - ETA: 3s - loss: 0.3641 - acc: 0.8904
 96/300 [========>.....................] - ETA: 3s - loss: 0.3287 - acc: 0.9007
128/300 [===========>..................] - ETA: 2s - loss: 0.3634 - acc: 0.8863
160/300 [===============>..............] - ETA: 2s - loss: 0.3569 - acc: 0.8928
192/300 [==================>...........] - ETA: 1s - loss: 0.3596 - acc: 0.8923
224/300 [=====================>........] - ETA: 1s - loss: 0.3536 - acc: 0.8933
256/300 [========================>.....] - ETA: 0s - loss: 0.3539 - acc: 0.8956
288/300 [===========================>..] - ETA: 0s - loss: 0.3466 - acc: 0.8973
300/300 [==============================] - 5s 16ms/step - loss: 0.3495 - acc: 0.8952 - val_loss: 0.2982 - val_acc: 0.9002
Epoch 5/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.2883 - acc: 0.9151
 64/300 [=====>........................] - ETA: 3s - loss: 0.3019 - acc: 0.9076
 96/300 [========>.....................] - ETA: 2s - loss: 0.3030 - acc: 0.9132
128/300 [===========>..................] - ETA: 2s - loss: 0.3059 - acc: 0.9102
160/300 [===============>..............] - ETA: 2s - loss: 0.3025 - acc: 0.9128
192/300 [==================>...........] - ETA: 1s - loss: 0.2922 - acc: 0.9154
224/300 [=====================>........] - ETA: 1s - loss: 0.2849 - acc: 0.9149
256/300 [========================>.....] - ETA: 0s - loss: 0.2851 - acc: 0.9158
288/300 [===========================>..] - ETA: 0s - loss: 0.2926 - acc: 0.9136
300/300 [==============================] - 5s 15ms/step - loss: 0.2922 - acc: 0.9140 - val_loss: 0.2994 - val_acc: 0.8975
Epoch 6/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.2754 - acc: 0.9120
 64/300 [=====>........................] - ETA: 3s - loss: 0.2622 - acc: 0.9162
 96/300 [========>.....................] - ETA: 2s - loss: 0.2770 - acc: 0.9150
128/300 [===========>..................] - ETA: 2s - loss: 0.2688 - acc: 0.9172
160/300 [===============>..............] - ETA: 2s - loss: 0.2705 - acc: 0.9137
192/300 [==================>...........] - ETA: 1s - loss: 0.2769 - acc: 0.9110
224/300 [=====================>........] - ETA: 1s - loss: 0.2747 - acc: 0.9109
256/300 [========================>.....] - ETA: 0s - loss: 0.2647 - acc: 0.9157
288/300 [===========================>..] - ETA: 0s - loss: 0.2570 - acc: 0.9181
300/300 [==============================] - 5s 15ms/step - loss: 0.2580 - acc: 0.9176 - val_loss: 0.2552 - val_acc: 0.9053
Epoch 7/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.2124 - acc: 0.9477
 64/300 [=====>........................] - ETA: 3s - loss: 0.1956 - acc: 0.9438
 96/300 [========>.....................] - ETA: 2s - loss: 0.2010 - acc: 0.9401
128/300 [===========>..................] - ETA: 2s - loss: 0.2163 - acc: 0.9348
160/300 [===============>..............] - ETA: 2s - loss: 0.2159 - acc: 0.9355
192/300 [==================>...........] - ETA: 1s - loss: 0.2219 - acc: 0.9325
224/300 [=====================>........] - ETA: 1s - loss: 0.2338 - acc: 0.9287
256/300 [========================>.....] - ETA: 0s - loss: 0.2294 - acc: 0.9303
288/300 [===========================>..] - ETA: 0s - loss: 0.2254 - acc: 0.9321
300/300 [==============================] - 5s 15ms/step - loss: 0.2293 - acc: 0.9301 - val_loss: 0.2962 - val_acc: 0.8945
Epoch 8/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.2842 - acc: 0.9024
 64/300 [=====>........................] - ETA: 3s - loss: 0.2858 - acc: 0.9023
 96/300 [========>.....................] - ETA: 2s - loss: 0.2697 - acc: 0.9097
128/300 [===========>..................] - ETA: 2s - loss: 0.2637 - acc: 0.9139
160/300 [===============>..............] - ETA: 2s - loss: 0.2509 - acc: 0.9205
192/300 [==================>...........] - ETA: 1s - loss: 0.2413 - acc: 0.9242
224/300 [=====================>........] - ETA: 1s - loss: 0.2255 - acc: 0.9307
256/300 [========================>.....] - ETA: 0s - loss: 0.2282 - acc: 0.9292
288/300 [===========================>..] - ETA: 0s - loss: 0.2193 - acc: 0.9321
300/300 [==============================] - 5s 15ms/step - loss: 0.2216 - acc: 0.9313 - val_loss: 0.2669 - val_acc: 0.9050
Computing...
Manual evaluation: (didn't understand why I made this)
True 7869
False 1202
True percentage 0.867489802668
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-PER       0.75      0.68      0.72       438
      B-ORG       0.70      0.45      0.55       296
     I-MISC       0.26      0.04      0.07       154
      B-LOC       0.62      0.70      0.65       218
      I-LOC       0.44      0.87      0.59       141
      I-ORG       0.43      0.33      0.38       151
      I-PER       0.72      0.61      0.66       214
     B-MISC       0.00      0.00      0.00       141

avg / total       0.89      0.87      0.87      9071

F-1 Score:
0.560929648241
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 334 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100379 unique words.
Found 94 unique chars.
Found 9 unique labels.
375 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 277
OOV word occurences: 429
Padding...
Data padded!
Padding...
Data padded!
Padded until 58 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 58, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 58)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 58, 64)       6424320     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 58, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 58, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 58, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 58, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 58, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,927,426
Trainable params: 6,927,426
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 300 samples, validate on 34 samples
Epoch 1/70

 32/300 [==>...........................] - ETA: 21s - loss: 2.2201 - acc: 0.0837
 64/300 [=====>........................] - ETA: 11s - loss: 1.5485 - acc: 0.4417
 96/300 [========>.....................] - ETA: 7s - loss: 1.7903 - acc: 0.5617 
128/300 [===========>..................] - ETA: 5s - loss: 1.6346 - acc: 0.6132
160/300 [===============>..............] - ETA: 4s - loss: 1.4544 - acc: 0.6561
192/300 [==================>...........] - ETA: 2s - loss: 1.3431 - acc: 0.6783
224/300 [=====================>........] - ETA: 1s - loss: 1.2535 - acc: 0.6980
256/300 [========================>.....] - ETA: 1s - loss: 1.1876 - acc: 0.7104
288/300 [===========================>..] - ETA: 0s - loss: 1.1292 - acc: 0.7232
300/300 [==============================] - 7s 25ms/step - loss: 1.1093 - acc: 0.7270 - val_loss: 0.6156 - val_acc: 0.8105
Epoch 2/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.6967 - acc: 0.7826
 64/300 [=====>........................] - ETA: 3s - loss: 0.6414 - acc: 0.8051
 96/300 [========>.....................] - ETA: 3s - loss: 0.6247 - acc: 0.8097
128/300 [===========>..................] - ETA: 2s - loss: 0.6148 - acc: 0.8127
160/300 [===============>..............] - ETA: 2s - loss: 0.6223 - acc: 0.8072
192/300 [==================>...........] - ETA: 1s - loss: 0.6146 - acc: 0.8204
224/300 [=====================>........] - ETA: 1s - loss: 0.6029 - acc: 0.8207
256/300 [========================>.....] - ETA: 0s - loss: 0.5813 - acc: 0.8261
288/300 [===========================>..] - ETA: 0s - loss: 0.5596 - acc: 0.8320
300/300 [==============================] - 5s 16ms/step - loss: 0.5663 - acc: 0.8300 - val_loss: 0.4794 - val_acc: 0.8954
Epoch 3/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.5189 - acc: 0.8761
 64/300 [=====>........................] - ETA: 3s - loss: 0.4691 - acc: 0.8801
 96/300 [========>.....................] - ETA: 3s - loss: 0.4558 - acc: 0.8757
128/300 [===========>..................] - ETA: 2s - loss: 0.4536 - acc: 0.8729
160/300 [===============>..............] - ETA: 2s - loss: 0.4388 - acc: 0.8732
192/300 [==================>...........] - ETA: 1s - loss: 0.4437 - acc: 0.8702
224/300 [=====================>........] - ETA: 1s - loss: 0.4442 - acc: 0.8677
256/300 [========================>.....] - ETA: 0s - loss: 0.4374 - acc: 0.8702
288/300 [===========================>..] - ETA: 0s - loss: 0.4322 - acc: 0.8719
300/300 [==============================] - 5s 16ms/step - loss: 0.4220 - acc: 0.8757 - val_loss: 0.3286 - val_acc: 0.8760
Epoch 4/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.3115 - acc: 0.8984
 64/300 [=====>........................] - ETA: 3s - loss: 0.3222 - acc: 0.8926
 96/300 [========>.....................] - ETA: 2s - loss: 0.3684 - acc: 0.8884
128/300 [===========>..................] - ETA: 2s - loss: 0.3743 - acc: 0.8844
160/300 [===============>..............] - ETA: 2s - loss: 0.3667 - acc: 0.8913
192/300 [==================>...........] - ETA: 1s - loss: 0.3680 - acc: 0.8898
224/300 [=====================>........] - ETA: 1s - loss: 0.3775 - acc: 0.8860
256/300 [========================>.....] - ETA: 0s - loss: 0.3611 - acc: 0.8917
288/300 [===========================>..] - ETA: 0s - loss: 0.3543 - acc: 0.8941
300/300 [==============================] - 5s 15ms/step - loss: 0.3536 - acc: 0.8938 - val_loss: 0.2727 - val_acc: 0.9247
Epoch 5/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.2553 - acc: 0.9289
 64/300 [=====>........................] - ETA: 3s - loss: 0.2554 - acc: 0.9329
 96/300 [========>.....................] - ETA: 2s - loss: 0.2472 - acc: 0.9323
128/300 [===========>..................] - ETA: 2s - loss: 0.2948 - acc: 0.9153
160/300 [===============>..............] - ETA: 2s - loss: 0.2958 - acc: 0.9167
192/300 [==================>...........] - ETA: 1s - loss: 0.2874 - acc: 0.9177
224/300 [=====================>........] - ETA: 1s - loss: 0.2821 - acc: 0.9165
256/300 [========================>.....] - ETA: 0s - loss: 0.2920 - acc: 0.9131
288/300 [===========================>..] - ETA: 0s - loss: 0.2910 - acc: 0.9140
300/300 [==============================] - 5s 15ms/step - loss: 0.2877 - acc: 0.9152 - val_loss: 0.2361 - val_acc: 0.9195
Epoch 6/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.2817 - acc: 0.9034
 64/300 [=====>........................] - ETA: 3s - loss: 0.2670 - acc: 0.9236
 96/300 [========>.....................] - ETA: 2s - loss: 0.2700 - acc: 0.9230
128/300 [===========>..................] - ETA: 2s - loss: 0.2573 - acc: 0.9252
160/300 [===============>..............] - ETA: 2s - loss: 0.2467 - acc: 0.9274
192/300 [==================>...........] - ETA: 1s - loss: 0.2403 - acc: 0.9267
224/300 [=====================>........] - ETA: 1s - loss: 0.2489 - acc: 0.9240
256/300 [========================>.....] - ETA: 0s - loss: 0.2528 - acc: 0.9234
288/300 [===========================>..] - ETA: 0s - loss: 0.2509 - acc: 0.9238
300/300 [==============================] - 5s 15ms/step - loss: 0.2474 - acc: 0.9249 - val_loss: 0.2098 - val_acc: 0.9356
Epoch 7/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.1652 - acc: 0.9451
 64/300 [=====>........................] - ETA: 3s - loss: 0.1891 - acc: 0.9435
 96/300 [========>.....................] - ETA: 2s - loss: 0.2066 - acc: 0.9383
128/300 [===========>..................] - ETA: 2s - loss: 0.2066 - acc: 0.9360
160/300 [===============>..............] - ETA: 2s - loss: 0.2232 - acc: 0.9310
192/300 [==================>...........] - ETA: 1s - loss: 0.2258 - acc: 0.9306
224/300 [=====================>........] - ETA: 1s - loss: 0.2169 - acc: 0.9333
256/300 [========================>.....] - ETA: 0s - loss: 0.2260 - acc: 0.9308
288/300 [===========================>..] - ETA: 0s - loss: 0.2225 - acc: 0.9331
300/300 [==============================] - 5s 15ms/step - loss: 0.2190 - acc: 0.9338 - val_loss: 0.1907 - val_acc: 0.9437
Epoch 8/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.2353 - acc: 0.9104
 64/300 [=====>........................] - ETA: 3s - loss: 0.2224 - acc: 0.9160
 96/300 [========>.....................] - ETA: 2s - loss: 0.2267 - acc: 0.9194
128/300 [===========>..................] - ETA: 2s - loss: 0.2058 - acc: 0.9301
160/300 [===============>..............] - ETA: 2s - loss: 0.2034 - acc: 0.9308
192/300 [==================>...........] - ETA: 1s - loss: 0.1984 - acc: 0.9342
224/300 [=====================>........] - ETA: 1s - loss: 0.1962 - acc: 0.9372
256/300 [========================>.....] - ETA: 0s - loss: 0.1938 - acc: 0.9389
288/300 [===========================>..] - ETA: 0s - loss: 0.1934 - acc: 0.9404
300/300 [==============================] - 5s 15ms/step - loss: 0.1920 - acc: 0.9409 - val_loss: 0.1803 - val_acc: 0.9437
Epoch 9/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.1534 - acc: 0.9575
 64/300 [=====>........................] - ETA: 3s - loss: 0.1513 - acc: 0.9558
 96/300 [========>.....................] - ETA: 2s - loss: 0.1706 - acc: 0.9510
128/300 [===========>..................] - ETA: 2s - loss: 0.1740 - acc: 0.9489
160/300 [===============>..............] - ETA: 2s - loss: 0.1743 - acc: 0.9463
192/300 [==================>...........] - ETA: 1s - loss: 0.1758 - acc: 0.9459
224/300 [=====================>........] - ETA: 1s - loss: 0.1844 - acc: 0.9438
256/300 [========================>.....] - ETA: 0s - loss: 0.1846 - acc: 0.9437
288/300 [===========================>..] - ETA: 0s - loss: 0.1875 - acc: 0.9426
300/300 [==============================] - 5s 15ms/step - loss: 0.1859 - acc: 0.9434 - val_loss: 0.1846 - val_acc: 0.9374
Epoch 10/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.1526 - acc: 0.9527
 64/300 [=====>........................] - ETA: 3s - loss: 0.1347 - acc: 0.9616
 96/300 [========>.....................] - ETA: 2s - loss: 0.1365 - acc: 0.9601
128/300 [===========>..................] - ETA: 2s - loss: 0.1549 - acc: 0.9531
160/300 [===============>..............] - ETA: 2s - loss: 0.1529 - acc: 0.9534
192/300 [==================>...........] - ETA: 1s - loss: 0.1610 - acc: 0.9495
224/300 [=====================>........] - ETA: 1s - loss: 0.1608 - acc: 0.9493
256/300 [========================>.....] - ETA: 0s - loss: 0.1637 - acc: 0.9498
288/300 [===========================>..] - ETA: 0s - loss: 0.1614 - acc: 0.9496
300/300 [==============================] - 5s 15ms/step - loss: 0.1596 - acc: 0.9497 - val_loss: 0.1750 - val_acc: 0.9414
Epoch 11/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.1645 - acc: 0.9365
 64/300 [=====>........................] - ETA: 3s - loss: 0.1622 - acc: 0.9435
 96/300 [========>.....................] - ETA: 2s - loss: 0.1462 - acc: 0.9533
128/300 [===========>..................] - ETA: 2s - loss: 0.1464 - acc: 0.9516
160/300 [===============>..............] - ETA: 1s - loss: 0.1541 - acc: 0.9498
192/300 [==================>...........] - ETA: 1s - loss: 0.1545 - acc: 0.9499
224/300 [=====================>........] - ETA: 1s - loss: 0.1531 - acc: 0.9505
256/300 [========================>.....] - ETA: 0s - loss: 0.1530 - acc: 0.9508
288/300 [===========================>..] - ETA: 0s - loss: 0.1495 - acc: 0.9519
300/300 [==============================] - 5s 15ms/step - loss: 0.1499 - acc: 0.9517 - val_loss: 0.1730 - val_acc: 0.9382
Epoch 12/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.1661 - acc: 0.9453
 64/300 [=====>........................] - ETA: 3s - loss: 0.1593 - acc: 0.9504
 96/300 [========>.....................] - ETA: 2s - loss: 0.1575 - acc: 0.9524
128/300 [===========>..................] - ETA: 2s - loss: 0.1565 - acc: 0.9515
160/300 [===============>..............] - ETA: 2s - loss: 0.1478 - acc: 0.9547
192/300 [==================>...........] - ETA: 1s - loss: 0.1462 - acc: 0.9547
224/300 [=====================>........] - ETA: 1s - loss: 0.1388 - acc: 0.9576
256/300 [========================>.....] - ETA: 0s - loss: 0.1400 - acc: 0.9571
288/300 [===========================>..] - ETA: 0s - loss: 0.1381 - acc: 0.9580
300/300 [==============================] - 5s 15ms/step - loss: 0.1363 - acc: 0.9586 - val_loss: 0.1708 - val_acc: 0.9393
Epoch 13/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.1585 - acc: 0.9492
 64/300 [=====>........................] - ETA: 3s - loss: 0.1402 - acc: 0.9533
 96/300 [========>.....................] - ETA: 2s - loss: 0.1453 - acc: 0.9546
128/300 [===========>..................] - ETA: 2s - loss: 0.1411 - acc: 0.9562
160/300 [===============>..............] - ETA: 1s - loss: 0.1444 - acc: 0.9543
192/300 [==================>...........] - ETA: 1s - loss: 0.1461 - acc: 0.9547
224/300 [=====================>........] - ETA: 1s - loss: 0.1344 - acc: 0.9595
256/300 [========================>.....] - ETA: 0s - loss: 0.1270 - acc: 0.9617
288/300 [===========================>..] - ETA: 0s - loss: 0.1279 - acc: 0.9616
300/300 [==============================] - 5s 15ms/step - loss: 0.1271 - acc: 0.9624 - val_loss: 0.1628 - val_acc: 0.9444
Epoch 14/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.1053 - acc: 0.9676
 64/300 [=====>........................] - ETA: 3s - loss: 0.1102 - acc: 0.9677
 96/300 [========>.....................] - ETA: 2s - loss: 0.1106 - acc: 0.9697
128/300 [===========>..................] - ETA: 2s - loss: 0.1014 - acc: 0.9736
160/300 [===============>..............] - ETA: 2s - loss: 0.1009 - acc: 0.9734
192/300 [==================>...........] - ETA: 1s - loss: 0.1039 - acc: 0.9717
224/300 [=====================>........] - ETA: 1s - loss: 0.1034 - acc: 0.9722
256/300 [========================>.....] - ETA: 0s - loss: 0.1103 - acc: 0.9700
288/300 [===========================>..] - ETA: 0s - loss: 0.1113 - acc: 0.9702
300/300 [==============================] - 5s 15ms/step - loss: 0.1128 - acc: 0.9691 - val_loss: 0.1786 - val_acc: 0.9301
Epoch 15/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.1488 - acc: 0.9548
 64/300 [=====>........................] - ETA: 3s - loss: 0.1514 - acc: 0.9595
 96/300 [========>.....................] - ETA: 2s - loss: 0.1296 - acc: 0.9650
128/300 [===========>..................] - ETA: 2s - loss: 0.1271 - acc: 0.9645
160/300 [===============>..............] - ETA: 2s - loss: 0.1166 - acc: 0.9680
192/300 [==================>...........] - ETA: 1s - loss: 0.1099 - acc: 0.9701
224/300 [=====================>........] - ETA: 1s - loss: 0.1096 - acc: 0.9708
256/300 [========================>.....] - ETA: 0s - loss: 0.1087 - acc: 0.9697
288/300 [===========================>..] - ETA: 0s - loss: 0.1103 - acc: 0.9690
300/300 [==============================] - 5s 15ms/step - loss: 0.1124 - acc: 0.9685 - val_loss: 0.1672 - val_acc: 0.9360
Computing...
Manual evaluation: (didn't understand why I made this)
True 7958
False 1113
True percentage 0.877301289825
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-PER       0.81      0.71      0.75       438
      B-LOC       0.71      0.66      0.69       218
      B-ORG       0.60      0.64      0.62       296
      I-PER       0.73      0.60      0.66       214
     B-MISC       0.51      0.21      0.29       141
     I-MISC       0.44      0.26      0.33       154
      I-LOC       0.64      0.78      0.70       141
      I-ORG       0.49      0.46      0.47       151

avg / total       0.91      0.88      0.89      9071

F-1 Score:
0.619872379216
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 334 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100374 unique words.
Found 94 unique chars.
Found 9 unique labels.
370 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 281
OOV word occurences: 431
Padding...
Data padded!
Padding...
Data padded!
Padded until 58 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 58, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 58)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 58, 64)       6424000     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 58, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 58, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 58, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 58, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 58, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,927,106
Trainable params: 6,927,106
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 300 samples, validate on 34 samples
Epoch 1/70

 32/300 [==>...........................] - ETA: 21s - loss: 2.4939 - acc: 0.0377
 64/300 [=====>........................] - ETA: 11s - loss: 1.7459 - acc: 0.4318
 96/300 [========>.....................] - ETA: 7s - loss: 1.9516 - acc: 0.5601 
128/300 [===========>..................] - ETA: 5s - loss: 1.6655 - acc: 0.6248
160/300 [===============>..............] - ETA: 3s - loss: 1.4914 - acc: 0.6619
192/300 [==================>...........] - ETA: 2s - loss: 1.3804 - acc: 0.6861
224/300 [=====================>........] - ETA: 1s - loss: 1.3121 - acc: 0.6973
256/300 [========================>.....] - ETA: 1s - loss: 1.2317 - acc: 0.7172
288/300 [===========================>..] - ETA: 0s - loss: 1.1796 - acc: 0.7255
300/300 [==============================] - 7s 24ms/step - loss: 1.1509 - acc: 0.7319 - val_loss: 0.5926 - val_acc: 0.8204
Epoch 2/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.5547 - acc: 0.8398
 64/300 [=====>........................] - ETA: 3s - loss: 0.6110 - acc: 0.8184
 96/300 [========>.....................] - ETA: 3s - loss: 0.5942 - acc: 0.8230
128/300 [===========>..................] - ETA: 2s - loss: 0.5892 - acc: 0.8251
160/300 [===============>..............] - ETA: 2s - loss: 0.5839 - acc: 0.8246
192/300 [==================>...........] - ETA: 1s - loss: 0.5816 - acc: 0.8245
224/300 [=====================>........] - ETA: 1s - loss: 0.5619 - acc: 0.8292
256/300 [========================>.....] - ETA: 0s - loss: 0.5606 - acc: 0.8294
288/300 [===========================>..] - ETA: 0s - loss: 0.5515 - acc: 0.8327
300/300 [==============================] - 5s 16ms/step - loss: 0.5523 - acc: 0.8326 - val_loss: 0.5436 - val_acc: 0.8432
Epoch 3/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.5292 - acc: 0.8519
 64/300 [=====>........................] - ETA: 3s - loss: 0.5595 - acc: 0.8370
 96/300 [========>.....................] - ETA: 2s - loss: 0.5237 - acc: 0.8520
128/300 [===========>..................] - ETA: 2s - loss: 0.4966 - acc: 0.8543
160/300 [===============>..............] - ETA: 2s - loss: 0.4860 - acc: 0.8578
192/300 [==================>...........] - ETA: 1s - loss: 0.4733 - acc: 0.8577
224/300 [=====================>........] - ETA: 1s - loss: 0.4687 - acc: 0.8604
256/300 [========================>.....] - ETA: 0s - loss: 0.4556 - acc: 0.8637
288/300 [===========================>..] - ETA: 0s - loss: 0.4447 - acc: 0.8654
300/300 [==============================] - 5s 15ms/step - loss: 0.4416 - acc: 0.8665 - val_loss: 0.3271 - val_acc: 0.9049
Epoch 4/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.3285 - acc: 0.9091
 64/300 [=====>........................] - ETA: 3s - loss: 0.3669 - acc: 0.8856
 96/300 [========>.....................] - ETA: 2s - loss: 0.3820 - acc: 0.8771
128/300 [===========>..................] - ETA: 2s - loss: 0.3623 - acc: 0.8835
160/300 [===============>..............] - ETA: 2s - loss: 0.3542 - acc: 0.8895
192/300 [==================>...........] - ETA: 1s - loss: 0.3487 - acc: 0.8928
224/300 [=====================>........] - ETA: 1s - loss: 0.3424 - acc: 0.8972
256/300 [========================>.....] - ETA: 0s - loss: 0.3429 - acc: 0.8969
288/300 [===========================>..] - ETA: 0s - loss: 0.3335 - acc: 0.8992
300/300 [==============================] - 5s 16ms/step - loss: 0.3326 - acc: 0.8991 - val_loss: 0.2676 - val_acc: 0.9140
Epoch 5/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.2469 - acc: 0.9205
 64/300 [=====>........................] - ETA: 3s - loss: 0.2458 - acc: 0.9258
 96/300 [========>.....................] - ETA: 2s - loss: 0.2724 - acc: 0.9196
128/300 [===========>..................] - ETA: 2s - loss: 0.3009 - acc: 0.9135
160/300 [===============>..............] - ETA: 2s - loss: 0.3028 - acc: 0.9105
192/300 [==================>...........] - ETA: 1s - loss: 0.3021 - acc: 0.9119
224/300 [=====================>........] - ETA: 1s - loss: 0.2944 - acc: 0.9130
256/300 [========================>.....] - ETA: 0s - loss: 0.2924 - acc: 0.9125
288/300 [===========================>..] - ETA: 0s - loss: 0.2921 - acc: 0.9142
300/300 [==============================] - 5s 15ms/step - loss: 0.2892 - acc: 0.9151 - val_loss: 0.2416 - val_acc: 0.9262
Epoch 6/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.2492 - acc: 0.9276
 64/300 [=====>........................] - ETA: 3s - loss: 0.2275 - acc: 0.9319
 96/300 [========>.....................] - ETA: 2s - loss: 0.2165 - acc: 0.9326
128/300 [===========>..................] - ETA: 2s - loss: 0.2391 - acc: 0.9270
160/300 [===============>..............] - ETA: 1s - loss: 0.2408 - acc: 0.9266
192/300 [==================>...........] - ETA: 1s - loss: 0.2480 - acc: 0.9216
224/300 [=====================>........] - ETA: 1s - loss: 0.2469 - acc: 0.9235
256/300 [========================>.....] - ETA: 0s - loss: 0.2444 - acc: 0.9258
288/300 [===========================>..] - ETA: 0s - loss: 0.2469 - acc: 0.9251
300/300 [==============================] - 5s 15ms/step - loss: 0.2461 - acc: 0.9257 - val_loss: 0.2524 - val_acc: 0.9023
Epoch 7/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.2642 - acc: 0.9085
 64/300 [=====>........................] - ETA: 3s - loss: 0.2190 - acc: 0.9327
 96/300 [========>.....................] - ETA: 2s - loss: 0.2435 - acc: 0.9257
128/300 [===========>..................] - ETA: 2s - loss: 0.2309 - acc: 0.9303
160/300 [===============>..............] - ETA: 2s - loss: 0.2182 - acc: 0.9363
192/300 [==================>...........] - ETA: 1s - loss: 0.2184 - acc: 0.9353
224/300 [=====================>........] - ETA: 1s - loss: 0.2198 - acc: 0.9345
256/300 [========================>.....] - ETA: 0s - loss: 0.2236 - acc: 0.9325
288/300 [===========================>..] - ETA: 0s - loss: 0.2239 - acc: 0.9309
300/300 [==============================] - 5s 15ms/step - loss: 0.2218 - acc: 0.9318 - val_loss: 0.2105 - val_acc: 0.9338
Epoch 8/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.1758 - acc: 0.9564
 64/300 [=====>........................] - ETA: 3s - loss: 0.1871 - acc: 0.9481
 96/300 [========>.....................] - ETA: 2s - loss: 0.1852 - acc: 0.9457
128/300 [===========>..................] - ETA: 2s - loss: 0.1774 - acc: 0.9482
160/300 [===============>..............] - ETA: 2s - loss: 0.1805 - acc: 0.9462
192/300 [==================>...........] - ETA: 1s - loss: 0.1857 - acc: 0.9428
224/300 [=====================>........] - ETA: 1s - loss: 0.1922 - acc: 0.9393
256/300 [========================>.....] - ETA: 0s - loss: 0.1892 - acc: 0.9414
288/300 [===========================>..] - ETA: 0s - loss: 0.1922 - acc: 0.9414
300/300 [==============================] - 5s 15ms/step - loss: 0.1944 - acc: 0.9411 - val_loss: 0.1989 - val_acc: 0.9409
Epoch 9/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.2371 - acc: 0.9282
 64/300 [=====>........................] - ETA: 3s - loss: 0.2323 - acc: 0.9283
 96/300 [========>.....................] - ETA: 2s - loss: 0.2244 - acc: 0.9327
128/300 [===========>..................] - ETA: 2s - loss: 0.2086 - acc: 0.9371
160/300 [===============>..............] - ETA: 2s - loss: 0.1902 - acc: 0.9425
192/300 [==================>...........] - ETA: 1s - loss: 0.1858 - acc: 0.9437
224/300 [=====================>........] - ETA: 1s - loss: 0.1818 - acc: 0.9446
256/300 [========================>.....] - ETA: 0s - loss: 0.1866 - acc: 0.9429
288/300 [===========================>..] - ETA: 0s - loss: 0.1841 - acc: 0.9433
300/300 [==============================] - 5s 15ms/step - loss: 0.1873 - acc: 0.9421 - val_loss: 0.1964 - val_acc: 0.9415
Epoch 10/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.1870 - acc: 0.9527
 64/300 [=====>........................] - ETA: 3s - loss: 0.1622 - acc: 0.9560
 96/300 [========>.....................] - ETA: 2s - loss: 0.1700 - acc: 0.9519
128/300 [===========>..................] - ETA: 2s - loss: 0.1770 - acc: 0.9474
160/300 [===============>..............] - ETA: 1s - loss: 0.1672 - acc: 0.9511
192/300 [==================>...........] - ETA: 1s - loss: 0.1642 - acc: 0.9509
224/300 [=====================>........] - ETA: 1s - loss: 0.1613 - acc: 0.9527
256/300 [========================>.....] - ETA: 0s - loss: 0.1626 - acc: 0.9517
288/300 [===========================>..] - ETA: 0s - loss: 0.1656 - acc: 0.9501
300/300 [==============================] - 5s 15ms/step - loss: 0.1660 - acc: 0.9500 - val_loss: 0.1774 - val_acc: 0.9385
Epoch 11/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.1019 - acc: 0.9743
 64/300 [=====>........................] - ETA: 3s - loss: 0.1280 - acc: 0.9582
 96/300 [========>.....................] - ETA: 2s - loss: 0.1386 - acc: 0.9549
128/300 [===========>..................] - ETA: 2s - loss: 0.1473 - acc: 0.9531
160/300 [===============>..............] - ETA: 2s - loss: 0.1525 - acc: 0.9513
192/300 [==================>...........] - ETA: 1s - loss: 0.1462 - acc: 0.9547
224/300 [=====================>........] - ETA: 1s - loss: 0.1485 - acc: 0.9543
256/300 [========================>.....] - ETA: 0s - loss: 0.1517 - acc: 0.9532
288/300 [===========================>..] - ETA: 0s - loss: 0.1544 - acc: 0.9526
300/300 [==============================] - 5s 15ms/step - loss: 0.1530 - acc: 0.9531 - val_loss: 0.1727 - val_acc: 0.9411
Epoch 12/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.1627 - acc: 0.9500
 64/300 [=====>........................] - ETA: 3s - loss: 0.1407 - acc: 0.9592
 96/300 [========>.....................] - ETA: 2s - loss: 0.1391 - acc: 0.9609
128/300 [===========>..................] - ETA: 2s - loss: 0.1372 - acc: 0.9603
160/300 [===============>..............] - ETA: 1s - loss: 0.1344 - acc: 0.9617
192/300 [==================>...........] - ETA: 1s - loss: 0.1357 - acc: 0.9602
224/300 [=====================>........] - ETA: 1s - loss: 0.1407 - acc: 0.9578
256/300 [========================>.....] - ETA: 0s - loss: 0.1389 - acc: 0.9588
288/300 [===========================>..] - ETA: 0s - loss: 0.1368 - acc: 0.9594
300/300 [==============================] - 5s 15ms/step - loss: 0.1353 - acc: 0.9606 - val_loss: 0.1674 - val_acc: 0.9400
Epoch 13/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.1415 - acc: 0.9582
 64/300 [=====>........................] - ETA: 3s - loss: 0.1290 - acc: 0.9648
 96/300 [========>.....................] - ETA: 2s - loss: 0.1317 - acc: 0.9594
128/300 [===========>..................] - ETA: 2s - loss: 0.1340 - acc: 0.9581
160/300 [===============>..............] - ETA: 2s - loss: 0.1283 - acc: 0.9601
192/300 [==================>...........] - ETA: 1s - loss: 0.1203 - acc: 0.9632
224/300 [=====================>........] - ETA: 1s - loss: 0.1217 - acc: 0.9630
256/300 [========================>.....] - ETA: 0s - loss: 0.1171 - acc: 0.9645
288/300 [===========================>..] - ETA: 0s - loss: 0.1167 - acc: 0.9641
300/300 [==============================] - 5s 15ms/step - loss: 0.1177 - acc: 0.9641 - val_loss: 0.1693 - val_acc: 0.9415
Epoch 14/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.1375 - acc: 0.9562
 64/300 [=====>........................] - ETA: 3s - loss: 0.1410 - acc: 0.9521
 96/300 [========>.....................] - ETA: 2s - loss: 0.1361 - acc: 0.9538
128/300 [===========>..................] - ETA: 2s - loss: 0.1261 - acc: 0.9581
160/300 [===============>..............] - ETA: 1s - loss: 0.1284 - acc: 0.9583
192/300 [==================>...........] - ETA: 1s - loss: 0.1230 - acc: 0.9608
224/300 [=====================>........] - ETA: 1s - loss: 0.1172 - acc: 0.9632
256/300 [========================>.....] - ETA: 0s - loss: 0.1236 - acc: 0.9628
288/300 [===========================>..] - ETA: 0s - loss: 0.1282 - acc: 0.9621
300/300 [==============================] - 5s 15ms/step - loss: 0.1292 - acc: 0.9612 - val_loss: 0.1747 - val_acc: 0.9444
Computing...
Manual evaluation: (didn't understand why I made this)
True 7955
False 1116
True percentage 0.876970565539
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-ORG       0.66      0.64      0.65       296
      I-ORG       0.43      0.48      0.45       151
      B-PER       0.79      0.73      0.76       438
      B-LOC       0.65      0.75      0.70       218
      I-LOC       0.61      0.79      0.69       141
      I-PER       0.83      0.54      0.65       214
     B-MISC       0.33      0.09      0.14       141
     I-MISC       0.37      0.22      0.28       154

avg / total       0.91      0.88      0.89      9071

F-1 Score:
0.612368024133
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 334 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100407 unique words.
Found 94 unique chars.
Found 9 unique labels.
403 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 288
OOV word occurences: 456
Padding...
Data padded!
Padding...
Data padded!
Padded until 67 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 67, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 67)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 67, 64)       6426112     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 67, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 67, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 67, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 67, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 67, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,929,218
Trainable params: 6,929,218
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 300 samples, validate on 34 samples
Epoch 1/70

 32/300 [==>...........................] - ETA: 22s - loss: 2.4951 - acc: 0.0178
 64/300 [=====>........................] - ETA: 12s - loss: 1.7072 - acc: 0.4143
 96/300 [========>.....................] - ETA: 8s - loss: 2.3547 - acc: 0.5147 
128/300 [===========>..................] - ETA: 5s - loss: 2.0549 - acc: 0.5861
160/300 [===============>..............] - ETA: 4s - loss: 1.7883 - acc: 0.6327
192/300 [==================>...........] - ETA: 3s - loss: 1.6089 - acc: 0.6641
224/300 [=====================>........] - ETA: 2s - loss: 1.4791 - acc: 0.6866
256/300 [========================>.....] - ETA: 1s - loss: 1.3760 - acc: 0.7045
288/300 [===========================>..] - ETA: 0s - loss: 1.2972 - acc: 0.7167
300/300 [==============================] - 8s 27ms/step - loss: 1.2718 - acc: 0.7204 - val_loss: 0.6577 - val_acc: 0.8090
Epoch 2/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.7386 - acc: 0.7717
 64/300 [=====>........................] - ETA: 3s - loss: 0.6343 - acc: 0.8077
 96/300 [========>.....................] - ETA: 3s - loss: 0.6595 - acc: 0.7946
128/300 [===========>..................] - ETA: 2s - loss: 0.6242 - acc: 0.8129
160/300 [===============>..............] - ETA: 2s - loss: 0.5873 - acc: 0.8240
192/300 [==================>...........] - ETA: 1s - loss: 0.5926 - acc: 0.8209
224/300 [=====================>........] - ETA: 1s - loss: 0.5909 - acc: 0.8239
256/300 [========================>.....] - ETA: 0s - loss: 0.5787 - acc: 0.8263
288/300 [===========================>..] - ETA: 0s - loss: 0.5643 - acc: 0.8316
300/300 [==============================] - 5s 18ms/step - loss: 0.5641 - acc: 0.8314 - val_loss: 0.4833 - val_acc: 0.8677
Epoch 3/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.4428 - acc: 0.8844
 64/300 [=====>........................] - ETA: 3s - loss: 0.5812 - acc: 0.8498
 96/300 [========>.....................] - ETA: 3s - loss: 0.6267 - acc: 0.8357
128/300 [===========>..................] - ETA: 2s - loss: 0.5948 - acc: 0.8432
160/300 [===============>..............] - ETA: 2s - loss: 0.5652 - acc: 0.8504
192/300 [==================>...........] - ETA: 1s - loss: 0.5400 - acc: 0.8544
224/300 [=====================>........] - ETA: 1s - loss: 0.5202 - acc: 0.8585
256/300 [========================>.....] - ETA: 0s - loss: 0.5136 - acc: 0.8585
288/300 [===========================>..] - ETA: 0s - loss: 0.4992 - acc: 0.8609
300/300 [==============================] - 5s 18ms/step - loss: 0.4928 - acc: 0.8635 - val_loss: 0.4805 - val_acc: 0.8704
Epoch 4/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.3778 - acc: 0.8822
 64/300 [=====>........................] - ETA: 3s - loss: 0.4074 - acc: 0.8751
 96/300 [========>.....................] - ETA: 3s - loss: 0.3824 - acc: 0.8854
128/300 [===========>..................] - ETA: 2s - loss: 0.3718 - acc: 0.8910
160/300 [===============>..............] - ETA: 2s - loss: 0.3667 - acc: 0.8929
192/300 [==================>...........] - ETA: 1s - loss: 0.3672 - acc: 0.8934
224/300 [=====================>........] - ETA: 1s - loss: 0.3760 - acc: 0.8888
256/300 [========================>.....] - ETA: 0s - loss: 0.3683 - acc: 0.8916
288/300 [===========================>..] - ETA: 0s - loss: 0.3628 - acc: 0.8929
300/300 [==============================] - 5s 18ms/step - loss: 0.3596 - acc: 0.8945 - val_loss: 0.3730 - val_acc: 0.8745
Epoch 5/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.3193 - acc: 0.9087
 64/300 [=====>........................] - ETA: 3s - loss: 0.2956 - acc: 0.9125
 96/300 [========>.....................] - ETA: 3s - loss: 0.3239 - acc: 0.9022
128/300 [===========>..................] - ETA: 2s - loss: 0.3226 - acc: 0.9032
160/300 [===============>..............] - ETA: 2s - loss: 0.3196 - acc: 0.9046
192/300 [==================>...........] - ETA: 1s - loss: 0.3156 - acc: 0.9058
224/300 [=====================>........] - ETA: 1s - loss: 0.3138 - acc: 0.9055
256/300 [========================>.....] - ETA: 0s - loss: 0.3134 - acc: 0.9050
288/300 [===========================>..] - ETA: 0s - loss: 0.3048 - acc: 0.9080
300/300 [==============================] - 5s 17ms/step - loss: 0.3045 - acc: 0.9082 - val_loss: 0.3269 - val_acc: 0.8827
Epoch 6/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.3044 - acc: 0.9051
 64/300 [=====>........................] - ETA: 3s - loss: 0.2713 - acc: 0.9177
 96/300 [========>.....................] - ETA: 3s - loss: 0.2653 - acc: 0.9176
128/300 [===========>..................] - ETA: 2s - loss: 0.2472 - acc: 0.9244
160/300 [===============>..............] - ETA: 2s - loss: 0.2542 - acc: 0.9216
192/300 [==================>...........] - ETA: 1s - loss: 0.2643 - acc: 0.9175
224/300 [=====================>........] - ETA: 1s - loss: 0.2644 - acc: 0.9178
256/300 [========================>.....] - ETA: 0s - loss: 0.2572 - acc: 0.9205
288/300 [===========================>..] - ETA: 0s - loss: 0.2618 - acc: 0.9187
300/300 [==============================] - 5s 17ms/step - loss: 0.2638 - acc: 0.9187 - val_loss: 0.3053 - val_acc: 0.8950
Epoch 7/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.2587 - acc: 0.9169
 64/300 [=====>........................] - ETA: 3s - loss: 0.2364 - acc: 0.9283
 96/300 [========>.....................] - ETA: 3s - loss: 0.2106 - acc: 0.9364
128/300 [===========>..................] - ETA: 2s - loss: 0.2283 - acc: 0.9305
160/300 [===============>..............] - ETA: 2s - loss: 0.2431 - acc: 0.9267
192/300 [==================>...........] - ETA: 1s - loss: 0.2373 - acc: 0.9295
224/300 [=====================>........] - ETA: 1s - loss: 0.2361 - acc: 0.9297
256/300 [========================>.....] - ETA: 0s - loss: 0.2358 - acc: 0.9303
288/300 [===========================>..] - ETA: 0s - loss: 0.2381 - acc: 0.9285
300/300 [==============================] - 5s 17ms/step - loss: 0.2351 - acc: 0.9300 - val_loss: 0.2855 - val_acc: 0.8991
Epoch 8/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.2172 - acc: 0.9426
 64/300 [=====>........................] - ETA: 3s - loss: 0.2174 - acc: 0.9346
 96/300 [========>.....................] - ETA: 3s - loss: 0.2257 - acc: 0.9305
128/300 [===========>..................] - ETA: 2s - loss: 0.2230 - acc: 0.9308
160/300 [===============>..............] - ETA: 2s - loss: 0.2151 - acc: 0.9341
192/300 [==================>...........] - ETA: 1s - loss: 0.2178 - acc: 0.9332
224/300 [=====================>........] - ETA: 1s - loss: 0.2210 - acc: 0.9315
256/300 [========================>.....] - ETA: 0s - loss: 0.2204 - acc: 0.9320
288/300 [===========================>..] - ETA: 0s - loss: 0.2158 - acc: 0.9340
300/300 [==============================] - 5s 17ms/step - loss: 0.2152 - acc: 0.9337 - val_loss: 0.2992 - val_acc: 0.8950
Epoch 9/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.1973 - acc: 0.9229
 64/300 [=====>........................] - ETA: 3s - loss: 0.1954 - acc: 0.9368
 96/300 [========>.....................] - ETA: 3s - loss: 0.2084 - acc: 0.9308
128/300 [===========>..................] - ETA: 2s - loss: 0.2094 - acc: 0.9299
160/300 [===============>..............] - ETA: 2s - loss: 0.2035 - acc: 0.9351
192/300 [==================>...........] - ETA: 1s - loss: 0.2007 - acc: 0.9379
224/300 [=====================>........] - ETA: 1s - loss: 0.2014 - acc: 0.9373
256/300 [========================>.....] - ETA: 0s - loss: 0.1960 - acc: 0.9390
288/300 [===========================>..] - ETA: 0s - loss: 0.1952 - acc: 0.9386
300/300 [==============================] - 5s 17ms/step - loss: 0.1941 - acc: 0.9391 - val_loss: 0.2850 - val_acc: 0.9059
Epoch 10/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.1812 - acc: 0.9305
 64/300 [=====>........................] - ETA: 3s - loss: 0.2136 - acc: 0.9219
 96/300 [========>.....................] - ETA: 3s - loss: 0.1963 - acc: 0.9366
128/300 [===========>..................] - ETA: 2s - loss: 0.2023 - acc: 0.9355
160/300 [===============>..............] - ETA: 2s - loss: 0.2029 - acc: 0.9355
192/300 [==================>...........] - ETA: 1s - loss: 0.1963 - acc: 0.9375
224/300 [=====================>........] - ETA: 1s - loss: 0.1875 - acc: 0.9402
256/300 [========================>.....] - ETA: 0s - loss: 0.1853 - acc: 0.9408
288/300 [===========================>..] - ETA: 0s - loss: 0.1795 - acc: 0.9430
300/300 [==============================] - 5s 17ms/step - loss: 0.1773 - acc: 0.9442 - val_loss: 0.2621 - val_acc: 0.9045
Epoch 11/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.1676 - acc: 0.9479
 64/300 [=====>........................] - ETA: 3s - loss: 0.1695 - acc: 0.9488
 96/300 [========>.....................] - ETA: 3s - loss: 0.1671 - acc: 0.9455
128/300 [===========>..................] - ETA: 2s - loss: 0.1563 - acc: 0.9516
160/300 [===============>..............] - ETA: 2s - loss: 0.1604 - acc: 0.9507
192/300 [==================>...........] - ETA: 1s - loss: 0.1580 - acc: 0.9512
224/300 [=====================>........] - ETA: 1s - loss: 0.1581 - acc: 0.9514
256/300 [========================>.....] - ETA: 0s - loss: 0.1674 - acc: 0.9482
288/300 [===========================>..] - ETA: 0s - loss: 0.1603 - acc: 0.9513
300/300 [==============================] - 5s 17ms/step - loss: 0.1595 - acc: 0.9514 - val_loss: 0.2976 - val_acc: 0.9059
Epoch 12/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.2349 - acc: 0.9272
 64/300 [=====>........................] - ETA: 3s - loss: 0.1954 - acc: 0.9438
 96/300 [========>.....................] - ETA: 3s - loss: 0.1791 - acc: 0.9476
128/300 [===========>..................] - ETA: 2s - loss: 0.1624 - acc: 0.9522
160/300 [===============>..............] - ETA: 2s - loss: 0.1548 - acc: 0.9541
192/300 [==================>...........] - ETA: 1s - loss: 0.1578 - acc: 0.9513
224/300 [=====================>........] - ETA: 1s - loss: 0.1585 - acc: 0.9529
256/300 [========================>.....] - ETA: 0s - loss: 0.1598 - acc: 0.9530
288/300 [===========================>..] - ETA: 0s - loss: 0.1577 - acc: 0.9529
300/300 [==============================] - 5s 17ms/step - loss: 0.1586 - acc: 0.9520 - val_loss: 0.2343 - val_acc: 0.9154
Epoch 13/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.1401 - acc: 0.9543
 64/300 [=====>........................] - ETA: 3s - loss: 0.1396 - acc: 0.9558
 96/300 [========>.....................] - ETA: 3s - loss: 0.1385 - acc: 0.9549
128/300 [===========>..................] - ETA: 2s - loss: 0.1503 - acc: 0.9525
160/300 [===============>..............] - ETA: 2s - loss: 0.1459 - acc: 0.9534
192/300 [==================>...........] - ETA: 1s - loss: 0.1371 - acc: 0.9567
224/300 [=====================>........] - ETA: 1s - loss: 0.1363 - acc: 0.9571
256/300 [========================>.....] - ETA: 0s - loss: 0.1336 - acc: 0.9582
288/300 [===========================>..] - ETA: 0s - loss: 0.1364 - acc: 0.9576
300/300 [==============================] - 5s 17ms/step - loss: 0.1368 - acc: 0.9575 - val_loss: 0.2425 - val_acc: 0.9195
Epoch 14/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.1095 - acc: 0.9728
 64/300 [=====>........................] - ETA: 3s - loss: 0.1104 - acc: 0.9732
 96/300 [========>.....................] - ETA: 3s - loss: 0.1192 - acc: 0.9671
128/300 [===========>..................] - ETA: 2s - loss: 0.1236 - acc: 0.9658
160/300 [===============>..............] - ETA: 2s - loss: 0.1255 - acc: 0.9653
192/300 [==================>...........] - ETA: 1s - loss: 0.1208 - acc: 0.9668
224/300 [=====================>........] - ETA: 1s - loss: 0.1253 - acc: 0.9636
256/300 [========================>.....] - ETA: 0s - loss: 0.1237 - acc: 0.9643
288/300 [===========================>..] - ETA: 0s - loss: 0.1223 - acc: 0.9645
300/300 [==============================] - 5s 17ms/step - loss: 0.1253 - acc: 0.9638 - val_loss: 0.2693 - val_acc: 0.9045
Computing...
Manual evaluation: (didn't understand why I made this)
True 7935
False 1136
True percentage 0.874765736964
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-ORG       0.52      0.68      0.59       296
      I-ORG       0.42      0.62      0.50       151
     B-MISC       0.33      0.08      0.13       141
     I-MISC       0.43      0.23      0.30       154
      B-PER       0.88      0.70      0.78       438
      B-LOC       0.82      0.48      0.61       218
      I-LOC       0.85      0.55      0.66       141
      I-PER       0.88      0.59      0.71       214

avg / total       0.92      0.87      0.89      9071

F-1 Score:
0.600564794478
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 334 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100409 unique words.
Found 94 unique chars.
Found 9 unique labels.
405 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 276
OOV word occurences: 398
Padding...
Data padded!
Padding...
Data padded!
Padded until 66 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 66 tokens.
Padded until 24 chars.
Padded until 66 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 66, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 66)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 66, 64)       6426240     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 66, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 66, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 66, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 66, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 66, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,929,346
Trainable params: 6,929,346
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 300 samples, validate on 34 samples
Epoch 1/70

 32/300 [==>...........................] - ETA: 23s - loss: 2.4548 - acc: 0.0093
 64/300 [=====>........................] - ETA: 12s - loss: 1.7125 - acc: 0.4114
 96/300 [========>.....................] - ETA: 8s - loss: 2.0345 - acc: 0.5397 
128/300 [===========>..................] - ETA: 6s - loss: 1.7837 - acc: 0.6035
160/300 [===============>..............] - ETA: 4s - loss: 1.5734 - acc: 0.6475
192/300 [==================>...........] - ETA: 3s - loss: 1.4489 - acc: 0.6704
224/300 [=====================>........] - ETA: 2s - loss: 1.3509 - acc: 0.6870
256/300 [========================>.....] - ETA: 1s - loss: 1.2593 - acc: 0.7041
288/300 [===========================>..] - ETA: 0s - loss: 1.1988 - acc: 0.7154
300/300 [==============================] - 8s 27ms/step - loss: 1.1817 - acc: 0.7182 - val_loss: 0.5507 - val_acc: 0.8224
Epoch 2/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.5987 - acc: 0.8290
 64/300 [=====>........................] - ETA: 3s - loss: 0.6055 - acc: 0.8189
 96/300 [========>.....................] - ETA: 3s - loss: 0.6001 - acc: 0.8197
128/300 [===========>..................] - ETA: 2s - loss: 0.5880 - acc: 0.8233
160/300 [===============>..............] - ETA: 2s - loss: 0.5970 - acc: 0.8168
192/300 [==================>...........] - ETA: 1s - loss: 0.5951 - acc: 0.8191
224/300 [=====================>........] - ETA: 1s - loss: 0.5733 - acc: 0.8262
256/300 [========================>.....] - ETA: 0s - loss: 0.5665 - acc: 0.8280
288/300 [===========================>..] - ETA: 0s - loss: 0.5599 - acc: 0.8287
300/300 [==============================] - 5s 18ms/step - loss: 0.5651 - acc: 0.8291 - val_loss: 0.3437 - val_acc: 0.9057
Epoch 3/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.4316 - acc: 0.8658
 64/300 [=====>........................] - ETA: 3s - loss: 0.4006 - acc: 0.8763
 96/300 [========>.....................] - ETA: 3s - loss: 0.4439 - acc: 0.8665
128/300 [===========>..................] - ETA: 2s - loss: 0.4584 - acc: 0.8681
160/300 [===============>..............] - ETA: 2s - loss: 0.4359 - acc: 0.8721
192/300 [==================>...........] - ETA: 1s - loss: 0.4185 - acc: 0.8780
224/300 [=====================>........] - ETA: 1s - loss: 0.4134 - acc: 0.8786
256/300 [========================>.....] - ETA: 0s - loss: 0.4143 - acc: 0.8770
288/300 [===========================>..] - ETA: 0s - loss: 0.4074 - acc: 0.8801
300/300 [==============================] - 5s 17ms/step - loss: 0.4054 - acc: 0.8811 - val_loss: 0.5081 - val_acc: 0.8416
Epoch 4/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.5259 - acc: 0.8331
 64/300 [=====>........................] - ETA: 3s - loss: 0.4644 - acc: 0.8541
 96/300 [========>.....................] - ETA: 3s - loss: 0.4186 - acc: 0.8704
128/300 [===========>..................] - ETA: 2s - loss: 0.3916 - acc: 0.8795
160/300 [===============>..............] - ETA: 2s - loss: 0.3823 - acc: 0.8819
192/300 [==================>...........] - ETA: 1s - loss: 0.3790 - acc: 0.8837
224/300 [=====================>........] - ETA: 1s - loss: 0.3712 - acc: 0.8863
256/300 [========================>.....] - ETA: 0s - loss: 0.3604 - acc: 0.8895
288/300 [===========================>..] - ETA: 0s - loss: 0.3564 - acc: 0.8901
300/300 [==============================] - 5s 17ms/step - loss: 0.3578 - acc: 0.8886 - val_loss: 0.2375 - val_acc: 0.9459
Epoch 5/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.3131 - acc: 0.9137
 64/300 [=====>........................] - ETA: 3s - loss: 0.2519 - acc: 0.9270
 96/300 [========>.....................] - ETA: 3s - loss: 0.2513 - acc: 0.9256
128/300 [===========>..................] - ETA: 2s - loss: 0.2488 - acc: 0.9280
160/300 [===============>..............] - ETA: 2s - loss: 0.2438 - acc: 0.9300
192/300 [==================>...........] - ETA: 1s - loss: 0.2550 - acc: 0.9244
224/300 [=====================>........] - ETA: 1s - loss: 0.2605 - acc: 0.9227
256/300 [========================>.....] - ETA: 0s - loss: 0.2701 - acc: 0.9184
288/300 [===========================>..] - ETA: 0s - loss: 0.2692 - acc: 0.9193
300/300 [==============================] - 5s 17ms/step - loss: 0.2716 - acc: 0.9188 - val_loss: 0.2099 - val_acc: 0.9473
Epoch 6/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.2358 - acc: 0.9309
 64/300 [=====>........................] - ETA: 3s - loss: 0.2347 - acc: 0.9309
 96/300 [========>.....................] - ETA: 3s - loss: 0.2300 - acc: 0.9321
128/300 [===========>..................] - ETA: 2s - loss: 0.2346 - acc: 0.9295
160/300 [===============>..............] - ETA: 2s - loss: 0.2384 - acc: 0.9279
192/300 [==================>...........] - ETA: 1s - loss: 0.2412 - acc: 0.9288
224/300 [=====================>........] - ETA: 1s - loss: 0.2432 - acc: 0.9259
256/300 [========================>.....] - ETA: 0s - loss: 0.2388 - acc: 0.9278
288/300 [===========================>..] - ETA: 0s - loss: 0.2395 - acc: 0.9271
300/300 [==============================] - 5s 17ms/step - loss: 0.2417 - acc: 0.9280 - val_loss: 0.1962 - val_acc: 0.9459
Epoch 7/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.2621 - acc: 0.9164
 64/300 [=====>........................] - ETA: 3s - loss: 0.2648 - acc: 0.9144
 96/300 [========>.....................] - ETA: 3s - loss: 0.2487 - acc: 0.9239
128/300 [===========>..................] - ETA: 2s - loss: 0.2368 - acc: 0.9293
160/300 [===============>..............] - ETA: 2s - loss: 0.2331 - acc: 0.9305
192/300 [==================>...........] - ETA: 1s - loss: 0.2298 - acc: 0.9297
224/300 [=====================>........] - ETA: 1s - loss: 0.2253 - acc: 0.9317
256/300 [========================>.....] - ETA: 0s - loss: 0.2225 - acc: 0.9327
288/300 [===========================>..] - ETA: 0s - loss: 0.2172 - acc: 0.9341
300/300 [==============================] - 5s 17ms/step - loss: 0.2183 - acc: 0.9334 - val_loss: 0.1857 - val_acc: 0.9487
Epoch 8/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.1896 - acc: 0.9308
 64/300 [=====>........................] - ETA: 3s - loss: 0.1933 - acc: 0.9391
 96/300 [========>.....................] - ETA: 3s - loss: 0.2005 - acc: 0.9377
128/300 [===========>..................] - ETA: 2s - loss: 0.1964 - acc: 0.9388
160/300 [===============>..............] - ETA: 2s - loss: 0.1846 - acc: 0.9440
192/300 [==================>...........] - ETA: 1s - loss: 0.1926 - acc: 0.9411
224/300 [=====================>........] - ETA: 1s - loss: 0.1917 - acc: 0.9406
256/300 [========================>.....] - ETA: 0s - loss: 0.1895 - acc: 0.9412
288/300 [===========================>..] - ETA: 0s - loss: 0.1893 - acc: 0.9419
300/300 [==============================] - 5s 17ms/step - loss: 0.1873 - acc: 0.9426 - val_loss: 0.1760 - val_acc: 0.9474
Epoch 9/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.1535 - acc: 0.9555
 64/300 [=====>........................] - ETA: 3s - loss: 0.1673 - acc: 0.9484
 96/300 [========>.....................] - ETA: 3s - loss: 0.1719 - acc: 0.9476
128/300 [===========>..................] - ETA: 2s - loss: 0.1607 - acc: 0.9524
160/300 [===============>..............] - ETA: 2s - loss: 0.1638 - acc: 0.9510
192/300 [==================>...........] - ETA: 1s - loss: 0.1609 - acc: 0.9530
224/300 [=====================>........] - ETA: 1s - loss: 0.1688 - acc: 0.9503
256/300 [========================>.....] - ETA: 0s - loss: 0.1704 - acc: 0.9498
288/300 [===========================>..] - ETA: 0s - loss: 0.1691 - acc: 0.9512
300/300 [==============================] - 5s 17ms/step - loss: 0.1747 - acc: 0.9494 - val_loss: 0.3370 - val_acc: 0.8929
Epoch 10/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.2783 - acc: 0.9120
 64/300 [=====>........................] - ETA: 3s - loss: 0.2438 - acc: 0.9174
 96/300 [========>.....................] - ETA: 3s - loss: 0.2203 - acc: 0.9280
128/300 [===========>..................] - ETA: 2s - loss: 0.1970 - acc: 0.9345
160/300 [===============>..............] - ETA: 2s - loss: 0.1884 - acc: 0.9380
192/300 [==================>...........] - ETA: 1s - loss: 0.1808 - acc: 0.9418
224/300 [=====================>........] - ETA: 1s - loss: 0.1787 - acc: 0.9441
256/300 [========================>.....] - ETA: 0s - loss: 0.1806 - acc: 0.9438
288/300 [===========================>..] - ETA: 0s - loss: 0.1766 - acc: 0.9460
300/300 [==============================] - 5s 17ms/step - loss: 0.1765 - acc: 0.9455 - val_loss: 0.1726 - val_acc: 0.9541
Epoch 11/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.1462 - acc: 0.9548
 64/300 [=====>........................] - ETA: 3s - loss: 0.1757 - acc: 0.9526
 96/300 [========>.....................] - ETA: 3s - loss: 0.1688 - acc: 0.9562
128/300 [===========>..................] - ETA: 2s - loss: 0.1643 - acc: 0.9563
160/300 [===============>..............] - ETA: 2s - loss: 0.1551 - acc: 0.9594
192/300 [==================>...........] - ETA: 1s - loss: 0.1497 - acc: 0.9604
224/300 [=====================>........] - ETA: 1s - loss: 0.1543 - acc: 0.9567
256/300 [========================>.....] - ETA: 0s - loss: 0.1563 - acc: 0.9560
288/300 [===========================>..] - ETA: 0s - loss: 0.1517 - acc: 0.9580
300/300 [==============================] - 5s 17ms/step - loss: 0.1513 - acc: 0.9578 - val_loss: 0.1605 - val_acc: 0.9541
Epoch 12/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.1082 - acc: 0.9707
 64/300 [=====>........................] - ETA: 3s - loss: 0.1277 - acc: 0.9650
 96/300 [========>.....................] - ETA: 3s - loss: 0.1287 - acc: 0.9625
128/300 [===========>..................] - ETA: 2s - loss: 0.1328 - acc: 0.9597
160/300 [===============>..............] - ETA: 2s - loss: 0.1293 - acc: 0.9608
192/300 [==================>...........] - ETA: 1s - loss: 0.1259 - acc: 0.9626
224/300 [=====================>........] - ETA: 1s - loss: 0.1232 - acc: 0.9628
256/300 [========================>.....] - ETA: 0s - loss: 0.1309 - acc: 0.9595
288/300 [===========================>..] - ETA: 0s - loss: 0.1317 - acc: 0.9600
300/300 [==============================] - 5s 17ms/step - loss: 0.1315 - acc: 0.9599 - val_loss: 0.1660 - val_acc: 0.9541
Epoch 13/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.1221 - acc: 0.9646
 64/300 [=====>........................] - ETA: 3s - loss: 0.1178 - acc: 0.9657
 96/300 [========>.....................] - ETA: 3s - loss: 0.1051 - acc: 0.9709
128/300 [===========>..................] - ETA: 2s - loss: 0.1220 - acc: 0.9641
160/300 [===============>..............] - ETA: 2s - loss: 0.1247 - acc: 0.9624
192/300 [==================>...........] - ETA: 1s - loss: 0.1292 - acc: 0.9631
224/300 [=====================>........] - ETA: 1s - loss: 0.1258 - acc: 0.9637
256/300 [========================>.....] - ETA: 0s - loss: 0.1257 - acc: 0.9638
288/300 [===========================>..] - ETA: 0s - loss: 0.1251 - acc: 0.9642
300/300 [==============================] - 5s 17ms/step - loss: 0.1249 - acc: 0.9644 - val_loss: 0.1568 - val_acc: 0.9500
Epoch 14/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.1153 - acc: 0.9738
 64/300 [=====>........................] - ETA: 3s - loss: 0.1075 - acc: 0.9771
 96/300 [========>.....................] - ETA: 3s - loss: 0.0981 - acc: 0.9790
128/300 [===========>..................] - ETA: 2s - loss: 0.0996 - acc: 0.9770
160/300 [===============>..............] - ETA: 2s - loss: 0.1057 - acc: 0.9738
192/300 [==================>...........] - ETA: 1s - loss: 0.1079 - acc: 0.9726
224/300 [=====================>........] - ETA: 1s - loss: 0.1098 - acc: 0.9717
256/300 [========================>.....] - ETA: 0s - loss: 0.1122 - acc: 0.9718
288/300 [===========================>..] - ETA: 0s - loss: 0.1114 - acc: 0.9719
300/300 [==============================] - 5s 17ms/step - loss: 0.1102 - acc: 0.9721 - val_loss: 0.1605 - val_acc: 0.9499
Epoch 15/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.0897 - acc: 0.9779
 64/300 [=====>........................] - ETA: 3s - loss: 0.1067 - acc: 0.9694
 96/300 [========>.....................] - ETA: 3s - loss: 0.1047 - acc: 0.9702
128/300 [===========>..................] - ETA: 2s - loss: 0.1045 - acc: 0.9708
160/300 [===============>..............] - ETA: 2s - loss: 0.1059 - acc: 0.9697
192/300 [==================>...........] - ETA: 1s - loss: 0.1037 - acc: 0.9701
224/300 [=====================>........] - ETA: 1s - loss: 0.1017 - acc: 0.9709
256/300 [========================>.....] - ETA: 0s - loss: 0.1033 - acc: 0.9703
288/300 [===========================>..] - ETA: 0s - loss: 0.1077 - acc: 0.9685
300/300 [==============================] - 5s 17ms/step - loss: 0.1067 - acc: 0.9687 - val_loss: 0.1560 - val_acc: 0.9541
Epoch 16/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.0772 - acc: 0.9800
 64/300 [=====>........................] - ETA: 3s - loss: 0.0972 - acc: 0.9785
 96/300 [========>.....................] - ETA: 3s - loss: 0.0933 - acc: 0.9775
128/300 [===========>..................] - ETA: 2s - loss: 0.0909 - acc: 0.9780
160/300 [===============>..............] - ETA: 2s - loss: 0.0994 - acc: 0.9743
192/300 [==================>...........] - ETA: 1s - loss: 0.1054 - acc: 0.9728
224/300 [=====================>........] - ETA: 1s - loss: 0.1010 - acc: 0.9738
256/300 [========================>.....] - ETA: 0s - loss: 0.1054 - acc: 0.9710
288/300 [===========================>..] - ETA: 0s - loss: 0.1036 - acc: 0.9704
300/300 [==============================] - 5s 17ms/step - loss: 0.1021 - acc: 0.9710 - val_loss: 0.1604 - val_acc: 0.9471
Epoch 17/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.0865 - acc: 0.9786
 64/300 [=====>........................] - ETA: 3s - loss: 0.0975 - acc: 0.9710
 96/300 [========>.....................] - ETA: 3s - loss: 0.1001 - acc: 0.9699
128/300 [===========>..................] - ETA: 2s - loss: 0.0970 - acc: 0.9732
160/300 [===============>..............] - ETA: 2s - loss: 0.0997 - acc: 0.9724
192/300 [==================>...........] - ETA: 1s - loss: 0.0947 - acc: 0.9744
224/300 [=====================>........] - ETA: 1s - loss: 0.0923 - acc: 0.9745
256/300 [========================>.....] - ETA: 0s - loss: 0.0910 - acc: 0.9757
288/300 [===========================>..] - ETA: 0s - loss: 0.0893 - acc: 0.9763
300/300 [==============================] - 5s 17ms/step - loss: 0.0888 - acc: 0.9764 - val_loss: 0.1817 - val_acc: 0.9485
Computing...
Manual evaluation: (didn't understand why I made this)
True 7907
False 1164
True percentage 0.87167897696
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.95      0.59      0.72       438
          O       0.96      0.96      0.96      7318
      B-ORG       0.58      0.65      0.61       296
     B-MISC       0.28      0.15      0.20       141
      B-LOC       0.77      0.60      0.67       218
      I-LOC       0.86      0.49      0.62       141
     I-MISC       0.27      0.16      0.20       154
      I-PER       0.97      0.52      0.68       214
      I-ORG       0.36      0.62      0.45       151

avg / total       0.91      0.87      0.89      9071

F-1 Score:
0.898150865864
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 334 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100379 unique words.
Found 94 unique chars.
Found 9 unique labels.
375 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 282
OOV word occurences: 459
Padding...
Data padded!
Padding...
Data padded!
Padded until 58 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 58, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 58)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 58, 64)       6424320     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 58, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 58, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 58, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 58, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 58, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,927,426
Trainable params: 6,927,426
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 300 samples, validate on 34 samples
Epoch 1/70

 32/300 [==>...........................] - ETA: 22s - loss: 2.1785 - acc: 0.1494
 64/300 [=====>........................] - ETA: 11s - loss: 1.5881 - acc: 0.4629
 96/300 [========>.....................] - ETA: 7s - loss: 1.3585 - acc: 0.5807 
128/300 [===========>..................] - ETA: 5s - loss: 1.4033 - acc: 0.6131
160/300 [===============>..............] - ETA: 4s - loss: 1.3006 - acc: 0.6446
192/300 [==================>...........] - ETA: 2s - loss: 1.2182 - acc: 0.6667
224/300 [=====================>........] - ETA: 1s - loss: 1.1580 - acc: 0.6815
256/300 [========================>.....] - ETA: 1s - loss: 1.0892 - acc: 0.6992
288/300 [===========================>..] - ETA: 0s - loss: 1.0496 - acc: 0.7081
300/300 [==============================] - 7s 25ms/step - loss: 1.0282 - acc: 0.7148 - val_loss: 0.6045 - val_acc: 0.8077
Epoch 2/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.5385 - acc: 0.8298
 64/300 [=====>........................] - ETA: 3s - loss: 0.5064 - acc: 0.8466
 96/300 [========>.....................] - ETA: 3s - loss: 0.4722 - acc: 0.8516
128/300 [===========>..................] - ETA: 2s - loss: 0.5206 - acc: 0.8359
160/300 [===============>..............] - ETA: 2s - loss: 0.5388 - acc: 0.8328
192/300 [==================>...........] - ETA: 1s - loss: 0.5450 - acc: 0.8280
224/300 [=====================>........] - ETA: 1s - loss: 0.5398 - acc: 0.8332
256/300 [========================>.....] - ETA: 0s - loss: 0.5399 - acc: 0.8337
288/300 [===========================>..] - ETA: 0s - loss: 0.5333 - acc: 0.8363
300/300 [==============================] - 5s 16ms/step - loss: 0.5278 - acc: 0.8384 - val_loss: 0.4038 - val_acc: 0.8766
Epoch 3/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.4549 - acc: 0.8530
 64/300 [=====>........................] - ETA: 3s - loss: 0.4344 - acc: 0.8761
 96/300 [========>.....................] - ETA: 2s - loss: 0.4303 - acc: 0.8721
128/300 [===========>..................] - ETA: 2s - loss: 0.4247 - acc: 0.8745
160/300 [===============>..............] - ETA: 2s - loss: 0.4134 - acc: 0.8767
192/300 [==================>...........] - ETA: 1s - loss: 0.4154 - acc: 0.8745
224/300 [=====================>........] - ETA: 1s - loss: 0.4035 - acc: 0.8800
256/300 [========================>.....] - ETA: 0s - loss: 0.4062 - acc: 0.8788
288/300 [===========================>..] - ETA: 0s - loss: 0.4056 - acc: 0.8810
300/300 [==============================] - 5s 15ms/step - loss: 0.4067 - acc: 0.8811 - val_loss: 0.3345 - val_acc: 0.9024
Epoch 4/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.3847 - acc: 0.8830
 64/300 [=====>........................] - ETA: 3s - loss: 0.3591 - acc: 0.8883
 96/300 [========>.....................] - ETA: 2s - loss: 0.3683 - acc: 0.8875
128/300 [===========>..................] - ETA: 2s - loss: 0.3600 - acc: 0.8926
160/300 [===============>..............] - ETA: 2s - loss: 0.3496 - acc: 0.8960
192/300 [==================>...........] - ETA: 1s - loss: 0.3353 - acc: 0.8982
224/300 [=====================>........] - ETA: 1s - loss: 0.3282 - acc: 0.9001
256/300 [========================>.....] - ETA: 0s - loss: 0.3222 - acc: 0.9025
288/300 [===========================>..] - ETA: 0s - loss: 0.3192 - acc: 0.9034
300/300 [==============================] - 5s 15ms/step - loss: 0.3190 - acc: 0.9033 - val_loss: 0.3245 - val_acc: 0.8939
Epoch 5/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.3218 - acc: 0.8962
 64/300 [=====>........................] - ETA: 3s - loss: 0.2758 - acc: 0.9182
 96/300 [========>.....................] - ETA: 2s - loss: 0.3053 - acc: 0.9094
128/300 [===========>..................] - ETA: 2s - loss: 0.2923 - acc: 0.9117
160/300 [===============>..............] - ETA: 2s - loss: 0.2726 - acc: 0.9194
192/300 [==================>...........] - ETA: 1s - loss: 0.2673 - acc: 0.9190
224/300 [=====================>........] - ETA: 1s - loss: 0.2672 - acc: 0.9178
256/300 [========================>.....] - ETA: 0s - loss: 0.2660 - acc: 0.9179
288/300 [===========================>..] - ETA: 0s - loss: 0.2671 - acc: 0.9175
300/300 [==============================] - 5s 16ms/step - loss: 0.2663 - acc: 0.9180 - val_loss: 0.3086 - val_acc: 0.8980
Epoch 6/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.3323 - acc: 0.8882
 64/300 [=====>........................] - ETA: 3s - loss: 0.2789 - acc: 0.9092
 96/300 [========>.....................] - ETA: 2s - loss: 0.2429 - acc: 0.9216
128/300 [===========>..................] - ETA: 2s - loss: 0.2520 - acc: 0.9196
160/300 [===============>..............] - ETA: 2s - loss: 0.2535 - acc: 0.9206
192/300 [==================>...........] - ETA: 1s - loss: 0.2393 - acc: 0.9263
224/300 [=====================>........] - ETA: 1s - loss: 0.2387 - acc: 0.9253
256/300 [========================>.....] - ETA: 0s - loss: 0.2391 - acc: 0.9243
288/300 [===========================>..] - ETA: 0s - loss: 0.2359 - acc: 0.9248
300/300 [==============================] - 5s 15ms/step - loss: 0.2324 - acc: 0.9262 - val_loss: 0.2614 - val_acc: 0.9210
Epoch 7/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.2325 - acc: 0.9285
 64/300 [=====>........................] - ETA: 3s - loss: 0.2243 - acc: 0.9298
 96/300 [========>.....................] - ETA: 2s - loss: 0.1833 - acc: 0.9460
128/300 [===========>..................] - ETA: 2s - loss: 0.1852 - acc: 0.9445
160/300 [===============>..............] - ETA: 2s - loss: 0.1919 - acc: 0.9407
192/300 [==================>...........] - ETA: 1s - loss: 0.2123 - acc: 0.9334
224/300 [=====================>........] - ETA: 1s - loss: 0.2069 - acc: 0.9355
256/300 [========================>.....] - ETA: 0s - loss: 0.2069 - acc: 0.9365
288/300 [===========================>..] - ETA: 0s - loss: 0.2019 - acc: 0.9377
300/300 [==============================] - 5s 15ms/step - loss: 0.2033 - acc: 0.9372 - val_loss: 0.2589 - val_acc: 0.9153
Epoch 8/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.2239 - acc: 0.9261
 64/300 [=====>........................] - ETA: 3s - loss: 0.2226 - acc: 0.9340
 96/300 [========>.....................] - ETA: 2s - loss: 0.2087 - acc: 0.9368
128/300 [===========>..................] - ETA: 2s - loss: 0.1881 - acc: 0.9426
160/300 [===============>..............] - ETA: 2s - loss: 0.1920 - acc: 0.9413
192/300 [==================>...........] - ETA: 1s - loss: 0.1913 - acc: 0.9411
224/300 [=====================>........] - ETA: 1s - loss: 0.1937 - acc: 0.9409
256/300 [========================>.....] - ETA: 0s - loss: 0.1913 - acc: 0.9420
288/300 [===========================>..] - ETA: 0s - loss: 0.1881 - acc: 0.9430
300/300 [==============================] - 5s 15ms/step - loss: 0.1882 - acc: 0.9423 - val_loss: 0.2823 - val_acc: 0.9066
Epoch 9/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.2135 - acc: 0.9214
 64/300 [=====>........................] - ETA: 3s - loss: 0.1945 - acc: 0.9373
 96/300 [========>.....................] - ETA: 2s - loss: 0.1869 - acc: 0.9409
128/300 [===========>..................] - ETA: 2s - loss: 0.1908 - acc: 0.9394
160/300 [===============>..............] - ETA: 2s - loss: 0.1822 - acc: 0.9427
192/300 [==================>...........] - ETA: 1s - loss: 0.1726 - acc: 0.9465
224/300 [=====================>........] - ETA: 1s - loss: 0.1636 - acc: 0.9493
256/300 [========================>.....] - ETA: 0s - loss: 0.1659 - acc: 0.9493
288/300 [===========================>..] - ETA: 0s - loss: 0.1692 - acc: 0.9495
300/300 [==============================] - 5s 15ms/step - loss: 0.1696 - acc: 0.9493 - val_loss: 0.2646 - val_acc: 0.9081
Computing...
Manual evaluation: (didn't understand why I made this)
True 7779
False 1292
True percentage 0.857568074082
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.89      0.63      0.73       438
          O       0.94      0.97      0.95      7318
      B-LOC       0.84      0.50      0.62       218
      I-LOC       0.74      0.40      0.52       141
      I-PER       0.89      0.55      0.68       214
      B-ORG       0.50      0.34      0.40       296
      I-ORG       0.26      0.25      0.26       151
     B-MISC       0.22      0.07      0.11       141
     I-MISC       0.28      0.07      0.11       154

avg / total       0.88      0.86      0.86      9071

F-1 Score:
0.886277751535
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 334 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100388 unique words.
Found 94 unique chars.
Found 9 unique labels.
384 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 280
OOV word occurences: 464
Padding...
Data padded!
Padding...
Data padded!
Padded until 83 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6424896     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,928,002
Trainable params: 6,928,002
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 300 samples, validate on 34 samples
Epoch 1/70

 32/300 [==>...........................] - ETA: 23s - loss: 2.2508 - acc: 0.0398
 64/300 [=====>........................] - ETA: 12s - loss: 1.6174 - acc: 0.4210
 96/300 [========>.....................] - ETA: 8s - loss: 1.9629 - acc: 0.5488 
128/300 [===========>..................] - ETA: 6s - loss: 1.7380 - acc: 0.6084
160/300 [===============>..............] - ETA: 4s - loss: 1.5175 - acc: 0.6578
192/300 [==================>...........] - ETA: 3s - loss: 1.3959 - acc: 0.6847
224/300 [=====================>........] - ETA: 2s - loss: 1.2939 - acc: 0.7043
256/300 [========================>.....] - ETA: 1s - loss: 1.2199 - acc: 0.7176
288/300 [===========================>..] - ETA: 0s - loss: 1.1585 - acc: 0.7277
300/300 [==============================] - 9s 30ms/step - loss: 1.1409 - acc: 0.7304 - val_loss: 0.7736 - val_acc: 0.7627
Epoch 2/70

 32/300 [==>...........................] - ETA: 5s - loss: 0.7352 - acc: 0.7884
 64/300 [=====>........................] - ETA: 4s - loss: 0.6380 - acc: 0.8112
 96/300 [========>.....................] - ETA: 3s - loss: 0.6262 - acc: 0.8188
128/300 [===========>..................] - ETA: 3s - loss: 0.5927 - acc: 0.8258
160/300 [===============>..............] - ETA: 2s - loss: 0.5905 - acc: 0.8255
192/300 [==================>...........] - ETA: 2s - loss: 0.5648 - acc: 0.8328
224/300 [=====================>........] - ETA: 1s - loss: 0.5756 - acc: 0.8292
256/300 [========================>.....] - ETA: 0s - loss: 0.5854 - acc: 0.8299
288/300 [===========================>..] - ETA: 0s - loss: 0.5605 - acc: 0.8378
300/300 [==============================] - 6s 21ms/step - loss: 0.5575 - acc: 0.8387 - val_loss: 0.6067 - val_acc: 0.8028
Epoch 3/70

 32/300 [==>...........................] - ETA: 5s - loss: 0.4324 - acc: 0.8782
 64/300 [=====>........................] - ETA: 4s - loss: 0.4183 - acc: 0.8787
 96/300 [========>.....................] - ETA: 3s - loss: 0.4218 - acc: 0.8778
128/300 [===========>..................] - ETA: 3s - loss: 0.4285 - acc: 0.8693
160/300 [===============>..............] - ETA: 2s - loss: 0.4299 - acc: 0.8709
192/300 [==================>...........] - ETA: 2s - loss: 0.4205 - acc: 0.8728
224/300 [=====================>........] - ETA: 1s - loss: 0.4143 - acc: 0.8757
256/300 [========================>.....] - ETA: 0s - loss: 0.4038 - acc: 0.8790
288/300 [===========================>..] - ETA: 0s - loss: 0.4065 - acc: 0.8770
300/300 [==============================] - 6s 21ms/step - loss: 0.4087 - acc: 0.8760 - val_loss: 0.5340 - val_acc: 0.8242
Epoch 4/70

 32/300 [==>...........................] - ETA: 5s - loss: 0.2467 - acc: 0.9255
 64/300 [=====>........................] - ETA: 4s - loss: 0.2828 - acc: 0.9193
 96/300 [========>.....................] - ETA: 3s - loss: 0.2961 - acc: 0.9165
128/300 [===========>..................] - ETA: 3s - loss: 0.3189 - acc: 0.9048
160/300 [===============>..............] - ETA: 2s - loss: 0.3280 - acc: 0.9017
192/300 [==================>...........] - ETA: 2s - loss: 0.3338 - acc: 0.9004
224/300 [=====================>........] - ETA: 1s - loss: 0.3247 - acc: 0.9035
256/300 [========================>.....] - ETA: 0s - loss: 0.3237 - acc: 0.9027
288/300 [===========================>..] - ETA: 0s - loss: 0.3214 - acc: 0.9033
300/300 [==============================] - 6s 20ms/step - loss: 0.3256 - acc: 0.9012 - val_loss: 0.4795 - val_acc: 0.8471
Epoch 5/70

 32/300 [==>...........................] - ETA: 5s - loss: 0.2949 - acc: 0.9035
 64/300 [=====>........................] - ETA: 4s - loss: 0.2941 - acc: 0.9064
 96/300 [========>.....................] - ETA: 3s - loss: 0.2675 - acc: 0.9183
128/300 [===========>..................] - ETA: 3s - loss: 0.2662 - acc: 0.9194
160/300 [===============>..............] - ETA: 2s - loss: 0.2647 - acc: 0.9186
192/300 [==================>...........] - ETA: 2s - loss: 0.2768 - acc: 0.9153
224/300 [=====================>........] - ETA: 1s - loss: 0.2785 - acc: 0.9139
256/300 [========================>.....] - ETA: 0s - loss: 0.2737 - acc: 0.9161
288/300 [===========================>..] - ETA: 0s - loss: 0.2780 - acc: 0.9131
300/300 [==============================] - 6s 20ms/step - loss: 0.2776 - acc: 0.9130 - val_loss: 0.4473 - val_acc: 0.8500
Epoch 6/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.2655 - acc: 0.9109
 64/300 [=====>........................] - ETA: 4s - loss: 0.2568 - acc: 0.9297
 96/300 [========>.....................] - ETA: 3s - loss: 0.2417 - acc: 0.9357
128/300 [===========>..................] - ETA: 3s - loss: 0.2499 - acc: 0.9303
160/300 [===============>..............] - ETA: 2s - loss: 0.2578 - acc: 0.9233
192/300 [==================>...........] - ETA: 2s - loss: 0.2504 - acc: 0.9253
224/300 [=====================>........] - ETA: 1s - loss: 0.2482 - acc: 0.9266
256/300 [========================>.....] - ETA: 0s - loss: 0.2391 - acc: 0.9288
288/300 [===========================>..] - ETA: 0s - loss: 0.2356 - acc: 0.9293
300/300 [==============================] - 6s 20ms/step - loss: 0.2389 - acc: 0.9282 - val_loss: 0.4567 - val_acc: 0.8528
Epoch 7/70

 32/300 [==>...........................] - ETA: 5s - loss: 0.2033 - acc: 0.9434
 64/300 [=====>........................] - ETA: 4s - loss: 0.2327 - acc: 0.9353
 96/300 [========>.....................] - ETA: 3s - loss: 0.2261 - acc: 0.9389
128/300 [===========>..................] - ETA: 3s - loss: 0.2185 - acc: 0.9412
160/300 [===============>..............] - ETA: 2s - loss: 0.2143 - acc: 0.9414
192/300 [==================>...........] - ETA: 2s - loss: 0.2060 - acc: 0.9430
224/300 [=====================>........] - ETA: 1s - loss: 0.2226 - acc: 0.9346
256/300 [========================>.....] - ETA: 0s - loss: 0.2195 - acc: 0.9366
288/300 [===========================>..] - ETA: 0s - loss: 0.2189 - acc: 0.9367
300/300 [==============================] - 6s 20ms/step - loss: 0.2198 - acc: 0.9362 - val_loss: 0.4029 - val_acc: 0.8671
Epoch 8/70

 32/300 [==>...........................] - ETA: 5s - loss: 0.2130 - acc: 0.9341
 64/300 [=====>........................] - ETA: 4s - loss: 0.2034 - acc: 0.9351
 96/300 [========>.....................] - ETA: 3s - loss: 0.2014 - acc: 0.9350
128/300 [===========>..................] - ETA: 3s - loss: 0.1896 - acc: 0.9432
160/300 [===============>..............] - ETA: 2s - loss: 0.1892 - acc: 0.9428
192/300 [==================>...........] - ETA: 2s - loss: 0.1902 - acc: 0.9431
224/300 [=====================>........] - ETA: 1s - loss: 0.1911 - acc: 0.9429
256/300 [========================>.....] - ETA: 0s - loss: 0.1919 - acc: 0.9422
288/300 [===========================>..] - ETA: 0s - loss: 0.1948 - acc: 0.9401
300/300 [==============================] - 6s 20ms/step - loss: 0.1909 - acc: 0.9415 - val_loss: 0.3809 - val_acc: 0.8686
Epoch 9/70

 32/300 [==>...........................] - ETA: 5s - loss: 0.1856 - acc: 0.9390
 64/300 [=====>........................] - ETA: 4s - loss: 0.1672 - acc: 0.9495
 96/300 [========>.....................] - ETA: 3s - loss: 0.1561 - acc: 0.9519
128/300 [===========>..................] - ETA: 3s - loss: 0.1641 - acc: 0.9497
160/300 [===============>..............] - ETA: 2s - loss: 0.1690 - acc: 0.9502
192/300 [==================>...........] - ETA: 2s - loss: 0.1818 - acc: 0.9455
224/300 [=====================>........] - ETA: 1s - loss: 0.1750 - acc: 0.9468
256/300 [========================>.....] - ETA: 0s - loss: 0.1702 - acc: 0.9489
288/300 [===========================>..] - ETA: 0s - loss: 0.1737 - acc: 0.9468
300/300 [==============================] - 6s 20ms/step - loss: 0.1733 - acc: 0.9472 - val_loss: 0.3768 - val_acc: 0.8799
Epoch 10/70

 32/300 [==>...........................] - ETA: 5s - loss: 0.1522 - acc: 0.9548
 64/300 [=====>........................] - ETA: 4s - loss: 0.1581 - acc: 0.9483
 96/300 [========>.....................] - ETA: 3s - loss: 0.1705 - acc: 0.9460
128/300 [===========>..................] - ETA: 3s - loss: 0.1676 - acc: 0.9476
160/300 [===============>..............] - ETA: 2s - loss: 0.1565 - acc: 0.9533
192/300 [==================>...........] - ETA: 2s - loss: 0.1493 - acc: 0.9539
224/300 [=====================>........] - ETA: 1s - loss: 0.1488 - acc: 0.9531
256/300 [========================>.....] - ETA: 0s - loss: 0.1475 - acc: 0.9521
288/300 [===========================>..] - ETA: 0s - loss: 0.1498 - acc: 0.9515
300/300 [==============================] - 6s 20ms/step - loss: 0.1502 - acc: 0.9508 - val_loss: 0.3790 - val_acc: 0.8743
Epoch 11/70

 32/300 [==>...........................] - ETA: 5s - loss: 0.1482 - acc: 0.9496
 64/300 [=====>........................] - ETA: 4s - loss: 0.1353 - acc: 0.9530
 96/300 [========>.....................] - ETA: 3s - loss: 0.1400 - acc: 0.9546
128/300 [===========>..................] - ETA: 3s - loss: 0.1402 - acc: 0.9555
160/300 [===============>..............] - ETA: 2s - loss: 0.1357 - acc: 0.9580
192/300 [==================>...........] - ETA: 2s - loss: 0.1291 - acc: 0.9606
224/300 [=====================>........] - ETA: 1s - loss: 0.1402 - acc: 0.9574
256/300 [========================>.....] - ETA: 0s - loss: 0.1377 - acc: 0.9592
288/300 [===========================>..] - ETA: 0s - loss: 0.1375 - acc: 0.9590
300/300 [==============================] - 6s 20ms/step - loss: 0.1399 - acc: 0.9572 - val_loss: 0.3817 - val_acc: 0.8843
Computing...
Manual evaluation: (didn't understand why I made this)
True 7880
False 1191
True percentage 0.868702458384
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-ORG       0.61      0.45      0.52       296
     B-MISC       0.34      0.12      0.18       141
     I-MISC       0.27      0.33      0.29       154
      B-PER       0.90      0.69      0.78       438
      B-LOC       0.61      0.80      0.69       218
      I-ORG       0.49      0.29      0.37       151
      I-PER       0.92      0.53      0.67       214
      I-LOC       0.61      0.79      0.69       141

avg / total       0.91      0.87      0.89      9071

F-1 Score:
0.585833591092
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 334 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100372 unique words.
Found 94 unique chars.
Found 9 unique labels.
368 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 274
OOV word occurences: 397
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6423872     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,926,978
Trainable params: 6,926,978
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 300 samples, validate on 34 samples
Epoch 1/70

 32/300 [==>...........................] - ETA: 22s - loss: 2.5666 - acc: 0.0128
 64/300 [=====>........................] - ETA: 11s - loss: 1.8394 - acc: 0.4035
 96/300 [========>.....................] - ETA: 7s - loss: 1.9588 - acc: 0.5468 
128/300 [===========>..................] - ETA: 5s - loss: 1.6769 - acc: 0.6132
160/300 [===============>..............] - ETA: 4s - loss: 1.5193 - acc: 0.6509
192/300 [==================>...........] - ETA: 2s - loss: 1.4194 - acc: 0.6778
224/300 [=====================>........] - ETA: 1s - loss: 1.3312 - acc: 0.6934
256/300 [========================>.....] - ETA: 1s - loss: 1.2692 - acc: 0.7035
288/300 [===========================>..] - ETA: 0s - loss: 1.2078 - acc: 0.7137
300/300 [==============================] - 7s 24ms/step - loss: 1.1794 - acc: 0.7200 - val_loss: 0.7397 - val_acc: 0.7866
Epoch 2/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.6325 - acc: 0.8220
 64/300 [=====>........................] - ETA: 3s - loss: 0.6961 - acc: 0.7939
 96/300 [========>.....................] - ETA: 3s - loss: 0.6676 - acc: 0.8018
128/300 [===========>..................] - ETA: 2s - loss: 0.6342 - acc: 0.8079
160/300 [===============>..............] - ETA: 2s - loss: 0.6000 - acc: 0.8209
192/300 [==================>...........] - ETA: 1s - loss: 0.5920 - acc: 0.8198
224/300 [=====================>........] - ETA: 1s - loss: 0.5835 - acc: 0.8252
256/300 [========================>.....] - ETA: 0s - loss: 0.5714 - acc: 0.8272
288/300 [===========================>..] - ETA: 0s - loss: 0.5683 - acc: 0.8261
300/300 [==============================] - 5s 16ms/step - loss: 0.5648 - acc: 0.8273 - val_loss: 0.5615 - val_acc: 0.8095
Epoch 3/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.4919 - acc: 0.8398
 64/300 [=====>........................] - ETA: 3s - loss: 0.4648 - acc: 0.8623
 96/300 [========>.....................] - ETA: 2s - loss: 0.4304 - acc: 0.8703
128/300 [===========>..................] - ETA: 2s - loss: 0.4354 - acc: 0.8647
160/300 [===============>..............] - ETA: 2s - loss: 0.4329 - acc: 0.8639
192/300 [==================>...........] - ETA: 1s - loss: 0.4141 - acc: 0.8751
224/300 [=====================>........] - ETA: 1s - loss: 0.4072 - acc: 0.8740
256/300 [========================>.....] - ETA: 0s - loss: 0.4124 - acc: 0.8738
288/300 [===========================>..] - ETA: 0s - loss: 0.4150 - acc: 0.8731
300/300 [==============================] - 5s 15ms/step - loss: 0.4154 - acc: 0.8730 - val_loss: 0.4440 - val_acc: 0.8652
Epoch 4/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.3394 - acc: 0.9050
 64/300 [=====>........................] - ETA: 3s - loss: 0.3150 - acc: 0.9075
 96/300 [========>.....................] - ETA: 2s - loss: 0.3276 - acc: 0.9024
128/300 [===========>..................] - ETA: 2s - loss: 0.3331 - acc: 0.9009
160/300 [===============>..............] - ETA: 1s - loss: 0.3242 - acc: 0.9000
192/300 [==================>...........] - ETA: 1s - loss: 0.3230 - acc: 0.9021
224/300 [=====================>........] - ETA: 1s - loss: 0.3273 - acc: 0.8994
256/300 [========================>.....] - ETA: 0s - loss: 0.3329 - acc: 0.9001
288/300 [===========================>..] - ETA: 0s - loss: 0.3323 - acc: 0.8990
300/300 [==============================] - 5s 15ms/step - loss: 0.3340 - acc: 0.8978 - val_loss: 0.4249 - val_acc: 0.8663
Epoch 5/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.3426 - acc: 0.9005
 64/300 [=====>........................] - ETA: 3s - loss: 0.3288 - acc: 0.8998
 96/300 [========>.....................] - ETA: 2s - loss: 0.3216 - acc: 0.9016
128/300 [===========>..................] - ETA: 2s - loss: 0.3136 - acc: 0.9006
160/300 [===============>..............] - ETA: 1s - loss: 0.3002 - acc: 0.9055
192/300 [==================>...........] - ETA: 1s - loss: 0.2898 - acc: 0.9080
224/300 [=====================>........] - ETA: 1s - loss: 0.2869 - acc: 0.9106
256/300 [========================>.....] - ETA: 0s - loss: 0.2804 - acc: 0.9124
288/300 [===========================>..] - ETA: 0s - loss: 0.2805 - acc: 0.9127
300/300 [==============================] - 5s 15ms/step - loss: 0.2841 - acc: 0.9118 - val_loss: 0.3762 - val_acc: 0.8791
Epoch 6/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.3398 - acc: 0.9038
 64/300 [=====>........................] - ETA: 3s - loss: 0.2922 - acc: 0.9194
 96/300 [========>.....................] - ETA: 2s - loss: 0.2811 - acc: 0.9197
128/300 [===========>..................] - ETA: 2s - loss: 0.2741 - acc: 0.9160
160/300 [===============>..............] - ETA: 2s - loss: 0.2601 - acc: 0.9218
192/300 [==================>...........] - ETA: 1s - loss: 0.2608 - acc: 0.9220
224/300 [=====================>........] - ETA: 1s - loss: 0.2556 - acc: 0.9232
256/300 [========================>.....] - ETA: 0s - loss: 0.2521 - acc: 0.9262
288/300 [===========================>..] - ETA: 0s - loss: 0.2512 - acc: 0.9249
300/300 [==============================] - 5s 15ms/step - loss: 0.2478 - acc: 0.9258 - val_loss: 0.2978 - val_acc: 0.9148
Epoch 7/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.2092 - acc: 0.9394
 64/300 [=====>........................] - ETA: 3s - loss: 0.2194 - acc: 0.9365
 96/300 [========>.....................] - ETA: 2s - loss: 0.2325 - acc: 0.9341
128/300 [===========>..................] - ETA: 2s - loss: 0.2325 - acc: 0.9328
160/300 [===============>..............] - ETA: 1s - loss: 0.2162 - acc: 0.9358
192/300 [==================>...........] - ETA: 1s - loss: 0.2096 - acc: 0.9363
224/300 [=====================>........] - ETA: 1s - loss: 0.2074 - acc: 0.9371
256/300 [========================>.....] - ETA: 0s - loss: 0.2055 - acc: 0.9367
288/300 [===========================>..] - ETA: 0s - loss: 0.2106 - acc: 0.9342
300/300 [==============================] - 5s 15ms/step - loss: 0.2084 - acc: 0.9346 - val_loss: 0.2848 - val_acc: 0.9188
Epoch 8/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.2000 - acc: 0.9415
 64/300 [=====>........................] - ETA: 3s - loss: 0.2107 - acc: 0.9354
 96/300 [========>.....................] - ETA: 2s - loss: 0.2093 - acc: 0.9385
128/300 [===========>..................] - ETA: 2s - loss: 0.2099 - acc: 0.9382
160/300 [===============>..............] - ETA: 1s - loss: 0.2031 - acc: 0.9394
192/300 [==================>...........] - ETA: 1s - loss: 0.2018 - acc: 0.9381
224/300 [=====================>........] - ETA: 1s - loss: 0.1955 - acc: 0.9397
256/300 [========================>.....] - ETA: 0s - loss: 0.1917 - acc: 0.9408
288/300 [===========================>..] - ETA: 0s - loss: 0.1870 - acc: 0.9423
300/300 [==============================] - 5s 15ms/step - loss: 0.1875 - acc: 0.9413 - val_loss: 0.2931 - val_acc: 0.9086
Epoch 9/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.1824 - acc: 0.9385
 64/300 [=====>........................] - ETA: 3s - loss: 0.1835 - acc: 0.9419
 96/300 [========>.....................] - ETA: 2s - loss: 0.1715 - acc: 0.9489
128/300 [===========>..................] - ETA: 2s - loss: 0.1791 - acc: 0.9446
160/300 [===============>..............] - ETA: 1s - loss: 0.1761 - acc: 0.9455
192/300 [==================>...........] - ETA: 1s - loss: 0.1706 - acc: 0.9479
224/300 [=====================>........] - ETA: 1s - loss: 0.1802 - acc: 0.9449
256/300 [========================>.....] - ETA: 0s - loss: 0.1809 - acc: 0.9460
288/300 [===========================>..] - ETA: 0s - loss: 0.1765 - acc: 0.9468
300/300 [==============================] - 5s 15ms/step - loss: 0.1776 - acc: 0.9470 - val_loss: 0.3146 - val_acc: 0.9071
Computing...
Manual evaluation: (didn't understand why I made this)
True 7780
False 1291
True percentage 0.857678315511
Sklearn evaluation:
             precision    recall  f1-score   support

     B-MISC       0.43      0.02      0.04       141
     I-MISC       0.20      0.06      0.10       154
          O       0.92      0.97      0.94      7318
      B-PER       0.88      0.55      0.68       438
      I-PER       0.88      0.47      0.61       214
      B-ORG       0.67      0.52      0.58       296
      B-LOC       0.82      0.49      0.61       218
      I-ORG       0.35      0.19      0.25       151
      I-LOC       0.92      0.47      0.62       141

avg / total       0.87      0.86      0.86      9071

F-1 Score:
0.883900664886
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 334 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100376 unique words.
Found 94 unique chars.
Found 9 unique labels.
372 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 285
OOV word occurences: 448
Padding...
Data padded!
Padding...
Data padded!
Padded until 67 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 67, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 67)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 67, 64)       6424128     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 67, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 67, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 67, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 67, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 67, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,927,234
Trainable params: 6,927,234
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 300 samples, validate on 34 samples
Epoch 1/70

 32/300 [==>...........................] - ETA: 22s - loss: 2.3916 - acc: 0.0172
 64/300 [=====>........................] - ETA: 12s - loss: 1.6681 - acc: 0.4083
 96/300 [========>.....................] - ETA: 8s - loss: 1.4798 - acc: 0.5440 
128/300 [===========>..................] - ETA: 5s - loss: 1.4974 - acc: 0.5971
160/300 [===============>..............] - ETA: 4s - loss: 1.3418 - acc: 0.6455
192/300 [==================>...........] - ETA: 3s - loss: 1.2670 - acc: 0.6653
224/300 [=====================>........] - ETA: 2s - loss: 1.2024 - acc: 0.6853
256/300 [========================>.....] - ETA: 1s - loss: 1.1320 - acc: 0.7033
288/300 [===========================>..] - ETA: 0s - loss: 1.0861 - acc: 0.7134
300/300 [==============================] - 8s 27ms/step - loss: 1.0772 - acc: 0.7139 - val_loss: 0.7037 - val_acc: 0.8115
Epoch 2/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.6665 - acc: 0.8247
 64/300 [=====>........................] - ETA: 3s - loss: 0.6998 - acc: 0.7911
 96/300 [========>.....................] - ETA: 3s - loss: 0.6654 - acc: 0.8065
128/300 [===========>..................] - ETA: 2s - loss: 0.6396 - acc: 0.8085
160/300 [===============>..............] - ETA: 2s - loss: 0.6168 - acc: 0.8193
192/300 [==================>...........] - ETA: 1s - loss: 0.5997 - acc: 0.8233
224/300 [=====================>........] - ETA: 1s - loss: 0.6060 - acc: 0.8193
256/300 [========================>.....] - ETA: 0s - loss: 0.5934 - acc: 0.8253
288/300 [===========================>..] - ETA: 0s - loss: 0.5743 - acc: 0.8290
300/300 [==============================] - 5s 18ms/step - loss: 0.5693 - acc: 0.8312 - val_loss: 0.4949 - val_acc: 0.8431
Epoch 3/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.4988 - acc: 0.8323
 64/300 [=====>........................] - ETA: 3s - loss: 0.4774 - acc: 0.8537
 96/300 [========>.....................] - ETA: 3s - loss: 0.4516 - acc: 0.8557
128/300 [===========>..................] - ETA: 2s - loss: 0.4452 - acc: 0.8585
160/300 [===============>..............] - ETA: 2s - loss: 0.4574 - acc: 0.8570
192/300 [==================>...........] - ETA: 1s - loss: 0.4469 - acc: 0.8581
224/300 [=====================>........] - ETA: 1s - loss: 0.4483 - acc: 0.8632
256/300 [========================>.....] - ETA: 0s - loss: 0.4372 - acc: 0.8669
288/300 [===========================>..] - ETA: 0s - loss: 0.4309 - acc: 0.8688
300/300 [==============================] - 5s 18ms/step - loss: 0.4264 - acc: 0.8698 - val_loss: 0.3845 - val_acc: 0.8759
Epoch 4/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.3175 - acc: 0.9061
 64/300 [=====>........................] - ETA: 3s - loss: 0.3163 - acc: 0.9044
 96/300 [========>.....................] - ETA: 3s - loss: 0.3303 - acc: 0.9054
128/300 [===========>..................] - ETA: 2s - loss: 0.3384 - acc: 0.8980
160/300 [===============>..............] - ETA: 2s - loss: 0.3599 - acc: 0.8909
192/300 [==================>...........] - ETA: 1s - loss: 0.3618 - acc: 0.8937
224/300 [=====================>........] - ETA: 1s - loss: 0.3543 - acc: 0.8937
256/300 [========================>.....] - ETA: 0s - loss: 0.3449 - acc: 0.8967
288/300 [===========================>..] - ETA: 0s - loss: 0.3379 - acc: 0.8979
300/300 [==============================] - 5s 18ms/step - loss: 0.3367 - acc: 0.8987 - val_loss: 0.3338 - val_acc: 0.8840
Epoch 5/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.3611 - acc: 0.8847
 64/300 [=====>........................] - ETA: 3s - loss: 0.3346 - acc: 0.8937
 96/300 [========>.....................] - ETA: 3s - loss: 0.3263 - acc: 0.8989
128/300 [===========>..................] - ETA: 2s - loss: 0.3054 - acc: 0.9038
160/300 [===============>..............] - ETA: 2s - loss: 0.2877 - acc: 0.9122
192/300 [==================>...........] - ETA: 1s - loss: 0.2801 - acc: 0.9145
224/300 [=====================>........] - ETA: 1s - loss: 0.2860 - acc: 0.9136
256/300 [========================>.....] - ETA: 0s - loss: 0.2859 - acc: 0.9154
288/300 [===========================>..] - ETA: 0s - loss: 0.2810 - acc: 0.9164
300/300 [==============================] - 5s 18ms/step - loss: 0.2771 - acc: 0.9173 - val_loss: 0.2769 - val_acc: 0.8997
Epoch 6/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.2424 - acc: 0.9260
 64/300 [=====>........................] - ETA: 3s - loss: 0.2423 - acc: 0.9257
 96/300 [========>.....................] - ETA: 3s - loss: 0.2378 - acc: 0.9288
128/300 [===========>..................] - ETA: 2s - loss: 0.2490 - acc: 0.9241
160/300 [===============>..............] - ETA: 2s - loss: 0.2479 - acc: 0.9220
192/300 [==================>...........] - ETA: 1s - loss: 0.2445 - acc: 0.9231
224/300 [=====================>........] - ETA: 1s - loss: 0.2403 - acc: 0.9255
256/300 [========================>.....] - ETA: 0s - loss: 0.2309 - acc: 0.9275
288/300 [===========================>..] - ETA: 0s - loss: 0.2388 - acc: 0.9237
300/300 [==============================] - 5s 17ms/step - loss: 0.2364 - acc: 0.9252 - val_loss: 0.3511 - val_acc: 0.8853
Epoch 7/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.2521 - acc: 0.9222
 64/300 [=====>........................] - ETA: 3s - loss: 0.2453 - acc: 0.9234
 96/300 [========>.....................] - ETA: 3s - loss: 0.2241 - acc: 0.9300
128/300 [===========>..................] - ETA: 2s - loss: 0.2254 - acc: 0.9302
160/300 [===============>..............] - ETA: 2s - loss: 0.2159 - acc: 0.9340
192/300 [==================>...........] - ETA: 1s - loss: 0.2158 - acc: 0.9331
224/300 [=====================>........] - ETA: 1s - loss: 0.2099 - acc: 0.9359
256/300 [========================>.....] - ETA: 0s - loss: 0.2145 - acc: 0.9337
288/300 [===========================>..] - ETA: 0s - loss: 0.2218 - acc: 0.9324
300/300 [==============================] - 5s 17ms/step - loss: 0.2206 - acc: 0.9329 - val_loss: 0.2506 - val_acc: 0.9122
Epoch 8/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.1844 - acc: 0.9347
 64/300 [=====>........................] - ETA: 3s - loss: 0.1707 - acc: 0.9507
 96/300 [========>.....................] - ETA: 3s - loss: 0.1582 - acc: 0.9519
128/300 [===========>..................] - ETA: 2s - loss: 0.1789 - acc: 0.9462
160/300 [===============>..............] - ETA: 2s - loss: 0.1775 - acc: 0.9483
192/300 [==================>...........] - ETA: 1s - loss: 0.1890 - acc: 0.9429
224/300 [=====================>........] - ETA: 1s - loss: 0.1871 - acc: 0.9427
256/300 [========================>.....] - ETA: 0s - loss: 0.1908 - acc: 0.9411
288/300 [===========================>..] - ETA: 0s - loss: 0.1906 - acc: 0.9423
300/300 [==============================] - 5s 17ms/step - loss: 0.1912 - acc: 0.9416 - val_loss: 0.2211 - val_acc: 0.9303
Epoch 9/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.1354 - acc: 0.9625
 64/300 [=====>........................] - ETA: 3s - loss: 0.2139 - acc: 0.9388
 96/300 [========>.....................] - ETA: 3s - loss: 0.1839 - acc: 0.9452
128/300 [===========>..................] - ETA: 2s - loss: 0.1856 - acc: 0.9449
160/300 [===============>..............] - ETA: 2s - loss: 0.1738 - acc: 0.9490
192/300 [==================>...........] - ETA: 1s - loss: 0.1655 - acc: 0.9510
224/300 [=====================>........] - ETA: 1s - loss: 0.1737 - acc: 0.9490
256/300 [========================>.....] - ETA: 0s - loss: 0.1757 - acc: 0.9490
288/300 [===========================>..] - ETA: 0s - loss: 0.1734 - acc: 0.9494
300/300 [==============================] - 5s 17ms/step - loss: 0.1717 - acc: 0.9495 - val_loss: 0.2265 - val_acc: 0.9209
Epoch 10/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.1335 - acc: 0.9625
 64/300 [=====>........................] - ETA: 3s - loss: 0.1577 - acc: 0.9562
 96/300 [========>.....................] - ETA: 3s - loss: 0.1719 - acc: 0.9510
128/300 [===========>..................] - ETA: 2s - loss: 0.1734 - acc: 0.9506
160/300 [===============>..............] - ETA: 2s - loss: 0.1724 - acc: 0.9495
192/300 [==================>...........] - ETA: 1s - loss: 0.1588 - acc: 0.9538
224/300 [=====================>........] - ETA: 1s - loss: 0.1549 - acc: 0.9548
256/300 [========================>.....] - ETA: 0s - loss: 0.1539 - acc: 0.9572
288/300 [===========================>..] - ETA: 0s - loss: 0.1624 - acc: 0.9532
300/300 [==============================] - 5s 17ms/step - loss: 0.1587 - acc: 0.9543 - val_loss: 0.2172 - val_acc: 0.9259
Epoch 11/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.1919 - acc: 0.9397
 64/300 [=====>........................] - ETA: 3s - loss: 0.1595 - acc: 0.9503
 96/300 [========>.....................] - ETA: 3s - loss: 0.1413 - acc: 0.9570
128/300 [===========>..................] - ETA: 2s - loss: 0.1355 - acc: 0.9586
160/300 [===============>..............] - ETA: 2s - loss: 0.1471 - acc: 0.9562
192/300 [==================>...........] - ETA: 1s - loss: 0.1518 - acc: 0.9545
224/300 [=====================>........] - ETA: 1s - loss: 0.1488 - acc: 0.9554
256/300 [========================>.....] - ETA: 0s - loss: 0.1459 - acc: 0.9567
288/300 [===========================>..] - ETA: 0s - loss: 0.1501 - acc: 0.9549
300/300 [==============================] - 5s 17ms/step - loss: 0.1509 - acc: 0.9536 - val_loss: 0.2162 - val_acc: 0.9219
Epoch 12/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.1199 - acc: 0.9522
 64/300 [=====>........................] - ETA: 3s - loss: 0.1399 - acc: 0.9544
 96/300 [========>.....................] - ETA: 3s - loss: 0.1414 - acc: 0.9558
128/300 [===========>..................] - ETA: 2s - loss: 0.1486 - acc: 0.9537
160/300 [===============>..............] - ETA: 2s - loss: 0.1363 - acc: 0.9584
192/300 [==================>...........] - ETA: 1s - loss: 0.1332 - acc: 0.9604
224/300 [=====================>........] - ETA: 1s - loss: 0.1339 - acc: 0.9586
256/300 [========================>.....] - ETA: 0s - loss: 0.1363 - acc: 0.9584
288/300 [===========================>..] - ETA: 0s - loss: 0.1367 - acc: 0.9599
300/300 [==============================] - 5s 17ms/step - loss: 0.1339 - acc: 0.9611 - val_loss: 0.2033 - val_acc: 0.9344
Epoch 13/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.1274 - acc: 0.9610
 64/300 [=====>........................] - ETA: 3s - loss: 0.1458 - acc: 0.9490
 96/300 [========>.....................] - ETA: 3s - loss: 0.1446 - acc: 0.9491
128/300 [===========>..................] - ETA: 2s - loss: 0.1429 - acc: 0.9501
160/300 [===============>..............] - ETA: 2s - loss: 0.1301 - acc: 0.9549
192/300 [==================>...........] - ETA: 1s - loss: 0.1297 - acc: 0.9551
224/300 [=====================>........] - ETA: 1s - loss: 0.1279 - acc: 0.9556
256/300 [========================>.....] - ETA: 0s - loss: 0.1251 - acc: 0.9579
288/300 [===========================>..] - ETA: 0s - loss: 0.1267 - acc: 0.9570
300/300 [==============================] - 5s 17ms/step - loss: 0.1271 - acc: 0.9569 - val_loss: 0.2092 - val_acc: 0.9289
Epoch 14/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.1263 - acc: 0.9574
 64/300 [=====>........................] - ETA: 3s - loss: 0.1086 - acc: 0.9635
 96/300 [========>.....................] - ETA: 3s - loss: 0.0997 - acc: 0.9684
128/300 [===========>..................] - ETA: 2s - loss: 0.0971 - acc: 0.9685
160/300 [===============>..............] - ETA: 2s - loss: 0.1041 - acc: 0.9675
192/300 [==================>...........] - ETA: 1s - loss: 0.1052 - acc: 0.9686
224/300 [=====================>........] - ETA: 1s - loss: 0.1075 - acc: 0.9678
256/300 [========================>.....] - ETA: 0s - loss: 0.1084 - acc: 0.9680
288/300 [===========================>..] - ETA: 0s - loss: 0.1103 - acc: 0.9672
300/300 [==============================] - 5s 17ms/step - loss: 0.1106 - acc: 0.9675 - val_loss: 0.1969 - val_acc: 0.9329
Epoch 15/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.1055 - acc: 0.9697
 64/300 [=====>........................] - ETA: 3s - loss: 0.1069 - acc: 0.9659
 96/300 [========>.....................] - ETA: 3s - loss: 0.1130 - acc: 0.9669
128/300 [===========>..................] - ETA: 2s - loss: 0.1138 - acc: 0.9685
160/300 [===============>..............] - ETA: 2s - loss: 0.1057 - acc: 0.9706
192/300 [==================>...........] - ETA: 1s - loss: 0.1053 - acc: 0.9700
224/300 [=====================>........] - ETA: 1s - loss: 0.1030 - acc: 0.9716
256/300 [========================>.....] - ETA: 0s - loss: 0.0967 - acc: 0.9738
288/300 [===========================>..] - ETA: 0s - loss: 0.0995 - acc: 0.9716
300/300 [==============================] - 5s 17ms/step - loss: 0.1005 - acc: 0.9709 - val_loss: 0.2267 - val_acc: 0.9311
Epoch 16/70

 32/300 [==>...........................] - ETA: 4s - loss: 0.0919 - acc: 0.9712
 64/300 [=====>........................] - ETA: 3s - loss: 0.0965 - acc: 0.9680
 96/300 [========>.....................] - ETA: 3s - loss: 0.0938 - acc: 0.9700
128/300 [===========>..................] - ETA: 2s - loss: 0.0955 - acc: 0.9699
160/300 [===============>..............] - ETA: 2s - loss: 0.0969 - acc: 0.9704
192/300 [==================>...........] - ETA: 1s - loss: 0.0961 - acc: 0.9703
224/300 [=====================>........] - ETA: 1s - loss: 0.0953 - acc: 0.9700
256/300 [========================>.....] - ETA: 0s - loss: 0.0931 - acc: 0.9713
288/300 [===========================>..] - ETA: 0s - loss: 0.0959 - acc: 0.9705
300/300 [==============================] - 5s 17ms/step - loss: 0.1006 - acc: 0.9682 - val_loss: 0.2002 - val_acc: 0.9347
Computing...
Manual evaluation: (didn't understand why I made this)
True 7947
False 1124
True percentage 0.876088634109
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-PER       0.89      0.75      0.81       438
      B-ORG       0.65      0.52      0.58       296
     B-MISC       0.23      0.35      0.28       141
     I-MISC       0.36      0.36      0.36       154
      I-ORG       0.50      0.45      0.47       151
      B-LOC       0.83      0.55      0.66       218
      I-LOC       0.89      0.65      0.75       141
      I-PER       0.84      0.63      0.72       214

avg / total       0.92      0.88      0.90      9071

F-1 Score:
0.611858190709
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 334 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100397 unique words.
Found 94 unique chars.
Found 9 unique labels.
393 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 279
OOV word occurences: 461
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6425472     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,928,578
Trainable params: 6,928,578
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 300 samples, validate on 34 samples
Epoch 1/70

 32/300 [==>...........................] - ETA: 21s - loss: 2.0846 - acc: 0.4290
 64/300 [=====>........................] - ETA: 11s - loss: 1.5350 - acc: 0.6084
 96/300 [========>.....................] - ETA: 7s - loss: 1.5672 - acc: 0.6730 
128/300 [===========>..................] - ETA: 5s - loss: 1.4756 - acc: 0.7107
160/300 [===============>..............] - ETA: 3s - loss: 1.3417 - acc: 0.7330
192/300 [==================>...........] - ETA: 2s - loss: 1.2456 - acc: 0.7439
224/300 [=====================>........] - ETA: 1s - loss: 1.1659 - acc: 0.7548
256/300 [========================>.....] - ETA: 1s - loss: 1.1055 - acc: 0.7608
288/300 [===========================>..] - ETA: 0s - loss: 1.0446 - acc: 0.7715
300/300 [==============================] - 7s 24ms/step - loss: 1.0263 - acc: 0.7737 - val_loss: 0.6387 - val_acc: 0.7882
Epoch 2/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.5766 - acc: 0.8412
 64/300 [=====>........................] - ETA: 3s - loss: 0.5788 - acc: 0.8295
 96/300 [========>.....................] - ETA: 2s - loss: 0.5500 - acc: 0.8359
128/300 [===========>..................] - ETA: 2s - loss: 0.5695 - acc: 0.8307
160/300 [===============>..............] - ETA: 2s - loss: 0.5480 - acc: 0.8349
192/300 [==================>...........] - ETA: 1s - loss: 0.5624 - acc: 0.8309
224/300 [=====================>........] - ETA: 1s - loss: 0.5722 - acc: 0.8346
256/300 [========================>.....] - ETA: 0s - loss: 0.5581 - acc: 0.8372
288/300 [===========================>..] - ETA: 0s - loss: 0.5357 - acc: 0.8443
300/300 [==============================] - 5s 15ms/step - loss: 0.5423 - acc: 0.8423 - val_loss: 0.4750 - val_acc: 0.8676
Epoch 3/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.3876 - acc: 0.8999
 64/300 [=====>........................] - ETA: 3s - loss: 0.4445 - acc: 0.8625
 96/300 [========>.....................] - ETA: 2s - loss: 0.4338 - acc: 0.8689
128/300 [===========>..................] - ETA: 2s - loss: 0.4222 - acc: 0.8698
160/300 [===============>..............] - ETA: 1s - loss: 0.4178 - acc: 0.8694
192/300 [==================>...........] - ETA: 1s - loss: 0.4109 - acc: 0.8738
224/300 [=====================>........] - ETA: 1s - loss: 0.4052 - acc: 0.8754
256/300 [========================>.....] - ETA: 0s - loss: 0.4030 - acc: 0.8766
288/300 [===========================>..] - ETA: 0s - loss: 0.3971 - acc: 0.8786
300/300 [==============================] - 5s 15ms/step - loss: 0.3918 - acc: 0.8803 - val_loss: 0.3554 - val_acc: 0.8872
Epoch 4/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.3458 - acc: 0.8979
 64/300 [=====>........................] - ETA: 3s - loss: 0.3497 - acc: 0.9027
 96/300 [========>.....................] - ETA: 2s - loss: 0.3568 - acc: 0.8975
128/300 [===========>..................] - ETA: 2s - loss: 0.3540 - acc: 0.8965
160/300 [===============>..............] - ETA: 2s - loss: 0.3320 - acc: 0.9049
192/300 [==================>...........] - ETA: 1s - loss: 0.3270 - acc: 0.9053
224/300 [=====================>........] - ETA: 1s - loss: 0.3254 - acc: 0.9059
256/300 [========================>.....] - ETA: 0s - loss: 0.3214 - acc: 0.9063
288/300 [===========================>..] - ETA: 0s - loss: 0.3146 - acc: 0.9090
300/300 [==============================] - 5s 15ms/step - loss: 0.3126 - acc: 0.9094 - val_loss: 0.2873 - val_acc: 0.9249
Epoch 5/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.3012 - acc: 0.9191
 64/300 [=====>........................] - ETA: 3s - loss: 0.2943 - acc: 0.9152
 96/300 [========>.....................] - ETA: 2s - loss: 0.2951 - acc: 0.9107
128/300 [===========>..................] - ETA: 2s - loss: 0.2832 - acc: 0.9148
160/300 [===============>..............] - ETA: 1s - loss: 0.2713 - acc: 0.9174
192/300 [==================>...........] - ETA: 1s - loss: 0.2537 - acc: 0.9241
224/300 [=====================>........] - ETA: 1s - loss: 0.2576 - acc: 0.9221
256/300 [========================>.....] - ETA: 0s - loss: 0.2641 - acc: 0.9198
288/300 [===========================>..] - ETA: 0s - loss: 0.2588 - acc: 0.9211
300/300 [==============================] - 5s 15ms/step - loss: 0.2590 - acc: 0.9209 - val_loss: 0.2797 - val_acc: 0.9184
Epoch 6/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.2694 - acc: 0.9278
 64/300 [=====>........................] - ETA: 3s - loss: 0.2678 - acc: 0.9252
 96/300 [========>.....................] - ETA: 2s - loss: 0.2586 - acc: 0.9234
128/300 [===========>..................] - ETA: 2s - loss: 0.2441 - acc: 0.9278
160/300 [===============>..............] - ETA: 1s - loss: 0.2452 - acc: 0.9240
192/300 [==================>...........] - ETA: 1s - loss: 0.2378 - acc: 0.9275
224/300 [=====================>........] - ETA: 1s - loss: 0.2332 - acc: 0.9297
256/300 [========================>.....] - ETA: 0s - loss: 0.2273 - acc: 0.9329
288/300 [===========================>..] - ETA: 0s - loss: 0.2181 - acc: 0.9343
300/300 [==============================] - 5s 15ms/step - loss: 0.2184 - acc: 0.9341 - val_loss: 0.2528 - val_acc: 0.9247
Epoch 7/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.1732 - acc: 0.9354
 64/300 [=====>........................] - ETA: 3s - loss: 0.1863 - acc: 0.9417
 96/300 [========>.....................] - ETA: 2s - loss: 0.2000 - acc: 0.9375
128/300 [===========>..................] - ETA: 2s - loss: 0.1925 - acc: 0.9391
160/300 [===============>..............] - ETA: 1s - loss: 0.1940 - acc: 0.9370
192/300 [==================>...........] - ETA: 1s - loss: 0.1945 - acc: 0.9373
224/300 [=====================>........] - ETA: 1s - loss: 0.1976 - acc: 0.9347
256/300 [========================>.....] - ETA: 0s - loss: 0.1989 - acc: 0.9337
288/300 [===========================>..] - ETA: 0s - loss: 0.2029 - acc: 0.9330
300/300 [==============================] - 5s 15ms/step - loss: 0.2025 - acc: 0.9328 - val_loss: 0.2702 - val_acc: 0.9139
Epoch 8/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.1817 - acc: 0.9430
 64/300 [=====>........................] - ETA: 3s - loss: 0.2168 - acc: 0.9284
 96/300 [========>.....................] - ETA: 2s - loss: 0.2007 - acc: 0.9388
128/300 [===========>..................] - ETA: 2s - loss: 0.1911 - acc: 0.9403
160/300 [===============>..............] - ETA: 1s - loss: 0.2028 - acc: 0.9362
192/300 [==================>...........] - ETA: 1s - loss: 0.2029 - acc: 0.9362
224/300 [=====================>........] - ETA: 1s - loss: 0.2028 - acc: 0.9366
256/300 [========================>.....] - ETA: 0s - loss: 0.1880 - acc: 0.9420
288/300 [===========================>..] - ETA: 0s - loss: 0.1857 - acc: 0.9432
300/300 [==============================] - 5s 15ms/step - loss: 0.1854 - acc: 0.9428 - val_loss: 0.2353 - val_acc: 0.9274
Epoch 9/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.1270 - acc: 0.9683
 64/300 [=====>........................] - ETA: 3s - loss: 0.1438 - acc: 0.9602
 96/300 [========>.....................] - ETA: 2s - loss: 0.1313 - acc: 0.9633
128/300 [===========>..................] - ETA: 2s - loss: 0.1372 - acc: 0.9613
160/300 [===============>..............] - ETA: 1s - loss: 0.1458 - acc: 0.9565
192/300 [==================>...........] - ETA: 1s - loss: 0.1576 - acc: 0.9518
224/300 [=====================>........] - ETA: 1s - loss: 0.1521 - acc: 0.9535
256/300 [========================>.....] - ETA: 0s - loss: 0.1580 - acc: 0.9514
288/300 [===========================>..] - ETA: 0s - loss: 0.1595 - acc: 0.9519
300/300 [==============================] - 5s 15ms/step - loss: 0.1579 - acc: 0.9526 - val_loss: 0.2176 - val_acc: 0.9303
Epoch 10/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.1419 - acc: 0.9552
 64/300 [=====>........................] - ETA: 3s - loss: 0.1374 - acc: 0.9606
 96/300 [========>.....................] - ETA: 2s - loss: 0.1291 - acc: 0.9649
128/300 [===========>..................] - ETA: 2s - loss: 0.1313 - acc: 0.9607
160/300 [===============>..............] - ETA: 1s - loss: 0.1261 - acc: 0.9613
192/300 [==================>...........] - ETA: 1s - loss: 0.1406 - acc: 0.9556
224/300 [=====================>........] - ETA: 1s - loss: 0.1508 - acc: 0.9521
256/300 [========================>.....] - ETA: 0s - loss: 0.1517 - acc: 0.9516
288/300 [===========================>..] - ETA: 0s - loss: 0.1463 - acc: 0.9531
300/300 [==============================] - 5s 15ms/step - loss: 0.1462 - acc: 0.9536 - val_loss: 0.2191 - val_acc: 0.9303
Epoch 11/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.1170 - acc: 0.9645
 64/300 [=====>........................] - ETA: 3s - loss: 0.1168 - acc: 0.9666
 96/300 [========>.....................] - ETA: 2s - loss: 0.1228 - acc: 0.9649
128/300 [===========>..................] - ETA: 2s - loss: 0.1313 - acc: 0.9614
160/300 [===============>..............] - ETA: 1s - loss: 0.1399 - acc: 0.9574
192/300 [==================>...........] - ETA: 1s - loss: 0.1339 - acc: 0.9593
224/300 [=====================>........] - ETA: 1s - loss: 0.1331 - acc: 0.9605
256/300 [========================>.....] - ETA: 0s - loss: 0.1368 - acc: 0.9579
288/300 [===========================>..] - ETA: 0s - loss: 0.1321 - acc: 0.9594
300/300 [==============================] - 5s 15ms/step - loss: 0.1292 - acc: 0.9604 - val_loss: 0.2038 - val_acc: 0.9365
Epoch 12/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.0979 - acc: 0.9665
 64/300 [=====>........................] - ETA: 3s - loss: 0.0959 - acc: 0.9704
 96/300 [========>.....................] - ETA: 2s - loss: 0.1056 - acc: 0.9691
128/300 [===========>..................] - ETA: 2s - loss: 0.1045 - acc: 0.9680
160/300 [===============>..............] - ETA: 1s - loss: 0.1022 - acc: 0.9720
192/300 [==================>...........] - ETA: 1s - loss: 0.0989 - acc: 0.9738
224/300 [=====================>........] - ETA: 1s - loss: 0.1080 - acc: 0.9689
256/300 [========================>.....] - ETA: 0s - loss: 0.1080 - acc: 0.9688
288/300 [===========================>..] - ETA: 0s - loss: 0.1167 - acc: 0.9659
300/300 [==============================] - 4s 15ms/step - loss: 0.1201 - acc: 0.9653 - val_loss: 0.2221 - val_acc: 0.9380
Epoch 13/70

 32/300 [==>...........................] - ETA: 3s - loss: 0.1241 - acc: 0.9591
 64/300 [=====>........................] - ETA: 3s - loss: 0.1195 - acc: 0.9620
 96/300 [========>.....................] - ETA: 2s - loss: 0.1233 - acc: 0.9581
128/300 [===========>..................] - ETA: 2s - loss: 0.1142 - acc: 0.9631
160/300 [===============>..............] - ETA: 1s - loss: 0.1160 - acc: 0.9610
192/300 [==================>...........] - ETA: 1s - loss: 0.1116 - acc: 0.9629
224/300 [=====================>........] - ETA: 1s - loss: 0.1097 - acc: 0.9650
256/300 [========================>.....] - ETA: 0s - loss: 0.1062 - acc: 0.9663
288/300 [===========================>..] - ETA: 0s - loss: 0.1070 - acc: 0.9657
300/300 [==============================] - 5s 15ms/step - loss: 0.1068 - acc: 0.9655 - val_loss: 0.2411 - val_acc: 0.9231
Computing...
Manual evaluation: (didn't understand why I made this)
True 7896
False 1175
True percentage 0.870466321244
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.96      0.96      7318
      B-ORG       0.74      0.47      0.58       296
      I-ORG       0.57      0.08      0.14       151
      B-PER       0.89      0.69      0.78       438
     B-MISC       0.24      0.15      0.18       141
     I-MISC       0.30      0.43      0.35       154
      B-LOC       0.79      0.56      0.65       218
      I-LOC       0.78      0.62      0.69       141
      I-PER       0.95      0.49      0.64       214

avg / total       0.91      0.87      0.88      9071

F-1 Score:
0.572291177457
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 167 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100192 unique words.
Found 94 unique chars.
Found 9 unique labels.
188 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 299
OOV word occurences: 491
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6412352     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,915,458
Trainable params: 6,915,458
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 150 samples, validate on 17 samples
Epoch 1/70

 32/150 [=====>........................] - ETA: 9s - loss: 2.4456 - acc: 0.0058
 64/150 [===========>..................] - ETA: 4s - loss: 1.7665 - acc: 0.4247
 96/150 [==================>...........] - ETA: 2s - loss: 2.4662 - acc: 0.5270
128/150 [========================>.....] - ETA: 0s - loss: 2.0568 - acc: 0.6036
150/150 [==============================] - 5s 32ms/step - loss: 1.9147 - acc: 0.6300 - val_loss: 0.9472 - val_acc: 0.7819
Epoch 2/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.8709 - acc: 0.8177
 64/150 [===========>..................] - ETA: 1s - loss: 0.8771 - acc: 0.7971
 96/150 [==================>...........] - ETA: 0s - loss: 0.8295 - acc: 0.8024
128/150 [========================>.....] - ETA: 0s - loss: 0.7974 - acc: 0.7999
150/150 [==============================] - 2s 16ms/step - loss: 0.7951 - acc: 0.7963 - val_loss: 0.7558 - val_acc: 0.7819
Epoch 3/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.7589 - acc: 0.7735
 64/150 [===========>..................] - ETA: 1s - loss: 0.7284 - acc: 0.7739
 96/150 [==================>...........] - ETA: 0s - loss: 0.6668 - acc: 0.7907
128/150 [========================>.....] - ETA: 0s - loss: 0.6186 - acc: 0.8055
150/150 [==============================] - 2s 16ms/step - loss: 0.6178 - acc: 0.8075 - val_loss: 0.6213 - val_acc: 0.7941
Epoch 4/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.5410 - acc: 0.8438
 64/150 [===========>..................] - ETA: 1s - loss: 0.5380 - acc: 0.8324
 96/150 [==================>...........] - ETA: 0s - loss: 0.5395 - acc: 0.8285
128/150 [========================>.....] - ETA: 0s - loss: 0.5314 - acc: 0.8317
150/150 [==============================] - 2s 16ms/step - loss: 0.5167 - acc: 0.8379 - val_loss: 0.5592 - val_acc: 0.8137
Epoch 5/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.3723 - acc: 0.8846
 64/150 [===========>..................] - ETA: 1s - loss: 0.4104 - acc: 0.8743
 96/150 [==================>...........] - ETA: 0s - loss: 0.4352 - acc: 0.8672
128/150 [========================>.....] - ETA: 0s - loss: 0.4368 - acc: 0.8636
150/150 [==============================] - 2s 16ms/step - loss: 0.4426 - acc: 0.8667 - val_loss: 0.5011 - val_acc: 0.8137
Epoch 6/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.4228 - acc: 0.8610
 64/150 [===========>..................] - ETA: 1s - loss: 0.4193 - acc: 0.8649
 96/150 [==================>...........] - ETA: 0s - loss: 0.3783 - acc: 0.8775
128/150 [========================>.....] - ETA: 0s - loss: 0.3797 - acc: 0.8776
150/150 [==============================] - 2s 15ms/step - loss: 0.3757 - acc: 0.8810 - val_loss: 0.4326 - val_acc: 0.8358
Epoch 7/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.3184 - acc: 0.9029
 64/150 [===========>..................] - ETA: 1s - loss: 0.3412 - acc: 0.8928
 96/150 [==================>...........] - ETA: 0s - loss: 0.3442 - acc: 0.8878
128/150 [========================>.....] - ETA: 0s - loss: 0.3364 - acc: 0.8922
150/150 [==============================] - 2s 15ms/step - loss: 0.3175 - acc: 0.8977 - val_loss: 0.3914 - val_acc: 0.8627
Epoch 8/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2833 - acc: 0.9101
 64/150 [===========>..................] - ETA: 1s - loss: 0.2650 - acc: 0.9151
 96/150 [==================>...........] - ETA: 0s - loss: 0.2501 - acc: 0.9184
128/150 [========================>.....] - ETA: 0s - loss: 0.2629 - acc: 0.9126
150/150 [==============================] - 2s 15ms/step - loss: 0.2792 - acc: 0.9069 - val_loss: 0.3623 - val_acc: 0.8676
Epoch 9/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2413 - acc: 0.9210
 64/150 [===========>..................] - ETA: 1s - loss: 0.2795 - acc: 0.9050
 96/150 [==================>...........] - ETA: 0s - loss: 0.2566 - acc: 0.9167
128/150 [========================>.....] - ETA: 0s - loss: 0.2554 - acc: 0.9160
150/150 [==============================] - 2s 15ms/step - loss: 0.2588 - acc: 0.9154 - val_loss: 0.3234 - val_acc: 0.8922
Epoch 10/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2220 - acc: 0.9368
 64/150 [===========>..................] - ETA: 1s - loss: 0.2260 - acc: 0.9331
 96/150 [==================>...........] - ETA: 0s - loss: 0.2716 - acc: 0.9129
128/150 [========================>.....] - ETA: 0s - loss: 0.2579 - acc: 0.9193
150/150 [==============================] - 2s 15ms/step - loss: 0.2553 - acc: 0.9181 - val_loss: 0.3063 - val_acc: 0.8897
Epoch 11/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1970 - acc: 0.9444
 64/150 [===========>..................] - ETA: 1s - loss: 0.2140 - acc: 0.9331
 96/150 [==================>...........] - ETA: 0s - loss: 0.2131 - acc: 0.9340
128/150 [========================>.....] - ETA: 0s - loss: 0.2124 - acc: 0.9355
150/150 [==============================] - 2s 15ms/step - loss: 0.2079 - acc: 0.9370 - val_loss: 0.2773 - val_acc: 0.8995
Epoch 12/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1684 - acc: 0.9510
 64/150 [===========>..................] - ETA: 1s - loss: 0.1772 - acc: 0.9464
 96/150 [==================>...........] - ETA: 0s - loss: 0.1801 - acc: 0.9420
128/150 [========================>.....] - ETA: 0s - loss: 0.1833 - acc: 0.9424
150/150 [==============================] - 2s 15ms/step - loss: 0.1831 - acc: 0.9418 - val_loss: 0.2674 - val_acc: 0.9118
Epoch 13/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2066 - acc: 0.9349
 64/150 [===========>..................] - ETA: 1s - loss: 0.1702 - acc: 0.9509
 96/150 [==================>...........] - ETA: 0s - loss: 0.1617 - acc: 0.9526
128/150 [========================>.....] - ETA: 0s - loss: 0.1676 - acc: 0.9520
150/150 [==============================] - 2s 15ms/step - loss: 0.1684 - acc: 0.9520 - val_loss: 0.2842 - val_acc: 0.8946
Epoch 14/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1760 - acc: 0.9291
 64/150 [===========>..................] - ETA: 1s - loss: 0.1704 - acc: 0.9355
 96/150 [==================>...........] - ETA: 0s - loss: 0.1640 - acc: 0.9446
128/150 [========================>.....] - ETA: 0s - loss: 0.1586 - acc: 0.9460
150/150 [==============================] - 2s 15ms/step - loss: 0.1564 - acc: 0.9475 - val_loss: 0.2439 - val_acc: 0.9216
Epoch 15/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1799 - acc: 0.9469
 64/150 [===========>..................] - ETA: 1s - loss: 0.1582 - acc: 0.9550
 96/150 [==================>...........] - ETA: 0s - loss: 0.1461 - acc: 0.9603
128/150 [========================>.....] - ETA: 0s - loss: 0.1463 - acc: 0.9579
150/150 [==============================] - 2s 15ms/step - loss: 0.1435 - acc: 0.9595 - val_loss: 0.2413 - val_acc: 0.9142
Epoch 16/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1281 - acc: 0.9664
 64/150 [===========>..................] - ETA: 1s - loss: 0.1389 - acc: 0.9595
 96/150 [==================>...........] - ETA: 0s - loss: 0.1379 - acc: 0.9614
128/150 [========================>.....] - ETA: 0s - loss: 0.1418 - acc: 0.9599
150/150 [==============================] - 2s 15ms/step - loss: 0.1345 - acc: 0.9624 - val_loss: 0.2315 - val_acc: 0.9216
Epoch 17/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1051 - acc: 0.9728
 64/150 [===========>..................] - ETA: 1s - loss: 0.1079 - acc: 0.9733
 96/150 [==================>...........] - ETA: 0s - loss: 0.1268 - acc: 0.9626
128/150 [========================>.....] - ETA: 0s - loss: 0.1326 - acc: 0.9595
150/150 [==============================] - 2s 15ms/step - loss: 0.1274 - acc: 0.9605 - val_loss: 0.2373 - val_acc: 0.9216
Epoch 18/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1052 - acc: 0.9688
 64/150 [===========>..................] - ETA: 1s - loss: 0.0890 - acc: 0.9774
 96/150 [==================>...........] - ETA: 0s - loss: 0.0913 - acc: 0.9798
128/150 [========================>.....] - ETA: 0s - loss: 0.1027 - acc: 0.9734
150/150 [==============================] - 2s 15ms/step - loss: 0.1081 - acc: 0.9712 - val_loss: 0.2326 - val_acc: 0.9240
Computing...
Manual evaluation: (didn't understand why I made this)
True 7837
False 1234
True percentage 0.863962076949
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-PER       0.83      0.63      0.71       438
      B-LOC       0.66      0.63      0.65       218
      B-ORG       0.71      0.61      0.65       296
      I-ORG       0.39      0.32      0.35       151
      I-PER       0.87      0.45      0.60       214
      I-LOC       0.58      0.66      0.62       141
     B-MISC       0.35      0.16      0.22       141
     I-MISC       0.29      0.24      0.26       154

avg / total       0.90      0.86      0.88      9071

F-1 Score:
0.567877629063
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 167 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100224 unique words.
Found 94 unique chars.
Found 9 unique labels.
220 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 299
OOV word occurences: 471
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6414400     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,917,506
Trainable params: 6,917,506
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 150 samples, validate on 17 samples
Epoch 1/70

 32/150 [=====>........................] - ETA: 10s - loss: 2.2203 - acc: 0.0194
 64/150 [===========>..................] - ETA: 4s - loss: 1.6293 - acc: 0.4093 
 96/150 [==================>...........] - ETA: 2s - loss: 2.0060 - acc: 0.5367
128/150 [========================>.....] - ETA: 0s - loss: 1.7388 - acc: 0.6094
150/150 [==============================] - 5s 33ms/step - loss: 1.6099 - acc: 0.6362 - val_loss: 0.7969 - val_acc: 0.7933
Epoch 2/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.7656 - acc: 0.8070
 64/150 [===========>..................] - ETA: 1s - loss: 0.7534 - acc: 0.8052
 96/150 [==================>...........] - ETA: 0s - loss: 0.7299 - acc: 0.8072
128/150 [========================>.....] - ETA: 0s - loss: 0.7565 - acc: 0.7956
150/150 [==============================] - 2s 16ms/step - loss: 0.7371 - acc: 0.7996 - val_loss: 0.6707 - val_acc: 0.7957
Epoch 3/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.6219 - acc: 0.8187
 64/150 [===========>..................] - ETA: 1s - loss: 0.5982 - acc: 0.8182
 96/150 [==================>...........] - ETA: 0s - loss: 0.6392 - acc: 0.8028
128/150 [========================>.....] - ETA: 0s - loss: 0.6289 - acc: 0.8119
150/150 [==============================] - 2s 16ms/step - loss: 0.6181 - acc: 0.8135 - val_loss: 0.5665 - val_acc: 0.8290
Epoch 4/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.5738 - acc: 0.8165
 64/150 [===========>..................] - ETA: 1s - loss: 0.5236 - acc: 0.8270
 96/150 [==================>...........] - ETA: 0s - loss: 0.5126 - acc: 0.8354
128/150 [========================>.....] - ETA: 0s - loss: 0.4913 - acc: 0.8399
150/150 [==============================] - 2s 16ms/step - loss: 0.4820 - acc: 0.8441 - val_loss: 0.4971 - val_acc: 0.8242
Epoch 5/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.4533 - acc: 0.8501
 64/150 [===========>..................] - ETA: 1s - loss: 0.4697 - acc: 0.8644
 96/150 [==================>...........] - ETA: 0s - loss: 0.4516 - acc: 0.8603
128/150 [========================>.....] - ETA: 0s - loss: 0.4439 - acc: 0.8641
150/150 [==============================] - 2s 16ms/step - loss: 0.4366 - acc: 0.8662 - val_loss: 0.4521 - val_acc: 0.8599
Epoch 6/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.3156 - acc: 0.9183
 64/150 [===========>..................] - ETA: 1s - loss: 0.3115 - acc: 0.9181
 96/150 [==================>...........] - ETA: 0s - loss: 0.3248 - acc: 0.9056
128/150 [========================>.....] - ETA: 0s - loss: 0.3343 - acc: 0.9036
150/150 [==============================] - 2s 15ms/step - loss: 0.3426 - acc: 0.8994 - val_loss: 0.4034 - val_acc: 0.8765
Epoch 7/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2903 - acc: 0.9336
 64/150 [===========>..................] - ETA: 1s - loss: 0.2891 - acc: 0.9194
 96/150 [==================>...........] - ETA: 0s - loss: 0.2953 - acc: 0.9182
128/150 [========================>.....] - ETA: 0s - loss: 0.2971 - acc: 0.9157
150/150 [==============================] - 2s 15ms/step - loss: 0.2965 - acc: 0.9133 - val_loss: 0.4358 - val_acc: 0.8646
Epoch 8/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2886 - acc: 0.9198
 64/150 [===========>..................] - ETA: 1s - loss: 0.3075 - acc: 0.9027
 96/150 [==================>...........] - ETA: 0s - loss: 0.3216 - acc: 0.9016
128/150 [========================>.....] - ETA: 0s - loss: 0.2860 - acc: 0.9170
150/150 [==============================] - 2s 15ms/step - loss: 0.2768 - acc: 0.9197 - val_loss: 0.3512 - val_acc: 0.8812
Epoch 9/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2500 - acc: 0.9278
 64/150 [===========>..................] - ETA: 1s - loss: 0.2354 - acc: 0.9317
 96/150 [==================>...........] - ETA: 0s - loss: 0.2234 - acc: 0.9357
128/150 [========================>.....] - ETA: 0s - loss: 0.2355 - acc: 0.9307
150/150 [==============================] - 2s 15ms/step - loss: 0.2329 - acc: 0.9325 - val_loss: 0.3297 - val_acc: 0.8955
Epoch 10/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2171 - acc: 0.9223
 64/150 [===========>..................] - ETA: 1s - loss: 0.1936 - acc: 0.9384
 96/150 [==================>...........] - ETA: 0s - loss: 0.1901 - acc: 0.9435
128/150 [========================>.....] - ETA: 0s - loss: 0.1979 - acc: 0.9406
150/150 [==============================] - 2s 15ms/step - loss: 0.2039 - acc: 0.9394 - val_loss: 0.3673 - val_acc: 0.8646
Epoch 11/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1958 - acc: 0.9338
 64/150 [===========>..................] - ETA: 1s - loss: 0.1999 - acc: 0.9385
 96/150 [==================>...........] - ETA: 0s - loss: 0.2042 - acc: 0.9381
128/150 [========================>.....] - ETA: 0s - loss: 0.2098 - acc: 0.9369
150/150 [==============================] - 2s 15ms/step - loss: 0.1996 - acc: 0.9411 - val_loss: 0.3169 - val_acc: 0.8907
Epoch 12/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1680 - acc: 0.9496
 64/150 [===========>..................] - ETA: 1s - loss: 0.1599 - acc: 0.9546
 96/150 [==================>...........] - ETA: 0s - loss: 0.1694 - acc: 0.9500
128/150 [========================>.....] - ETA: 0s - loss: 0.1765 - acc: 0.9460
150/150 [==============================] - 2s 15ms/step - loss: 0.1706 - acc: 0.9490 - val_loss: 0.3273 - val_acc: 0.8836
Epoch 13/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1951 - acc: 0.9498
 64/150 [===========>..................] - ETA: 1s - loss: 0.1755 - acc: 0.9515
 96/150 [==================>...........] - ETA: 0s - loss: 0.1687 - acc: 0.9527
128/150 [========================>.....] - ETA: 0s - loss: 0.1650 - acc: 0.9535
150/150 [==============================] - 2s 15ms/step - loss: 0.1644 - acc: 0.9553 - val_loss: 0.3058 - val_acc: 0.8884
Epoch 14/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1638 - acc: 0.9524
 64/150 [===========>..................] - ETA: 1s - loss: 0.1538 - acc: 0.9516
 96/150 [==================>...........] - ETA: 0s - loss: 0.1640 - acc: 0.9501
128/150 [========================>.....] - ETA: 0s - loss: 0.1564 - acc: 0.9533
150/150 [==============================] - 2s 15ms/step - loss: 0.1536 - acc: 0.9539 - val_loss: 0.3260 - val_acc: 0.8789
Epoch 15/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1930 - acc: 0.9402
 64/150 [===========>..................] - ETA: 1s - loss: 0.1569 - acc: 0.9496
 96/150 [==================>...........] - ETA: 0s - loss: 0.1337 - acc: 0.9590
128/150 [========================>.....] - ETA: 0s - loss: 0.1292 - acc: 0.9613
150/150 [==============================] - 2s 15ms/step - loss: 0.1277 - acc: 0.9623 - val_loss: 0.2845 - val_acc: 0.9050
Epoch 16/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.0973 - acc: 0.9731
 64/150 [===========>..................] - ETA: 1s - loss: 0.1336 - acc: 0.9571
 96/150 [==================>...........] - ETA: 0s - loss: 0.1396 - acc: 0.9551
128/150 [========================>.....] - ETA: 0s - loss: 0.1509 - acc: 0.9501
150/150 [==============================] - 2s 15ms/step - loss: 0.1412 - acc: 0.9544 - val_loss: 0.2979 - val_acc: 0.8955
Epoch 17/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1374 - acc: 0.9556
 64/150 [===========>..................] - ETA: 1s - loss: 0.1103 - acc: 0.9692
 96/150 [==================>...........] - ETA: 0s - loss: 0.1105 - acc: 0.9686
128/150 [========================>.....] - ETA: 0s - loss: 0.1098 - acc: 0.9663
150/150 [==============================] - 2s 15ms/step - loss: 0.1106 - acc: 0.9665 - val_loss: 0.2903 - val_acc: 0.8955
Computing...
Manual evaluation: (didn't understand why I made this)
True 7800
False 1271
True percentage 0.859883144086
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.94      0.96      7318
      B-ORG       0.55      0.57      0.56       296
      B-LOC       0.67      0.68      0.67       218
      I-ORG       0.29      0.31      0.30       151
     B-MISC       0.19      0.02      0.04       141
     I-MISC       0.38      0.17      0.23       154
      B-PER       0.76      0.67      0.72       438
      I-PER       0.72      0.52      0.60       214
      I-LOC       0.60      0.74      0.66       141

avg / total       0.89      0.86      0.87      9071

F-1 Score:
0.557710064635
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 167 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100192 unique words.
Found 94 unique chars.
Found 9 unique labels.
188 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 299
OOV word occurences: 491
Padding...
Data padded!
Padding...
Data padded!
Padded until 66 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 66 tokens.
Padded until 24 chars.
Padded until 66 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 66, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 66)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 66, 64)       6412352     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 66, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 66, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 66, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 66, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 66, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,915,458
Trainable params: 6,915,458
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 150 samples, validate on 17 samples
Epoch 1/70

 32/150 [=====>........................] - ETA: 9s - loss: 2.1710 - acc: 0.1114
 64/150 [===========>..................] - ETA: 4s - loss: 1.4704 - acc: 0.4755
 96/150 [==================>...........] - ETA: 2s - loss: 1.3775 - acc: 0.5811
128/150 [========================>.....] - ETA: 0s - loss: 1.2992 - acc: 0.6425
150/150 [==============================] - 5s 34ms/step - loss: 1.2220 - acc: 0.6706 - val_loss: 0.6826 - val_acc: 0.8356
Epoch 2/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.6117 - acc: 0.8347
 64/150 [===========>..................] - ETA: 1s - loss: 0.6461 - acc: 0.8240
 96/150 [==================>...........] - ETA: 0s - loss: 0.6569 - acc: 0.8183
128/150 [========================>.....] - ETA: 0s - loss: 0.6349 - acc: 0.8248
150/150 [==============================] - 3s 18ms/step - loss: 0.6306 - acc: 0.8239 - val_loss: 0.5682 - val_acc: 0.8356
Epoch 3/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.4414 - acc: 0.8635
 64/150 [===========>..................] - ETA: 1s - loss: 0.5488 - acc: 0.8260
 96/150 [==================>...........] - ETA: 0s - loss: 0.5180 - acc: 0.8389
128/150 [========================>.....] - ETA: 0s - loss: 0.5264 - acc: 0.8355
150/150 [==============================] - 3s 18ms/step - loss: 0.5142 - acc: 0.8424 - val_loss: 0.4738 - val_acc: 0.8491
Epoch 4/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.4346 - acc: 0.8569
 64/150 [===========>..................] - ETA: 1s - loss: 0.4234 - acc: 0.8602
 96/150 [==================>...........] - ETA: 0s - loss: 0.4190 - acc: 0.8659
128/150 [========================>.....] - ETA: 0s - loss: 0.4159 - acc: 0.8629
150/150 [==============================] - 3s 18ms/step - loss: 0.4195 - acc: 0.8643 - val_loss: 0.4069 - val_acc: 0.8760
Epoch 5/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.3471 - acc: 0.8904
 64/150 [===========>..................] - ETA: 1s - loss: 0.3471 - acc: 0.8856
 96/150 [==================>...........] - ETA: 0s - loss: 0.3481 - acc: 0.8927
128/150 [========================>.....] - ETA: 0s - loss: 0.3606 - acc: 0.8899
150/150 [==============================] - 3s 18ms/step - loss: 0.3541 - acc: 0.8916 - val_loss: 0.3651 - val_acc: 0.8922
Epoch 6/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.3586 - acc: 0.8801
 64/150 [===========>..................] - ETA: 1s - loss: 0.3102 - acc: 0.9045
 96/150 [==================>...........] - ETA: 0s - loss: 0.3263 - acc: 0.8890
128/150 [========================>.....] - ETA: 0s - loss: 0.3308 - acc: 0.8965
150/150 [==============================] - 3s 17ms/step - loss: 0.3263 - acc: 0.8967 - val_loss: 0.3422 - val_acc: 0.8976
Epoch 7/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2678 - acc: 0.9299
 64/150 [===========>..................] - ETA: 1s - loss: 0.2737 - acc: 0.9209
 96/150 [==================>...........] - ETA: 0s - loss: 0.2495 - acc: 0.9276
128/150 [========================>.....] - ETA: 0s - loss: 0.2619 - acc: 0.9195
150/150 [==============================] - 3s 17ms/step - loss: 0.2715 - acc: 0.9163 - val_loss: 0.3106 - val_acc: 0.9057
Epoch 8/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2780 - acc: 0.9163
 64/150 [===========>..................] - ETA: 1s - loss: 0.2626 - acc: 0.9210
 96/150 [==================>...........] - ETA: 0s - loss: 0.2371 - acc: 0.9283
128/150 [========================>.....] - ETA: 0s - loss: 0.2350 - acc: 0.9281
150/150 [==============================] - 3s 17ms/step - loss: 0.2314 - acc: 0.9301 - val_loss: 0.2972 - val_acc: 0.9218
Epoch 9/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2034 - acc: 0.9319
 64/150 [===========>..................] - ETA: 1s - loss: 0.2024 - acc: 0.9379
 96/150 [==================>...........] - ETA: 0s - loss: 0.2306 - acc: 0.9253
128/150 [========================>.....] - ETA: 0s - loss: 0.2361 - acc: 0.9276
150/150 [==============================] - 3s 17ms/step - loss: 0.2360 - acc: 0.9277 - val_loss: 0.3041 - val_acc: 0.9084
Epoch 10/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1592 - acc: 0.9571
 64/150 [===========>..................] - ETA: 1s - loss: 0.1832 - acc: 0.9446
 96/150 [==================>...........] - ETA: 0s - loss: 0.1819 - acc: 0.9440
128/150 [========================>.....] - ETA: 0s - loss: 0.1828 - acc: 0.9450
150/150 [==============================] - 3s 17ms/step - loss: 0.1924 - acc: 0.9409 - val_loss: 0.2959 - val_acc: 0.9084
Epoch 11/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1576 - acc: 0.9534
 64/150 [===========>..................] - ETA: 1s - loss: 0.1604 - acc: 0.9510
 96/150 [==================>...........] - ETA: 0s - loss: 0.1596 - acc: 0.9537
128/150 [========================>.....] - ETA: 0s - loss: 0.1805 - acc: 0.9470
150/150 [==============================] - 3s 17ms/step - loss: 0.1825 - acc: 0.9457 - val_loss: 0.2814 - val_acc: 0.9218
Epoch 12/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1562 - acc: 0.9420
 64/150 [===========>..................] - ETA: 1s - loss: 0.1469 - acc: 0.9498
 96/150 [==================>...........] - ETA: 0s - loss: 0.1567 - acc: 0.9509
128/150 [========================>.....] - ETA: 0s - loss: 0.1615 - acc: 0.9490
150/150 [==============================] - 3s 18ms/step - loss: 0.1675 - acc: 0.9484 - val_loss: 0.2884 - val_acc: 0.9218
Epoch 13/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1348 - acc: 0.9560
 64/150 [===========>..................] - ETA: 1s - loss: 0.1469 - acc: 0.9530
 96/150 [==================>...........] - ETA: 0s - loss: 0.1410 - acc: 0.9574
128/150 [========================>.....] - ETA: 0s - loss: 0.1428 - acc: 0.9549
150/150 [==============================] - 3s 17ms/step - loss: 0.1494 - acc: 0.9540 - val_loss: 0.2847 - val_acc: 0.9272
Computing...
Manual evaluation: (didn't understand why I made this)
True 7786
False 1285
True percentage 0.858339764083
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.95      0.95      7318
      B-PER       0.80      0.67      0.73       438
      B-ORG       0.65      0.36      0.46       296
      I-ORG       0.32      0.24      0.27       151
      I-PER       0.79      0.54      0.64       214
      B-LOC       0.62      0.71      0.66       218
      I-LOC       0.63      0.72      0.67       141
     B-MISC       0.27      0.02      0.04       141
     I-MISC       0.17      0.02      0.03       154

avg / total       0.88      0.86      0.86      9071

F-1 Score:
0.545271629779
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 167 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100192 unique words.
Found 94 unique chars.
Found 9 unique labels.
188 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 296
OOV word occurences: 446
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6412352     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,915,458
Trainable params: 6,915,458
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 150 samples, validate on 17 samples
Epoch 1/70

 32/150 [=====>........................] - ETA: 9s - loss: 2.5474 - acc: 0.0204
 64/150 [===========>..................] - ETA: 4s - loss: 1.7435 - acc: 0.4072
 96/150 [==================>...........] - ETA: 2s - loss: 1.5011 - acc: 0.5428
128/150 [========================>.....] - ETA: 0s - loss: 1.5499 - acc: 0.5782
150/150 [==============================] - 5s 32ms/step - loss: 1.4290 - acc: 0.6174 - val_loss: 0.8815 - val_acc: 0.7865
Epoch 2/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.9239 - acc: 0.7778
 64/150 [===========>..................] - ETA: 1s - loss: 0.8486 - acc: 0.7954
 96/150 [==================>...........] - ETA: 0s - loss: 0.7694 - acc: 0.8091
128/150 [========================>.....] - ETA: 0s - loss: 0.7228 - acc: 0.8171
150/150 [==============================] - 2s 16ms/step - loss: 0.7041 - acc: 0.8173 - val_loss: 0.6672 - val_acc: 0.7921
Epoch 3/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.6326 - acc: 0.8207
 64/150 [===========>..................] - ETA: 1s - loss: 0.6002 - acc: 0.8246
 96/150 [==================>...........] - ETA: 0s - loss: 0.5784 - acc: 0.8259
128/150 [========================>.....] - ETA: 0s - loss: 0.5698 - acc: 0.8285
150/150 [==============================] - 2s 16ms/step - loss: 0.5732 - acc: 0.8232 - val_loss: 0.5428 - val_acc: 0.8371
Epoch 4/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.5203 - acc: 0.8424
 64/150 [===========>..................] - ETA: 1s - loss: 0.4936 - acc: 0.8389
 96/150 [==================>...........] - ETA: 0s - loss: 0.4712 - acc: 0.8491
128/150 [========================>.....] - ETA: 0s - loss: 0.4576 - acc: 0.8523
150/150 [==============================] - 2s 16ms/step - loss: 0.4656 - acc: 0.8523 - val_loss: 0.5541 - val_acc: 0.8174
Epoch 5/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.4615 - acc: 0.8424
 64/150 [===========>..................] - ETA: 1s - loss: 0.4956 - acc: 0.8517
 96/150 [==================>...........] - ETA: 0s - loss: 0.4568 - acc: 0.8641
128/150 [========================>.....] - ETA: 0s - loss: 0.4431 - acc: 0.8674
150/150 [==============================] - 2s 16ms/step - loss: 0.4200 - acc: 0.8724 - val_loss: 0.4098 - val_acc: 0.8848
Epoch 6/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.3216 - acc: 0.8964
 64/150 [===========>..................] - ETA: 1s - loss: 0.3762 - acc: 0.8772
 96/150 [==================>...........] - ETA: 0s - loss: 0.3965 - acc: 0.8730
128/150 [========================>.....] - ETA: 0s - loss: 0.3692 - acc: 0.8809
150/150 [==============================] - 2s 15ms/step - loss: 0.3608 - acc: 0.8845 - val_loss: 0.3675 - val_acc: 0.8820
Epoch 7/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.3671 - acc: 0.8947
 64/150 [===========>..................] - ETA: 1s - loss: 0.3273 - acc: 0.9073
 96/150 [==================>...........] - ETA: 0s - loss: 0.3246 - acc: 0.9064
128/150 [========================>.....] - ETA: 0s - loss: 0.3179 - acc: 0.9094
150/150 [==============================] - 2s 15ms/step - loss: 0.3134 - acc: 0.9062 - val_loss: 0.3481 - val_acc: 0.9101
Epoch 8/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2741 - acc: 0.9187
 64/150 [===========>..................] - ETA: 1s - loss: 0.2311 - acc: 0.9327
 96/150 [==================>...........] - ETA: 0s - loss: 0.2432 - acc: 0.9273
128/150 [========================>.....] - ETA: 0s - loss: 0.2580 - acc: 0.9208
150/150 [==============================] - 2s 16ms/step - loss: 0.2622 - acc: 0.9188 - val_loss: 0.3537 - val_acc: 0.8961
Epoch 9/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2485 - acc: 0.9215
 64/150 [===========>..................] - ETA: 1s - loss: 0.2834 - acc: 0.9112
 96/150 [==================>...........] - ETA: 0s - loss: 0.2543 - acc: 0.9274
128/150 [========================>.....] - ETA: 0s - loss: 0.2430 - acc: 0.9294
150/150 [==============================] - 2s 16ms/step - loss: 0.2418 - acc: 0.9294 - val_loss: 0.2971 - val_acc: 0.9157
Epoch 10/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2019 - acc: 0.9425
 64/150 [===========>..................] - ETA: 1s - loss: 0.2170 - acc: 0.9401
 96/150 [==================>...........] - ETA: 0s - loss: 0.2470 - acc: 0.9233
128/150 [========================>.....] - ETA: 0s - loss: 0.2540 - acc: 0.9225
150/150 [==============================] - 2s 15ms/step - loss: 0.2454 - acc: 0.9254 - val_loss: 0.3298 - val_acc: 0.8989
Epoch 11/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2339 - acc: 0.9206
 64/150 [===========>..................] - ETA: 1s - loss: 0.2439 - acc: 0.9215
 96/150 [==================>...........] - ETA: 0s - loss: 0.2212 - acc: 0.9345
128/150 [========================>.....] - ETA: 0s - loss: 0.2105 - acc: 0.9374
150/150 [==============================] - 2s 15ms/step - loss: 0.1962 - acc: 0.9431 - val_loss: 0.2981 - val_acc: 0.9129
Computing...
Manual evaluation: (didn't understand why I made this)
True 7741
False 1330
True percentage 0.853378899791
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.95      0.95      7318
     B-MISC       0.25      0.01      0.01       141
     I-MISC       0.39      0.07      0.12       154
      B-ORG       0.55      0.49      0.52       296
      I-ORG       0.37      0.27      0.31       151
      B-PER       0.80      0.52      0.63       438
      I-PER       0.70      0.41      0.52       214
      B-LOC       0.61      0.63      0.62       218
      I-LOC       0.61      0.76      0.68       141

avg / total       0.87      0.85      0.86      9071

F-1 Score:
0.510939077752
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 167 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100194 unique words.
Found 94 unique chars.
Found 9 unique labels.
190 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 303
OOV word occurences: 485
Padding...
Data padded!
Padding...
Data padded!
Padded until 63 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 63 tokens.
Padded until 24 chars.
Padded until 63 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 63, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 63)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 63, 64)       6412480     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 63, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 63, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 63, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 63, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 63, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,915,586
Trainable params: 6,915,586
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 150 samples, validate on 17 samples
Epoch 1/70

 32/150 [=====>........................] - ETA: 9s - loss: 2.2336 - acc: 0.0541
 64/150 [===========>..................] - ETA: 4s - loss: 1.5932 - acc: 0.4214
 96/150 [==================>...........] - ETA: 2s - loss: 1.3378 - acc: 0.5485
128/150 [========================>.....] - ETA: 0s - loss: 1.1976 - acc: 0.6132
150/150 [==============================] - 5s 34ms/step - loss: 1.2271 - acc: 0.6411 - val_loss: 1.2762 - val_acc: 0.7582
Epoch 2/70

 32/150 [=====>........................] - ETA: 1s - loss: 1.1887 - acc: 0.8258
 64/150 [===========>..................] - ETA: 1s - loss: 0.9541 - acc: 0.8129
 96/150 [==================>...........] - ETA: 0s - loss: 0.8489 - acc: 0.8120
128/150 [========================>.....] - ETA: 0s - loss: 0.8042 - acc: 0.8048
150/150 [==============================] - 3s 17ms/step - loss: 0.7960 - acc: 0.7989 - val_loss: 0.6725 - val_acc: 0.8030
Epoch 3/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.6977 - acc: 0.7826
 64/150 [===========>..................] - ETA: 1s - loss: 0.6404 - acc: 0.7970
 96/150 [==================>...........] - ETA: 0s - loss: 0.6040 - acc: 0.8065
128/150 [========================>.....] - ETA: 0s - loss: 0.5860 - acc: 0.8114
150/150 [==============================] - 3s 17ms/step - loss: 0.5698 - acc: 0.8151 - val_loss: 0.5379 - val_acc: 0.8239
Epoch 4/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.5402 - acc: 0.8166
 64/150 [===========>..................] - ETA: 1s - loss: 0.4664 - acc: 0.8459
 96/150 [==================>...........] - ETA: 0s - loss: 0.5062 - acc: 0.8331
128/150 [========================>.....] - ETA: 0s - loss: 0.4880 - acc: 0.8405
150/150 [==============================] - 3s 17ms/step - loss: 0.4885 - acc: 0.8385 - val_loss: 0.5492 - val_acc: 0.8507
Epoch 5/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.4210 - acc: 0.9052
 64/150 [===========>..................] - ETA: 1s - loss: 0.4120 - acc: 0.8838
 96/150 [==================>...........] - ETA: 0s - loss: 0.4190 - acc: 0.8796
128/150 [========================>.....] - ETA: 0s - loss: 0.4159 - acc: 0.8773
150/150 [==============================] - 3s 17ms/step - loss: 0.4150 - acc: 0.8746 - val_loss: 0.4351 - val_acc: 0.8806
Epoch 6/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2552 - acc: 0.9441
 64/150 [===========>..................] - ETA: 1s - loss: 0.3046 - acc: 0.9208
 96/150 [==================>...........] - ETA: 0s - loss: 0.3489 - acc: 0.9030
128/150 [========================>.....] - ETA: 0s - loss: 0.3278 - acc: 0.9061
150/150 [==============================] - 2s 17ms/step - loss: 0.3318 - acc: 0.9038 - val_loss: 0.4374 - val_acc: 0.8418
Epoch 7/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2717 - acc: 0.9239
 64/150 [===========>..................] - ETA: 1s - loss: 0.3263 - acc: 0.8945
 96/150 [==================>...........] - ETA: 0s - loss: 0.3802 - acc: 0.8683
128/150 [========================>.....] - ETA: 0s - loss: 0.3760 - acc: 0.8719
150/150 [==============================] - 2s 17ms/step - loss: 0.3613 - acc: 0.8776 - val_loss: 0.3822 - val_acc: 0.8896
Epoch 8/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.3173 - acc: 0.9165
 64/150 [===========>..................] - ETA: 1s - loss: 0.2849 - acc: 0.9273
 96/150 [==================>...........] - ETA: 0s - loss: 0.2962 - acc: 0.9213
128/150 [========================>.....] - ETA: 0s - loss: 0.2745 - acc: 0.9286
150/150 [==============================] - 2s 17ms/step - loss: 0.2793 - acc: 0.9234 - val_loss: 0.3843 - val_acc: 0.8806
Epoch 9/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2677 - acc: 0.9232
 64/150 [===========>..................] - ETA: 1s - loss: 0.2667 - acc: 0.9167
 96/150 [==================>...........] - ETA: 0s - loss: 0.2638 - acc: 0.9217
128/150 [========================>.....] - ETA: 0s - loss: 0.2389 - acc: 0.9279
150/150 [==============================] - 2s 17ms/step - loss: 0.2397 - acc: 0.9302 - val_loss: 0.3471 - val_acc: 0.8925
Epoch 10/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1837 - acc: 0.9513
 64/150 [===========>..................] - ETA: 1s - loss: 0.2321 - acc: 0.9269
 96/150 [==================>...........] - ETA: 0s - loss: 0.2337 - acc: 0.9292
128/150 [========================>.....] - ETA: 0s - loss: 0.2210 - acc: 0.9334
150/150 [==============================] - 3s 17ms/step - loss: 0.2263 - acc: 0.9310 - val_loss: 0.3502 - val_acc: 0.9015
Epoch 11/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1821 - acc: 0.9352
 64/150 [===========>..................] - ETA: 1s - loss: 0.1911 - acc: 0.9423
 96/150 [==================>...........] - ETA: 0s - loss: 0.1917 - acc: 0.9423
128/150 [========================>.....] - ETA: 0s - loss: 0.1905 - acc: 0.9436
150/150 [==============================] - 2s 17ms/step - loss: 0.1950 - acc: 0.9423 - val_loss: 0.3297 - val_acc: 0.9015
Epoch 12/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1951 - acc: 0.9514
 64/150 [===========>..................] - ETA: 1s - loss: 0.1947 - acc: 0.9468
 96/150 [==================>...........] - ETA: 0s - loss: 0.1890 - acc: 0.9494
128/150 [========================>.....] - ETA: 0s - loss: 0.1772 - acc: 0.9542
150/150 [==============================] - 2s 17ms/step - loss: 0.1836 - acc: 0.9513 - val_loss: 0.3433 - val_acc: 0.8925
Epoch 13/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1758 - acc: 0.9405
 64/150 [===========>..................] - ETA: 1s - loss: 0.1817 - acc: 0.9492
 96/150 [==================>...........] - ETA: 0s - loss: 0.1753 - acc: 0.9492
128/150 [========================>.....] - ETA: 0s - loss: 0.1675 - acc: 0.9534
150/150 [==============================] - 2s 17ms/step - loss: 0.1556 - acc: 0.9571 - val_loss: 0.3151 - val_acc: 0.8985
Epoch 14/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1510 - acc: 0.9547
 64/150 [===========>..................] - ETA: 1s - loss: 0.1628 - acc: 0.9560
 96/150 [==================>...........] - ETA: 0s - loss: 0.1578 - acc: 0.9561
128/150 [========================>.....] - ETA: 0s - loss: 0.1635 - acc: 0.9529
150/150 [==============================] - 2s 16ms/step - loss: 0.1601 - acc: 0.9524 - val_loss: 0.3209 - val_acc: 0.8955
Epoch 15/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1127 - acc: 0.9698
 64/150 [===========>..................] - ETA: 1s - loss: 0.1324 - acc: 0.9581
 96/150 [==================>...........] - ETA: 0s - loss: 0.1345 - acc: 0.9597
128/150 [========================>.....] - ETA: 0s - loss: 0.1367 - acc: 0.9615
150/150 [==============================] - 2s 17ms/step - loss: 0.1347 - acc: 0.9621 - val_loss: 0.2969 - val_acc: 0.9045
Epoch 16/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1492 - acc: 0.9510
 64/150 [===========>..................] - ETA: 1s - loss: 0.1499 - acc: 0.9496
 96/150 [==================>...........] - ETA: 0s - loss: 0.1447 - acc: 0.9561
128/150 [========================>.....] - ETA: 0s - loss: 0.1305 - acc: 0.9620
150/150 [==============================] - 2s 16ms/step - loss: 0.1349 - acc: 0.9616 - val_loss: 0.3256 - val_acc: 0.8985
Epoch 17/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1513 - acc: 0.9442
 64/150 [===========>..................] - ETA: 1s - loss: 0.1447 - acc: 0.9506
 96/150 [==================>...........] - ETA: 0s - loss: 0.1446 - acc: 0.9502
128/150 [========================>.....] - ETA: 0s - loss: 0.1395 - acc: 0.9537
150/150 [==============================] - 2s 16ms/step - loss: 0.1348 - acc: 0.9561 - val_loss: 0.2890 - val_acc: 0.9075
Epoch 18/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1036 - acc: 0.9744
 64/150 [===========>..................] - ETA: 1s - loss: 0.1046 - acc: 0.9755
 96/150 [==================>...........] - ETA: 0s - loss: 0.1039 - acc: 0.9731
128/150 [========================>.....] - ETA: 0s - loss: 0.1017 - acc: 0.9753
150/150 [==============================] - 2s 16ms/step - loss: 0.1037 - acc: 0.9747 - val_loss: 0.3098 - val_acc: 0.8985
Epoch 19/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1020 - acc: 0.9791
 64/150 [===========>..................] - ETA: 1s - loss: 0.1005 - acc: 0.9753
 96/150 [==================>...........] - ETA: 0s - loss: 0.1038 - acc: 0.9735
128/150 [========================>.....] - ETA: 0s - loss: 0.0998 - acc: 0.9743
150/150 [==============================] - 2s 17ms/step - loss: 0.0972 - acc: 0.9760 - val_loss: 0.3017 - val_acc: 0.8985
Computing...
Manual evaluation: (didn't understand why I made this)
True 7801
False 1270
True percentage 0.859993385514
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-ORG       0.52      0.42      0.46       296
      B-LOC       0.65      0.62      0.64       218
      B-PER       0.80      0.62      0.70       438
      I-PER       0.68      0.55      0.61       214
     B-MISC       0.21      0.11      0.15       141
      I-ORG       0.41      0.42      0.41       151
      I-LOC       0.69      0.67      0.68       141
     I-MISC       0.34      0.15      0.21       154

avg / total       0.89      0.86      0.88      9071

F-1 Score:
0.537825810553
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 167 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100177 unique words.
Found 94 unique chars.
Found 9 unique labels.
173 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 303
OOV word occurences: 487
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6411392     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,914,498
Trainable params: 6,914,498
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 150 samples, validate on 17 samples
Epoch 1/70

 32/150 [=====>........................] - ETA: 9s - loss: 2.4270 - acc: 0.0122
 64/150 [===========>..................] - ETA: 4s - loss: 1.7029 - acc: 0.3970
 96/150 [==================>...........] - ETA: 2s - loss: 1.7367 - acc: 0.5245
128/150 [========================>.....] - ETA: 0s - loss: 1.7020 - acc: 0.5737
150/150 [==============================] - 5s 32ms/step - loss: 1.5801 - acc: 0.6045 - val_loss: 0.8852 - val_acc: 0.7441
Epoch 2/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.7132 - acc: 0.8084
 64/150 [===========>..................] - ETA: 1s - loss: 0.7316 - acc: 0.7949
 96/150 [==================>...........] - ETA: 0s - loss: 0.6992 - acc: 0.8005
128/150 [========================>.....] - ETA: 0s - loss: 0.7056 - acc: 0.7972
150/150 [==============================] - 2s 16ms/step - loss: 0.7199 - acc: 0.7897 - val_loss: 0.7310 - val_acc: 0.7546
Epoch 3/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.6309 - acc: 0.8145
 64/150 [===========>..................] - ETA: 1s - loss: 0.6237 - acc: 0.8155
 96/150 [==================>...........] - ETA: 0s - loss: 0.6360 - acc: 0.8041
128/150 [========================>.....] - ETA: 0s - loss: 0.6054 - acc: 0.8145
150/150 [==============================] - 2s 15ms/step - loss: 0.5942 - acc: 0.8188 - val_loss: 0.6260 - val_acc: 0.7784
Epoch 4/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.4709 - acc: 0.8499
 64/150 [===========>..................] - ETA: 1s - loss: 0.5599 - acc: 0.8218
 96/150 [==================>...........] - ETA: 0s - loss: 0.5136 - acc: 0.8406
128/150 [========================>.....] - ETA: 0s - loss: 0.5206 - acc: 0.8398
150/150 [==============================] - 2s 15ms/step - loss: 0.5327 - acc: 0.8410 - val_loss: 0.5676 - val_acc: 0.7968
Epoch 5/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.4908 - acc: 0.8416
 64/150 [===========>..................] - ETA: 1s - loss: 0.4730 - acc: 0.8413
 96/150 [==================>...........] - ETA: 0s - loss: 0.4498 - acc: 0.8532
128/150 [========================>.....] - ETA: 0s - loss: 0.4547 - acc: 0.8547
150/150 [==============================] - 2s 15ms/step - loss: 0.4438 - acc: 0.8578 - val_loss: 0.4926 - val_acc: 0.8575
Epoch 6/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.4271 - acc: 0.8881
 64/150 [===========>..................] - ETA: 1s - loss: 0.4066 - acc: 0.8757
 96/150 [==================>...........] - ETA: 0s - loss: 0.3943 - acc: 0.8809
128/150 [========================>.....] - ETA: 0s - loss: 0.3927 - acc: 0.8787
150/150 [==============================] - 2s 16ms/step - loss: 0.3862 - acc: 0.8784 - val_loss: 0.4497 - val_acc: 0.8575
Epoch 7/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.4457 - acc: 0.8694
 64/150 [===========>..................] - ETA: 1s - loss: 0.3620 - acc: 0.8949
 96/150 [==================>...........] - ETA: 0s - loss: 0.3472 - acc: 0.8959
128/150 [========================>.....] - ETA: 0s - loss: 0.3769 - acc: 0.8810
150/150 [==============================] - 2s 15ms/step - loss: 0.3870 - acc: 0.8839 - val_loss: 0.4330 - val_acc: 0.8628
Epoch 8/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.3592 - acc: 0.8954
 64/150 [===========>..................] - ETA: 1s - loss: 0.3295 - acc: 0.9041
 96/150 [==================>...........] - ETA: 0s - loss: 0.3234 - acc: 0.9112
128/150 [========================>.....] - ETA: 0s - loss: 0.3356 - acc: 0.9014
150/150 [==============================] - 2s 15ms/step - loss: 0.3264 - acc: 0.9070 - val_loss: 0.3913 - val_acc: 0.8734
Epoch 9/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2336 - acc: 0.9566
 64/150 [===========>..................] - ETA: 1s - loss: 0.3015 - acc: 0.9168
 96/150 [==================>...........] - ETA: 0s - loss: 0.3017 - acc: 0.9130
128/150 [========================>.....] - ETA: 0s - loss: 0.2817 - acc: 0.9226
150/150 [==============================] - 2s 15ms/step - loss: 0.2878 - acc: 0.9163 - val_loss: 0.3731 - val_acc: 0.8734
Epoch 10/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2667 - acc: 0.9206
 64/150 [===========>..................] - ETA: 1s - loss: 0.2782 - acc: 0.9199
 96/150 [==================>...........] - ETA: 0s - loss: 0.2580 - acc: 0.9266
128/150 [========================>.....] - ETA: 0s - loss: 0.2587 - acc: 0.9247
150/150 [==============================] - 2s 15ms/step - loss: 0.2662 - acc: 0.9200 - val_loss: 0.3648 - val_acc: 0.8813
Epoch 11/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2835 - acc: 0.9173
 64/150 [===========>..................] - ETA: 1s - loss: 0.2761 - acc: 0.9149
 96/150 [==================>...........] - ETA: 0s - loss: 0.2488 - acc: 0.9234
128/150 [========================>.....] - ETA: 0s - loss: 0.2424 - acc: 0.9257
150/150 [==============================] - 2s 15ms/step - loss: 0.2406 - acc: 0.9280 - val_loss: 0.3506 - val_acc: 0.8760
Epoch 12/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2038 - acc: 0.9423
 64/150 [===========>..................] - ETA: 1s - loss: 0.2204 - acc: 0.9275
 96/150 [==================>...........] - ETA: 0s - loss: 0.2192 - acc: 0.9307
128/150 [========================>.....] - ETA: 0s - loss: 0.2280 - acc: 0.9311
150/150 [==============================] - 2s 15ms/step - loss: 0.2200 - acc: 0.9336 - val_loss: 0.3529 - val_acc: 0.8813
Epoch 13/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2045 - acc: 0.9347
 64/150 [===========>..................] - ETA: 1s - loss: 0.1917 - acc: 0.9433
 96/150 [==================>...........] - ETA: 0s - loss: 0.1914 - acc: 0.9470
128/150 [========================>.....] - ETA: 0s - loss: 0.2035 - acc: 0.9410
150/150 [==============================] - 2s 15ms/step - loss: 0.2003 - acc: 0.9412 - val_loss: 0.3319 - val_acc: 0.8839
Epoch 14/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2367 - acc: 0.9384
 64/150 [===========>..................] - ETA: 1s - loss: 0.2212 - acc: 0.9412
 96/150 [==================>...........] - ETA: 0s - loss: 0.2039 - acc: 0.9436
128/150 [========================>.....] - ETA: 0s - loss: 0.2026 - acc: 0.9455
150/150 [==============================] - 2s 15ms/step - loss: 0.2011 - acc: 0.9443 - val_loss: 0.3177 - val_acc: 0.8865
Epoch 15/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1971 - acc: 0.9422
 64/150 [===========>..................] - ETA: 1s - loss: 0.1774 - acc: 0.9500
 96/150 [==================>...........] - ETA: 0s - loss: 0.1736 - acc: 0.9556
128/150 [========================>.....] - ETA: 0s - loss: 0.1639 - acc: 0.9565
150/150 [==============================] - 2s 15ms/step - loss: 0.1668 - acc: 0.9550 - val_loss: 0.3159 - val_acc: 0.8865
Epoch 16/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1481 - acc: 0.9568
 64/150 [===========>..................] - ETA: 1s - loss: 0.1433 - acc: 0.9595
 96/150 [==================>...........] - ETA: 0s - loss: 0.1505 - acc: 0.9566
128/150 [========================>.....] - ETA: 0s - loss: 0.1618 - acc: 0.9524
150/150 [==============================] - 2s 15ms/step - loss: 0.1615 - acc: 0.9530 - val_loss: 0.3331 - val_acc: 0.9050
Epoch 17/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1182 - acc: 0.9636
 64/150 [===========>..................] - ETA: 1s - loss: 0.1463 - acc: 0.9529
 96/150 [==================>...........] - ETA: 0s - loss: 0.1520 - acc: 0.9502
128/150 [========================>.....] - ETA: 0s - loss: 0.1617 - acc: 0.9505
150/150 [==============================] - 2s 15ms/step - loss: 0.1676 - acc: 0.9476 - val_loss: 0.3236 - val_acc: 0.8918
Computing...
Manual evaluation: (didn't understand why I made this)
True 7811
False 1260
True percentage 0.861095799802
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-PER       0.79      0.64      0.71       438
      B-ORG       0.69      0.38      0.49       296
     I-MISC       0.27      0.22      0.24       154
      B-LOC       0.67      0.67      0.67       218
      I-LOC       0.47      0.81      0.60       141
      I-ORG       0.48      0.23      0.31       151
      I-PER       0.84      0.58      0.69       214
     B-MISC       0.28      0.14      0.19       141

avg / total       0.90      0.86      0.88      9071

F-1 Score:
0.550190597205
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 167 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100206 unique words.
Found 94 unique chars.
Found 9 unique labels.
202 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 300
OOV word occurences: 542
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6413248     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,916,354
Trainable params: 6,916,354
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 150 samples, validate on 17 samples
Epoch 1/70

 32/150 [=====>........................] - ETA: 9s - loss: 2.5433 - acc: 0.0531
 64/150 [===========>..................] - ETA: 4s - loss: 1.7575 - acc: 0.4259
 96/150 [==================>...........] - ETA: 2s - loss: 2.0887 - acc: 0.5491
128/150 [========================>.....] - ETA: 0s - loss: 1.8109 - acc: 0.6072
150/150 [==============================] - 5s 32ms/step - loss: 1.6583 - acc: 0.6374 - val_loss: 0.7631 - val_acc: 0.8151
Epoch 2/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.7375 - acc: 0.8074
 64/150 [===========>..................] - ETA: 1s - loss: 0.7401 - acc: 0.8026
 96/150 [==================>...........] - ETA: 0s - loss: 0.7406 - acc: 0.7990
128/150 [========================>.....] - ETA: 0s - loss: 0.7292 - acc: 0.7980
150/150 [==============================] - 2s 16ms/step - loss: 0.7284 - acc: 0.7946 - val_loss: 0.6229 - val_acc: 0.8179
Epoch 3/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.5798 - acc: 0.8346
 64/150 [===========>..................] - ETA: 1s - loss: 0.6147 - acc: 0.8156
 96/150 [==================>...........] - ETA: 0s - loss: 0.6315 - acc: 0.8158
128/150 [========================>.....] - ETA: 0s - loss: 0.6181 - acc: 0.8135
150/150 [==============================] - 2s 16ms/step - loss: 0.6072 - acc: 0.8187 - val_loss: 0.4954 - val_acc: 0.8263
Epoch 4/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.6151 - acc: 0.7921
 64/150 [===========>..................] - ETA: 1s - loss: 0.5288 - acc: 0.8325
 96/150 [==================>...........] - ETA: 0s - loss: 0.5565 - acc: 0.8223
128/150 [========================>.....] - ETA: 0s - loss: 0.5650 - acc: 0.8338
150/150 [==============================] - 2s 16ms/step - loss: 0.5366 - acc: 0.8446 - val_loss: 0.4728 - val_acc: 0.8431
Epoch 5/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.4404 - acc: 0.8630
 64/150 [===========>..................] - ETA: 1s - loss: 0.4584 - acc: 0.8585
 96/150 [==================>...........] - ETA: 0s - loss: 0.4380 - acc: 0.8621
128/150 [========================>.....] - ETA: 0s - loss: 0.4170 - acc: 0.8656
150/150 [==============================] - 2s 15ms/step - loss: 0.4152 - acc: 0.8691 - val_loss: 0.3916 - val_acc: 0.8796
Epoch 6/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2895 - acc: 0.9191
 64/150 [===========>..................] - ETA: 1s - loss: 0.3399 - acc: 0.8960
 96/150 [==================>...........] - ETA: 0s - loss: 0.3425 - acc: 0.8983
128/150 [========================>.....] - ETA: 0s - loss: 0.3449 - acc: 0.8984
150/150 [==============================] - 2s 15ms/step - loss: 0.3429 - acc: 0.8977 - val_loss: 0.3707 - val_acc: 0.8992
Epoch 7/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.3076 - acc: 0.9032
 64/150 [===========>..................] - ETA: 1s - loss: 0.3101 - acc: 0.9027
 96/150 [==================>...........] - ETA: 0s - loss: 0.3145 - acc: 0.9034
128/150 [========================>.....] - ETA: 0s - loss: 0.3095 - acc: 0.9069
150/150 [==============================] - 2s 15ms/step - loss: 0.3027 - acc: 0.9079 - val_loss: 0.3438 - val_acc: 0.9048
Epoch 8/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2574 - acc: 0.9203
 64/150 [===========>..................] - ETA: 1s - loss: 0.2671 - acc: 0.9222
 96/150 [==================>...........] - ETA: 0s - loss: 0.2756 - acc: 0.9152
128/150 [========================>.....] - ETA: 0s - loss: 0.2792 - acc: 0.9132
150/150 [==============================] - 2s 15ms/step - loss: 0.2757 - acc: 0.9145 - val_loss: 0.3101 - val_acc: 0.9020
Epoch 9/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2566 - acc: 0.9295
 64/150 [===========>..................] - ETA: 1s - loss: 0.2525 - acc: 0.9271
 96/150 [==================>...........] - ETA: 0s - loss: 0.2514 - acc: 0.9249
128/150 [========================>.....] - ETA: 0s - loss: 0.2255 - acc: 0.9339
150/150 [==============================] - 2s 15ms/step - loss: 0.2327 - acc: 0.9324 - val_loss: 0.3306 - val_acc: 0.9020
Epoch 10/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2139 - acc: 0.9280
 64/150 [===========>..................] - ETA: 1s - loss: 0.2340 - acc: 0.9255
 96/150 [==================>...........] - ETA: 0s - loss: 0.2373 - acc: 0.9228
128/150 [========================>.....] - ETA: 0s - loss: 0.2379 - acc: 0.9246
150/150 [==============================] - 2s 15ms/step - loss: 0.2265 - acc: 0.9291 - val_loss: 0.3020 - val_acc: 0.9020
Epoch 11/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2157 - acc: 0.9234
 64/150 [===========>..................] - ETA: 1s - loss: 0.2115 - acc: 0.9369
 96/150 [==================>...........] - ETA: 0s - loss: 0.1989 - acc: 0.9402
128/150 [========================>.....] - ETA: 0s - loss: 0.1973 - acc: 0.9419
150/150 [==============================] - 2s 15ms/step - loss: 0.1972 - acc: 0.9437 - val_loss: 0.3467 - val_acc: 0.9048
Epoch 12/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1684 - acc: 0.9424
 64/150 [===========>..................] - ETA: 1s - loss: 0.2010 - acc: 0.9333
 96/150 [==================>...........] - ETA: 0s - loss: 0.1963 - acc: 0.9405
128/150 [========================>.....] - ETA: 0s - loss: 0.1878 - acc: 0.9416
150/150 [==============================] - 2s 15ms/step - loss: 0.1898 - acc: 0.9425 - val_loss: 0.3262 - val_acc: 0.9048
Computing...
Manual evaluation: (didn't understand why I made this)
True 7674
False 1397
True percentage 0.845992724066
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.95      0.95      7318
      B-PER       0.72      0.46      0.56       438
      B-LOC       0.73      0.57      0.64       218
      B-ORG       0.54      0.45      0.49       296
      I-PER       0.70      0.41      0.51       214
     B-MISC       0.92      0.09      0.16       141
     I-MISC       0.41      0.12      0.18       154
      I-LOC       0.73      0.41      0.53       141
      I-ORG       0.37      0.38      0.37       151

avg / total       0.88      0.85      0.86      9071

F-1 Score:
0.481894150418
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 167 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100214 unique words.
Found 94 unique chars.
Found 9 unique labels.
210 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 300
OOV word occurences: 479
Padding...
Data padded!
Padding...
Data padded!
Padded until 58 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 58, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 58)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 58, 64)       6413760     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 58, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 58, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 58, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 58, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 58, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,916,866
Trainable params: 6,916,866
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 150 samples, validate on 17 samples
Epoch 1/70

 32/150 [=====>........................] - ETA: 9s - loss: 2.4023 - acc: 0.0401
 64/150 [===========>..................] - ETA: 4s - loss: 1.7524 - acc: 0.4185
 96/150 [==================>...........] - ETA: 2s - loss: 1.9393 - acc: 0.5530
128/150 [========================>.....] - ETA: 0s - loss: 1.7072 - acc: 0.6122
150/150 [==============================] - 5s 32ms/step - loss: 1.5654 - acc: 0.6454 - val_loss: 0.7018 - val_acc: 0.8210
Epoch 2/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.9299 - acc: 0.7520
 64/150 [===========>..................] - ETA: 1s - loss: 0.8406 - acc: 0.7754
 96/150 [==================>...........] - ETA: 0s - loss: 0.7691 - acc: 0.7925
128/150 [========================>.....] - ETA: 0s - loss: 0.7496 - acc: 0.7970
150/150 [==============================] - 2s 17ms/step - loss: 0.7214 - acc: 0.8069 - val_loss: 0.5991 - val_acc: 0.8210
Epoch 3/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.5907 - acc: 0.8208
 64/150 [===========>..................] - ETA: 1s - loss: 0.5663 - acc: 0.8293
 96/150 [==================>...........] - ETA: 0s - loss: 0.5833 - acc: 0.8224
128/150 [========================>.....] - ETA: 0s - loss: 0.5701 - acc: 0.8286
150/150 [==============================] - 2s 16ms/step - loss: 0.5652 - acc: 0.8276 - val_loss: 0.4325 - val_acc: 0.8765
Epoch 4/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.5252 - acc: 0.8312
 64/150 [===========>..................] - ETA: 1s - loss: 0.4745 - acc: 0.8463
 96/150 [==================>...........] - ETA: 0s - loss: 0.4617 - acc: 0.8605
128/150 [========================>.....] - ETA: 0s - loss: 0.4816 - acc: 0.8524
150/150 [==============================] - 2s 16ms/step - loss: 0.4723 - acc: 0.8580 - val_loss: 0.3866 - val_acc: 0.8786
Epoch 5/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.3751 - acc: 0.8772
 64/150 [===========>..................] - ETA: 1s - loss: 0.3966 - acc: 0.8761
 96/150 [==================>...........] - ETA: 0s - loss: 0.3714 - acc: 0.8890
128/150 [========================>.....] - ETA: 0s - loss: 0.3783 - acc: 0.8847
150/150 [==============================] - 2s 16ms/step - loss: 0.3772 - acc: 0.8863 - val_loss: 0.3278 - val_acc: 0.8909
Epoch 6/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.3411 - acc: 0.8908
 64/150 [===========>..................] - ETA: 1s - loss: 0.3713 - acc: 0.8798
 96/150 [==================>...........] - ETA: 0s - loss: 0.3566 - acc: 0.8831
128/150 [========================>.....] - ETA: 0s - loss: 0.3459 - acc: 0.8920
150/150 [==============================] - 2s 16ms/step - loss: 0.3397 - acc: 0.8934 - val_loss: 0.3004 - val_acc: 0.9095
Epoch 7/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.3610 - acc: 0.8918
 64/150 [===========>..................] - ETA: 1s - loss: 0.3223 - acc: 0.9018
 96/150 [==================>...........] - ETA: 0s - loss: 0.3065 - acc: 0.9072
128/150 [========================>.....] - ETA: 0s - loss: 0.2996 - acc: 0.9127
150/150 [==============================] - 2s 15ms/step - loss: 0.2936 - acc: 0.9134 - val_loss: 0.3211 - val_acc: 0.9177
Epoch 8/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2697 - acc: 0.9303
 64/150 [===========>..................] - ETA: 1s - loss: 0.2883 - acc: 0.9159
 96/150 [==================>...........] - ETA: 0s - loss: 0.2811 - acc: 0.9226
128/150 [========================>.....] - ETA: 0s - loss: 0.2734 - acc: 0.9241
150/150 [==============================] - 2s 15ms/step - loss: 0.2780 - acc: 0.9197 - val_loss: 0.2836 - val_acc: 0.9012
Epoch 9/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2359 - acc: 0.9300
 64/150 [===========>..................] - ETA: 1s - loss: 0.2333 - acc: 0.9329
 96/150 [==================>...........] - ETA: 0s - loss: 0.2496 - acc: 0.9273
128/150 [========================>.....] - ETA: 0s - loss: 0.2440 - acc: 0.9282
150/150 [==============================] - 2s 15ms/step - loss: 0.2375 - acc: 0.9318 - val_loss: 0.2518 - val_acc: 0.9321
Epoch 10/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1352 - acc: 0.9633
 64/150 [===========>..................] - ETA: 1s - loss: 0.2291 - acc: 0.9325
 96/150 [==================>...........] - ETA: 0s - loss: 0.2215 - acc: 0.9378
128/150 [========================>.....] - ETA: 0s - loss: 0.2082 - acc: 0.9424
150/150 [==============================] - 2s 15ms/step - loss: 0.2109 - acc: 0.9398 - val_loss: 0.2435 - val_acc: 0.9300
Epoch 11/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1528 - acc: 0.9670
 64/150 [===========>..................] - ETA: 1s - loss: 0.1823 - acc: 0.9524
 96/150 [==================>...........] - ETA: 0s - loss: 0.2122 - acc: 0.9408
128/150 [========================>.....] - ETA: 0s - loss: 0.1928 - acc: 0.9474
150/150 [==============================] - 2s 16ms/step - loss: 0.1897 - acc: 0.9487 - val_loss: 0.2311 - val_acc: 0.9259
Epoch 12/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1244 - acc: 0.9649
 64/150 [===========>..................] - ETA: 1s - loss: 0.1250 - acc: 0.9637
 96/150 [==================>...........] - ETA: 0s - loss: 0.1535 - acc: 0.9528
128/150 [========================>.....] - ETA: 0s - loss: 0.1581 - acc: 0.9514
150/150 [==============================] - 2s 16ms/step - loss: 0.1693 - acc: 0.9470 - val_loss: 0.2254 - val_acc: 0.9342
Epoch 13/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1568 - acc: 0.9511
 64/150 [===========>..................] - ETA: 1s - loss: 0.1461 - acc: 0.9586
 96/150 [==================>...........] - ETA: 0s - loss: 0.1511 - acc: 0.9555
128/150 [========================>.....] - ETA: 0s - loss: 0.1558 - acc: 0.9518
150/150 [==============================] - 2s 15ms/step - loss: 0.1608 - acc: 0.9488 - val_loss: 0.2136 - val_acc: 0.9424
Epoch 14/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1728 - acc: 0.9412
 64/150 [===========>..................] - ETA: 1s - loss: 0.1445 - acc: 0.9567
 96/150 [==================>...........] - ETA: 0s - loss: 0.1476 - acc: 0.9581
128/150 [========================>.....] - ETA: 0s - loss: 0.1428 - acc: 0.9576
150/150 [==============================] - 2s 15ms/step - loss: 0.1402 - acc: 0.9590 - val_loss: 0.2110 - val_acc: 0.9342
Epoch 15/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1213 - acc: 0.9661
 64/150 [===========>..................] - ETA: 1s - loss: 0.1504 - acc: 0.9515
 96/150 [==================>...........] - ETA: 0s - loss: 0.1397 - acc: 0.9573
128/150 [========================>.....] - ETA: 0s - loss: 0.1385 - acc: 0.9563
150/150 [==============================] - 2s 15ms/step - loss: 0.1462 - acc: 0.9513 - val_loss: 0.2453 - val_acc: 0.9280
Epoch 16/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1777 - acc: 0.9471
 64/150 [===========>..................] - ETA: 1s - loss: 0.1706 - acc: 0.9472
 96/150 [==================>...........] - ETA: 0s - loss: 0.1486 - acc: 0.9548
128/150 [========================>.....] - ETA: 0s - loss: 0.1485 - acc: 0.9536
150/150 [==============================] - 2s 15ms/step - loss: 0.1467 - acc: 0.9551 - val_loss: 0.2054 - val_acc: 0.9362
Epoch 17/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1670 - acc: 0.9531
 64/150 [===========>..................] - ETA: 1s - loss: 0.1377 - acc: 0.9614
 96/150 [==================>...........] - ETA: 0s - loss: 0.1316 - acc: 0.9611
128/150 [========================>.....] - ETA: 0s - loss: 0.1246 - acc: 0.9665
150/150 [==============================] - 2s 15ms/step - loss: 0.1166 - acc: 0.9686 - val_loss: 0.2035 - val_acc: 0.9444
Epoch 18/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.0838 - acc: 0.9764
 64/150 [===========>..................] - ETA: 1s - loss: 0.1014 - acc: 0.9716
 96/150 [==================>...........] - ETA: 0s - loss: 0.1025 - acc: 0.9721
128/150 [========================>.....] - ETA: 0s - loss: 0.1056 - acc: 0.9706
150/150 [==============================] - 2s 15ms/step - loss: 0.1061 - acc: 0.9700 - val_loss: 0.1964 - val_acc: 0.9527
Epoch 19/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.0684 - acc: 0.9844
 64/150 [===========>..................] - ETA: 1s - loss: 0.0993 - acc: 0.9733
 96/150 [==================>...........] - ETA: 0s - loss: 0.0953 - acc: 0.9727
128/150 [========================>.....] - ETA: 0s - loss: 0.1009 - acc: 0.9698
150/150 [==============================] - 2s 15ms/step - loss: 0.1010 - acc: 0.9703 - val_loss: 0.2134 - val_acc: 0.9403
Epoch 20/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1027 - acc: 0.9707
 64/150 [===========>..................] - ETA: 1s - loss: 0.1026 - acc: 0.9714
 96/150 [==================>...........] - ETA: 0s - loss: 0.0975 - acc: 0.9713
128/150 [========================>.....] - ETA: 0s - loss: 0.0987 - acc: 0.9712
150/150 [==============================] - 2s 15ms/step - loss: 0.0943 - acc: 0.9727 - val_loss: 0.2001 - val_acc: 0.9424
Computing...
Manual evaluation: (didn't understand why I made this)
True 7772
False 1299
True percentage 0.856796384081
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.95      0.95      7318
      B-ORG       0.58      0.45      0.51       296
      I-ORG       0.43      0.26      0.33       151
      B-PER       0.83      0.61      0.70       438
      B-LOC       0.79      0.60      0.68       218
      I-LOC       0.86      0.61      0.71       141
      I-PER       0.80      0.44      0.57       214
     B-MISC       0.09      0.07      0.08       141
     I-MISC       0.39      0.19      0.26       154

avg / total       0.89      0.86      0.87      9071

F-1 Score:
0.532568342896
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 167 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100211 unique words.
Found 94 unique chars.
Found 9 unique labels.
207 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 299
OOV word occurences: 478
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6413568     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,916,674
Trainable params: 6,916,674
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 150 samples, validate on 17 samples
Epoch 1/70

 32/150 [=====>........................] - ETA: 9s - loss: 2.3325 - acc: 0.0174
 64/150 [===========>..................] - ETA: 4s - loss: 1.6609 - acc: 0.4075
 96/150 [==================>...........] - ETA: 2s - loss: 1.9323 - acc: 0.5354
128/150 [========================>.....] - ETA: 0s - loss: 1.7692 - acc: 0.5939
150/150 [==============================] - 5s 32ms/step - loss: 1.6158 - acc: 0.6272 - val_loss: 0.4791 - val_acc: 0.8889
Epoch 2/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.6203 - acc: 0.8451
 64/150 [===========>..................] - ETA: 1s - loss: 0.7193 - acc: 0.8121
 96/150 [==================>...........] - ETA: 0s - loss: 0.7211 - acc: 0.8076
128/150 [========================>.....] - ETA: 0s - loss: 0.7082 - acc: 0.8049
150/150 [==============================] - 2s 16ms/step - loss: 0.7308 - acc: 0.7977 - val_loss: 0.4256 - val_acc: 0.8916
Epoch 3/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.6169 - acc: 0.8181
 64/150 [===========>..................] - ETA: 1s - loss: 0.6443 - acc: 0.8018
 96/150 [==================>...........] - ETA: 0s - loss: 0.6265 - acc: 0.8176
128/150 [========================>.....] - ETA: 0s - loss: 0.6032 - acc: 0.8214
150/150 [==============================] - 2s 16ms/step - loss: 0.6159 - acc: 0.8162 - val_loss: 0.3114 - val_acc: 0.9133
Epoch 4/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.5048 - acc: 0.8448
 64/150 [===========>..................] - ETA: 1s - loss: 0.5186 - acc: 0.8338
 96/150 [==================>...........] - ETA: 0s - loss: 0.5046 - acc: 0.8392
128/150 [========================>.....] - ETA: 0s - loss: 0.4975 - acc: 0.8466
150/150 [==============================] - 2s 16ms/step - loss: 0.4990 - acc: 0.8470 - val_loss: 0.4679 - val_acc: 0.9295
Epoch 5/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.6046 - acc: 0.8531
 64/150 [===========>..................] - ETA: 1s - loss: 0.5296 - acc: 0.8597
 96/150 [==================>...........] - ETA: 0s - loss: 0.4976 - acc: 0.8614
128/150 [========================>.....] - ETA: 0s - loss: 0.4828 - acc: 0.8644
150/150 [==============================] - 2s 16ms/step - loss: 0.4621 - acc: 0.8706 - val_loss: 0.2232 - val_acc: 0.9431
Epoch 6/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.3832 - acc: 0.8752
 64/150 [===========>..................] - ETA: 1s - loss: 0.3604 - acc: 0.8872
 96/150 [==================>...........] - ETA: 0s - loss: 0.3542 - acc: 0.8883
128/150 [========================>.....] - ETA: 0s - loss: 0.3742 - acc: 0.8847
150/150 [==============================] - 2s 15ms/step - loss: 0.3627 - acc: 0.8897 - val_loss: 0.2068 - val_acc: 0.9512
Epoch 7/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2811 - acc: 0.9108
 64/150 [===========>..................] - ETA: 1s - loss: 0.3459 - acc: 0.8927
 96/150 [==================>...........] - ETA: 0s - loss: 0.3159 - acc: 0.9048
128/150 [========================>.....] - ETA: 0s - loss: 0.3200 - acc: 0.9018
150/150 [==============================] - 2s 15ms/step - loss: 0.3153 - acc: 0.9035 - val_loss: 0.2038 - val_acc: 0.9539
Epoch 8/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.3315 - acc: 0.9009
 64/150 [===========>..................] - ETA: 1s - loss: 0.2749 - acc: 0.9171
 96/150 [==================>...........] - ETA: 0s - loss: 0.2759 - acc: 0.9173
128/150 [========================>.....] - ETA: 0s - loss: 0.2740 - acc: 0.9137
150/150 [==============================] - 2s 15ms/step - loss: 0.2856 - acc: 0.9093 - val_loss: 0.1911 - val_acc: 0.9593
Epoch 9/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2036 - acc: 0.9392
 64/150 [===========>..................] - ETA: 1s - loss: 0.2328 - acc: 0.9250
 96/150 [==================>...........] - ETA: 0s - loss: 0.2428 - acc: 0.9271
128/150 [========================>.....] - ETA: 0s - loss: 0.2477 - acc: 0.9257
150/150 [==============================] - 2s 15ms/step - loss: 0.2403 - acc: 0.9282 - val_loss: 0.1799 - val_acc: 0.9566
Epoch 10/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2528 - acc: 0.9313
 64/150 [===========>..................] - ETA: 1s - loss: 0.2576 - acc: 0.9280
 96/150 [==================>...........] - ETA: 0s - loss: 0.2373 - acc: 0.9357
128/150 [========================>.....] - ETA: 0s - loss: 0.2235 - acc: 0.9381
150/150 [==============================] - 2s 15ms/step - loss: 0.2253 - acc: 0.9357 - val_loss: 0.1537 - val_acc: 0.9675
Epoch 11/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2452 - acc: 0.9142
 64/150 [===========>..................] - ETA: 1s - loss: 0.2319 - acc: 0.9214
 96/150 [==================>...........] - ETA: 0s - loss: 0.2142 - acc: 0.9289
128/150 [========================>.....] - ETA: 0s - loss: 0.2064 - acc: 0.9333
150/150 [==============================] - 2s 15ms/step - loss: 0.1988 - acc: 0.9386 - val_loss: 0.1525 - val_acc: 0.9593
Epoch 12/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1571 - acc: 0.9596
 64/150 [===========>..................] - ETA: 1s - loss: 0.1938 - acc: 0.9433
 96/150 [==================>...........] - ETA: 0s - loss: 0.1762 - acc: 0.9490
128/150 [========================>.....] - ETA: 0s - loss: 0.1832 - acc: 0.9450
150/150 [==============================] - 2s 15ms/step - loss: 0.1895 - acc: 0.9399 - val_loss: 0.2003 - val_acc: 0.9404
Epoch 13/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2366 - acc: 0.9158
 64/150 [===========>..................] - ETA: 1s - loss: 0.1879 - acc: 0.9346
 96/150 [==================>...........] - ETA: 0s - loss: 0.1934 - acc: 0.9327
128/150 [========================>.....] - ETA: 0s - loss: 0.1815 - acc: 0.9390
150/150 [==============================] - 2s 15ms/step - loss: 0.1825 - acc: 0.9402 - val_loss: 0.1426 - val_acc: 0.9539
Epoch 14/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1827 - acc: 0.9457
 64/150 [===========>..................] - ETA: 1s - loss: 0.1859 - acc: 0.9453
 96/150 [==================>...........] - ETA: 0s - loss: 0.1703 - acc: 0.9506
128/150 [========================>.....] - ETA: 0s - loss: 0.1594 - acc: 0.9551
150/150 [==============================] - 2s 15ms/step - loss: 0.1564 - acc: 0.9553 - val_loss: 0.1507 - val_acc: 0.9539
Epoch 15/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1175 - acc: 0.9672
 64/150 [===========>..................] - ETA: 1s - loss: 0.1265 - acc: 0.9648
 96/150 [==================>...........] - ETA: 0s - loss: 0.1330 - acc: 0.9613
128/150 [========================>.....] - ETA: 0s - loss: 0.1405 - acc: 0.9593
150/150 [==============================] - 2s 15ms/step - loss: 0.1413 - acc: 0.9582 - val_loss: 0.1360 - val_acc: 0.9539
Epoch 16/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1046 - acc: 0.9614
 64/150 [===========>..................] - ETA: 1s - loss: 0.0971 - acc: 0.9638
 96/150 [==================>...........] - ETA: 0s - loss: 0.1192 - acc: 0.9569
128/150 [========================>.....] - ETA: 0s - loss: 0.1276 - acc: 0.9585
150/150 [==============================] - 2s 15ms/step - loss: 0.1287 - acc: 0.9584 - val_loss: 0.1468 - val_acc: 0.9485
Epoch 17/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1215 - acc: 0.9653
 64/150 [===========>..................] - ETA: 1s - loss: 0.1003 - acc: 0.9733
 96/150 [==================>...........] - ETA: 0s - loss: 0.1021 - acc: 0.9728
128/150 [========================>.....] - ETA: 0s - loss: 0.1116 - acc: 0.9708
150/150 [==============================] - 2s 15ms/step - loss: 0.1168 - acc: 0.9691 - val_loss: 0.1559 - val_acc: 0.9485
Computing...
Manual evaluation: (didn't understand why I made this)
True 7873
False 1198
True percentage 0.867930768383
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.96      0.96      7318
      B-ORG       0.66      0.41      0.51       296
      I-ORG       0.52      0.30      0.38       151
     B-MISC       0.30      0.11      0.16       141
     I-MISC       0.49      0.19      0.27       154
      B-PER       0.79      0.69      0.74       438
      B-LOC       0.66      0.70      0.68       218
      I-LOC       0.70      0.67      0.69       141
      I-PER       0.76      0.54      0.63       214

avg / total       0.90      0.87      0.88      9071

F-1 Score:
0.578011849901
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 167 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100218 unique words.
Found 94 unique chars.
Found 9 unique labels.
214 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 297
OOV word occurences: 581
Padding...
Data padded!
Padding...
Data padded!
Padded until 66 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 66 tokens.
Padded until 24 chars.
Padded until 66 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 66, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 66)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 66, 64)       6414016     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 66, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 66, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 66, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 66, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 66, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,917,122
Trainable params: 6,917,122
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 150 samples, validate on 17 samples
Epoch 1/70

 32/150 [=====>........................] - ETA: 9s - loss: 2.6093 - acc: 0.0559
 64/150 [===========>..................] - ETA: 4s - loss: 1.7736 - acc: 0.4546
 96/150 [==================>...........] - ETA: 2s - loss: 2.1451 - acc: 0.5647
128/150 [========================>.....] - ETA: 0s - loss: 1.8602 - acc: 0.6091
150/150 [==============================] - 5s 34ms/step - loss: 1.6945 - acc: 0.6414 - val_loss: 0.6936 - val_acc: 0.8297
Epoch 2/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.8431 - acc: 0.7866
 64/150 [===========>..................] - ETA: 1s - loss: 0.8491 - acc: 0.7706
 96/150 [==================>...........] - ETA: 0s - loss: 0.7940 - acc: 0.7865
128/150 [========================>.....] - ETA: 0s - loss: 0.7579 - acc: 0.7954
150/150 [==============================] - 3s 18ms/step - loss: 0.7462 - acc: 0.7997 - val_loss: 0.6305 - val_acc: 0.8297
Epoch 3/70

 32/150 [=====>........................] - ETA: 2s - loss: 0.7568 - acc: 0.7982
 64/150 [===========>..................] - ETA: 1s - loss: 0.7630 - acc: 0.7872
 96/150 [==================>...........] - ETA: 0s - loss: 0.6885 - acc: 0.8007
128/150 [========================>.....] - ETA: 0s - loss: 0.6436 - acc: 0.8082
150/150 [==============================] - 3s 18ms/step - loss: 0.6273 - acc: 0.8135 - val_loss: 0.4737 - val_acc: 0.8544
Epoch 4/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.4732 - acc: 0.8487
 64/150 [===========>..................] - ETA: 1s - loss: 0.4884 - acc: 0.8445
 96/150 [==================>...........] - ETA: 0s - loss: 0.4507 - acc: 0.8587
128/150 [========================>.....] - ETA: 0s - loss: 0.4602 - acc: 0.8572
150/150 [==============================] - 3s 18ms/step - loss: 0.4763 - acc: 0.8563 - val_loss: 0.4508 - val_acc: 0.8571
Epoch 5/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.5038 - acc: 0.8438
 64/150 [===========>..................] - ETA: 1s - loss: 0.4723 - acc: 0.8756
 96/150 [==================>...........] - ETA: 0s - loss: 0.4570 - acc: 0.8728
128/150 [========================>.....] - ETA: 0s - loss: 0.4373 - acc: 0.8799
150/150 [==============================] - 3s 18ms/step - loss: 0.4262 - acc: 0.8814 - val_loss: 0.3457 - val_acc: 0.8901
Epoch 6/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.3506 - acc: 0.9117
 64/150 [===========>..................] - ETA: 1s - loss: 0.3525 - acc: 0.9113
 96/150 [==================>...........] - ETA: 0s - loss: 0.3263 - acc: 0.9143
128/150 [========================>.....] - ETA: 0s - loss: 0.3361 - acc: 0.9043
150/150 [==============================] - 3s 18ms/step - loss: 0.3405 - acc: 0.9056 - val_loss: 0.3478 - val_acc: 0.8956
Epoch 7/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.3360 - acc: 0.8918
 64/150 [===========>..................] - ETA: 1s - loss: 0.3064 - acc: 0.9079
 96/150 [==================>...........] - ETA: 0s - loss: 0.3232 - acc: 0.9006
128/150 [========================>.....] - ETA: 0s - loss: 0.3056 - acc: 0.9088
150/150 [==============================] - 3s 17ms/step - loss: 0.3018 - acc: 0.9096 - val_loss: 0.2979 - val_acc: 0.8874
Epoch 8/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2251 - acc: 0.9424
 64/150 [===========>..................] - ETA: 1s - loss: 0.2797 - acc: 0.9189
 96/150 [==================>...........] - ETA: 0s - loss: 0.2792 - acc: 0.9241
128/150 [========================>.....] - ETA: 0s - loss: 0.2585 - acc: 0.9284
150/150 [==============================] - 3s 17ms/step - loss: 0.2610 - acc: 0.9278 - val_loss: 0.3065 - val_acc: 0.9038
Epoch 9/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2519 - acc: 0.9243
 64/150 [===========>..................] - ETA: 1s - loss: 0.2405 - acc: 0.9293
 96/150 [==================>...........] - ETA: 0s - loss: 0.2306 - acc: 0.9328
128/150 [========================>.....] - ETA: 0s - loss: 0.2224 - acc: 0.9345
150/150 [==============================] - 3s 17ms/step - loss: 0.2258 - acc: 0.9331 - val_loss: 0.3037 - val_acc: 0.8984
Computing...
Manual evaluation: (didn't understand why I made this)
True 7493
False 1578
True percentage 0.826039025466
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.89      0.33      0.48       438
          O       0.94      0.95      0.95      7318
      B-ORG       0.40      0.50      0.45       296
     B-MISC       0.12      0.01      0.01       141
      B-LOC       0.85      0.32      0.47       218
      I-LOC       1.00      0.01      0.03       141
     I-MISC       0.00      0.00      0.00       154
      I-PER       0.84      0.33      0.47       214
      I-ORG       0.22      0.56      0.32       151

avg / total       0.88      0.83      0.83      9071

F-1 Score:
0.866643084542
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 167 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100205 unique words.
Found 94 unique chars.
Found 9 unique labels.
201 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 303
OOV word occurences: 588
Padding...
Data padded!
Padding...
Data padded!
Padded until 58 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 58, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 58)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 58, 64)       6413184     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 58, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 58, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 58, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 58, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 58, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,916,290
Trainable params: 6,916,290
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 150 samples, validate on 17 samples
Epoch 1/70

 32/150 [=====>........................] - ETA: 9s - loss: 1.8995 - acc: 0.7658
 64/150 [===========>..................] - ETA: 4s - loss: 1.3298 - acc: 0.7997
 96/150 [==================>...........] - ETA: 2s - loss: 1.2265 - acc: 0.7994
128/150 [========================>.....] - ETA: 0s - loss: 1.2383 - acc: 0.7975
150/150 [==============================] - 5s 33ms/step - loss: 1.1880 - acc: 0.7993 - val_loss: 1.0731 - val_acc: 0.7143
Epoch 2/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.6339 - acc: 0.8254
 64/150 [===========>..................] - ETA: 1s - loss: 0.7413 - acc: 0.7919
 96/150 [==================>...........] - ETA: 0s - loss: 0.6716 - acc: 0.8135
128/150 [========================>.....] - ETA: 0s - loss: 0.6650 - acc: 0.8126
150/150 [==============================] - 2s 17ms/step - loss: 0.6656 - acc: 0.8114 - val_loss: 0.9076 - val_acc: 0.7143
Epoch 3/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.4797 - acc: 0.8470
 64/150 [===========>..................] - ETA: 1s - loss: 0.5902 - acc: 0.8112
 96/150 [==================>...........] - ETA: 0s - loss: 0.5770 - acc: 0.8205
128/150 [========================>.....] - ETA: 0s - loss: 0.5272 - acc: 0.8369
150/150 [==============================] - 2s 16ms/step - loss: 0.5365 - acc: 0.8313 - val_loss: 0.7640 - val_acc: 0.7682
Epoch 4/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.4861 - acc: 0.8687
 64/150 [===========>..................] - ETA: 1s - loss: 0.4576 - acc: 0.8655
 96/150 [==================>...........] - ETA: 0s - loss: 0.4520 - acc: 0.8651
128/150 [========================>.....] - ETA: 0s - loss: 0.4505 - acc: 0.8640
150/150 [==============================] - 2s 16ms/step - loss: 0.4413 - acc: 0.8666 - val_loss: 0.7377 - val_acc: 0.7752
Epoch 5/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.3774 - acc: 0.8697
 64/150 [===========>..................] - ETA: 1s - loss: 0.3686 - acc: 0.8787
 96/150 [==================>...........] - ETA: 0s - loss: 0.3594 - acc: 0.8829
128/150 [========================>.....] - ETA: 0s - loss: 0.3728 - acc: 0.8760
150/150 [==============================] - 2s 16ms/step - loss: 0.3859 - acc: 0.8794 - val_loss: 0.7392 - val_acc: 0.7658
Epoch 6/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.3641 - acc: 0.8826
 64/150 [===========>..................] - ETA: 1s - loss: 0.3407 - acc: 0.9010
 96/150 [==================>...........] - ETA: 0s - loss: 0.3264 - acc: 0.9022
128/150 [========================>.....] - ETA: 0s - loss: 0.3345 - acc: 0.9013
150/150 [==============================] - 2s 16ms/step - loss: 0.3289 - acc: 0.9020 - val_loss: 0.5909 - val_acc: 0.8080
Epoch 7/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.3326 - acc: 0.9041
 64/150 [===========>..................] - ETA: 1s - loss: 0.2895 - acc: 0.9125
 96/150 [==================>...........] - ETA: 0s - loss: 0.2795 - acc: 0.9143
128/150 [========================>.....] - ETA: 0s - loss: 0.2576 - acc: 0.9238
150/150 [==============================] - 2s 16ms/step - loss: 0.2701 - acc: 0.9206 - val_loss: 0.6293 - val_acc: 0.8173
Epoch 8/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2490 - acc: 0.9174
 64/150 [===========>..................] - ETA: 1s - loss: 0.2478 - acc: 0.9211
 96/150 [==================>...........] - ETA: 0s - loss: 0.2561 - acc: 0.9166
128/150 [========================>.....] - ETA: 0s - loss: 0.2476 - acc: 0.9202
150/150 [==============================] - 2s 16ms/step - loss: 0.2507 - acc: 0.9218 - val_loss: 0.5443 - val_acc: 0.8454
Epoch 9/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1851 - acc: 0.9515
 64/150 [===========>..................] - ETA: 1s - loss: 0.2007 - acc: 0.9404
 96/150 [==================>...........] - ETA: 0s - loss: 0.2107 - acc: 0.9429
128/150 [========================>.....] - ETA: 0s - loss: 0.2027 - acc: 0.9446
150/150 [==============================] - 2s 15ms/step - loss: 0.2091 - acc: 0.9430 - val_loss: 0.5509 - val_acc: 0.8337
Epoch 10/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1917 - acc: 0.9467
 64/150 [===========>..................] - ETA: 1s - loss: 0.1800 - acc: 0.9452
 96/150 [==================>...........] - ETA: 0s - loss: 0.1994 - acc: 0.9392
128/150 [========================>.....] - ETA: 0s - loss: 0.2025 - acc: 0.9402
150/150 [==============================] - 2s 15ms/step - loss: 0.1887 - acc: 0.9442 - val_loss: 0.5643 - val_acc: 0.8314
Computing...
Manual evaluation: (didn't understand why I made this)
True 7641
False 1430
True percentage 0.842354756918
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.72      0.59      0.64       438
          O       0.95      0.95      0.95      7318
      B-LOC       0.76      0.51      0.61       218
      I-LOC       0.72      0.44      0.55       141
      I-PER       0.69      0.39      0.50       214
      B-ORG       0.44      0.36      0.40       296
      I-ORG       0.28      0.24      0.26       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.35      0.11      0.17       154

avg / total       0.87      0.84      0.85      9071

F-1 Score:
0.881303335919
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 167 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100212 unique words.
Found 94 unique chars.
Found 9 unique labels.
208 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 298
OOV word occurences: 502
Padding...
Data padded!
Padding...
Data padded!
Padded until 66 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 66 tokens.
Padded until 24 chars.
Padded until 66 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 66, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 66)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 66, 64)       6413632     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 66, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 66, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 66, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 66, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 66, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,916,738
Trainable params: 6,916,738
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 150 samples, validate on 17 samples
Epoch 1/70

 32/150 [=====>........................] - ETA: 10s - loss: 2.2956 - acc: 0.0328
 64/150 [===========>..................] - ETA: 4s - loss: 1.6604 - acc: 0.4128 
 96/150 [==================>...........] - ETA: 2s - loss: 1.8651 - acc: 0.5397
128/150 [========================>.....] - ETA: 0s - loss: 1.7179 - acc: 0.6075
150/150 [==============================] - 5s 35ms/step - loss: 1.5715 - acc: 0.6424 - val_loss: 0.7045 - val_acc: 0.8417
Epoch 2/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.7822 - acc: 0.8149
 64/150 [===========>..................] - ETA: 1s - loss: 0.7735 - acc: 0.8080
 96/150 [==================>...........] - ETA: 0s - loss: 0.7736 - acc: 0.8042
128/150 [========================>.....] - ETA: 0s - loss: 0.7493 - acc: 0.8052
150/150 [==============================] - 3s 18ms/step - loss: 0.7287 - acc: 0.8079 - val_loss: 0.5889 - val_acc: 0.8417
Epoch 3/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.6330 - acc: 0.8109
 64/150 [===========>..................] - ETA: 1s - loss: 0.6108 - acc: 0.8164
 96/150 [==================>...........] - ETA: 0s - loss: 0.6083 - acc: 0.8138
128/150 [========================>.....] - ETA: 0s - loss: 0.5963 - acc: 0.8173
150/150 [==============================] - 3s 18ms/step - loss: 0.5965 - acc: 0.8161 - val_loss: 0.5014 - val_acc: 0.8470
Epoch 4/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.6193 - acc: 0.8145
 64/150 [===========>..................] - ETA: 1s - loss: 0.5670 - acc: 0.8294
 96/150 [==================>...........] - ETA: 0s - loss: 0.5834 - acc: 0.8363
128/150 [========================>.....] - ETA: 0s - loss: 0.5677 - acc: 0.8352
150/150 [==============================] - 3s 18ms/step - loss: 0.5541 - acc: 0.8359 - val_loss: 0.4343 - val_acc: 0.8707
Epoch 5/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.5019 - acc: 0.8428
 64/150 [===========>..................] - ETA: 1s - loss: 0.4705 - acc: 0.8490
 96/150 [==================>...........] - ETA: 0s - loss: 0.4668 - acc: 0.8483
128/150 [========================>.....] - ETA: 0s - loss: 0.4528 - acc: 0.8558
150/150 [==============================] - 3s 18ms/step - loss: 0.4379 - acc: 0.8605 - val_loss: 0.3772 - val_acc: 0.8786
Epoch 6/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.3794 - acc: 0.8672
 64/150 [===========>..................] - ETA: 1s - loss: 0.4211 - acc: 0.8638
 96/150 [==================>...........] - ETA: 0s - loss: 0.4021 - acc: 0.8732
128/150 [========================>.....] - ETA: 0s - loss: 0.3745 - acc: 0.8857
150/150 [==============================] - 3s 17ms/step - loss: 0.3733 - acc: 0.8842 - val_loss: 0.3632 - val_acc: 0.9024
Epoch 7/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.3175 - acc: 0.9260
 64/150 [===========>..................] - ETA: 1s - loss: 0.3456 - acc: 0.9014
 96/150 [==================>...........] - ETA: 0s - loss: 0.3352 - acc: 0.9055
128/150 [========================>.....] - ETA: 0s - loss: 0.3360 - acc: 0.9012
150/150 [==============================] - 3s 17ms/step - loss: 0.3301 - acc: 0.9023 - val_loss: 0.3107 - val_acc: 0.9103
Epoch 8/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2429 - acc: 0.9386
 64/150 [===========>..................] - ETA: 1s - loss: 0.2842 - acc: 0.9095
 96/150 [==================>...........] - ETA: 0s - loss: 0.2871 - acc: 0.9176
128/150 [========================>.....] - ETA: 0s - loss: 0.2911 - acc: 0.9144
150/150 [==============================] - 3s 17ms/step - loss: 0.2874 - acc: 0.9162 - val_loss: 0.3002 - val_acc: 0.8945
Epoch 9/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2587 - acc: 0.9155
 64/150 [===========>..................] - ETA: 1s - loss: 0.2389 - acc: 0.9312
 96/150 [==================>...........] - ETA: 0s - loss: 0.2591 - acc: 0.9193
128/150 [========================>.....] - ETA: 0s - loss: 0.2526 - acc: 0.9231
150/150 [==============================] - 3s 17ms/step - loss: 0.2463 - acc: 0.9267 - val_loss: 0.3428 - val_acc: 0.8839
Epoch 10/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2411 - acc: 0.9214
 64/150 [===========>..................] - ETA: 1s - loss: 0.2578 - acc: 0.9181
 96/150 [==================>...........] - ETA: 0s - loss: 0.2676 - acc: 0.9133
128/150 [========================>.....] - ETA: 0s - loss: 0.2602 - acc: 0.9191
150/150 [==============================] - 3s 17ms/step - loss: 0.2469 - acc: 0.9233 - val_loss: 0.2881 - val_acc: 0.9050
Epoch 11/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1247 - acc: 0.9687
 64/150 [===========>..................] - ETA: 1s - loss: 0.1564 - acc: 0.9500
 96/150 [==================>...........] - ETA: 0s - loss: 0.1756 - acc: 0.9473
128/150 [========================>.....] - ETA: 0s - loss: 0.1960 - acc: 0.9385
150/150 [==============================] - 3s 17ms/step - loss: 0.2051 - acc: 0.9365 - val_loss: 0.2967 - val_acc: 0.9129
Epoch 12/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2058 - acc: 0.9302
 64/150 [===========>..................] - ETA: 1s - loss: 0.1788 - acc: 0.9452
 96/150 [==================>...........] - ETA: 0s - loss: 0.1709 - acc: 0.9491
128/150 [========================>.....] - ETA: 0s - loss: 0.1847 - acc: 0.9428
150/150 [==============================] - 3s 17ms/step - loss: 0.1872 - acc: 0.9431 - val_loss: 0.2884 - val_acc: 0.9024
Computing...
Manual evaluation: (didn't understand why I made this)
True 7677
False 1394
True percentage 0.846323448352
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.94      0.95      7318
      B-ORG       0.40      0.47      0.43       296
     B-MISC       0.05      0.01      0.01       141
     I-MISC       0.27      0.19      0.22       154
      B-PER       0.70      0.66      0.68       438
      B-LOC       0.77      0.53      0.63       218
      I-ORG       0.35      0.31      0.33       151
      I-PER       0.65      0.35      0.45       214
      I-LOC       0.79      0.60      0.68       141

avg / total       0.88      0.85      0.86      9071

F-1 Score:
0.495715645827
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 167 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100205 unique words.
Found 94 unique chars.
Found 9 unique labels.
201 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 297
OOV word occurences: 457
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6413184     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,916,290
Trainable params: 6,916,290
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 150 samples, validate on 17 samples
Epoch 1/70

 32/150 [=====>........................] - ETA: 9s - loss: 2.4071 - acc: 0.0223
 64/150 [===========>..................] - ETA: 4s - loss: 1.6785 - acc: 0.4287
 96/150 [==================>...........] - ETA: 2s - loss: 2.0226 - acc: 0.5487
128/150 [========================>.....] - ETA: 0s - loss: 1.7476 - acc: 0.6133
150/150 [==============================] - 5s 32ms/step - loss: 1.6351 - acc: 0.6404 - val_loss: 0.9544 - val_acc: 0.7521
Epoch 2/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.8131 - acc: 0.8171
 64/150 [===========>..................] - ETA: 1s - loss: 0.7860 - acc: 0.8067
 96/150 [==================>...........] - ETA: 0s - loss: 0.7428 - acc: 0.8145
128/150 [========================>.....] - ETA: 0s - loss: 0.7462 - acc: 0.8070
150/150 [==============================] - 2s 16ms/step - loss: 0.7309 - acc: 0.8084 - val_loss: 0.8283 - val_acc: 0.7521
Epoch 3/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.5560 - acc: 0.8384
 64/150 [===========>..................] - ETA: 1s - loss: 0.6507 - acc: 0.8015
 96/150 [==================>...........] - ETA: 0s - loss: 0.6385 - acc: 0.8048
128/150 [========================>.....] - ETA: 0s - loss: 0.6014 - acc: 0.8170
150/150 [==============================] - 2s 16ms/step - loss: 0.5909 - acc: 0.8176 - val_loss: 0.6941 - val_acc: 0.7752
Epoch 4/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.5353 - acc: 0.8367
 64/150 [===========>..................] - ETA: 1s - loss: 0.4833 - acc: 0.8479
 96/150 [==================>...........] - ETA: 0s - loss: 0.4779 - acc: 0.8510
128/150 [========================>.....] - ETA: 0s - loss: 0.4567 - acc: 0.8574
150/150 [==============================] - 2s 15ms/step - loss: 0.4718 - acc: 0.8531 - val_loss: 0.6176 - val_acc: 0.8151
Epoch 5/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.4565 - acc: 0.8814
 64/150 [===========>..................] - ETA: 1s - loss: 0.5269 - acc: 0.8476
 96/150 [==================>...........] - ETA: 0s - loss: 0.5167 - acc: 0.8654
128/150 [========================>.....] - ETA: 0s - loss: 0.4752 - acc: 0.8754
150/150 [==============================] - 2s 16ms/step - loss: 0.4703 - acc: 0.8730 - val_loss: 0.5724 - val_acc: 0.8088
Epoch 6/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.3300 - acc: 0.8985
 64/150 [===========>..................] - ETA: 1s - loss: 0.3870 - acc: 0.8841
 96/150 [==================>...........] - ETA: 0s - loss: 0.3516 - acc: 0.8974
128/150 [========================>.....] - ETA: 0s - loss: 0.3460 - acc: 0.8989
150/150 [==============================] - 2s 15ms/step - loss: 0.3554 - acc: 0.8986 - val_loss: 0.5409 - val_acc: 0.8214
Epoch 7/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.3211 - acc: 0.9024
 64/150 [===========>..................] - ETA: 1s - loss: 0.2966 - acc: 0.9126
 96/150 [==================>...........] - ETA: 0s - loss: 0.2821 - acc: 0.9135
128/150 [========================>.....] - ETA: 0s - loss: 0.2900 - acc: 0.9156
150/150 [==============================] - 2s 15ms/step - loss: 0.3033 - acc: 0.9094 - val_loss: 0.4889 - val_acc: 0.8466
Epoch 8/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2453 - acc: 0.9396
 64/150 [===========>..................] - ETA: 1s - loss: 0.2788 - acc: 0.9235
 96/150 [==================>...........] - ETA: 0s - loss: 0.2625 - acc: 0.9267
128/150 [========================>.....] - ETA: 0s - loss: 0.2583 - acc: 0.9285
150/150 [==============================] - 2s 15ms/step - loss: 0.2617 - acc: 0.9261 - val_loss: 0.4893 - val_acc: 0.8424
Epoch 9/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2507 - acc: 0.9316
 64/150 [===========>..................] - ETA: 1s - loss: 0.2375 - acc: 0.9319
 96/150 [==================>...........] - ETA: 0s - loss: 0.2425 - acc: 0.9247
128/150 [========================>.....] - ETA: 0s - loss: 0.2492 - acc: 0.9227
150/150 [==============================] - 2s 15ms/step - loss: 0.2412 - acc: 0.9240 - val_loss: 0.4742 - val_acc: 0.8424
Epoch 10/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1870 - acc: 0.9616
 64/150 [===========>..................] - ETA: 1s - loss: 0.1783 - acc: 0.9564
 96/150 [==================>...........] - ETA: 0s - loss: 0.1986 - acc: 0.9438
128/150 [========================>.....] - ETA: 0s - loss: 0.2099 - acc: 0.9387
150/150 [==============================] - 2s 15ms/step - loss: 0.2139 - acc: 0.9373 - val_loss: 0.5281 - val_acc: 0.8256
Epoch 11/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2951 - acc: 0.9035
 64/150 [===========>..................] - ETA: 1s - loss: 0.2562 - acc: 0.9257
 96/150 [==================>...........] - ETA: 0s - loss: 0.2357 - acc: 0.9320
128/150 [========================>.....] - ETA: 0s - loss: 0.2248 - acc: 0.9341
150/150 [==============================] - 2s 15ms/step - loss: 0.2198 - acc: 0.9364 - val_loss: 0.4771 - val_acc: 0.8361
Computing...
Manual evaluation: (didn't understand why I made this)
True 7638
False 1433
True percentage 0.842024032631
Sklearn evaluation:
             precision    recall  f1-score   support

     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.14      0.01      0.01       154
          O       0.91      0.96      0.94      7318
      B-PER       0.78      0.54      0.64       438
      I-PER       0.73      0.35      0.47       214
      B-ORG       0.56      0.42      0.48       296
      B-LOC       0.81      0.44      0.57       218
      I-ORG       0.31      0.19      0.24       151
      I-LOC       0.76      0.31      0.44       141

avg / total       0.85      0.84      0.84      9071

F-1 Score:
0.8707250342
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 167 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100215 unique words.
Found 94 unique chars.
Found 9 unique labels.
211 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 295
OOV word occurences: 462
Padding...
Data padded!
Padding...
Data padded!
Padded until 67 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 67, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 67)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 67, 64)       6413824     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 67, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 67, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 67, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 67, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 67, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,916,930
Trainable params: 6,916,930
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 150 samples, validate on 17 samples
Epoch 1/70

 32/150 [=====>........................] - ETA: 9s - loss: 2.1675 - acc: 0.1878
 64/150 [===========>..................] - ETA: 4s - loss: 1.5787 - acc: 0.4772
 96/150 [==================>...........] - ETA: 2s - loss: 1.4750 - acc: 0.5819
128/150 [========================>.....] - ETA: 0s - loss: 1.3284 - acc: 0.6409
150/150 [==============================] - 5s 35ms/step - loss: 1.2758 - acc: 0.6550 - val_loss: 0.5899 - val_acc: 0.8251
Epoch 2/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.7080 - acc: 0.8114
 64/150 [===========>..................] - ETA: 1s - loss: 0.6745 - acc: 0.8193
 96/150 [==================>...........] - ETA: 0s - loss: 0.6960 - acc: 0.8036
128/150 [========================>.....] - ETA: 0s - loss: 0.6903 - acc: 0.8034
150/150 [==============================] - 3s 18ms/step - loss: 0.6775 - acc: 0.8070 - val_loss: 0.4367 - val_acc: 0.8747
Epoch 3/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.5758 - acc: 0.8315
 64/150 [===========>..................] - ETA: 1s - loss: 0.5704 - acc: 0.8277
 96/150 [==================>...........] - ETA: 0s - loss: 0.5594 - acc: 0.8317
128/150 [========================>.....] - ETA: 0s - loss: 0.5456 - acc: 0.8329
150/150 [==============================] - 3s 18ms/step - loss: 0.5514 - acc: 0.8308 - val_loss: 0.3703 - val_acc: 0.8818
Epoch 4/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.4610 - acc: 0.8436
 64/150 [===========>..................] - ETA: 1s - loss: 0.4714 - acc: 0.8527
 96/150 [==================>...........] - ETA: 0s - loss: 0.4553 - acc: 0.8568
128/150 [========================>.....] - ETA: 0s - loss: 0.4490 - acc: 0.8651
150/150 [==============================] - 3s 18ms/step - loss: 0.4693 - acc: 0.8551 - val_loss: 0.3793 - val_acc: 0.9149
Epoch 5/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.4646 - acc: 0.8799
 64/150 [===========>..................] - ETA: 1s - loss: 0.4059 - acc: 0.8842
 96/150 [==================>...........] - ETA: 0s - loss: 0.4020 - acc: 0.8812
128/150 [========================>.....] - ETA: 0s - loss: 0.4039 - acc: 0.8763
150/150 [==============================] - 3s 18ms/step - loss: 0.3923 - acc: 0.8797 - val_loss: 0.2999 - val_acc: 0.9125
Epoch 6/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.3977 - acc: 0.8696
 64/150 [===========>..................] - ETA: 1s - loss: 0.3651 - acc: 0.8861
 96/150 [==================>...........] - ETA: 0s - loss: 0.3584 - acc: 0.8865
128/150 [========================>.....] - ETA: 0s - loss: 0.3442 - acc: 0.8925
150/150 [==============================] - 3s 18ms/step - loss: 0.3517 - acc: 0.8906 - val_loss: 0.3026 - val_acc: 0.9078
Epoch 7/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.3070 - acc: 0.9073
 64/150 [===========>..................] - ETA: 1s - loss: 0.3448 - acc: 0.8984
 96/150 [==================>...........] - ETA: 0s - loss: 0.3210 - acc: 0.9069
128/150 [========================>.....] - ETA: 0s - loss: 0.3265 - acc: 0.9030
150/150 [==============================] - 3s 18ms/step - loss: 0.3259 - acc: 0.9044 - val_loss: 0.2380 - val_acc: 0.9244
Epoch 8/70

 32/150 [=====>........................] - ETA: 2s - loss: 0.2651 - acc: 0.9148
 64/150 [===========>..................] - ETA: 1s - loss: 0.2721 - acc: 0.9090
 96/150 [==================>...........] - ETA: 0s - loss: 0.2761 - acc: 0.9157
128/150 [========================>.....] - ETA: 0s - loss: 0.2698 - acc: 0.9160
150/150 [==============================] - 3s 18ms/step - loss: 0.2698 - acc: 0.9153 - val_loss: 0.2290 - val_acc: 0.9314
Epoch 9/70

 32/150 [=====>........................] - ETA: 2s - loss: 0.2808 - acc: 0.9126
 64/150 [===========>..................] - ETA: 1s - loss: 0.2687 - acc: 0.9134
 96/150 [==================>...........] - ETA: 0s - loss: 0.2571 - acc: 0.9184
128/150 [========================>.....] - ETA: 0s - loss: 0.2527 - acc: 0.9209
150/150 [==============================] - 3s 18ms/step - loss: 0.2509 - acc: 0.9207 - val_loss: 0.2598 - val_acc: 0.9314
Epoch 10/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2441 - acc: 0.9273
 64/150 [===========>..................] - ETA: 1s - loss: 0.2278 - acc: 0.9332
 96/150 [==================>...........] - ETA: 0s - loss: 0.2391 - acc: 0.9261
128/150 [========================>.....] - ETA: 0s - loss: 0.2231 - acc: 0.9296
150/150 [==============================] - 3s 18ms/step - loss: 0.2164 - acc: 0.9336 - val_loss: 0.1808 - val_acc: 0.9409
Epoch 11/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1809 - acc: 0.9381
 64/150 [===========>..................] - ETA: 1s - loss: 0.2094 - acc: 0.9323
 96/150 [==================>...........] - ETA: 0s - loss: 0.2060 - acc: 0.9319
128/150 [========================>.....] - ETA: 0s - loss: 0.2003 - acc: 0.9340
150/150 [==============================] - 3s 18ms/step - loss: 0.2098 - acc: 0.9314 - val_loss: 0.2153 - val_acc: 0.9338
Epoch 12/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2122 - acc: 0.9469
 64/150 [===========>..................] - ETA: 1s - loss: 0.1768 - acc: 0.9505
 96/150 [==================>...........] - ETA: 0s - loss: 0.1884 - acc: 0.9388
128/150 [========================>.....] - ETA: 0s - loss: 0.1873 - acc: 0.9432
150/150 [==============================] - 3s 18ms/step - loss: 0.1834 - acc: 0.9457 - val_loss: 0.1793 - val_acc: 0.9433
Epoch 13/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1754 - acc: 0.9463
 64/150 [===========>..................] - ETA: 1s - loss: 0.1604 - acc: 0.9499
 96/150 [==================>...........] - ETA: 0s - loss: 0.1618 - acc: 0.9541
128/150 [========================>.....] - ETA: 0s - loss: 0.1661 - acc: 0.9524
150/150 [==============================] - 3s 18ms/step - loss: 0.1673 - acc: 0.9518 - val_loss: 0.1791 - val_acc: 0.9433
Epoch 14/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1138 - acc: 0.9689
 64/150 [===========>..................] - ETA: 1s - loss: 0.1623 - acc: 0.9480
 96/150 [==================>...........] - ETA: 0s - loss: 0.1688 - acc: 0.9502
128/150 [========================>.....] - ETA: 0s - loss: 0.1619 - acc: 0.9523
150/150 [==============================] - 3s 18ms/step - loss: 0.1575 - acc: 0.9537 - val_loss: 0.1834 - val_acc: 0.9385
Epoch 15/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1765 - acc: 0.9446
 64/150 [===========>..................] - ETA: 1s - loss: 0.1559 - acc: 0.9476
 96/150 [==================>...........] - ETA: 0s - loss: 0.1355 - acc: 0.9584
128/150 [========================>.....] - ETA: 0s - loss: 0.1281 - acc: 0.9616
150/150 [==============================] - 3s 18ms/step - loss: 0.1340 - acc: 0.9605 - val_loss: 0.1901 - val_acc: 0.9314
Computing...
Manual evaluation: (didn't understand why I made this)
True 7762
False 1309
True percentage 0.855693969794
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.94      0.96      7318
      B-PER       0.82      0.66      0.73       438
      B-ORG       0.46      0.62      0.53       296
     B-MISC       0.23      0.23      0.23       141
     I-MISC       0.32      0.34      0.33       154
      I-ORG       0.34      0.39      0.36       151
      B-LOC       0.85      0.47      0.60       218
      I-LOC       0.89      0.47      0.61       141
      I-PER       0.76      0.55      0.64       214

avg / total       0.91      0.86      0.88      9071

F-1 Score:
0.539892021596
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 167 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100211 unique words.
Found 94 unique chars.
Found 9 unique labels.
207 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 301
OOV word occurences: 498
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6413568     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,916,674
Trainable params: 6,916,674
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 150 samples, validate on 17 samples
Epoch 1/70

 32/150 [=====>........................] - ETA: 9s - loss: 2.3275 - acc: 0.0087
 64/150 [===========>..................] - ETA: 4s - loss: 1.6872 - acc: 0.4024
 96/150 [==================>...........] - ETA: 2s - loss: 1.8806 - acc: 0.5458
128/150 [========================>.....] - ETA: 0s - loss: 1.6649 - acc: 0.6017
150/150 [==============================] - 5s 32ms/step - loss: 1.5399 - acc: 0.6337 - val_loss: 0.8495 - val_acc: 0.8237
Epoch 2/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.7976 - acc: 0.8377
 64/150 [===========>..................] - ETA: 1s - loss: 0.8117 - acc: 0.8176
 96/150 [==================>...........] - ETA: 0s - loss: 0.8167 - acc: 0.8047
128/150 [========================>.....] - ETA: 0s - loss: 0.7707 - acc: 0.8085
150/150 [==============================] - 2s 16ms/step - loss: 0.7463 - acc: 0.8115 - val_loss: 0.5961 - val_acc: 0.8347
Epoch 3/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.5106 - acc: 0.8398
 64/150 [===========>..................] - ETA: 1s - loss: 0.6221 - acc: 0.8042
 96/150 [==================>...........] - ETA: 0s - loss: 0.5926 - acc: 0.8135
128/150 [========================>.....] - ETA: 0s - loss: 0.5646 - acc: 0.8204
150/150 [==============================] - 2s 16ms/step - loss: 0.5417 - acc: 0.8288 - val_loss: 0.5273 - val_acc: 0.8430
Epoch 4/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.5049 - acc: 0.8445
 64/150 [===========>..................] - ETA: 1s - loss: 0.4706 - acc: 0.8646
 96/150 [==================>...........] - ETA: 0s - loss: 0.4712 - acc: 0.8546
128/150 [========================>.....] - ETA: 0s - loss: 0.4727 - acc: 0.8614
150/150 [==============================] - 2s 16ms/step - loss: 0.4722 - acc: 0.8584 - val_loss: 0.4966 - val_acc: 0.8567
Epoch 5/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.3677 - acc: 0.9091
 64/150 [===========>..................] - ETA: 1s - loss: 0.3923 - acc: 0.8860
 96/150 [==================>...........] - ETA: 0s - loss: 0.4152 - acc: 0.8798
128/150 [========================>.....] - ETA: 0s - loss: 0.3986 - acc: 0.8853
150/150 [==============================] - 2s 15ms/step - loss: 0.3797 - acc: 0.8896 - val_loss: 0.4318 - val_acc: 0.8733
Epoch 6/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.3249 - acc: 0.9103
 64/150 [===========>..................] - ETA: 1s - loss: 0.3359 - acc: 0.8981
 96/150 [==================>...........] - ETA: 0s - loss: 0.3210 - acc: 0.9062
128/150 [========================>.....] - ETA: 0s - loss: 0.3273 - acc: 0.9034
150/150 [==============================] - 2s 16ms/step - loss: 0.3219 - acc: 0.9080 - val_loss: 0.4228 - val_acc: 0.8595
Epoch 7/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2710 - acc: 0.9267
 64/150 [===========>..................] - ETA: 1s - loss: 0.3020 - acc: 0.9114
 96/150 [==================>...........] - ETA: 0s - loss: 0.2772 - acc: 0.9217
128/150 [========================>.....] - ETA: 0s - loss: 0.2757 - acc: 0.9212
150/150 [==============================] - 2s 15ms/step - loss: 0.2749 - acc: 0.9228 - val_loss: 0.4044 - val_acc: 0.8733
Epoch 8/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.2667 - acc: 0.9249
 64/150 [===========>..................] - ETA: 1s - loss: 0.2302 - acc: 0.9359
 96/150 [==================>...........] - ETA: 0s - loss: 0.2377 - acc: 0.9303
128/150 [========================>.....] - ETA: 0s - loss: 0.2440 - acc: 0.9278
150/150 [==============================] - 2s 15ms/step - loss: 0.2374 - acc: 0.9300 - val_loss: 0.3630 - val_acc: 0.8953
Epoch 9/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1832 - acc: 0.9501
 64/150 [===========>..................] - ETA: 1s - loss: 0.2220 - acc: 0.9328
 96/150 [==================>...........] - ETA: 0s - loss: 0.2384 - acc: 0.9313
128/150 [========================>.....] - ETA: 0s - loss: 0.2303 - acc: 0.9334
150/150 [==============================] - 2s 15ms/step - loss: 0.2414 - acc: 0.9296 - val_loss: 0.3605 - val_acc: 0.8926
Epoch 10/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1633 - acc: 0.9561
 64/150 [===========>..................] - ETA: 1s - loss: 0.1850 - acc: 0.9454
 96/150 [==================>...........] - ETA: 0s - loss: 0.2044 - acc: 0.9397
128/150 [========================>.....] - ETA: 0s - loss: 0.1986 - acc: 0.9431
150/150 [==============================] - 2s 15ms/step - loss: 0.1905 - acc: 0.9468 - val_loss: 0.3310 - val_acc: 0.9036
Epoch 11/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1570 - acc: 0.9564
 64/150 [===========>..................] - ETA: 1s - loss: 0.1751 - acc: 0.9524
 96/150 [==================>...........] - ETA: 0s - loss: 0.1836 - acc: 0.9483
128/150 [========================>.....] - ETA: 0s - loss: 0.1805 - acc: 0.9496
150/150 [==============================] - 2s 15ms/step - loss: 0.1766 - acc: 0.9499 - val_loss: 0.3305 - val_acc: 0.9036
Epoch 12/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1387 - acc: 0.9722
 64/150 [===========>..................] - ETA: 1s - loss: 0.1507 - acc: 0.9586
 96/150 [==================>...........] - ETA: 0s - loss: 0.1612 - acc: 0.9560
128/150 [========================>.....] - ETA: 0s - loss: 0.1597 - acc: 0.9548
150/150 [==============================] - 2s 15ms/step - loss: 0.1514 - acc: 0.9570 - val_loss: 0.3232 - val_acc: 0.9118
Epoch 13/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1464 - acc: 0.9570
 64/150 [===========>..................] - ETA: 1s - loss: 0.1276 - acc: 0.9613
 96/150 [==================>...........] - ETA: 0s - loss: 0.1351 - acc: 0.9601
128/150 [========================>.....] - ETA: 0s - loss: 0.1356 - acc: 0.9601
150/150 [==============================] - 2s 15ms/step - loss: 0.1406 - acc: 0.9591 - val_loss: 0.3209 - val_acc: 0.9008
Epoch 14/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1221 - acc: 0.9597
 64/150 [===========>..................] - ETA: 1s - loss: 0.1354 - acc: 0.9639
 96/150 [==================>...........] - ETA: 0s - loss: 0.1251 - acc: 0.9662
128/150 [========================>.....] - ETA: 0s - loss: 0.1297 - acc: 0.9636
150/150 [==============================] - 2s 15ms/step - loss: 0.1377 - acc: 0.9615 - val_loss: 0.3258 - val_acc: 0.8981
Epoch 15/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1354 - acc: 0.9594
 64/150 [===========>..................] - ETA: 1s - loss: 0.1255 - acc: 0.9628
 96/150 [==================>...........] - ETA: 0s - loss: 0.1310 - acc: 0.9618
128/150 [========================>.....] - ETA: 0s - loss: 0.1188 - acc: 0.9677
150/150 [==============================] - 2s 15ms/step - loss: 0.1171 - acc: 0.9673 - val_loss: 0.3063 - val_acc: 0.9063
Epoch 16/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1014 - acc: 0.9641
 64/150 [===========>..................] - ETA: 1s - loss: 0.1235 - acc: 0.9589
 96/150 [==================>...........] - ETA: 0s - loss: 0.1200 - acc: 0.9660
128/150 [========================>.....] - ETA: 0s - loss: 0.1126 - acc: 0.9667
150/150 [==============================] - 2s 15ms/step - loss: 0.1166 - acc: 0.9661 - val_loss: 0.3164 - val_acc: 0.9036
Epoch 17/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1033 - acc: 0.9628
 64/150 [===========>..................] - ETA: 1s - loss: 0.1058 - acc: 0.9670
 96/150 [==================>...........] - ETA: 0s - loss: 0.1164 - acc: 0.9651
128/150 [========================>.....] - ETA: 0s - loss: 0.1117 - acc: 0.9676
150/150 [==============================] - 2s 15ms/step - loss: 0.1036 - acc: 0.9698 - val_loss: 0.3058 - val_acc: 0.8981
Epoch 18/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.0990 - acc: 0.9682
 64/150 [===========>..................] - ETA: 1s - loss: 0.0855 - acc: 0.9766
 96/150 [==================>...........] - ETA: 0s - loss: 0.0948 - acc: 0.9720
128/150 [========================>.....] - ETA: 0s - loss: 0.1090 - acc: 0.9665
150/150 [==============================] - 2s 15ms/step - loss: 0.1042 - acc: 0.9679 - val_loss: 0.3086 - val_acc: 0.9063
Epoch 19/70

 32/150 [=====>........................] - ETA: 1s - loss: 0.1013 - acc: 0.9613
 64/150 [===========>..................] - ETA: 1s - loss: 0.0864 - acc: 0.9686
 96/150 [==================>...........] - ETA: 0s - loss: 0.1040 - acc: 0.9641
128/150 [========================>.....] - ETA: 0s - loss: 0.1061 - acc: 0.9663
150/150 [==============================] - 2s 15ms/step - loss: 0.1010 - acc: 0.9690 - val_loss: 0.3066 - val_acc: 0.9036
Computing...
Manual evaluation: (didn't understand why I made this)
True 7803
False 1268
True percentage 0.860213868372
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.96      0.95      7318
      B-ORG       0.62      0.47      0.54       296
      I-ORG       0.32      0.21      0.26       151
      B-PER       0.83      0.63      0.72       438
     B-MISC       0.36      0.07      0.12       141
     I-MISC       0.32      0.16      0.21       154
      B-LOC       0.77      0.57      0.65       218
      I-LOC       0.80      0.52      0.64       141
      I-PER       0.65      0.57      0.60       214

avg / total       0.89      0.86      0.87      9071

F-1 Score:
0.543301759134
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 83 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100103 unique words.
Found 94 unique chars.
Found 9 unique labels.
99 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 309
OOV word occurences: 517
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6406656     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,909,762
Trainable params: 6,909,762
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 74 samples, validate on 9 samples
Epoch 1/70

32/74 [===========>..................] - ETA: 3s - loss: 2.4874 - acc: 0.0421
64/74 [========================>.....] - ETA: 0s - loss: 1.7790 - acc: 0.4278
74/74 [==============================] - 4s 50ms/step - loss: 1.8508 - acc: 0.4823 - val_loss: 1.7124 - val_acc: 0.6218
Epoch 2/70

32/74 [===========>..................] - ETA: 0s - loss: 0.8124 - acc: 0.8246
64/74 [========================>.....] - ETA: 0s - loss: 0.9021 - acc: 0.8030
74/74 [==============================] - 1s 18ms/step - loss: 0.9305 - acc: 0.7983 - val_loss: 1.3742 - val_acc: 0.6218
Epoch 3/70

32/74 [===========>..................] - ETA: 0s - loss: 0.6869 - acc: 0.8062
64/74 [========================>.....] - ETA: 0s - loss: 0.6851 - acc: 0.8058
74/74 [==============================] - 1s 17ms/step - loss: 0.6993 - acc: 0.8002 - val_loss: 1.2401 - val_acc: 0.6176
Epoch 4/70

32/74 [===========>..................] - ETA: 0s - loss: 0.6000 - acc: 0.8132
64/74 [========================>.....] - ETA: 0s - loss: 0.6243 - acc: 0.7978
74/74 [==============================] - 1s 17ms/step - loss: 0.6160 - acc: 0.8019 - val_loss: 1.2309 - val_acc: 0.6471
Epoch 5/70

32/74 [===========>..................] - ETA: 0s - loss: 0.5327 - acc: 0.8231
64/74 [========================>.....] - ETA: 0s - loss: 0.5332 - acc: 0.8265
74/74 [==============================] - 1s 17ms/step - loss: 0.5335 - acc: 0.8231 - val_loss: 1.1394 - val_acc: 0.6681
Epoch 6/70

32/74 [===========>..................] - ETA: 0s - loss: 0.4863 - acc: 0.8556
64/74 [========================>.....] - ETA: 0s - loss: 0.4440 - acc: 0.8567
74/74 [==============================] - 1s 17ms/step - loss: 0.4583 - acc: 0.8533 - val_loss: 1.1203 - val_acc: 0.6765
Epoch 7/70

32/74 [===========>..................] - ETA: 0s - loss: 0.3769 - acc: 0.8701
64/74 [========================>.....] - ETA: 0s - loss: 0.4472 - acc: 0.8613
74/74 [==============================] - 1s 17ms/step - loss: 0.4351 - acc: 0.8625 - val_loss: 0.9789 - val_acc: 0.7017
Epoch 8/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2913 - acc: 0.9146
64/74 [========================>.....] - ETA: 0s - loss: 0.3423 - acc: 0.8885
74/74 [==============================] - 1s 17ms/step - loss: 0.3511 - acc: 0.8860 - val_loss: 0.8702 - val_acc: 0.7269
Epoch 9/70

32/74 [===========>..................] - ETA: 0s - loss: 0.3398 - acc: 0.8986
64/74 [========================>.....] - ETA: 0s - loss: 0.3187 - acc: 0.9000
74/74 [==============================] - 1s 17ms/step - loss: 0.3220 - acc: 0.9004 - val_loss: 0.9380 - val_acc: 0.7185
Epoch 10/70

32/74 [===========>..................] - ETA: 0s - loss: 0.3274 - acc: 0.8803
64/74 [========================>.....] - ETA: 0s - loss: 0.3001 - acc: 0.8998
74/74 [==============================] - 1s 17ms/step - loss: 0.2879 - acc: 0.9059 - val_loss: 0.9072 - val_acc: 0.7395
Computing...
Manual evaluation: (didn't understand why I made this)
True 7415
False 1656
True percentage 0.817440194025
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.91      0.96      0.93      7318
      B-PER       0.68      0.41      0.51       438
      B-LOC       0.84      0.32      0.46       218
      B-ORG       0.49      0.35      0.41       296
      I-ORG       0.24      0.45      0.32       151
      I-PER       0.00      0.00      0.00       214
      I-LOC       0.88      0.05      0.09       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.12      0.01      0.01       154

avg / total       0.82      0.82      0.81      9071

F-1 Score:
0.327566320646
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 83 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100138 unique words.
Found 94 unique chars.
Found 9 unique labels.
134 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 309
OOV word occurences: 566
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6408896     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,912,002
Trainable params: 6,912,002
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 74 samples, validate on 9 samples
Epoch 1/70

32/74 [===========>..................] - ETA: 4s - loss: 2.4868 - acc: 0.0484
64/74 [========================>.....] - ETA: 0s - loss: 1.6875 - acc: 0.4238
74/74 [==============================] - 4s 56ms/step - loss: 1.7310 - acc: 0.4721 - val_loss: 1.3958 - val_acc: 0.7800
Epoch 2/70

32/74 [===========>..................] - ETA: 0s - loss: 1.3287 - acc: 0.7995
64/74 [========================>.....] - ETA: 0s - loss: 1.0304 - acc: 0.8064
74/74 [==============================] - 1s 17ms/step - loss: 0.9825 - acc: 0.8077 - val_loss: 0.9475 - val_acc: 0.7800
Epoch 3/70

32/74 [===========>..................] - ETA: 0s - loss: 0.7260 - acc: 0.7998
64/74 [========================>.....] - ETA: 0s - loss: 0.7058 - acc: 0.8042
74/74 [==============================] - 1s 17ms/step - loss: 0.6762 - acc: 0.8126 - val_loss: 0.9020 - val_acc: 0.7800
Epoch 4/70

32/74 [===========>..................] - ETA: 0s - loss: 0.6299 - acc: 0.8107
64/74 [========================>.....] - ETA: 0s - loss: 0.6109 - acc: 0.8141
74/74 [==============================] - 1s 18ms/step - loss: 0.6134 - acc: 0.8137 - val_loss: 0.8780 - val_acc: 0.7900
Epoch 5/70

32/74 [===========>..................] - ETA: 0s - loss: 0.5947 - acc: 0.8106
64/74 [========================>.....] - ETA: 0s - loss: 0.5583 - acc: 0.8226
74/74 [==============================] - 1s 17ms/step - loss: 0.5488 - acc: 0.8240 - val_loss: 0.7955 - val_acc: 0.7950
Epoch 6/70

32/74 [===========>..................] - ETA: 0s - loss: 0.4760 - acc: 0.8505
64/74 [========================>.....] - ETA: 0s - loss: 0.4931 - acc: 0.8471
74/74 [==============================] - 1s 16ms/step - loss: 0.4882 - acc: 0.8505 - val_loss: 0.7514 - val_acc: 0.8050
Epoch 7/70

32/74 [===========>..................] - ETA: 0s - loss: 0.4425 - acc: 0.8507
64/74 [========================>.....] - ETA: 0s - loss: 0.4241 - acc: 0.8660
74/74 [==============================] - 1s 17ms/step - loss: 0.4292 - acc: 0.8652 - val_loss: 0.7591 - val_acc: 0.8050
Epoch 8/70

32/74 [===========>..................] - ETA: 0s - loss: 0.4507 - acc: 0.8642
64/74 [========================>.....] - ETA: 0s - loss: 0.4431 - acc: 0.8791
74/74 [==============================] - 1s 17ms/step - loss: 0.4333 - acc: 0.8793 - val_loss: 0.6765 - val_acc: 0.8050
Epoch 9/70

32/74 [===========>..................] - ETA: 0s - loss: 0.3259 - acc: 0.9025
64/74 [========================>.....] - ETA: 0s - loss: 0.3558 - acc: 0.8892
74/74 [==============================] - 1s 17ms/step - loss: 0.3546 - acc: 0.8906 - val_loss: 0.6016 - val_acc: 0.8150
Epoch 10/70

32/74 [===========>..................] - ETA: 0s - loss: 0.3262 - acc: 0.8910
64/74 [========================>.....] - ETA: 0s - loss: 0.3268 - acc: 0.8950
74/74 [==============================] - 1s 16ms/step - loss: 0.3241 - acc: 0.8962 - val_loss: 0.6072 - val_acc: 0.8150
Epoch 11/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2961 - acc: 0.9029
64/74 [========================>.....] - ETA: 0s - loss: 0.2942 - acc: 0.9052
74/74 [==============================] - 1s 16ms/step - loss: 0.2976 - acc: 0.9051 - val_loss: 0.5986 - val_acc: 0.8250
Epoch 12/70

32/74 [===========>..................] - ETA: 0s - loss: 0.3219 - acc: 0.8851
64/74 [========================>.....] - ETA: 0s - loss: 0.3062 - acc: 0.9017
74/74 [==============================] - 1s 17ms/step - loss: 0.3161 - acc: 0.9011 - val_loss: 0.4030 - val_acc: 0.8850
Epoch 13/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2740 - acc: 0.9372
64/74 [========================>.....] - ETA: 0s - loss: 0.2743 - acc: 0.9321
74/74 [==============================] - 1s 16ms/step - loss: 0.2645 - acc: 0.9338 - val_loss: 0.4724 - val_acc: 0.8500
Epoch 14/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2338 - acc: 0.9260
64/74 [========================>.....] - ETA: 0s - loss: 0.2219 - acc: 0.9350
74/74 [==============================] - 1s 17ms/step - loss: 0.2309 - acc: 0.9337 - val_loss: 0.3995 - val_acc: 0.8750
Epoch 15/70

32/74 [===========>..................] - ETA: 0s - loss: 0.1931 - acc: 0.9463
64/74 [========================>.....] - ETA: 0s - loss: 0.2036 - acc: 0.9440
74/74 [==============================] - 1s 16ms/step - loss: 0.2111 - acc: 0.9400 - val_loss: 0.4842 - val_acc: 0.8450
Epoch 16/70

32/74 [===========>..................] - ETA: 0s - loss: 0.1840 - acc: 0.9479
64/74 [========================>.....] - ETA: 0s - loss: 0.1950 - acc: 0.9439
74/74 [==============================] - 1s 17ms/step - loss: 0.2037 - acc: 0.9407 - val_loss: 0.3887 - val_acc: 0.8850
Epoch 17/70

32/74 [===========>..................] - ETA: 0s - loss: 0.1706 - acc: 0.9565
64/74 [========================>.....] - ETA: 0s - loss: 0.1827 - acc: 0.9549
74/74 [==============================] - 1s 17ms/step - loss: 0.1790 - acc: 0.9545 - val_loss: 0.3619 - val_acc: 0.8950
Epoch 18/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2038 - acc: 0.9483
64/74 [========================>.....] - ETA: 0s - loss: 0.1677 - acc: 0.9589
74/74 [==============================] - 1s 17ms/step - loss: 0.1686 - acc: 0.9583 - val_loss: 0.4323 - val_acc: 0.8750
Epoch 19/70

32/74 [===========>..................] - ETA: 0s - loss: 0.1615 - acc: 0.9440
64/74 [========================>.....] - ETA: 0s - loss: 0.1561 - acc: 0.9488
74/74 [==============================] - 1s 17ms/step - loss: 0.1472 - acc: 0.9527 - val_loss: 0.4037 - val_acc: 0.8900
Computing...
Manual evaluation: (didn't understand why I made this)
True 7567
False 1504
True percentage 0.834196891192
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.95      0.94      7318
      B-ORG       0.64      0.45      0.53       296
      B-LOC       0.79      0.47      0.59       218
      I-ORG       0.29      0.22      0.25       151
     B-MISC       0.15      0.02      0.04       141
     I-MISC       0.35      0.05      0.09       154
      B-PER       0.59      0.53      0.56       438
      I-PER       0.51      0.32      0.40       214
      I-LOC       0.79      0.40      0.54       141

avg / total       0.86      0.83      0.84      9071

F-1 Score:
0.447645818693
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 83 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100091 unique words.
Found 94 unique chars.
Found 9 unique labels.
87 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 318
OOV word occurences: 550
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6405888     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,908,994
Trainable params: 6,908,994
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 74 samples, validate on 9 samples
Epoch 1/70

32/74 [===========>..................] - ETA: 3s - loss: 2.5214 - acc: 0.0101
64/74 [========================>.....] - ETA: 0s - loss: 1.6321 - acc: 0.4292
74/74 [==============================] - 4s 50ms/step - loss: 1.7725 - acc: 0.4783 - val_loss: 1.1114 - val_acc: 0.7872
Epoch 2/70

32/74 [===========>..................] - ETA: 0s - loss: 0.9511 - acc: 0.8500
64/74 [========================>.....] - ETA: 0s - loss: 0.8859 - acc: 0.8331
74/74 [==============================] - 1s 18ms/step - loss: 0.8762 - acc: 0.8287 - val_loss: 0.7455 - val_acc: 0.7872
Epoch 3/70

32/74 [===========>..................] - ETA: 0s - loss: 0.6432 - acc: 0.8286
64/74 [========================>.....] - ETA: 0s - loss: 0.6277 - acc: 0.8319
74/74 [==============================] - 1s 18ms/step - loss: 0.6383 - acc: 0.8291 - val_loss: 0.6960 - val_acc: 0.7872
Epoch 4/70

32/74 [===========>..................] - ETA: 0s - loss: 0.6636 - acc: 0.8098
64/74 [========================>.....] - ETA: 0s - loss: 0.5849 - acc: 0.8319
74/74 [==============================] - 1s 17ms/step - loss: 0.5827 - acc: 0.8320 - val_loss: 0.6532 - val_acc: 0.7979
Epoch 5/70

32/74 [===========>..................] - ETA: 0s - loss: 0.5493 - acc: 0.8385
64/74 [========================>.....] - ETA: 0s - loss: 0.5448 - acc: 0.8352
74/74 [==============================] - 1s 17ms/step - loss: 0.5275 - acc: 0.8407 - val_loss: 0.5863 - val_acc: 0.8032
Epoch 6/70

32/74 [===========>..................] - ETA: 0s - loss: 0.5594 - acc: 0.8226
64/74 [========================>.....] - ETA: 0s - loss: 0.4766 - acc: 0.8525
74/74 [==============================] - 1s 17ms/step - loss: 0.4688 - acc: 0.8550 - val_loss: 0.5288 - val_acc: 0.8298
Epoch 7/70

32/74 [===========>..................] - ETA: 0s - loss: 0.3704 - acc: 0.8981
64/74 [========================>.....] - ETA: 0s - loss: 0.4191 - acc: 0.8685
74/74 [==============================] - 1s 17ms/step - loss: 0.4177 - acc: 0.8699 - val_loss: 0.4577 - val_acc: 0.8457
Epoch 8/70

32/74 [===========>..................] - ETA: 0s - loss: 0.3718 - acc: 0.8776
64/74 [========================>.....] - ETA: 0s - loss: 0.3899 - acc: 0.8726
74/74 [==============================] - 1s 17ms/step - loss: 0.3679 - acc: 0.8845 - val_loss: 0.5761 - val_acc: 0.8085
Epoch 9/70

32/74 [===========>..................] - ETA: 0s - loss: 0.4463 - acc: 0.8553
64/74 [========================>.....] - ETA: 0s - loss: 0.4396 - acc: 0.8801
74/74 [==============================] - 1s 17ms/step - loss: 0.4297 - acc: 0.8807 - val_loss: 0.3880 - val_acc: 0.8670
Epoch 10/70

32/74 [===========>..................] - ETA: 0s - loss: 0.3249 - acc: 0.8965
64/74 [========================>.....] - ETA: 0s - loss: 0.3035 - acc: 0.9069
74/74 [==============================] - 1s 17ms/step - loss: 0.3112 - acc: 0.9043 - val_loss: 0.3758 - val_acc: 0.8723
Epoch 11/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2838 - acc: 0.9130
64/74 [========================>.....] - ETA: 0s - loss: 0.2857 - acc: 0.9185
74/74 [==============================] - 1s 17ms/step - loss: 0.2796 - acc: 0.9204 - val_loss: 0.3553 - val_acc: 0.8777
Epoch 12/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2044 - acc: 0.9409
64/74 [========================>.....] - ETA: 0s - loss: 0.2358 - acc: 0.9361
74/74 [==============================] - 1s 16ms/step - loss: 0.2567 - acc: 0.9262 - val_loss: 0.4488 - val_acc: 0.8723
Epoch 13/70

32/74 [===========>..................] - ETA: 0s - loss: 0.3213 - acc: 0.8953
64/74 [========================>.....] - ETA: 0s - loss: 0.2745 - acc: 0.9136
74/74 [==============================] - 1s 17ms/step - loss: 0.2646 - acc: 0.9178 - val_loss: 0.3150 - val_acc: 0.8989
Epoch 14/70

32/74 [===========>..................] - ETA: 0s - loss: 0.1799 - acc: 0.9607
64/74 [========================>.....] - ETA: 0s - loss: 0.2074 - acc: 0.9423
74/74 [==============================] - 1s 16ms/step - loss: 0.2019 - acc: 0.9453 - val_loss: 0.3068 - val_acc: 0.8883
Epoch 15/70

32/74 [===========>..................] - ETA: 0s - loss: 0.1934 - acc: 0.9402
64/74 [========================>.....] - ETA: 0s - loss: 0.1852 - acc: 0.9438
74/74 [==============================] - 1s 17ms/step - loss: 0.1825 - acc: 0.9466 - val_loss: 0.3157 - val_acc: 0.9043
Epoch 16/70

32/74 [===========>..................] - ETA: 0s - loss: 0.1901 - acc: 0.9500
64/74 [========================>.....] - ETA: 0s - loss: 0.1847 - acc: 0.9501
74/74 [==============================] - 1s 16ms/step - loss: 0.1763 - acc: 0.9518 - val_loss: 0.2989 - val_acc: 0.9043
Epoch 17/70

32/74 [===========>..................] - ETA: 0s - loss: 0.1538 - acc: 0.9579
64/74 [========================>.....] - ETA: 0s - loss: 0.1559 - acc: 0.9601
74/74 [==============================] - 1s 16ms/step - loss: 0.1592 - acc: 0.9596 - val_loss: 0.2780 - val_acc: 0.9255
Epoch 18/70

32/74 [===========>..................] - ETA: 0s - loss: 0.1233 - acc: 0.9686
64/74 [========================>.....] - ETA: 0s - loss: 0.1502 - acc: 0.9571
74/74 [==============================] - 1s 17ms/step - loss: 0.1519 - acc: 0.9564 - val_loss: 0.2901 - val_acc: 0.8989
Epoch 19/70

32/74 [===========>..................] - ETA: 0s - loss: 0.1566 - acc: 0.9503
64/74 [========================>.....] - ETA: 0s - loss: 0.1405 - acc: 0.9601
74/74 [==============================] - 1s 16ms/step - loss: 0.1415 - acc: 0.9593 - val_loss: 0.2611 - val_acc: 0.9149
Epoch 20/70

32/74 [===========>..................] - ETA: 0s - loss: 0.0969 - acc: 0.9819
64/74 [========================>.....] - ETA: 0s - loss: 0.1306 - acc: 0.9689
74/74 [==============================] - 1s 16ms/step - loss: 0.1227 - acc: 0.9725 - val_loss: 0.2785 - val_acc: 0.9096
Epoch 21/70

32/74 [===========>..................] - ETA: 0s - loss: 0.1235 - acc: 0.9646
64/74 [========================>.....] - ETA: 0s - loss: 0.1233 - acc: 0.9654
74/74 [==============================] - 1s 16ms/step - loss: 0.1259 - acc: 0.9652 - val_loss: 0.2647 - val_acc: 0.9096
Computing...
Manual evaluation: (didn't understand why I made this)
True 7543
False 1528
True percentage 0.831551096902
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.92      0.95      0.93      7318
      B-PER       0.77      0.55      0.64       438
      B-ORG       0.47      0.38      0.42       296
      I-ORG       0.38      0.17      0.23       151
      I-PER       0.67      0.39      0.49       214
      B-LOC       0.83      0.44      0.57       218
      I-LOC       0.90      0.32      0.47       141
     B-MISC       0.14      0.05      0.07       141
     I-MISC       0.12      0.03      0.04       154

avg / total       0.86      0.83      0.84      9071

F-1 Score:
0.446637426901
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 83 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100110 unique words.
Found 94 unique chars.
Found 9 unique labels.
106 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 308
OOV word occurences: 492
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6407104     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,910,210
Trainable params: 6,910,210
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 74 samples, validate on 9 samples
Epoch 1/70

32/74 [===========>..................] - ETA: 3s - loss: 1.8743 - acc: 0.7847
64/74 [========================>.....] - ETA: 0s - loss: 1.4079 - acc: 0.7922
74/74 [==============================] - 4s 50ms/step - loss: 1.3698 - acc: 0.7974 - val_loss: 0.9227 - val_acc: 0.7909
Epoch 2/70

32/74 [===========>..................] - ETA: 0s - loss: 0.8512 - acc: 0.8043
64/74 [========================>.....] - ETA: 0s - loss: 0.8448 - acc: 0.8041
74/74 [==============================] - 1s 17ms/step - loss: 0.8122 - acc: 0.8086 - val_loss: 0.7249 - val_acc: 0.7909
Epoch 3/70

32/74 [===========>..................] - ETA: 0s - loss: 0.7106 - acc: 0.7933
64/74 [========================>.....] - ETA: 0s - loss: 0.6511 - acc: 0.8115
74/74 [==============================] - 1s 17ms/step - loss: 0.6517 - acc: 0.8109 - val_loss: 0.6524 - val_acc: 0.8023
Epoch 4/70

32/74 [===========>..................] - ETA: 0s - loss: 0.6109 - acc: 0.8117
64/74 [========================>.....] - ETA: 0s - loss: 0.5515 - acc: 0.8210
74/74 [==============================] - 1s 17ms/step - loss: 0.5501 - acc: 0.8213 - val_loss: 0.6144 - val_acc: 0.8061
Epoch 5/70

32/74 [===========>..................] - ETA: 0s - loss: 0.4744 - acc: 0.8429
64/74 [========================>.....] - ETA: 0s - loss: 0.4818 - acc: 0.8661
74/74 [==============================] - 1s 18ms/step - loss: 0.4847 - acc: 0.8609 - val_loss: 0.6134 - val_acc: 0.8517
Epoch 6/70

32/74 [===========>..................] - ETA: 0s - loss: 0.5102 - acc: 0.8934
64/74 [========================>.....] - ETA: 0s - loss: 0.4530 - acc: 0.8859
74/74 [==============================] - 1s 17ms/step - loss: 0.4476 - acc: 0.8857 - val_loss: 0.4753 - val_acc: 0.8783
Epoch 7/70

32/74 [===========>..................] - ETA: 0s - loss: 0.3528 - acc: 0.9210
64/74 [========================>.....] - ETA: 0s - loss: 0.3672 - acc: 0.9014
74/74 [==============================] - 1s 17ms/step - loss: 0.3625 - acc: 0.9041 - val_loss: 0.4364 - val_acc: 0.8669
Epoch 8/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2813 - acc: 0.9262
64/74 [========================>.....] - ETA: 0s - loss: 0.3159 - acc: 0.9082
74/74 [==============================] - 1s 17ms/step - loss: 0.3119 - acc: 0.9101 - val_loss: 0.4543 - val_acc: 0.8555
Epoch 9/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2853 - acc: 0.9087
64/74 [========================>.....] - ETA: 0s - loss: 0.3007 - acc: 0.9174
74/74 [==============================] - 1s 16ms/step - loss: 0.2928 - acc: 0.9217 - val_loss: 0.3907 - val_acc: 0.8821
Epoch 10/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2725 - acc: 0.9232
64/74 [========================>.....] - ETA: 0s - loss: 0.2505 - acc: 0.9281
74/74 [==============================] - 1s 17ms/step - loss: 0.2432 - acc: 0.9336 - val_loss: 0.3532 - val_acc: 0.8783
Epoch 11/70

32/74 [===========>..................] - ETA: 0s - loss: 0.1906 - acc: 0.9502
64/74 [========================>.....] - ETA: 0s - loss: 0.2311 - acc: 0.9314
74/74 [==============================] - 1s 17ms/step - loss: 0.2356 - acc: 0.9321 - val_loss: 0.3822 - val_acc: 0.8707
Epoch 12/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2267 - acc: 0.9262
64/74 [========================>.....] - ETA: 0s - loss: 0.2097 - acc: 0.9380
74/74 [==============================] - 1s 17ms/step - loss: 0.2112 - acc: 0.9383 - val_loss: 0.3794 - val_acc: 0.8593
Computing...
Manual evaluation: (didn't understand why I made this)
True 7649
False 1422
True percentage 0.843236688347
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.96      0.94      7318
     B-MISC       0.10      0.01      0.01       141
     I-MISC       0.33      0.05      0.09       154
      B-ORG       0.49      0.47      0.48       296
      I-ORG       0.29      0.14      0.19       151
      B-PER       0.69      0.55      0.61       438
      I-PER       0.66      0.41      0.50       214
      B-LOC       0.91      0.40      0.55       218
      I-LOC       0.93      0.50      0.65       141

avg / total       0.86      0.84      0.85      9071

F-1 Score:
0.469664525339
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 83 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100107 unique words.
Found 94 unique chars.
Found 9 unique labels.
103 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 314
OOV word occurences: 593
Padding...
Data padded!
Padding...
Data padded!
Padded until 63 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 63 tokens.
Padded until 24 chars.
Padded until 63 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 63, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 63)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 63, 64)       6406912     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 63, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 63, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 63, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 63, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 63, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,910,018
Trainable params: 6,910,018
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 74 samples, validate on 9 samples
Epoch 1/70

32/74 [===========>..................] - ETA: 3s - loss: 2.1800 - acc: 0.0317
64/74 [========================>.....] - ETA: 0s - loss: 1.6163 - acc: 0.3974
74/74 [==============================] - 4s 51ms/step - loss: 1.5415 - acc: 0.4497 - val_loss: 1.5601 - val_acc: 0.7151
Epoch 2/70

32/74 [===========>..................] - ETA: 0s - loss: 1.6422 - acc: 0.6285
64/74 [========================>.....] - ETA: 0s - loss: 1.2478 - acc: 0.7118
74/74 [==============================] - 1s 19ms/step - loss: 1.2115 - acc: 0.7118 - val_loss: 0.6721 - val_acc: 0.8101
Epoch 3/70

32/74 [===========>..................] - ETA: 0s - loss: 0.7898 - acc: 0.7731
64/74 [========================>.....] - ETA: 0s - loss: 0.7799 - acc: 0.7689
74/74 [==============================] - 1s 19ms/step - loss: 0.7491 - acc: 0.7792 - val_loss: 0.5891 - val_acc: 0.8101
Epoch 4/70

32/74 [===========>..................] - ETA: 0s - loss: 0.6606 - acc: 0.7897
64/74 [========================>.....] - ETA: 0s - loss: 0.6718 - acc: 0.7923
74/74 [==============================] - 1s 19ms/step - loss: 0.6642 - acc: 0.7915 - val_loss: 0.5055 - val_acc: 0.8268
Epoch 5/70

32/74 [===========>..................] - ETA: 0s - loss: 0.5339 - acc: 0.8389
64/74 [========================>.....] - ETA: 0s - loss: 0.5759 - acc: 0.8155
74/74 [==============================] - 1s 18ms/step - loss: 0.5679 - acc: 0.8204 - val_loss: 0.4364 - val_acc: 0.8380
Epoch 6/70

32/74 [===========>..................] - ETA: 0s - loss: 0.4968 - acc: 0.8292
64/74 [========================>.....] - ETA: 0s - loss: 0.4875 - acc: 0.8432
74/74 [==============================] - 1s 18ms/step - loss: 0.4943 - acc: 0.8403 - val_loss: 0.3907 - val_acc: 0.9162
Epoch 7/70

32/74 [===========>..................] - ETA: 0s - loss: 0.4240 - acc: 0.9088
64/74 [========================>.....] - ETA: 0s - loss: 0.4604 - acc: 0.8683
74/74 [==============================] - 1s 18ms/step - loss: 0.4634 - acc: 0.8670 - val_loss: 0.3344 - val_acc: 0.8939
Epoch 8/70

32/74 [===========>..................] - ETA: 0s - loss: 0.4159 - acc: 0.8707
64/74 [========================>.....] - ETA: 0s - loss: 0.3706 - acc: 0.8864
74/74 [==============================] - 1s 18ms/step - loss: 0.3760 - acc: 0.8850 - val_loss: 0.3571 - val_acc: 0.9106
Epoch 9/70

32/74 [===========>..................] - ETA: 0s - loss: 0.4061 - acc: 0.8741
64/74 [========================>.....] - ETA: 0s - loss: 0.3859 - acc: 0.8774
74/74 [==============================] - 1s 18ms/step - loss: 0.3778 - acc: 0.8840 - val_loss: 0.2817 - val_acc: 0.9274
Epoch 10/70

32/74 [===========>..................] - ETA: 0s - loss: 0.3378 - acc: 0.8915
64/74 [========================>.....] - ETA: 0s - loss: 0.2958 - acc: 0.9130
74/74 [==============================] - 1s 18ms/step - loss: 0.3016 - acc: 0.9131 - val_loss: 0.2800 - val_acc: 0.9218
Epoch 11/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2587 - acc: 0.9315
64/74 [========================>.....] - ETA: 0s - loss: 0.2755 - acc: 0.9276
74/74 [==============================] - 1s 18ms/step - loss: 0.2663 - acc: 0.9296 - val_loss: 0.2449 - val_acc: 0.9441
Epoch 12/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2224 - acc: 0.9504
64/74 [========================>.....] - ETA: 0s - loss: 0.2592 - acc: 0.9297
74/74 [==============================] - 1s 18ms/step - loss: 0.2646 - acc: 0.9309 - val_loss: 0.2541 - val_acc: 0.9330
Epoch 13/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2536 - acc: 0.9256
64/74 [========================>.....] - ETA: 0s - loss: 0.2199 - acc: 0.9357
74/74 [==============================] - 1s 18ms/step - loss: 0.2218 - acc: 0.9365 - val_loss: 0.2336 - val_acc: 0.9385
Epoch 14/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2134 - acc: 0.9479
64/74 [========================>.....] - ETA: 0s - loss: 0.2175 - acc: 0.9440
74/74 [==============================] - 1s 18ms/step - loss: 0.2149 - acc: 0.9435 - val_loss: 0.2931 - val_acc: 0.8939
Epoch 15/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2126 - acc: 0.9397
64/74 [========================>.....] - ETA: 0s - loss: 0.2071 - acc: 0.9367
74/74 [==============================] - 1s 18ms/step - loss: 0.2067 - acc: 0.9393 - val_loss: 0.2273 - val_acc: 0.9497
Epoch 16/70

32/74 [===========>..................] - ETA: 0s - loss: 0.1759 - acc: 0.9672
64/74 [========================>.....] - ETA: 0s - loss: 0.1666 - acc: 0.9617
74/74 [==============================] - 1s 18ms/step - loss: 0.1646 - acc: 0.9611 - val_loss: 0.2762 - val_acc: 0.9274
Epoch 17/70

32/74 [===========>..................] - ETA: 0s - loss: 0.1258 - acc: 0.9704
64/74 [========================>.....] - ETA: 0s - loss: 0.1597 - acc: 0.9560
74/74 [==============================] - 1s 18ms/step - loss: 0.1591 - acc: 0.9544 - val_loss: 0.2100 - val_acc: 0.9497
Epoch 18/70

32/74 [===========>..................] - ETA: 0s - loss: 0.1453 - acc: 0.9616
64/74 [========================>.....] - ETA: 0s - loss: 0.1380 - acc: 0.9673
74/74 [==============================] - 1s 18ms/step - loss: 0.1479 - acc: 0.9649 - val_loss: 0.2624 - val_acc: 0.9274
Epoch 19/70

32/74 [===========>..................] - ETA: 0s - loss: 0.1415 - acc: 0.9542
64/74 [========================>.....] - ETA: 0s - loss: 0.1518 - acc: 0.9578
74/74 [==============================] - 1s 18ms/step - loss: 0.1537 - acc: 0.9554 - val_loss: 0.2492 - val_acc: 0.9330
Computing...
Manual evaluation: (didn't understand why I made this)
True 7587
False 1484
True percentage 0.836401719766
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.95      0.95      7318
      B-ORG       0.59      0.31      0.41       296
      B-LOC       0.71      0.55      0.62       218
      B-PER       0.90      0.41      0.57       438
      I-PER       0.92      0.21      0.35       214
     B-MISC       0.18      0.13      0.15       141
      I-ORG       0.48      0.14      0.22       151
      I-LOC       0.80      0.55      0.65       141
     I-MISC       0.24      0.40      0.30       154

avg / total       0.89      0.84      0.85      9071

F-1 Score:
0.435643564356
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 83 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100094 unique words.
Found 94 unique chars.
Found 9 unique labels.
90 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 312
OOV word occurences: 522
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6406080     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,909,186
Trainable params: 6,909,186
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 74 samples, validate on 9 samples
Epoch 1/70

32/74 [===========>..................] - ETA: 3s - loss: 2.4815 - acc: 0.0313
64/74 [========================>.....] - ETA: 0s - loss: 1.7565 - acc: 0.4306
74/74 [==============================] - 4s 49ms/step - loss: 1.8768 - acc: 0.4797 - val_loss: 0.8383 - val_acc: 0.8295
Epoch 2/70

32/74 [===========>..................] - ETA: 0s - loss: 1.0587 - acc: 0.7697
64/74 [========================>.....] - ETA: 0s - loss: 0.9000 - acc: 0.7993
74/74 [==============================] - 1s 17ms/step - loss: 0.8887 - acc: 0.7954 - val_loss: 0.6687 - val_acc: 0.8295
Epoch 3/70

32/74 [===========>..................] - ETA: 0s - loss: 0.7766 - acc: 0.7831
64/74 [========================>.....] - ETA: 0s - loss: 0.7401 - acc: 0.7980
74/74 [==============================] - 1s 17ms/step - loss: 0.7350 - acc: 0.7951 - val_loss: 0.5813 - val_acc: 0.8295
Epoch 4/70

32/74 [===========>..................] - ETA: 0s - loss: 0.7680 - acc: 0.7604
64/74 [========================>.....] - ETA: 0s - loss: 0.6625 - acc: 0.7987
74/74 [==============================] - 1s 18ms/step - loss: 0.6446 - acc: 0.7998 - val_loss: 0.5415 - val_acc: 0.8295
Epoch 5/70

32/74 [===========>..................] - ETA: 0s - loss: 0.6344 - acc: 0.7960
64/74 [========================>.....] - ETA: 0s - loss: 0.6186 - acc: 0.8039
74/74 [==============================] - 1s 17ms/step - loss: 0.5936 - acc: 0.8110 - val_loss: 0.4630 - val_acc: 0.8466
Epoch 6/70

32/74 [===========>..................] - ETA: 0s - loss: 0.4571 - acc: 0.8522
64/74 [========================>.....] - ETA: 0s - loss: 0.5056 - acc: 0.8321
74/74 [==============================] - 1s 17ms/step - loss: 0.5091 - acc: 0.8309 - val_loss: 0.4159 - val_acc: 0.8636
Epoch 7/70

32/74 [===========>..................] - ETA: 0s - loss: 0.4330 - acc: 0.8621
64/74 [========================>.....] - ETA: 0s - loss: 0.4321 - acc: 0.8647
74/74 [==============================] - 1s 16ms/step - loss: 0.4371 - acc: 0.8646 - val_loss: 0.4743 - val_acc: 0.8466
Epoch 8/70

32/74 [===========>..................] - ETA: 0s - loss: 0.4693 - acc: 0.8311
64/74 [========================>.....] - ETA: 0s - loss: 0.4617 - acc: 0.8694
74/74 [==============================] - 1s 17ms/step - loss: 0.4530 - acc: 0.8667 - val_loss: 0.3797 - val_acc: 0.8693
Epoch 9/70

32/74 [===========>..................] - ETA: 0s - loss: 0.3879 - acc: 0.8764
64/74 [========================>.....] - ETA: 0s - loss: 0.3629 - acc: 0.8902
74/74 [==============================] - 1s 17ms/step - loss: 0.3665 - acc: 0.8878 - val_loss: 0.3740 - val_acc: 0.8636
Epoch 10/70

32/74 [===========>..................] - ETA: 0s - loss: 0.3501 - acc: 0.8788
64/74 [========================>.....] - ETA: 0s - loss: 0.3565 - acc: 0.8826
74/74 [==============================] - 1s 17ms/step - loss: 0.3452 - acc: 0.8887 - val_loss: 0.3346 - val_acc: 0.8750
Epoch 11/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2731 - acc: 0.9114
64/74 [========================>.....] - ETA: 0s - loss: 0.3007 - acc: 0.9047
74/74 [==============================] - 1s 17ms/step - loss: 0.2913 - acc: 0.9085 - val_loss: 0.3152 - val_acc: 0.8977
Epoch 12/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2383 - acc: 0.9207
64/74 [========================>.....] - ETA: 0s - loss: 0.2566 - acc: 0.9232
74/74 [==============================] - 1s 16ms/step - loss: 0.2664 - acc: 0.9201 - val_loss: 0.3422 - val_acc: 0.8920
Epoch 13/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2488 - acc: 0.9264
64/74 [========================>.....] - ETA: 0s - loss: 0.2542 - acc: 0.9221
74/74 [==============================] - 1s 17ms/step - loss: 0.2422 - acc: 0.9232 - val_loss: 0.3366 - val_acc: 0.8920
Computing...
Manual evaluation: (didn't understand why I made this)
True 7519
False 1552
True percentage 0.828905302613
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.94      0.95      7318
      B-PER       0.76      0.57      0.65       438
      B-ORG       0.39      0.35      0.37       296
     I-MISC       0.20      0.51      0.29       154
      B-LOC       0.83      0.31      0.45       218
      I-LOC       1.00      0.09      0.16       141
      I-ORG       0.33      0.09      0.15       151
      I-PER       0.57      0.52      0.54       214
     B-MISC       0.31      0.12      0.17       141

avg / total       0.88      0.83      0.84      9071

F-1 Score:
0.416746564398
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 83 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100097 unique words.
Found 94 unique chars.
Found 9 unique labels.
93 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 315
OOV word occurences: 601
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6406272     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,909,378
Trainable params: 6,909,378
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 74 samples, validate on 9 samples
Epoch 1/70

32/74 [===========>..................] - ETA: 3s - loss: 2.2042 - acc: 0.0906
64/74 [========================>.....] - ETA: 0s - loss: 1.6159 - acc: 0.4307
74/74 [==============================] - 4s 49ms/step - loss: 1.6720 - acc: 0.4826 - val_loss: 0.9659 - val_acc: 0.8263
Epoch 2/70

32/74 [===========>..................] - ETA: 0s - loss: 1.0728 - acc: 0.8048
64/74 [========================>.....] - ETA: 0s - loss: 0.9652 - acc: 0.7895
74/74 [==============================] - 1s 17ms/step - loss: 0.9480 - acc: 0.7878 - val_loss: 0.6426 - val_acc: 0.8263
Epoch 3/70

32/74 [===========>..................] - ETA: 0s - loss: 0.6709 - acc: 0.8130
64/74 [========================>.....] - ETA: 0s - loss: 0.7485 - acc: 0.7809
74/74 [==============================] - 1s 18ms/step - loss: 0.7299 - acc: 0.7870 - val_loss: 0.5832 - val_acc: 0.8263
Epoch 4/70

32/74 [===========>..................] - ETA: 0s - loss: 0.6205 - acc: 0.8043
64/74 [========================>.....] - ETA: 0s - loss: 0.6444 - acc: 0.8015
74/74 [==============================] - 1s 17ms/step - loss: 0.6479 - acc: 0.8001 - val_loss: 0.5144 - val_acc: 0.8517
Epoch 5/70

32/74 [===========>..................] - ETA: 0s - loss: 0.5945 - acc: 0.8228
64/74 [========================>.....] - ETA: 0s - loss: 0.5427 - acc: 0.8300
74/74 [==============================] - 1s 17ms/step - loss: 0.5540 - acc: 0.8246 - val_loss: 0.4504 - val_acc: 0.8729
Epoch 6/70

32/74 [===========>..................] - ETA: 0s - loss: 0.4944 - acc: 0.8737
64/74 [========================>.....] - ETA: 0s - loss: 0.5358 - acc: 0.8454
74/74 [==============================] - 1s 17ms/step - loss: 0.5370 - acc: 0.8508 - val_loss: 0.4245 - val_acc: 0.8602
Epoch 7/70

32/74 [===========>..................] - ETA: 0s - loss: 0.4520 - acc: 0.8486
64/74 [========================>.....] - ETA: 0s - loss: 0.4553 - acc: 0.8545
74/74 [==============================] - 1s 17ms/step - loss: 0.4461 - acc: 0.8587 - val_loss: 0.3756 - val_acc: 0.8856
Epoch 8/70

32/74 [===========>..................] - ETA: 0s - loss: 0.4365 - acc: 0.8518
64/74 [========================>.....] - ETA: 0s - loss: 0.3948 - acc: 0.8741
74/74 [==============================] - 1s 17ms/step - loss: 0.3851 - acc: 0.8791 - val_loss: 0.3632 - val_acc: 0.8771
Epoch 9/70

32/74 [===========>..................] - ETA: 0s - loss: 0.3802 - acc: 0.8774
64/74 [========================>.....] - ETA: 0s - loss: 0.3313 - acc: 0.8976
74/74 [==============================] - 1s 16ms/step - loss: 0.3236 - acc: 0.8973 - val_loss: 0.3849 - val_acc: 0.8686
Epoch 10/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2825 - acc: 0.9086
64/74 [========================>.....] - ETA: 0s - loss: 0.3040 - acc: 0.9093
74/74 [==============================] - 1s 17ms/step - loss: 0.3033 - acc: 0.9086 - val_loss: 0.3663 - val_acc: 0.8771
Computing...
Manual evaluation: (didn't understand why I made this)
True 7295
False 1776
True percentage 0.804211222577
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.94      0.95      7318
      B-PER       0.86      0.14      0.24       438
      B-LOC       0.90      0.35      0.51       218
      B-ORG       0.43      0.46      0.45       296
      I-PER       0.50      0.01      0.02       214
     B-MISC       0.00      0.00      0.00       141
     I-MISC       1.00      0.01      0.01       154
      I-LOC       0.00      0.00      0.00       141
      I-ORG       0.16      0.77      0.27       151

avg / total       0.87      0.80      0.81      9071

F-1 Score:
0.268433571186
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 83 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100112 unique words.
Found 94 unique chars.
Found 9 unique labels.
108 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 308
OOV word occurences: 503
Padding...
Data padded!
Padding...
Data padded!
Padded until 58 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 58, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 58)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 58, 64)       6407232     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 58, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 58, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 58, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 58, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 58, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,910,338
Trainable params: 6,910,338
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 74 samples, validate on 9 samples
Epoch 1/70

32/74 [===========>..................] - ETA: 3s - loss: 2.3472 - acc: 0.0259
64/74 [========================>.....] - ETA: 0s - loss: 1.6630 - acc: 0.4075
74/74 [==============================] - 4s 50ms/step - loss: 1.6933 - acc: 0.4664 - val_loss: 0.9977 - val_acc: 0.7883
Epoch 2/70

32/74 [===========>..................] - ETA: 0s - loss: 1.0773 - acc: 0.7924
64/74 [========================>.....] - ETA: 0s - loss: 0.9393 - acc: 0.8018
74/74 [==============================] - 1s 17ms/step - loss: 0.9085 - acc: 0.8055 - val_loss: 0.7118 - val_acc: 0.7883
Epoch 3/70

32/74 [===========>..................] - ETA: 0s - loss: 0.6974 - acc: 0.8151
64/74 [========================>.....] - ETA: 0s - loss: 0.6725 - acc: 0.8155
74/74 [==============================] - 1s 18ms/step - loss: 0.6825 - acc: 0.8095 - val_loss: 0.6130 - val_acc: 0.7883
Epoch 4/70

32/74 [===========>..................] - ETA: 0s - loss: 0.5806 - acc: 0.8258
64/74 [========================>.....] - ETA: 0s - loss: 0.5611 - acc: 0.8268
74/74 [==============================] - 1s 18ms/step - loss: 0.5974 - acc: 0.8134 - val_loss: 0.5708 - val_acc: 0.8153
Epoch 5/70

32/74 [===========>..................] - ETA: 0s - loss: 0.4685 - acc: 0.8606
64/74 [========================>.....] - ETA: 0s - loss: 0.4953 - acc: 0.8489
74/74 [==============================] - 1s 17ms/step - loss: 0.5043 - acc: 0.8451 - val_loss: 0.4216 - val_acc: 0.8874
Epoch 6/70

32/74 [===========>..................] - ETA: 0s - loss: 0.3924 - acc: 0.8788
64/74 [========================>.....] - ETA: 0s - loss: 0.4045 - acc: 0.8662
74/74 [==============================] - 1s 17ms/step - loss: 0.4210 - acc: 0.8657 - val_loss: 0.4005 - val_acc: 0.8919
Epoch 7/70

32/74 [===========>..................] - ETA: 0s - loss: 0.3668 - acc: 0.8676
64/74 [========================>.....] - ETA: 0s - loss: 0.3538 - acc: 0.8744
74/74 [==============================] - 1s 17ms/step - loss: 0.3626 - acc: 0.8728 - val_loss: 0.3586 - val_acc: 0.9144
Epoch 8/70

32/74 [===========>..................] - ETA: 0s - loss: 0.3498 - acc: 0.8917
64/74 [========================>.....] - ETA: 0s - loss: 0.3834 - acc: 0.8763
74/74 [==============================] - 1s 17ms/step - loss: 0.3590 - acc: 0.8897 - val_loss: 0.3503 - val_acc: 0.9054
Epoch 9/70

32/74 [===========>..................] - ETA: 0s - loss: 0.3372 - acc: 0.8956
64/74 [========================>.....] - ETA: 0s - loss: 0.2839 - acc: 0.9129
74/74 [==============================] - 1s 17ms/step - loss: 0.2930 - acc: 0.9095 - val_loss: 0.3782 - val_acc: 0.8919
Epoch 10/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2919 - acc: 0.9213
64/74 [========================>.....] - ETA: 0s - loss: 0.2697 - acc: 0.9211
74/74 [==============================] - 1s 17ms/step - loss: 0.2882 - acc: 0.9129 - val_loss: 0.3907 - val_acc: 0.8514
Computing...
Manual evaluation: (didn't understand why I made this)
True 7397
False 1674
True percentage 0.815455848308
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.89      0.96      0.92      7318
      B-ORG       0.58      0.36      0.44       296
      I-ORG       0.50      0.06      0.11       151
      B-PER       0.79      0.22      0.35       438
      B-LOC       0.73      0.50      0.60       218
      I-LOC       0.67      0.09      0.15       141
      I-PER       0.53      0.15      0.23       214
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.23      0.17      0.20       154

avg / total       0.83      0.82      0.80      9071

F-1 Score:
0.324279835391
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 83 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100115 unique words.
Found 94 unique chars.
Found 9 unique labels.
111 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 311
OOV word occurences: 505
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6407424     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,910,530
Trainable params: 6,910,530
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 74 samples, validate on 9 samples
Epoch 1/70

32/74 [===========>..................] - ETA: 3s - loss: 2.1960 - acc: 0.0759
64/74 [========================>.....] - ETA: 0s - loss: 1.6010 - acc: 0.4199
74/74 [==============================] - 4s 49ms/step - loss: 1.5227 - acc: 0.4717 - val_loss: 1.4265 - val_acc: 0.8315
Epoch 2/70

32/74 [===========>..................] - ETA: 0s - loss: 1.5368 - acc: 0.7143
64/74 [========================>.....] - ETA: 0s - loss: 1.1415 - acc: 0.7687
74/74 [==============================] - 1s 17ms/step - loss: 1.0824 - acc: 0.7734 - val_loss: 0.6780 - val_acc: 0.7935
Epoch 3/70

32/74 [===========>..................] - ETA: 0s - loss: 0.6872 - acc: 0.8059
64/74 [========================>.....] - ETA: 0s - loss: 0.6794 - acc: 0.7986
74/74 [==============================] - 1s 17ms/step - loss: 0.6906 - acc: 0.7940 - val_loss: 0.6100 - val_acc: 0.7935
Epoch 4/70

32/74 [===========>..................] - ETA: 0s - loss: 0.7072 - acc: 0.7830
64/74 [========================>.....] - ETA: 0s - loss: 0.6346 - acc: 0.7980
74/74 [==============================] - 1s 17ms/step - loss: 0.6055 - acc: 0.8068 - val_loss: 0.5760 - val_acc: 0.8043
Epoch 5/70

32/74 [===========>..................] - ETA: 0s - loss: 0.5986 - acc: 0.8036
64/74 [========================>.....] - ETA: 0s - loss: 0.5392 - acc: 0.8329
74/74 [==============================] - 1s 16ms/step - loss: 0.5231 - acc: 0.8387 - val_loss: 0.4849 - val_acc: 0.8533
Epoch 6/70

32/74 [===========>..................] - ETA: 0s - loss: 0.4737 - acc: 0.8481
64/74 [========================>.....] - ETA: 0s - loss: 0.4799 - acc: 0.8470
74/74 [==============================] - 1s 17ms/step - loss: 0.4511 - acc: 0.8558 - val_loss: 0.4434 - val_acc: 0.8859
Epoch 7/70

32/74 [===========>..................] - ETA: 0s - loss: 0.3677 - acc: 0.8864
64/74 [========================>.....] - ETA: 0s - loss: 0.3840 - acc: 0.8810
74/74 [==============================] - 1s 17ms/step - loss: 0.3961 - acc: 0.8778 - val_loss: 0.5299 - val_acc: 0.8478
Epoch 8/70

32/74 [===========>..................] - ETA: 0s - loss: 0.4237 - acc: 0.8470
64/74 [========================>.....] - ETA: 0s - loss: 0.4798 - acc: 0.8552
74/74 [==============================] - 1s 17ms/step - loss: 0.4605 - acc: 0.8605 - val_loss: 0.3921 - val_acc: 0.8967
Epoch 9/70

32/74 [===========>..................] - ETA: 0s - loss: 0.3091 - acc: 0.9102
64/74 [========================>.....] - ETA: 0s - loss: 0.3254 - acc: 0.9043
74/74 [==============================] - 1s 17ms/step - loss: 0.3248 - acc: 0.9020 - val_loss: 0.3717 - val_acc: 0.9076
Epoch 10/70

32/74 [===========>..................] - ETA: 0s - loss: 0.3044 - acc: 0.9082
64/74 [========================>.....] - ETA: 0s - loss: 0.2696 - acc: 0.9216
74/74 [==============================] - 1s 16ms/step - loss: 0.2826 - acc: 0.9139 - val_loss: 0.3408 - val_acc: 0.9022
Epoch 11/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2730 - acc: 0.9125
64/74 [========================>.....] - ETA: 0s - loss: 0.2579 - acc: 0.9183
74/74 [==============================] - 1s 17ms/step - loss: 0.2485 - acc: 0.9215 - val_loss: 0.3930 - val_acc: 0.8859
Epoch 12/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2272 - acc: 0.9234
64/74 [========================>.....] - ETA: 0s - loss: 0.2300 - acc: 0.9288
74/74 [==============================] - 1s 17ms/step - loss: 0.2243 - acc: 0.9271 - val_loss: 0.3698 - val_acc: 0.8967
Computing...
Manual evaluation: (didn't understand why I made this)
True 7658
False 1413
True percentage 0.844228861206
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.95      0.95      7318
      B-ORG       0.43      0.52      0.47       296
      I-ORG       0.40      0.25      0.31       151
     B-MISC       0.24      0.22      0.23       141
     I-MISC       0.27      0.27      0.27       154
      B-PER       0.87      0.50      0.63       438
      B-LOC       0.67      0.38      0.48       218
      I-LOC       0.71      0.52      0.60       141
      I-PER       0.71      0.47      0.56       214

avg / total       0.89      0.84      0.86      9071

F-1 Score:
0.476037311032
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 83 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100115 unique words.
Found 94 unique chars.
Found 9 unique labels.
111 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 307
OOV word occurences: 604
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6407424     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,910,530
Trainable params: 6,910,530
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 74 samples, validate on 9 samples
Epoch 1/70

32/74 [===========>..................] - ETA: 3s - loss: 2.3832 - acc: 0.0537
64/74 [========================>.....] - ETA: 0s - loss: 1.6357 - acc: 0.4318
74/74 [==============================] - 4s 51ms/step - loss: 1.8157 - acc: 0.4775 - val_loss: 1.0774 - val_acc: 0.8060
Epoch 2/70

32/74 [===========>..................] - ETA: 0s - loss: 1.1020 - acc: 0.8068
64/74 [========================>.....] - ETA: 0s - loss: 0.9717 - acc: 0.8096
74/74 [==============================] - 1s 17ms/step - loss: 0.9603 - acc: 0.8027 - val_loss: 0.7606 - val_acc: 0.7960
Epoch 3/70

32/74 [===========>..................] - ETA: 0s - loss: 0.7649 - acc: 0.7969
64/74 [========================>.....] - ETA: 0s - loss: 0.7179 - acc: 0.8040
74/74 [==============================] - 1s 18ms/step - loss: 0.7087 - acc: 0.8019 - val_loss: 0.7052 - val_acc: 0.7960
Epoch 4/70

32/74 [===========>..................] - ETA: 0s - loss: 0.6488 - acc: 0.8060
64/74 [========================>.....] - ETA: 0s - loss: 0.6618 - acc: 0.7971
74/74 [==============================] - 1s 17ms/step - loss: 0.6383 - acc: 0.8040 - val_loss: 0.6601 - val_acc: 0.7960
Epoch 5/70

32/74 [===========>..................] - ETA: 0s - loss: 0.4453 - acc: 0.8488
64/74 [========================>.....] - ETA: 0s - loss: 0.5229 - acc: 0.8266
74/74 [==============================] - 1s 17ms/step - loss: 0.5574 - acc: 0.8189 - val_loss: 0.5347 - val_acc: 0.8259
Epoch 6/70

32/74 [===========>..................] - ETA: 0s - loss: 0.5140 - acc: 0.8487
64/74 [========================>.....] - ETA: 0s - loss: 0.4830 - acc: 0.8494
74/74 [==============================] - 1s 17ms/step - loss: 0.4938 - acc: 0.8463 - val_loss: 0.4727 - val_acc: 0.8507
Epoch 7/70

32/74 [===========>..................] - ETA: 0s - loss: 0.3733 - acc: 0.9023
64/74 [========================>.....] - ETA: 0s - loss: 0.5005 - acc: 0.8447
74/74 [==============================] - 1s 17ms/step - loss: 0.5168 - acc: 0.8423 - val_loss: 0.4785 - val_acc: 0.8607
Epoch 8/70

32/74 [===========>..................] - ETA: 0s - loss: 0.4451 - acc: 0.8676
64/74 [========================>.....] - ETA: 0s - loss: 0.4285 - acc: 0.8723
74/74 [==============================] - 1s 17ms/step - loss: 0.4100 - acc: 0.8793 - val_loss: 0.4823 - val_acc: 0.8308
Computing...
Manual evaluation: (didn't understand why I made this)
True 7273
False 1798
True percentage 0.801785911145
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.83      0.20      0.32       438
          O       0.88      0.96      0.92      7318
      B-ORG       0.47      0.40      0.43       296
     B-MISC       0.00      0.00      0.00       141
      B-LOC       0.33      0.00      0.01       218
      I-LOC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      I-PER       0.69      0.17      0.27       214
      I-ORG       0.39      0.09      0.15       151

avg / total       0.79      0.80      0.78      9071

F-1 Score:
0.845728406684
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 83 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100116 unique words.
Found 94 unique chars.
Found 9 unique labels.
112 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 315
OOV word occurences: 609
Padding...
Data padded!
Padding...
Data padded!
Padded until 58 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 58, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 58)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 58, 64)       6407488     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 58, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 58, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 58, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 58, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 58, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,910,594
Trainable params: 6,910,594
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 74 samples, validate on 9 samples
Epoch 1/70

32/74 [===========>..................] - ETA: 3s - loss: 2.4445 - acc: 0.0028
64/74 [========================>.....] - ETA: 0s - loss: 1.6474 - acc: 0.4220
74/74 [==============================] - 4s 51ms/step - loss: 1.8315 - acc: 0.4694 - val_loss: 0.9776 - val_acc: 0.8099
Epoch 2/70

32/74 [===========>..................] - ETA: 0s - loss: 0.9643 - acc: 0.8159
64/74 [========================>.....] - ETA: 0s - loss: 0.9888 - acc: 0.8079
74/74 [==============================] - 1s 18ms/step - loss: 0.9431 - acc: 0.8171 - val_loss: 0.6882 - val_acc: 0.8169
Epoch 3/70

32/74 [===========>..................] - ETA: 0s - loss: 0.5584 - acc: 0.8587
64/74 [========================>.....] - ETA: 0s - loss: 0.6665 - acc: 0.8195
74/74 [==============================] - 1s 17ms/step - loss: 0.6657 - acc: 0.8182 - val_loss: 0.6236 - val_acc: 0.8169
Epoch 4/70

32/74 [===========>..................] - ETA: 0s - loss: 0.6444 - acc: 0.8039
64/74 [========================>.....] - ETA: 0s - loss: 0.6045 - acc: 0.8157
74/74 [==============================] - 1s 18ms/step - loss: 0.6062 - acc: 0.8190 - val_loss: 0.5845 - val_acc: 0.8310
Epoch 5/70

32/74 [===========>..................] - ETA: 0s - loss: 0.5804 - acc: 0.8054
64/74 [========================>.....] - ETA: 0s - loss: 0.5445 - acc: 0.8232
74/74 [==============================] - 1s 17ms/step - loss: 0.5346 - acc: 0.8244 - val_loss: 0.5236 - val_acc: 0.8451
Epoch 6/70

32/74 [===========>..................] - ETA: 0s - loss: 0.4671 - acc: 0.8477
64/74 [========================>.....] - ETA: 0s - loss: 0.5076 - acc: 0.8413
74/74 [==============================] - 1s 17ms/step - loss: 0.4725 - acc: 0.8524 - val_loss: 0.4828 - val_acc: 0.8592
Epoch 7/70

32/74 [===========>..................] - ETA: 0s - loss: 0.4573 - acc: 0.8634
64/74 [========================>.....] - ETA: 0s - loss: 0.4077 - acc: 0.8780
74/74 [==============================] - 1s 17ms/step - loss: 0.4215 - acc: 0.8705 - val_loss: 0.4884 - val_acc: 0.8451
Epoch 8/70

32/74 [===========>..................] - ETA: 0s - loss: 0.3384 - acc: 0.9149
64/74 [========================>.....] - ETA: 0s - loss: 0.3885 - acc: 0.8784
74/74 [==============================] - 1s 17ms/step - loss: 0.3962 - acc: 0.8783 - val_loss: 0.4402 - val_acc: 0.8451
Epoch 9/70

32/74 [===========>..................] - ETA: 0s - loss: 0.3523 - acc: 0.8759
64/74 [========================>.....] - ETA: 0s - loss: 0.3695 - acc: 0.8718
74/74 [==============================] - 1s 17ms/step - loss: 0.3466 - acc: 0.8808 - val_loss: 0.4185 - val_acc: 0.8592
Epoch 10/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2881 - acc: 0.9133
64/74 [========================>.....] - ETA: 0s - loss: 0.3093 - acc: 0.9062
74/74 [==============================] - 1s 17ms/step - loss: 0.2956 - acc: 0.9132 - val_loss: 0.4596 - val_acc: 0.8521
Epoch 11/70

32/74 [===========>..................] - ETA: 0s - loss: 0.3094 - acc: 0.8929
64/74 [========================>.....] - ETA: 0s - loss: 0.3256 - acc: 0.9033
74/74 [==============================] - 1s 17ms/step - loss: 0.3118 - acc: 0.9052 - val_loss: 0.3899 - val_acc: 0.8732
Epoch 12/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2501 - acc: 0.9186
64/74 [========================>.....] - ETA: 0s - loss: 0.2242 - acc: 0.9338
74/74 [==============================] - 1s 17ms/step - loss: 0.2371 - acc: 0.9291 - val_loss: 0.4011 - val_acc: 0.8803
Epoch 13/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2185 - acc: 0.9537
64/74 [========================>.....] - ETA: 0s - loss: 0.2255 - acc: 0.9439
74/74 [==============================] - 1s 17ms/step - loss: 0.2217 - acc: 0.9462 - val_loss: 0.3846 - val_acc: 0.8662
Epoch 14/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2459 - acc: 0.9201
64/74 [========================>.....] - ETA: 0s - loss: 0.2008 - acc: 0.9424
74/74 [==============================] - 1s 17ms/step - loss: 0.2035 - acc: 0.9392 - val_loss: 0.3671 - val_acc: 0.8803
Epoch 15/70

32/74 [===========>..................] - ETA: 0s - loss: 0.1621 - acc: 0.9598
64/74 [========================>.....] - ETA: 0s - loss: 0.1614 - acc: 0.9640
74/74 [==============================] - 1s 17ms/step - loss: 0.1722 - acc: 0.9570 - val_loss: 0.3619 - val_acc: 0.8944
Epoch 16/70

32/74 [===========>..................] - ETA: 0s - loss: 0.1440 - acc: 0.9645
64/74 [========================>.....] - ETA: 0s - loss: 0.1595 - acc: 0.9617
74/74 [==============================] - 1s 17ms/step - loss: 0.1604 - acc: 0.9600 - val_loss: 0.3778 - val_acc: 0.8732
Epoch 17/70

32/74 [===========>..................] - ETA: 0s - loss: 0.1462 - acc: 0.9479
64/74 [========================>.....] - ETA: 0s - loss: 0.1401 - acc: 0.9598
74/74 [==============================] - 1s 17ms/step - loss: 0.1384 - acc: 0.9611 - val_loss: 0.4006 - val_acc: 0.8732
Computing...
Manual evaluation: (didn't understand why I made this)
True 7443
False 1628
True percentage 0.820526954029
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.83      0.30      0.44       438
          O       0.94      0.94      0.94      7318
      B-LOC       0.45      0.73      0.56       218
      I-LOC       0.39      0.74      0.51       141
      I-PER       0.63      0.15      0.24       214
      B-ORG       0.48      0.33      0.39       296
      I-ORG       0.36      0.14      0.20       151
     B-MISC       0.08      0.01      0.01       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.85      0.82      0.82      9071

F-1 Score:
0.863451207273
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 83 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100110 unique words.
Found 94 unique chars.
Found 9 unique labels.
106 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 312
OOV word occurences: 543
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6407104     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,910,210
Trainable params: 6,910,210
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 74 samples, validate on 9 samples
Epoch 1/70

32/74 [===========>..................] - ETA: 3s - loss: 2.1991 - acc: 0.1681
64/74 [========================>.....] - ETA: 0s - loss: 1.5378 - acc: 0.4871
74/74 [==============================] - 4s 51ms/step - loss: 1.4225 - acc: 0.5352 - val_loss: 1.2366 - val_acc: 0.7955
Epoch 2/70

32/74 [===========>..................] - ETA: 0s - loss: 1.2229 - acc: 0.7981
64/74 [========================>.....] - ETA: 0s - loss: 0.9635 - acc: 0.8091
74/74 [==============================] - 1s 17ms/step - loss: 0.9439 - acc: 0.8019 - val_loss: 0.6578 - val_acc: 0.8409
Epoch 3/70

32/74 [===========>..................] - ETA: 0s - loss: 0.7313 - acc: 0.7813
64/74 [========================>.....] - ETA: 0s - loss: 0.6451 - acc: 0.8105
74/74 [==============================] - 1s 18ms/step - loss: 0.6278 - acc: 0.8145 - val_loss: 0.5463 - val_acc: 0.8409
Epoch 4/70

32/74 [===========>..................] - ETA: 0s - loss: 0.5634 - acc: 0.8261
64/74 [========================>.....] - ETA: 0s - loss: 0.5523 - acc: 0.8298
74/74 [==============================] - 1s 17ms/step - loss: 0.5411 - acc: 0.8362 - val_loss: 0.6092 - val_acc: 0.8466
Epoch 5/70

32/74 [===========>..................] - ETA: 0s - loss: 0.6541 - acc: 0.8025
64/74 [========================>.....] - ETA: 0s - loss: 0.6304 - acc: 0.8242
74/74 [==============================] - 1s 17ms/step - loss: 0.5935 - acc: 0.8338 - val_loss: 0.4591 - val_acc: 0.8580
Epoch 6/70

32/74 [===========>..................] - ETA: 0s - loss: 0.4264 - acc: 0.8602
64/74 [========================>.....] - ETA: 0s - loss: 0.3919 - acc: 0.8679
74/74 [==============================] - 1s 17ms/step - loss: 0.4292 - acc: 0.8558 - val_loss: 0.4588 - val_acc: 0.8693
Epoch 7/70

32/74 [===========>..................] - ETA: 0s - loss: 0.4316 - acc: 0.8807
64/74 [========================>.....] - ETA: 0s - loss: 0.3942 - acc: 0.8826
74/74 [==============================] - 1s 17ms/step - loss: 0.4004 - acc: 0.8787 - val_loss: 0.4094 - val_acc: 0.8466
Epoch 8/70

32/74 [===========>..................] - ETA: 0s - loss: 0.3725 - acc: 0.8681
64/74 [========================>.....] - ETA: 0s - loss: 0.3534 - acc: 0.8838
74/74 [==============================] - 1s 17ms/step - loss: 0.3527 - acc: 0.8808 - val_loss: 0.3712 - val_acc: 0.8807
Epoch 9/70

32/74 [===========>..................] - ETA: 0s - loss: 0.3467 - acc: 0.8884
64/74 [========================>.....] - ETA: 0s - loss: 0.3116 - acc: 0.8985
74/74 [==============================] - 1s 17ms/step - loss: 0.3110 - acc: 0.8955 - val_loss: 0.3274 - val_acc: 0.8977
Epoch 10/70

32/74 [===========>..................] - ETA: 0s - loss: 0.3036 - acc: 0.8987
64/74 [========================>.....] - ETA: 0s - loss: 0.2858 - acc: 0.9062
74/74 [==============================] - 1s 17ms/step - loss: 0.2800 - acc: 0.9095 - val_loss: 0.3519 - val_acc: 0.9034
Epoch 11/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2833 - acc: 0.9168
64/74 [========================>.....] - ETA: 0s - loss: 0.2811 - acc: 0.9119
74/74 [==============================] - 1s 17ms/step - loss: 0.2813 - acc: 0.9129 - val_loss: 0.3142 - val_acc: 0.9034
Epoch 12/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2239 - acc: 0.9374
64/74 [========================>.....] - ETA: 0s - loss: 0.2334 - acc: 0.9339
74/74 [==============================] - 1s 17ms/step - loss: 0.2355 - acc: 0.9331 - val_loss: 0.2964 - val_acc: 0.9148
Epoch 13/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2011 - acc: 0.9470
64/74 [========================>.....] - ETA: 0s - loss: 0.2028 - acc: 0.9439
74/74 [==============================] - 1s 17ms/step - loss: 0.1948 - acc: 0.9454 - val_loss: 0.2543 - val_acc: 0.9148
Epoch 14/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2215 - acc: 0.9294
64/74 [========================>.....] - ETA: 0s - loss: 0.1926 - acc: 0.9430
74/74 [==============================] - 1s 16ms/step - loss: 0.1950 - acc: 0.9403 - val_loss: 0.3230 - val_acc: 0.8977
Epoch 15/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2703 - acc: 0.9176
64/74 [========================>.....] - ETA: 0s - loss: 0.2477 - acc: 0.9204
74/74 [==============================] - 1s 17ms/step - loss: 0.2306 - acc: 0.9258 - val_loss: 0.2543 - val_acc: 0.9261
Computing...
Manual evaluation: (didn't understand why I made this)
True 7546
False 1525
True percentage 0.831881821188
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.94      0.94      7318
      B-ORG       0.44      0.42      0.43       296
     B-MISC       0.03      0.01      0.01       141
     I-MISC       0.22      0.06      0.09       154
      B-PER       0.76      0.52      0.61       438
      B-LOC       0.66      0.50      0.57       218
      I-ORG       0.22      0.27      0.24       151
      I-PER       0.74      0.30      0.43       214
      I-LOC       0.81      0.40      0.54       141

avg / total       0.86      0.83      0.84      9071

F-1 Score:
0.431452991453
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 83 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100111 unique words.
Found 94 unique chars.
Found 9 unique labels.
107 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 308
OOV word occurences: 480
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6407168     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,910,274
Trainable params: 6,910,274
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 74 samples, validate on 9 samples
Epoch 1/70

32/74 [===========>..................] - ETA: 3s - loss: 2.4992 - acc: 0.0303
64/74 [========================>.....] - ETA: 0s - loss: 1.7294 - acc: 0.4139
74/74 [==============================] - 4s 52ms/step - loss: 1.7346 - acc: 0.4764 - val_loss: 1.1675 - val_acc: 0.6815
Epoch 2/70

32/74 [===========>..................] - ETA: 0s - loss: 0.7741 - acc: 0.8098
64/74 [========================>.....] - ETA: 0s - loss: 0.7569 - acc: 0.8207
74/74 [==============================] - 1s 17ms/step - loss: 0.7694 - acc: 0.8177 - val_loss: 1.2660 - val_acc: 0.6815
Epoch 3/70

32/74 [===========>..................] - ETA: 0s - loss: 0.7893 - acc: 0.8178
64/74 [========================>.....] - ETA: 0s - loss: 0.7686 - acc: 0.8293
74/74 [==============================] - 1s 18ms/step - loss: 0.7801 - acc: 0.8176 - val_loss: 0.9952 - val_acc: 0.6879
Epoch 4/70

32/74 [===========>..................] - ETA: 0s - loss: 0.6216 - acc: 0.8340
64/74 [========================>.....] - ETA: 0s - loss: 0.5923 - acc: 0.8207
74/74 [==============================] - 1s 17ms/step - loss: 0.5843 - acc: 0.8218 - val_loss: 0.9031 - val_acc: 0.6943
Epoch 5/70

32/74 [===========>..................] - ETA: 0s - loss: 0.4686 - acc: 0.8526
64/74 [========================>.....] - ETA: 0s - loss: 0.4805 - acc: 0.8446
74/74 [==============================] - 1s 17ms/step - loss: 0.4959 - acc: 0.8385 - val_loss: 0.8238 - val_acc: 0.7261
Epoch 6/70

32/74 [===========>..................] - ETA: 0s - loss: 0.4132 - acc: 0.8760
64/74 [========================>.....] - ETA: 0s - loss: 0.4578 - acc: 0.8536
74/74 [==============================] - 1s 17ms/step - loss: 0.4481 - acc: 0.8615 - val_loss: 0.8195 - val_acc: 0.7261
Epoch 7/70

32/74 [===========>..................] - ETA: 0s - loss: 0.4703 - acc: 0.8255
64/74 [========================>.....] - ETA: 0s - loss: 0.4386 - acc: 0.8692
74/74 [==============================] - 1s 17ms/step - loss: 0.4266 - acc: 0.8711 - val_loss: 0.6744 - val_acc: 0.7898
Epoch 8/70

32/74 [===========>..................] - ETA: 0s - loss: 0.3413 - acc: 0.9013
64/74 [========================>.....] - ETA: 0s - loss: 0.3382 - acc: 0.8934
74/74 [==============================] - 1s 17ms/step - loss: 0.3484 - acc: 0.8910 - val_loss: 0.6653 - val_acc: 0.7707
Epoch 9/70

32/74 [===========>..................] - ETA: 0s - loss: 0.3826 - acc: 0.8860
64/74 [========================>.....] - ETA: 0s - loss: 0.3208 - acc: 0.9026
74/74 [==============================] - 1s 16ms/step - loss: 0.3067 - acc: 0.9055 - val_loss: 0.6078 - val_acc: 0.8025
Epoch 10/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2918 - acc: 0.9076
64/74 [========================>.....] - ETA: 0s - loss: 0.2876 - acc: 0.9112
74/74 [==============================] - 1s 17ms/step - loss: 0.2824 - acc: 0.9153 - val_loss: 0.6515 - val_acc: 0.7771
Epoch 11/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2750 - acc: 0.9069
64/74 [========================>.....] - ETA: 0s - loss: 0.2974 - acc: 0.9119
74/74 [==============================] - 1s 17ms/step - loss: 0.2835 - acc: 0.9159 - val_loss: 0.5807 - val_acc: 0.8025
Epoch 12/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2335 - acc: 0.9373
64/74 [========================>.....] - ETA: 0s - loss: 0.2312 - acc: 0.9351
74/74 [==============================] - 1s 17ms/step - loss: 0.2298 - acc: 0.9365 - val_loss: 0.5479 - val_acc: 0.8217
Epoch 13/70

32/74 [===========>..................] - ETA: 0s - loss: 0.1400 - acc: 0.9581
64/74 [========================>.....] - ETA: 0s - loss: 0.1822 - acc: 0.9426
74/74 [==============================] - 1s 17ms/step - loss: 0.1945 - acc: 0.9411 - val_loss: 0.5441 - val_acc: 0.8089
Epoch 14/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2415 - acc: 0.9493
64/74 [========================>.....] - ETA: 0s - loss: 0.2220 - acc: 0.9449
74/74 [==============================] - 1s 16ms/step - loss: 0.2145 - acc: 0.9441 - val_loss: 0.6046 - val_acc: 0.8153
Epoch 15/70

32/74 [===========>..................] - ETA: 0s - loss: 0.1538 - acc: 0.9498
64/74 [========================>.....] - ETA: 0s - loss: 0.1645 - acc: 0.9446
74/74 [==============================] - 1s 17ms/step - loss: 0.1716 - acc: 0.9418 - val_loss: 0.5113 - val_acc: 0.8153
Epoch 16/70

32/74 [===========>..................] - ETA: 0s - loss: 0.1912 - acc: 0.9531
64/74 [========================>.....] - ETA: 0s - loss: 0.1709 - acc: 0.9582
74/74 [==============================] - 1s 16ms/step - loss: 0.1715 - acc: 0.9560 - val_loss: 0.5848 - val_acc: 0.8025
Epoch 17/70

32/74 [===========>..................] - ETA: 0s - loss: 0.1499 - acc: 0.9558
64/74 [========================>.....] - ETA: 0s - loss: 0.1500 - acc: 0.9580
74/74 [==============================] - 1s 17ms/step - loss: 0.1449 - acc: 0.9590 - val_loss: 0.5474 - val_acc: 0.8280
Computing...
Manual evaluation: (didn't understand why I made this)
True 7709
False 1362
True percentage 0.849851174071
Sklearn evaluation:
             precision    recall  f1-score   support

     B-MISC       0.50      0.02      0.04       141
     I-MISC       0.29      0.06      0.11       154
          O       0.93      0.95      0.94      7318
      B-PER       0.79      0.60      0.68       438
      I-PER       0.68      0.43      0.53       214
      B-ORG       0.61      0.46      0.52       296
      B-LOC       0.72      0.58      0.64       218
      I-ORG       0.36      0.18      0.24       151
      I-LOC       0.75      0.48      0.58       141

avg / total       0.87      0.85      0.85      9071

F-1 Score:
0.879931487297
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 83 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100128 unique words.
Found 94 unique chars.
Found 9 unique labels.
124 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 308
OOV word occurences: 571
Padding...
Data padded!
Padding...
Data padded!
Padded until 67 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 67, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 67)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 67, 64)       6408256     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 67, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 67, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 67, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 67, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 67, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,911,362
Trainable params: 6,911,362
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 74 samples, validate on 9 samples
Epoch 1/70

32/74 [===========>..................] - ETA: 3s - loss: 2.3851 - acc: 0.0203
64/74 [========================>.....] - ETA: 0s - loss: 1.6673 - acc: 0.4078
74/74 [==============================] - 4s 52ms/step - loss: 1.5645 - acc: 0.4599 - val_loss: 1.6817 - val_acc: 0.7819
Epoch 2/70

32/74 [===========>..................] - ETA: 0s - loss: 1.8924 - acc: 0.7965
64/74 [========================>.....] - ETA: 0s - loss: 1.4927 - acc: 0.7995
74/74 [==============================] - 1s 20ms/step - loss: 1.3889 - acc: 0.7983 - val_loss: 0.7389 - val_acc: 0.7819
Epoch 3/70

32/74 [===========>..................] - ETA: 0s - loss: 0.8011 - acc: 0.7779
64/74 [========================>.....] - ETA: 0s - loss: 0.7229 - acc: 0.8016
74/74 [==============================] - 2s 20ms/step - loss: 0.7202 - acc: 0.8005 - val_loss: 0.6900 - val_acc: 0.7872
Epoch 4/70

32/74 [===========>..................] - ETA: 0s - loss: 0.6238 - acc: 0.8121
64/74 [========================>.....] - ETA: 0s - loss: 0.5949 - acc: 0.8223
74/74 [==============================] - 1s 19ms/step - loss: 0.6180 - acc: 0.8137 - val_loss: 0.6350 - val_acc: 0.8404
Epoch 5/70

32/74 [===========>..................] - ETA: 0s - loss: 0.5438 - acc: 0.8441
64/74 [========================>.....] - ETA: 0s - loss: 0.5612 - acc: 0.8247
74/74 [==============================] - 1s 20ms/step - loss: 0.5617 - acc: 0.8254 - val_loss: 0.5691 - val_acc: 0.8404
Epoch 6/70

32/74 [===========>..................] - ETA: 0s - loss: 0.5263 - acc: 0.8380
64/74 [========================>.....] - ETA: 0s - loss: 0.5141 - acc: 0.8466
74/74 [==============================] - 1s 19ms/step - loss: 0.5075 - acc: 0.8473 - val_loss: 0.5294 - val_acc: 0.8351
Epoch 7/70

32/74 [===========>..................] - ETA: 0s - loss: 0.5218 - acc: 0.8310
64/74 [========================>.....] - ETA: 0s - loss: 0.4747 - acc: 0.8542
74/74 [==============================] - 1s 19ms/step - loss: 0.4706 - acc: 0.8539 - val_loss: 0.4988 - val_acc: 0.8564
Epoch 8/70

32/74 [===========>..................] - ETA: 0s - loss: 0.3976 - acc: 0.8685
64/74 [========================>.....] - ETA: 0s - loss: 0.4119 - acc: 0.8613
74/74 [==============================] - 1s 19ms/step - loss: 0.4153 - acc: 0.8632 - val_loss: 0.5308 - val_acc: 0.8351
Epoch 9/70

32/74 [===========>..................] - ETA: 0s - loss: 0.3504 - acc: 0.8798
64/74 [========================>.....] - ETA: 0s - loss: 0.4137 - acc: 0.8627
74/74 [==============================] - 1s 19ms/step - loss: 0.4020 - acc: 0.8689 - val_loss: 0.4503 - val_acc: 0.8670
Epoch 10/70

32/74 [===========>..................] - ETA: 0s - loss: 0.4156 - acc: 0.8552
64/74 [========================>.....] - ETA: 0s - loss: 0.3721 - acc: 0.8768
74/74 [==============================] - 1s 19ms/step - loss: 0.3616 - acc: 0.8814 - val_loss: 0.4226 - val_acc: 0.8564
Epoch 11/70

32/74 [===========>..................] - ETA: 0s - loss: 0.3260 - acc: 0.8811
64/74 [========================>.....] - ETA: 0s - loss: 0.3299 - acc: 0.8901
74/74 [==============================] - 1s 19ms/step - loss: 0.3277 - acc: 0.8900 - val_loss: 0.4304 - val_acc: 0.8883
Epoch 12/70

32/74 [===========>..................] - ETA: 0s - loss: 0.3259 - acc: 0.8982
64/74 [========================>.....] - ETA: 0s - loss: 0.2989 - acc: 0.9034
74/74 [==============================] - 1s 19ms/step - loss: 0.3072 - acc: 0.9037 - val_loss: 0.4161 - val_acc: 0.8670
Epoch 13/70

32/74 [===========>..................] - ETA: 0s - loss: 0.3087 - acc: 0.9055
64/74 [========================>.....] - ETA: 0s - loss: 0.2879 - acc: 0.9087
74/74 [==============================] - 1s 19ms/step - loss: 0.2750 - acc: 0.9148 - val_loss: 0.3762 - val_acc: 0.8723
Epoch 14/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2408 - acc: 0.9129
64/74 [========================>.....] - ETA: 0s - loss: 0.2466 - acc: 0.9168
74/74 [==============================] - 1s 19ms/step - loss: 0.2517 - acc: 0.9178 - val_loss: 0.4009 - val_acc: 0.8777
Epoch 15/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2394 - acc: 0.9294
64/74 [========================>.....] - ETA: 0s - loss: 0.2385 - acc: 0.9327
74/74 [==============================] - 1s 19ms/step - loss: 0.2424 - acc: 0.9280 - val_loss: 0.3582 - val_acc: 0.8989
Epoch 16/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2390 - acc: 0.9370
64/74 [========================>.....] - ETA: 0s - loss: 0.2208 - acc: 0.9463
74/74 [==============================] - 1s 19ms/step - loss: 0.2134 - acc: 0.9463 - val_loss: 0.3785 - val_acc: 0.8777
Epoch 17/70

32/74 [===========>..................] - ETA: 0s - loss: 0.1892 - acc: 0.9495
64/74 [========================>.....] - ETA: 0s - loss: 0.2094 - acc: 0.9302
74/74 [==============================] - 1s 19ms/step - loss: 0.2144 - acc: 0.9310 - val_loss: 0.3816 - val_acc: 0.8723
Computing...
Manual evaluation: (didn't understand why I made this)
True 7593
False 1478
True percentage 0.837063168339
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.95      0.94      7318
      B-PER       0.75      0.43      0.55       438
      B-ORG       0.65      0.49      0.56       296
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.17      0.01      0.01       154
      I-ORG       0.41      0.16      0.23       151
      B-LOC       0.61      0.57      0.59       218
      I-LOC       0.55      0.71      0.62       141
      I-PER       0.87      0.19      0.31       214

avg / total       0.86      0.84      0.84      9071

F-1 Score:
0.457415565345
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 83 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100101 unique words.
Found 94 unique chars.
Found 9 unique labels.
97 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 317
OOV word occurences: 536
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6406528     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,909,634
Trainable params: 6,909,634
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 74 samples, validate on 9 samples
Epoch 1/70

32/74 [===========>..................] - ETA: 3s - loss: 2.1813 - acc: 0.1433
64/74 [========================>.....] - ETA: 0s - loss: 1.5768 - acc: 0.4625
74/74 [==============================] - 4s 49ms/step - loss: 1.5936 - acc: 0.5067 - val_loss: 1.3867 - val_acc: 0.7366
Epoch 2/70

32/74 [===========>..................] - ETA: 0s - loss: 1.3470 - acc: 0.7320
64/74 [========================>.....] - ETA: 0s - loss: 1.0857 - acc: 0.7695
74/74 [==============================] - 1s 16ms/step - loss: 1.0282 - acc: 0.7783 - val_loss: 0.6899 - val_acc: 0.8118
Epoch 3/70

32/74 [===========>..................] - ETA: 0s - loss: 0.5556 - acc: 0.8444
64/74 [========================>.....] - ETA: 0s - loss: 0.6473 - acc: 0.8109
74/74 [==============================] - 1s 16ms/step - loss: 0.6353 - acc: 0.8177 - val_loss: 0.6256 - val_acc: 0.8118
Epoch 4/70

32/74 [===========>..................] - ETA: 0s - loss: 0.6400 - acc: 0.7902
64/74 [========================>.....] - ETA: 0s - loss: 0.5694 - acc: 0.8150
74/74 [==============================] - 1s 17ms/step - loss: 0.5466 - acc: 0.8267 - val_loss: 0.5880 - val_acc: 0.8280
Epoch 5/70

32/74 [===========>..................] - ETA: 0s - loss: 0.4654 - acc: 0.8494
64/74 [========================>.....] - ETA: 0s - loss: 0.4730 - acc: 0.8572
74/74 [==============================] - 1s 17ms/step - loss: 0.4753 - acc: 0.8527 - val_loss: 0.5283 - val_acc: 0.8333
Epoch 6/70

32/74 [===========>..................] - ETA: 0s - loss: 0.4652 - acc: 0.8593
64/74 [========================>.....] - ETA: 0s - loss: 0.4041 - acc: 0.8756
74/74 [==============================] - 1s 17ms/step - loss: 0.3980 - acc: 0.8785 - val_loss: 0.4823 - val_acc: 0.8441
Epoch 7/70

32/74 [===========>..................] - ETA: 0s - loss: 0.3732 - acc: 0.8688
64/74 [========================>.....] - ETA: 0s - loss: 0.4083 - acc: 0.8831
74/74 [==============================] - 1s 16ms/step - loss: 0.3818 - acc: 0.8904 - val_loss: 0.4695 - val_acc: 0.8387
Epoch 8/70

32/74 [===========>..................] - ETA: 0s - loss: 0.3071 - acc: 0.8920
64/74 [========================>.....] - ETA: 0s - loss: 0.3399 - acc: 0.8893
74/74 [==============================] - 1s 17ms/step - loss: 0.3262 - acc: 0.8954 - val_loss: 0.4350 - val_acc: 0.8495
Epoch 9/70

32/74 [===========>..................] - ETA: 0s - loss: 0.3048 - acc: 0.9078
64/74 [========================>.....] - ETA: 0s - loss: 0.2811 - acc: 0.9185
74/74 [==============================] - 1s 17ms/step - loss: 0.2745 - acc: 0.9204 - val_loss: 0.3937 - val_acc: 0.8871
Epoch 10/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2548 - acc: 0.9223
64/74 [========================>.....] - ETA: 0s - loss: 0.2338 - acc: 0.9268
74/74 [==============================] - 1s 17ms/step - loss: 0.2438 - acc: 0.9264 - val_loss: 0.3638 - val_acc: 0.8925
Epoch 11/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2873 - acc: 0.9191
64/74 [========================>.....] - ETA: 0s - loss: 0.2948 - acc: 0.9053
74/74 [==============================] - 1s 16ms/step - loss: 0.2834 - acc: 0.9139 - val_loss: 0.3592 - val_acc: 0.8925
Epoch 12/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2302 - acc: 0.9497
64/74 [========================>.....] - ETA: 0s - loss: 0.2473 - acc: 0.9324
74/74 [==============================] - 1s 17ms/step - loss: 0.2375 - acc: 0.9379 - val_loss: 0.4081 - val_acc: 0.8817
Epoch 13/70

32/74 [===========>..................] - ETA: 0s - loss: 0.2105 - acc: 0.9330
64/74 [========================>.....] - ETA: 0s - loss: 0.2051 - acc: 0.9424
74/74 [==============================] - 1s 17ms/step - loss: 0.2069 - acc: 0.9434 - val_loss: 0.3261 - val_acc: 0.9032
Epoch 14/70

32/74 [===========>..................] - ETA: 0s - loss: 0.1603 - acc: 0.9574
64/74 [========================>.....] - ETA: 0s - loss: 0.1865 - acc: 0.9487
74/74 [==============================] - 1s 16ms/step - loss: 0.1828 - acc: 0.9500 - val_loss: 0.3490 - val_acc: 0.8871
Epoch 15/70

32/74 [===========>..................] - ETA: 0s - loss: 0.1337 - acc: 0.9583
64/74 [========================>.....] - ETA: 0s - loss: 0.1757 - acc: 0.9477
74/74 [==============================] - 1s 16ms/step - loss: 0.1692 - acc: 0.9487 - val_loss: 0.2911 - val_acc: 0.9140
Epoch 16/70

32/74 [===========>..................] - ETA: 0s - loss: 0.1230 - acc: 0.9737
64/74 [========================>.....] - ETA: 0s - loss: 0.1333 - acc: 0.9639
74/74 [==============================] - 1s 16ms/step - loss: 0.1515 - acc: 0.9574 - val_loss: 0.2570 - val_acc: 0.9194
Epoch 17/70

32/74 [===========>..................] - ETA: 0s - loss: 0.1573 - acc: 0.9603
64/74 [========================>.....] - ETA: 0s - loss: 0.1603 - acc: 0.9557
74/74 [==============================] - 1s 16ms/step - loss: 0.1508 - acc: 0.9588 - val_loss: 0.3278 - val_acc: 0.8978
Epoch 18/70

32/74 [===========>..................] - ETA: 0s - loss: 0.1258 - acc: 0.9603
64/74 [========================>.....] - ETA: 0s - loss: 0.1285 - acc: 0.9631
74/74 [==============================] - 1s 16ms/step - loss: 0.1353 - acc: 0.9615 - val_loss: 0.2638 - val_acc: 0.9086
Computing...
Manual evaluation: (didn't understand why I made this)
True 7484
False 1587
True percentage 0.825046852607
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.95      0.94      7318
      B-ORG       0.46      0.36      0.40       296
      I-ORG       0.20      0.21      0.21       151
      B-PER       0.80      0.45      0.58       438
     B-MISC       0.21      0.07      0.11       141
     I-MISC       0.15      0.24      0.18       154
      B-LOC       0.90      0.34      0.50       218
      I-LOC       0.80      0.03      0.05       141
      I-PER       0.75      0.28      0.40       214

avg / total       0.87      0.83      0.83      9071

F-1 Score:
0.364273204904
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 33 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100039 unique words.
Found 92 unique chars.
Found 9 unique labels.
35 unique words not found in embedding.
8 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 322
OOV word occurences: 628
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6402560     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,905,538
Trainable params: 6,905,538
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 29 samples, validate on 4 samples
Epoch 1/70

29/29 [==============================] - 3s 101ms/step - loss: 2.1188 - acc: 0.3730 - val_loss: 0.9222 - val_acc: 0.7938
Epoch 2/70

29/29 [==============================] - 0s 17ms/step - loss: 0.9591 - acc: 0.7940 - val_loss: 0.8115 - val_acc: 0.7938
Epoch 3/70

29/29 [==============================] - 0s 17ms/step - loss: 0.7781 - acc: 0.7940 - val_loss: 1.4191 - val_acc: 0.7320
Epoch 4/70

29/29 [==============================] - 0s 16ms/step - loss: 1.3362 - acc: 0.7158 - val_loss: 0.7285 - val_acc: 0.7938
Epoch 5/70

29/29 [==============================] - 0s 17ms/step - loss: 0.6953 - acc: 0.7940 - val_loss: 0.6690 - val_acc: 0.8041
Epoch 6/70

29/29 [==============================] - 0s 16ms/step - loss: 0.6100 - acc: 0.8082 - val_loss: 0.6196 - val_acc: 0.8041
Epoch 7/70

29/29 [==============================] - 0s 17ms/step - loss: 0.5457 - acc: 0.8153 - val_loss: 0.5899 - val_acc: 0.8557
Epoch 8/70

29/29 [==============================] - 1s 18ms/step - loss: 0.5129 - acc: 0.8721 - val_loss: 0.6211 - val_acc: 0.8144
Epoch 9/70

29/29 [==============================] - 1s 17ms/step - loss: 0.4875 - acc: 0.8242 - val_loss: 0.5770 - val_acc: 0.8763
Epoch 10/70

29/29 [==============================] - 0s 16ms/step - loss: 0.4932 - acc: 0.8845 - val_loss: 0.5078 - val_acc: 0.8454
Epoch 11/70

29/29 [==============================] - 0s 16ms/step - loss: 0.3621 - acc: 0.8721 - val_loss: 0.4222 - val_acc: 0.8866
Epoch 12/70

29/29 [==============================] - 0s 16ms/step - loss: 0.3398 - acc: 0.8917 - val_loss: 0.4216 - val_acc: 0.8866
Epoch 13/70

29/29 [==============================] - 0s 16ms/step - loss: 0.2902 - acc: 0.9201 - val_loss: 0.3784 - val_acc: 0.8866
Epoch 14/70

29/29 [==============================] - 0s 17ms/step - loss: 0.2792 - acc: 0.9165 - val_loss: 0.4632 - val_acc: 0.8763
Epoch 15/70

29/29 [==============================] - 0s 17ms/step - loss: 0.2778 - acc: 0.9218 - val_loss: 0.3419 - val_acc: 0.8763
Epoch 16/70

29/29 [==============================] - 0s 17ms/step - loss: 0.2298 - acc: 0.9414 - val_loss: 0.3607 - val_acc: 0.8866
Epoch 17/70

29/29 [==============================] - 0s 16ms/step - loss: 0.2055 - acc: 0.9361 - val_loss: 0.3237 - val_acc: 0.9175
Epoch 18/70

29/29 [==============================] - 0s 16ms/step - loss: 0.2167 - acc: 0.9378 - val_loss: 0.4665 - val_acc: 0.8763
Epoch 19/70

29/29 [==============================] - 0s 16ms/step - loss: 0.2682 - acc: 0.9076 - val_loss: 0.4187 - val_acc: 0.8969
Computing...
Manual evaluation: (didn't understand why I made this)
True 6990
False 2081
True percentage 0.770587586815
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.90      0.93      7318
      B-PER       0.62      0.26      0.36       438
      B-LOC       0.21      0.50      0.29       218
      B-ORG       0.25      0.20      0.22       296
      I-ORG       0.18      0.30      0.23       151
      I-PER       1.00      0.01      0.03       214
      I-LOC       0.12      0.33      0.18       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.85      0.77      0.79      9071

F-1 Score:
0.224276767074
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 33 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100062 unique words.
Found 94 unique chars.
Found 9 unique labels.
58 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 319
OOV word occurences: 618
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6404032     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,907,138
Trainable params: 6,907,138
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 29 samples, validate on 4 samples
Epoch 1/70

29/29 [==============================] - 3s 100ms/step - loss: 2.1044 - acc: 0.4378 - val_loss: 0.7608 - val_acc: 0.8795
Epoch 2/70

29/29 [==============================] - 1s 17ms/step - loss: 0.9173 - acc: 0.8122 - val_loss: 1.4354 - val_acc: 0.8795
Epoch 3/70

29/29 [==============================] - 0s 17ms/step - loss: 2.4047 - acc: 0.8122 - val_loss: 1.0047 - val_acc: 0.8675
Computing...
Manual evaluation: (didn't understand why I made this)
True 7027
False 2044
True percentage 0.774666519678
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.86      0.95      0.90      7318
      B-ORG       0.10      0.03      0.04       296
      B-LOC       0.00      0.00      0.00       218
      I-ORG       0.19      0.31      0.24       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-PER       0.00      0.00      0.00       438
      I-PER       0.00      0.00      0.00       214
      I-LOC       0.00      0.00      0.00       141

avg / total       0.70      0.77      0.73      9071

F-1 Score:
0.052757793765
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 33 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100044 unique words.
Found 94 unique chars.
Found 9 unique labels.
40 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 324
OOV word occurences: 560
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6402880     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,905,986
Trainable params: 6,905,986
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 29 samples, validate on 4 samples
Epoch 1/70

29/29 [==============================] - 3s 99ms/step - loss: 2.3228 - acc: 0.0202 - val_loss: 0.9410 - val_acc: 0.8000
Epoch 2/70

29/29 [==============================] - 0s 17ms/step - loss: 0.7737 - acc: 0.8445 - val_loss: 1.7986 - val_acc: 0.8000
Epoch 3/70

29/29 [==============================] - 0s 17ms/step - loss: 1.8291 - acc: 0.8445 - val_loss: 1.0815 - val_acc: 0.8000
Computing...
Manual evaluation: (didn't understand why I made this)
True 7037
False 2034
True percentage 0.775768933965
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.83      0.96      0.89      7318
      B-PER       0.38      0.02      0.04       438
      B-ORG       0.50      0.00      0.01       296
      I-ORG       0.00      0.00      0.00       151
      I-PER       0.00      0.00      0.00       214
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.70      0.78      0.72      9071

F-1 Score:
0.0123526108928
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 33 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100044 unique words.
Found 94 unique chars.
Found 9 unique labels.
40 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 320
OOV word occurences: 543
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6402880     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,905,986
Trainable params: 6,905,986
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 29 samples, validate on 4 samples
Epoch 1/70

29/29 [==============================] - 3s 101ms/step - loss: 2.4785 - acc: 0.0284 - val_loss: 0.8640 - val_acc: 0.8148
Epoch 2/70

29/29 [==============================] - 0s 17ms/step - loss: 0.9703 - acc: 0.7867 - val_loss: 1.5630 - val_acc: 0.8148
Epoch 3/70

29/29 [==============================] - 0s 17ms/step - loss: 1.7691 - acc: 0.7899 - val_loss: 1.5907 - val_acc: 0.7531
Computing...
Manual evaluation: (didn't understand why I made this)
True 5883
False 3188
True percentage 0.648550325212
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.76      0.86      7318
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-ORG       0.08      0.64      0.14       296
      I-ORG       0.10      0.01      0.02       151
      B-PER       0.42      0.08      0.14       438
      I-PER       0.00      0.00      0.00       214
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.23      0.56      0.33       141

avg / total       0.82      0.65      0.71      9071

F-1 Score:
0.133594429939
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 33 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100031 unique words.
Found 93 unique chars.
Found 9 unique labels.
27 unique words not found in embedding.
9 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 321
OOV word occurences: 620
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6402048     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,905,090
Trainable params: 6,905,090
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 29 samples, validate on 4 samples
Epoch 1/70

29/29 [==============================] - 3s 99ms/step - loss: 2.2268 - acc: 0.1190 - val_loss: 0.9078 - val_acc: 0.8171
Epoch 2/70

29/29 [==============================] - 1s 17ms/step - loss: 0.9925 - acc: 0.7674 - val_loss: 1.7030 - val_acc: 0.8171
Epoch 3/70

29/29 [==============================] - 1s 17ms/step - loss: 1.8100 - acc: 0.7674 - val_loss: 1.4513 - val_acc: 0.8049
Computing...
Manual evaluation: (didn't understand why I made this)
True 6530
False 2541
True percentage 0.7198765296
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.86      0.91      7318
      B-ORG       0.00      0.00      0.00       296
      B-LOC       0.11      0.81      0.19       218
      B-PER       0.58      0.05      0.09       438
      I-PER       0.00      0.00      0.00       214
     B-MISC       0.00      0.00      0.00       141
      I-ORG       0.00      0.00      0.00       151
      I-LOC       0.07      0.12      0.09       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.81      0.72      0.75      9071

F-1 Score:
0.116684841876
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 33 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100037 unique words.
Found 94 unique chars.
Found 9 unique labels.
33 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 325
OOV word occurences: 636
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6402432     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,905,538
Trainable params: 6,905,538
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 29 samples, validate on 4 samples
Epoch 1/70

29/29 [==============================] - 3s 100ms/step - loss: 2.2725 - acc: 0.0260 - val_loss: 0.6786 - val_acc: 0.8687
Epoch 2/70

29/29 [==============================] - 0s 17ms/step - loss: 0.9055 - acc: 0.7955 - val_loss: 0.8836 - val_acc: 0.8889
Epoch 3/70

29/29 [==============================] - 0s 16ms/step - loss: 1.0954 - acc: 0.8160 - val_loss: 1.0538 - val_acc: 0.8687
Computing...
Manual evaluation: (didn't understand why I made this)
True 7031
False 2040
True percentage 0.775107485393
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.83      0.96      0.89      7318
      B-PER       0.00      0.00      0.00       438
      B-ORG       0.00      0.00      0.00       296
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
      I-ORG       0.00      0.00      0.00       151
      I-PER       0.00      0.00      0.00       214
     B-MISC       0.00      0.00      0.00       141

avg / total       0.67      0.78      0.72      9071

F-1 Score:
0.0
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 33 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100051 unique words.
Found 94 unique chars.
Found 9 unique labels.
47 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 320
OOV word occurences: 627
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6403328     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,906,434
Trainable params: 6,906,434
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 29 samples, validate on 4 samples
Epoch 1/70

29/29 [==============================] - 3s 100ms/step - loss: 2.4766 - acc: 0.0188 - val_loss: 1.0191 - val_acc: 0.7879
Epoch 2/70

29/29 [==============================] - 0s 17ms/step - loss: 0.9864 - acc: 0.7881 - val_loss: 2.9548 - val_acc: 0.7879
Epoch 3/70

29/29 [==============================] - 0s 16ms/step - loss: 2.6052 - acc: 0.7881 - val_loss: 1.1875 - val_acc: 0.7879
Computing...
Manual evaluation: (didn't understand why I made this)
True 6962
False 2109
True percentage 0.767500826811
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.87      0.94      0.90      7318
      B-PER       0.00      0.00      0.00       438
      B-LOC       0.00      0.00      0.00       218
      B-ORG       0.00      0.00      0.00       296
      I-PER       0.00      0.00      0.00       214
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      I-LOC       0.00      0.00      0.00       141
      I-ORG       0.15      0.52      0.23       151

avg / total       0.70      0.77      0.73      9071

F-1 Score:
0.0691466083151
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 33 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100053 unique words.
Found 94 unique chars.
Found 9 unique labels.
49 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 318
OOV word occurences: 529
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6403456     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,906,562
Trainable params: 6,906,562
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 29 samples, validate on 4 samples
Epoch 1/70

29/29 [==============================] - 3s 103ms/step - loss: 2.5736 - acc: 0.0367 - val_loss: 0.8563 - val_acc: 0.8710
Epoch 2/70

29/29 [==============================] - 0s 17ms/step - loss: 1.0656 - acc: 0.7815 - val_loss: 1.5838 - val_acc: 0.8710
Epoch 3/70

29/29 [==============================] - 0s 16ms/step - loss: 2.8752 - acc: 0.7815 - val_loss: 0.8538 - val_acc: 0.8710
Epoch 4/70

29/29 [==============================] - 0s 16ms/step - loss: 1.0432 - acc: 0.7863 - val_loss: 0.6636 - val_acc: 0.8710
Epoch 5/70

29/29 [==============================] - 0s 16ms/step - loss: 0.9631 - acc: 0.7815 - val_loss: 0.7137 - val_acc: 0.8710
Epoch 6/70

29/29 [==============================] - 0s 16ms/step - loss: 0.8860 - acc: 0.7895 - val_loss: 0.5602 - val_acc: 0.8710
Epoch 7/70

29/29 [==============================] - 0s 16ms/step - loss: 0.7664 - acc: 0.7831 - val_loss: 0.5485 - val_acc: 0.8710
Epoch 8/70

29/29 [==============================] - 0s 17ms/step - loss: 0.7206 - acc: 0.7895 - val_loss: 0.5178 - val_acc: 0.8710
Epoch 9/70

29/29 [==============================] - 1s 17ms/step - loss: 0.6870 - acc: 0.7911 - val_loss: 0.4942 - val_acc: 0.8710
Epoch 10/70

29/29 [==============================] - 0s 17ms/step - loss: 0.6353 - acc: 0.7911 - val_loss: 0.4704 - val_acc: 0.8710
Epoch 11/70

29/29 [==============================] - 0s 16ms/step - loss: 0.6128 - acc: 0.8086 - val_loss: 0.4424 - val_acc: 0.8710
Epoch 12/70

29/29 [==============================] - 0s 16ms/step - loss: 0.5675 - acc: 0.8182 - val_loss: 0.4169 - val_acc: 0.8710
Epoch 13/70

29/29 [==============================] - 0s 16ms/step - loss: 0.5287 - acc: 0.8341 - val_loss: 0.3958 - val_acc: 0.8710
Epoch 14/70

29/29 [==============================] - 0s 16ms/step - loss: 0.5032 - acc: 0.8373 - val_loss: 0.3801 - val_acc: 0.8710
Epoch 15/70

29/29 [==============================] - 0s 17ms/step - loss: 0.4606 - acc: 0.8517 - val_loss: 0.3601 - val_acc: 0.8710
Epoch 16/70

29/29 [==============================] - 0s 16ms/step - loss: 0.4298 - acc: 0.8596 - val_loss: 0.3512 - val_acc: 0.8710
Epoch 17/70

29/29 [==============================] - 0s 16ms/step - loss: 0.4051 - acc: 0.8565 - val_loss: 0.3441 - val_acc: 0.9032
Epoch 18/70

29/29 [==============================] - 0s 16ms/step - loss: 0.4110 - acc: 0.8931 - val_loss: 0.3502 - val_acc: 0.8871
Epoch 19/70

29/29 [==============================] - 0s 16ms/step - loss: 0.3852 - acc: 0.8644 - val_loss: 0.3263 - val_acc: 0.9032
Epoch 20/70

29/29 [==============================] - 0s 16ms/step - loss: 0.3654 - acc: 0.9123 - val_loss: 0.3154 - val_acc: 0.9032
Epoch 21/70

29/29 [==============================] - 0s 17ms/step - loss: 0.3292 - acc: 0.8931 - val_loss: 0.2940 - val_acc: 0.9194
Epoch 22/70

29/29 [==============================] - 0s 16ms/step - loss: 0.3002 - acc: 0.9155 - val_loss: 0.2944 - val_acc: 0.9194
Epoch 23/70

29/29 [==============================] - 0s 16ms/step - loss: 0.2816 - acc: 0.9187 - val_loss: 0.2723 - val_acc: 0.9032
Epoch 24/70

29/29 [==============================] - 0s 16ms/step - loss: 0.2517 - acc: 0.9362 - val_loss: 0.2751 - val_acc: 0.9032
Epoch 25/70

29/29 [==============================] - 0s 16ms/step - loss: 0.2364 - acc: 0.9378 - val_loss: 0.2717 - val_acc: 0.9194
Epoch 26/70

29/29 [==============================] - 0s 16ms/step - loss: 0.2321 - acc: 0.9426 - val_loss: 0.2738 - val_acc: 0.9032
Epoch 27/70

29/29 [==============================] - 0s 17ms/step - loss: 0.2298 - acc: 0.9298 - val_loss: 0.2688 - val_acc: 0.9194
Epoch 28/70

29/29 [==============================] - 0s 17ms/step - loss: 0.2372 - acc: 0.9490 - val_loss: 0.2657 - val_acc: 0.8871
Epoch 29/70

29/29 [==============================] - 0s 16ms/step - loss: 0.2019 - acc: 0.9410 - val_loss: 0.2327 - val_acc: 0.9516
Epoch 30/70

29/29 [==============================] - 0s 16ms/step - loss: 0.1831 - acc: 0.9681 - val_loss: 0.2300 - val_acc: 0.9032
Epoch 31/70

29/29 [==============================] - 0s 16ms/step - loss: 0.1653 - acc: 0.9585 - val_loss: 0.2269 - val_acc: 0.9194
Epoch 32/70

29/29 [==============================] - 0s 16ms/step - loss: 0.1467 - acc: 0.9761 - val_loss: 0.2284 - val_acc: 0.9032
Epoch 33/70

29/29 [==============================] - 0s 16ms/step - loss: 0.1363 - acc: 0.9665 - val_loss: 0.2413 - val_acc: 0.9032
Computing...
Manual evaluation: (didn't understand why I made this)
True 7334
False 1737
True percentage 0.808510638298
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.91      0.95      0.93      7318
      B-ORG       0.45      0.46      0.46       296
      I-ORG       0.37      0.18      0.24       151
      B-PER       0.63      0.25      0.36       438
      B-LOC       0.78      0.27      0.40       218
      I-LOC       0.67      0.03      0.05       141
      I-PER       0.66      0.15      0.25       214
     B-MISC       0.01      0.01      0.01       141
     I-MISC       0.20      0.18      0.19       154

avg / total       0.83      0.81      0.81      9071

F-1 Score:
0.297792742237
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 33 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100060 unique words.
Found 94 unique chars.
Found 9 unique labels.
56 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 318
OOV word occurences: 519
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6403904     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,907,010
Trainable params: 6,907,010
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 29 samples, validate on 4 samples
Epoch 1/70

29/29 [==============================] - 3s 99ms/step - loss: 2.2186 - acc: 0.1333 - val_loss: 1.1765 - val_acc: 0.7143
Epoch 2/70

29/29 [==============================] - 1s 17ms/step - loss: 0.8840 - acc: 0.8071 - val_loss: 2.1526 - val_acc: 0.7143
Epoch 3/70

29/29 [==============================] - 0s 17ms/step - loss: 1.3455 - acc: 0.8071 - val_loss: 1.5019 - val_acc: 0.7143
Computing...
Manual evaluation: (didn't understand why I made this)
True 7072
False 1999
True percentage 0.779627383971
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.84      0.96      0.90      7318
      B-ORG       0.40      0.05      0.10       296
      I-ORG       0.00      0.00      0.00       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-PER       0.52      0.03      0.05       438
      B-LOC       0.62      0.05      0.09       218
      I-LOC       0.27      0.06      0.09       141
      I-PER       0.44      0.06      0.10       214

avg / total       0.75      0.78      0.73      9071

F-1 Score:
0.0584915341201
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 33 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100050 unique words.
Found 94 unique chars.
Found 9 unique labels.
46 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 317
OOV word occurences: 617
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6403264     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,906,370
Trainable params: 6,906,370
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 29 samples, validate on 4 samples
Epoch 1/70

29/29 [==============================] - 3s 100ms/step - loss: 2.3452 - acc: 0.0125 - val_loss: 0.8569 - val_acc: 0.8276
Epoch 2/70

29/29 [==============================] - 0s 17ms/step - loss: 0.8737 - acc: 0.8182 - val_loss: 0.8365 - val_acc: 0.8276
Epoch 3/70

29/29 [==============================] - 0s 16ms/step - loss: 0.7717 - acc: 0.8182 - val_loss: 1.1475 - val_acc: 0.8506
Epoch 4/70

29/29 [==============================] - 0s 16ms/step - loss: 1.1537 - acc: 0.8401 - val_loss: 0.9901 - val_acc: 0.8276
Computing...
Manual evaluation: (didn't understand why I made this)
True 7047
False 2024
True percentage 0.776871348253
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.00      0.00      0.00       438
          O       0.83      0.96      0.89      7318
      B-ORG       0.00      0.00      0.00       296
     B-MISC       0.00      0.00      0.00       141
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      I-PER       0.00      0.00      0.00       214
      I-ORG       0.00      0.00      0.00       151

avg / total       0.67      0.78      0.72      9071

F-1 Score:
0.824837595833
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 33 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100048 unique words.
Found 93 unique chars.
Found 9 unique labels.
44 unique words not found in embedding.
9 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 323
OOV word occurences: 626
Padding...
Data padded!
Padding...
Data padded!
Padded until 58 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 58, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 58)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 58, 64)       6403136     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 58, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 58, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 58, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 58, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 58, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,906,178
Trainable params: 6,906,178
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 29 samples, validate on 4 samples
Epoch 1/70

29/29 [==============================] - 3s 100ms/step - loss: 2.3601 - acc: 0.0232 - val_loss: 0.8154 - val_acc: 0.9277
Epoch 2/70

29/29 [==============================] - 1s 17ms/step - loss: 1.0145 - acc: 0.8065 - val_loss: 0.7755 - val_acc: 0.9277
Epoch 3/70

29/29 [==============================] - 0s 17ms/step - loss: 2.3462 - acc: 0.8065 - val_loss: 0.8166 - val_acc: 0.9277
Epoch 4/70

29/29 [==============================] - 0s 17ms/step - loss: 0.9655 - acc: 0.8111 - val_loss: 0.3881 - val_acc: 0.9277
Epoch 5/70

29/29 [==============================] - 0s 17ms/step - loss: 0.6985 - acc: 0.8065 - val_loss: 0.3707 - val_acc: 0.9277
Epoch 6/70

29/29 [==============================] - 0s 17ms/step - loss: 0.6337 - acc: 0.8065 - val_loss: 0.3363 - val_acc: 0.9277
Epoch 7/70

29/29 [==============================] - 0s 17ms/step - loss: 0.5942 - acc: 0.8080 - val_loss: 0.3220 - val_acc: 0.9277
Epoch 8/70

29/29 [==============================] - 0s 16ms/step - loss: 0.5610 - acc: 0.8251 - val_loss: 0.2992 - val_acc: 0.9277
Epoch 9/70

29/29 [==============================] - 0s 17ms/step - loss: 0.4972 - acc: 0.8344 - val_loss: 0.2760 - val_acc: 0.9277
Epoch 10/70

29/29 [==============================] - 1s 18ms/step - loss: 0.4573 - acc: 0.8514 - val_loss: 0.2511 - val_acc: 0.9277
Epoch 11/70

29/29 [==============================] - 0s 17ms/step - loss: 0.4080 - acc: 0.8653 - val_loss: 0.2350 - val_acc: 0.9518
Epoch 12/70

29/29 [==============================] - 0s 17ms/step - loss: 0.3701 - acc: 0.8715 - val_loss: 0.2136 - val_acc: 0.9639
Epoch 13/70

29/29 [==============================] - 0s 16ms/step - loss: 0.3328 - acc: 0.8963 - val_loss: 0.2197 - val_acc: 0.9639
Epoch 14/70

29/29 [==============================] - 0s 16ms/step - loss: 0.2995 - acc: 0.9149 - val_loss: 0.2148 - val_acc: 0.9398
Computing...
Manual evaluation: (didn't understand why I made this)
True 7087
False 1984
True percentage 0.781281005402
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.62      0.08      0.14       438
          O       0.84      0.96      0.90      7318
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
      I-PER       0.00      0.00      0.00       214
      B-ORG       0.70      0.07      0.13       296
      I-ORG       0.00      0.00      0.00       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.73      0.78      0.73      9071

F-1 Score:
0.828643599836
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 33 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100048 unique words.
Found 93 unique chars.
Found 9 unique labels.
44 unique words not found in embedding.
9 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 324
OOV word occurences: 630
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6403136     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,906,178
Trainable params: 6,906,178
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 29 samples, validate on 4 samples
Epoch 1/70

29/29 [==============================] - 3s 100ms/step - loss: 2.3207 - acc: 0.0017 - val_loss: 0.8398 - val_acc: 0.8167
Epoch 2/70

29/29 [==============================] - 0s 17ms/step - loss: 0.9111 - acc: 0.7980 - val_loss: 1.0028 - val_acc: 0.8167
Epoch 3/70

29/29 [==============================] - 0s 16ms/step - loss: 0.9734 - acc: 0.8030 - val_loss: 1.8799 - val_acc: 0.8167
Computing...
Manual evaluation: (didn't understand why I made this)
True 7037
False 2034
True percentage 0.775768933965
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.83      0.96      0.89      7318
      B-ORG       0.00      0.00      0.00       296
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-PER       0.00      0.00      0.00       438
      B-LOC       0.00      0.00      0.00       218
      I-ORG       0.00      0.00      0.00       151
      I-PER       0.00      0.00      0.00       214
      I-LOC       0.00      0.00      0.00       141

avg / total       0.67      0.78      0.72      9071

F-1 Score:
0.0
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 33 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100047 unique words.
Found 93 unique chars.
Found 9 unique labels.
43 unique words not found in embedding.
9 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 322
OOV word occurences: 626
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6403072     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,906,114
Trainable params: 6,906,114
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 29 samples, validate on 4 samples
Epoch 1/70

29/29 [==============================] - 3s 98ms/step - loss: 2.4496 - acc: 0.0440 - val_loss: 0.7162 - val_acc: 0.8816
Epoch 2/70

29/29 [==============================] - 0s 17ms/step - loss: 0.8083 - acc: 0.8365 - val_loss: 1.1663 - val_acc: 0.8816
Epoch 3/70

29/29 [==============================] - 0s 16ms/step - loss: 1.5412 - acc: 0.8365 - val_loss: 1.2993 - val_acc: 0.8421
Computing...
Manual evaluation: (didn't understand why I made this)
True 6809
False 2262
True percentage 0.750633888215
Sklearn evaluation:
             precision    recall  f1-score   support

     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
          O       0.92      0.91      0.91      7318
      B-PER       0.00      0.00      0.00       438
      I-PER       0.00      0.00      0.00       214
      B-ORG       0.13      0.51      0.20       296
      B-LOC       0.00      0.00      0.00       218
      I-ORG       0.00      0.00      0.00       151
      I-LOC       0.00      0.00      0.00       141

avg / total       0.74      0.75      0.74      9071

F-1 Score:
0.783769784173
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 33 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100044 unique words.
Found 94 unique chars.
Found 9 unique labels.
40 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 323
OOV word occurences: 630
Padding...
Data padded!
Padding...
Data padded!
Padded until 67 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 67, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 67)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 67, 64)       6402880     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 67, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 67, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 67, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 67, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 67, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,905,986
Trainable params: 6,905,986
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 29 samples, validate on 4 samples
Epoch 1/70

29/29 [==============================] - 3s 102ms/step - loss: 2.2406 - acc: 0.0735 - val_loss: 0.8250 - val_acc: 0.8370
Epoch 2/70

29/29 [==============================] - 1s 20ms/step - loss: 1.0341 - acc: 0.7672 - val_loss: 2.2813 - val_acc: 0.8370
Epoch 3/70

29/29 [==============================] - 1s 19ms/step - loss: 2.9688 - acc: 0.7672 - val_loss: 0.9205 - val_acc: 0.8370
Computing...
Manual evaluation: (didn't understand why I made this)
True 7029
False 2042
True percentage 0.774887002536
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.83      0.96      0.89      7318
      B-PER       0.00      0.00      0.00       438
      B-ORG       0.00      0.00      0.00       296
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      I-ORG       0.00      0.00      0.00       151
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
      I-PER       0.00      0.00      0.00       214

avg / total       0.67      0.77      0.72      9071

F-1 Score:
0.0
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 33 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100052 unique words.
Found 94 unique chars.
Found 9 unique labels.
48 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 322
OOV word occurences: 623
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6403392     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,906,498
Trainable params: 6,906,498
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 29 samples, validate on 4 samples
Epoch 1/70

29/29 [==============================] - 3s 99ms/step - loss: 2.3144 - acc: 0.0659 - val_loss: 0.5774 - val_acc: 0.8837
Epoch 2/70

29/29 [==============================] - 0s 17ms/step - loss: 0.8426 - acc: 0.8199 - val_loss: 0.4669 - val_acc: 0.8837
Epoch 3/70

29/29 [==============================] - 0s 17ms/step - loss: 0.7483 - acc: 0.8199 - val_loss: 1.5004 - val_acc: 0.6047
Epoch 4/70

29/29 [==============================] - 0s 17ms/step - loss: 1.5024 - acc: 0.5788 - val_loss: 0.4708 - val_acc: 0.8837
Computing...
Manual evaluation: (didn't understand why I made this)
True 7042
False 2029
True percentage 0.776320141109
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.83      0.96      0.89      7318
      B-ORG       0.00      0.00      0.00       296
      I-ORG       0.00      0.00      0.00       151
      B-PER       0.20      0.00      0.00       438
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
      I-PER       0.00      0.00      0.00       214

avg / total       0.68      0.78      0.72      9071

F-1 Score:
0.00113765642776
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 16 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100019 unique words.
Found 88 unique chars.
Found 9 unique labels.
15 unique words not found in embedding.
4 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 323
OOV word occurences: 631
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5696        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6401280     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,904,002
Trainable params: 6,904,002
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 14 samples, validate on 2 samples
Epoch 1/70

14/14 [==============================] - 3s 196ms/step - loss: 2.4823 - acc: 0.0249 - val_loss: 0.5470 - val_acc: 0.9333
Epoch 2/70

14/14 [==============================] - 0s 24ms/step - loss: 0.9834 - acc: 0.7829 - val_loss: 0.4180 - val_acc: 0.9333
Epoch 3/70

14/14 [==============================] - 0s 23ms/step - loss: 1.4879 - acc: 0.7829 - val_loss: 1.3728 - val_acc: 0.9000
Epoch 4/70

14/14 [==============================] - 0s 23ms/step - loss: 1.5371 - acc: 0.7224 - val_loss: 0.5892 - val_acc: 0.9333
Computing...
Manual evaluation: (didn't understand why I made this)
True 7031
False 2040
True percentage 0.775107485393
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.83      0.96      0.89      7318
      B-PER       1.00      0.01      0.01       438
      B-LOC       0.00      0.00      0.00       218
      B-ORG       0.00      0.00      0.00       296
      I-ORG       0.00      0.00      0.00       151
      I-PER       0.00      0.00      0.00       214
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.72      0.78      0.72      9071

F-1 Score:
0.00340715502555
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 16 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100033 unique words.
Found 94 unique chars.
Found 9 unique labels.
29 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 324
OOV word occurences: 634
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6402176     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,905,282
Trainable params: 6,905,282
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 14 samples, validate on 2 samples
Epoch 1/70

14/14 [==============================] - 3s 191ms/step - loss: 2.1863 - acc: 0.0844 - val_loss: 0.5394 - val_acc: 0.9000
Epoch 2/70

14/14 [==============================] - 0s 24ms/step - loss: 0.9188 - acc: 0.8047 - val_loss: 0.6320 - val_acc: 0.9000
Epoch 3/70

14/14 [==============================] - 0s 24ms/step - loss: 0.8741 - acc: 0.8074 - val_loss: 1.5089 - val_acc: 0.5667
Computing...
Manual evaluation: (didn't understand why I made this)
True 5100
False 3971
True percentage 0.562231286517
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.67      0.79      7318
      B-ORG       0.05      0.37      0.09       296
      B-LOC       0.00      0.00      0.00       218
      I-ORG       0.08      0.64      0.14       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-PER       0.00      0.00      0.00       438
      I-PER       0.00      0.00      0.00       214
      I-LOC       0.00      0.00      0.00       141

avg / total       0.79      0.56      0.64      9071

F-1 Score:
0.0800621842208
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 16 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100024 unique words.
Found 93 unique chars.
Found 9 unique labels.
20 unique words not found in embedding.
9 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 324
OOV word occurences: 560
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6401600     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,904,642
Trainable params: 6,904,642
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 14 samples, validate on 2 samples
Epoch 1/70

14/14 [==============================] - 3s 199ms/step - loss: 2.2305 - acc: 0.0819 - val_loss: 0.6939 - val_acc: 0.8913
Epoch 2/70

14/14 [==============================] - 0s 24ms/step - loss: 0.7303 - acc: 0.8635 - val_loss: 1.4437 - val_acc: 0.8913
Epoch 3/70

14/14 [==============================] - 0s 24ms/step - loss: 1.7887 - acc: 0.8635 - val_loss: 0.6171 - val_acc: 0.8913
Epoch 4/70

14/14 [==============================] - 0s 23ms/step - loss: 0.6645 - acc: 0.8635 - val_loss: 0.5443 - val_acc: 0.8913
Epoch 5/70

14/14 [==============================] - 0s 23ms/step - loss: 0.6387 - acc: 0.8635 - val_loss: 0.5579 - val_acc: 0.8913
Epoch 6/70

14/14 [==============================] - 0s 23ms/step - loss: 0.5854 - acc: 0.8635 - val_loss: 0.4278 - val_acc: 0.8913
Epoch 7/70

14/14 [==============================] - 0s 24ms/step - loss: 0.5108 - acc: 0.8635 - val_loss: 0.4569 - val_acc: 0.8913
Epoch 8/70

14/14 [==============================] - 0s 24ms/step - loss: 0.4865 - acc: 0.8669 - val_loss: 0.3944 - val_acc: 0.8913
Epoch 9/70

14/14 [==============================] - 0s 24ms/step - loss: 0.4284 - acc: 0.8669 - val_loss: 0.3880 - val_acc: 0.8913
Epoch 10/70

14/14 [==============================] - 0s 24ms/step - loss: 0.4118 - acc: 0.8669 - val_loss: 0.3590 - val_acc: 0.8913
Epoch 11/70

14/14 [==============================] - 0s 23ms/step - loss: 0.3666 - acc: 0.8908 - val_loss: 0.3452 - val_acc: 0.8913
Epoch 12/70

14/14 [==============================] - 0s 24ms/step - loss: 0.3204 - acc: 0.8908 - val_loss: 0.3164 - val_acc: 0.8913
Epoch 13/70

14/14 [==============================] - 0s 26ms/step - loss: 0.2781 - acc: 0.9078 - val_loss: 0.3095 - val_acc: 0.8913
Epoch 14/70

14/14 [==============================] - 0s 24ms/step - loss: 0.2472 - acc: 0.9352 - val_loss: 0.3084 - val_acc: 0.8913
Epoch 15/70

14/14 [==============================] - 0s 25ms/step - loss: 0.2340 - acc: 0.9147 - val_loss: 0.5283 - val_acc: 0.8043
Epoch 16/70

14/14 [==============================] - 0s 24ms/step - loss: 0.3828 - acc: 0.9010 - val_loss: 0.4841 - val_acc: 0.8696
Computing...
Manual evaluation: (didn't understand why I made this)
True 7138
False 1933
True percentage 0.786903318267
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.84      0.96      0.90      7318
      B-PER       0.63      0.13      0.22       438
      B-ORG       0.67      0.19      0.30       296
      I-ORG       0.00      0.00      0.00       151
      I-PER       0.00      0.00      0.00       214
      B-LOC       1.00      0.00      0.01       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.76      0.79      0.74      9071

F-1 Score:
0.11923276309
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 16 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100026 unique words.
Found 94 unique chars.
Found 9 unique labels.
22 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 323
OOV word occurences: 627
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6401728     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,904,834
Trainable params: 6,904,834
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 14 samples, validate on 2 samples
Epoch 1/70

14/14 [==============================] - 3s 192ms/step - loss: 2.1403 - acc: 0.1953 - val_loss: 0.9123 - val_acc: 0.8088
Epoch 2/70

14/14 [==============================] - 0s 24ms/step - loss: 0.8848 - acc: 0.7980 - val_loss: 1.0389 - val_acc: 0.8088
Epoch 3/70

14/14 [==============================] - 0s 23ms/step - loss: 0.7615 - acc: 0.7980 - val_loss: 0.9770 - val_acc: 0.8088
Computing...
Manual evaluation: (didn't understand why I made this)
True 7060
False 2011
True percentage 0.778304486826
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.85      0.96      0.90      7318
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-ORG       0.31      0.03      0.06       296
      I-ORG       0.50      0.01      0.01       151
      B-PER       0.00      0.00      0.00       438
      I-PER       0.00      0.00      0.00       214
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.23      0.21      0.22       141

avg / total       0.71      0.78      0.73      9071

F-1 Score:
0.0426638917794
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 16 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100013 unique words.
Found 92 unique chars.
Found 8 unique labels.
9 unique words not found in embedding.
8 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 328
OOV word occurences: 641
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6400896     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 9)        3564        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,903,468
Trainable params: 6,903,468
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 14 samples, validate on 2 samples
Epoch 1/70

14/14 [==============================] - 3s 192ms/step - loss: 2.2138 - acc: 0.0337 - val_loss: 1.3172 - val_acc: 0.5882
Epoch 2/70

14/14 [==============================] - 0s 24ms/step - loss: 0.9854 - acc: 0.7715 - val_loss: 1.3098 - val_acc: 0.5882
Epoch 3/70

14/14 [==============================] - 0s 23ms/step - loss: 1.0223 - acc: 0.7678 - val_loss: 3.1673 - val_acc: 0.5882
Epoch 4/70

14/14 [==============================] - 0s 23ms/step - loss: 1.8362 - acc: 0.7715 - val_loss: 1.2353 - val_acc: 0.5882
Epoch 5/70

14/14 [==============================] - 0s 23ms/step - loss: 0.9483 - acc: 0.7903 - val_loss: 1.2610 - val_acc: 0.5882
Epoch 6/70

14/14 [==============================] - 0s 23ms/step - loss: 0.7292 - acc: 0.7715 - val_loss: 1.1929 - val_acc: 0.5882
Epoch 7/70

14/14 [==============================] - 0s 23ms/step - loss: 0.6656 - acc: 0.7865 - val_loss: 1.1824 - val_acc: 0.5882
Epoch 8/70

14/14 [==============================] - 0s 24ms/step - loss: 0.6223 - acc: 0.7790 - val_loss: 1.1252 - val_acc: 0.5882
Epoch 9/70

14/14 [==============================] - 0s 24ms/step - loss: 0.5554 - acc: 0.7978 - val_loss: 1.1047 - val_acc: 0.5882
Epoch 10/70

14/14 [==============================] - 0s 23ms/step - loss: 0.4975 - acc: 0.8427 - val_loss: 1.0946 - val_acc: 0.5882
Epoch 11/70

14/14 [==============================] - 0s 23ms/step - loss: 0.4602 - acc: 0.8539 - val_loss: 1.2330 - val_acc: 0.6176
Epoch 12/70

14/14 [==============================] - 0s 24ms/step - loss: 0.4634 - acc: 0.8614 - val_loss: 1.0193 - val_acc: 0.5882
Epoch 13/70

14/14 [==============================] - 0s 26ms/step - loss: 0.4290 - acc: 0.8577 - val_loss: 0.9866 - val_acc: 0.5882
Epoch 14/70

14/14 [==============================] - 0s 24ms/step - loss: 0.3415 - acc: 0.9139 - val_loss: 0.9910 - val_acc: 0.5882
Epoch 15/70

14/14 [==============================] - 0s 24ms/step - loss: 0.2952 - acc: 0.9101 - val_loss: 0.9528 - val_acc: 0.5882
Epoch 16/70

14/14 [==============================] - 0s 23ms/step - loss: 0.2639 - acc: 0.9326 - val_loss: 0.9782 - val_acc: 0.5882
Epoch 17/70

14/14 [==============================] - 0s 23ms/step - loss: 0.2312 - acc: 0.9288 - val_loss: 0.8937 - val_acc: 0.6471
Epoch 18/70

14/14 [==============================] - 0s 23ms/step - loss: 0.2191 - acc: 0.9513 - val_loss: 1.2610 - val_acc: 0.6176
Epoch 19/70

14/14 [==============================] - 0s 23ms/step - loss: 0.2394 - acc: 0.8727 - val_loss: 0.9169 - val_acc: 0.6176
Computing...
Manual evaluation: (didn't understand why I made this)
True 6632
False 2285
True percentage 0.743747897275
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.84      0.90      7318
      B-ORG       0.14      0.52      0.22       296
      B-LOC       0.34      0.51      0.41       218
      B-PER       0.40      0.16      0.22       438
      I-PER       0.67      0.07      0.13       214
     B-MISC       0.00      0.00      0.00       141
      I-ORG       0.16      0.06      0.09       151
      I-LOC       0.28      0.82      0.42       141

avg / total       0.86      0.74      0.78      8917

F-1 Score:
0.256341068538
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 16 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100019 unique words.
Found 91 unique chars.
Found 9 unique labels.
15 unique words not found in embedding.
7 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 325
OOV word occurences: 636
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5888        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6401280     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,904,194
Trainable params: 6,904,194
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 14 samples, validate on 2 samples
Epoch 1/70

14/14 [==============================] - 3s 195ms/step - loss: 2.3005 - acc: 0.0445 - val_loss: 1.2813 - val_acc: 0.6757
Epoch 2/70

14/14 [==============================] - 0s 24ms/step - loss: 0.8450 - acc: 0.8421 - val_loss: 4.0507 - val_acc: 0.6757
Epoch 3/70

14/14 [==============================] - 0s 23ms/step - loss: 1.7833 - acc: 0.8421 - val_loss: 1.2796 - val_acc: 0.6757
Epoch 4/70

14/14 [==============================] - 0s 24ms/step - loss: 0.7914 - acc: 0.8462 - val_loss: 1.3206 - val_acc: 0.6757
Epoch 5/70

14/14 [==============================] - 0s 23ms/step - loss: 0.6468 - acc: 0.8421 - val_loss: 1.1774 - val_acc: 0.6757
Epoch 6/70

14/14 [==============================] - 0s 23ms/step - loss: 0.5793 - acc: 0.8421 - val_loss: 1.2099 - val_acc: 0.6757
Epoch 7/70

14/14 [==============================] - 0s 24ms/step - loss: 0.5610 - acc: 0.8421 - val_loss: 1.1550 - val_acc: 0.6757
Epoch 8/70

14/14 [==============================] - 0s 24ms/step - loss: 0.5088 - acc: 0.8421 - val_loss: 1.1448 - val_acc: 0.6757
Epoch 9/70

14/14 [==============================] - 0s 23ms/step - loss: 0.4704 - acc: 0.8421 - val_loss: 1.1063 - val_acc: 0.6757
Epoch 10/70

14/14 [==============================] - 0s 23ms/step - loss: 0.4389 - acc: 0.8502 - val_loss: 1.0937 - val_acc: 0.6757
Epoch 11/70

14/14 [==============================] - 0s 24ms/step - loss: 0.3967 - acc: 0.8502 - val_loss: 1.0429 - val_acc: 0.6757
Epoch 12/70

14/14 [==============================] - 0s 25ms/step - loss: 0.3616 - acc: 0.8866 - val_loss: 1.1123 - val_acc: 0.6757
Epoch 13/70

14/14 [==============================] - 0s 24ms/step - loss: 0.3382 - acc: 0.8543 - val_loss: 1.0100 - val_acc: 0.7027
Epoch 14/70

14/14 [==============================] - 0s 25ms/step - loss: 0.3187 - acc: 0.9109 - val_loss: 1.1089 - val_acc: 0.6757
Epoch 15/70

14/14 [==============================] - 0s 24ms/step - loss: 0.2718 - acc: 0.8907 - val_loss: 0.9560 - val_acc: 0.7027
Epoch 16/70

14/14 [==============================] - 0s 23ms/step - loss: 0.2418 - acc: 0.9514 - val_loss: 1.0442 - val_acc: 0.7027
Epoch 17/70

14/14 [==============================] - 0s 23ms/step - loss: 0.2148 - acc: 0.9231 - val_loss: 0.9157 - val_acc: 0.7027
Epoch 18/70

14/14 [==============================] - 0s 23ms/step - loss: 0.1760 - acc: 0.9676 - val_loss: 1.0102 - val_acc: 0.7027
Epoch 19/70

14/14 [==============================] - 0s 24ms/step - loss: 0.1625 - acc: 0.9433 - val_loss: 0.8861 - val_acc: 0.7297
Epoch 20/70

14/14 [==============================] - 0s 22ms/step - loss: 0.1677 - acc: 0.9717 - val_loss: 1.2058 - val_acc: 0.7027
Epoch 21/70

14/14 [==============================] - 0s 23ms/step - loss: 0.1661 - acc: 0.9271 - val_loss: 0.7705 - val_acc: 0.7568
Epoch 22/70

14/14 [==============================] - 0s 23ms/step - loss: 0.1464 - acc: 0.9919 - val_loss: 0.9542 - val_acc: 0.7027
Epoch 23/70

14/14 [==============================] - 0s 24ms/step - loss: 0.1040 - acc: 0.9879 - val_loss: 0.8623 - val_acc: 0.7568
Computing...
Manual evaluation: (didn't understand why I made this)
True 7132
False 1939
True percentage 0.786241869695
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.87      0.95      0.91      7318
      B-PER       0.46      0.18      0.26       438
      B-ORG       0.35      0.20      0.26       296
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.22      0.03      0.05       218
      I-LOC       0.00      0.00      0.00       141
      I-ORG       0.30      0.13      0.18       151
      I-PER       0.53      0.04      0.07       214
     B-MISC       0.00      0.00      0.00       141

avg / total       0.76      0.79      0.76      9071

F-1 Score:
0.15666965085
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 16 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100031 unique words.
Found 94 unique chars.
Found 9 unique labels.
27 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 324
OOV word occurences: 635
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6402048     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,905,154
Trainable params: 6,905,154
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 14 samples, validate on 2 samples
Epoch 1/70

14/14 [==============================] - 3s 193ms/step - loss: 2.2429 - acc: 0.0726 - val_loss: 1.3160 - val_acc: 0.6047
Epoch 2/70

14/14 [==============================] - 0s 24ms/step - loss: 0.9800 - acc: 0.7792 - val_loss: 1.7536 - val_acc: 0.6047
Epoch 3/70

14/14 [==============================] - 0s 24ms/step - loss: 1.1126 - acc: 0.7792 - val_loss: 1.6970 - val_acc: 0.5581
Computing...
Manual evaluation: (didn't understand why I made this)
True 6588
False 2483
True percentage 0.726270532466
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.86      0.90      7318
      B-PER       0.38      0.19      0.25       438
      B-LOC       0.32      0.27      0.29       218
      B-ORG       0.10      0.45      0.16       296
      I-PER       0.00      0.00      0.00       214
     B-MISC       0.00      0.00      0.00       141
     I-MISC       1.00      0.01      0.01       154
      I-LOC       0.00      0.00      0.00       141
      I-ORG       0.17      0.03      0.05       151

avg / total       0.81      0.73      0.75      9071

F-1 Score:
0.157864849517
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 16 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100032 unique words.
Found 94 unique chars.
Found 9 unique labels.
28 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 321
OOV word occurences: 533
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6402112     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,905,218
Trainable params: 6,905,218
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 14 samples, validate on 2 samples
Epoch 1/70

14/14 [==============================] - 3s 193ms/step - loss: 2.2534 - acc: 0.0528 - val_loss: 0.9428 - val_acc: 0.7903
Epoch 2/70

14/14 [==============================] - 0s 24ms/step - loss: 0.9320 - acc: 0.7923 - val_loss: 1.5702 - val_acc: 0.7903
Epoch 3/70

14/14 [==============================] - 0s 24ms/step - loss: 1.3212 - acc: 0.7923 - val_loss: 1.5369 - val_acc: 0.7742
Computing...
Manual evaluation: (didn't understand why I made this)
True 6912
False 2159
True percentage 0.761988755374
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.89      0.92      0.90      7318
      B-ORG       0.15      0.39      0.22       296
      I-ORG       0.00      0.00      0.00       151
      B-PER       0.43      0.19      0.26       438
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
      I-PER       0.00      0.00      0.00       214
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.74      0.76      0.75      9071

F-1 Score:
0.143690736689
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 16 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100034 unique words.
Found 91 unique chars.
Found 9 unique labels.
30 unique words not found in embedding.
7 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 324
OOV word occurences: 605
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5888        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6402240     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,905,154
Trainable params: 6,905,154
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 14 samples, validate on 2 samples
Epoch 1/70

14/14 [==============================] - 3s 194ms/step - loss: 2.2707 - acc: 0.0761 - val_loss: 1.2514 - val_acc: 0.7500
Epoch 2/70

14/14 [==============================] - 0s 24ms/step - loss: 0.9546 - acc: 0.7887 - val_loss: 2.0664 - val_acc: 0.7500
Epoch 3/70

14/14 [==============================] - 0s 24ms/step - loss: 2.0566 - acc: 0.7887 - val_loss: 1.4647 - val_acc: 0.7500
Computing...
Manual evaluation: (didn't understand why I made this)
True 7035
False 2036
True percentage 0.775548451108
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.85      0.95      0.90      7318
      B-ORG       0.11      0.08      0.09       296
      I-ORG       0.00      0.00      0.00       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-PER       0.43      0.04      0.07       438
      B-LOC       0.50      0.01      0.02       218
      I-LOC       0.18      0.02      0.04       141
      I-PER       0.00      0.00      0.00       214

avg / total       0.73      0.78      0.74      9071

F-1 Score:
0.0459657701711
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 16 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100021 unique words.
Found 94 unique chars.
Found 9 unique labels.
17 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 322
OOV word occurences: 624
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6401408     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,904,514
Trainable params: 6,904,514
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 14 samples, validate on 2 samples
Epoch 1/70

14/14 [==============================] - 3s 193ms/step - loss: 2.5159 - acc: 0.0214 - val_loss: 1.1058 - val_acc: 0.7500
Epoch 2/70

14/14 [==============================] - 0s 24ms/step - loss: 0.9038 - acc: 0.8000 - val_loss: 1.0194 - val_acc: 0.7500
Epoch 3/70

14/14 [==============================] - 0s 23ms/step - loss: 0.7553 - acc: 0.8000 - val_loss: 1.1318 - val_acc: 0.7500
Epoch 4/70

14/14 [==============================] - 0s 23ms/step - loss: 0.7655 - acc: 0.8000 - val_loss: 1.4792 - val_acc: 0.6923
Computing...
Manual evaluation: (didn't understand why I made this)
True 6900
False 2171
True percentage 0.76066585823
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.25      0.28      0.26       438
          O       0.96      0.90      0.93      7318
      B-ORG       0.19      0.52      0.28       296
     B-MISC       0.00      0.00      0.00       141
      B-LOC       0.42      0.14      0.21       218
      I-LOC       0.00      0.00      0.00       141
     I-MISC       0.10      0.16      0.12       154
      I-PER       0.56      0.02      0.04       214
      I-ORG       0.04      0.01      0.01       151

avg / total       0.82      0.76      0.78      9071

F-1 Score:
0.816823330923
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 16 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100026 unique words.
Found 90 unique chars.
Found 9 unique labels.
22 unique words not found in embedding.
6 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 327
OOV word occurences: 632
Padding...
Data padded!
Padding...
Data padded!
Padded until 58 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 58, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5824        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 58)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 58, 64)       6401728     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 58, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 58, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 58, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 58, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 58, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,904,578
Trainable params: 6,904,578
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 14 samples, validate on 2 samples
Epoch 1/70

14/14 [==============================] - 3s 195ms/step - loss: 2.2610 - acc: 0.0365 - val_loss: 0.5928 - val_acc: 0.9286
Epoch 2/70

14/14 [==============================] - 0s 24ms/step - loss: 0.9764 - acc: 0.7508 - val_loss: 0.8398 - val_acc: 0.9286
Epoch 3/70

14/14 [==============================] - 0s 24ms/step - loss: 2.6305 - acc: 0.7508 - val_loss: 1.4558 - val_acc: 0.5357
Computing...
Manual evaluation: (didn't understand why I made this)
True 5312
False 3759
True percentage 0.585602469408
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.82      0.02      0.04       438
          O       0.97      0.70      0.81      7318
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
      I-PER       0.00      0.00      0.00       214
      B-ORG       0.07      0.70      0.12       296
      I-ORG       0.00      0.00      0.00       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.82      0.59      0.66      9071

F-1 Score:
0.621688159437
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 16 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100030 unique words.
Found 92 unique chars.
Found 7 unique labels.
26 unique words not found in embedding.
8 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 325
OOV word occurences: 632
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6401984     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 8)        3160        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,904,152
Trainable params: 6,904,152
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 14 samples, validate on 2 samples
Epoch 1/70

14/14 [==============================] - 3s 235ms/step - loss: 2.2575 - acc: 0.0141 - val_loss: 1.2888 - val_acc: 0.7442
Epoch 2/70

14/14 [==============================] - 0s 24ms/step - loss: 0.9522 - acc: 0.8099 - val_loss: 2.5886 - val_acc: 0.7442
Epoch 3/70

14/14 [==============================] - 0s 23ms/step - loss: 1.9330 - acc: 0.8099 - val_loss: 1.4141 - val_acc: 0.7442
Computing...
Manual evaluation: (didn't understand why I made this)
True 6988
False 1728
True percentage 0.801743919229
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.86      0.95      0.90      7318
      B-ORG       0.00      0.00      0.00       296
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.02      0.01      0.02       154
      B-PER       0.30      0.04      0.07       438
      B-LOC       0.00      0.00      0.00       218
      I-ORG       0.17      0.25      0.20       151

avg / total       0.74      0.80      0.76      8716

F-1 Score:
0.0626748740907
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 16 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100028 unique words.
Found 92 unique chars.
Found 9 unique labels.
24 unique words not found in embedding.
8 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 325
OOV word occurences: 630
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6401856     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,904,834
Trainable params: 6,904,834
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 14 samples, validate on 2 samples
Epoch 1/70

14/14 [==============================] - 3s 192ms/step - loss: 2.6313 - acc: 0.0000e+00 - val_loss: 0.8358 - val_acc: 0.8333
Epoch 2/70

14/14 [==============================] - 0s 24ms/step - loss: 0.8238 - acc: 0.8207 - val_loss: 1.4299 - val_acc: 0.8333
Epoch 3/70

14/14 [==============================] - 0s 23ms/step - loss: 1.4465 - acc: 0.8207 - val_loss: 1.5767 - val_acc: 0.6667
Computing...
Manual evaluation: (didn't understand why I made this)
True 5979
False 3092
True percentage 0.65913350237
Sklearn evaluation:
             precision    recall  f1-score   support

     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
          O       0.97      0.79      0.87      7318
      B-PER       0.50      0.00      0.00       438
      I-PER       0.00      0.00      0.00       214
      B-ORG       0.08      0.69      0.15       296
      B-LOC       0.00      0.00      0.00       218
      I-ORG       0.00      0.00      0.00       151
      I-LOC       0.00      0.00      0.00       141

avg / total       0.81      0.66      0.71      9071

F-1 Score:
0.6883886938
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 16 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100028 unique words.
Found 94 unique chars.
Found 9 unique labels.
24 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 326
OOV word occurences: 635
Padding...
Data padded!
Padding...
Data padded!
Padded until 67 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 67, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 67)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 67, 64)       6401856     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 67, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 67, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 67, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 67, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 67, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,904,962
Trainable params: 6,904,962
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 14 samples, validate on 2 samples
Epoch 1/70

14/14 [==============================] - 3s 198ms/step - loss: 2.4473 - acc: 0.0087 - val_loss: 0.8563 - val_acc: 0.7556
Epoch 2/70

14/14 [==============================] - 0s 27ms/step - loss: 0.9537 - acc: 0.7784 - val_loss: 1.9729 - val_acc: 0.7556
Epoch 3/70

14/14 [==============================] - 0s 27ms/step - loss: 1.7333 - acc: 0.7784 - val_loss: 1.6822 - val_acc: 0.4222
Computing...
Manual evaluation: (didn't understand why I made this)
True 3735
False 5336
True percentage 0.411751736303
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.48      0.65      7318
      B-PER       0.25      0.00      0.01       438
      B-ORG       0.04      0.72      0.08       296
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.10      0.01      0.01       154
      I-ORG       0.00      0.00      0.00       151
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
      I-PER       0.00      0.00      0.00       214

avg / total       0.81      0.41      0.53      9071

F-1 Score:
0.0655391120507
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 16 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100023 unique words.
Found 93 unique chars.
Found 9 unique labels.
19 unique words not found in embedding.
9 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 325
OOV word occurences: 627
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6401536     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,904,578
Trainable params: 6,904,578
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 14 samples, validate on 2 samples
Epoch 1/70

14/14 [==============================] - 3s 226ms/step - loss: 2.1850 - acc: 0.0853 - val_loss: 1.1699 - val_acc: 0.7500
Epoch 2/70

14/14 [==============================] - 0s 24ms/step - loss: 1.0812 - acc: 0.8055 - val_loss: 2.4581 - val_acc: 0.7500
Epoch 3/70

14/14 [==============================] - 0s 23ms/step - loss: 2.2479 - acc: 0.8055 - val_loss: 1.1561 - val_acc: 0.7812
Epoch 4/70

14/14 [==============================] - 0s 24ms/step - loss: 1.0172 - acc: 0.8191 - val_loss: 0.9243 - val_acc: 0.7500
Epoch 5/70

14/14 [==============================] - 0s 23ms/step - loss: 0.7339 - acc: 0.8055 - val_loss: 0.8992 - val_acc: 0.7500
Epoch 6/70

14/14 [==============================] - 0s 23ms/step - loss: 0.6698 - acc: 0.8123 - val_loss: 0.8954 - val_acc: 0.7500
Epoch 7/70

14/14 [==============================] - 0s 23ms/step - loss: 0.6101 - acc: 0.8089 - val_loss: 0.8509 - val_acc: 0.7500
Epoch 8/70

14/14 [==============================] - 0s 23ms/step - loss: 0.5793 - acc: 0.8225 - val_loss: 0.8524 - val_acc: 0.7500
Epoch 9/70

14/14 [==============================] - 0s 24ms/step - loss: 0.5267 - acc: 0.8089 - val_loss: 0.8030 - val_acc: 0.7812
Epoch 10/70

14/14 [==============================] - 0s 24ms/step - loss: 0.4615 - acc: 0.8464 - val_loss: 0.8043 - val_acc: 0.7812
Epoch 11/70

14/14 [==============================] - 0s 24ms/step - loss: 0.4235 - acc: 0.8532 - val_loss: 0.7618 - val_acc: 0.7812
Epoch 12/70

14/14 [==============================] - 0s 23ms/step - loss: 0.3860 - acc: 0.8840 - val_loss: 0.7616 - val_acc: 0.7812
Epoch 13/70

14/14 [==============================] - 0s 24ms/step - loss: 0.3253 - acc: 0.8908 - val_loss: 0.7427 - val_acc: 0.7812
Epoch 14/70

14/14 [==============================] - 0s 24ms/step - loss: 0.2884 - acc: 0.9078 - val_loss: 0.7946 - val_acc: 0.7812
Epoch 15/70

14/14 [==============================] - 0s 25ms/step - loss: 0.2567 - acc: 0.9113 - val_loss: 0.7571 - val_acc: 0.7812
Computing...
Manual evaluation: (didn't understand why I made this)
True 7002
False 2069
True percentage 0.77191048396
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.88      0.94      0.91      7318
      B-ORG       0.20      0.06      0.09       296
      I-ORG       0.00      0.00      0.00       151
      B-PER       0.49      0.12      0.19       438
     B-MISC       0.11      0.02      0.04       141
     I-MISC       0.08      0.19      0.11       154
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
      I-PER       0.00      0.00      0.00       214

avg / total       0.74      0.77      0.75      9071

F-1 Score:
0.0872142252329
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 8 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100013 unique words.
Found 84 unique chars.
Found 8 unique labels.
9 unique words not found in embedding.
0 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 328
OOV word occurences: 641
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5440        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6400896     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 9)        3564        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,902,956
Trainable params: 6,902,956
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 7 samples, validate on 1 samples
Epoch 1/70

7/7 [==============================] - 3s 377ms/step - loss: 2.0429 - acc: 0.2698 - val_loss: 0.7381 - val_acc: 0.8276
Epoch 2/70

7/7 [==============================] - 0s 38ms/step - loss: 1.0133 - acc: 0.7698 - val_loss: 1.1353 - val_acc: 0.8276
Epoch 3/70

7/7 [==============================] - 0s 35ms/step - loss: 0.9390 - acc: 0.7698 - val_loss: 1.5869 - val_acc: 0.4138
Computing...
Manual evaluation: (didn't understand why I made this)
True 3104
False 5813
True percentage 0.348099136481
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.40      0.57      7318
      B-PER       0.53      0.08      0.14       438
      B-LOC       0.18      0.13      0.15       218
      B-ORG       0.00      0.00      0.00       296
      I-ORG       0.02      0.82      0.05       151
      I-PER       0.00      0.00      0.00       214
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141

avg / total       0.83      0.35      0.48      8917

F-1 Score:
0.0532460136674
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 8 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100018 unique words.
Found 92 unique chars.
Found 9 unique labels.
14 unique words not found in embedding.
8 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 325
OOV word occurences: 635
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6401216     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,904,194
Trainable params: 6,904,194
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 7 samples, validate on 1 samples
Epoch 1/70

7/7 [==============================] - 3s 368ms/step - loss: 2.1666 - acc: 0.1049 - val_loss: 0.8117 - val_acc: 0.8421
Epoch 2/70

7/7 [==============================] - 0s 35ms/step - loss: 0.8676 - acc: 0.7963 - val_loss: 1.3406 - val_acc: 0.8421
Epoch 3/70

7/7 [==============================] - 0s 37ms/step - loss: 0.9970 - acc: 0.7963 - val_loss: 1.5011 - val_acc: 0.6842
Computing...
Manual evaluation: (didn't understand why I made this)
True 6078
False 2993
True percentage 0.670047403814
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.80      0.88      7318
      B-ORG       0.09      0.47      0.14       296
      B-LOC       0.00      0.00      0.00       218
      I-ORG       0.10      0.50      0.17       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-PER       0.00      0.00      0.00       438
      I-PER       0.00      0.00      0.00       214
      I-LOC       0.00      0.00      0.00       141

avg / total       0.78      0.67      0.71      9071

F-1 Score:
0.104343605921
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 8 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100016 unique words.
Found 91 unique chars.
Found 9 unique labels.
12 unique words not found in embedding.
7 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 324
OOV word occurences: 560
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5888        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6401088     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,904,002
Trainable params: 6,904,002
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 7 samples, validate on 1 samples
Epoch 1/70

7/7 [==============================] - 3s 372ms/step - loss: 2.2937 - acc: 0.0556 - val_loss: 0.5027 - val_acc: 0.9259
Epoch 2/70

7/7 [==============================] - 0s 35ms/step - loss: 0.7724 - acc: 0.8403 - val_loss: 0.6427 - val_acc: 0.9259
Epoch 3/70

7/7 [==============================] - 0s 36ms/step - loss: 1.3041 - acc: 0.8403 - val_loss: 1.1748 - val_acc: 0.9259
Computing...
Manual evaluation: (didn't understand why I made this)
True 6724
False 2347
True percentage 0.741263366773
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.87      0.91      7318
      B-PER       0.22      0.61      0.32       438
      B-ORG       0.00      0.00      0.00       296
      I-ORG       0.00      0.00      0.00       151
      I-PER       0.00      0.00      0.00       214
      B-LOC       0.18      0.53      0.27       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.78      0.74      0.75      9071

F-1 Score:
0.212070874862
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 8 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100015 unique words.
Found 94 unique chars.
Found 9 unique labels.
11 unique words not found in embedding.
10 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 326
OOV word occurences: 631
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6401024     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,904,130
Trainable params: 6,904,130
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 7 samples, validate on 1 samples
Epoch 1/70

7/7 [==============================] - 3s 373ms/step - loss: 2.4035 - acc: 0.0000e+00 - val_loss: 1.5744 - val_acc: 0.6364
Epoch 2/70

7/7 [==============================] - 0s 36ms/step - loss: 0.9622 - acc: 0.7919 - val_loss: 5.8612 - val_acc: 0.6364
Epoch 3/70

7/7 [==============================] - 0s 37ms/step - loss: 2.6898 - acc: 0.7919 - val_loss: 1.9984 - val_acc: 0.6364
Computing...
Manual evaluation: (didn't understand why I made this)
True 7028
False 2043
True percentage 0.774776761107
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.83      0.96      0.89      7318
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-ORG       0.00      0.00      0.00       296
      I-ORG       0.10      0.01      0.01       151
      B-PER       0.00      0.00      0.00       438
      I-PER       0.33      0.00      0.01       214
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141

avg / total       0.68      0.77      0.72      9071

F-1 Score:
0.00270486876377
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 8 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100009 unique words.
Found 92 unique chars.
Found 8 unique labels.
5 unique words not found in embedding.
8 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 328
OOV word occurences: 641
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6400640     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 9)        3564        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,903,212
Trainable params: 6,903,212
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 7 samples, validate on 1 samples
Epoch 1/70

7/7 [==============================] - 3s 381ms/step - loss: 2.2987 - acc: 0.0256 - val_loss: 1.3220 - val_acc: 0.6842
Epoch 2/70

7/7 [==============================] - 0s 37ms/step - loss: 1.1179 - acc: 0.7521 - val_loss: 3.4080 - val_acc: 0.6842
Epoch 3/70

7/7 [==============================] - 0s 37ms/step - loss: 2.9382 - acc: 0.7521 - val_loss: 1.2751 - val_acc: 0.5789
Epoch 4/70

7/7 [==============================] - 0s 35ms/step - loss: 1.2654 - acc: 0.6752 - val_loss: 0.9109 - val_acc: 0.6842
Epoch 5/70

7/7 [==============================] - 0s 37ms/step - loss: 0.7851 - acc: 0.7521 - val_loss: 0.8354 - val_acc: 0.6842
Epoch 6/70

7/7 [==============================] - 0s 36ms/step - loss: 0.7269 - acc: 0.7521 - val_loss: 0.7623 - val_acc: 0.6842
Epoch 7/70

7/7 [==============================] - 0s 35ms/step - loss: 0.6631 - acc: 0.7949 - val_loss: 0.7266 - val_acc: 0.6842
Epoch 8/70

7/7 [==============================] - 0s 38ms/step - loss: 0.6279 - acc: 0.8205 - val_loss: 0.7098 - val_acc: 0.6842
Epoch 9/70

7/7 [==============================] - 0s 37ms/step - loss: 0.5774 - acc: 0.8120 - val_loss: 0.6136 - val_acc: 0.7368
Epoch 10/70

7/7 [==============================] - 0s 38ms/step - loss: 0.5461 - acc: 0.8547 - val_loss: 0.6910 - val_acc: 0.6842
Epoch 11/70

7/7 [==============================] - 0s 38ms/step - loss: 0.4753 - acc: 0.8376 - val_loss: 0.5917 - val_acc: 0.8421
Epoch 12/70

7/7 [==============================] - 0s 35ms/step - loss: 0.4832 - acc: 0.8974 - val_loss: 0.7122 - val_acc: 0.6842
Epoch 13/70

7/7 [==============================] - 0s 37ms/step - loss: 0.3842 - acc: 0.8547 - val_loss: 0.5243 - val_acc: 0.8421
Epoch 14/70

7/7 [==============================] - 0s 37ms/step - loss: 0.3537 - acc: 0.9316 - val_loss: 0.5639 - val_acc: 0.7368
Epoch 15/70

7/7 [==============================] - 0s 35ms/step - loss: 0.3197 - acc: 0.8803 - val_loss: 0.4402 - val_acc: 0.8947
Epoch 16/70

7/7 [==============================] - 0s 37ms/step - loss: 0.2815 - acc: 0.9402 - val_loss: 0.7449 - val_acc: 0.7368
Epoch 17/70

7/7 [==============================] - 0s 38ms/step - loss: 0.2266 - acc: 0.9316 - val_loss: 0.3231 - val_acc: 0.9474
Epoch 18/70

7/7 [==============================] - 0s 40ms/step - loss: 0.2255 - acc: 0.9316 - val_loss: 0.7962 - val_acc: 0.6842
Epoch 19/70

7/7 [==============================] - 0s 39ms/step - loss: 0.2046 - acc: 0.9402 - val_loss: 0.3366 - val_acc: 0.8947
Computing...
Manual evaluation: (didn't understand why I made this)
True 7127
False 1790
True percentage 0.799259840754
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.90      0.94      0.92      7318
      B-ORG       0.50      0.02      0.04       296
      B-LOC       0.28      0.55      0.37       218
      B-PER       0.38      0.05      0.10       438
      I-PER       0.17      0.01      0.02       214
     B-MISC       0.09      0.02      0.03       141
      I-ORG       0.50      0.01      0.01       151
      I-LOC       0.34      0.59      0.43       141

avg / total       0.80      0.80      0.78      8917

F-1 Score:
0.200419287212
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 8 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100014 unique words.
Found 91 unique chars.
Found 8 unique labels.
10 unique words not found in embedding.
7 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 325
OOV word occurences: 636
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5888        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6400960     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 9)        3564        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,903,468
Trainable params: 6,903,468
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 7 samples, validate on 1 samples
Epoch 1/70

7/7 [==============================] - 3s 370ms/step - loss: 2.2049 - acc: 0.0000e+00 - val_loss: 1.0538 - val_acc: 0.7895
Epoch 2/70

7/7 [==============================] - 0s 37ms/step - loss: 0.9185 - acc: 0.8760 - val_loss: 3.3541 - val_acc: 0.7895
Epoch 3/70

7/7 [==============================] - 0s 36ms/step - loss: 1.3789 - acc: 0.8760 - val_loss: 1.0972 - val_acc: 0.7895
Computing...
Manual evaluation: (didn't understand why I made this)
True 7031
False 1899
True percentage 0.787346024636
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.83      0.96      0.89      7318
      B-PER       0.00      0.00      0.00       438
      B-ORG       0.00      0.00      0.00       296
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
      I-ORG       0.00      0.00      0.00       151
      I-PER       0.00      0.00      0.00       214

avg / total       0.68      0.79      0.73      8930

F-1 Score:
0.0
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 8 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100015 unique words.
Found 91 unique chars.
Found 9 unique labels.
11 unique words not found in embedding.
7 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 327
OOV word occurences: 638
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5888        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6401024     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,903,938
Trainable params: 6,903,938
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 7 samples, validate on 1 samples
Epoch 1/70

7/7 [==============================] - 3s 372ms/step - loss: 2.3346 - acc: 0.0458 - val_loss: 1.1524 - val_acc: 0.7200
Epoch 2/70

7/7 [==============================] - 0s 36ms/step - loss: 1.1541 - acc: 0.7124 - val_loss: 3.9180 - val_acc: 0.7200
Epoch 3/70

7/7 [==============================] - 0s 37ms/step - loss: 3.6298 - acc: 0.7124 - val_loss: 1.4142 - val_acc: 0.6800
Computing...
Manual evaluation: (didn't understand why I made this)
True 7013
False 2058
True percentage 0.773123139676
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.85      0.95      0.90      7318
      B-PER       0.57      0.05      0.09       438
      B-LOC       0.00      0.00      0.00       218
      B-ORG       0.00      0.00      0.00       296
      I-PER       0.00      0.00      0.00       214
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.10      0.05      0.07       154
      I-LOC       0.00      0.00      0.00       141
      I-ORG       0.18      0.19      0.18       151

avg / total       0.72      0.77      0.73      9071

F-1 Score:
0.0559646539028
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 8 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100021 unique words.
Found 91 unique chars.
Found 8 unique labels.
17 unique words not found in embedding.
7 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 323
OOV word occurences: 543
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5888        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6401408     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 9)        3564        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,903,916
Trainable params: 6,903,916
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 7 samples, validate on 1 samples
Epoch 1/70

7/7 [==============================] - 3s 370ms/step - loss: 2.0360 - acc: 0.2642 - val_loss: 1.5108 - val_acc: 0.6552
Epoch 2/70

7/7 [==============================] - 0s 36ms/step - loss: 0.9043 - acc: 0.8113 - val_loss: 1.9799 - val_acc: 0.6552
Epoch 3/70

7/7 [==============================] - 0s 36ms/step - loss: 0.8117 - acc: 0.8113 - val_loss: 1.8503 - val_acc: 0.3103
Computing...
Manual evaluation: (didn't understand why I made this)
True 5290
False 3627
True percentage 0.59324885051
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.70      0.81      7318
      B-ORG       0.50      0.00      0.01       296
      I-ORG       0.04      0.82      0.08       151
      B-PER       0.52      0.03      0.06       438
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
      I-PER       0.00      0.00      0.00       214
     B-MISC       0.00      0.00      0.00       141

avg / total       0.83      0.59      0.67      8917

F-1 Score:
0.0578737680856
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 8 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100019 unique words.
Found 91 unique chars.
Found 9 unique labels.
15 unique words not found in embedding.
7 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 326
OOV word occurences: 637
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5888        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6401280     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,904,194
Trainable params: 6,904,194
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 7 samples, validate on 1 samples
Epoch 1/70

7/7 [==============================] - 3s 375ms/step - loss: 2.6583 - acc: 0.0123 - val_loss: 1.0640 - val_acc: 0.8333
Epoch 2/70

7/7 [==============================] - 0s 40ms/step - loss: 0.9856 - acc: 0.7914 - val_loss: 1.6957 - val_acc: 0.8333
Epoch 3/70

7/7 [==============================] - 0s 39ms/step - loss: 2.5652 - acc: 0.7975 - val_loss: 1.6517 - val_acc: 0.2778
Computing...
Manual evaluation: (didn't understand why I made this)
True 4009
False 5062
True percentage 0.441957887774
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.52      0.68      7318
      B-ORG       0.00      0.00      0.00       296
      I-ORG       0.00      0.00      0.00       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-PER       0.00      0.00      0.00       438
      B-LOC       0.04      0.92      0.08       218
      I-LOC       0.05      0.01      0.02       141
      I-PER       0.00      0.00      0.00       214

avg / total       0.80      0.44      0.55      9071

F-1 Score:
0.0639746634996
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 8 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100012 unique words.
Found 89 unique chars.
Found 9 unique labels.
8 unique words not found in embedding.
5 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 324
OOV word occurences: 628
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5760        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6400832     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,903,618
Trainable params: 6,903,618
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 7 samples, validate on 1 samples
Epoch 1/70

7/7 [==============================] - 3s 371ms/step - loss: 2.3981 - acc: 0.0312 - val_loss: 1.3311 - val_acc: 0.6667
Epoch 2/70

7/7 [==============================] - 0s 36ms/step - loss: 1.0127 - acc: 0.8047 - val_loss: 4.5830 - val_acc: 0.6667
Epoch 3/70

7/7 [==============================] - 0s 37ms/step - loss: 2.2754 - acc: 0.8047 - val_loss: 1.5104 - val_acc: 0.7222
Computing...
Manual evaluation: (didn't understand why I made this)
True 7016
False 2055
True percentage 0.773453863962
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.00      0.00      0.00       438
          O       0.86      0.95      0.90      7318
      B-ORG       0.27      0.14      0.18       296
     B-MISC       0.00      0.00      0.00       141
      B-LOC       0.13      0.12      0.13       218
      I-LOC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      I-PER       0.00      0.00      0.00       214
      I-ORG       0.00      0.00      0.00       151

avg / total       0.71      0.77      0.74      9071

F-1 Score:
0.82173811197
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 8 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100018 unique words.
Found 88 unique chars.
Found 9 unique labels.
14 unique words not found in embedding.
4 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 327
OOV word occurences: 632
Padding...
Data padded!
Padding...
Data padded!
Padded until 58 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 58, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5696        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 58)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 58, 64)       6401216     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 58, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 58, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 58, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 58, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 58, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,903,938
Trainable params: 6,903,938
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 7 samples, validate on 1 samples
Epoch 1/70

7/7 [==============================] - 3s 367ms/step - loss: 2.1623 - acc: 0.3488 - val_loss: 1.3151 - val_acc: 0.6471
Epoch 2/70

7/7 [==============================] - 0s 37ms/step - loss: 1.1093 - acc: 0.6860 - val_loss: 1.3380 - val_acc: 0.6471
Epoch 3/70

7/7 [==============================] - 0s 36ms/step - loss: 1.2516 - acc: 0.5814 - val_loss: 1.2576 - val_acc: 0.6471
Epoch 4/70

7/7 [==============================] - 0s 35ms/step - loss: 0.8888 - acc: 0.6860 - val_loss: 1.1827 - val_acc: 0.6471
Epoch 5/70

7/7 [==============================] - 0s 37ms/step - loss: 0.8086 - acc: 0.8372 - val_loss: 1.0566 - val_acc: 0.7059
Epoch 6/70

7/7 [==============================] - 0s 38ms/step - loss: 0.6498 - acc: 0.7907 - val_loss: 1.4059 - val_acc: 0.6471
Epoch 7/70

7/7 [==============================] - 0s 37ms/step - loss: 0.6085 - acc: 0.8430 - val_loss: 0.9144 - val_acc: 0.7059
Epoch 8/70

7/7 [==============================] - 0s 35ms/step - loss: 0.4845 - acc: 0.8430 - val_loss: 1.0931 - val_acc: 0.6471
Epoch 9/70

7/7 [==============================] - 0s 38ms/step - loss: 0.3872 - acc: 0.8953 - val_loss: 1.1327 - val_acc: 0.6471
Computing...
Manual evaluation: (didn't understand why I made this)
True 7077
False 1994
True percentage 0.780178591115
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.42      0.16      0.23       438
          O       0.87      0.94      0.91      7318
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
      I-PER       0.40      0.01      0.02       214
      B-ORG       0.28      0.26      0.27       296
      I-ORG       0.21      0.10      0.13       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.75      0.78      0.75      9071

F-1 Score:
0.829025962505
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 8 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100015 unique words.
Found 92 unique chars.
Found 7 unique labels.
11 unique words not found in embedding.
8 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 325
OOV word occurences: 632
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6401024     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 8)        3160        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,903,192
Trainable params: 6,903,192
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 7 samples, validate on 1 samples
Epoch 1/70

7/7 [==============================] - 3s 376ms/step - loss: 1.8453 - acc: 0.2593 - val_loss: 0.6497 - val_acc: 0.9583
Epoch 2/70

7/7 [==============================] - 0s 36ms/step - loss: 0.8694 - acc: 0.8000 - val_loss: 0.3114 - val_acc: 0.9583
Epoch 3/70

7/7 [==============================] - 0s 35ms/step - loss: 0.9700 - acc: 0.8000 - val_loss: 1.5649 - val_acc: 0.4583
Epoch 4/70

7/7 [==============================] - 0s 35ms/step - loss: 1.4304 - acc: 0.4593 - val_loss: 0.7919 - val_acc: 0.9583
Computing...
Manual evaluation: (didn't understand why I made this)
True 7033
False 1683
True percentage 0.806906837999
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.84      0.96      0.89      7318
      B-ORG       0.00      0.00      0.00       296
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-PER       0.30      0.01      0.03       438
      B-LOC       0.00      0.00      0.00       218
      I-ORG       0.00      0.00      0.00       151

avg / total       0.72      0.81      0.75      8716

F-1 Score:
0.00842696629213
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 8 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100015 unique words.
Found 88 unique chars.
Found 7 unique labels.
11 unique words not found in embedding.
4 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 326
OOV word occurences: 631
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5696        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6401024     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 8)        3160        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,902,936
Trainable params: 6,902,936
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 7 samples, validate on 1 samples
Epoch 1/70

7/7 [==============================] - 3s 374ms/step - loss: 1.8452 - acc: 0.3716 - val_loss: 0.9244 - val_acc: 0.7692
Epoch 2/70

7/7 [==============================] - 0s 36ms/step - loss: 0.6444 - acc: 0.8581 - val_loss: 2.1447 - val_acc: 0.7692
Epoch 3/70

7/7 [==============================] - 0s 36ms/step - loss: 1.4538 - acc: 0.8581 - val_loss: 1.1471 - val_acc: 0.7692
Computing...
Manual evaluation: (didn't understand why I made this)
True 6743
False 2036
True percentage 0.768082925162
Sklearn evaluation:
             precision    recall  f1-score   support

     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.09      0.55      0.15       154
          O       0.89      0.91      0.90      7318
      B-PER       0.00      0.00      0.00       438
      I-PER       0.00      0.00      0.00       214
      B-ORG       0.00      0.00      0.00       296
      B-LOC       0.00      0.00      0.00       218

avg / total       0.74      0.77      0.75      8779

F-1 Score:
0.789670921654
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 8 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100016 unique words.
Found 91 unique chars.
Found 9 unique labels.
12 unique words not found in embedding.
7 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 326
OOV word occurences: 635
Padding...
Data padded!
Padding...
Data padded!
Padded until 67 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 67, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5888        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 67)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 67, 64)       6401088     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 67, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 67, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 67, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 67, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 67, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,904,002
Trainable params: 6,904,002
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 7 samples, validate on 1 samples
Epoch 1/70

7/7 [==============================] - 3s 380ms/step - loss: 2.3486 - acc: 0.0380 - val_loss: 1.3488 - val_acc: 0.6538
Epoch 2/70

7/7 [==============================] - 0s 40ms/step - loss: 0.9838 - acc: 0.7663 - val_loss: 1.4755 - val_acc: 0.6538
Epoch 3/70

7/7 [==============================] - 0s 40ms/step - loss: 0.8869 - acc: 0.7880 - val_loss: 3.2561 - val_acc: 0.6538
Computing...
Manual evaluation: (didn't understand why I made this)
True 7029
False 2042
True percentage 0.774887002536
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.83      0.96      0.89      7318
      B-PER       0.00      0.00      0.00       438
      B-ORG       0.00      0.00      0.00       296
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      I-ORG       0.00      0.00      0.00       151
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
      I-PER       0.00      0.00      0.00       214

avg / total       0.67      0.77      0.72      9071

F-1 Score:
0.0
Opening file ner_3_train.ner
Loading data...
Creating words and labels...
Data loaded! 1674 sentences!
Data sliced! 8 sentences!
Opening file ner_3_test.ner
Loading data...
Creating words and labels...
Data loaded! 419 sentences!
Loading polyglot.vec ...
Found 100004 word vectors.
Loading polyglot-char.vec ...
Found 84 char vectors.
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Index saved!
Indexing...
Data indexed!
Found 100018 unique words.
Found 91 unique chars.
Found 9 unique labels.
14 unique words not found in embedding.
7 unique chars not found in embedding.
Triming sequence length...
Sequence trimmed!
Triming sequence length...
Sequence trimmed!
Mapping...
Data mapped!
Mapping...
Data mapped!
Number of OOV: 326
OOV word occurences: 636
Padding...
Data padded!
Padding...
Data padded!
Padded until 57 tokens.
Mapping...
Data mapped!
Mapping...
Data mapped!
Padding...
Data padded!
Padding...
Data padded!
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5888        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6401216     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,904,130
Trainable params: 6,904,130
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 7 samples, validate on 1 samples
Epoch 1/70

7/7 [==============================] - 3s 373ms/step - loss: 2.3367 - acc: 0.0199 - val_loss: 0.5593 - val_acc: 0.9200
Epoch 2/70

7/7 [==============================] - 0s 38ms/step - loss: 0.9487 - acc: 0.7748 - val_loss: 0.3917 - val_acc: 0.9200
Epoch 3/70

7/7 [==============================] - 0s 37ms/step - loss: 0.9596 - acc: 0.7748 - val_loss: 1.4842 - val_acc: 0.5200
Epoch 4/70

7/7 [==============================] - 0s 36ms/step - loss: 1.5416 - acc: 0.5563 - val_loss: 0.4639 - val_acc: 0.9200
Computing...
Manual evaluation: (didn't understand why I made this)
True 7029
False 2042
True percentage 0.774887002536
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.83      0.96      0.89      7318
      B-ORG       0.00      0.00      0.00       296
      I-ORG       0.00      0.00      0.00       151
      B-PER       0.29      0.00      0.01       438
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
      I-PER       0.00      0.00      0.00       214

avg / total       0.69      0.77      0.72      9071

F-1 Score:
0.00227014755959
