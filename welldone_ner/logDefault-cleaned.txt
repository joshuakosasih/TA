Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,992,194
Trainable params: 6,992,194
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1506 samples, validate on 168 samples
Epoch 1/70

1506/1506 [==============================] - 33s 22ms/step - loss: 0.5755 - acc: 0.8400 - val_loss: 0.4031 - val_acc: 0.8779
Epoch 2/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.2726 - acc: 0.9158 - val_loss: 0.2219 - val_acc: 0.9314
Epoch 3/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.2120 - acc: 0.9337 - val_loss: 0.2021 - val_acc: 0.9334
Epoch 4/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1813 - acc: 0.9432 - val_loss: 0.2808 - val_acc: 0.9114
Epoch 5/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1639 - acc: 0.9502 - val_loss: 0.1899 - val_acc: 0.9361
Epoch 6/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1447 - acc: 0.9544 - val_loss: 0.1877 - val_acc: 0.9348
Epoch 7/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1310 - acc: 0.9587 - val_loss: 0.2046 - val_acc: 0.9347
Epoch 8/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1186 - acc: 0.9633 - val_loss: 0.1529 - val_acc: 0.9519
Epoch 9/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1070 - acc: 0.9664 - val_loss: 0.1564 - val_acc: 0.9545
Epoch 10/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1028 - acc: 0.9679 - val_loss: 0.1447 - val_acc: 0.9555
Epoch 11/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.0925 - acc: 0.9717 - val_loss: 0.1439 - val_acc: 0.9540
Epoch 12/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.0871 - acc: 0.9733 - val_loss: 0.1414 - val_acc: 0.9547
Epoch 13/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.0837 - acc: 0.9737 - val_loss: 0.1427 - val_acc: 0.9552
Epoch 14/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.0776 - acc: 0.9768 - val_loss: 0.1415 - val_acc: 0.9585
Manual evaluation: (didn't understand why I made this)
True 8253
False 818
True percentage 0.9098225113
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.92      0.84      0.88       438
      B-LOC       0.72      0.80      0.75       218
      B-ORG       0.77      0.74      0.76       296
      I-ORG       0.67      0.61      0.64       151
      I-PER       0.92      0.63      0.75       214
      I-LOC       0.70      0.79      0.74       141
     B-MISC       0.50      0.28      0.36       141
     I-MISC       0.53      0.41      0.46       154

avg / total       0.94      0.91      0.92      9071

F-1 Score:
0.72393007836
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,992,194
Trainable params: 6,992,194
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1506 samples, validate on 168 samples
Epoch 1/70

1506/1506 [==============================] - 33s 22ms/step - loss: 0.5651 - acc: 0.8375 - val_loss: 0.3617 - val_acc: 0.8806
Epoch 2/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.2672 - acc: 0.9163 - val_loss: 0.4001 - val_acc: 0.8657
Epoch 3/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.2182 - acc: 0.9320 - val_loss: 0.1758 - val_acc: 0.9486
Epoch 4/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1850 - acc: 0.9401 - val_loss: 0.2642 - val_acc: 0.9174
Epoch 5/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1620 - acc: 0.9494 - val_loss: 0.2659 - val_acc: 0.9076
Manual evaluation: (didn't understand why I made this)
True 7804
False 1267
True percentage 0.8603241098
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.77      0.43      0.55       296
      B-LOC       0.39      0.89      0.54       218
      I-ORG       0.54      0.09      0.16       151
     B-MISC       0.24      0.04      0.07       141
     I-MISC       0.47      0.05      0.08       154
      B-PER       0.96      0.58      0.72       438
      I-PER       0.99      0.39      0.56       214
      I-LOC       0.24      0.90      0.38       141

avg / total       0.92      0.86      0.87      9071

F-1 Score:
0.481261154075
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,992,194
Trainable params: 6,992,194
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1506 samples, validate on 168 samples
Epoch 1/70

1506/1506 [==============================] - 33s 22ms/step - loss: 0.5947 - acc: 0.8365 - val_loss: 0.3803 - val_acc: 0.8745
Epoch 2/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.2777 - acc: 0.9141 - val_loss: 0.2824 - val_acc: 0.9084
Epoch 3/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.2159 - acc: 0.9334 - val_loss: 0.2369 - val_acc: 0.9224
Epoch 4/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1829 - acc: 0.9420 - val_loss: 0.3334 - val_acc: 0.8950
Epoch 5/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1627 - acc: 0.9488 - val_loss: 0.2700 - val_acc: 0.9137
Manual evaluation: (didn't understand why I made this)
True 8001
False 1070
True percentage 0.88204167126
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.95      0.97      7318
      B-PER       0.88      0.79      0.84       438
      B-ORG       0.48      0.79      0.60       296
      I-ORG       0.31      0.80      0.45       151
      I-PER       0.86      0.60      0.71       214
      B-LOC       0.74      0.64      0.69       218
      I-LOC       0.68      0.77      0.72       141
     B-MISC       0.50      0.01      0.01       141
     I-MISC       1.00      0.01      0.01       154

avg / total       0.94      0.88      0.89      9071

F-1 Score:
0.613810741688
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,992,194
Trainable params: 6,992,194
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1506 samples, validate on 168 samples
Epoch 1/70

1506/1506 [==============================] - 33s 22ms/step - loss: 0.5894 - acc: 0.8383 - val_loss: 0.3075 - val_acc: 0.9016
Epoch 2/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.2621 - acc: 0.9195 - val_loss: 0.2768 - val_acc: 0.9095
Epoch 3/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.2077 - acc: 0.9353 - val_loss: 0.2095 - val_acc: 0.9356
Epoch 4/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1756 - acc: 0.9452 - val_loss: 0.2315 - val_acc: 0.9307
Epoch 5/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1621 - acc: 0.9500 - val_loss: 0.2671 - val_acc: 0.9102
Manual evaluation: (didn't understand why I made this)
True 7851
False 1220
True percentage 0.865505456951
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.95      0.97      7318
     B-MISC       0.42      0.04      0.07       141
     I-MISC       0.26      0.12      0.16       154
      B-ORG       0.35      0.82      0.50       296
      I-ORG       0.34      0.79      0.47       151
      B-PER       0.94      0.54      0.69       438
      I-PER       0.89      0.57      0.69       214
      B-LOC       0.84      0.47      0.61       218
      I-LOC       0.80      0.60      0.69       141

avg / total       0.92      0.87      0.88      9071

F-1 Score:
0.533638705983
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,992,194
Trainable params: 6,992,194
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1506 samples, validate on 168 samples
Epoch 1/70

1506/1506 [==============================] - 33s 22ms/step - loss: 0.6002 - acc: 0.8345 - val_loss: 0.2791 - val_acc: 0.9110
Epoch 2/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.2619 - acc: 0.9184 - val_loss: 0.1921 - val_acc: 0.9402
Epoch 3/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.2084 - acc: 0.9354 - val_loss: 0.1625 - val_acc: 0.9444
Epoch 4/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1788 - acc: 0.9441 - val_loss: 0.1985 - val_acc: 0.9408
Epoch 5/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1616 - acc: 0.9498 - val_loss: 0.1430 - val_acc: 0.9526
Epoch 6/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1433 - acc: 0.9548 - val_loss: 0.1503 - val_acc: 0.9524
Epoch 7/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1319 - acc: 0.9590 - val_loss: 0.1512 - val_acc: 0.9502
Manual evaluation: (didn't understand why I made this)
True 8129
False 942
True percentage 0.896152574137
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.84      0.59      0.69       296
      B-LOC       0.72      0.72      0.72       218
      B-PER       0.94      0.80      0.86       438
      I-PER       0.90      0.59      0.72       214
     B-MISC       0.34      0.39      0.36       141
      I-ORG       0.78      0.30      0.43       151
      I-LOC       0.73      0.72      0.73       141
     I-MISC       0.31      0.65      0.42       154

avg / total       0.94      0.90      0.91      9071

F-1 Score:
0.658956109134
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,992,194
Trainable params: 6,992,194
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1506 samples, validate on 168 samples
Epoch 1/70

1506/1506 [==============================] - 33s 22ms/step - loss: 0.5763 - acc: 0.8407 - val_loss: 0.2953 - val_acc: 0.9087
Epoch 2/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.2636 - acc: 0.9179 - val_loss: 0.3201 - val_acc: 0.8947
Epoch 3/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.2113 - acc: 0.9332 - val_loss: 0.2100 - val_acc: 0.9321
Epoch 4/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1757 - acc: 0.9453 - val_loss: 0.2087 - val_acc: 0.9322
Epoch 5/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1575 - acc: 0.9508 - val_loss: 0.3396 - val_acc: 0.8915
Epoch 6/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1454 - acc: 0.9537 - val_loss: 0.1663 - val_acc: 0.9448
Epoch 7/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1308 - acc: 0.9586 - val_loss: 0.2233 - val_acc: 0.9303
Epoch 8/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1197 - acc: 0.9629 - val_loss: 0.1619 - val_acc: 0.9480
Epoch 9/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1059 - acc: 0.9662 - val_loss: 0.1549 - val_acc: 0.9496
Epoch 10/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1026 - acc: 0.9682 - val_loss: 0.1989 - val_acc: 0.9416
Epoch 11/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.0941 - acc: 0.9713 - val_loss: 0.1763 - val_acc: 0.9429
Manual evaluation: (didn't understand why I made this)
True 8182
False 889
True percentage 0.90199536986
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.84      0.86      0.85       438
      B-ORG       0.76      0.70      0.73       296
     I-MISC       0.63      0.26      0.37       154
      B-LOC       0.59      0.85      0.70       218
      I-LOC       0.65      0.84      0.73       141
      I-ORG       0.59      0.60      0.60       151
      I-PER       0.87      0.65      0.74       214
     B-MISC       0.61      0.20      0.30       141

avg / total       0.93      0.90      0.91      9071

F-1 Score:
0.699086354259
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,992,194
Trainable params: 6,992,194
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1506 samples, validate on 168 samples
Epoch 1/70

1506/1506 [==============================] - 33s 22ms/step - loss: 0.5929 - acc: 0.8384 - val_loss: 0.4395 - val_acc: 0.8520
Epoch 2/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.2633 - acc: 0.9183 - val_loss: 0.2748 - val_acc: 0.9067
Epoch 3/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.2136 - acc: 0.9321 - val_loss: 0.2367 - val_acc: 0.9187
Epoch 4/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1799 - acc: 0.9429 - val_loss: 0.1949 - val_acc: 0.9371
Epoch 5/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1580 - acc: 0.9496 - val_loss: 0.2839 - val_acc: 0.9048
Epoch 6/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1456 - acc: 0.9547 - val_loss: 0.1805 - val_acc: 0.9426
Epoch 7/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1281 - acc: 0.9595 - val_loss: 0.1698 - val_acc: 0.9486
Epoch 8/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1182 - acc: 0.9634 - val_loss: 0.2558 - val_acc: 0.9231
Epoch 9/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1154 - acc: 0.9644 - val_loss: 0.1536 - val_acc: 0.9498
Epoch 10/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1032 - acc: 0.9673 - val_loss: 0.1478 - val_acc: 0.9513
Epoch 11/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.0951 - acc: 0.9702 - val_loss: 0.2499 - val_acc: 0.9318
Epoch 12/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.0942 - acc: 0.9706 - val_loss: 0.3524 - val_acc: 0.8901
Manual evaluation: (didn't understand why I made this)
True 7673
False 1398
True percentage 0.845882482637
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.94      0.96      7318
      B-PER       0.95      0.59      0.73       438
      B-LOC       0.83      0.39      0.53       218
      B-ORG       0.84      0.16      0.26       296
      I-PER       0.93      0.53      0.67       214
     B-MISC       0.15      0.72      0.24       141
     I-MISC       0.25      0.78      0.38       154
      I-LOC       0.82      0.53      0.64       141
      I-ORG       0.71      0.11      0.19       151

avg / total       0.95      0.85      0.87      9071

F-1 Score:
0.456798348615
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,992,194
Trainable params: 6,992,194
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1506 samples, validate on 168 samples
Epoch 1/70

1506/1506 [==============================] - 33s 22ms/step - loss: 0.5799 - acc: 0.8386 - val_loss: 0.3153 - val_acc: 0.9030
Epoch 2/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.2552 - acc: 0.9184 - val_loss: 0.2599 - val_acc: 0.9206
Epoch 3/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.2037 - acc: 0.9355 - val_loss: 0.2213 - val_acc: 0.9317
Epoch 4/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1708 - acc: 0.9461 - val_loss: 0.2143 - val_acc: 0.9363
Epoch 5/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1531 - acc: 0.9517 - val_loss: 0.1941 - val_acc: 0.9400
Epoch 6/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1392 - acc: 0.9577 - val_loss: 0.1806 - val_acc: 0.9463
Epoch 7/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1242 - acc: 0.9619 - val_loss: 0.1811 - val_acc: 0.9427
Epoch 8/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1139 - acc: 0.9644 - val_loss: 0.1890 - val_acc: 0.9413
Manual evaluation: (didn't understand why I made this)
True 8172
False 899
True percentage 0.900892955573
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.65      0.75      0.70       296
      I-ORG       0.43      0.74      0.54       151
      B-PER       0.92      0.82      0.86       438
      B-LOC       0.71      0.77      0.74       218
      I-LOC       0.66      0.81      0.73       141
      I-PER       0.89      0.64      0.74       214
     B-MISC       0.67      0.06      0.10       141
     I-MISC       0.76      0.10      0.18       154

avg / total       0.94      0.90      0.91      9071

F-1 Score:
0.678260869565
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,992,194
Trainable params: 6,992,194
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1506 samples, validate on 168 samples
Epoch 1/70

1506/1506 [==============================] - 33s 22ms/step - loss: 0.5821 - acc: 0.8375 - val_loss: 0.3600 - val_acc: 0.8712
Epoch 2/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.2658 - acc: 0.9176 - val_loss: 0.2060 - val_acc: 0.9372
Epoch 3/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.2104 - acc: 0.9331 - val_loss: 0.1793 - val_acc: 0.9444
Epoch 4/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1825 - acc: 0.9418 - val_loss: 0.1725 - val_acc: 0.9508
Epoch 5/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1583 - acc: 0.9494 - val_loss: 0.1500 - val_acc: 0.9561
Epoch 6/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1429 - acc: 0.9550 - val_loss: 0.1951 - val_acc: 0.9403
Epoch 7/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1288 - acc: 0.9600 - val_loss: 0.1559 - val_acc: 0.9578
Manual evaluation: (didn't understand why I made this)
True 8177
False 894
True percentage 0.901444162716
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.79      0.64      0.70       296
      I-ORG       0.64      0.46      0.54       151
     B-MISC       0.69      0.16      0.25       141
     I-MISC       0.61      0.31      0.41       154
      B-PER       0.77      0.87      0.81       438
      B-LOC       0.67      0.77      0.72       218
      I-LOC       0.68      0.76      0.72       141
      I-PER       0.81      0.67      0.74       214

avg / total       0.93      0.90      0.91      9071

F-1 Score:
0.684514755096
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,992,194
Trainable params: 6,992,194
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1506 samples, validate on 168 samples
Epoch 1/70

1506/1506 [==============================] - 33s 22ms/step - loss: 0.5871 - acc: 0.8393 - val_loss: 0.2965 - val_acc: 0.9064
Epoch 2/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.2613 - acc: 0.9179 - val_loss: 0.2200 - val_acc: 0.9279
Epoch 3/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.2053 - acc: 0.9357 - val_loss: 0.1882 - val_acc: 0.9379
Epoch 4/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1761 - acc: 0.9451 - val_loss: 0.1758 - val_acc: 0.9406
Epoch 5/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1576 - acc: 0.9515 - val_loss: 0.1819 - val_acc: 0.9402
Epoch 6/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1402 - acc: 0.9552 - val_loss: 0.1791 - val_acc: 0.9430
Manual evaluation: (didn't understand why I made this)
True 8144
False 927
True percentage 0.897806195568
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.91      0.79      0.85       438
          O       0.98      0.96      0.97      7318
      B-ORG       0.56      0.79      0.66       296
     B-MISC       0.57      0.06      0.10       141
      B-LOC       0.82      0.63      0.71       218
      I-LOC       0.77      0.73      0.75       141
     I-MISC       0.45      0.19      0.27       154
      I-PER       0.85      0.64      0.73       214
      I-ORG       0.50      0.64      0.56       151

avg / total       0.93      0.90      0.91      9071

F-1 Score:
0.917348079299
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,992,194
Trainable params: 6,992,194
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1506 samples, validate on 168 samples
Epoch 1/70

1506/1506 [==============================] - 33s 22ms/step - loss: 0.6118 - acc: 0.8302 - val_loss: 1.4056 - val_acc: 0.8150
Epoch 2/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.3143 - acc: 0.9103 - val_loss: 0.2541 - val_acc: 0.9134
Epoch 3/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.2214 - acc: 0.9303 - val_loss: 0.1839 - val_acc: 0.9372
Epoch 4/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1881 - acc: 0.9412 - val_loss: 0.1674 - val_acc: 0.9462
Epoch 5/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1684 - acc: 0.9470 - val_loss: 0.2482 - val_acc: 0.9157
Epoch 6/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1520 - acc: 0.9528 - val_loss: 0.2268 - val_acc: 0.9267
Manual evaluation: (didn't understand why I made this)
True 7930
False 1141
True percentage 0.87421452982
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.90      0.76      0.82       438
          O       0.98      0.96      0.97      7318
      B-LOC       0.40      0.89      0.55       218
      I-LOC       0.32      0.91      0.47       141
      I-PER       0.90      0.57      0.70       214
      B-ORG       0.88      0.39      0.54       296
      I-ORG       0.62      0.17      0.26       151
     B-MISC       0.23      0.05      0.08       141
     I-MISC       0.42      0.12      0.18       154

avg / total       0.92      0.87      0.88      9071

F-1 Score:
0.893369386316
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,992,194
Trainable params: 6,992,194
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1506 samples, validate on 168 samples
Epoch 1/70

1506/1506 [==============================] - 33s 22ms/step - loss: 0.5966 - acc: 0.8381 - val_loss: 0.3784 - val_acc: 0.8923
Epoch 2/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.2716 - acc: 0.9175 - val_loss: 0.5632 - val_acc: 0.8372
Epoch 3/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.2146 - acc: 0.9341 - val_loss: 0.2301 - val_acc: 0.9298
Epoch 4/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1789 - acc: 0.9447 - val_loss: 0.2285 - val_acc: 0.9296
Epoch 5/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1561 - acc: 0.9520 - val_loss: 0.2101 - val_acc: 0.9380
Epoch 6/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1404 - acc: 0.9564 - val_loss: 0.2373 - val_acc: 0.9330
Epoch 7/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1294 - acc: 0.9605 - val_loss: 0.2232 - val_acc: 0.9383
Manual evaluation: (didn't understand why I made this)
True 8081
False 990
True percentage 0.890860985558
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.97      0.96      7318
      B-ORG       0.76      0.65      0.70       296
     B-MISC       0.36      0.03      0.05       141
     I-MISC       0.40      0.19      0.26       154
      B-PER       0.91      0.76      0.83       438
      B-LOC       0.57      0.74      0.64       218
      I-ORG       0.64      0.32      0.43       151
      I-PER       0.97      0.57      0.72       214
      I-LOC       0.69      0.75      0.72       141

avg / total       0.91      0.89      0.90      9071

F-1 Score:
0.643826761474
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,992,194
Trainable params: 6,992,194
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1506 samples, validate on 168 samples
Epoch 1/70

1506/1506 [==============================] - 33s 22ms/step - loss: 0.5133 - acc: 0.8526 - val_loss: 0.3171 - val_acc: 0.9013
Epoch 2/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.2470 - acc: 0.9224 - val_loss: 0.2777 - val_acc: 0.9166
Epoch 3/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.2013 - acc: 0.9362 - val_loss: 0.1976 - val_acc: 0.9392
Epoch 4/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1713 - acc: 0.9465 - val_loss: 0.3154 - val_acc: 0.9041
Epoch 5/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1563 - acc: 0.9510 - val_loss: 0.1679 - val_acc: 0.9508
Epoch 6/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1330 - acc: 0.9587 - val_loss: 0.1728 - val_acc: 0.9466
Epoch 7/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1228 - acc: 0.9629 - val_loss: 0.1821 - val_acc: 0.9460
Manual evaluation: (didn't understand why I made this)
True 8137
False 934
True percentage 0.897034505567
Sklearn evaluation:
             precision    recall  f1-score   support

     B-MISC       0.39      0.17      0.24       141
     I-MISC       0.50      0.41      0.45       154
          O       0.95      0.97      0.96      7318
      B-PER       0.91      0.76      0.83       438
      I-PER       0.91      0.63      0.74       214
      B-ORG       0.87      0.51      0.64       296
      B-LOC       0.76      0.72      0.74       218
      I-ORG       0.69      0.44      0.53       151
      I-LOC       0.84      0.71      0.77       141

avg / total       0.92      0.90      0.91      9071

F-1 Score:
0.921094459582
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,992,194
Trainable params: 6,992,194
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1506 samples, validate on 168 samples
Epoch 1/70

1506/1506 [==============================] - 33s 22ms/step - loss: 0.5935 - acc: 0.8291 - val_loss: 0.2907 - val_acc: 0.9068
Epoch 2/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.2766 - acc: 0.9132 - val_loss: 0.2200 - val_acc: 0.9323
Epoch 3/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.2199 - acc: 0.9295 - val_loss: 0.1818 - val_acc: 0.9406
Epoch 4/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1877 - acc: 0.9402 - val_loss: 0.1788 - val_acc: 0.9417
Epoch 5/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1675 - acc: 0.9466 - val_loss: 0.2820 - val_acc: 0.9155
Epoch 6/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1533 - acc: 0.9505 - val_loss: 0.1915 - val_acc: 0.9395
Manual evaluation: (didn't understand why I made this)
True 8029
False 1042
True percentage 0.885128431264
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.75      0.81      0.78       438
      B-ORG       0.65      0.64      0.64       296
     B-MISC       0.50      0.02      0.04       141
     I-MISC       0.57      0.05      0.10       154
      I-ORG       0.36      0.54      0.43       151
      B-LOC       0.72      0.67      0.70       218
      I-LOC       0.76      0.46      0.58       141
      I-PER       0.60      0.68      0.64       214

avg / total       0.91      0.89      0.89      9071

F-1 Score:
0.603155339806
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,992,194
Trainable params: 6,992,194
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 1506 samples, validate on 168 samples
Epoch 1/70

1506/1506 [==============================] - 33s 22ms/step - loss: 0.5670 - acc: 0.8406 - val_loss: 0.3558 - val_acc: 0.8803
Epoch 2/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.2558 - acc: 0.9208 - val_loss: 0.3410 - val_acc: 0.8928
Epoch 3/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.2054 - acc: 0.9351 - val_loss: 0.2318 - val_acc: 0.9286
Epoch 4/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1751 - acc: 0.9456 - val_loss: 0.2465 - val_acc: 0.9301
Epoch 5/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1518 - acc: 0.9520 - val_loss: 0.2115 - val_acc: 0.9345
Epoch 6/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1371 - acc: 0.9571 - val_loss: 0.2338 - val_acc: 0.9328
Epoch 7/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1218 - acc: 0.9623 - val_loss: 0.1839 - val_acc: 0.9456
Epoch 8/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1143 - acc: 0.9650 - val_loss: 0.1731 - val_acc: 0.9506
Epoch 9/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.1032 - acc: 0.9665 - val_loss: 0.2279 - val_acc: 0.9358
Epoch 10/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.0984 - acc: 0.9696 - val_loss: 0.1716 - val_acc: 0.9524
Epoch 11/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.0915 - acc: 0.9716 - val_loss: 0.1571 - val_acc: 0.9558
Epoch 12/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.0830 - acc: 0.9747 - val_loss: 0.1812 - val_acc: 0.9483
Epoch 13/70

1506/1506 [==============================] - 30s 20ms/step - loss: 0.0795 - acc: 0.9753 - val_loss: 0.1673 - val_acc: 0.9551
Manual evaluation: (didn't understand why I made this)
True 8229
False 842
True percentage 0.90717671701
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
      B-ORG       0.78      0.66      0.71       296
      I-ORG       0.67      0.54      0.60       151
      B-PER       0.92      0.86      0.89       438
     B-MISC       0.35      0.39      0.37       141
     I-MISC       0.57      0.36      0.44       154
      B-LOC       0.66      0.79      0.72       218
      I-LOC       0.70      0.82      0.76       141
      I-PER       0.91      0.65      0.76       214

avg / total       0.94      0.91      0.92      9071

F-1 Score:
0.708680142687
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100846 unique words.
Found 94 unique chars.
Found 9 unique labels.
842 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 257
OOV word occurences: 384
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6454208     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,957,314
Trainable params: 6,957,314
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 753 samples, validate on 84 samples
Epoch 1/70

753/753 [==============================] - 19s 25ms/step - loss: 0.8274 - acc: 0.7939 - val_loss: 0.4674 - val_acc: 0.8811
Epoch 2/70

753/753 [==============================] - 15s 20ms/step - loss: 0.3740 - acc: 0.8845 - val_loss: 0.3524 - val_acc: 0.8857
Epoch 3/70

753/753 [==============================] - 15s 20ms/step - loss: 0.2857 - acc: 0.9112 - val_loss: 0.2623 - val_acc: 0.9135
Epoch 4/70

753/753 [==============================] - 15s 20ms/step - loss: 0.2389 - acc: 0.9262 - val_loss: 0.2215 - val_acc: 0.9260
Epoch 5/70

753/753 [==============================] - 15s 20ms/step - loss: 0.2041 - acc: 0.9355 - val_loss: 0.2110 - val_acc: 0.9345
Epoch 6/70

753/753 [==============================] - 15s 20ms/step - loss: 0.1864 - acc: 0.9414 - val_loss: 0.2115 - val_acc: 0.9289
Epoch 7/70

753/753 [==============================] - 15s 20ms/step - loss: 0.1653 - acc: 0.9484 - val_loss: 0.1872 - val_acc: 0.9366
Epoch 8/70

753/753 [==============================] - 15s 20ms/step - loss: 0.1492 - acc: 0.9525 - val_loss: 0.1825 - val_acc: 0.9415
Epoch 9/70

753/753 [==============================] - 15s 20ms/step - loss: 0.1332 - acc: 0.9614 - val_loss: 0.1966 - val_acc: 0.9313
Epoch 10/70

753/753 [==============================] - 15s 20ms/step - loss: 0.1269 - acc: 0.9608 - val_loss: 0.1860 - val_acc: 0.9385
Manual evaluation: (didn't understand why I made this)
True 8059
False 1012
True percentage 0.888435674126
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.96      0.97      7318
      B-PER       0.90      0.74      0.81       438
      B-LOC       0.70      0.74      0.72       218
      B-ORG       0.71      0.64      0.67       296
      I-ORG       0.59      0.34      0.43       151
      I-PER       0.91      0.59      0.71       214
      I-LOC       0.66      0.76      0.71       141
     B-MISC       0.31      0.11      0.16       141
     I-MISC       0.40      0.42      0.41       154

avg / total       0.92      0.89      0.90      9071

F-1 Score:
0.645443196005
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100833 unique words.
Found 94 unique chars.
Found 9 unique labels.
829 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 254
OOV word occurences: 364
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6453376     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,956,482
Trainable params: 6,956,482
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 753 samples, validate on 84 samples
Epoch 1/70

753/753 [==============================] - 19s 25ms/step - loss: 0.8037 - acc: 0.7870 - val_loss: 0.4442 - val_acc: 0.8694
Epoch 2/70

753/753 [==============================] - 15s 20ms/step - loss: 0.3587 - acc: 0.8904 - val_loss: 0.3129 - val_acc: 0.9064
Epoch 3/70

753/753 [==============================] - 15s 20ms/step - loss: 0.2691 - acc: 0.9150 - val_loss: 0.2765 - val_acc: 0.9125
Epoch 4/70

753/753 [==============================] - 15s 20ms/step - loss: 0.2240 - acc: 0.9297 - val_loss: 0.2713 - val_acc: 0.9156
Epoch 5/70

753/753 [==============================] - 15s 20ms/step - loss: 0.1978 - acc: 0.9382 - val_loss: 0.2519 - val_acc: 0.9253
Epoch 6/70

753/753 [==============================] - 15s 20ms/step - loss: 0.1722 - acc: 0.9472 - val_loss: 0.2317 - val_acc: 0.9296
Epoch 7/70

753/753 [==============================] - 15s 20ms/step - loss: 0.1477 - acc: 0.9542 - val_loss: 0.2282 - val_acc: 0.9289
Epoch 8/70

753/753 [==============================] - 15s 20ms/step - loss: 0.1426 - acc: 0.9537 - val_loss: 0.2244 - val_acc: 0.9270
Epoch 9/70

753/753 [==============================] - 15s 20ms/step - loss: 0.1225 - acc: 0.9606 - val_loss: 0.2216 - val_acc: 0.9280
Epoch 10/70

753/753 [==============================] - 15s 20ms/step - loss: 0.1129 - acc: 0.9656 - val_loss: 0.2188 - val_acc: 0.9294
Epoch 11/70

753/753 [==============================] - 15s 20ms/step - loss: 0.1083 - acc: 0.9674 - val_loss: 0.2214 - val_acc: 0.9338
Epoch 12/70

753/753 [==============================] - 15s 20ms/step - loss: 0.0970 - acc: 0.9696 - val_loss: 0.2242 - val_acc: 0.9335
Manual evaluation: (didn't understand why I made this)
True 8097
False 974
True percentage 0.892624848418
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.78      0.57      0.66       296
      B-LOC       0.72      0.72      0.72       218
      I-ORG       0.67      0.29      0.41       151
     B-MISC       0.32      0.28      0.30       141
     I-MISC       0.37      0.49      0.42       154
      B-PER       0.91      0.80      0.85       438
      I-PER       0.86      0.61      0.72       214
      I-LOC       0.79      0.75      0.77       141

avg / total       0.93      0.89      0.91      9071

F-1 Score:
0.659502609764
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100816 unique words.
Found 94 unique chars.
Found 9 unique labels.
812 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 260
OOV word occurences: 365
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6452288     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,955,394
Trainable params: 6,955,394
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 753 samples, validate on 84 samples
Epoch 1/70

753/753 [==============================] - 18s 24ms/step - loss: 0.7500 - acc: 0.7784 - val_loss: 0.4193 - val_acc: 0.8611
Epoch 2/70

753/753 [==============================] - 15s 20ms/step - loss: 0.3573 - acc: 0.8910 - val_loss: 0.2798 - val_acc: 0.9200
Epoch 3/70

753/753 [==============================] - 15s 20ms/step - loss: 0.2749 - acc: 0.9174 - val_loss: 0.2232 - val_acc: 0.9331
Epoch 4/70

753/753 [==============================] - 15s 20ms/step - loss: 0.2245 - acc: 0.9293 - val_loss: 0.1888 - val_acc: 0.9398
Epoch 5/70

753/753 [==============================] - 15s 20ms/step - loss: 0.1966 - acc: 0.9392 - val_loss: 0.1890 - val_acc: 0.9387
Epoch 6/70

753/753 [==============================] - 15s 20ms/step - loss: 0.1778 - acc: 0.9462 - val_loss: 0.1720 - val_acc: 0.9385
Epoch 7/70

753/753 [==============================] - 15s 20ms/step - loss: 0.1593 - acc: 0.9488 - val_loss: 0.1656 - val_acc: 0.9467
Epoch 8/70

753/753 [==============================] - 15s 20ms/step - loss: 0.1480 - acc: 0.9533 - val_loss: 0.1527 - val_acc: 0.9522
Epoch 9/70

753/753 [==============================] - 15s 20ms/step - loss: 0.1269 - acc: 0.9608 - val_loss: 0.1619 - val_acc: 0.9540
Epoch 10/70

753/753 [==============================] - 15s 20ms/step - loss: 0.1208 - acc: 0.9631 - val_loss: 0.1548 - val_acc: 0.9517
Manual evaluation: (didn't understand why I made this)
True 8108
False 963
True percentage 0.893837504134
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.97      7318
      B-PER       0.88      0.82      0.85       438
      B-ORG       0.78      0.70      0.74       296
      I-ORG       0.56      0.55      0.56       151
      I-PER       0.88      0.60      0.71       214
      B-LOC       0.66      0.69      0.67       218
      I-LOC       0.72      0.74      0.73       141
     B-MISC       0.37      0.29      0.33       141
     I-MISC       0.44      0.32      0.37       154

avg / total       0.93      0.89      0.91      9071

F-1 Score:
0.675903614458
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100806 unique words.
Found 94 unique chars.
Found 9 unique labels.
802 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 259
OOV word occurences: 368
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 58, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 58)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 58, 64)       6451648     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 58, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 58, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 58, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 58, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 58, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,954,754
Trainable params: 6,954,754
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 753 samples, validate on 84 samples
Epoch 1/70

753/753 [==============================] - 14s 19ms/step - loss: 0.7849 - acc: 0.7902 - val_loss: 0.4211 - val_acc: 0.8656
Epoch 2/70

753/753 [==============================] - 11s 15ms/step - loss: 0.3593 - acc: 0.8884 - val_loss: 0.3068 - val_acc: 0.9028
Epoch 3/70

753/753 [==============================] - 11s 15ms/step - loss: 0.2760 - acc: 0.9162 - val_loss: 0.2521 - val_acc: 0.9209
Epoch 4/70

753/753 [==============================] - 11s 15ms/step - loss: 0.2195 - acc: 0.9323 - val_loss: 0.2282 - val_acc: 0.9335
Epoch 5/70

753/753 [==============================] - 11s 15ms/step - loss: 0.1881 - acc: 0.9403 - val_loss: 0.2064 - val_acc: 0.9373
Epoch 6/70

753/753 [==============================] - 11s 15ms/step - loss: 0.1669 - acc: 0.9480 - val_loss: 0.2001 - val_acc: 0.9366
Epoch 7/70

753/753 [==============================] - 11s 15ms/step - loss: 0.1523 - acc: 0.9524 - val_loss: 0.2076 - val_acc: 0.9389
Epoch 8/70

753/753 [==============================] - 11s 15ms/step - loss: 0.1365 - acc: 0.9567 - val_loss: 0.1962 - val_acc: 0.9405
Epoch 9/70

753/753 [==============================] - 11s 15ms/step - loss: 0.1266 - acc: 0.9605 - val_loss: 0.1789 - val_acc: 0.9404
Epoch 10/70

753/753 [==============================] - 11s 15ms/step - loss: 0.1142 - acc: 0.9653 - val_loss: 0.1802 - val_acc: 0.9441
Epoch 11/70

753/753 [==============================] - 11s 15ms/step - loss: 0.1048 - acc: 0.9679 - val_loss: 0.1868 - val_acc: 0.9455
Manual evaluation: (didn't understand why I made this)
True 8087
False 984
True percentage 0.891522434131
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.96      0.97      7318
     B-MISC       0.33      0.21      0.25       141
     I-MISC       0.45      0.40      0.42       154
      B-ORG       0.78      0.60      0.68       296
      I-ORG       0.62      0.37      0.46       151
      B-PER       0.93      0.71      0.80       438
      I-PER       0.89      0.62      0.73       214
      B-LOC       0.70      0.75      0.72       218
      I-LOC       0.65      0.79      0.71       141

avg / total       0.92      0.89      0.90      9071

F-1 Score:
0.653483992467
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100790 unique words.
Found 94 unique chars.
Found 9 unique labels.
786 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 259
OOV word occurences: 392
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 67, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 67)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 67, 64)       6450624     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 67, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 67, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 67, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 67, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 67, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,953,730
Trainable params: 6,953,730
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 753 samples, validate on 84 samples
Epoch 1/70

753/753 [==============================] - 16s 21ms/step - loss: 0.8318 - acc: 0.7846 - val_loss: 0.4378 - val_acc: 0.8669
Epoch 2/70

753/753 [==============================] - 13s 17ms/step - loss: 0.3726 - acc: 0.8856 - val_loss: 0.3072 - val_acc: 0.8994
Epoch 3/70

753/753 [==============================] - 13s 17ms/step - loss: 0.2707 - acc: 0.9186 - val_loss: 0.2504 - val_acc: 0.9213
Epoch 4/70

753/753 [==============================] - 13s 17ms/step - loss: 0.2251 - acc: 0.9289 - val_loss: 0.2329 - val_acc: 0.9310
Epoch 5/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1934 - acc: 0.9400 - val_loss: 0.2158 - val_acc: 0.9337
Epoch 6/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1674 - acc: 0.9472 - val_loss: 0.2143 - val_acc: 0.9393
Epoch 7/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1508 - acc: 0.9509 - val_loss: 0.2179 - val_acc: 0.9367
Epoch 8/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1366 - acc: 0.9576 - val_loss: 0.2028 - val_acc: 0.9414
Epoch 9/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1243 - acc: 0.9622 - val_loss: 0.2095 - val_acc: 0.9361
Epoch 10/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1149 - acc: 0.9620 - val_loss: 0.1974 - val_acc: 0.9447
Epoch 11/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1023 - acc: 0.9676 - val_loss: 0.1925 - val_acc: 0.9429
Epoch 12/70

753/753 [==============================] - 13s 17ms/step - loss: 0.0951 - acc: 0.9715 - val_loss: 0.1899 - val_acc: 0.9468
Epoch 13/70

753/753 [==============================] - 13s 17ms/step - loss: 0.0914 - acc: 0.9717 - val_loss: 0.1922 - val_acc: 0.9464
Epoch 14/70

753/753 [==============================] - 13s 17ms/step - loss: 0.0810 - acc: 0.9756 - val_loss: 0.1924 - val_acc: 0.9458
Manual evaluation: (didn't understand why I made this)
True 8086
False 985
True percentage 0.891412192702
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.96      0.97      7318
      B-ORG       0.71      0.71      0.71       296
      B-LOC       0.72      0.69      0.71       218
      B-PER       0.88      0.74      0.80       438
      I-PER       0.90      0.61      0.73       214
     B-MISC       0.39      0.12      0.18       141
      I-ORG       0.51      0.70      0.59       151
      I-LOC       0.74      0.71      0.72       141
     I-MISC       0.37      0.09      0.15       154

avg / total       0.92      0.89      0.90      9071

F-1 Score:
0.657886484791
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100764 unique words.
Found 94 unique chars.
Found 9 unique labels.
760 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 254
OOV word occurences: 352
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 67, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 67)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 67, 64)       6448960     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 67, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 67, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 67, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 67, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 67, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,952,066
Trainable params: 6,952,066
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 753 samples, validate on 84 samples
Epoch 1/70

753/753 [==============================] - 16s 21ms/step - loss: 0.8001 - acc: 0.7884 - val_loss: 0.3845 - val_acc: 0.8949
Epoch 2/70

753/753 [==============================] - 13s 17ms/step - loss: 0.3503 - acc: 0.8948 - val_loss: 0.2639 - val_acc: 0.9100
Epoch 3/70

753/753 [==============================] - 13s 17ms/step - loss: 0.2602 - acc: 0.9207 - val_loss: 0.2013 - val_acc: 0.9401
Epoch 4/70

753/753 [==============================] - 13s 17ms/step - loss: 0.2187 - acc: 0.9326 - val_loss: 0.1750 - val_acc: 0.9454
Epoch 5/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1923 - acc: 0.9389 - val_loss: 0.1501 - val_acc: 0.9413
Epoch 6/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1654 - acc: 0.9468 - val_loss: 0.1451 - val_acc: 0.9512
Epoch 7/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1548 - acc: 0.9508 - val_loss: 0.1372 - val_acc: 0.9512
Epoch 8/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1376 - acc: 0.9575 - val_loss: 0.1345 - val_acc: 0.9506
Epoch 9/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1261 - acc: 0.9600 - val_loss: 0.1320 - val_acc: 0.9547
Epoch 10/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1164 - acc: 0.9646 - val_loss: 0.1253 - val_acc: 0.9570
Epoch 11/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1092 - acc: 0.9667 - val_loss: 0.1170 - val_acc: 0.9616
Epoch 12/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1024 - acc: 0.9672 - val_loss: 0.1256 - val_acc: 0.9576
Epoch 13/70

753/753 [==============================] - 13s 17ms/step - loss: 0.0950 - acc: 0.9706 - val_loss: 0.1191 - val_acc: 0.9599
Manual evaluation: (didn't understand why I made this)
True 8166
False 905
True percentage 0.900231507
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.90      0.82      0.86       438
      B-ORG       0.71      0.72      0.71       296
     I-MISC       0.39      0.31      0.35       154
      B-LOC       0.70      0.78      0.74       218
      I-LOC       0.78      0.78      0.78       141
      I-ORG       0.54      0.61      0.57       151
      I-PER       0.91      0.61      0.73       214
     B-MISC       0.46      0.16      0.23       141

avg / total       0.93      0.90      0.91      9071

F-1 Score:
0.688327316486
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100794 unique words.
Found 94 unique chars.
Found 9 unique labels.
790 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 258
OOV word occurences: 395
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 67, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 67)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 67, 64)       6450880     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 67, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 67, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 67, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 67, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 67, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,953,986
Trainable params: 6,953,986
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 753 samples, validate on 84 samples
Epoch 1/70

753/753 [==============================] - 16s 21ms/step - loss: 0.8096 - acc: 0.7894 - val_loss: 0.4122 - val_acc: 0.8728
Epoch 2/70

753/753 [==============================] - 13s 17ms/step - loss: 0.3643 - acc: 0.8889 - val_loss: 0.3973 - val_acc: 0.8825
Epoch 3/70

753/753 [==============================] - 13s 17ms/step - loss: 0.2749 - acc: 0.9139 - val_loss: 0.2518 - val_acc: 0.9270
Epoch 4/70

753/753 [==============================] - 13s 17ms/step - loss: 0.2201 - acc: 0.9328 - val_loss: 0.2439 - val_acc: 0.9228
Epoch 5/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1947 - acc: 0.9387 - val_loss: 0.2107 - val_acc: 0.9344
Epoch 6/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1698 - acc: 0.9476 - val_loss: 0.1952 - val_acc: 0.9396
Epoch 7/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1497 - acc: 0.9555 - val_loss: 0.1897 - val_acc: 0.9450
Epoch 8/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1363 - acc: 0.9587 - val_loss: 0.1832 - val_acc: 0.9422
Epoch 9/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1278 - acc: 0.9631 - val_loss: 0.1955 - val_acc: 0.9387
Epoch 10/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1199 - acc: 0.9636 - val_loss: 0.1812 - val_acc: 0.9448
Epoch 11/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1060 - acc: 0.9669 - val_loss: 0.1787 - val_acc: 0.9464
Epoch 12/70

753/753 [==============================] - 13s 17ms/step - loss: 0.0943 - acc: 0.9725 - val_loss: 0.1739 - val_acc: 0.9474
Epoch 13/70

753/753 [==============================] - 13s 17ms/step - loss: 0.0930 - acc: 0.9726 - val_loss: 0.1764 - val_acc: 0.9491
Epoch 14/70

753/753 [==============================] - 13s 17ms/step - loss: 0.0860 - acc: 0.9759 - val_loss: 0.1754 - val_acc: 0.9458
Manual evaluation: (didn't understand why I made this)
True 8096
False 975
True percentage 0.892514606989
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-PER       0.88      0.72      0.79       438
      B-LOC       0.72      0.71      0.72       218
      B-ORG       0.69      0.69      0.69       296
      I-PER       0.80      0.64      0.72       214
     B-MISC       0.49      0.29      0.37       141
     I-MISC       0.51      0.34      0.41       154
      I-LOC       0.72      0.74      0.73       141
      I-ORG       0.50      0.64      0.56       151

avg / total       0.93      0.89      0.91      9071

F-1 Score:
0.667270531401
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100798 unique words.
Found 94 unique chars.
Found 9 unique labels.
794 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 259
OOV word occurences: 391
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 58, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 58)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 58, 64)       6451136     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 58, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 58, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 58, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 58, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 58, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,954,242
Trainable params: 6,954,242
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 753 samples, validate on 84 samples
Epoch 1/70

753/753 [==============================] - 14s 19ms/step - loss: 0.8619 - acc: 0.7855 - val_loss: 0.3802 - val_acc: 0.8697
Epoch 2/70

753/753 [==============================] - 11s 15ms/step - loss: 0.3705 - acc: 0.8845 - val_loss: 0.2808 - val_acc: 0.9137
Epoch 3/70

753/753 [==============================] - 11s 15ms/step - loss: 0.2697 - acc: 0.9150 - val_loss: 0.1957 - val_acc: 0.9401
Epoch 4/70

753/753 [==============================] - 11s 15ms/step - loss: 0.2271 - acc: 0.9292 - val_loss: 0.1807 - val_acc: 0.9487
Epoch 5/70

753/753 [==============================] - 11s 15ms/step - loss: 0.1945 - acc: 0.9394 - val_loss: 0.1496 - val_acc: 0.9563
Epoch 6/70

753/753 [==============================] - 11s 15ms/step - loss: 0.1716 - acc: 0.9483 - val_loss: 0.1515 - val_acc: 0.9533
Epoch 7/70

753/753 [==============================] - 11s 15ms/step - loss: 0.1593 - acc: 0.9494 - val_loss: 0.1384 - val_acc: 0.9599
Epoch 8/70

753/753 [==============================] - 11s 15ms/step - loss: 0.1406 - acc: 0.9575 - val_loss: 0.1286 - val_acc: 0.9645
Epoch 9/70

753/753 [==============================] - 11s 15ms/step - loss: 0.1287 - acc: 0.9602 - val_loss: 0.1348 - val_acc: 0.9605
Epoch 10/70

753/753 [==============================] - 11s 15ms/step - loss: 0.1223 - acc: 0.9617 - val_loss: 0.1254 - val_acc: 0.9589
Epoch 11/70

753/753 [==============================] - 11s 15ms/step - loss: 0.1096 - acc: 0.9670 - val_loss: 0.1420 - val_acc: 0.9572
Epoch 12/70

753/753 [==============================] - 11s 15ms/step - loss: 0.1025 - acc: 0.9694 - val_loss: 0.1133 - val_acc: 0.9668
Epoch 13/70

753/753 [==============================] - 11s 15ms/step - loss: 0.0952 - acc: 0.9710 - val_loss: 0.1167 - val_acc: 0.9646
Epoch 14/70

753/753 [==============================] - 11s 15ms/step - loss: 0.0912 - acc: 0.9716 - val_loss: 0.1192 - val_acc: 0.9657
Manual evaluation: (didn't understand why I made this)
True 8059
False 1012
True percentage 0.888435674126
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-ORG       0.79      0.60      0.68       296
      I-ORG       0.57      0.35      0.43       151
      B-PER       0.89      0.73      0.80       438
      B-LOC       0.80      0.66      0.72       218
      I-LOC       0.73      0.74      0.74       141
      I-PER       0.91      0.57      0.70       214
     B-MISC       0.26      0.38      0.31       141
     I-MISC       0.40      0.42      0.41       154

avg / total       0.93      0.89      0.91      9071

F-1 Score:
0.63781461019
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100807 unique words.
Found 94 unique chars.
Found 9 unique labels.
803 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 256
OOV word occurences: 360
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6451712     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,954,818
Trainable params: 6,954,818
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 753 samples, validate on 84 samples
Epoch 1/70

753/753 [==============================] - 19s 25ms/step - loss: 0.7045 - acc: 0.8013 - val_loss: 0.4120 - val_acc: 0.8793
Epoch 2/70

753/753 [==============================] - 15s 20ms/step - loss: 0.3507 - acc: 0.8939 - val_loss: 0.2751 - val_acc: 0.9239
Epoch 3/70

753/753 [==============================] - 15s 20ms/step - loss: 0.2575 - acc: 0.9200 - val_loss: 0.2317 - val_acc: 0.9315
Epoch 4/70

753/753 [==============================] - 15s 20ms/step - loss: 0.2065 - acc: 0.9330 - val_loss: 0.2182 - val_acc: 0.9354
Epoch 5/70

753/753 [==============================] - 15s 20ms/step - loss: 0.1806 - acc: 0.9436 - val_loss: 0.2036 - val_acc: 0.9440
Epoch 6/70

753/753 [==============================] - 15s 20ms/step - loss: 0.1633 - acc: 0.9484 - val_loss: 0.2040 - val_acc: 0.9376
Epoch 7/70

753/753 [==============================] - 15s 20ms/step - loss: 0.1463 - acc: 0.9542 - val_loss: 0.1841 - val_acc: 0.9489
Epoch 8/70

753/753 [==============================] - 15s 20ms/step - loss: 0.1333 - acc: 0.9596 - val_loss: 0.1861 - val_acc: 0.9522
Epoch 9/70

753/753 [==============================] - 15s 20ms/step - loss: 0.1203 - acc: 0.9636 - val_loss: 0.1758 - val_acc: 0.9478
Epoch 10/70

753/753 [==============================] - 15s 20ms/step - loss: 0.1090 - acc: 0.9676 - val_loss: 0.1762 - val_acc: 0.9462
Epoch 11/70

753/753 [==============================] - 15s 20ms/step - loss: 0.1017 - acc: 0.9691 - val_loss: 0.1769 - val_acc: 0.9479
Manual evaluation: (didn't understand why I made this)
True 8122
False 949
True percentage 0.895380884136
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.96      0.97      7318
      B-ORG       0.83      0.65      0.73       296
      I-ORG       0.72      0.25      0.37       151
     B-MISC       0.43      0.30      0.36       141
     I-MISC       0.41      0.50      0.45       154
      B-PER       0.87      0.77      0.82       438
      B-LOC       0.76      0.70      0.73       218
      I-LOC       0.68      0.72      0.70       141
      I-PER       0.86      0.62      0.72       214

avg / total       0.93      0.90      0.91      9071

F-1 Score:
0.668118195956
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100814 unique words.
Found 94 unique chars.
Found 9 unique labels.
810 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 255
OOV word occurences: 357
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 67, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 67)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 67, 64)       6452160     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 67, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 67, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 67, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 67, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 67, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,955,266
Trainable params: 6,955,266
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 753 samples, validate on 84 samples
Epoch 1/70

753/753 [==============================] - 16s 21ms/step - loss: 0.7947 - acc: 0.7873 - val_loss: 0.3613 - val_acc: 0.8937
Epoch 2/70

753/753 [==============================] - 13s 17ms/step - loss: 0.3580 - acc: 0.8912 - val_loss: 0.2621 - val_acc: 0.9205
Epoch 3/70

753/753 [==============================] - 13s 17ms/step - loss: 0.2684 - acc: 0.9171 - val_loss: 0.2190 - val_acc: 0.9340
Epoch 4/70

753/753 [==============================] - 13s 17ms/step - loss: 0.2196 - acc: 0.9311 - val_loss: 0.2227 - val_acc: 0.9303
Epoch 5/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1929 - acc: 0.9409 - val_loss: 0.2030 - val_acc: 0.9330
Epoch 6/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1702 - acc: 0.9477 - val_loss: 0.1963 - val_acc: 0.9383
Epoch 7/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1503 - acc: 0.9541 - val_loss: 0.1905 - val_acc: 0.9428
Epoch 8/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1410 - acc: 0.9568 - val_loss: 0.1804 - val_acc: 0.9476
Epoch 9/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1272 - acc: 0.9616 - val_loss: 0.1764 - val_acc: 0.9482
Epoch 10/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1143 - acc: 0.9663 - val_loss: 0.1777 - val_acc: 0.9449
Epoch 11/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1046 - acc: 0.9685 - val_loss: 0.1927 - val_acc: 0.9449
Manual evaluation: (didn't understand why I made this)
True 8044
False 1027
True percentage 0.886782052695
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.91      0.76      0.83       438
          O       0.98      0.96      0.97      7318
      B-ORG       0.75      0.49      0.60       296
     B-MISC       0.27      0.33      0.30       141
      B-LOC       0.68      0.74      0.71       218
      I-LOC       0.67      0.73      0.70       141
     I-MISC       0.35      0.42      0.38       154
      I-PER       0.90      0.59      0.71       214
      I-ORG       0.57      0.31      0.40       151

avg / total       0.92      0.89      0.90      9071

F-1 Score:
0.908191508156
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100785 unique words.
Found 94 unique chars.
Found 9 unique labels.
781 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 253
OOV word occurences: 351
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 67, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 67)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 67, 64)       6450304     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 67, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 67, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 67, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 67, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 67, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,953,410
Trainable params: 6,953,410
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 753 samples, validate on 84 samples
Epoch 1/70

753/753 [==============================] - 16s 22ms/step - loss: 0.7364 - acc: 0.7864 - val_loss: 0.3856 - val_acc: 0.8839
Epoch 2/70

753/753 [==============================] - 13s 17ms/step - loss: 0.3645 - acc: 0.8858 - val_loss: 0.2616 - val_acc: 0.9329
Epoch 3/70

753/753 [==============================] - 13s 17ms/step - loss: 0.2751 - acc: 0.9147 - val_loss: 0.2226 - val_acc: 0.9354
Epoch 4/70

753/753 [==============================] - 13s 17ms/step - loss: 0.2360 - acc: 0.9255 - val_loss: 0.1967 - val_acc: 0.9453
Epoch 5/70

753/753 [==============================] - 13s 17ms/step - loss: 0.2019 - acc: 0.9358 - val_loss: 0.1998 - val_acc: 0.9452
Epoch 6/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1807 - acc: 0.9438 - val_loss: 0.1781 - val_acc: 0.9499
Epoch 7/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1565 - acc: 0.9501 - val_loss: 0.1893 - val_acc: 0.9469
Epoch 8/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1429 - acc: 0.9554 - val_loss: 0.1882 - val_acc: 0.9485
Manual evaluation: (didn't understand why I made this)
True 8085
False 986
True percentage 0.891301951273
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.92      0.74      0.82       438
          O       0.99      0.95      0.97      7318
      B-LOC       0.74      0.63      0.68       218
      I-LOC       0.79      0.66      0.72       141
      I-PER       0.85      0.57      0.68       214
      B-ORG       0.59      0.76      0.67       296
      I-ORG       0.43      0.72      0.54       151
     B-MISC       0.44      0.29      0.35       141
     I-MISC       0.46      0.33      0.38       154

avg / total       0.93      0.89      0.91      9071

F-1 Score:
0.913132976534
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100820 unique words.
Found 94 unique chars.
Found 9 unique labels.
816 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 252
OOV word occurences: 360
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6452544     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,955,650
Trainable params: 6,955,650
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 753 samples, validate on 84 samples
Epoch 1/70

753/753 [==============================] - 19s 25ms/step - loss: 0.6911 - acc: 0.8284 - val_loss: 0.3790 - val_acc: 0.8692
Epoch 2/70

753/753 [==============================] - 15s 20ms/step - loss: 0.3337 - acc: 0.8966 - val_loss: 0.2435 - val_acc: 0.9295
Epoch 3/70

753/753 [==============================] - 15s 20ms/step - loss: 0.2491 - acc: 0.9224 - val_loss: 0.2146 - val_acc: 0.9312
Epoch 4/70

753/753 [==============================] - 15s 20ms/step - loss: 0.2111 - acc: 0.9337 - val_loss: 0.1921 - val_acc: 0.9391
Epoch 5/70

753/753 [==============================] - 15s 20ms/step - loss: 0.1773 - acc: 0.9437 - val_loss: 0.1694 - val_acc: 0.9425
Epoch 6/70

753/753 [==============================] - 15s 20ms/step - loss: 0.1621 - acc: 0.9478 - val_loss: 0.1584 - val_acc: 0.9486
Epoch 7/70

753/753 [==============================] - 15s 20ms/step - loss: 0.1458 - acc: 0.9549 - val_loss: 0.1545 - val_acc: 0.9461
Epoch 8/70

753/753 [==============================] - 15s 20ms/step - loss: 0.1331 - acc: 0.9585 - val_loss: 0.1688 - val_acc: 0.9402
Epoch 9/70

753/753 [==============================] - 15s 20ms/step - loss: 0.1201 - acc: 0.9614 - val_loss: 0.1400 - val_acc: 0.9551
Epoch 10/70

753/753 [==============================] - 15s 20ms/step - loss: 0.1103 - acc: 0.9648 - val_loss: 0.1364 - val_acc: 0.9563
Epoch 11/70

753/753 [==============================] - 15s 20ms/step - loss: 0.1021 - acc: 0.9686 - val_loss: 0.1385 - val_acc: 0.9599
Epoch 12/70

753/753 [==============================] - 15s 20ms/step - loss: 0.0947 - acc: 0.9707 - val_loss: 0.1371 - val_acc: 0.9550
Manual evaluation: (didn't understand why I made this)
True 8146
False 925
True percentage 0.898026678426
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.96      0.97      7318
      B-ORG       0.77      0.62      0.69       296
     B-MISC       0.40      0.32      0.36       141
     I-MISC       0.56      0.37      0.45       154
      B-PER       0.88      0.80      0.84       438
      B-LOC       0.74      0.68      0.71       218
      I-ORG       0.56      0.56      0.56       151
      I-PER       0.88      0.63      0.73       214
      I-LOC       0.83      0.71      0.77       141

avg / total       0.93      0.90      0.91      9071

F-1 Score:
0.683591331269
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100804 unique words.
Found 94 unique chars.
Found 9 unique labels.
800 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 258
OOV word occurences: 365
Padded until 63 tokens.
Padded until 24 chars.
Padded until 63 tokens.
Padded until 24 chars.
Padded until 63 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 63, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 63)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 63, 64)       6451520     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 63, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 63, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 63, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 63, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 63, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,954,626
Trainable params: 6,954,626
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 753 samples, validate on 84 samples
Epoch 1/70

753/753 [==============================] - 15s 20ms/step - loss: 0.7631 - acc: 0.7867 - val_loss: 0.4013 - val_acc: 0.8861
Epoch 2/70

753/753 [==============================] - 12s 16ms/step - loss: 0.3669 - acc: 0.8889 - val_loss: 0.3046 - val_acc: 0.9159
Epoch 3/70

753/753 [==============================] - 12s 16ms/step - loss: 0.2721 - acc: 0.9146 - val_loss: 0.2583 - val_acc: 0.9245
Epoch 4/70

753/753 [==============================] - 12s 16ms/step - loss: 0.2246 - acc: 0.9295 - val_loss: 0.2331 - val_acc: 0.9359
Epoch 5/70

753/753 [==============================] - 12s 16ms/step - loss: 0.1955 - acc: 0.9390 - val_loss: 0.2373 - val_acc: 0.9358
Epoch 6/70

753/753 [==============================] - 12s 16ms/step - loss: 0.1706 - acc: 0.9445 - val_loss: 0.2295 - val_acc: 0.9311
Epoch 7/70

753/753 [==============================] - 12s 16ms/step - loss: 0.1586 - acc: 0.9497 - val_loss: 0.2197 - val_acc: 0.9419
Epoch 8/70

753/753 [==============================] - 12s 16ms/step - loss: 0.1425 - acc: 0.9545 - val_loss: 0.2144 - val_acc: 0.9400
Epoch 9/70

753/753 [==============================] - 12s 16ms/step - loss: 0.1279 - acc: 0.9601 - val_loss: 0.2146 - val_acc: 0.9418
Epoch 10/70

753/753 [==============================] - 12s 16ms/step - loss: 0.1204 - acc: 0.9623 - val_loss: 0.2126 - val_acc: 0.9424
Epoch 11/70

753/753 [==============================] - 12s 16ms/step - loss: 0.1092 - acc: 0.9658 - val_loss: 0.2148 - val_acc: 0.9436
Epoch 12/70

753/753 [==============================] - 12s 16ms/step - loss: 0.1035 - acc: 0.9685 - val_loss: 0.2080 - val_acc: 0.9453
Epoch 13/70

753/753 [==============================] - 12s 16ms/step - loss: 0.0913 - acc: 0.9724 - val_loss: 0.2101 - val_acc: 0.9430
Epoch 14/70

753/753 [==============================] - 12s 16ms/step - loss: 0.0909 - acc: 0.9731 - val_loss: 0.2144 - val_acc: 0.9430
Manual evaluation: (didn't understand why I made this)
True 8131
False 940
True percentage 0.896373056995
Sklearn evaluation:
             precision    recall  f1-score   support

     B-MISC       0.43      0.26      0.32       141
     I-MISC       0.49      0.33      0.39       154
          O       0.98      0.96      0.97      7318
      B-PER       0.89      0.83      0.86       438
      I-PER       0.88      0.64      0.74       214
      B-ORG       0.71      0.68      0.69       296
      B-LOC       0.71      0.71      0.71       218
      I-ORG       0.52      0.49      0.50       151
      I-LOC       0.71      0.74      0.72       141

avg / total       0.93      0.90      0.91      9071

F-1 Score:
0.922402005469
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100790 unique words.
Found 94 unique chars.
Found 9 unique labels.
786 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 257
OOV word occurences: 381
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 67, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 67)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 67, 64)       6450624     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 67, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 67, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 67, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 67, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 67, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,953,730
Trainable params: 6,953,730
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 753 samples, validate on 84 samples
Epoch 1/70

753/753 [==============================] - 16s 21ms/step - loss: 0.8285 - acc: 0.7823 - val_loss: 0.4300 - val_acc: 0.8520
Epoch 2/70

753/753 [==============================] - 13s 17ms/step - loss: 0.3762 - acc: 0.8858 - val_loss: 0.2758 - val_acc: 0.9139
Epoch 3/70

753/753 [==============================] - 13s 17ms/step - loss: 0.2755 - acc: 0.9156 - val_loss: 0.2491 - val_acc: 0.9160
Epoch 4/70

753/753 [==============================] - 13s 17ms/step - loss: 0.2296 - acc: 0.9298 - val_loss: 0.2120 - val_acc: 0.9353
Epoch 5/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1993 - acc: 0.9372 - val_loss: 0.2207 - val_acc: 0.9292
Epoch 6/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1771 - acc: 0.9444 - val_loss: 0.2034 - val_acc: 0.9362
Epoch 7/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1562 - acc: 0.9524 - val_loss: 0.1896 - val_acc: 0.9425
Epoch 8/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1469 - acc: 0.9532 - val_loss: 0.1923 - val_acc: 0.9407
Epoch 9/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1360 - acc: 0.9588 - val_loss: 0.1893 - val_acc: 0.9418
Epoch 10/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1207 - acc: 0.9641 - val_loss: 0.1852 - val_acc: 0.9465
Epoch 11/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1135 - acc: 0.9649 - val_loss: 0.1814 - val_acc: 0.9499
Epoch 12/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1000 - acc: 0.9701 - val_loss: 0.1760 - val_acc: 0.9528
Epoch 13/70

753/753 [==============================] - 13s 17ms/step - loss: 0.0955 - acc: 0.9717 - val_loss: 0.1827 - val_acc: 0.9444
Epoch 14/70

753/753 [==============================] - 13s 17ms/step - loss: 0.0880 - acc: 0.9725 - val_loss: 0.1819 - val_acc: 0.9495
Manual evaluation: (didn't understand why I made this)
True 8105
False 966
True percentage 0.893506779848
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.96      0.97      7318
      B-PER       0.90      0.75      0.82       438
      B-ORG       0.75      0.67      0.71       296
     B-MISC       0.41      0.30      0.35       141
     I-MISC       0.45      0.22      0.30       154
      I-ORG       0.53      0.54      0.54       151
      B-LOC       0.60      0.81      0.69       218
      I-LOC       0.59      0.82      0.69       141
      I-PER       0.87      0.64      0.73       214

avg / total       0.93      0.89      0.91      9071

F-1 Score:
0.664088069027
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100796 unique words.
Found 94 unique chars.
Found 9 unique labels.
792 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 253
OOV word occurences: 368
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 67, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 67)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 67, 64)       6451008     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 67, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 67, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 67, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 67, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 67, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,954,114
Trainable params: 6,954,114
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 753 samples, validate on 84 samples
Epoch 1/70

753/753 [==============================] - 16s 21ms/step - loss: 0.7466 - acc: 0.7982 - val_loss: 0.4419 - val_acc: 0.8550
Epoch 2/70

753/753 [==============================] - 13s 17ms/step - loss: 0.3454 - acc: 0.8926 - val_loss: 0.3090 - val_acc: 0.9010
Epoch 3/70

753/753 [==============================] - 13s 17ms/step - loss: 0.2559 - acc: 0.9205 - val_loss: 0.2753 - val_acc: 0.9061
Epoch 4/70

753/753 [==============================] - 13s 17ms/step - loss: 0.2101 - acc: 0.9335 - val_loss: 0.2453 - val_acc: 0.9155
Epoch 5/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1792 - acc: 0.9446 - val_loss: 0.2114 - val_acc: 0.9337
Epoch 6/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1574 - acc: 0.9517 - val_loss: 0.2164 - val_acc: 0.9333
Epoch 7/70

753/753 [==============================] - 13s 17ms/step - loss: 0.1456 - acc: 0.9548 - val_loss: 0.2155 - val_acc: 0.9346
Manual evaluation: (didn't understand why I made this)
True 8056
False 1015
True percentage 0.88810494984
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.96      0.96      7318
      B-ORG       0.59      0.67      0.62       296
      I-ORG       0.45      0.52      0.48       151
      B-PER       0.90      0.76      0.82       438
     B-MISC       0.41      0.06      0.11       141
     I-MISC       0.36      0.12      0.18       154
      B-LOC       0.82      0.65      0.72       218
      I-LOC       0.79      0.71      0.75       141
      I-PER       0.86      0.61      0.72       214

avg / total       0.91      0.89      0.90      9071

F-1 Score:
0.638351822504
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100358 unique words.
Found 94 unique chars.
Found 9 unique labels.
354 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 287
OOV word occurences: 458
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6422976     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,926,082
Trainable params: 6,926,082
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 300 samples, validate on 34 samples
Epoch 1/70

300/300 [==============================] - 7s 24ms/step - loss: 1.1112 - acc: 0.7065 - val_loss: 0.5648 - val_acc: 0.8157
Epoch 2/70

300/300 [==============================] - 5s 15ms/step - loss: 0.5770 - acc: 0.8246 - val_loss: 0.3956 - val_acc: 0.8819
Epoch 3/70

300/300 [==============================] - 5s 15ms/step - loss: 0.4216 - acc: 0.8669 - val_loss: 0.3112 - val_acc: 0.8956
Epoch 4/70

300/300 [==============================] - 5s 15ms/step - loss: 0.4277 - acc: 0.8747 - val_loss: 0.2985 - val_acc: 0.9079
Epoch 5/70

300/300 [==============================] - 5s 15ms/step - loss: 0.3058 - acc: 0.9046 - val_loss: 0.2952 - val_acc: 0.9202
Epoch 6/70

300/300 [==============================] - 5s 15ms/step - loss: 0.2587 - acc: 0.9230 - val_loss: 0.2563 - val_acc: 0.9212
Epoch 7/70

300/300 [==============================] - 4s 15ms/step - loss: 0.2287 - acc: 0.9278 - val_loss: 0.2546 - val_acc: 0.9202
Epoch 8/70

300/300 [==============================] - 5s 15ms/step - loss: 0.2094 - acc: 0.9327 - val_loss: 0.2933 - val_acc: 0.9042
Epoch 9/70

300/300 [==============================] - 5s 15ms/step - loss: 0.1916 - acc: 0.9397 - val_loss: 0.2320 - val_acc: 0.9277
Epoch 10/70

300/300 [==============================] - 5s 15ms/step - loss: 0.1773 - acc: 0.9447 - val_loss: 0.2288 - val_acc: 0.9301
Epoch 11/70

300/300 [==============================] - 5s 15ms/step - loss: 0.1611 - acc: 0.9531 - val_loss: 0.2633 - val_acc: 0.9141
Epoch 12/70

300/300 [==============================] - 4s 15ms/step - loss: 0.1494 - acc: 0.9544 - val_loss: 0.2414 - val_acc: 0.9254
Manual evaluation: (didn't understand why I made this)
True 7874
False 1197
True percentage 0.868041009811
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-PER       0.87      0.68      0.77       438
      B-LOC       0.65      0.61      0.63       218
      B-ORG       0.69      0.54      0.61       296
      I-ORG       0.37      0.19      0.25       151
      I-PER       0.84      0.54      0.66       214
      I-LOC       0.71      0.60      0.65       141
     B-MISC       0.24      0.21      0.22       141
     I-MISC       0.28      0.41      0.33       154

avg / total       0.91      0.87      0.89      9071

F-1 Score:
0.568847352025
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100395 unique words.
Found 94 unique chars.
Found 9 unique labels.
391 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 281
OOV word occurences: 416
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 58, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 58)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 58, 64)       6425344     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 58, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 58, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 58, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 58, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 58, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,928,450
Trainable params: 6,928,450
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 300 samples, validate on 34 samples
Epoch 1/70

300/300 [==============================] - 7s 24ms/step - loss: 1.2170 - acc: 0.7170 - val_loss: 0.7012 - val_acc: 0.7985
Epoch 2/70

300/300 [==============================] - 5s 16ms/step - loss: 0.5709 - acc: 0.8263 - val_loss: 0.6132 - val_acc: 0.8274
Epoch 3/70

300/300 [==============================] - 5s 16ms/step - loss: 0.4873 - acc: 0.8616 - val_loss: 0.4652 - val_acc: 0.8545
Epoch 4/70

300/300 [==============================] - 5s 16ms/step - loss: 0.3434 - acc: 0.9015 - val_loss: 0.3954 - val_acc: 0.8725
Epoch 5/70

300/300 [==============================] - 5s 16ms/step - loss: 0.2808 - acc: 0.9179 - val_loss: 0.3331 - val_acc: 0.8901
Epoch 6/70

300/300 [==============================] - 5s 15ms/step - loss: 0.2473 - acc: 0.9275 - val_loss: 0.3829 - val_acc: 0.8885
Epoch 7/70

300/300 [==============================] - 5s 15ms/step - loss: 0.2294 - acc: 0.9298 - val_loss: 0.3067 - val_acc: 0.9123
Epoch 8/70

300/300 [==============================] - 5s 15ms/step - loss: 0.1963 - acc: 0.9413 - val_loss: 0.3066 - val_acc: 0.9095
Epoch 9/70

300/300 [==============================] - 5s 15ms/step - loss: 0.1761 - acc: 0.9460 - val_loss: 0.2747 - val_acc: 0.9040
Epoch 10/70

300/300 [==============================] - 5s 15ms/step - loss: 0.1633 - acc: 0.9528 - val_loss: 0.3155 - val_acc: 0.9024
Epoch 11/70

300/300 [==============================] - 5s 15ms/step - loss: 0.1412 - acc: 0.9561 - val_loss: 0.2576 - val_acc: 0.9055
Epoch 12/70

300/300 [==============================] - 5s 15ms/step - loss: 0.1331 - acc: 0.9593 - val_loss: 0.2927 - val_acc: 0.8970
Epoch 13/70

300/300 [==============================] - 5s 15ms/step - loss: 0.1202 - acc: 0.9637 - val_loss: 0.2661 - val_acc: 0.9097
Manual evaluation: (didn't understand why I made this)
True 7961
False 1110
True percentage 0.877632014111
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-ORG       0.66      0.63      0.64       296
      B-LOC       0.68      0.69      0.68       218
      I-ORG       0.41      0.40      0.41       151
     B-MISC       0.21      0.09      0.12       141
     I-MISC       0.30      0.11      0.16       154
      B-PER       0.85      0.79      0.82       438
      I-PER       0.88      0.56      0.68       214
      I-LOC       0.62      0.80      0.70       141

avg / total       0.91      0.88      0.89      9071

F-1 Score:
0.618607516944
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100363 unique words.
Found 94 unique chars.
Found 9 unique labels.
359 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 287
OOV word occurences: 450
Padded until 66 tokens.
Padded until 24 chars.
Padded until 66 tokens.
Padded until 24 chars.
Padded until 66 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 66, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 66)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 66, 64)       6423296     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 66, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 66, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 66, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 66, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 66, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,926,402
Trainable params: 6,926,402
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 300 samples, validate on 34 samples
Epoch 1/70

300/300 [==============================] - 8s 26ms/step - loss: 0.9694 - acc: 0.7471 - val_loss: 0.6182 - val_acc: 0.8022
Epoch 2/70

300/300 [==============================] - 5s 18ms/step - loss: 0.5106 - acc: 0.8451 - val_loss: 0.5066 - val_acc: 0.8816
Epoch 3/70

300/300 [==============================] - 5s 17ms/step - loss: 0.3941 - acc: 0.8825 - val_loss: 0.3808 - val_acc: 0.8830
Epoch 4/70

300/300 [==============================] - 5s 17ms/step - loss: 0.3056 - acc: 0.9080 - val_loss: 0.3026 - val_acc: 0.9067
Epoch 5/70

300/300 [==============================] - 5s 17ms/step - loss: 0.2606 - acc: 0.9187 - val_loss: 0.2937 - val_acc: 0.8974
Epoch 6/70

300/300 [==============================] - 5s 17ms/step - loss: 0.2301 - acc: 0.9245 - val_loss: 0.3410 - val_acc: 0.8915
Epoch 7/70

300/300 [==============================] - 5s 17ms/step - loss: 0.1971 - acc: 0.9377 - val_loss: 0.3538 - val_acc: 0.8889
Manual evaluation: (didn't understand why I made this)
True 7713
False 1358
True percentage 0.850292139786
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.96      0.95      7318
      B-PER       0.82      0.65      0.73       438
      B-ORG       0.62      0.45      0.52       296
      I-ORG       0.27      0.26      0.27       151
      I-PER       0.93      0.37      0.53       214
      B-LOC       0.90      0.34      0.49       218
      I-LOC       1.00      0.21      0.35       141
     B-MISC       0.18      0.19      0.18       141
     I-MISC       0.21      0.10      0.14       154

avg / total       0.89      0.85      0.86      9071

F-1 Score:
0.474740484429
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100362 unique words.
Found 94 unique chars.
Found 9 unique labels.
358 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 281
OOV word occurences: 425
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6423232     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,926,338
Trainable params: 6,926,338
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 300 samples, validate on 34 samples
Epoch 1/70

300/300 [==============================] - 7s 24ms/step - loss: 1.0270 - acc: 0.7573 - val_loss: 0.5981 - val_acc: 0.8155
Epoch 2/70

300/300 [==============================] - 5s 15ms/step - loss: 0.5301 - acc: 0.8382 - val_loss: 0.4423 - val_acc: 0.8757
Epoch 3/70

300/300 [==============================] - 5s 15ms/step - loss: 0.4302 - acc: 0.8703 - val_loss: 0.3855 - val_acc: 0.8947
Epoch 4/70

300/300 [==============================] - 5s 15ms/step - loss: 0.3188 - acc: 0.9032 - val_loss: 0.3404 - val_acc: 0.8952
Epoch 5/70

300/300 [==============================] - 5s 15ms/step - loss: 0.2784 - acc: 0.9113 - val_loss: 0.3080 - val_acc: 0.9075
Epoch 6/70

300/300 [==============================] - 5s 15ms/step - loss: 0.2350 - acc: 0.9273 - val_loss: 0.2827 - val_acc: 0.9071
Epoch 7/70

300/300 [==============================] - 5s 15ms/step - loss: 0.2025 - acc: 0.9388 - val_loss: 0.2742 - val_acc: 0.9164
Epoch 8/70

300/300 [==============================] - 5s 15ms/step - loss: 0.1882 - acc: 0.9437 - val_loss: 0.2621 - val_acc: 0.9151
Epoch 9/70

300/300 [==============================] - 5s 15ms/step - loss: 0.1703 - acc: 0.9475 - val_loss: 0.2860 - val_acc: 0.9208
Epoch 10/70

300/300 [==============================] - 5s 15ms/step - loss: 0.1529 - acc: 0.9559 - val_loss: 0.2675 - val_acc: 0.9213
Manual evaluation: (didn't understand why I made this)
True 7950
False 1121
True percentage 0.876419358395
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.96      0.96      7318
     B-MISC       0.14      0.01      0.01       141
     I-MISC       0.35      0.07      0.12       154
      B-ORG       0.61      0.60      0.61       296
      I-ORG       0.49      0.35      0.41       151
      B-PER       0.84      0.74      0.79       438
      I-PER       0.78      0.57      0.66       214
      B-LOC       0.62      0.71      0.67       218
      I-LOC       0.67      0.78      0.72       141

avg / total       0.90      0.88      0.88      9071

F-1 Score:
0.606870229008
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100380 unique words.
Found 94 unique chars.
Found 9 unique labels.
376 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 282
OOV word occurences: 438
Padded until 63 tokens.
Padded until 24 chars.
Padded until 63 tokens.
Padded until 24 chars.
Padded until 63 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 63, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 63)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 63, 64)       6424384     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 63, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 63, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 63, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 63, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 63, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,927,490
Trainable params: 6,927,490
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 300 samples, validate on 34 samples
Epoch 1/70

300/300 [==============================] - 8s 25ms/step - loss: 1.1092 - acc: 0.7784 - val_loss: 0.5605 - val_acc: 0.8342
Epoch 2/70

300/300 [==============================] - 5s 17ms/step - loss: 0.5539 - acc: 0.8241 - val_loss: 0.4468 - val_acc: 0.8907
Epoch 3/70

300/300 [==============================] - 5s 17ms/step - loss: 0.7752 - acc: 0.8613 - val_loss: 0.3833 - val_acc: 0.8763
Epoch 4/70

300/300 [==============================] - 5s 17ms/step - loss: 0.3659 - acc: 0.8914 - val_loss: 0.2935 - val_acc: 0.9043
Epoch 5/70

300/300 [==============================] - 5s 16ms/step - loss: 0.2904 - acc: 0.9142 - val_loss: 0.2554 - val_acc: 0.9208
Epoch 6/70

300/300 [==============================] - 5s 16ms/step - loss: 0.2484 - acc: 0.9211 - val_loss: 0.2552 - val_acc: 0.9232
Epoch 7/70

300/300 [==============================] - 5s 16ms/step - loss: 0.2244 - acc: 0.9321 - val_loss: 0.2197 - val_acc: 0.9368
Epoch 8/70

300/300 [==============================] - 5s 16ms/step - loss: 0.1994 - acc: 0.9396 - val_loss: 0.2144 - val_acc: 0.9398
Epoch 9/70

300/300 [==============================] - 5s 16ms/step - loss: 0.1858 - acc: 0.9434 - val_loss: 0.2987 - val_acc: 0.9112
Epoch 10/70

300/300 [==============================] - 5s 16ms/step - loss: 0.1842 - acc: 0.9443 - val_loss: 0.2024 - val_acc: 0.9413
Epoch 11/70

300/300 [==============================] - 5s 16ms/step - loss: 0.1487 - acc: 0.9576 - val_loss: 0.2051 - val_acc: 0.9398
Epoch 12/70

300/300 [==============================] - 5s 16ms/step - loss: 0.1380 - acc: 0.9596 - val_loss: 0.2438 - val_acc: 0.9202
Manual evaluation: (didn't understand why I made this)
True 7859
False 1212
True percentage 0.866387388381
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-ORG       0.44      0.65      0.53       296
      B-LOC       0.81      0.55      0.66       218
      B-PER       0.86      0.68      0.76       438
      I-PER       0.82      0.59      0.68       214
     B-MISC       0.33      0.01      0.01       141
      I-ORG       0.30      0.78      0.43       151
      I-LOC       0.84      0.55      0.66       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.91      0.87      0.88      9071

F-1 Score:
0.560528687293
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100354 unique words.
Found 94 unique chars.
Found 9 unique labels.
350 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 286
OOV word occurences: 421
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 58, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 58)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 58, 64)       6422720     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 58, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 58, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 58, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 58, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 58, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,925,826
Trainable params: 6,925,826
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 300 samples, validate on 34 samples
Epoch 1/70

300/300 [==============================] - 7s 24ms/step - loss: 1.1843 - acc: 0.7242 - val_loss: 0.6781 - val_acc: 0.7926
Epoch 2/70

300/300 [==============================] - 5s 16ms/step - loss: 0.5790 - acc: 0.8248 - val_loss: 0.4733 - val_acc: 0.8359
Epoch 3/70

300/300 [==============================] - 5s 16ms/step - loss: 0.4280 - acc: 0.8707 - val_loss: 0.3678 - val_acc: 0.8945
Epoch 4/70

300/300 [==============================] - 5s 16ms/step - loss: 0.3495 - acc: 0.8952 - val_loss: 0.2982 - val_acc: 0.9002
Epoch 5/70

300/300 [==============================] - 5s 15ms/step - loss: 0.2922 - acc: 0.9140 - val_loss: 0.2994 - val_acc: 0.8975
Epoch 6/70

300/300 [==============================] - 5s 15ms/step - loss: 0.2580 - acc: 0.9176 - val_loss: 0.2552 - val_acc: 0.9053
Epoch 7/70

300/300 [==============================] - 5s 15ms/step - loss: 0.2293 - acc: 0.9301 - val_loss: 0.2962 - val_acc: 0.8945
Epoch 8/70

300/300 [==============================] - 5s 15ms/step - loss: 0.2216 - acc: 0.9313 - val_loss: 0.2669 - val_acc: 0.9050
Manual evaluation: (didn't understand why I made this)
True 7869
False 1202
True percentage 0.867489802668
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-PER       0.75      0.68      0.72       438
      B-ORG       0.70      0.45      0.55       296
     I-MISC       0.26      0.04      0.07       154
      B-LOC       0.62      0.70      0.65       218
      I-LOC       0.44      0.87      0.59       141
      I-ORG       0.43      0.33      0.38       151
      I-PER       0.72      0.61      0.66       214
     B-MISC       0.00      0.00      0.00       141

avg / total       0.89      0.87      0.87      9071

F-1 Score:
0.560929648241
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100379 unique words.
Found 94 unique chars.
Found 9 unique labels.
375 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 277
OOV word occurences: 429
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 58, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 58)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 58, 64)       6424320     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 58, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 58, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 58, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 58, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 58, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,927,426
Trainable params: 6,927,426
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 300 samples, validate on 34 samples
Epoch 1/70

300/300 [==============================] - 7s 25ms/step - loss: 1.1093 - acc: 0.7270 - val_loss: 0.6156 - val_acc: 0.8105
Epoch 2/70

300/300 [==============================] - 5s 16ms/step - loss: 0.5663 - acc: 0.8300 - val_loss: 0.4794 - val_acc: 0.8954
Epoch 3/70

300/300 [==============================] - 5s 16ms/step - loss: 0.4220 - acc: 0.8757 - val_loss: 0.3286 - val_acc: 0.8760
Epoch 4/70

300/300 [==============================] - 5s 15ms/step - loss: 0.3536 - acc: 0.8938 - val_loss: 0.2727 - val_acc: 0.9247
Epoch 5/70

300/300 [==============================] - 5s 15ms/step - loss: 0.2877 - acc: 0.9152 - val_loss: 0.2361 - val_acc: 0.9195
Epoch 6/70

300/300 [==============================] - 5s 15ms/step - loss: 0.2474 - acc: 0.9249 - val_loss: 0.2098 - val_acc: 0.9356
Epoch 7/70

300/300 [==============================] - 5s 15ms/step - loss: 0.2190 - acc: 0.9338 - val_loss: 0.1907 - val_acc: 0.9437
Epoch 8/70

300/300 [==============================] - 5s 15ms/step - loss: 0.1920 - acc: 0.9409 - val_loss: 0.1803 - val_acc: 0.9437
Epoch 9/70

300/300 [==============================] - 5s 15ms/step - loss: 0.1859 - acc: 0.9434 - val_loss: 0.1846 - val_acc: 0.9374
Epoch 10/70

300/300 [==============================] - 5s 15ms/step - loss: 0.1596 - acc: 0.9497 - val_loss: 0.1750 - val_acc: 0.9414
Epoch 11/70

300/300 [==============================] - 5s 15ms/step - loss: 0.1499 - acc: 0.9517 - val_loss: 0.1730 - val_acc: 0.9382
Epoch 12/70

300/300 [==============================] - 5s 15ms/step - loss: 0.1363 - acc: 0.9586 - val_loss: 0.1708 - val_acc: 0.9393
Epoch 13/70

300/300 [==============================] - 5s 15ms/step - loss: 0.1271 - acc: 0.9624 - val_loss: 0.1628 - val_acc: 0.9444
Epoch 14/70

300/300 [==============================] - 5s 15ms/step - loss: 0.1128 - acc: 0.9691 - val_loss: 0.1786 - val_acc: 0.9301
Epoch 15/70

300/300 [==============================] - 5s 15ms/step - loss: 0.1124 - acc: 0.9685 - val_loss: 0.1672 - val_acc: 0.9360
Manual evaluation: (didn't understand why I made this)
True 7958
False 1113
True percentage 0.877301289825
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-PER       0.81      0.71      0.75       438
      B-LOC       0.71      0.66      0.69       218
      B-ORG       0.60      0.64      0.62       296
      I-PER       0.73      0.60      0.66       214
     B-MISC       0.51      0.21      0.29       141
     I-MISC       0.44      0.26      0.33       154
      I-LOC       0.64      0.78      0.70       141
      I-ORG       0.49      0.46      0.47       151

avg / total       0.91      0.88      0.89      9071

F-1 Score:
0.619872379216
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100374 unique words.
Found 94 unique chars.
Found 9 unique labels.
370 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 281
OOV word occurences: 431
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 58, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 58)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 58, 64)       6424000     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 58, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 58, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 58, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 58, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 58, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,927,106
Trainable params: 6,927,106
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 300 samples, validate on 34 samples
Epoch 1/70

300/300 [==============================] - 7s 24ms/step - loss: 1.1509 - acc: 0.7319 - val_loss: 0.5926 - val_acc: 0.8204
Epoch 2/70

300/300 [==============================] - 5s 16ms/step - loss: 0.5523 - acc: 0.8326 - val_loss: 0.5436 - val_acc: 0.8432
Epoch 3/70

300/300 [==============================] - 5s 15ms/step - loss: 0.4416 - acc: 0.8665 - val_loss: 0.3271 - val_acc: 0.9049
Epoch 4/70

300/300 [==============================] - 5s 16ms/step - loss: 0.3326 - acc: 0.8991 - val_loss: 0.2676 - val_acc: 0.9140
Epoch 5/70

300/300 [==============================] - 5s 15ms/step - loss: 0.2892 - acc: 0.9151 - val_loss: 0.2416 - val_acc: 0.9262
Epoch 6/70

300/300 [==============================] - 5s 15ms/step - loss: 0.2461 - acc: 0.9257 - val_loss: 0.2524 - val_acc: 0.9023
Epoch 7/70

300/300 [==============================] - 5s 15ms/step - loss: 0.2218 - acc: 0.9318 - val_loss: 0.2105 - val_acc: 0.9338
Epoch 8/70

300/300 [==============================] - 5s 15ms/step - loss: 0.1944 - acc: 0.9411 - val_loss: 0.1989 - val_acc: 0.9409
Epoch 9/70

300/300 [==============================] - 5s 15ms/step - loss: 0.1873 - acc: 0.9421 - val_loss: 0.1964 - val_acc: 0.9415
Epoch 10/70

300/300 [==============================] - 5s 15ms/step - loss: 0.1660 - acc: 0.9500 - val_loss: 0.1774 - val_acc: 0.9385
Epoch 11/70

300/300 [==============================] - 5s 15ms/step - loss: 0.1530 - acc: 0.9531 - val_loss: 0.1727 - val_acc: 0.9411
Epoch 12/70

300/300 [==============================] - 5s 15ms/step - loss: 0.1353 - acc: 0.9606 - val_loss: 0.1674 - val_acc: 0.9400
Epoch 13/70

300/300 [==============================] - 5s 15ms/step - loss: 0.1177 - acc: 0.9641 - val_loss: 0.1693 - val_acc: 0.9415
Epoch 14/70

300/300 [==============================] - 5s 15ms/step - loss: 0.1292 - acc: 0.9612 - val_loss: 0.1747 - val_acc: 0.9444
Manual evaluation: (didn't understand why I made this)
True 7955
False 1116
True percentage 0.876970565539
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-ORG       0.66      0.64      0.65       296
      I-ORG       0.43      0.48      0.45       151
      B-PER       0.79      0.73      0.76       438
      B-LOC       0.65      0.75      0.70       218
      I-LOC       0.61      0.79      0.69       141
      I-PER       0.83      0.54      0.65       214
     B-MISC       0.33      0.09      0.14       141
     I-MISC       0.37      0.22      0.28       154

avg / total       0.91      0.88      0.89      9071

F-1 Score:
0.612368024133
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100407 unique words.
Found 94 unique chars.
Found 9 unique labels.
403 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 288
OOV word occurences: 456
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 67, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 67)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 67, 64)       6426112     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 67, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 67, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 67, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 67, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 67, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,929,218
Trainable params: 6,929,218
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 300 samples, validate on 34 samples
Epoch 1/70

300/300 [==============================] - 8s 27ms/step - loss: 1.2718 - acc: 0.7204 - val_loss: 0.6577 - val_acc: 0.8090
Epoch 2/70

300/300 [==============================] - 5s 18ms/step - loss: 0.5641 - acc: 0.8314 - val_loss: 0.4833 - val_acc: 0.8677
Epoch 3/70

300/300 [==============================] - 5s 18ms/step - loss: 0.4928 - acc: 0.8635 - val_loss: 0.4805 - val_acc: 0.8704
Epoch 4/70

300/300 [==============================] - 5s 18ms/step - loss: 0.3596 - acc: 0.8945 - val_loss: 0.3730 - val_acc: 0.8745
Epoch 5/70

300/300 [==============================] - 5s 17ms/step - loss: 0.3045 - acc: 0.9082 - val_loss: 0.3269 - val_acc: 0.8827
Epoch 6/70

300/300 [==============================] - 5s 17ms/step - loss: 0.2638 - acc: 0.9187 - val_loss: 0.3053 - val_acc: 0.8950
Epoch 7/70

300/300 [==============================] - 5s 17ms/step - loss: 0.2351 - acc: 0.9300 - val_loss: 0.2855 - val_acc: 0.8991
Epoch 8/70

300/300 [==============================] - 5s 17ms/step - loss: 0.2152 - acc: 0.9337 - val_loss: 0.2992 - val_acc: 0.8950
Epoch 9/70

300/300 [==============================] - 5s 17ms/step - loss: 0.1941 - acc: 0.9391 - val_loss: 0.2850 - val_acc: 0.9059
Epoch 10/70

300/300 [==============================] - 5s 17ms/step - loss: 0.1773 - acc: 0.9442 - val_loss: 0.2621 - val_acc: 0.9045
Epoch 11/70

300/300 [==============================] - 5s 17ms/step - loss: 0.1595 - acc: 0.9514 - val_loss: 0.2976 - val_acc: 0.9059
Epoch 12/70

300/300 [==============================] - 5s 17ms/step - loss: 0.1586 - acc: 0.9520 - val_loss: 0.2343 - val_acc: 0.9154
Epoch 13/70

300/300 [==============================] - 5s 17ms/step - loss: 0.1368 - acc: 0.9575 - val_loss: 0.2425 - val_acc: 0.9195
Epoch 14/70

300/300 [==============================] - 5s 17ms/step - loss: 0.1253 - acc: 0.9638 - val_loss: 0.2693 - val_acc: 0.9045
Manual evaluation: (didn't understand why I made this)
True 7935
False 1136
True percentage 0.874765736964
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-ORG       0.52      0.68      0.59       296
      I-ORG       0.42      0.62      0.50       151
     B-MISC       0.33      0.08      0.13       141
     I-MISC       0.43      0.23      0.30       154
      B-PER       0.88      0.70      0.78       438
      B-LOC       0.82      0.48      0.61       218
      I-LOC       0.85      0.55      0.66       141
      I-PER       0.88      0.59      0.71       214

avg / total       0.92      0.87      0.89      9071

F-1 Score:
0.600564794478
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100409 unique words.
Found 94 unique chars.
Found 9 unique labels.
405 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 276
OOV word occurences: 398
Padded until 66 tokens.
Padded until 24 chars.
Padded until 66 tokens.
Padded until 24 chars.
Padded until 66 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 66, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 66)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 66, 64)       6426240     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 66, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 66, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 66, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 66, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 66, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,929,346
Trainable params: 6,929,346
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 300 samples, validate on 34 samples
Epoch 1/70

300/300 [==============================] - 8s 27ms/step - loss: 1.1817 - acc: 0.7182 - val_loss: 0.5507 - val_acc: 0.8224
Epoch 2/70

300/300 [==============================] - 5s 18ms/step - loss: 0.5651 - acc: 0.8291 - val_loss: 0.3437 - val_acc: 0.9057
Epoch 3/70

300/300 [==============================] - 5s 17ms/step - loss: 0.4054 - acc: 0.8811 - val_loss: 0.5081 - val_acc: 0.8416
Epoch 4/70

300/300 [==============================] - 5s 17ms/step - loss: 0.3578 - acc: 0.8886 - val_loss: 0.2375 - val_acc: 0.9459
Epoch 5/70

300/300 [==============================] - 5s 17ms/step - loss: 0.2716 - acc: 0.9188 - val_loss: 0.2099 - val_acc: 0.9473
Epoch 6/70

300/300 [==============================] - 5s 17ms/step - loss: 0.2417 - acc: 0.9280 - val_loss: 0.1962 - val_acc: 0.9459
Epoch 7/70

300/300 [==============================] - 5s 17ms/step - loss: 0.2183 - acc: 0.9334 - val_loss: 0.1857 - val_acc: 0.9487
Epoch 8/70

300/300 [==============================] - 5s 17ms/step - loss: 0.1873 - acc: 0.9426 - val_loss: 0.1760 - val_acc: 0.9474
Epoch 9/70

300/300 [==============================] - 5s 17ms/step - loss: 0.1747 - acc: 0.9494 - val_loss: 0.3370 - val_acc: 0.8929
Epoch 10/70

300/300 [==============================] - 5s 17ms/step - loss: 0.1765 - acc: 0.9455 - val_loss: 0.1726 - val_acc: 0.9541
Epoch 11/70

300/300 [==============================] - 5s 17ms/step - loss: 0.1513 - acc: 0.9578 - val_loss: 0.1605 - val_acc: 0.9541
Epoch 12/70

300/300 [==============================] - 5s 17ms/step - loss: 0.1315 - acc: 0.9599 - val_loss: 0.1660 - val_acc: 0.9541
Epoch 13/70

300/300 [==============================] - 5s 17ms/step - loss: 0.1249 - acc: 0.9644 - val_loss: 0.1568 - val_acc: 0.9500
Epoch 14/70

300/300 [==============================] - 5s 17ms/step - loss: 0.1102 - acc: 0.9721 - val_loss: 0.1605 - val_acc: 0.9499
Epoch 15/70

300/300 [==============================] - 5s 17ms/step - loss: 0.1067 - acc: 0.9687 - val_loss: 0.1560 - val_acc: 0.9541
Epoch 16/70

300/300 [==============================] - 5s 17ms/step - loss: 0.1021 - acc: 0.9710 - val_loss: 0.1604 - val_acc: 0.9471
Epoch 17/70

300/300 [==============================] - 5s 17ms/step - loss: 0.0888 - acc: 0.9764 - val_loss: 0.1817 - val_acc: 0.9485
Manual evaluation: (didn't understand why I made this)
True 7907
False 1164
True percentage 0.87167897696
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.95      0.59      0.72       438
          O       0.96      0.96      0.96      7318
      B-ORG       0.58      0.65      0.61       296
     B-MISC       0.28      0.15      0.20       141
      B-LOC       0.77      0.60      0.67       218
      I-LOC       0.86      0.49      0.62       141
     I-MISC       0.27      0.16      0.20       154
      I-PER       0.97      0.52      0.68       214
      I-ORG       0.36      0.62      0.45       151

avg / total       0.91      0.87      0.89      9071

F-1 Score:
0.898150865864
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100379 unique words.
Found 94 unique chars.
Found 9 unique labels.
375 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 282
OOV word occurences: 459
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 58, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 58)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 58, 64)       6424320     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 58, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 58, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 58, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 58, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 58, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,927,426
Trainable params: 6,927,426
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 300 samples, validate on 34 samples
Epoch 1/70

300/300 [==============================] - 7s 25ms/step - loss: 1.0282 - acc: 0.7148 - val_loss: 0.6045 - val_acc: 0.8077
Epoch 2/70

300/300 [==============================] - 5s 16ms/step - loss: 0.5278 - acc: 0.8384 - val_loss: 0.4038 - val_acc: 0.8766
Epoch 3/70

300/300 [==============================] - 5s 15ms/step - loss: 0.4067 - acc: 0.8811 - val_loss: 0.3345 - val_acc: 0.9024
Epoch 4/70

300/300 [==============================] - 5s 15ms/step - loss: 0.3190 - acc: 0.9033 - val_loss: 0.3245 - val_acc: 0.8939
Epoch 5/70

300/300 [==============================] - 5s 16ms/step - loss: 0.2663 - acc: 0.9180 - val_loss: 0.3086 - val_acc: 0.8980
Epoch 6/70

300/300 [==============================] - 5s 15ms/step - loss: 0.2324 - acc: 0.9262 - val_loss: 0.2614 - val_acc: 0.9210
Epoch 7/70

300/300 [==============================] - 5s 15ms/step - loss: 0.2033 - acc: 0.9372 - val_loss: 0.2589 - val_acc: 0.9153
Epoch 8/70

300/300 [==============================] - 5s 15ms/step - loss: 0.1882 - acc: 0.9423 - val_loss: 0.2823 - val_acc: 0.9066
Epoch 9/70

300/300 [==============================] - 5s 15ms/step - loss: 0.1696 - acc: 0.9493 - val_loss: 0.2646 - val_acc: 0.9081
Manual evaluation: (didn't understand why I made this)
True 7779
False 1292
True percentage 0.857568074082
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.89      0.63      0.73       438
          O       0.94      0.97      0.95      7318
      B-LOC       0.84      0.50      0.62       218
      I-LOC       0.74      0.40      0.52       141
      I-PER       0.89      0.55      0.68       214
      B-ORG       0.50      0.34      0.40       296
      I-ORG       0.26      0.25      0.26       151
     B-MISC       0.22      0.07      0.11       141
     I-MISC       0.28      0.07      0.11       154

avg / total       0.88      0.86      0.86      9071

F-1 Score:
0.886277751535
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100388 unique words.
Found 94 unique chars.
Found 9 unique labels.
384 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 280
OOV word occurences: 464
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6424896     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 83, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 83, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,928,002
Trainable params: 6,928,002
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 300 samples, validate on 34 samples
Epoch 1/70

300/300 [==============================] - 9s 30ms/step - loss: 1.1409 - acc: 0.7304 - val_loss: 0.7736 - val_acc: 0.7627
Epoch 2/70

300/300 [==============================] - 6s 21ms/step - loss: 0.5575 - acc: 0.8387 - val_loss: 0.6067 - val_acc: 0.8028
Epoch 3/70

300/300 [==============================] - 6s 21ms/step - loss: 0.4087 - acc: 0.8760 - val_loss: 0.5340 - val_acc: 0.8242
Epoch 4/70

300/300 [==============================] - 6s 20ms/step - loss: 0.3256 - acc: 0.9012 - val_loss: 0.4795 - val_acc: 0.8471
Epoch 5/70

300/300 [==============================] - 6s 20ms/step - loss: 0.2776 - acc: 0.9130 - val_loss: 0.4473 - val_acc: 0.8500
Epoch 6/70

300/300 [==============================] - 6s 20ms/step - loss: 0.2389 - acc: 0.9282 - val_loss: 0.4567 - val_acc: 0.8528
Epoch 7/70

300/300 [==============================] - 6s 20ms/step - loss: 0.2198 - acc: 0.9362 - val_loss: 0.4029 - val_acc: 0.8671
Epoch 8/70

300/300 [==============================] - 6s 20ms/step - loss: 0.1909 - acc: 0.9415 - val_loss: 0.3809 - val_acc: 0.8686
Epoch 9/70

300/300 [==============================] - 6s 20ms/step - loss: 0.1733 - acc: 0.9472 - val_loss: 0.3768 - val_acc: 0.8799
Epoch 10/70

300/300 [==============================] - 6s 20ms/step - loss: 0.1502 - acc: 0.9508 - val_loss: 0.3790 - val_acc: 0.8743
Epoch 11/70

300/300 [==============================] - 6s 20ms/step - loss: 0.1399 - acc: 0.9572 - val_loss: 0.3817 - val_acc: 0.8843
Manual evaluation: (didn't understand why I made this)
True 7880
False 1191
True percentage 0.868702458384
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-ORG       0.61      0.45      0.52       296
     B-MISC       0.34      0.12      0.18       141
     I-MISC       0.27      0.33      0.29       154
      B-PER       0.90      0.69      0.78       438
      B-LOC       0.61      0.80      0.69       218
      I-ORG       0.49      0.29      0.37       151
      I-PER       0.92      0.53      0.67       214
      I-LOC       0.61      0.79      0.69       141

avg / total       0.91      0.87      0.89      9071

F-1 Score:
0.585833591092
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100372 unique words.
Found 94 unique chars.
Found 9 unique labels.
368 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 274
OOV word occurences: 397
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6423872     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,926,978
Trainable params: 6,926,978
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 300 samples, validate on 34 samples
Epoch 1/70

300/300 [==============================] - 7s 24ms/step - loss: 1.1794 - acc: 0.7200 - val_loss: 0.7397 - val_acc: 0.7866
Epoch 2/70

300/300 [==============================] - 5s 16ms/step - loss: 0.5648 - acc: 0.8273 - val_loss: 0.5615 - val_acc: 0.8095
Epoch 3/70

300/300 [==============================] - 5s 15ms/step - loss: 0.4154 - acc: 0.8730 - val_loss: 0.4440 - val_acc: 0.8652
Epoch 4/70

300/300 [==============================] - 5s 15ms/step - loss: 0.3340 - acc: 0.8978 - val_loss: 0.4249 - val_acc: 0.8663
Epoch 5/70

300/300 [==============================] - 5s 15ms/step - loss: 0.2841 - acc: 0.9118 - val_loss: 0.3762 - val_acc: 0.8791
Epoch 6/70

300/300 [==============================] - 5s 15ms/step - loss: 0.2478 - acc: 0.9258 - val_loss: 0.2978 - val_acc: 0.9148
Epoch 7/70

300/300 [==============================] - 5s 15ms/step - loss: 0.2084 - acc: 0.9346 - val_loss: 0.2848 - val_acc: 0.9188
Epoch 8/70

300/300 [==============================] - 5s 15ms/step - loss: 0.1875 - acc: 0.9413 - val_loss: 0.2931 - val_acc: 0.9086
Epoch 9/70

300/300 [==============================] - 5s 15ms/step - loss: 0.1776 - acc: 0.9470 - val_loss: 0.3146 - val_acc: 0.9071
Manual evaluation: (didn't understand why I made this)
True 7780
False 1291
True percentage 0.857678315511
Sklearn evaluation:
             precision    recall  f1-score   support

     B-MISC       0.43      0.02      0.04       141
     I-MISC       0.20      0.06      0.10       154
          O       0.92      0.97      0.94      7318
      B-PER       0.88      0.55      0.68       438
      I-PER       0.88      0.47      0.61       214
      B-ORG       0.67      0.52      0.58       296
      B-LOC       0.82      0.49      0.61       218
      I-ORG       0.35      0.19      0.25       151
      I-LOC       0.92      0.47      0.62       141

avg / total       0.87      0.86      0.86      9071

F-1 Score:
0.883900664886
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100376 unique words.
Found 94 unique chars.
Found 9 unique labels.
372 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 285
OOV word occurences: 448
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 67, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 67)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 67, 64)       6424128     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 67, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 67, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 67, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 67, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 67, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,927,234
Trainable params: 6,927,234
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 300 samples, validate on 34 samples
Epoch 1/70

300/300 [==============================] - 8s 27ms/step - loss: 1.0772 - acc: 0.7139 - val_loss: 0.7037 - val_acc: 0.8115
Epoch 2/70

300/300 [==============================] - 5s 18ms/step - loss: 0.5693 - acc: 0.8312 - val_loss: 0.4949 - val_acc: 0.8431
Epoch 3/70

300/300 [==============================] - 5s 18ms/step - loss: 0.4264 - acc: 0.8698 - val_loss: 0.3845 - val_acc: 0.8759
Epoch 4/70

300/300 [==============================] - 5s 18ms/step - loss: 0.3367 - acc: 0.8987 - val_loss: 0.3338 - val_acc: 0.8840
Epoch 5/70

300/300 [==============================] - 5s 18ms/step - loss: 0.2771 - acc: 0.9173 - val_loss: 0.2769 - val_acc: 0.8997
Epoch 6/70

300/300 [==============================] - 5s 17ms/step - loss: 0.2364 - acc: 0.9252 - val_loss: 0.3511 - val_acc: 0.8853
Epoch 7/70

300/300 [==============================] - 5s 17ms/step - loss: 0.2206 - acc: 0.9329 - val_loss: 0.2506 - val_acc: 0.9122
Epoch 8/70

300/300 [==============================] - 5s 17ms/step - loss: 0.1912 - acc: 0.9416 - val_loss: 0.2211 - val_acc: 0.9303
Epoch 9/70

300/300 [==============================] - 5s 17ms/step - loss: 0.1717 - acc: 0.9495 - val_loss: 0.2265 - val_acc: 0.9209
Epoch 10/70

300/300 [==============================] - 5s 17ms/step - loss: 0.1587 - acc: 0.9543 - val_loss: 0.2172 - val_acc: 0.9259
Epoch 11/70

300/300 [==============================] - 5s 17ms/step - loss: 0.1509 - acc: 0.9536 - val_loss: 0.2162 - val_acc: 0.9219
Epoch 12/70

300/300 [==============================] - 5s 17ms/step - loss: 0.1339 - acc: 0.9611 - val_loss: 0.2033 - val_acc: 0.9344
Epoch 13/70

300/300 [==============================] - 5s 17ms/step - loss: 0.1271 - acc: 0.9569 - val_loss: 0.2092 - val_acc: 0.9289
Epoch 14/70

300/300 [==============================] - 5s 17ms/step - loss: 0.1106 - acc: 0.9675 - val_loss: 0.1969 - val_acc: 0.9329
Epoch 15/70

300/300 [==============================] - 5s 17ms/step - loss: 0.1005 - acc: 0.9709 - val_loss: 0.2267 - val_acc: 0.9311
Epoch 16/70

300/300 [==============================] - 5s 17ms/step - loss: 0.1006 - acc: 0.9682 - val_loss: 0.2002 - val_acc: 0.9347
Manual evaluation: (didn't understand why I made this)
True 7947
False 1124
True percentage 0.876088634109
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-PER       0.89      0.75      0.81       438
      B-ORG       0.65      0.52      0.58       296
     B-MISC       0.23      0.35      0.28       141
     I-MISC       0.36      0.36      0.36       154
      I-ORG       0.50      0.45      0.47       151
      B-LOC       0.83      0.55      0.66       218
      I-LOC       0.89      0.65      0.75       141
      I-PER       0.84      0.63      0.72       214

avg / total       0.92      0.88      0.90      9071

F-1 Score:
0.611858190709
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100397 unique words.
Found 94 unique chars.
Found 9 unique labels.
393 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 279
OOV word occurences: 461
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6425472     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,928,578
Trainable params: 6,928,578
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 300 samples, validate on 34 samples
Epoch 1/70

300/300 [==============================] - 7s 24ms/step - loss: 1.0263 - acc: 0.7737 - val_loss: 0.6387 - val_acc: 0.7882
Epoch 2/70

300/300 [==============================] - 5s 15ms/step - loss: 0.5423 - acc: 0.8423 - val_loss: 0.4750 - val_acc: 0.8676
Epoch 3/70

300/300 [==============================] - 5s 15ms/step - loss: 0.3918 - acc: 0.8803 - val_loss: 0.3554 - val_acc: 0.8872
Epoch 4/70

300/300 [==============================] - 5s 15ms/step - loss: 0.3126 - acc: 0.9094 - val_loss: 0.2873 - val_acc: 0.9249
Epoch 5/70

300/300 [==============================] - 5s 15ms/step - loss: 0.2590 - acc: 0.9209 - val_loss: 0.2797 - val_acc: 0.9184
Epoch 6/70

300/300 [==============================] - 5s 15ms/step - loss: 0.2184 - acc: 0.9341 - val_loss: 0.2528 - val_acc: 0.9247
Epoch 7/70

300/300 [==============================] - 5s 15ms/step - loss: 0.2025 - acc: 0.9328 - val_loss: 0.2702 - val_acc: 0.9139
Epoch 8/70

300/300 [==============================] - 5s 15ms/step - loss: 0.1854 - acc: 0.9428 - val_loss: 0.2353 - val_acc: 0.9274
Epoch 9/70

300/300 [==============================] - 5s 15ms/step - loss: 0.1579 - acc: 0.9526 - val_loss: 0.2176 - val_acc: 0.9303
Epoch 10/70

300/300 [==============================] - 5s 15ms/step - loss: 0.1462 - acc: 0.9536 - val_loss: 0.2191 - val_acc: 0.9303
Epoch 11/70

300/300 [==============================] - 5s 15ms/step - loss: 0.1292 - acc: 0.9604 - val_loss: 0.2038 - val_acc: 0.9365
Epoch 12/70

300/300 [==============================] - 4s 15ms/step - loss: 0.1201 - acc: 0.9653 - val_loss: 0.2221 - val_acc: 0.9380
Epoch 13/70

300/300 [==============================] - 5s 15ms/step - loss: 0.1068 - acc: 0.9655 - val_loss: 0.2411 - val_acc: 0.9231
Manual evaluation: (didn't understand why I made this)
True 7896
False 1175
True percentage 0.870466321244
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.96      0.96      7318
      B-ORG       0.74      0.47      0.58       296
      I-ORG       0.57      0.08      0.14       151
      B-PER       0.89      0.69      0.78       438
     B-MISC       0.24      0.15      0.18       141
     I-MISC       0.30      0.43      0.35       154
      B-LOC       0.79      0.56      0.65       218
      I-LOC       0.78      0.62      0.69       141
      I-PER       0.95      0.49      0.64       214

avg / total       0.91      0.87      0.88      9071

F-1 Score:
0.572291177457
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100192 unique words.
Found 94 unique chars.
Found 9 unique labels.
188 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 299
OOV word occurences: 491
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6412352     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,915,458
Trainable params: 6,915,458
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 150 samples, validate on 17 samples
Epoch 1/70

150/150 [==============================] - 5s 32ms/step - loss: 1.9147 - acc: 0.6300 - val_loss: 0.9472 - val_acc: 0.7819
Epoch 2/70

150/150 [==============================] - 2s 16ms/step - loss: 0.7951 - acc: 0.7963 - val_loss: 0.7558 - val_acc: 0.7819
Epoch 3/70

150/150 [==============================] - 2s 16ms/step - loss: 0.6178 - acc: 0.8075 - val_loss: 0.6213 - val_acc: 0.7941
Epoch 4/70

150/150 [==============================] - 2s 16ms/step - loss: 0.5167 - acc: 0.8379 - val_loss: 0.5592 - val_acc: 0.8137
Epoch 5/70

150/150 [==============================] - 2s 16ms/step - loss: 0.4426 - acc: 0.8667 - val_loss: 0.5011 - val_acc: 0.8137
Epoch 6/70

150/150 [==============================] - 2s 15ms/step - loss: 0.3757 - acc: 0.8810 - val_loss: 0.4326 - val_acc: 0.8358
Epoch 7/70

150/150 [==============================] - 2s 15ms/step - loss: 0.3175 - acc: 0.8977 - val_loss: 0.3914 - val_acc: 0.8627
Epoch 8/70

150/150 [==============================] - 2s 15ms/step - loss: 0.2792 - acc: 0.9069 - val_loss: 0.3623 - val_acc: 0.8676
Epoch 9/70

150/150 [==============================] - 2s 15ms/step - loss: 0.2588 - acc: 0.9154 - val_loss: 0.3234 - val_acc: 0.8922
Epoch 10/70

150/150 [==============================] - 2s 15ms/step - loss: 0.2553 - acc: 0.9181 - val_loss: 0.3063 - val_acc: 0.8897
Epoch 11/70

150/150 [==============================] - 2s 15ms/step - loss: 0.2079 - acc: 0.9370 - val_loss: 0.2773 - val_acc: 0.8995
Epoch 12/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1831 - acc: 0.9418 - val_loss: 0.2674 - val_acc: 0.9118
Epoch 13/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1684 - acc: 0.9520 - val_loss: 0.2842 - val_acc: 0.8946
Epoch 14/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1564 - acc: 0.9475 - val_loss: 0.2439 - val_acc: 0.9216
Epoch 15/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1435 - acc: 0.9595 - val_loss: 0.2413 - val_acc: 0.9142
Epoch 16/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1345 - acc: 0.9624 - val_loss: 0.2315 - val_acc: 0.9216
Epoch 17/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1274 - acc: 0.9605 - val_loss: 0.2373 - val_acc: 0.9216
Epoch 18/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1081 - acc: 0.9712 - val_loss: 0.2326 - val_acc: 0.9240
Manual evaluation: (didn't understand why I made this)
True 7837
False 1234
True percentage 0.863962076949
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-PER       0.83      0.63      0.71       438
      B-LOC       0.66      0.63      0.65       218
      B-ORG       0.71      0.61      0.65       296
      I-ORG       0.39      0.32      0.35       151
      I-PER       0.87      0.45      0.60       214
      I-LOC       0.58      0.66      0.62       141
     B-MISC       0.35      0.16      0.22       141
     I-MISC       0.29      0.24      0.26       154

avg / total       0.90      0.86      0.88      9071

F-1 Score:
0.567877629063
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100224 unique words.
Found 94 unique chars.
Found 9 unique labels.
220 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 299
OOV word occurences: 471
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6414400     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,917,506
Trainable params: 6,917,506
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 150 samples, validate on 17 samples
Epoch 1/70

150/150 [==============================] - 5s 33ms/step - loss: 1.6099 - acc: 0.6362 - val_loss: 0.7969 - val_acc: 0.7933
Epoch 2/70

150/150 [==============================] - 2s 16ms/step - loss: 0.7371 - acc: 0.7996 - val_loss: 0.6707 - val_acc: 0.7957
Epoch 3/70

150/150 [==============================] - 2s 16ms/step - loss: 0.6181 - acc: 0.8135 - val_loss: 0.5665 - val_acc: 0.8290
Epoch 4/70

150/150 [==============================] - 2s 16ms/step - loss: 0.4820 - acc: 0.8441 - val_loss: 0.4971 - val_acc: 0.8242
Epoch 5/70

150/150 [==============================] - 2s 16ms/step - loss: 0.4366 - acc: 0.8662 - val_loss: 0.4521 - val_acc: 0.8599
Epoch 6/70

150/150 [==============================] - 2s 15ms/step - loss: 0.3426 - acc: 0.8994 - val_loss: 0.4034 - val_acc: 0.8765
Epoch 7/70

150/150 [==============================] - 2s 15ms/step - loss: 0.2965 - acc: 0.9133 - val_loss: 0.4358 - val_acc: 0.8646
Epoch 8/70

150/150 [==============================] - 2s 15ms/step - loss: 0.2768 - acc: 0.9197 - val_loss: 0.3512 - val_acc: 0.8812
Epoch 9/70

150/150 [==============================] - 2s 15ms/step - loss: 0.2329 - acc: 0.9325 - val_loss: 0.3297 - val_acc: 0.8955
Epoch 10/70

150/150 [==============================] - 2s 15ms/step - loss: 0.2039 - acc: 0.9394 - val_loss: 0.3673 - val_acc: 0.8646
Epoch 11/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1996 - acc: 0.9411 - val_loss: 0.3169 - val_acc: 0.8907
Epoch 12/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1706 - acc: 0.9490 - val_loss: 0.3273 - val_acc: 0.8836
Epoch 13/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1644 - acc: 0.9553 - val_loss: 0.3058 - val_acc: 0.8884
Epoch 14/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1536 - acc: 0.9539 - val_loss: 0.3260 - val_acc: 0.8789
Epoch 15/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1277 - acc: 0.9623 - val_loss: 0.2845 - val_acc: 0.9050
Epoch 16/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1412 - acc: 0.9544 - val_loss: 0.2979 - val_acc: 0.8955
Epoch 17/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1106 - acc: 0.9665 - val_loss: 0.2903 - val_acc: 0.8955
Manual evaluation: (didn't understand why I made this)
True 7800
False 1271
True percentage 0.859883144086
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.94      0.96      7318
      B-ORG       0.55      0.57      0.56       296
      B-LOC       0.67      0.68      0.67       218
      I-ORG       0.29      0.31      0.30       151
     B-MISC       0.19      0.02      0.04       141
     I-MISC       0.38      0.17      0.23       154
      B-PER       0.76      0.67      0.72       438
      I-PER       0.72      0.52      0.60       214
      I-LOC       0.60      0.74      0.66       141

avg / total       0.89      0.86      0.87      9071

F-1 Score:
0.557710064635
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100192 unique words.
Found 94 unique chars.
Found 9 unique labels.
188 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 299
OOV word occurences: 491
Padded until 66 tokens.
Padded until 24 chars.
Padded until 66 tokens.
Padded until 24 chars.
Padded until 66 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 66, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 66)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 66, 64)       6412352     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 66, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 66, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 66, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 66, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 66, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,915,458
Trainable params: 6,915,458
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 150 samples, validate on 17 samples
Epoch 1/70

150/150 [==============================] - 5s 34ms/step - loss: 1.2220 - acc: 0.6706 - val_loss: 0.6826 - val_acc: 0.8356
Epoch 2/70

150/150 [==============================] - 3s 18ms/step - loss: 0.6306 - acc: 0.8239 - val_loss: 0.5682 - val_acc: 0.8356
Epoch 3/70

150/150 [==============================] - 3s 18ms/step - loss: 0.5142 - acc: 0.8424 - val_loss: 0.4738 - val_acc: 0.8491
Epoch 4/70

150/150 [==============================] - 3s 18ms/step - loss: 0.4195 - acc: 0.8643 - val_loss: 0.4069 - val_acc: 0.8760
Epoch 5/70

150/150 [==============================] - 3s 18ms/step - loss: 0.3541 - acc: 0.8916 - val_loss: 0.3651 - val_acc: 0.8922
Epoch 6/70

150/150 [==============================] - 3s 17ms/step - loss: 0.3263 - acc: 0.8967 - val_loss: 0.3422 - val_acc: 0.8976
Epoch 7/70

150/150 [==============================] - 3s 17ms/step - loss: 0.2715 - acc: 0.9163 - val_loss: 0.3106 - val_acc: 0.9057
Epoch 8/70

150/150 [==============================] - 3s 17ms/step - loss: 0.2314 - acc: 0.9301 - val_loss: 0.2972 - val_acc: 0.9218
Epoch 9/70

150/150 [==============================] - 3s 17ms/step - loss: 0.2360 - acc: 0.9277 - val_loss: 0.3041 - val_acc: 0.9084
Epoch 10/70

150/150 [==============================] - 3s 17ms/step - loss: 0.1924 - acc: 0.9409 - val_loss: 0.2959 - val_acc: 0.9084
Epoch 11/70

150/150 [==============================] - 3s 17ms/step - loss: 0.1825 - acc: 0.9457 - val_loss: 0.2814 - val_acc: 0.9218
Epoch 12/70

150/150 [==============================] - 3s 18ms/step - loss: 0.1675 - acc: 0.9484 - val_loss: 0.2884 - val_acc: 0.9218
Epoch 13/70

150/150 [==============================] - 3s 17ms/step - loss: 0.1494 - acc: 0.9540 - val_loss: 0.2847 - val_acc: 0.9272
Manual evaluation: (didn't understand why I made this)
True 7786
False 1285
True percentage 0.858339764083
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.95      0.95      7318
      B-PER       0.80      0.67      0.73       438
      B-ORG       0.65      0.36      0.46       296
      I-ORG       0.32      0.24      0.27       151
      I-PER       0.79      0.54      0.64       214
      B-LOC       0.62      0.71      0.66       218
      I-LOC       0.63      0.72      0.67       141
     B-MISC       0.27      0.02      0.04       141
     I-MISC       0.17      0.02      0.03       154

avg / total       0.88      0.86      0.86      9071

F-1 Score:
0.545271629779
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100192 unique words.
Found 94 unique chars.
Found 9 unique labels.
188 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 296
OOV word occurences: 446
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6412352     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,915,458
Trainable params: 6,915,458
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 150 samples, validate on 17 samples
Epoch 1/70

150/150 [==============================] - 5s 32ms/step - loss: 1.4290 - acc: 0.6174 - val_loss: 0.8815 - val_acc: 0.7865
Epoch 2/70

150/150 [==============================] - 2s 16ms/step - loss: 0.7041 - acc: 0.8173 - val_loss: 0.6672 - val_acc: 0.7921
Epoch 3/70

150/150 [==============================] - 2s 16ms/step - loss: 0.5732 - acc: 0.8232 - val_loss: 0.5428 - val_acc: 0.8371
Epoch 4/70

150/150 [==============================] - 2s 16ms/step - loss: 0.4656 - acc: 0.8523 - val_loss: 0.5541 - val_acc: 0.8174
Epoch 5/70

150/150 [==============================] - 2s 16ms/step - loss: 0.4200 - acc: 0.8724 - val_loss: 0.4098 - val_acc: 0.8848
Epoch 6/70

150/150 [==============================] - 2s 15ms/step - loss: 0.3608 - acc: 0.8845 - val_loss: 0.3675 - val_acc: 0.8820
Epoch 7/70

150/150 [==============================] - 2s 15ms/step - loss: 0.3134 - acc: 0.9062 - val_loss: 0.3481 - val_acc: 0.9101
Epoch 8/70

150/150 [==============================] - 2s 16ms/step - loss: 0.2622 - acc: 0.9188 - val_loss: 0.3537 - val_acc: 0.8961
Epoch 9/70

150/150 [==============================] - 2s 16ms/step - loss: 0.2418 - acc: 0.9294 - val_loss: 0.2971 - val_acc: 0.9157
Epoch 10/70

150/150 [==============================] - 2s 15ms/step - loss: 0.2454 - acc: 0.9254 - val_loss: 0.3298 - val_acc: 0.8989
Epoch 11/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1962 - acc: 0.9431 - val_loss: 0.2981 - val_acc: 0.9129
Manual evaluation: (didn't understand why I made this)
True 7741
False 1330
True percentage 0.853378899791
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.95      0.95      7318
     B-MISC       0.25      0.01      0.01       141
     I-MISC       0.39      0.07      0.12       154
      B-ORG       0.55      0.49      0.52       296
      I-ORG       0.37      0.27      0.31       151
      B-PER       0.80      0.52      0.63       438
      I-PER       0.70      0.41      0.52       214
      B-LOC       0.61      0.63      0.62       218
      I-LOC       0.61      0.76      0.68       141

avg / total       0.87      0.85      0.86      9071

F-1 Score:
0.510939077752
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100194 unique words.
Found 94 unique chars.
Found 9 unique labels.
190 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 303
OOV word occurences: 485
Padded until 63 tokens.
Padded until 24 chars.
Padded until 63 tokens.
Padded until 24 chars.
Padded until 63 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 63, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 63)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 63, 64)       6412480     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 63, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 63, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 63, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 63, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 63, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,915,586
Trainable params: 6,915,586
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 150 samples, validate on 17 samples
Epoch 1/70

150/150 [==============================] - 5s 34ms/step - loss: 1.2271 - acc: 0.6411 - val_loss: 1.2762 - val_acc: 0.7582
Epoch 2/70

150/150 [==============================] - 3s 17ms/step - loss: 0.7960 - acc: 0.7989 - val_loss: 0.6725 - val_acc: 0.8030
Epoch 3/70

150/150 [==============================] - 3s 17ms/step - loss: 0.5698 - acc: 0.8151 - val_loss: 0.5379 - val_acc: 0.8239
Epoch 4/70

150/150 [==============================] - 3s 17ms/step - loss: 0.4885 - acc: 0.8385 - val_loss: 0.5492 - val_acc: 0.8507
Epoch 5/70

150/150 [==============================] - 3s 17ms/step - loss: 0.4150 - acc: 0.8746 - val_loss: 0.4351 - val_acc: 0.8806
Epoch 6/70

150/150 [==============================] - 2s 17ms/step - loss: 0.3318 - acc: 0.9038 - val_loss: 0.4374 - val_acc: 0.8418
Epoch 7/70

150/150 [==============================] - 2s 17ms/step - loss: 0.3613 - acc: 0.8776 - val_loss: 0.3822 - val_acc: 0.8896
Epoch 8/70

150/150 [==============================] - 2s 17ms/step - loss: 0.2793 - acc: 0.9234 - val_loss: 0.3843 - val_acc: 0.8806
Epoch 9/70

150/150 [==============================] - 2s 17ms/step - loss: 0.2397 - acc: 0.9302 - val_loss: 0.3471 - val_acc: 0.8925
Epoch 10/70

150/150 [==============================] - 3s 17ms/step - loss: 0.2263 - acc: 0.9310 - val_loss: 0.3502 - val_acc: 0.9015
Epoch 11/70

150/150 [==============================] - 2s 17ms/step - loss: 0.1950 - acc: 0.9423 - val_loss: 0.3297 - val_acc: 0.9015
Epoch 12/70

150/150 [==============================] - 2s 17ms/step - loss: 0.1836 - acc: 0.9513 - val_loss: 0.3433 - val_acc: 0.8925
Epoch 13/70

150/150 [==============================] - 2s 17ms/step - loss: 0.1556 - acc: 0.9571 - val_loss: 0.3151 - val_acc: 0.8985
Epoch 14/70

150/150 [==============================] - 2s 16ms/step - loss: 0.1601 - acc: 0.9524 - val_loss: 0.3209 - val_acc: 0.8955
Epoch 15/70

150/150 [==============================] - 2s 17ms/step - loss: 0.1347 - acc: 0.9621 - val_loss: 0.2969 - val_acc: 0.9045
Epoch 16/70

150/150 [==============================] - 2s 16ms/step - loss: 0.1349 - acc: 0.9616 - val_loss: 0.3256 - val_acc: 0.8985
Epoch 17/70

150/150 [==============================] - 2s 16ms/step - loss: 0.1348 - acc: 0.9561 - val_loss: 0.2890 - val_acc: 0.9075
Epoch 18/70

150/150 [==============================] - 2s 16ms/step - loss: 0.1037 - acc: 0.9747 - val_loss: 0.3098 - val_acc: 0.8985
Epoch 19/70

150/150 [==============================] - 2s 17ms/step - loss: 0.0972 - acc: 0.9760 - val_loss: 0.3017 - val_acc: 0.8985
Manual evaluation: (didn't understand why I made this)
True 7801
False 1270
True percentage 0.859993385514
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-ORG       0.52      0.42      0.46       296
      B-LOC       0.65      0.62      0.64       218
      B-PER       0.80      0.62      0.70       438
      I-PER       0.68      0.55      0.61       214
     B-MISC       0.21      0.11      0.15       141
      I-ORG       0.41      0.42      0.41       151
      I-LOC       0.69      0.67      0.68       141
     I-MISC       0.34      0.15      0.21       154

avg / total       0.89      0.86      0.88      9071

F-1 Score:
0.537825810553
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100177 unique words.
Found 94 unique chars.
Found 9 unique labels.
173 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 303
OOV word occurences: 487
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6411392     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,914,498
Trainable params: 6,914,498
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 150 samples, validate on 17 samples
Epoch 1/70

150/150 [==============================] - 5s 32ms/step - loss: 1.5801 - acc: 0.6045 - val_loss: 0.8852 - val_acc: 0.7441
Epoch 2/70

150/150 [==============================] - 2s 16ms/step - loss: 0.7199 - acc: 0.7897 - val_loss: 0.7310 - val_acc: 0.7546
Epoch 3/70

150/150 [==============================] - 2s 15ms/step - loss: 0.5942 - acc: 0.8188 - val_loss: 0.6260 - val_acc: 0.7784
Epoch 4/70

150/150 [==============================] - 2s 15ms/step - loss: 0.5327 - acc: 0.8410 - val_loss: 0.5676 - val_acc: 0.7968
Epoch 5/70

150/150 [==============================] - 2s 15ms/step - loss: 0.4438 - acc: 0.8578 - val_loss: 0.4926 - val_acc: 0.8575
Epoch 6/70

150/150 [==============================] - 2s 16ms/step - loss: 0.3862 - acc: 0.8784 - val_loss: 0.4497 - val_acc: 0.8575
Epoch 7/70

150/150 [==============================] - 2s 15ms/step - loss: 0.3870 - acc: 0.8839 - val_loss: 0.4330 - val_acc: 0.8628
Epoch 8/70

150/150 [==============================] - 2s 15ms/step - loss: 0.3264 - acc: 0.9070 - val_loss: 0.3913 - val_acc: 0.8734
Epoch 9/70

150/150 [==============================] - 2s 15ms/step - loss: 0.2878 - acc: 0.9163 - val_loss: 0.3731 - val_acc: 0.8734
Epoch 10/70

150/150 [==============================] - 2s 15ms/step - loss: 0.2662 - acc: 0.9200 - val_loss: 0.3648 - val_acc: 0.8813
Epoch 11/70

150/150 [==============================] - 2s 15ms/step - loss: 0.2406 - acc: 0.9280 - val_loss: 0.3506 - val_acc: 0.8760
Epoch 12/70

150/150 [==============================] - 2s 15ms/step - loss: 0.2200 - acc: 0.9336 - val_loss: 0.3529 - val_acc: 0.8813
Epoch 13/70

150/150 [==============================] - 2s 15ms/step - loss: 0.2003 - acc: 0.9412 - val_loss: 0.3319 - val_acc: 0.8839
Epoch 14/70

150/150 [==============================] - 2s 15ms/step - loss: 0.2011 - acc: 0.9443 - val_loss: 0.3177 - val_acc: 0.8865
Epoch 15/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1668 - acc: 0.9550 - val_loss: 0.3159 - val_acc: 0.8865
Epoch 16/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1615 - acc: 0.9530 - val_loss: 0.3331 - val_acc: 0.9050
Epoch 17/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1676 - acc: 0.9476 - val_loss: 0.3236 - val_acc: 0.8918
Manual evaluation: (didn't understand why I made this)
True 7811
False 1260
True percentage 0.861095799802
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-PER       0.79      0.64      0.71       438
      B-ORG       0.69      0.38      0.49       296
     I-MISC       0.27      0.22      0.24       154
      B-LOC       0.67      0.67      0.67       218
      I-LOC       0.47      0.81      0.60       141
      I-ORG       0.48      0.23      0.31       151
      I-PER       0.84      0.58      0.69       214
     B-MISC       0.28      0.14      0.19       141

avg / total       0.90      0.86      0.88      9071

F-1 Score:
0.550190597205
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100206 unique words.
Found 94 unique chars.
Found 9 unique labels.
202 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 300
OOV word occurences: 542
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6413248     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,916,354
Trainable params: 6,916,354
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 150 samples, validate on 17 samples
Epoch 1/70

150/150 [==============================] - 5s 32ms/step - loss: 1.6583 - acc: 0.6374 - val_loss: 0.7631 - val_acc: 0.8151
Epoch 2/70

150/150 [==============================] - 2s 16ms/step - loss: 0.7284 - acc: 0.7946 - val_loss: 0.6229 - val_acc: 0.8179
Epoch 3/70

150/150 [==============================] - 2s 16ms/step - loss: 0.6072 - acc: 0.8187 - val_loss: 0.4954 - val_acc: 0.8263
Epoch 4/70

150/150 [==============================] - 2s 16ms/step - loss: 0.5366 - acc: 0.8446 - val_loss: 0.4728 - val_acc: 0.8431
Epoch 5/70

150/150 [==============================] - 2s 15ms/step - loss: 0.4152 - acc: 0.8691 - val_loss: 0.3916 - val_acc: 0.8796
Epoch 6/70

150/150 [==============================] - 2s 15ms/step - loss: 0.3429 - acc: 0.8977 - val_loss: 0.3707 - val_acc: 0.8992
Epoch 7/70

150/150 [==============================] - 2s 15ms/step - loss: 0.3027 - acc: 0.9079 - val_loss: 0.3438 - val_acc: 0.9048
Epoch 8/70

150/150 [==============================] - 2s 15ms/step - loss: 0.2757 - acc: 0.9145 - val_loss: 0.3101 - val_acc: 0.9020
Epoch 9/70

150/150 [==============================] - 2s 15ms/step - loss: 0.2327 - acc: 0.9324 - val_loss: 0.3306 - val_acc: 0.9020
Epoch 10/70

150/150 [==============================] - 2s 15ms/step - loss: 0.2265 - acc: 0.9291 - val_loss: 0.3020 - val_acc: 0.9020
Epoch 11/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1972 - acc: 0.9437 - val_loss: 0.3467 - val_acc: 0.9048
Epoch 12/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1898 - acc: 0.9425 - val_loss: 0.3262 - val_acc: 0.9048
Manual evaluation: (didn't understand why I made this)
True 7674
False 1397
True percentage 0.845992724066
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.95      0.95      7318
      B-PER       0.72      0.46      0.56       438
      B-LOC       0.73      0.57      0.64       218
      B-ORG       0.54      0.45      0.49       296
      I-PER       0.70      0.41      0.51       214
     B-MISC       0.92      0.09      0.16       141
     I-MISC       0.41      0.12      0.18       154
      I-LOC       0.73      0.41      0.53       141
      I-ORG       0.37      0.38      0.37       151

avg / total       0.88      0.85      0.86      9071

F-1 Score:
0.481894150418
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100214 unique words.
Found 94 unique chars.
Found 9 unique labels.
210 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 300
OOV word occurences: 479
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 58, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 58)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 58, 64)       6413760     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 58, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 58, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 58, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 58, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 58, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,916,866
Trainable params: 6,916,866
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 150 samples, validate on 17 samples
Epoch 1/70

150/150 [==============================] - 5s 32ms/step - loss: 1.5654 - acc: 0.6454 - val_loss: 0.7018 - val_acc: 0.8210
Epoch 2/70

150/150 [==============================] - 2s 17ms/step - loss: 0.7214 - acc: 0.8069 - val_loss: 0.5991 - val_acc: 0.8210
Epoch 3/70

150/150 [==============================] - 2s 16ms/step - loss: 0.5652 - acc: 0.8276 - val_loss: 0.4325 - val_acc: 0.8765
Epoch 4/70

150/150 [==============================] - 2s 16ms/step - loss: 0.4723 - acc: 0.8580 - val_loss: 0.3866 - val_acc: 0.8786
Epoch 5/70

150/150 [==============================] - 2s 16ms/step - loss: 0.3772 - acc: 0.8863 - val_loss: 0.3278 - val_acc: 0.8909
Epoch 6/70

150/150 [==============================] - 2s 16ms/step - loss: 0.3397 - acc: 0.8934 - val_loss: 0.3004 - val_acc: 0.9095
Epoch 7/70

150/150 [==============================] - 2s 15ms/step - loss: 0.2936 - acc: 0.9134 - val_loss: 0.3211 - val_acc: 0.9177
Epoch 8/70

150/150 [==============================] - 2s 15ms/step - loss: 0.2780 - acc: 0.9197 - val_loss: 0.2836 - val_acc: 0.9012
Epoch 9/70

150/150 [==============================] - 2s 15ms/step - loss: 0.2375 - acc: 0.9318 - val_loss: 0.2518 - val_acc: 0.9321
Epoch 10/70

150/150 [==============================] - 2s 15ms/step - loss: 0.2109 - acc: 0.9398 - val_loss: 0.2435 - val_acc: 0.9300
Epoch 11/70

150/150 [==============================] - 2s 16ms/step - loss: 0.1897 - acc: 0.9487 - val_loss: 0.2311 - val_acc: 0.9259
Epoch 12/70

150/150 [==============================] - 2s 16ms/step - loss: 0.1693 - acc: 0.9470 - val_loss: 0.2254 - val_acc: 0.9342
Epoch 13/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1608 - acc: 0.9488 - val_loss: 0.2136 - val_acc: 0.9424
Epoch 14/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1402 - acc: 0.9590 - val_loss: 0.2110 - val_acc: 0.9342
Epoch 15/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1462 - acc: 0.9513 - val_loss: 0.2453 - val_acc: 0.9280
Epoch 16/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1467 - acc: 0.9551 - val_loss: 0.2054 - val_acc: 0.9362
Epoch 17/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1166 - acc: 0.9686 - val_loss: 0.2035 - val_acc: 0.9444
Epoch 18/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1061 - acc: 0.9700 - val_loss: 0.1964 - val_acc: 0.9527
Epoch 19/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1010 - acc: 0.9703 - val_loss: 0.2134 - val_acc: 0.9403
Epoch 20/70

150/150 [==============================] - 2s 15ms/step - loss: 0.0943 - acc: 0.9727 - val_loss: 0.2001 - val_acc: 0.9424
Manual evaluation: (didn't understand why I made this)
True 7772
False 1299
True percentage 0.856796384081
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.95      0.95      7318
      B-ORG       0.58      0.45      0.51       296
      I-ORG       0.43      0.26      0.33       151
      B-PER       0.83      0.61      0.70       438
      B-LOC       0.79      0.60      0.68       218
      I-LOC       0.86      0.61      0.71       141
      I-PER       0.80      0.44      0.57       214
     B-MISC       0.09      0.07      0.08       141
     I-MISC       0.39      0.19      0.26       154

avg / total       0.89      0.86      0.87      9071

F-1 Score:
0.532568342896
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100211 unique words.
Found 94 unique chars.
Found 9 unique labels.
207 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 299
OOV word occurences: 478
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6413568     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,916,674
Trainable params: 6,916,674
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 150 samples, validate on 17 samples
Epoch 1/70

150/150 [==============================] - 5s 32ms/step - loss: 1.6158 - acc: 0.6272 - val_loss: 0.4791 - val_acc: 0.8889
Epoch 2/70

150/150 [==============================] - 2s 16ms/step - loss: 0.7308 - acc: 0.7977 - val_loss: 0.4256 - val_acc: 0.8916
Epoch 3/70

150/150 [==============================] - 2s 16ms/step - loss: 0.6159 - acc: 0.8162 - val_loss: 0.3114 - val_acc: 0.9133
Epoch 4/70

150/150 [==============================] - 2s 16ms/step - loss: 0.4990 - acc: 0.8470 - val_loss: 0.4679 - val_acc: 0.9295
Epoch 5/70

150/150 [==============================] - 2s 16ms/step - loss: 0.4621 - acc: 0.8706 - val_loss: 0.2232 - val_acc: 0.9431
Epoch 6/70

150/150 [==============================] - 2s 15ms/step - loss: 0.3627 - acc: 0.8897 - val_loss: 0.2068 - val_acc: 0.9512
Epoch 7/70

150/150 [==============================] - 2s 15ms/step - loss: 0.3153 - acc: 0.9035 - val_loss: 0.2038 - val_acc: 0.9539
Epoch 8/70

150/150 [==============================] - 2s 15ms/step - loss: 0.2856 - acc: 0.9093 - val_loss: 0.1911 - val_acc: 0.9593
Epoch 9/70

150/150 [==============================] - 2s 15ms/step - loss: 0.2403 - acc: 0.9282 - val_loss: 0.1799 - val_acc: 0.9566
Epoch 10/70

150/150 [==============================] - 2s 15ms/step - loss: 0.2253 - acc: 0.9357 - val_loss: 0.1537 - val_acc: 0.9675
Epoch 11/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1988 - acc: 0.9386 - val_loss: 0.1525 - val_acc: 0.9593
Epoch 12/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1895 - acc: 0.9399 - val_loss: 0.2003 - val_acc: 0.9404
Epoch 13/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1825 - acc: 0.9402 - val_loss: 0.1426 - val_acc: 0.9539
Epoch 14/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1564 - acc: 0.9553 - val_loss: 0.1507 - val_acc: 0.9539
Epoch 15/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1413 - acc: 0.9582 - val_loss: 0.1360 - val_acc: 0.9539
Epoch 16/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1287 - acc: 0.9584 - val_loss: 0.1468 - val_acc: 0.9485
Epoch 17/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1168 - acc: 0.9691 - val_loss: 0.1559 - val_acc: 0.9485
Manual evaluation: (didn't understand why I made this)
True 7873
False 1198
True percentage 0.867930768383
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.96      0.96      7318
      B-ORG       0.66      0.41      0.51       296
      I-ORG       0.52      0.30      0.38       151
     B-MISC       0.30      0.11      0.16       141
     I-MISC       0.49      0.19      0.27       154
      B-PER       0.79      0.69      0.74       438
      B-LOC       0.66      0.70      0.68       218
      I-LOC       0.70      0.67      0.69       141
      I-PER       0.76      0.54      0.63       214

avg / total       0.90      0.87      0.88      9071

F-1 Score:
0.578011849901
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100218 unique words.
Found 94 unique chars.
Found 9 unique labels.
214 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 297
OOV word occurences: 581
Padded until 66 tokens.
Padded until 24 chars.
Padded until 66 tokens.
Padded until 24 chars.
Padded until 66 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 66, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 66)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 66, 64)       6414016     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 66, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 66, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 66, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 66, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 66, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,917,122
Trainable params: 6,917,122
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 150 samples, validate on 17 samples
Epoch 1/70

150/150 [==============================] - 5s 34ms/step - loss: 1.6945 - acc: 0.6414 - val_loss: 0.6936 - val_acc: 0.8297
Epoch 2/70

150/150 [==============================] - 3s 18ms/step - loss: 0.7462 - acc: 0.7997 - val_loss: 0.6305 - val_acc: 0.8297
Epoch 3/70

150/150 [==============================] - 3s 18ms/step - loss: 0.6273 - acc: 0.8135 - val_loss: 0.4737 - val_acc: 0.8544
Epoch 4/70

150/150 [==============================] - 3s 18ms/step - loss: 0.4763 - acc: 0.8563 - val_loss: 0.4508 - val_acc: 0.8571
Epoch 5/70

150/150 [==============================] - 3s 18ms/step - loss: 0.4262 - acc: 0.8814 - val_loss: 0.3457 - val_acc: 0.8901
Epoch 6/70

150/150 [==============================] - 3s 18ms/step - loss: 0.3405 - acc: 0.9056 - val_loss: 0.3478 - val_acc: 0.8956
Epoch 7/70

150/150 [==============================] - 3s 17ms/step - loss: 0.3018 - acc: 0.9096 - val_loss: 0.2979 - val_acc: 0.8874
Epoch 8/70

150/150 [==============================] - 3s 17ms/step - loss: 0.2610 - acc: 0.9278 - val_loss: 0.3065 - val_acc: 0.9038
Epoch 9/70

150/150 [==============================] - 3s 17ms/step - loss: 0.2258 - acc: 0.9331 - val_loss: 0.3037 - val_acc: 0.8984
Manual evaluation: (didn't understand why I made this)
True 7493
False 1578
True percentage 0.826039025466
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.89      0.33      0.48       438
          O       0.94      0.95      0.95      7318
      B-ORG       0.40      0.50      0.45       296
     B-MISC       0.12      0.01      0.01       141
      B-LOC       0.85      0.32      0.47       218
      I-LOC       1.00      0.01      0.03       141
     I-MISC       0.00      0.00      0.00       154
      I-PER       0.84      0.33      0.47       214
      I-ORG       0.22      0.56      0.32       151

avg / total       0.88      0.83      0.83      9071

F-1 Score:
0.866643084542
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100205 unique words.
Found 94 unique chars.
Found 9 unique labels.
201 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 303
OOV word occurences: 588
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 58, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 58)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 58, 64)       6413184     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 58, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 58, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 58, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 58, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 58, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,916,290
Trainable params: 6,916,290
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 150 samples, validate on 17 samples
Epoch 1/70

150/150 [==============================] - 5s 33ms/step - loss: 1.1880 - acc: 0.7993 - val_loss: 1.0731 - val_acc: 0.7143
Epoch 2/70

150/150 [==============================] - 2s 17ms/step - loss: 0.6656 - acc: 0.8114 - val_loss: 0.9076 - val_acc: 0.7143
Epoch 3/70

150/150 [==============================] - 2s 16ms/step - loss: 0.5365 - acc: 0.8313 - val_loss: 0.7640 - val_acc: 0.7682
Epoch 4/70

150/150 [==============================] - 2s 16ms/step - loss: 0.4413 - acc: 0.8666 - val_loss: 0.7377 - val_acc: 0.7752
Epoch 5/70

150/150 [==============================] - 2s 16ms/step - loss: 0.3859 - acc: 0.8794 - val_loss: 0.7392 - val_acc: 0.7658
Epoch 6/70

150/150 [==============================] - 2s 16ms/step - loss: 0.3289 - acc: 0.9020 - val_loss: 0.5909 - val_acc: 0.8080
Epoch 7/70

150/150 [==============================] - 2s 16ms/step - loss: 0.2701 - acc: 0.9206 - val_loss: 0.6293 - val_acc: 0.8173
Epoch 8/70

150/150 [==============================] - 2s 16ms/step - loss: 0.2507 - acc: 0.9218 - val_loss: 0.5443 - val_acc: 0.8454
Epoch 9/70

150/150 [==============================] - 2s 15ms/step - loss: 0.2091 - acc: 0.9430 - val_loss: 0.5509 - val_acc: 0.8337
Epoch 10/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1887 - acc: 0.9442 - val_loss: 0.5643 - val_acc: 0.8314
Manual evaluation: (didn't understand why I made this)
True 7641
False 1430
True percentage 0.842354756918
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.72      0.59      0.64       438
          O       0.95      0.95      0.95      7318
      B-LOC       0.76      0.51      0.61       218
      I-LOC       0.72      0.44      0.55       141
      I-PER       0.69      0.39      0.50       214
      B-ORG       0.44      0.36      0.40       296
      I-ORG       0.28      0.24      0.26       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.35      0.11      0.17       154

avg / total       0.87      0.84      0.85      9071

F-1 Score:
0.881303335919
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100212 unique words.
Found 94 unique chars.
Found 9 unique labels.
208 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 298
OOV word occurences: 502
Padded until 66 tokens.
Padded until 24 chars.
Padded until 66 tokens.
Padded until 24 chars.
Padded until 66 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 66, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 66)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 66, 64)       6413632     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 66, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 66, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 66, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 66, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 66, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,916,738
Trainable params: 6,916,738
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 150 samples, validate on 17 samples
Epoch 1/70

150/150 [==============================] - 5s 35ms/step - loss: 1.5715 - acc: 0.6424 - val_loss: 0.7045 - val_acc: 0.8417
Epoch 2/70

150/150 [==============================] - 3s 18ms/step - loss: 0.7287 - acc: 0.8079 - val_loss: 0.5889 - val_acc: 0.8417
Epoch 3/70

150/150 [==============================] - 3s 18ms/step - loss: 0.5965 - acc: 0.8161 - val_loss: 0.5014 - val_acc: 0.8470
Epoch 4/70

150/150 [==============================] - 3s 18ms/step - loss: 0.5541 - acc: 0.8359 - val_loss: 0.4343 - val_acc: 0.8707
Epoch 5/70

150/150 [==============================] - 3s 18ms/step - loss: 0.4379 - acc: 0.8605 - val_loss: 0.3772 - val_acc: 0.8786
Epoch 6/70

150/150 [==============================] - 3s 17ms/step - loss: 0.3733 - acc: 0.8842 - val_loss: 0.3632 - val_acc: 0.9024
Epoch 7/70

150/150 [==============================] - 3s 17ms/step - loss: 0.3301 - acc: 0.9023 - val_loss: 0.3107 - val_acc: 0.9103
Epoch 8/70

150/150 [==============================] - 3s 17ms/step - loss: 0.2874 - acc: 0.9162 - val_loss: 0.3002 - val_acc: 0.8945
Epoch 9/70

150/150 [==============================] - 3s 17ms/step - loss: 0.2463 - acc: 0.9267 - val_loss: 0.3428 - val_acc: 0.8839
Epoch 10/70

150/150 [==============================] - 3s 17ms/step - loss: 0.2469 - acc: 0.9233 - val_loss: 0.2881 - val_acc: 0.9050
Epoch 11/70

150/150 [==============================] - 3s 17ms/step - loss: 0.2051 - acc: 0.9365 - val_loss: 0.2967 - val_acc: 0.9129
Epoch 12/70

150/150 [==============================] - 3s 17ms/step - loss: 0.1872 - acc: 0.9431 - val_loss: 0.2884 - val_acc: 0.9024
Manual evaluation: (didn't understand why I made this)
True 7677
False 1394
True percentage 0.846323448352
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.94      0.95      7318
      B-ORG       0.40      0.47      0.43       296
     B-MISC       0.05      0.01      0.01       141
     I-MISC       0.27      0.19      0.22       154
      B-PER       0.70      0.66      0.68       438
      B-LOC       0.77      0.53      0.63       218
      I-ORG       0.35      0.31      0.33       151
      I-PER       0.65      0.35      0.45       214
      I-LOC       0.79      0.60      0.68       141

avg / total       0.88      0.85      0.86      9071

F-1 Score:
0.495715645827
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100205 unique words.
Found 94 unique chars.
Found 9 unique labels.
201 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 297
OOV word occurences: 457
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6413184     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,916,290
Trainable params: 6,916,290
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 150 samples, validate on 17 samples
Epoch 1/70

150/150 [==============================] - 5s 32ms/step - loss: 1.6351 - acc: 0.6404 - val_loss: 0.9544 - val_acc: 0.7521
Epoch 2/70

150/150 [==============================] - 2s 16ms/step - loss: 0.7309 - acc: 0.8084 - val_loss: 0.8283 - val_acc: 0.7521
Epoch 3/70

150/150 [==============================] - 2s 16ms/step - loss: 0.5909 - acc: 0.8176 - val_loss: 0.6941 - val_acc: 0.7752
Epoch 4/70

150/150 [==============================] - 2s 15ms/step - loss: 0.4718 - acc: 0.8531 - val_loss: 0.6176 - val_acc: 0.8151
Epoch 5/70

150/150 [==============================] - 2s 16ms/step - loss: 0.4703 - acc: 0.8730 - val_loss: 0.5724 - val_acc: 0.8088
Epoch 6/70

150/150 [==============================] - 2s 15ms/step - loss: 0.3554 - acc: 0.8986 - val_loss: 0.5409 - val_acc: 0.8214
Epoch 7/70

150/150 [==============================] - 2s 15ms/step - loss: 0.3033 - acc: 0.9094 - val_loss: 0.4889 - val_acc: 0.8466
Epoch 8/70

150/150 [==============================] - 2s 15ms/step - loss: 0.2617 - acc: 0.9261 - val_loss: 0.4893 - val_acc: 0.8424
Epoch 9/70

150/150 [==============================] - 2s 15ms/step - loss: 0.2412 - acc: 0.9240 - val_loss: 0.4742 - val_acc: 0.8424
Epoch 10/70

150/150 [==============================] - 2s 15ms/step - loss: 0.2139 - acc: 0.9373 - val_loss: 0.5281 - val_acc: 0.8256
Epoch 11/70

150/150 [==============================] - 2s 15ms/step - loss: 0.2198 - acc: 0.9364 - val_loss: 0.4771 - val_acc: 0.8361
Manual evaluation: (didn't understand why I made this)
True 7638
False 1433
True percentage 0.842024032631
Sklearn evaluation:
             precision    recall  f1-score   support

     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.14      0.01      0.01       154
          O       0.91      0.96      0.94      7318
      B-PER       0.78      0.54      0.64       438
      I-PER       0.73      0.35      0.47       214
      B-ORG       0.56      0.42      0.48       296
      B-LOC       0.81      0.44      0.57       218
      I-ORG       0.31      0.19      0.24       151
      I-LOC       0.76      0.31      0.44       141

avg / total       0.85      0.84      0.84      9071

F-1 Score:
0.8707250342
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100215 unique words.
Found 94 unique chars.
Found 9 unique labels.
211 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 295
OOV word occurences: 462
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 67, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 67)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 67, 64)       6413824     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 67, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 67, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 67, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 67, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 67, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,916,930
Trainable params: 6,916,930
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 150 samples, validate on 17 samples
Epoch 1/70

150/150 [==============================] - 5s 35ms/step - loss: 1.2758 - acc: 0.6550 - val_loss: 0.5899 - val_acc: 0.8251
Epoch 2/70

150/150 [==============================] - 3s 18ms/step - loss: 0.6775 - acc: 0.8070 - val_loss: 0.4367 - val_acc: 0.8747
Epoch 3/70

150/150 [==============================] - 3s 18ms/step - loss: 0.5514 - acc: 0.8308 - val_loss: 0.3703 - val_acc: 0.8818
Epoch 4/70

150/150 [==============================] - 3s 18ms/step - loss: 0.4693 - acc: 0.8551 - val_loss: 0.3793 - val_acc: 0.9149
Epoch 5/70

150/150 [==============================] - 3s 18ms/step - loss: 0.3923 - acc: 0.8797 - val_loss: 0.2999 - val_acc: 0.9125
Epoch 6/70

150/150 [==============================] - 3s 18ms/step - loss: 0.3517 - acc: 0.8906 - val_loss: 0.3026 - val_acc: 0.9078
Epoch 7/70

150/150 [==============================] - 3s 18ms/step - loss: 0.3259 - acc: 0.9044 - val_loss: 0.2380 - val_acc: 0.9244
Epoch 8/70

150/150 [==============================] - 3s 18ms/step - loss: 0.2698 - acc: 0.9153 - val_loss: 0.2290 - val_acc: 0.9314
Epoch 9/70

150/150 [==============================] - 3s 18ms/step - loss: 0.2509 - acc: 0.9207 - val_loss: 0.2598 - val_acc: 0.9314
Epoch 10/70

150/150 [==============================] - 3s 18ms/step - loss: 0.2164 - acc: 0.9336 - val_loss: 0.1808 - val_acc: 0.9409
Epoch 11/70

150/150 [==============================] - 3s 18ms/step - loss: 0.2098 - acc: 0.9314 - val_loss: 0.2153 - val_acc: 0.9338
Epoch 12/70

150/150 [==============================] - 3s 18ms/step - loss: 0.1834 - acc: 0.9457 - val_loss: 0.1793 - val_acc: 0.9433
Epoch 13/70

150/150 [==============================] - 3s 18ms/step - loss: 0.1673 - acc: 0.9518 - val_loss: 0.1791 - val_acc: 0.9433
Epoch 14/70

150/150 [==============================] - 3s 18ms/step - loss: 0.1575 - acc: 0.9537 - val_loss: 0.1834 - val_acc: 0.9385
Epoch 15/70

150/150 [==============================] - 3s 18ms/step - loss: 0.1340 - acc: 0.9605 - val_loss: 0.1901 - val_acc: 0.9314
Manual evaluation: (didn't understand why I made this)
True 7762
False 1309
True percentage 0.855693969794
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.94      0.96      7318
      B-PER       0.82      0.66      0.73       438
      B-ORG       0.46      0.62      0.53       296
     B-MISC       0.23      0.23      0.23       141
     I-MISC       0.32      0.34      0.33       154
      I-ORG       0.34      0.39      0.36       151
      B-LOC       0.85      0.47      0.60       218
      I-LOC       0.89      0.47      0.61       141
      I-PER       0.76      0.55      0.64       214

avg / total       0.91      0.86      0.88      9071

F-1 Score:
0.539892021596
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100211 unique words.
Found 94 unique chars.
Found 9 unique labels.
207 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 301
OOV word occurences: 498
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6413568     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,916,674
Trainable params: 6,916,674
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 150 samples, validate on 17 samples
Epoch 1/70

150/150 [==============================] - 5s 32ms/step - loss: 1.5399 - acc: 0.6337 - val_loss: 0.8495 - val_acc: 0.8237
Epoch 2/70

150/150 [==============================] - 2s 16ms/step - loss: 0.7463 - acc: 0.8115 - val_loss: 0.5961 - val_acc: 0.8347
Epoch 3/70

150/150 [==============================] - 2s 16ms/step - loss: 0.5417 - acc: 0.8288 - val_loss: 0.5273 - val_acc: 0.8430
Epoch 4/70

150/150 [==============================] - 2s 16ms/step - loss: 0.4722 - acc: 0.8584 - val_loss: 0.4966 - val_acc: 0.8567
Epoch 5/70

150/150 [==============================] - 2s 15ms/step - loss: 0.3797 - acc: 0.8896 - val_loss: 0.4318 - val_acc: 0.8733
Epoch 6/70

150/150 [==============================] - 2s 16ms/step - loss: 0.3219 - acc: 0.9080 - val_loss: 0.4228 - val_acc: 0.8595
Epoch 7/70

150/150 [==============================] - 2s 15ms/step - loss: 0.2749 - acc: 0.9228 - val_loss: 0.4044 - val_acc: 0.8733
Epoch 8/70

150/150 [==============================] - 2s 15ms/step - loss: 0.2374 - acc: 0.9300 - val_loss: 0.3630 - val_acc: 0.8953
Epoch 9/70

150/150 [==============================] - 2s 15ms/step - loss: 0.2414 - acc: 0.9296 - val_loss: 0.3605 - val_acc: 0.8926
Epoch 10/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1905 - acc: 0.9468 - val_loss: 0.3310 - val_acc: 0.9036
Epoch 11/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1766 - acc: 0.9499 - val_loss: 0.3305 - val_acc: 0.9036
Epoch 12/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1514 - acc: 0.9570 - val_loss: 0.3232 - val_acc: 0.9118
Epoch 13/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1406 - acc: 0.9591 - val_loss: 0.3209 - val_acc: 0.9008
Epoch 14/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1377 - acc: 0.9615 - val_loss: 0.3258 - val_acc: 0.8981
Epoch 15/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1171 - acc: 0.9673 - val_loss: 0.3063 - val_acc: 0.9063
Epoch 16/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1166 - acc: 0.9661 - val_loss: 0.3164 - val_acc: 0.9036
Epoch 17/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1036 - acc: 0.9698 - val_loss: 0.3058 - val_acc: 0.8981
Epoch 18/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1042 - acc: 0.9679 - val_loss: 0.3086 - val_acc: 0.9063
Epoch 19/70

150/150 [==============================] - 2s 15ms/step - loss: 0.1010 - acc: 0.9690 - val_loss: 0.3066 - val_acc: 0.9036
Manual evaluation: (didn't understand why I made this)
True 7803
False 1268
True percentage 0.860213868372
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.96      0.95      7318
      B-ORG       0.62      0.47      0.54       296
      I-ORG       0.32      0.21      0.26       151
      B-PER       0.83      0.63      0.72       438
     B-MISC       0.36      0.07      0.12       141
     I-MISC       0.32      0.16      0.21       154
      B-LOC       0.77      0.57      0.65       218
      I-LOC       0.80      0.52      0.64       141
      I-PER       0.65      0.57      0.60       214

avg / total       0.89      0.86      0.87      9071

F-1 Score:
0.543301759134
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100103 unique words.
Found 94 unique chars.
Found 9 unique labels.
99 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 309
OOV word occurences: 517
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6406656     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,909,762
Trainable params: 6,909,762
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 74 samples, validate on 9 samples
Epoch 1/70

74/74 [==============================] - 4s 50ms/step - loss: 1.8508 - acc: 0.4823 - val_loss: 1.7124 - val_acc: 0.6218
Epoch 2/70

74/74 [==============================] - 1s 18ms/step - loss: 0.9305 - acc: 0.7983 - val_loss: 1.3742 - val_acc: 0.6218
Epoch 3/70

74/74 [==============================] - 1s 17ms/step - loss: 0.6993 - acc: 0.8002 - val_loss: 1.2401 - val_acc: 0.6176
Epoch 4/70

74/74 [==============================] - 1s 17ms/step - loss: 0.6160 - acc: 0.8019 - val_loss: 1.2309 - val_acc: 0.6471
Epoch 5/70

74/74 [==============================] - 1s 17ms/step - loss: 0.5335 - acc: 0.8231 - val_loss: 1.1394 - val_acc: 0.6681
Epoch 6/70

74/74 [==============================] - 1s 17ms/step - loss: 0.4583 - acc: 0.8533 - val_loss: 1.1203 - val_acc: 0.6765
Epoch 7/70

74/74 [==============================] - 1s 17ms/step - loss: 0.4351 - acc: 0.8625 - val_loss: 0.9789 - val_acc: 0.7017
Epoch 8/70

74/74 [==============================] - 1s 17ms/step - loss: 0.3511 - acc: 0.8860 - val_loss: 0.8702 - val_acc: 0.7269
Epoch 9/70

74/74 [==============================] - 1s 17ms/step - loss: 0.3220 - acc: 0.9004 - val_loss: 0.9380 - val_acc: 0.7185
Epoch 10/70

74/74 [==============================] - 1s 17ms/step - loss: 0.2879 - acc: 0.9059 - val_loss: 0.9072 - val_acc: 0.7395
Manual evaluation: (didn't understand why I made this)
True 7415
False 1656
True percentage 0.817440194025
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.91      0.96      0.93      7318
      B-PER       0.68      0.41      0.51       438
      B-LOC       0.84      0.32      0.46       218
      B-ORG       0.49      0.35      0.41       296
      I-ORG       0.24      0.45      0.32       151
      I-PER       0.00      0.00      0.00       214
      I-LOC       0.88      0.05      0.09       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.12      0.01      0.01       154

avg / total       0.82      0.82      0.81      9071

F-1 Score:
0.327566320646
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100138 unique words.
Found 94 unique chars.
Found 9 unique labels.
134 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 309
OOV word occurences: 566
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6408896     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,912,002
Trainable params: 6,912,002
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 74 samples, validate on 9 samples
Epoch 1/70

74/74 [==============================] - 4s 56ms/step - loss: 1.7310 - acc: 0.4721 - val_loss: 1.3958 - val_acc: 0.7800
Epoch 2/70

74/74 [==============================] - 1s 17ms/step - loss: 0.9825 - acc: 0.8077 - val_loss: 0.9475 - val_acc: 0.7800
Epoch 3/70

74/74 [==============================] - 1s 17ms/step - loss: 0.6762 - acc: 0.8126 - val_loss: 0.9020 - val_acc: 0.7800
Epoch 4/70

74/74 [==============================] - 1s 18ms/step - loss: 0.6134 - acc: 0.8137 - val_loss: 0.8780 - val_acc: 0.7900
Epoch 5/70

74/74 [==============================] - 1s 17ms/step - loss: 0.5488 - acc: 0.8240 - val_loss: 0.7955 - val_acc: 0.7950
Epoch 6/70

74/74 [==============================] - 1s 16ms/step - loss: 0.4882 - acc: 0.8505 - val_loss: 0.7514 - val_acc: 0.8050
Epoch 7/70

74/74 [==============================] - 1s 17ms/step - loss: 0.4292 - acc: 0.8652 - val_loss: 0.7591 - val_acc: 0.8050
Epoch 8/70

74/74 [==============================] - 1s 17ms/step - loss: 0.4333 - acc: 0.8793 - val_loss: 0.6765 - val_acc: 0.8050
Epoch 9/70

74/74 [==============================] - 1s 17ms/step - loss: 0.3546 - acc: 0.8906 - val_loss: 0.6016 - val_acc: 0.8150
Epoch 10/70

74/74 [==============================] - 1s 16ms/step - loss: 0.3241 - acc: 0.8962 - val_loss: 0.6072 - val_acc: 0.8150
Epoch 11/70

74/74 [==============================] - 1s 16ms/step - loss: 0.2976 - acc: 0.9051 - val_loss: 0.5986 - val_acc: 0.8250
Epoch 12/70

74/74 [==============================] - 1s 17ms/step - loss: 0.3161 - acc: 0.9011 - val_loss: 0.4030 - val_acc: 0.8850
Epoch 13/70

74/74 [==============================] - 1s 16ms/step - loss: 0.2645 - acc: 0.9338 - val_loss: 0.4724 - val_acc: 0.8500
Epoch 14/70

74/74 [==============================] - 1s 17ms/step - loss: 0.2309 - acc: 0.9337 - val_loss: 0.3995 - val_acc: 0.8750
Epoch 15/70

74/74 [==============================] - 1s 16ms/step - loss: 0.2111 - acc: 0.9400 - val_loss: 0.4842 - val_acc: 0.8450
Epoch 16/70

74/74 [==============================] - 1s 17ms/step - loss: 0.2037 - acc: 0.9407 - val_loss: 0.3887 - val_acc: 0.8850
Epoch 17/70

74/74 [==============================] - 1s 17ms/step - loss: 0.1790 - acc: 0.9545 - val_loss: 0.3619 - val_acc: 0.8950
Epoch 18/70

74/74 [==============================] - 1s 17ms/step - loss: 0.1686 - acc: 0.9583 - val_loss: 0.4323 - val_acc: 0.8750
Epoch 19/70

74/74 [==============================] - 1s 17ms/step - loss: 0.1472 - acc: 0.9527 - val_loss: 0.4037 - val_acc: 0.8900
Manual evaluation: (didn't understand why I made this)
True 7567
False 1504
True percentage 0.834196891192
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.95      0.94      7318
      B-ORG       0.64      0.45      0.53       296
      B-LOC       0.79      0.47      0.59       218
      I-ORG       0.29      0.22      0.25       151
     B-MISC       0.15      0.02      0.04       141
     I-MISC       0.35      0.05      0.09       154
      B-PER       0.59      0.53      0.56       438
      I-PER       0.51      0.32      0.40       214
      I-LOC       0.79      0.40      0.54       141

avg / total       0.86      0.83      0.84      9071

F-1 Score:
0.447645818693
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100091 unique words.
Found 94 unique chars.
Found 9 unique labels.
87 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 318
OOV word occurences: 550
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6405888     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,908,994
Trainable params: 6,908,994
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 74 samples, validate on 9 samples
Epoch 1/70

74/74 [==============================] - 4s 50ms/step - loss: 1.7725 - acc: 0.4783 - val_loss: 1.1114 - val_acc: 0.7872
Epoch 2/70

74/74 [==============================] - 1s 18ms/step - loss: 0.8762 - acc: 0.8287 - val_loss: 0.7455 - val_acc: 0.7872
Epoch 3/70

74/74 [==============================] - 1s 18ms/step - loss: 0.6383 - acc: 0.8291 - val_loss: 0.6960 - val_acc: 0.7872
Epoch 4/70

74/74 [==============================] - 1s 17ms/step - loss: 0.5827 - acc: 0.8320 - val_loss: 0.6532 - val_acc: 0.7979
Epoch 5/70

74/74 [==============================] - 1s 17ms/step - loss: 0.5275 - acc: 0.8407 - val_loss: 0.5863 - val_acc: 0.8032
Epoch 6/70

74/74 [==============================] - 1s 17ms/step - loss: 0.4688 - acc: 0.8550 - val_loss: 0.5288 - val_acc: 0.8298
Epoch 7/70

74/74 [==============================] - 1s 17ms/step - loss: 0.4177 - acc: 0.8699 - val_loss: 0.4577 - val_acc: 0.8457
Epoch 8/70

74/74 [==============================] - 1s 17ms/step - loss: 0.3679 - acc: 0.8845 - val_loss: 0.5761 - val_acc: 0.8085
Epoch 9/70

74/74 [==============================] - 1s 17ms/step - loss: 0.4297 - acc: 0.8807 - val_loss: 0.3880 - val_acc: 0.8670
Epoch 10/70

74/74 [==============================] - 1s 17ms/step - loss: 0.3112 - acc: 0.9043 - val_loss: 0.3758 - val_acc: 0.8723
Epoch 11/70

74/74 [==============================] - 1s 17ms/step - loss: 0.2796 - acc: 0.9204 - val_loss: 0.3553 - val_acc: 0.8777
Epoch 12/70

74/74 [==============================] - 1s 16ms/step - loss: 0.2567 - acc: 0.9262 - val_loss: 0.4488 - val_acc: 0.8723
Epoch 13/70

74/74 [==============================] - 1s 17ms/step - loss: 0.2646 - acc: 0.9178 - val_loss: 0.3150 - val_acc: 0.8989
Epoch 14/70

74/74 [==============================] - 1s 16ms/step - loss: 0.2019 - acc: 0.9453 - val_loss: 0.3068 - val_acc: 0.8883
Epoch 15/70

74/74 [==============================] - 1s 17ms/step - loss: 0.1825 - acc: 0.9466 - val_loss: 0.3157 - val_acc: 0.9043
Epoch 16/70

74/74 [==============================] - 1s 16ms/step - loss: 0.1763 - acc: 0.9518 - val_loss: 0.2989 - val_acc: 0.9043
Epoch 17/70

74/74 [==============================] - 1s 16ms/step - loss: 0.1592 - acc: 0.9596 - val_loss: 0.2780 - val_acc: 0.9255
Epoch 18/70

74/74 [==============================] - 1s 17ms/step - loss: 0.1519 - acc: 0.9564 - val_loss: 0.2901 - val_acc: 0.8989
Epoch 19/70

74/74 [==============================] - 1s 16ms/step - loss: 0.1415 - acc: 0.9593 - val_loss: 0.2611 - val_acc: 0.9149
Epoch 20/70

74/74 [==============================] - 1s 16ms/step - loss: 0.1227 - acc: 0.9725 - val_loss: 0.2785 - val_acc: 0.9096
Epoch 21/70

74/74 [==============================] - 1s 16ms/step - loss: 0.1259 - acc: 0.9652 - val_loss: 0.2647 - val_acc: 0.9096
Manual evaluation: (didn't understand why I made this)
True 7543
False 1528
True percentage 0.831551096902
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.92      0.95      0.93      7318
      B-PER       0.77      0.55      0.64       438
      B-ORG       0.47      0.38      0.42       296
      I-ORG       0.38      0.17      0.23       151
      I-PER       0.67      0.39      0.49       214
      B-LOC       0.83      0.44      0.57       218
      I-LOC       0.90      0.32      0.47       141
     B-MISC       0.14      0.05      0.07       141
     I-MISC       0.12      0.03      0.04       154

avg / total       0.86      0.83      0.84      9071

F-1 Score:
0.446637426901
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100110 unique words.
Found 94 unique chars.
Found 9 unique labels.
106 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 308
OOV word occurences: 492
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6407104     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,910,210
Trainable params: 6,910,210
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 74 samples, validate on 9 samples
Epoch 1/70

74/74 [==============================] - 4s 50ms/step - loss: 1.3698 - acc: 0.7974 - val_loss: 0.9227 - val_acc: 0.7909
Epoch 2/70

74/74 [==============================] - 1s 17ms/step - loss: 0.8122 - acc: 0.8086 - val_loss: 0.7249 - val_acc: 0.7909
Epoch 3/70

74/74 [==============================] - 1s 17ms/step - loss: 0.6517 - acc: 0.8109 - val_loss: 0.6524 - val_acc: 0.8023
Epoch 4/70

74/74 [==============================] - 1s 17ms/step - loss: 0.5501 - acc: 0.8213 - val_loss: 0.6144 - val_acc: 0.8061
Epoch 5/70

74/74 [==============================] - 1s 18ms/step - loss: 0.4847 - acc: 0.8609 - val_loss: 0.6134 - val_acc: 0.8517
Epoch 6/70

74/74 [==============================] - 1s 17ms/step - loss: 0.4476 - acc: 0.8857 - val_loss: 0.4753 - val_acc: 0.8783
Epoch 7/70

74/74 [==============================] - 1s 17ms/step - loss: 0.3625 - acc: 0.9041 - val_loss: 0.4364 - val_acc: 0.8669
Epoch 8/70

74/74 [==============================] - 1s 17ms/step - loss: 0.3119 - acc: 0.9101 - val_loss: 0.4543 - val_acc: 0.8555
Epoch 9/70

74/74 [==============================] - 1s 16ms/step - loss: 0.2928 - acc: 0.9217 - val_loss: 0.3907 - val_acc: 0.8821
Epoch 10/70

74/74 [==============================] - 1s 17ms/step - loss: 0.2432 - acc: 0.9336 - val_loss: 0.3532 - val_acc: 0.8783
Epoch 11/70

74/74 [==============================] - 1s 17ms/step - loss: 0.2356 - acc: 0.9321 - val_loss: 0.3822 - val_acc: 0.8707
Epoch 12/70

74/74 [==============================] - 1s 17ms/step - loss: 0.2112 - acc: 0.9383 - val_loss: 0.3794 - val_acc: 0.8593
Manual evaluation: (didn't understand why I made this)
True 7649
False 1422
True percentage 0.843236688347
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.96      0.94      7318
     B-MISC       0.10      0.01      0.01       141
     I-MISC       0.33      0.05      0.09       154
      B-ORG       0.49      0.47      0.48       296
      I-ORG       0.29      0.14      0.19       151
      B-PER       0.69      0.55      0.61       438
      I-PER       0.66      0.41      0.50       214
      B-LOC       0.91      0.40      0.55       218
      I-LOC       0.93      0.50      0.65       141

avg / total       0.86      0.84      0.85      9071

F-1 Score:
0.469664525339
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100107 unique words.
Found 94 unique chars.
Found 9 unique labels.
103 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 314
OOV word occurences: 593
Padded until 63 tokens.
Padded until 24 chars.
Padded until 63 tokens.
Padded until 24 chars.
Padded until 63 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 63, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 63)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 63, 64)       6406912     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 63, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 63, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 63, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 63, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 63, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,910,018
Trainable params: 6,910,018
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 74 samples, validate on 9 samples
Epoch 1/70

74/74 [==============================] - 4s 51ms/step - loss: 1.5415 - acc: 0.4497 - val_loss: 1.5601 - val_acc: 0.7151
Epoch 2/70

74/74 [==============================] - 1s 19ms/step - loss: 1.2115 - acc: 0.7118 - val_loss: 0.6721 - val_acc: 0.8101
Epoch 3/70

74/74 [==============================] - 1s 19ms/step - loss: 0.7491 - acc: 0.7792 - val_loss: 0.5891 - val_acc: 0.8101
Epoch 4/70

74/74 [==============================] - 1s 19ms/step - loss: 0.6642 - acc: 0.7915 - val_loss: 0.5055 - val_acc: 0.8268
Epoch 5/70

74/74 [==============================] - 1s 18ms/step - loss: 0.5679 - acc: 0.8204 - val_loss: 0.4364 - val_acc: 0.8380
Epoch 6/70

74/74 [==============================] - 1s 18ms/step - loss: 0.4943 - acc: 0.8403 - val_loss: 0.3907 - val_acc: 0.9162
Epoch 7/70

74/74 [==============================] - 1s 18ms/step - loss: 0.4634 - acc: 0.8670 - val_loss: 0.3344 - val_acc: 0.8939
Epoch 8/70

74/74 [==============================] - 1s 18ms/step - loss: 0.3760 - acc: 0.8850 - val_loss: 0.3571 - val_acc: 0.9106
Epoch 9/70

74/74 [==============================] - 1s 18ms/step - loss: 0.3778 - acc: 0.8840 - val_loss: 0.2817 - val_acc: 0.9274
Epoch 10/70

74/74 [==============================] - 1s 18ms/step - loss: 0.3016 - acc: 0.9131 - val_loss: 0.2800 - val_acc: 0.9218
Epoch 11/70

74/74 [==============================] - 1s 18ms/step - loss: 0.2663 - acc: 0.9296 - val_loss: 0.2449 - val_acc: 0.9441
Epoch 12/70

74/74 [==============================] - 1s 18ms/step - loss: 0.2646 - acc: 0.9309 - val_loss: 0.2541 - val_acc: 0.9330
Epoch 13/70

74/74 [==============================] - 1s 18ms/step - loss: 0.2218 - acc: 0.9365 - val_loss: 0.2336 - val_acc: 0.9385
Epoch 14/70

74/74 [==============================] - 1s 18ms/step - loss: 0.2149 - acc: 0.9435 - val_loss: 0.2931 - val_acc: 0.8939
Epoch 15/70

74/74 [==============================] - 1s 18ms/step - loss: 0.2067 - acc: 0.9393 - val_loss: 0.2273 - val_acc: 0.9497
Epoch 16/70

74/74 [==============================] - 1s 18ms/step - loss: 0.1646 - acc: 0.9611 - val_loss: 0.2762 - val_acc: 0.9274
Epoch 17/70

74/74 [==============================] - 1s 18ms/step - loss: 0.1591 - acc: 0.9544 - val_loss: 0.2100 - val_acc: 0.9497
Epoch 18/70

74/74 [==============================] - 1s 18ms/step - loss: 0.1479 - acc: 0.9649 - val_loss: 0.2624 - val_acc: 0.9274
Epoch 19/70

74/74 [==============================] - 1s 18ms/step - loss: 0.1537 - acc: 0.9554 - val_loss: 0.2492 - val_acc: 0.9330
Manual evaluation: (didn't understand why I made this)
True 7587
False 1484
True percentage 0.836401719766
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.95      0.95      7318
      B-ORG       0.59      0.31      0.41       296
      B-LOC       0.71      0.55      0.62       218
      B-PER       0.90      0.41      0.57       438
      I-PER       0.92      0.21      0.35       214
     B-MISC       0.18      0.13      0.15       141
      I-ORG       0.48      0.14      0.22       151
      I-LOC       0.80      0.55      0.65       141
     I-MISC       0.24      0.40      0.30       154

avg / total       0.89      0.84      0.85      9071

F-1 Score:
0.435643564356
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100094 unique words.
Found 94 unique chars.
Found 9 unique labels.
90 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 312
OOV word occurences: 522
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6406080     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,909,186
Trainable params: 6,909,186
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 74 samples, validate on 9 samples
Epoch 1/70

74/74 [==============================] - 4s 49ms/step - loss: 1.8768 - acc: 0.4797 - val_loss: 0.8383 - val_acc: 0.8295
Epoch 2/70

74/74 [==============================] - 1s 17ms/step - loss: 0.8887 - acc: 0.7954 - val_loss: 0.6687 - val_acc: 0.8295
Epoch 3/70

74/74 [==============================] - 1s 17ms/step - loss: 0.7350 - acc: 0.7951 - val_loss: 0.5813 - val_acc: 0.8295
Epoch 4/70

74/74 [==============================] - 1s 18ms/step - loss: 0.6446 - acc: 0.7998 - val_loss: 0.5415 - val_acc: 0.8295
Epoch 5/70

74/74 [==============================] - 1s 17ms/step - loss: 0.5936 - acc: 0.8110 - val_loss: 0.4630 - val_acc: 0.8466
Epoch 6/70

74/74 [==============================] - 1s 17ms/step - loss: 0.5091 - acc: 0.8309 - val_loss: 0.4159 - val_acc: 0.8636
Epoch 7/70

74/74 [==============================] - 1s 16ms/step - loss: 0.4371 - acc: 0.8646 - val_loss: 0.4743 - val_acc: 0.8466
Epoch 8/70

74/74 [==============================] - 1s 17ms/step - loss: 0.4530 - acc: 0.8667 - val_loss: 0.3797 - val_acc: 0.8693
Epoch 9/70

74/74 [==============================] - 1s 17ms/step - loss: 0.3665 - acc: 0.8878 - val_loss: 0.3740 - val_acc: 0.8636
Epoch 10/70

74/74 [==============================] - 1s 17ms/step - loss: 0.3452 - acc: 0.8887 - val_loss: 0.3346 - val_acc: 0.8750
Epoch 11/70

74/74 [==============================] - 1s 17ms/step - loss: 0.2913 - acc: 0.9085 - val_loss: 0.3152 - val_acc: 0.8977
Epoch 12/70

74/74 [==============================] - 1s 16ms/step - loss: 0.2664 - acc: 0.9201 - val_loss: 0.3422 - val_acc: 0.8920
Epoch 13/70

74/74 [==============================] - 1s 17ms/step - loss: 0.2422 - acc: 0.9232 - val_loss: 0.3366 - val_acc: 0.8920
Manual evaluation: (didn't understand why I made this)
True 7519
False 1552
True percentage 0.828905302613
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.94      0.95      7318
      B-PER       0.76      0.57      0.65       438
      B-ORG       0.39      0.35      0.37       296
     I-MISC       0.20      0.51      0.29       154
      B-LOC       0.83      0.31      0.45       218
      I-LOC       1.00      0.09      0.16       141
      I-ORG       0.33      0.09      0.15       151
      I-PER       0.57      0.52      0.54       214
     B-MISC       0.31      0.12      0.17       141

avg / total       0.88      0.83      0.84      9071

F-1 Score:
0.416746564398
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100097 unique words.
Found 94 unique chars.
Found 9 unique labels.
93 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 315
OOV word occurences: 601
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6406272     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,909,378
Trainable params: 6,909,378
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 74 samples, validate on 9 samples
Epoch 1/70

74/74 [==============================] - 4s 49ms/step - loss: 1.6720 - acc: 0.4826 - val_loss: 0.9659 - val_acc: 0.8263
Epoch 2/70

74/74 [==============================] - 1s 17ms/step - loss: 0.9480 - acc: 0.7878 - val_loss: 0.6426 - val_acc: 0.8263
Epoch 3/70

74/74 [==============================] - 1s 18ms/step - loss: 0.7299 - acc: 0.7870 - val_loss: 0.5832 - val_acc: 0.8263
Epoch 4/70

74/74 [==============================] - 1s 17ms/step - loss: 0.6479 - acc: 0.8001 - val_loss: 0.5144 - val_acc: 0.8517
Epoch 5/70

74/74 [==============================] - 1s 17ms/step - loss: 0.5540 - acc: 0.8246 - val_loss: 0.4504 - val_acc: 0.8729
Epoch 6/70

74/74 [==============================] - 1s 17ms/step - loss: 0.5370 - acc: 0.8508 - val_loss: 0.4245 - val_acc: 0.8602
Epoch 7/70

74/74 [==============================] - 1s 17ms/step - loss: 0.4461 - acc: 0.8587 - val_loss: 0.3756 - val_acc: 0.8856
Epoch 8/70

74/74 [==============================] - 1s 17ms/step - loss: 0.3851 - acc: 0.8791 - val_loss: 0.3632 - val_acc: 0.8771
Epoch 9/70

74/74 [==============================] - 1s 16ms/step - loss: 0.3236 - acc: 0.8973 - val_loss: 0.3849 - val_acc: 0.8686
Epoch 10/70

74/74 [==============================] - 1s 17ms/step - loss: 0.3033 - acc: 0.9086 - val_loss: 0.3663 - val_acc: 0.8771
Manual evaluation: (didn't understand why I made this)
True 7295
False 1776
True percentage 0.804211222577
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.94      0.95      7318
      B-PER       0.86      0.14      0.24       438
      B-LOC       0.90      0.35      0.51       218
      B-ORG       0.43      0.46      0.45       296
      I-PER       0.50      0.01      0.02       214
     B-MISC       0.00      0.00      0.00       141
     I-MISC       1.00      0.01      0.01       154
      I-LOC       0.00      0.00      0.00       141
      I-ORG       0.16      0.77      0.27       151

avg / total       0.87      0.80      0.81      9071

F-1 Score:
0.268433571186
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100112 unique words.
Found 94 unique chars.
Found 9 unique labels.
108 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 308
OOV word occurences: 503
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 58, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 58)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 58, 64)       6407232     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 58, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 58, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 58, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 58, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 58, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,910,338
Trainable params: 6,910,338
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 74 samples, validate on 9 samples
Epoch 1/70

74/74 [==============================] - 4s 50ms/step - loss: 1.6933 - acc: 0.4664 - val_loss: 0.9977 - val_acc: 0.7883
Epoch 2/70

74/74 [==============================] - 1s 17ms/step - loss: 0.9085 - acc: 0.8055 - val_loss: 0.7118 - val_acc: 0.7883
Epoch 3/70

74/74 [==============================] - 1s 18ms/step - loss: 0.6825 - acc: 0.8095 - val_loss: 0.6130 - val_acc: 0.7883
Epoch 4/70

74/74 [==============================] - 1s 18ms/step - loss: 0.5974 - acc: 0.8134 - val_loss: 0.5708 - val_acc: 0.8153
Epoch 5/70

74/74 [==============================] - 1s 17ms/step - loss: 0.5043 - acc: 0.8451 - val_loss: 0.4216 - val_acc: 0.8874
Epoch 6/70

74/74 [==============================] - 1s 17ms/step - loss: 0.4210 - acc: 0.8657 - val_loss: 0.4005 - val_acc: 0.8919
Epoch 7/70

74/74 [==============================] - 1s 17ms/step - loss: 0.3626 - acc: 0.8728 - val_loss: 0.3586 - val_acc: 0.9144
Epoch 8/70

74/74 [==============================] - 1s 17ms/step - loss: 0.3590 - acc: 0.8897 - val_loss: 0.3503 - val_acc: 0.9054
Epoch 9/70

74/74 [==============================] - 1s 17ms/step - loss: 0.2930 - acc: 0.9095 - val_loss: 0.3782 - val_acc: 0.8919
Epoch 10/70

74/74 [==============================] - 1s 17ms/step - loss: 0.2882 - acc: 0.9129 - val_loss: 0.3907 - val_acc: 0.8514
Manual evaluation: (didn't understand why I made this)
True 7397
False 1674
True percentage 0.815455848308
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.89      0.96      0.92      7318
      B-ORG       0.58      0.36      0.44       296
      I-ORG       0.50      0.06      0.11       151
      B-PER       0.79      0.22      0.35       438
      B-LOC       0.73      0.50      0.60       218
      I-LOC       0.67      0.09      0.15       141
      I-PER       0.53      0.15      0.23       214
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.23      0.17      0.20       154

avg / total       0.83      0.82      0.80      9071

F-1 Score:
0.324279835391
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100115 unique words.
Found 94 unique chars.
Found 9 unique labels.
111 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 311
OOV word occurences: 505
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6407424     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,910,530
Trainable params: 6,910,530
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 74 samples, validate on 9 samples
Epoch 1/70

74/74 [==============================] - 4s 49ms/step - loss: 1.5227 - acc: 0.4717 - val_loss: 1.4265 - val_acc: 0.8315
Epoch 2/70

74/74 [==============================] - 1s 17ms/step - loss: 1.0824 - acc: 0.7734 - val_loss: 0.6780 - val_acc: 0.7935
Epoch 3/70

74/74 [==============================] - 1s 17ms/step - loss: 0.6906 - acc: 0.7940 - val_loss: 0.6100 - val_acc: 0.7935
Epoch 4/70

74/74 [==============================] - 1s 17ms/step - loss: 0.6055 - acc: 0.8068 - val_loss: 0.5760 - val_acc: 0.8043
Epoch 5/70

74/74 [==============================] - 1s 16ms/step - loss: 0.5231 - acc: 0.8387 - val_loss: 0.4849 - val_acc: 0.8533
Epoch 6/70

74/74 [==============================] - 1s 17ms/step - loss: 0.4511 - acc: 0.8558 - val_loss: 0.4434 - val_acc: 0.8859
Epoch 7/70

74/74 [==============================] - 1s 17ms/step - loss: 0.3961 - acc: 0.8778 - val_loss: 0.5299 - val_acc: 0.8478
Epoch 8/70

74/74 [==============================] - 1s 17ms/step - loss: 0.4605 - acc: 0.8605 - val_loss: 0.3921 - val_acc: 0.8967
Epoch 9/70

74/74 [==============================] - 1s 17ms/step - loss: 0.3248 - acc: 0.9020 - val_loss: 0.3717 - val_acc: 0.9076
Epoch 10/70

74/74 [==============================] - 1s 16ms/step - loss: 0.2826 - acc: 0.9139 - val_loss: 0.3408 - val_acc: 0.9022
Epoch 11/70

74/74 [==============================] - 1s 17ms/step - loss: 0.2485 - acc: 0.9215 - val_loss: 0.3930 - val_acc: 0.8859
Epoch 12/70

74/74 [==============================] - 1s 17ms/step - loss: 0.2243 - acc: 0.9271 - val_loss: 0.3698 - val_acc: 0.8967
Manual evaluation: (didn't understand why I made this)
True 7658
False 1413
True percentage 0.844228861206
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.95      0.95      7318
      B-ORG       0.43      0.52      0.47       296
      I-ORG       0.40      0.25      0.31       151
     B-MISC       0.24      0.22      0.23       141
     I-MISC       0.27      0.27      0.27       154
      B-PER       0.87      0.50      0.63       438
      B-LOC       0.67      0.38      0.48       218
      I-LOC       0.71      0.52      0.60       141
      I-PER       0.71      0.47      0.56       214

avg / total       0.89      0.84      0.86      9071

F-1 Score:
0.476037311032
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100115 unique words.
Found 94 unique chars.
Found 9 unique labels.
111 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 307
OOV word occurences: 604
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6407424     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,910,530
Trainable params: 6,910,530
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 74 samples, validate on 9 samples
Epoch 1/70

74/74 [==============================] - 4s 51ms/step - loss: 1.8157 - acc: 0.4775 - val_loss: 1.0774 - val_acc: 0.8060
Epoch 2/70

74/74 [==============================] - 1s 17ms/step - loss: 0.9603 - acc: 0.8027 - val_loss: 0.7606 - val_acc: 0.7960
Epoch 3/70

74/74 [==============================] - 1s 18ms/step - loss: 0.7087 - acc: 0.8019 - val_loss: 0.7052 - val_acc: 0.7960
Epoch 4/70

74/74 [==============================] - 1s 17ms/step - loss: 0.6383 - acc: 0.8040 - val_loss: 0.6601 - val_acc: 0.7960
Epoch 5/70

74/74 [==============================] - 1s 17ms/step - loss: 0.5574 - acc: 0.8189 - val_loss: 0.5347 - val_acc: 0.8259
Epoch 6/70

74/74 [==============================] - 1s 17ms/step - loss: 0.4938 - acc: 0.8463 - val_loss: 0.4727 - val_acc: 0.8507
Epoch 7/70

74/74 [==============================] - 1s 17ms/step - loss: 0.5168 - acc: 0.8423 - val_loss: 0.4785 - val_acc: 0.8607
Epoch 8/70

74/74 [==============================] - 1s 17ms/step - loss: 0.4100 - acc: 0.8793 - val_loss: 0.4823 - val_acc: 0.8308
Manual evaluation: (didn't understand why I made this)
True 7273
False 1798
True percentage 0.801785911145
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.83      0.20      0.32       438
          O       0.88      0.96      0.92      7318
      B-ORG       0.47      0.40      0.43       296
     B-MISC       0.00      0.00      0.00       141
      B-LOC       0.33      0.00      0.01       218
      I-LOC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      I-PER       0.69      0.17      0.27       214
      I-ORG       0.39      0.09      0.15       151

avg / total       0.79      0.80      0.78      9071

F-1 Score:
0.845728406684
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100116 unique words.
Found 94 unique chars.
Found 9 unique labels.
112 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 315
OOV word occurences: 609
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 58, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 58)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 58, 64)       6407488     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 58, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 58, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 58, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 58, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 58, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,910,594
Trainable params: 6,910,594
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 74 samples, validate on 9 samples
Epoch 1/70

74/74 [==============================] - 4s 51ms/step - loss: 1.8315 - acc: 0.4694 - val_loss: 0.9776 - val_acc: 0.8099
Epoch 2/70

74/74 [==============================] - 1s 18ms/step - loss: 0.9431 - acc: 0.8171 - val_loss: 0.6882 - val_acc: 0.8169
Epoch 3/70

74/74 [==============================] - 1s 17ms/step - loss: 0.6657 - acc: 0.8182 - val_loss: 0.6236 - val_acc: 0.8169
Epoch 4/70

74/74 [==============================] - 1s 18ms/step - loss: 0.6062 - acc: 0.8190 - val_loss: 0.5845 - val_acc: 0.8310
Epoch 5/70

74/74 [==============================] - 1s 17ms/step - loss: 0.5346 - acc: 0.8244 - val_loss: 0.5236 - val_acc: 0.8451
Epoch 6/70

74/74 [==============================] - 1s 17ms/step - loss: 0.4725 - acc: 0.8524 - val_loss: 0.4828 - val_acc: 0.8592
Epoch 7/70

74/74 [==============================] - 1s 17ms/step - loss: 0.4215 - acc: 0.8705 - val_loss: 0.4884 - val_acc: 0.8451
Epoch 8/70

74/74 [==============================] - 1s 17ms/step - loss: 0.3962 - acc: 0.8783 - val_loss: 0.4402 - val_acc: 0.8451
Epoch 9/70

74/74 [==============================] - 1s 17ms/step - loss: 0.3466 - acc: 0.8808 - val_loss: 0.4185 - val_acc: 0.8592
Epoch 10/70

74/74 [==============================] - 1s 17ms/step - loss: 0.2956 - acc: 0.9132 - val_loss: 0.4596 - val_acc: 0.8521
Epoch 11/70

74/74 [==============================] - 1s 17ms/step - loss: 0.3118 - acc: 0.9052 - val_loss: 0.3899 - val_acc: 0.8732
Epoch 12/70

74/74 [==============================] - 1s 17ms/step - loss: 0.2371 - acc: 0.9291 - val_loss: 0.4011 - val_acc: 0.8803
Epoch 13/70

74/74 [==============================] - 1s 17ms/step - loss: 0.2217 - acc: 0.9462 - val_loss: 0.3846 - val_acc: 0.8662
Epoch 14/70

74/74 [==============================] - 1s 17ms/step - loss: 0.2035 - acc: 0.9392 - val_loss: 0.3671 - val_acc: 0.8803
Epoch 15/70

74/74 [==============================] - 1s 17ms/step - loss: 0.1722 - acc: 0.9570 - val_loss: 0.3619 - val_acc: 0.8944
Epoch 16/70

74/74 [==============================] - 1s 17ms/step - loss: 0.1604 - acc: 0.9600 - val_loss: 0.3778 - val_acc: 0.8732
Epoch 17/70

74/74 [==============================] - 1s 17ms/step - loss: 0.1384 - acc: 0.9611 - val_loss: 0.4006 - val_acc: 0.8732
Manual evaluation: (didn't understand why I made this)
True 7443
False 1628
True percentage 0.820526954029
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.83      0.30      0.44       438
          O       0.94      0.94      0.94      7318
      B-LOC       0.45      0.73      0.56       218
      I-LOC       0.39      0.74      0.51       141
      I-PER       0.63      0.15      0.24       214
      B-ORG       0.48      0.33      0.39       296
      I-ORG       0.36      0.14      0.20       151
     B-MISC       0.08      0.01      0.01       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.85      0.82      0.82      9071

F-1 Score:
0.863451207273
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100110 unique words.
Found 94 unique chars.
Found 9 unique labels.
106 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 312
OOV word occurences: 543
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6407104     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,910,210
Trainable params: 6,910,210
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 74 samples, validate on 9 samples
Epoch 1/70

74/74 [==============================] - 4s 51ms/step - loss: 1.4225 - acc: 0.5352 - val_loss: 1.2366 - val_acc: 0.7955
Epoch 2/70

74/74 [==============================] - 1s 17ms/step - loss: 0.9439 - acc: 0.8019 - val_loss: 0.6578 - val_acc: 0.8409
Epoch 3/70

74/74 [==============================] - 1s 18ms/step - loss: 0.6278 - acc: 0.8145 - val_loss: 0.5463 - val_acc: 0.8409
Epoch 4/70

74/74 [==============================] - 1s 17ms/step - loss: 0.5411 - acc: 0.8362 - val_loss: 0.6092 - val_acc: 0.8466
Epoch 5/70

74/74 [==============================] - 1s 17ms/step - loss: 0.5935 - acc: 0.8338 - val_loss: 0.4591 - val_acc: 0.8580
Epoch 6/70

74/74 [==============================] - 1s 17ms/step - loss: 0.4292 - acc: 0.8558 - val_loss: 0.4588 - val_acc: 0.8693
Epoch 7/70

74/74 [==============================] - 1s 17ms/step - loss: 0.4004 - acc: 0.8787 - val_loss: 0.4094 - val_acc: 0.8466
Epoch 8/70

74/74 [==============================] - 1s 17ms/step - loss: 0.3527 - acc: 0.8808 - val_loss: 0.3712 - val_acc: 0.8807
Epoch 9/70

74/74 [==============================] - 1s 17ms/step - loss: 0.3110 - acc: 0.8955 - val_loss: 0.3274 - val_acc: 0.8977
Epoch 10/70

74/74 [==============================] - 1s 17ms/step - loss: 0.2800 - acc: 0.9095 - val_loss: 0.3519 - val_acc: 0.9034
Epoch 11/70

74/74 [==============================] - 1s 17ms/step - loss: 0.2813 - acc: 0.9129 - val_loss: 0.3142 - val_acc: 0.9034
Epoch 12/70

74/74 [==============================] - 1s 17ms/step - loss: 0.2355 - acc: 0.9331 - val_loss: 0.2964 - val_acc: 0.9148
Epoch 13/70

74/74 [==============================] - 1s 17ms/step - loss: 0.1948 - acc: 0.9454 - val_loss: 0.2543 - val_acc: 0.9148
Epoch 14/70

74/74 [==============================] - 1s 16ms/step - loss: 0.1950 - acc: 0.9403 - val_loss: 0.3230 - val_acc: 0.8977
Epoch 15/70

74/74 [==============================] - 1s 17ms/step - loss: 0.2306 - acc: 0.9258 - val_loss: 0.2543 - val_acc: 0.9261
Manual evaluation: (didn't understand why I made this)
True 7546
False 1525
True percentage 0.831881821188
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.94      0.94      7318
      B-ORG       0.44      0.42      0.43       296
     B-MISC       0.03      0.01      0.01       141
     I-MISC       0.22      0.06      0.09       154
      B-PER       0.76      0.52      0.61       438
      B-LOC       0.66      0.50      0.57       218
      I-ORG       0.22      0.27      0.24       151
      I-PER       0.74      0.30      0.43       214
      I-LOC       0.81      0.40      0.54       141

avg / total       0.86      0.83      0.84      9071

F-1 Score:
0.431452991453
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100111 unique words.
Found 94 unique chars.
Found 9 unique labels.
107 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 308
OOV word occurences: 480
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6407168     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,910,274
Trainable params: 6,910,274
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 74 samples, validate on 9 samples
Epoch 1/70

74/74 [==============================] - 4s 52ms/step - loss: 1.7346 - acc: 0.4764 - val_loss: 1.1675 - val_acc: 0.6815
Epoch 2/70

74/74 [==============================] - 1s 17ms/step - loss: 0.7694 - acc: 0.8177 - val_loss: 1.2660 - val_acc: 0.6815
Epoch 3/70

74/74 [==============================] - 1s 18ms/step - loss: 0.7801 - acc: 0.8176 - val_loss: 0.9952 - val_acc: 0.6879
Epoch 4/70

74/74 [==============================] - 1s 17ms/step - loss: 0.5843 - acc: 0.8218 - val_loss: 0.9031 - val_acc: 0.6943
Epoch 5/70

74/74 [==============================] - 1s 17ms/step - loss: 0.4959 - acc: 0.8385 - val_loss: 0.8238 - val_acc: 0.7261
Epoch 6/70

74/74 [==============================] - 1s 17ms/step - loss: 0.4481 - acc: 0.8615 - val_loss: 0.8195 - val_acc: 0.7261
Epoch 7/70

74/74 [==============================] - 1s 17ms/step - loss: 0.4266 - acc: 0.8711 - val_loss: 0.6744 - val_acc: 0.7898
Epoch 8/70

74/74 [==============================] - 1s 17ms/step - loss: 0.3484 - acc: 0.8910 - val_loss: 0.6653 - val_acc: 0.7707
Epoch 9/70

74/74 [==============================] - 1s 16ms/step - loss: 0.3067 - acc: 0.9055 - val_loss: 0.6078 - val_acc: 0.8025
Epoch 10/70

74/74 [==============================] - 1s 17ms/step - loss: 0.2824 - acc: 0.9153 - val_loss: 0.6515 - val_acc: 0.7771
Epoch 11/70

74/74 [==============================] - 1s 17ms/step - loss: 0.2835 - acc: 0.9159 - val_loss: 0.5807 - val_acc: 0.8025
Epoch 12/70

74/74 [==============================] - 1s 17ms/step - loss: 0.2298 - acc: 0.9365 - val_loss: 0.5479 - val_acc: 0.8217
Epoch 13/70

74/74 [==============================] - 1s 17ms/step - loss: 0.1945 - acc: 0.9411 - val_loss: 0.5441 - val_acc: 0.8089
Epoch 14/70

74/74 [==============================] - 1s 16ms/step - loss: 0.2145 - acc: 0.9441 - val_loss: 0.6046 - val_acc: 0.8153
Epoch 15/70

74/74 [==============================] - 1s 17ms/step - loss: 0.1716 - acc: 0.9418 - val_loss: 0.5113 - val_acc: 0.8153
Epoch 16/70

74/74 [==============================] - 1s 16ms/step - loss: 0.1715 - acc: 0.9560 - val_loss: 0.5848 - val_acc: 0.8025
Epoch 17/70

74/74 [==============================] - 1s 17ms/step - loss: 0.1449 - acc: 0.9590 - val_loss: 0.5474 - val_acc: 0.8280
Manual evaluation: (didn't understand why I made this)
True 7709
False 1362
True percentage 0.849851174071
Sklearn evaluation:
             precision    recall  f1-score   support

     B-MISC       0.50      0.02      0.04       141
     I-MISC       0.29      0.06      0.11       154
          O       0.93      0.95      0.94      7318
      B-PER       0.79      0.60      0.68       438
      I-PER       0.68      0.43      0.53       214
      B-ORG       0.61      0.46      0.52       296
      B-LOC       0.72      0.58      0.64       218
      I-ORG       0.36      0.18      0.24       151
      I-LOC       0.75      0.48      0.58       141

avg / total       0.87      0.85      0.85      9071

F-1 Score:
0.879931487297
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100128 unique words.
Found 94 unique chars.
Found 9 unique labels.
124 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 308
OOV word occurences: 571
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 67, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 67)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 67, 64)       6408256     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 67, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 67, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 67, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 67, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 67, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,911,362
Trainable params: 6,911,362
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 74 samples, validate on 9 samples
Epoch 1/70

74/74 [==============================] - 4s 52ms/step - loss: 1.5645 - acc: 0.4599 - val_loss: 1.6817 - val_acc: 0.7819
Epoch 2/70

74/74 [==============================] - 1s 20ms/step - loss: 1.3889 - acc: 0.7983 - val_loss: 0.7389 - val_acc: 0.7819
Epoch 3/70

74/74 [==============================] - 2s 20ms/step - loss: 0.7202 - acc: 0.8005 - val_loss: 0.6900 - val_acc: 0.7872
Epoch 4/70

74/74 [==============================] - 1s 19ms/step - loss: 0.6180 - acc: 0.8137 - val_loss: 0.6350 - val_acc: 0.8404
Epoch 5/70

74/74 [==============================] - 1s 20ms/step - loss: 0.5617 - acc: 0.8254 - val_loss: 0.5691 - val_acc: 0.8404
Epoch 6/70

74/74 [==============================] - 1s 19ms/step - loss: 0.5075 - acc: 0.8473 - val_loss: 0.5294 - val_acc: 0.8351
Epoch 7/70

74/74 [==============================] - 1s 19ms/step - loss: 0.4706 - acc: 0.8539 - val_loss: 0.4988 - val_acc: 0.8564
Epoch 8/70

74/74 [==============================] - 1s 19ms/step - loss: 0.4153 - acc: 0.8632 - val_loss: 0.5308 - val_acc: 0.8351
Epoch 9/70

74/74 [==============================] - 1s 19ms/step - loss: 0.4020 - acc: 0.8689 - val_loss: 0.4503 - val_acc: 0.8670
Epoch 10/70

74/74 [==============================] - 1s 19ms/step - loss: 0.3616 - acc: 0.8814 - val_loss: 0.4226 - val_acc: 0.8564
Epoch 11/70

74/74 [==============================] - 1s 19ms/step - loss: 0.3277 - acc: 0.8900 - val_loss: 0.4304 - val_acc: 0.8883
Epoch 12/70

74/74 [==============================] - 1s 19ms/step - loss: 0.3072 - acc: 0.9037 - val_loss: 0.4161 - val_acc: 0.8670
Epoch 13/70

74/74 [==============================] - 1s 19ms/step - loss: 0.2750 - acc: 0.9148 - val_loss: 0.3762 - val_acc: 0.8723
Epoch 14/70

74/74 [==============================] - 1s 19ms/step - loss: 0.2517 - acc: 0.9178 - val_loss: 0.4009 - val_acc: 0.8777
Epoch 15/70

74/74 [==============================] - 1s 19ms/step - loss: 0.2424 - acc: 0.9280 - val_loss: 0.3582 - val_acc: 0.8989
Epoch 16/70

74/74 [==============================] - 1s 19ms/step - loss: 0.2134 - acc: 0.9463 - val_loss: 0.3785 - val_acc: 0.8777
Epoch 17/70

74/74 [==============================] - 1s 19ms/step - loss: 0.2144 - acc: 0.9310 - val_loss: 0.3816 - val_acc: 0.8723
Manual evaluation: (didn't understand why I made this)
True 7593
False 1478
True percentage 0.837063168339
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.95      0.94      7318
      B-PER       0.75      0.43      0.55       438
      B-ORG       0.65      0.49      0.56       296
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.17      0.01      0.01       154
      I-ORG       0.41      0.16      0.23       151
      B-LOC       0.61      0.57      0.59       218
      I-LOC       0.55      0.71      0.62       141
      I-PER       0.87      0.19      0.31       214

avg / total       0.86      0.84      0.84      9071

F-1 Score:
0.457415565345
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100101 unique words.
Found 94 unique chars.
Found 9 unique labels.
97 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 317
OOV word occurences: 536
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6406528     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,909,634
Trainable params: 6,909,634
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 74 samples, validate on 9 samples
Epoch 1/70

74/74 [==============================] - 4s 49ms/step - loss: 1.5936 - acc: 0.5067 - val_loss: 1.3867 - val_acc: 0.7366
Epoch 2/70

74/74 [==============================] - 1s 16ms/step - loss: 1.0282 - acc: 0.7783 - val_loss: 0.6899 - val_acc: 0.8118
Epoch 3/70

74/74 [==============================] - 1s 16ms/step - loss: 0.6353 - acc: 0.8177 - val_loss: 0.6256 - val_acc: 0.8118
Epoch 4/70

74/74 [==============================] - 1s 17ms/step - loss: 0.5466 - acc: 0.8267 - val_loss: 0.5880 - val_acc: 0.8280
Epoch 5/70

74/74 [==============================] - 1s 17ms/step - loss: 0.4753 - acc: 0.8527 - val_loss: 0.5283 - val_acc: 0.8333
Epoch 6/70

74/74 [==============================] - 1s 17ms/step - loss: 0.3980 - acc: 0.8785 - val_loss: 0.4823 - val_acc: 0.8441
Epoch 7/70

74/74 [==============================] - 1s 16ms/step - loss: 0.3818 - acc: 0.8904 - val_loss: 0.4695 - val_acc: 0.8387
Epoch 8/70

74/74 [==============================] - 1s 17ms/step - loss: 0.3262 - acc: 0.8954 - val_loss: 0.4350 - val_acc: 0.8495
Epoch 9/70

74/74 [==============================] - 1s 17ms/step - loss: 0.2745 - acc: 0.9204 - val_loss: 0.3937 - val_acc: 0.8871
Epoch 10/70

74/74 [==============================] - 1s 17ms/step - loss: 0.2438 - acc: 0.9264 - val_loss: 0.3638 - val_acc: 0.8925
Epoch 11/70

74/74 [==============================] - 1s 16ms/step - loss: 0.2834 - acc: 0.9139 - val_loss: 0.3592 - val_acc: 0.8925
Epoch 12/70

74/74 [==============================] - 1s 17ms/step - loss: 0.2375 - acc: 0.9379 - val_loss: 0.4081 - val_acc: 0.8817
Epoch 13/70

74/74 [==============================] - 1s 17ms/step - loss: 0.2069 - acc: 0.9434 - val_loss: 0.3261 - val_acc: 0.9032
Epoch 14/70

74/74 [==============================] - 1s 16ms/step - loss: 0.1828 - acc: 0.9500 - val_loss: 0.3490 - val_acc: 0.8871
Epoch 15/70

74/74 [==============================] - 1s 16ms/step - loss: 0.1692 - acc: 0.9487 - val_loss: 0.2911 - val_acc: 0.9140
Epoch 16/70

74/74 [==============================] - 1s 16ms/step - loss: 0.1515 - acc: 0.9574 - val_loss: 0.2570 - val_acc: 0.9194
Epoch 17/70

74/74 [==============================] - 1s 16ms/step - loss: 0.1508 - acc: 0.9588 - val_loss: 0.3278 - val_acc: 0.8978
Epoch 18/70

74/74 [==============================] - 1s 16ms/step - loss: 0.1353 - acc: 0.9615 - val_loss: 0.2638 - val_acc: 0.9086
Manual evaluation: (didn't understand why I made this)
True 7484
False 1587
True percentage 0.825046852607
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.95      0.94      7318
      B-ORG       0.46      0.36      0.40       296
      I-ORG       0.20      0.21      0.21       151
      B-PER       0.80      0.45      0.58       438
     B-MISC       0.21      0.07      0.11       141
     I-MISC       0.15      0.24      0.18       154
      B-LOC       0.90      0.34      0.50       218
      I-LOC       0.80      0.03      0.05       141
      I-PER       0.75      0.28      0.40       214

avg / total       0.87      0.83      0.83      9071

F-1 Score:
0.364273204904
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100039 unique words.
Found 92 unique chars.
Found 9 unique labels.
35 unique words not found in embedding.
8 unique chars not found in embedding.
Number of OOV: 322
OOV word occurences: 628
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6402560     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,905,538
Trainable params: 6,905,538
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 29 samples, validate on 4 samples
Epoch 1/70

29/29 [==============================] - 3s 101ms/step - loss: 2.1188 - acc: 0.3730 - val_loss: 0.9222 - val_acc: 0.7938
Epoch 2/70

29/29 [==============================] - 0s 17ms/step - loss: 0.9591 - acc: 0.7940 - val_loss: 0.8115 - val_acc: 0.7938
Epoch 3/70

29/29 [==============================] - 0s 17ms/step - loss: 0.7781 - acc: 0.7940 - val_loss: 1.4191 - val_acc: 0.7320
Epoch 4/70

29/29 [==============================] - 0s 16ms/step - loss: 1.3362 - acc: 0.7158 - val_loss: 0.7285 - val_acc: 0.7938
Epoch 5/70

29/29 [==============================] - 0s 17ms/step - loss: 0.6953 - acc: 0.7940 - val_loss: 0.6690 - val_acc: 0.8041
Epoch 6/70

29/29 [==============================] - 0s 16ms/step - loss: 0.6100 - acc: 0.8082 - val_loss: 0.6196 - val_acc: 0.8041
Epoch 7/70

29/29 [==============================] - 0s 17ms/step - loss: 0.5457 - acc: 0.8153 - val_loss: 0.5899 - val_acc: 0.8557
Epoch 8/70

29/29 [==============================] - 1s 18ms/step - loss: 0.5129 - acc: 0.8721 - val_loss: 0.6211 - val_acc: 0.8144
Epoch 9/70

29/29 [==============================] - 1s 17ms/step - loss: 0.4875 - acc: 0.8242 - val_loss: 0.5770 - val_acc: 0.8763
Epoch 10/70

29/29 [==============================] - 0s 16ms/step - loss: 0.4932 - acc: 0.8845 - val_loss: 0.5078 - val_acc: 0.8454
Epoch 11/70

29/29 [==============================] - 0s 16ms/step - loss: 0.3621 - acc: 0.8721 - val_loss: 0.4222 - val_acc: 0.8866
Epoch 12/70

29/29 [==============================] - 0s 16ms/step - loss: 0.3398 - acc: 0.8917 - val_loss: 0.4216 - val_acc: 0.8866
Epoch 13/70

29/29 [==============================] - 0s 16ms/step - loss: 0.2902 - acc: 0.9201 - val_loss: 0.3784 - val_acc: 0.8866
Epoch 14/70

29/29 [==============================] - 0s 17ms/step - loss: 0.2792 - acc: 0.9165 - val_loss: 0.4632 - val_acc: 0.8763
Epoch 15/70

29/29 [==============================] - 0s 17ms/step - loss: 0.2778 - acc: 0.9218 - val_loss: 0.3419 - val_acc: 0.8763
Epoch 16/70

29/29 [==============================] - 0s 17ms/step - loss: 0.2298 - acc: 0.9414 - val_loss: 0.3607 - val_acc: 0.8866
Epoch 17/70

29/29 [==============================] - 0s 16ms/step - loss: 0.2055 - acc: 0.9361 - val_loss: 0.3237 - val_acc: 0.9175
Epoch 18/70

29/29 [==============================] - 0s 16ms/step - loss: 0.2167 - acc: 0.9378 - val_loss: 0.4665 - val_acc: 0.8763
Epoch 19/70

29/29 [==============================] - 0s 16ms/step - loss: 0.2682 - acc: 0.9076 - val_loss: 0.4187 - val_acc: 0.8969
Manual evaluation: (didn't understand why I made this)
True 6990
False 2081
True percentage 0.770587586815
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.90      0.93      7318
      B-PER       0.62      0.26      0.36       438
      B-LOC       0.21      0.50      0.29       218
      B-ORG       0.25      0.20      0.22       296
      I-ORG       0.18      0.30      0.23       151
      I-PER       1.00      0.01      0.03       214
      I-LOC       0.12      0.33      0.18       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.85      0.77      0.79      9071

F-1 Score:
0.224276767074
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100062 unique words.
Found 94 unique chars.
Found 9 unique labels.
58 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 319
OOV word occurences: 618
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6404032     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,907,138
Trainable params: 6,907,138
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 29 samples, validate on 4 samples
Epoch 1/70

29/29 [==============================] - 3s 100ms/step - loss: 2.1044 - acc: 0.4378 - val_loss: 0.7608 - val_acc: 0.8795
Epoch 2/70

29/29 [==============================] - 1s 17ms/step - loss: 0.9173 - acc: 0.8122 - val_loss: 1.4354 - val_acc: 0.8795
Epoch 3/70

29/29 [==============================] - 0s 17ms/step - loss: 2.4047 - acc: 0.8122 - val_loss: 1.0047 - val_acc: 0.8675
Manual evaluation: (didn't understand why I made this)
True 7027
False 2044
True percentage 0.774666519678
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.86      0.95      0.90      7318
      B-ORG       0.10      0.03      0.04       296
      B-LOC       0.00      0.00      0.00       218
      I-ORG       0.19      0.31      0.24       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-PER       0.00      0.00      0.00       438
      I-PER       0.00      0.00      0.00       214
      I-LOC       0.00      0.00      0.00       141

avg / total       0.70      0.77      0.73      9071

F-1 Score:
0.052757793765
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100044 unique words.
Found 94 unique chars.
Found 9 unique labels.
40 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 324
OOV word occurences: 560
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6402880     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,905,986
Trainable params: 6,905,986
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 29 samples, validate on 4 samples
Epoch 1/70

29/29 [==============================] - 3s 99ms/step - loss: 2.3228 - acc: 0.0202 - val_loss: 0.9410 - val_acc: 0.8000
Epoch 2/70

29/29 [==============================] - 0s 17ms/step - loss: 0.7737 - acc: 0.8445 - val_loss: 1.7986 - val_acc: 0.8000
Epoch 3/70

29/29 [==============================] - 0s 17ms/step - loss: 1.8291 - acc: 0.8445 - val_loss: 1.0815 - val_acc: 0.8000
Manual evaluation: (didn't understand why I made this)
True 7037
False 2034
True percentage 0.775768933965
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.83      0.96      0.89      7318
      B-PER       0.38      0.02      0.04       438
      B-ORG       0.50      0.00      0.01       296
      I-ORG       0.00      0.00      0.00       151
      I-PER       0.00      0.00      0.00       214
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.70      0.78      0.72      9071

F-1 Score:
0.0123526108928
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100044 unique words.
Found 94 unique chars.
Found 9 unique labels.
40 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 320
OOV word occurences: 543
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6402880     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,905,986
Trainable params: 6,905,986
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 29 samples, validate on 4 samples
Epoch 1/70

29/29 [==============================] - 3s 101ms/step - loss: 2.4785 - acc: 0.0284 - val_loss: 0.8640 - val_acc: 0.8148
Epoch 2/70

29/29 [==============================] - 0s 17ms/step - loss: 0.9703 - acc: 0.7867 - val_loss: 1.5630 - val_acc: 0.8148
Epoch 3/70

29/29 [==============================] - 0s 17ms/step - loss: 1.7691 - acc: 0.7899 - val_loss: 1.5907 - val_acc: 0.7531
Manual evaluation: (didn't understand why I made this)
True 5883
False 3188
True percentage 0.648550325212
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.76      0.86      7318
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-ORG       0.08      0.64      0.14       296
      I-ORG       0.10      0.01      0.02       151
      B-PER       0.42      0.08      0.14       438
      I-PER       0.00      0.00      0.00       214
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.23      0.56      0.33       141

avg / total       0.82      0.65      0.71      9071

F-1 Score:
0.133594429939
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100031 unique words.
Found 93 unique chars.
Found 9 unique labels.
27 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 321
OOV word occurences: 620
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6402048     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,905,090
Trainable params: 6,905,090
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 29 samples, validate on 4 samples
Epoch 1/70

29/29 [==============================] - 3s 99ms/step - loss: 2.2268 - acc: 0.1190 - val_loss: 0.9078 - val_acc: 0.8171
Epoch 2/70

29/29 [==============================] - 1s 17ms/step - loss: 0.9925 - acc: 0.7674 - val_loss: 1.7030 - val_acc: 0.8171
Epoch 3/70

29/29 [==============================] - 1s 17ms/step - loss: 1.8100 - acc: 0.7674 - val_loss: 1.4513 - val_acc: 0.8049
Manual evaluation: (didn't understand why I made this)
True 6530
False 2541
True percentage 0.7198765296
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.86      0.91      7318
      B-ORG       0.00      0.00      0.00       296
      B-LOC       0.11      0.81      0.19       218
      B-PER       0.58      0.05      0.09       438
      I-PER       0.00      0.00      0.00       214
     B-MISC       0.00      0.00      0.00       141
      I-ORG       0.00      0.00      0.00       151
      I-LOC       0.07      0.12      0.09       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.81      0.72      0.75      9071

F-1 Score:
0.116684841876
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100037 unique words.
Found 94 unique chars.
Found 9 unique labels.
33 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 325
OOV word occurences: 636
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6402432     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,905,538
Trainable params: 6,905,538
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 29 samples, validate on 4 samples
Epoch 1/70

29/29 [==============================] - 3s 100ms/step - loss: 2.2725 - acc: 0.0260 - val_loss: 0.6786 - val_acc: 0.8687
Epoch 2/70

29/29 [==============================] - 0s 17ms/step - loss: 0.9055 - acc: 0.7955 - val_loss: 0.8836 - val_acc: 0.8889
Epoch 3/70

29/29 [==============================] - 0s 16ms/step - loss: 1.0954 - acc: 0.8160 - val_loss: 1.0538 - val_acc: 0.8687
Manual evaluation: (didn't understand why I made this)
True 7031
False 2040
True percentage 0.775107485393
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.83      0.96      0.89      7318
      B-PER       0.00      0.00      0.00       438
      B-ORG       0.00      0.00      0.00       296
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
      I-ORG       0.00      0.00      0.00       151
      I-PER       0.00      0.00      0.00       214
     B-MISC       0.00      0.00      0.00       141

avg / total       0.67      0.78      0.72      9071

F-1 Score:
0.0
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100051 unique words.
Found 94 unique chars.
Found 9 unique labels.
47 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 320
OOV word occurences: 627
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6403328     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,906,434
Trainable params: 6,906,434
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 29 samples, validate on 4 samples
Epoch 1/70

29/29 [==============================] - 3s 100ms/step - loss: 2.4766 - acc: 0.0188 - val_loss: 1.0191 - val_acc: 0.7879
Epoch 2/70

29/29 [==============================] - 0s 17ms/step - loss: 0.9864 - acc: 0.7881 - val_loss: 2.9548 - val_acc: 0.7879
Epoch 3/70

29/29 [==============================] - 0s 16ms/step - loss: 2.6052 - acc: 0.7881 - val_loss: 1.1875 - val_acc: 0.7879
Manual evaluation: (didn't understand why I made this)
True 6962
False 2109
True percentage 0.767500826811
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.87      0.94      0.90      7318
      B-PER       0.00      0.00      0.00       438
      B-LOC       0.00      0.00      0.00       218
      B-ORG       0.00      0.00      0.00       296
      I-PER       0.00      0.00      0.00       214
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      I-LOC       0.00      0.00      0.00       141
      I-ORG       0.15      0.52      0.23       151

avg / total       0.70      0.77      0.73      9071

F-1 Score:
0.0691466083151
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100053 unique words.
Found 94 unique chars.
Found 9 unique labels.
49 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 318
OOV word occurences: 529
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6403456     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,906,562
Trainable params: 6,906,562
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 29 samples, validate on 4 samples
Epoch 1/70

29/29 [==============================] - 3s 103ms/step - loss: 2.5736 - acc: 0.0367 - val_loss: 0.8563 - val_acc: 0.8710
Epoch 2/70

29/29 [==============================] - 0s 17ms/step - loss: 1.0656 - acc: 0.7815 - val_loss: 1.5838 - val_acc: 0.8710
Epoch 3/70

29/29 [==============================] - 0s 16ms/step - loss: 2.8752 - acc: 0.7815 - val_loss: 0.8538 - val_acc: 0.8710
Epoch 4/70

29/29 [==============================] - 0s 16ms/step - loss: 1.0432 - acc: 0.7863 - val_loss: 0.6636 - val_acc: 0.8710
Epoch 5/70

29/29 [==============================] - 0s 16ms/step - loss: 0.9631 - acc: 0.7815 - val_loss: 0.7137 - val_acc: 0.8710
Epoch 6/70

29/29 [==============================] - 0s 16ms/step - loss: 0.8860 - acc: 0.7895 - val_loss: 0.5602 - val_acc: 0.8710
Epoch 7/70

29/29 [==============================] - 0s 16ms/step - loss: 0.7664 - acc: 0.7831 - val_loss: 0.5485 - val_acc: 0.8710
Epoch 8/70

29/29 [==============================] - 0s 17ms/step - loss: 0.7206 - acc: 0.7895 - val_loss: 0.5178 - val_acc: 0.8710
Epoch 9/70

29/29 [==============================] - 1s 17ms/step - loss: 0.6870 - acc: 0.7911 - val_loss: 0.4942 - val_acc: 0.8710
Epoch 10/70

29/29 [==============================] - 0s 17ms/step - loss: 0.6353 - acc: 0.7911 - val_loss: 0.4704 - val_acc: 0.8710
Epoch 11/70

29/29 [==============================] - 0s 16ms/step - loss: 0.6128 - acc: 0.8086 - val_loss: 0.4424 - val_acc: 0.8710
Epoch 12/70

29/29 [==============================] - 0s 16ms/step - loss: 0.5675 - acc: 0.8182 - val_loss: 0.4169 - val_acc: 0.8710
Epoch 13/70

29/29 [==============================] - 0s 16ms/step - loss: 0.5287 - acc: 0.8341 - val_loss: 0.3958 - val_acc: 0.8710
Epoch 14/70

29/29 [==============================] - 0s 16ms/step - loss: 0.5032 - acc: 0.8373 - val_loss: 0.3801 - val_acc: 0.8710
Epoch 15/70

29/29 [==============================] - 0s 17ms/step - loss: 0.4606 - acc: 0.8517 - val_loss: 0.3601 - val_acc: 0.8710
Epoch 16/70

29/29 [==============================] - 0s 16ms/step - loss: 0.4298 - acc: 0.8596 - val_loss: 0.3512 - val_acc: 0.8710
Epoch 17/70

29/29 [==============================] - 0s 16ms/step - loss: 0.4051 - acc: 0.8565 - val_loss: 0.3441 - val_acc: 0.9032
Epoch 18/70

29/29 [==============================] - 0s 16ms/step - loss: 0.4110 - acc: 0.8931 - val_loss: 0.3502 - val_acc: 0.8871
Epoch 19/70

29/29 [==============================] - 0s 16ms/step - loss: 0.3852 - acc: 0.8644 - val_loss: 0.3263 - val_acc: 0.9032
Epoch 20/70

29/29 [==============================] - 0s 16ms/step - loss: 0.3654 - acc: 0.9123 - val_loss: 0.3154 - val_acc: 0.9032
Epoch 21/70

29/29 [==============================] - 0s 17ms/step - loss: 0.3292 - acc: 0.8931 - val_loss: 0.2940 - val_acc: 0.9194
Epoch 22/70

29/29 [==============================] - 0s 16ms/step - loss: 0.3002 - acc: 0.9155 - val_loss: 0.2944 - val_acc: 0.9194
Epoch 23/70

29/29 [==============================] - 0s 16ms/step - loss: 0.2816 - acc: 0.9187 - val_loss: 0.2723 - val_acc: 0.9032
Epoch 24/70

29/29 [==============================] - 0s 16ms/step - loss: 0.2517 - acc: 0.9362 - val_loss: 0.2751 - val_acc: 0.9032
Epoch 25/70

29/29 [==============================] - 0s 16ms/step - loss: 0.2364 - acc: 0.9378 - val_loss: 0.2717 - val_acc: 0.9194
Epoch 26/70

29/29 [==============================] - 0s 16ms/step - loss: 0.2321 - acc: 0.9426 - val_loss: 0.2738 - val_acc: 0.9032
Epoch 27/70

29/29 [==============================] - 0s 17ms/step - loss: 0.2298 - acc: 0.9298 - val_loss: 0.2688 - val_acc: 0.9194
Epoch 28/70

29/29 [==============================] - 0s 17ms/step - loss: 0.2372 - acc: 0.9490 - val_loss: 0.2657 - val_acc: 0.8871
Epoch 29/70

29/29 [==============================] - 0s 16ms/step - loss: 0.2019 - acc: 0.9410 - val_loss: 0.2327 - val_acc: 0.9516
Epoch 30/70

29/29 [==============================] - 0s 16ms/step - loss: 0.1831 - acc: 0.9681 - val_loss: 0.2300 - val_acc: 0.9032
Epoch 31/70

29/29 [==============================] - 0s 16ms/step - loss: 0.1653 - acc: 0.9585 - val_loss: 0.2269 - val_acc: 0.9194
Epoch 32/70

29/29 [==============================] - 0s 16ms/step - loss: 0.1467 - acc: 0.9761 - val_loss: 0.2284 - val_acc: 0.9032
Epoch 33/70

29/29 [==============================] - 0s 16ms/step - loss: 0.1363 - acc: 0.9665 - val_loss: 0.2413 - val_acc: 0.9032
Manual evaluation: (didn't understand why I made this)
True 7334
False 1737
True percentage 0.808510638298
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.91      0.95      0.93      7318
      B-ORG       0.45      0.46      0.46       296
      I-ORG       0.37      0.18      0.24       151
      B-PER       0.63      0.25      0.36       438
      B-LOC       0.78      0.27      0.40       218
      I-LOC       0.67      0.03      0.05       141
      I-PER       0.66      0.15      0.25       214
     B-MISC       0.01      0.01      0.01       141
     I-MISC       0.20      0.18      0.19       154

avg / total       0.83      0.81      0.81      9071

F-1 Score:
0.297792742237
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100060 unique words.
Found 94 unique chars.
Found 9 unique labels.
56 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 318
OOV word occurences: 519
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6403904     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,907,010
Trainable params: 6,907,010
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 29 samples, validate on 4 samples
Epoch 1/70

29/29 [==============================] - 3s 99ms/step - loss: 2.2186 - acc: 0.1333 - val_loss: 1.1765 - val_acc: 0.7143
Epoch 2/70

29/29 [==============================] - 1s 17ms/step - loss: 0.8840 - acc: 0.8071 - val_loss: 2.1526 - val_acc: 0.7143
Epoch 3/70

29/29 [==============================] - 0s 17ms/step - loss: 1.3455 - acc: 0.8071 - val_loss: 1.5019 - val_acc: 0.7143
Manual evaluation: (didn't understand why I made this)
True 7072
False 1999
True percentage 0.779627383971
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.84      0.96      0.90      7318
      B-ORG       0.40      0.05      0.10       296
      I-ORG       0.00      0.00      0.00       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-PER       0.52      0.03      0.05       438
      B-LOC       0.62      0.05      0.09       218
      I-LOC       0.27      0.06      0.09       141
      I-PER       0.44      0.06      0.10       214

avg / total       0.75      0.78      0.73      9071

F-1 Score:
0.0584915341201
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100050 unique words.
Found 94 unique chars.
Found 9 unique labels.
46 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 317
OOV word occurences: 617
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6403264     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,906,370
Trainable params: 6,906,370
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 29 samples, validate on 4 samples
Epoch 1/70

29/29 [==============================] - 3s 100ms/step - loss: 2.3452 - acc: 0.0125 - val_loss: 0.8569 - val_acc: 0.8276
Epoch 2/70

29/29 [==============================] - 0s 17ms/step - loss: 0.8737 - acc: 0.8182 - val_loss: 0.8365 - val_acc: 0.8276
Epoch 3/70

29/29 [==============================] - 0s 16ms/step - loss: 0.7717 - acc: 0.8182 - val_loss: 1.1475 - val_acc: 0.8506
Epoch 4/70

29/29 [==============================] - 0s 16ms/step - loss: 1.1537 - acc: 0.8401 - val_loss: 0.9901 - val_acc: 0.8276
Manual evaluation: (didn't understand why I made this)
True 7047
False 2024
True percentage 0.776871348253
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.00      0.00      0.00       438
          O       0.83      0.96      0.89      7318
      B-ORG       0.00      0.00      0.00       296
     B-MISC       0.00      0.00      0.00       141
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      I-PER       0.00      0.00      0.00       214
      I-ORG       0.00      0.00      0.00       151

avg / total       0.67      0.78      0.72      9071

F-1 Score:
0.824837595833
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100048 unique words.
Found 93 unique chars.
Found 9 unique labels.
44 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 323
OOV word occurences: 626
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 58, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 58)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 58, 64)       6403136     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 58, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 58, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 58, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 58, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 58, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,906,178
Trainable params: 6,906,178
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 29 samples, validate on 4 samples
Epoch 1/70

29/29 [==============================] - 3s 100ms/step - loss: 2.3601 - acc: 0.0232 - val_loss: 0.8154 - val_acc: 0.9277
Epoch 2/70

29/29 [==============================] - 1s 17ms/step - loss: 1.0145 - acc: 0.8065 - val_loss: 0.7755 - val_acc: 0.9277
Epoch 3/70

29/29 [==============================] - 0s 17ms/step - loss: 2.3462 - acc: 0.8065 - val_loss: 0.8166 - val_acc: 0.9277
Epoch 4/70

29/29 [==============================] - 0s 17ms/step - loss: 0.9655 - acc: 0.8111 - val_loss: 0.3881 - val_acc: 0.9277
Epoch 5/70

29/29 [==============================] - 0s 17ms/step - loss: 0.6985 - acc: 0.8065 - val_loss: 0.3707 - val_acc: 0.9277
Epoch 6/70

29/29 [==============================] - 0s 17ms/step - loss: 0.6337 - acc: 0.8065 - val_loss: 0.3363 - val_acc: 0.9277
Epoch 7/70

29/29 [==============================] - 0s 17ms/step - loss: 0.5942 - acc: 0.8080 - val_loss: 0.3220 - val_acc: 0.9277
Epoch 8/70

29/29 [==============================] - 0s 16ms/step - loss: 0.5610 - acc: 0.8251 - val_loss: 0.2992 - val_acc: 0.9277
Epoch 9/70

29/29 [==============================] - 0s 17ms/step - loss: 0.4972 - acc: 0.8344 - val_loss: 0.2760 - val_acc: 0.9277
Epoch 10/70

29/29 [==============================] - 1s 18ms/step - loss: 0.4573 - acc: 0.8514 - val_loss: 0.2511 - val_acc: 0.9277
Epoch 11/70

29/29 [==============================] - 0s 17ms/step - loss: 0.4080 - acc: 0.8653 - val_loss: 0.2350 - val_acc: 0.9518
Epoch 12/70

29/29 [==============================] - 0s 17ms/step - loss: 0.3701 - acc: 0.8715 - val_loss: 0.2136 - val_acc: 0.9639
Epoch 13/70

29/29 [==============================] - 0s 16ms/step - loss: 0.3328 - acc: 0.8963 - val_loss: 0.2197 - val_acc: 0.9639
Epoch 14/70

29/29 [==============================] - 0s 16ms/step - loss: 0.2995 - acc: 0.9149 - val_loss: 0.2148 - val_acc: 0.9398
Manual evaluation: (didn't understand why I made this)
True 7087
False 1984
True percentage 0.781281005402
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.62      0.08      0.14       438
          O       0.84      0.96      0.90      7318
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
      I-PER       0.00      0.00      0.00       214
      B-ORG       0.70      0.07      0.13       296
      I-ORG       0.00      0.00      0.00       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.73      0.78      0.73      9071

F-1 Score:
0.828643599836
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100048 unique words.
Found 93 unique chars.
Found 9 unique labels.
44 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 324
OOV word occurences: 630
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6403136     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,906,178
Trainable params: 6,906,178
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 29 samples, validate on 4 samples
Epoch 1/70

29/29 [==============================] - 3s 100ms/step - loss: 2.3207 - acc: 0.0017 - val_loss: 0.8398 - val_acc: 0.8167
Epoch 2/70

29/29 [==============================] - 0s 17ms/step - loss: 0.9111 - acc: 0.7980 - val_loss: 1.0028 - val_acc: 0.8167
Epoch 3/70

29/29 [==============================] - 0s 16ms/step - loss: 0.9734 - acc: 0.8030 - val_loss: 1.8799 - val_acc: 0.8167
Manual evaluation: (didn't understand why I made this)
True 7037
False 2034
True percentage 0.775768933965
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.83      0.96      0.89      7318
      B-ORG       0.00      0.00      0.00       296
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-PER       0.00      0.00      0.00       438
      B-LOC       0.00      0.00      0.00       218
      I-ORG       0.00      0.00      0.00       151
      I-PER       0.00      0.00      0.00       214
      I-LOC       0.00      0.00      0.00       141

avg / total       0.67      0.78      0.72      9071

F-1 Score:
0.0
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100047 unique words.
Found 93 unique chars.
Found 9 unique labels.
43 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 322
OOV word occurences: 626
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6403072     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,906,114
Trainable params: 6,906,114
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 29 samples, validate on 4 samples
Epoch 1/70

29/29 [==============================] - 3s 98ms/step - loss: 2.4496 - acc: 0.0440 - val_loss: 0.7162 - val_acc: 0.8816
Epoch 2/70

29/29 [==============================] - 0s 17ms/step - loss: 0.8083 - acc: 0.8365 - val_loss: 1.1663 - val_acc: 0.8816
Epoch 3/70

29/29 [==============================] - 0s 16ms/step - loss: 1.5412 - acc: 0.8365 - val_loss: 1.2993 - val_acc: 0.8421
Manual evaluation: (didn't understand why I made this)
True 6809
False 2262
True percentage 0.750633888215
Sklearn evaluation:
             precision    recall  f1-score   support

     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
          O       0.92      0.91      0.91      7318
      B-PER       0.00      0.00      0.00       438
      I-PER       0.00      0.00      0.00       214
      B-ORG       0.13      0.51      0.20       296
      B-LOC       0.00      0.00      0.00       218
      I-ORG       0.00      0.00      0.00       151
      I-LOC       0.00      0.00      0.00       141

avg / total       0.74      0.75      0.74      9071

F-1 Score:
0.783769784173
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100044 unique words.
Found 94 unique chars.
Found 9 unique labels.
40 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 323
OOV word occurences: 630
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 67, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 67)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 67, 64)       6402880     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 67, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 67, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 67, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 67, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 67, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,905,986
Trainable params: 6,905,986
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 29 samples, validate on 4 samples
Epoch 1/70

29/29 [==============================] - 3s 102ms/step - loss: 2.2406 - acc: 0.0735 - val_loss: 0.8250 - val_acc: 0.8370
Epoch 2/70

29/29 [==============================] - 1s 20ms/step - loss: 1.0341 - acc: 0.7672 - val_loss: 2.2813 - val_acc: 0.8370
Epoch 3/70

29/29 [==============================] - 1s 19ms/step - loss: 2.9688 - acc: 0.7672 - val_loss: 0.9205 - val_acc: 0.8370
Manual evaluation: (didn't understand why I made this)
True 7029
False 2042
True percentage 0.774887002536
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.83      0.96      0.89      7318
      B-PER       0.00      0.00      0.00       438
      B-ORG       0.00      0.00      0.00       296
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      I-ORG       0.00      0.00      0.00       151
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
      I-PER       0.00      0.00      0.00       214

avg / total       0.67      0.77      0.72      9071

F-1 Score:
0.0
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100052 unique words.
Found 94 unique chars.
Found 9 unique labels.
48 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 322
OOV word occurences: 623
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6403392     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,906,498
Trainable params: 6,906,498
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 29 samples, validate on 4 samples
Epoch 1/70

29/29 [==============================] - 3s 99ms/step - loss: 2.3144 - acc: 0.0659 - val_loss: 0.5774 - val_acc: 0.8837
Epoch 2/70

29/29 [==============================] - 0s 17ms/step - loss: 0.8426 - acc: 0.8199 - val_loss: 0.4669 - val_acc: 0.8837
Epoch 3/70

29/29 [==============================] - 0s 17ms/step - loss: 0.7483 - acc: 0.8199 - val_loss: 1.5004 - val_acc: 0.6047
Epoch 4/70

29/29 [==============================] - 0s 17ms/step - loss: 1.5024 - acc: 0.5788 - val_loss: 0.4708 - val_acc: 0.8837
Manual evaluation: (didn't understand why I made this)
True 7042
False 2029
True percentage 0.776320141109
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.83      0.96      0.89      7318
      B-ORG       0.00      0.00      0.00       296
      I-ORG       0.00      0.00      0.00       151
      B-PER       0.20      0.00      0.00       438
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
      I-PER       0.00      0.00      0.00       214

avg / total       0.68      0.78      0.72      9071

F-1 Score:
0.00113765642776
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100019 unique words.
Found 88 unique chars.
Found 9 unique labels.
15 unique words not found in embedding.
4 unique chars not found in embedding.
Number of OOV: 323
OOV word occurences: 631
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5696        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6401280     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,904,002
Trainable params: 6,904,002
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 14 samples, validate on 2 samples
Epoch 1/70

14/14 [==============================] - 3s 196ms/step - loss: 2.4823 - acc: 0.0249 - val_loss: 0.5470 - val_acc: 0.9333
Epoch 2/70

14/14 [==============================] - 0s 24ms/step - loss: 0.9834 - acc: 0.7829 - val_loss: 0.4180 - val_acc: 0.9333
Epoch 3/70

14/14 [==============================] - 0s 23ms/step - loss: 1.4879 - acc: 0.7829 - val_loss: 1.3728 - val_acc: 0.9000
Epoch 4/70

14/14 [==============================] - 0s 23ms/step - loss: 1.5371 - acc: 0.7224 - val_loss: 0.5892 - val_acc: 0.9333
Manual evaluation: (didn't understand why I made this)
True 7031
False 2040
True percentage 0.775107485393
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.83      0.96      0.89      7318
      B-PER       1.00      0.01      0.01       438
      B-LOC       0.00      0.00      0.00       218
      B-ORG       0.00      0.00      0.00       296
      I-ORG       0.00      0.00      0.00       151
      I-PER       0.00      0.00      0.00       214
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.72      0.78      0.72      9071

F-1 Score:
0.00340715502555
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100033 unique words.
Found 94 unique chars.
Found 9 unique labels.
29 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 324
OOV word occurences: 634
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6402176     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,905,282
Trainable params: 6,905,282
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 14 samples, validate on 2 samples
Epoch 1/70

14/14 [==============================] - 3s 191ms/step - loss: 2.1863 - acc: 0.0844 - val_loss: 0.5394 - val_acc: 0.9000
Epoch 2/70

14/14 [==============================] - 0s 24ms/step - loss: 0.9188 - acc: 0.8047 - val_loss: 0.6320 - val_acc: 0.9000
Epoch 3/70

14/14 [==============================] - 0s 24ms/step - loss: 0.8741 - acc: 0.8074 - val_loss: 1.5089 - val_acc: 0.5667
Manual evaluation: (didn't understand why I made this)
True 5100
False 3971
True percentage 0.562231286517
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.67      0.79      7318
      B-ORG       0.05      0.37      0.09       296
      B-LOC       0.00      0.00      0.00       218
      I-ORG       0.08      0.64      0.14       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-PER       0.00      0.00      0.00       438
      I-PER       0.00      0.00      0.00       214
      I-LOC       0.00      0.00      0.00       141

avg / total       0.79      0.56      0.64      9071

F-1 Score:
0.0800621842208
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100024 unique words.
Found 93 unique chars.
Found 9 unique labels.
20 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 324
OOV word occurences: 560
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6401600     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,904,642
Trainable params: 6,904,642
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 14 samples, validate on 2 samples
Epoch 1/70

14/14 [==============================] - 3s 199ms/step - loss: 2.2305 - acc: 0.0819 - val_loss: 0.6939 - val_acc: 0.8913
Epoch 2/70

14/14 [==============================] - 0s 24ms/step - loss: 0.7303 - acc: 0.8635 - val_loss: 1.4437 - val_acc: 0.8913
Epoch 3/70

14/14 [==============================] - 0s 24ms/step - loss: 1.7887 - acc: 0.8635 - val_loss: 0.6171 - val_acc: 0.8913
Epoch 4/70

14/14 [==============================] - 0s 23ms/step - loss: 0.6645 - acc: 0.8635 - val_loss: 0.5443 - val_acc: 0.8913
Epoch 5/70

14/14 [==============================] - 0s 23ms/step - loss: 0.6387 - acc: 0.8635 - val_loss: 0.5579 - val_acc: 0.8913
Epoch 6/70

14/14 [==============================] - 0s 23ms/step - loss: 0.5854 - acc: 0.8635 - val_loss: 0.4278 - val_acc: 0.8913
Epoch 7/70

14/14 [==============================] - 0s 24ms/step - loss: 0.5108 - acc: 0.8635 - val_loss: 0.4569 - val_acc: 0.8913
Epoch 8/70

14/14 [==============================] - 0s 24ms/step - loss: 0.4865 - acc: 0.8669 - val_loss: 0.3944 - val_acc: 0.8913
Epoch 9/70

14/14 [==============================] - 0s 24ms/step - loss: 0.4284 - acc: 0.8669 - val_loss: 0.3880 - val_acc: 0.8913
Epoch 10/70

14/14 [==============================] - 0s 24ms/step - loss: 0.4118 - acc: 0.8669 - val_loss: 0.3590 - val_acc: 0.8913
Epoch 11/70

14/14 [==============================] - 0s 23ms/step - loss: 0.3666 - acc: 0.8908 - val_loss: 0.3452 - val_acc: 0.8913
Epoch 12/70

14/14 [==============================] - 0s 24ms/step - loss: 0.3204 - acc: 0.8908 - val_loss: 0.3164 - val_acc: 0.8913
Epoch 13/70

14/14 [==============================] - 0s 26ms/step - loss: 0.2781 - acc: 0.9078 - val_loss: 0.3095 - val_acc: 0.8913
Epoch 14/70

14/14 [==============================] - 0s 24ms/step - loss: 0.2472 - acc: 0.9352 - val_loss: 0.3084 - val_acc: 0.8913
Epoch 15/70

14/14 [==============================] - 0s 25ms/step - loss: 0.2340 - acc: 0.9147 - val_loss: 0.5283 - val_acc: 0.8043
Epoch 16/70

14/14 [==============================] - 0s 24ms/step - loss: 0.3828 - acc: 0.9010 - val_loss: 0.4841 - val_acc: 0.8696
Manual evaluation: (didn't understand why I made this)
True 7138
False 1933
True percentage 0.786903318267
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.84      0.96      0.90      7318
      B-PER       0.63      0.13      0.22       438
      B-ORG       0.67      0.19      0.30       296
      I-ORG       0.00      0.00      0.00       151
      I-PER       0.00      0.00      0.00       214
      B-LOC       1.00      0.00      0.01       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.76      0.79      0.74      9071

F-1 Score:
0.11923276309
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100026 unique words.
Found 94 unique chars.
Found 9 unique labels.
22 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 323
OOV word occurences: 627
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6401728     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,904,834
Trainable params: 6,904,834
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 14 samples, validate on 2 samples
Epoch 1/70

14/14 [==============================] - 3s 192ms/step - loss: 2.1403 - acc: 0.1953 - val_loss: 0.9123 - val_acc: 0.8088
Epoch 2/70

14/14 [==============================] - 0s 24ms/step - loss: 0.8848 - acc: 0.7980 - val_loss: 1.0389 - val_acc: 0.8088
Epoch 3/70

14/14 [==============================] - 0s 23ms/step - loss: 0.7615 - acc: 0.7980 - val_loss: 0.9770 - val_acc: 0.8088
Manual evaluation: (didn't understand why I made this)
True 7060
False 2011
True percentage 0.778304486826
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.85      0.96      0.90      7318
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-ORG       0.31      0.03      0.06       296
      I-ORG       0.50      0.01      0.01       151
      B-PER       0.00      0.00      0.00       438
      I-PER       0.00      0.00      0.00       214
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.23      0.21      0.22       141

avg / total       0.71      0.78      0.73      9071

F-1 Score:
0.0426638917794
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100013 unique words.
Found 92 unique chars.
Found 8 unique labels.
9 unique words not found in embedding.
8 unique chars not found in embedding.
Number of OOV: 328
OOV word occurences: 641
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6400896     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 9)        3564        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,903,468
Trainable params: 6,903,468
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 14 samples, validate on 2 samples
Epoch 1/70

14/14 [==============================] - 3s 192ms/step - loss: 2.2138 - acc: 0.0337 - val_loss: 1.3172 - val_acc: 0.5882
Epoch 2/70

14/14 [==============================] - 0s 24ms/step - loss: 0.9854 - acc: 0.7715 - val_loss: 1.3098 - val_acc: 0.5882
Epoch 3/70

14/14 [==============================] - 0s 23ms/step - loss: 1.0223 - acc: 0.7678 - val_loss: 3.1673 - val_acc: 0.5882
Epoch 4/70

14/14 [==============================] - 0s 23ms/step - loss: 1.8362 - acc: 0.7715 - val_loss: 1.2353 - val_acc: 0.5882
Epoch 5/70

14/14 [==============================] - 0s 23ms/step - loss: 0.9483 - acc: 0.7903 - val_loss: 1.2610 - val_acc: 0.5882
Epoch 6/70

14/14 [==============================] - 0s 23ms/step - loss: 0.7292 - acc: 0.7715 - val_loss: 1.1929 - val_acc: 0.5882
Epoch 7/70

14/14 [==============================] - 0s 23ms/step - loss: 0.6656 - acc: 0.7865 - val_loss: 1.1824 - val_acc: 0.5882
Epoch 8/70

14/14 [==============================] - 0s 24ms/step - loss: 0.6223 - acc: 0.7790 - val_loss: 1.1252 - val_acc: 0.5882
Epoch 9/70

14/14 [==============================] - 0s 24ms/step - loss: 0.5554 - acc: 0.7978 - val_loss: 1.1047 - val_acc: 0.5882
Epoch 10/70

14/14 [==============================] - 0s 23ms/step - loss: 0.4975 - acc: 0.8427 - val_loss: 1.0946 - val_acc: 0.5882
Epoch 11/70

14/14 [==============================] - 0s 23ms/step - loss: 0.4602 - acc: 0.8539 - val_loss: 1.2330 - val_acc: 0.6176
Epoch 12/70

14/14 [==============================] - 0s 24ms/step - loss: 0.4634 - acc: 0.8614 - val_loss: 1.0193 - val_acc: 0.5882
Epoch 13/70

14/14 [==============================] - 0s 26ms/step - loss: 0.4290 - acc: 0.8577 - val_loss: 0.9866 - val_acc: 0.5882
Epoch 14/70

14/14 [==============================] - 0s 24ms/step - loss: 0.3415 - acc: 0.9139 - val_loss: 0.9910 - val_acc: 0.5882
Epoch 15/70

14/14 [==============================] - 0s 24ms/step - loss: 0.2952 - acc: 0.9101 - val_loss: 0.9528 - val_acc: 0.5882
Epoch 16/70

14/14 [==============================] - 0s 23ms/step - loss: 0.2639 - acc: 0.9326 - val_loss: 0.9782 - val_acc: 0.5882
Epoch 17/70

14/14 [==============================] - 0s 23ms/step - loss: 0.2312 - acc: 0.9288 - val_loss: 0.8937 - val_acc: 0.6471
Epoch 18/70

14/14 [==============================] - 0s 23ms/step - loss: 0.2191 - acc: 0.9513 - val_loss: 1.2610 - val_acc: 0.6176
Epoch 19/70

14/14 [==============================] - 0s 23ms/step - loss: 0.2394 - acc: 0.8727 - val_loss: 0.9169 - val_acc: 0.6176
Manual evaluation: (didn't understand why I made this)
True 6632
False 2285
True percentage 0.743747897275
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.84      0.90      7318
      B-ORG       0.14      0.52      0.22       296
      B-LOC       0.34      0.51      0.41       218
      B-PER       0.40      0.16      0.22       438
      I-PER       0.67      0.07      0.13       214
     B-MISC       0.00      0.00      0.00       141
      I-ORG       0.16      0.06      0.09       151
      I-LOC       0.28      0.82      0.42       141

avg / total       0.86      0.74      0.78      8917

F-1 Score:
0.256341068538
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100019 unique words.
Found 91 unique chars.
Found 9 unique labels.
15 unique words not found in embedding.
7 unique chars not found in embedding.
Number of OOV: 325
OOV word occurences: 636
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5888        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6401280     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,904,194
Trainable params: 6,904,194
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 14 samples, validate on 2 samples
Epoch 1/70

14/14 [==============================] - 3s 195ms/step - loss: 2.3005 - acc: 0.0445 - val_loss: 1.2813 - val_acc: 0.6757
Epoch 2/70

14/14 [==============================] - 0s 24ms/step - loss: 0.8450 - acc: 0.8421 - val_loss: 4.0507 - val_acc: 0.6757
Epoch 3/70

14/14 [==============================] - 0s 23ms/step - loss: 1.7833 - acc: 0.8421 - val_loss: 1.2796 - val_acc: 0.6757
Epoch 4/70

14/14 [==============================] - 0s 24ms/step - loss: 0.7914 - acc: 0.8462 - val_loss: 1.3206 - val_acc: 0.6757
Epoch 5/70

14/14 [==============================] - 0s 23ms/step - loss: 0.6468 - acc: 0.8421 - val_loss: 1.1774 - val_acc: 0.6757
Epoch 6/70

14/14 [==============================] - 0s 23ms/step - loss: 0.5793 - acc: 0.8421 - val_loss: 1.2099 - val_acc: 0.6757
Epoch 7/70

14/14 [==============================] - 0s 24ms/step - loss: 0.5610 - acc: 0.8421 - val_loss: 1.1550 - val_acc: 0.6757
Epoch 8/70

14/14 [==============================] - 0s 24ms/step - loss: 0.5088 - acc: 0.8421 - val_loss: 1.1448 - val_acc: 0.6757
Epoch 9/70

14/14 [==============================] - 0s 23ms/step - loss: 0.4704 - acc: 0.8421 - val_loss: 1.1063 - val_acc: 0.6757
Epoch 10/70

14/14 [==============================] - 0s 23ms/step - loss: 0.4389 - acc: 0.8502 - val_loss: 1.0937 - val_acc: 0.6757
Epoch 11/70

14/14 [==============================] - 0s 24ms/step - loss: 0.3967 - acc: 0.8502 - val_loss: 1.0429 - val_acc: 0.6757
Epoch 12/70

14/14 [==============================] - 0s 25ms/step - loss: 0.3616 - acc: 0.8866 - val_loss: 1.1123 - val_acc: 0.6757
Epoch 13/70

14/14 [==============================] - 0s 24ms/step - loss: 0.3382 - acc: 0.8543 - val_loss: 1.0100 - val_acc: 0.7027
Epoch 14/70

14/14 [==============================] - 0s 25ms/step - loss: 0.3187 - acc: 0.9109 - val_loss: 1.1089 - val_acc: 0.6757
Epoch 15/70

14/14 [==============================] - 0s 24ms/step - loss: 0.2718 - acc: 0.8907 - val_loss: 0.9560 - val_acc: 0.7027
Epoch 16/70

14/14 [==============================] - 0s 23ms/step - loss: 0.2418 - acc: 0.9514 - val_loss: 1.0442 - val_acc: 0.7027
Epoch 17/70

14/14 [==============================] - 0s 23ms/step - loss: 0.2148 - acc: 0.9231 - val_loss: 0.9157 - val_acc: 0.7027
Epoch 18/70

14/14 [==============================] - 0s 23ms/step - loss: 0.1760 - acc: 0.9676 - val_loss: 1.0102 - val_acc: 0.7027
Epoch 19/70

14/14 [==============================] - 0s 24ms/step - loss: 0.1625 - acc: 0.9433 - val_loss: 0.8861 - val_acc: 0.7297
Epoch 20/70

14/14 [==============================] - 0s 22ms/step - loss: 0.1677 - acc: 0.9717 - val_loss: 1.2058 - val_acc: 0.7027
Epoch 21/70

14/14 [==============================] - 0s 23ms/step - loss: 0.1661 - acc: 0.9271 - val_loss: 0.7705 - val_acc: 0.7568
Epoch 22/70

14/14 [==============================] - 0s 23ms/step - loss: 0.1464 - acc: 0.9919 - val_loss: 0.9542 - val_acc: 0.7027
Epoch 23/70

14/14 [==============================] - 0s 24ms/step - loss: 0.1040 - acc: 0.9879 - val_loss: 0.8623 - val_acc: 0.7568
Manual evaluation: (didn't understand why I made this)
True 7132
False 1939
True percentage 0.786241869695
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.87      0.95      0.91      7318
      B-PER       0.46      0.18      0.26       438
      B-ORG       0.35      0.20      0.26       296
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.22      0.03      0.05       218
      I-LOC       0.00      0.00      0.00       141
      I-ORG       0.30      0.13      0.18       151
      I-PER       0.53      0.04      0.07       214
     B-MISC       0.00      0.00      0.00       141

avg / total       0.76      0.79      0.76      9071

F-1 Score:
0.15666965085
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100031 unique words.
Found 94 unique chars.
Found 9 unique labels.
27 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 324
OOV word occurences: 635
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6402048     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,905,154
Trainable params: 6,905,154
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 14 samples, validate on 2 samples
Epoch 1/70

14/14 [==============================] - 3s 193ms/step - loss: 2.2429 - acc: 0.0726 - val_loss: 1.3160 - val_acc: 0.6047
Epoch 2/70

14/14 [==============================] - 0s 24ms/step - loss: 0.9800 - acc: 0.7792 - val_loss: 1.7536 - val_acc: 0.6047
Epoch 3/70

14/14 [==============================] - 0s 24ms/step - loss: 1.1126 - acc: 0.7792 - val_loss: 1.6970 - val_acc: 0.5581
Manual evaluation: (didn't understand why I made this)
True 6588
False 2483
True percentage 0.726270532466
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.86      0.90      7318
      B-PER       0.38      0.19      0.25       438
      B-LOC       0.32      0.27      0.29       218
      B-ORG       0.10      0.45      0.16       296
      I-PER       0.00      0.00      0.00       214
     B-MISC       0.00      0.00      0.00       141
     I-MISC       1.00      0.01      0.01       154
      I-LOC       0.00      0.00      0.00       141
      I-ORG       0.17      0.03      0.05       151

avg / total       0.81      0.73      0.75      9071

F-1 Score:
0.157864849517
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100032 unique words.
Found 94 unique chars.
Found 9 unique labels.
28 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 321
OOV word occurences: 533
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6402112     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,905,218
Trainable params: 6,905,218
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 14 samples, validate on 2 samples
Epoch 1/70

14/14 [==============================] - 3s 193ms/step - loss: 2.2534 - acc: 0.0528 - val_loss: 0.9428 - val_acc: 0.7903
Epoch 2/70

14/14 [==============================] - 0s 24ms/step - loss: 0.9320 - acc: 0.7923 - val_loss: 1.5702 - val_acc: 0.7903
Epoch 3/70

14/14 [==============================] - 0s 24ms/step - loss: 1.3212 - acc: 0.7923 - val_loss: 1.5369 - val_acc: 0.7742
Manual evaluation: (didn't understand why I made this)
True 6912
False 2159
True percentage 0.761988755374
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.89      0.92      0.90      7318
      B-ORG       0.15      0.39      0.22       296
      I-ORG       0.00      0.00      0.00       151
      B-PER       0.43      0.19      0.26       438
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
      I-PER       0.00      0.00      0.00       214
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.74      0.76      0.75      9071

F-1 Score:
0.143690736689
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100034 unique words.
Found 91 unique chars.
Found 9 unique labels.
30 unique words not found in embedding.
7 unique chars not found in embedding.
Number of OOV: 324
OOV word occurences: 605
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5888        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6402240     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,905,154
Trainable params: 6,905,154
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 14 samples, validate on 2 samples
Epoch 1/70

14/14 [==============================] - 3s 194ms/step - loss: 2.2707 - acc: 0.0761 - val_loss: 1.2514 - val_acc: 0.7500
Epoch 2/70

14/14 [==============================] - 0s 24ms/step - loss: 0.9546 - acc: 0.7887 - val_loss: 2.0664 - val_acc: 0.7500
Epoch 3/70

14/14 [==============================] - 0s 24ms/step - loss: 2.0566 - acc: 0.7887 - val_loss: 1.4647 - val_acc: 0.7500
Manual evaluation: (didn't understand why I made this)
True 7035
False 2036
True percentage 0.775548451108
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.85      0.95      0.90      7318
      B-ORG       0.11      0.08      0.09       296
      I-ORG       0.00      0.00      0.00       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-PER       0.43      0.04      0.07       438
      B-LOC       0.50      0.01      0.02       218
      I-LOC       0.18      0.02      0.04       141
      I-PER       0.00      0.00      0.00       214

avg / total       0.73      0.78      0.74      9071

F-1 Score:
0.0459657701711
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100021 unique words.
Found 94 unique chars.
Found 9 unique labels.
17 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 322
OOV word occurences: 624
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6401408     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,904,514
Trainable params: 6,904,514
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 14 samples, validate on 2 samples
Epoch 1/70

14/14 [==============================] - 3s 193ms/step - loss: 2.5159 - acc: 0.0214 - val_loss: 1.1058 - val_acc: 0.7500
Epoch 2/70

14/14 [==============================] - 0s 24ms/step - loss: 0.9038 - acc: 0.8000 - val_loss: 1.0194 - val_acc: 0.7500
Epoch 3/70

14/14 [==============================] - 0s 23ms/step - loss: 0.7553 - acc: 0.8000 - val_loss: 1.1318 - val_acc: 0.7500
Epoch 4/70

14/14 [==============================] - 0s 23ms/step - loss: 0.7655 - acc: 0.8000 - val_loss: 1.4792 - val_acc: 0.6923
Manual evaluation: (didn't understand why I made this)
True 6900
False 2171
True percentage 0.76066585823
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.25      0.28      0.26       438
          O       0.96      0.90      0.93      7318
      B-ORG       0.19      0.52      0.28       296
     B-MISC       0.00      0.00      0.00       141
      B-LOC       0.42      0.14      0.21       218
      I-LOC       0.00      0.00      0.00       141
     I-MISC       0.10      0.16      0.12       154
      I-PER       0.56      0.02      0.04       214
      I-ORG       0.04      0.01      0.01       151

avg / total       0.82      0.76      0.78      9071

F-1 Score:
0.816823330923
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100026 unique words.
Found 90 unique chars.
Found 9 unique labels.
22 unique words not found in embedding.
6 unique chars not found in embedding.
Number of OOV: 327
OOV word occurences: 632
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 58, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5824        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 58)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 58, 64)       6401728     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 58, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 58, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 58, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 58, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 58, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,904,578
Trainable params: 6,904,578
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 14 samples, validate on 2 samples
Epoch 1/70

14/14 [==============================] - 3s 195ms/step - loss: 2.2610 - acc: 0.0365 - val_loss: 0.5928 - val_acc: 0.9286
Epoch 2/70

14/14 [==============================] - 0s 24ms/step - loss: 0.9764 - acc: 0.7508 - val_loss: 0.8398 - val_acc: 0.9286
Epoch 3/70

14/14 [==============================] - 0s 24ms/step - loss: 2.6305 - acc: 0.7508 - val_loss: 1.4558 - val_acc: 0.5357
Manual evaluation: (didn't understand why I made this)
True 5312
False 3759
True percentage 0.585602469408
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.82      0.02      0.04       438
          O       0.97      0.70      0.81      7318
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
      I-PER       0.00      0.00      0.00       214
      B-ORG       0.07      0.70      0.12       296
      I-ORG       0.00      0.00      0.00       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.82      0.59      0.66      9071

F-1 Score:
0.621688159437
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100030 unique words.
Found 92 unique chars.
Found 7 unique labels.
26 unique words not found in embedding.
8 unique chars not found in embedding.
Number of OOV: 325
OOV word occurences: 632
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6401984     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 8)        3160        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,904,152
Trainable params: 6,904,152
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 14 samples, validate on 2 samples
Epoch 1/70

14/14 [==============================] - 3s 235ms/step - loss: 2.2575 - acc: 0.0141 - val_loss: 1.2888 - val_acc: 0.7442
Epoch 2/70

14/14 [==============================] - 0s 24ms/step - loss: 0.9522 - acc: 0.8099 - val_loss: 2.5886 - val_acc: 0.7442
Epoch 3/70

14/14 [==============================] - 0s 23ms/step - loss: 1.9330 - acc: 0.8099 - val_loss: 1.4141 - val_acc: 0.7442
Manual evaluation: (didn't understand why I made this)
True 6988
False 1728
True percentage 0.801743919229
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.86      0.95      0.90      7318
      B-ORG       0.00      0.00      0.00       296
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.02      0.01      0.02       154
      B-PER       0.30      0.04      0.07       438
      B-LOC       0.00      0.00      0.00       218
      I-ORG       0.17      0.25      0.20       151

avg / total       0.74      0.80      0.76      8716

F-1 Score:
0.0626748740907
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100028 unique words.
Found 92 unique chars.
Found 9 unique labels.
24 unique words not found in embedding.
8 unique chars not found in embedding.
Number of OOV: 325
OOV word occurences: 630
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6401856     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,904,834
Trainable params: 6,904,834
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 14 samples, validate on 2 samples
Epoch 1/70

14/14 [==============================] - 3s 192ms/step - loss: 2.6313 - acc: 0.0000e+00 - val_loss: 0.8358 - val_acc: 0.8333
Epoch 2/70

14/14 [==============================] - 0s 24ms/step - loss: 0.8238 - acc: 0.8207 - val_loss: 1.4299 - val_acc: 0.8333
Epoch 3/70

14/14 [==============================] - 0s 23ms/step - loss: 1.4465 - acc: 0.8207 - val_loss: 1.5767 - val_acc: 0.6667
Manual evaluation: (didn't understand why I made this)
True 5979
False 3092
True percentage 0.65913350237
Sklearn evaluation:
             precision    recall  f1-score   support

     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
          O       0.97      0.79      0.87      7318
      B-PER       0.50      0.00      0.00       438
      I-PER       0.00      0.00      0.00       214
      B-ORG       0.08      0.69      0.15       296
      B-LOC       0.00      0.00      0.00       218
      I-ORG       0.00      0.00      0.00       151
      I-LOC       0.00      0.00      0.00       141

avg / total       0.81      0.66      0.71      9071

F-1 Score:
0.6883886938
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100028 unique words.
Found 94 unique chars.
Found 9 unique labels.
24 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 326
OOV word occurences: 635
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 67, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 67)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 67, 64)       6401856     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 67, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 67, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 67, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 67, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 67, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,904,962
Trainable params: 6,904,962
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 14 samples, validate on 2 samples
Epoch 1/70

14/14 [==============================] - 3s 198ms/step - loss: 2.4473 - acc: 0.0087 - val_loss: 0.8563 - val_acc: 0.7556
Epoch 2/70

14/14 [==============================] - 0s 27ms/step - loss: 0.9537 - acc: 0.7784 - val_loss: 1.9729 - val_acc: 0.7556
Epoch 3/70

14/14 [==============================] - 0s 27ms/step - loss: 1.7333 - acc: 0.7784 - val_loss: 1.6822 - val_acc: 0.4222
Manual evaluation: (didn't understand why I made this)
True 3735
False 5336
True percentage 0.411751736303
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.99      0.48      0.65      7318
      B-PER       0.25      0.00      0.01       438
      B-ORG       0.04      0.72      0.08       296
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.10      0.01      0.01       154
      I-ORG       0.00      0.00      0.00       151
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
      I-PER       0.00      0.00      0.00       214

avg / total       0.81      0.41      0.53      9071

F-1 Score:
0.0655391120507
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100023 unique words.
Found 93 unique chars.
Found 9 unique labels.
19 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 325
OOV word occurences: 627
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6401536     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,904,578
Trainable params: 6,904,578
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 14 samples, validate on 2 samples
Epoch 1/70

14/14 [==============================] - 3s 226ms/step - loss: 2.1850 - acc: 0.0853 - val_loss: 1.1699 - val_acc: 0.7500
Epoch 2/70

14/14 [==============================] - 0s 24ms/step - loss: 1.0812 - acc: 0.8055 - val_loss: 2.4581 - val_acc: 0.7500
Epoch 3/70

14/14 [==============================] - 0s 23ms/step - loss: 2.2479 - acc: 0.8055 - val_loss: 1.1561 - val_acc: 0.7812
Epoch 4/70

14/14 [==============================] - 0s 24ms/step - loss: 1.0172 - acc: 0.8191 - val_loss: 0.9243 - val_acc: 0.7500
Epoch 5/70

14/14 [==============================] - 0s 23ms/step - loss: 0.7339 - acc: 0.8055 - val_loss: 0.8992 - val_acc: 0.7500
Epoch 6/70

14/14 [==============================] - 0s 23ms/step - loss: 0.6698 - acc: 0.8123 - val_loss: 0.8954 - val_acc: 0.7500
Epoch 7/70

14/14 [==============================] - 0s 23ms/step - loss: 0.6101 - acc: 0.8089 - val_loss: 0.8509 - val_acc: 0.7500
Epoch 8/70

14/14 [==============================] - 0s 23ms/step - loss: 0.5793 - acc: 0.8225 - val_loss: 0.8524 - val_acc: 0.7500
Epoch 9/70

14/14 [==============================] - 0s 24ms/step - loss: 0.5267 - acc: 0.8089 - val_loss: 0.8030 - val_acc: 0.7812
Epoch 10/70

14/14 [==============================] - 0s 24ms/step - loss: 0.4615 - acc: 0.8464 - val_loss: 0.8043 - val_acc: 0.7812
Epoch 11/70

14/14 [==============================] - 0s 24ms/step - loss: 0.4235 - acc: 0.8532 - val_loss: 0.7618 - val_acc: 0.7812
Epoch 12/70

14/14 [==============================] - 0s 23ms/step - loss: 0.3860 - acc: 0.8840 - val_loss: 0.7616 - val_acc: 0.7812
Epoch 13/70

14/14 [==============================] - 0s 24ms/step - loss: 0.3253 - acc: 0.8908 - val_loss: 0.7427 - val_acc: 0.7812
Epoch 14/70

14/14 [==============================] - 0s 24ms/step - loss: 0.2884 - acc: 0.9078 - val_loss: 0.7946 - val_acc: 0.7812
Epoch 15/70

14/14 [==============================] - 0s 25ms/step - loss: 0.2567 - acc: 0.9113 - val_loss: 0.7571 - val_acc: 0.7812
Manual evaluation: (didn't understand why I made this)
True 7002
False 2069
True percentage 0.77191048396
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.88      0.94      0.91      7318
      B-ORG       0.20      0.06      0.09       296
      I-ORG       0.00      0.00      0.00       151
      B-PER       0.49      0.12      0.19       438
     B-MISC       0.11      0.02      0.04       141
     I-MISC       0.08      0.19      0.11       154
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
      I-PER       0.00      0.00      0.00       214

avg / total       0.74      0.77      0.75      9071

F-1 Score:
0.0872142252329
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100013 unique words.
Found 84 unique chars.
Found 8 unique labels.
9 unique words not found in embedding.
0 unique chars not found in embedding.
Number of OOV: 328
OOV word occurences: 641
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5440        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6400896     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 9)        3564        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,902,956
Trainable params: 6,902,956
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 7 samples, validate on 1 samples
Epoch 1/70

7/7 [==============================] - 3s 377ms/step - loss: 2.0429 - acc: 0.2698 - val_loss: 0.7381 - val_acc: 0.8276
Epoch 2/70

7/7 [==============================] - 0s 38ms/step - loss: 1.0133 - acc: 0.7698 - val_loss: 1.1353 - val_acc: 0.8276
Epoch 3/70

7/7 [==============================] - 0s 35ms/step - loss: 0.9390 - acc: 0.7698 - val_loss: 1.5869 - val_acc: 0.4138
Manual evaluation: (didn't understand why I made this)
True 3104
False 5813
True percentage 0.348099136481
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.40      0.57      7318
      B-PER       0.53      0.08      0.14       438
      B-LOC       0.18      0.13      0.15       218
      B-ORG       0.00      0.00      0.00       296
      I-ORG       0.02      0.82      0.05       151
      I-PER       0.00      0.00      0.00       214
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141

avg / total       0.83      0.35      0.48      8917

F-1 Score:
0.0532460136674
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100018 unique words.
Found 92 unique chars.
Found 9 unique labels.
14 unique words not found in embedding.
8 unique chars not found in embedding.
Number of OOV: 325
OOV word occurences: 635
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6401216     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,904,194
Trainable params: 6,904,194
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 7 samples, validate on 1 samples
Epoch 1/70

7/7 [==============================] - 3s 368ms/step - loss: 2.1666 - acc: 0.1049 - val_loss: 0.8117 - val_acc: 0.8421
Epoch 2/70

7/7 [==============================] - 0s 35ms/step - loss: 0.8676 - acc: 0.7963 - val_loss: 1.3406 - val_acc: 0.8421
Epoch 3/70

7/7 [==============================] - 0s 37ms/step - loss: 0.9970 - acc: 0.7963 - val_loss: 1.5011 - val_acc: 0.6842
Manual evaluation: (didn't understand why I made this)
True 6078
False 2993
True percentage 0.670047403814
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.80      0.88      7318
      B-ORG       0.09      0.47      0.14       296
      B-LOC       0.00      0.00      0.00       218
      I-ORG       0.10      0.50      0.17       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-PER       0.00      0.00      0.00       438
      I-PER       0.00      0.00      0.00       214
      I-LOC       0.00      0.00      0.00       141

avg / total       0.78      0.67      0.71      9071

F-1 Score:
0.104343605921
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100016 unique words.
Found 91 unique chars.
Found 9 unique labels.
12 unique words not found in embedding.
7 unique chars not found in embedding.
Number of OOV: 324
OOV word occurences: 560
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5888        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6401088     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,904,002
Trainable params: 6,904,002
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 7 samples, validate on 1 samples
Epoch 1/70

7/7 [==============================] - 3s 372ms/step - loss: 2.2937 - acc: 0.0556 - val_loss: 0.5027 - val_acc: 0.9259
Epoch 2/70

7/7 [==============================] - 0s 35ms/step - loss: 0.7724 - acc: 0.8403 - val_loss: 0.6427 - val_acc: 0.9259
Epoch 3/70

7/7 [==============================] - 0s 36ms/step - loss: 1.3041 - acc: 0.8403 - val_loss: 1.1748 - val_acc: 0.9259
Manual evaluation: (didn't understand why I made this)
True 6724
False 2347
True percentage 0.741263366773
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.87      0.91      7318
      B-PER       0.22      0.61      0.32       438
      B-ORG       0.00      0.00      0.00       296
      I-ORG       0.00      0.00      0.00       151
      I-PER       0.00      0.00      0.00       214
      B-LOC       0.18      0.53      0.27       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.78      0.74      0.75      9071

F-1 Score:
0.212070874862
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100015 unique words.
Found 94 unique chars.
Found 9 unique labels.
11 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 326
OOV word occurences: 631
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6401024     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,904,130
Trainable params: 6,904,130
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 7 samples, validate on 1 samples
Epoch 1/70

7/7 [==============================] - 3s 373ms/step - loss: 2.4035 - acc: 0.0000e+00 - val_loss: 1.5744 - val_acc: 0.6364
Epoch 2/70

7/7 [==============================] - 0s 36ms/step - loss: 0.9622 - acc: 0.7919 - val_loss: 5.8612 - val_acc: 0.6364
Epoch 3/70

7/7 [==============================] - 0s 37ms/step - loss: 2.6898 - acc: 0.7919 - val_loss: 1.9984 - val_acc: 0.6364
Manual evaluation: (didn't understand why I made this)
True 7028
False 2043
True percentage 0.774776761107
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.83      0.96      0.89      7318
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-ORG       0.00      0.00      0.00       296
      I-ORG       0.10      0.01      0.01       151
      B-PER       0.00      0.00      0.00       438
      I-PER       0.33      0.00      0.01       214
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141

avg / total       0.68      0.77      0.72      9071

F-1 Score:
0.00270486876377
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100009 unique words.
Found 92 unique chars.
Found 8 unique labels.
5 unique words not found in embedding.
8 unique chars not found in embedding.
Number of OOV: 328
OOV word occurences: 641
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6400640     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 9)        3564        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,903,212
Trainable params: 6,903,212
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 7 samples, validate on 1 samples
Epoch 1/70

7/7 [==============================] - 3s 381ms/step - loss: 2.2987 - acc: 0.0256 - val_loss: 1.3220 - val_acc: 0.6842
Epoch 2/70

7/7 [==============================] - 0s 37ms/step - loss: 1.1179 - acc: 0.7521 - val_loss: 3.4080 - val_acc: 0.6842
Epoch 3/70

7/7 [==============================] - 0s 37ms/step - loss: 2.9382 - acc: 0.7521 - val_loss: 1.2751 - val_acc: 0.5789
Epoch 4/70

7/7 [==============================] - 0s 35ms/step - loss: 1.2654 - acc: 0.6752 - val_loss: 0.9109 - val_acc: 0.6842
Epoch 5/70

7/7 [==============================] - 0s 37ms/step - loss: 0.7851 - acc: 0.7521 - val_loss: 0.8354 - val_acc: 0.6842
Epoch 6/70

7/7 [==============================] - 0s 36ms/step - loss: 0.7269 - acc: 0.7521 - val_loss: 0.7623 - val_acc: 0.6842
Epoch 7/70

7/7 [==============================] - 0s 35ms/step - loss: 0.6631 - acc: 0.7949 - val_loss: 0.7266 - val_acc: 0.6842
Epoch 8/70

7/7 [==============================] - 0s 38ms/step - loss: 0.6279 - acc: 0.8205 - val_loss: 0.7098 - val_acc: 0.6842
Epoch 9/70

7/7 [==============================] - 0s 37ms/step - loss: 0.5774 - acc: 0.8120 - val_loss: 0.6136 - val_acc: 0.7368
Epoch 10/70

7/7 [==============================] - 0s 38ms/step - loss: 0.5461 - acc: 0.8547 - val_loss: 0.6910 - val_acc: 0.6842
Epoch 11/70

7/7 [==============================] - 0s 38ms/step - loss: 0.4753 - acc: 0.8376 - val_loss: 0.5917 - val_acc: 0.8421
Epoch 12/70

7/7 [==============================] - 0s 35ms/step - loss: 0.4832 - acc: 0.8974 - val_loss: 0.7122 - val_acc: 0.6842
Epoch 13/70

7/7 [==============================] - 0s 37ms/step - loss: 0.3842 - acc: 0.8547 - val_loss: 0.5243 - val_acc: 0.8421
Epoch 14/70

7/7 [==============================] - 0s 37ms/step - loss: 0.3537 - acc: 0.9316 - val_loss: 0.5639 - val_acc: 0.7368
Epoch 15/70

7/7 [==============================] - 0s 35ms/step - loss: 0.3197 - acc: 0.8803 - val_loss: 0.4402 - val_acc: 0.8947
Epoch 16/70

7/7 [==============================] - 0s 37ms/step - loss: 0.2815 - acc: 0.9402 - val_loss: 0.7449 - val_acc: 0.7368
Epoch 17/70

7/7 [==============================] - 0s 38ms/step - loss: 0.2266 - acc: 0.9316 - val_loss: 0.3231 - val_acc: 0.9474
Epoch 18/70

7/7 [==============================] - 0s 40ms/step - loss: 0.2255 - acc: 0.9316 - val_loss: 0.7962 - val_acc: 0.6842
Epoch 19/70

7/7 [==============================] - 0s 39ms/step - loss: 0.2046 - acc: 0.9402 - val_loss: 0.3366 - val_acc: 0.8947
Manual evaluation: (didn't understand why I made this)
True 7127
False 1790
True percentage 0.799259840754
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.90      0.94      0.92      7318
      B-ORG       0.50      0.02      0.04       296
      B-LOC       0.28      0.55      0.37       218
      B-PER       0.38      0.05      0.10       438
      I-PER       0.17      0.01      0.02       214
     B-MISC       0.09      0.02      0.03       141
      I-ORG       0.50      0.01      0.01       151
      I-LOC       0.34      0.59      0.43       141

avg / total       0.80      0.80      0.78      8917

F-1 Score:
0.200419287212
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100014 unique words.
Found 91 unique chars.
Found 8 unique labels.
10 unique words not found in embedding.
7 unique chars not found in embedding.
Number of OOV: 325
OOV word occurences: 636
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5888        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6400960     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 9)        3564        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,903,468
Trainable params: 6,903,468
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 7 samples, validate on 1 samples
Epoch 1/70

7/7 [==============================] - 3s 370ms/step - loss: 2.2049 - acc: 0.0000e+00 - val_loss: 1.0538 - val_acc: 0.7895
Epoch 2/70

7/7 [==============================] - 0s 37ms/step - loss: 0.9185 - acc: 0.8760 - val_loss: 3.3541 - val_acc: 0.7895
Epoch 3/70

7/7 [==============================] - 0s 36ms/step - loss: 1.3789 - acc: 0.8760 - val_loss: 1.0972 - val_acc: 0.7895
Manual evaluation: (didn't understand why I made this)
True 7031
False 1899
True percentage 0.787346024636
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.83      0.96      0.89      7318
      B-PER       0.00      0.00      0.00       438
      B-ORG       0.00      0.00      0.00       296
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
      I-ORG       0.00      0.00      0.00       151
      I-PER       0.00      0.00      0.00       214

avg / total       0.68      0.79      0.73      8930

F-1 Score:
0.0
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100015 unique words.
Found 91 unique chars.
Found 9 unique labels.
11 unique words not found in embedding.
7 unique chars not found in embedding.
Number of OOV: 327
OOV word occurences: 638
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5888        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6401024     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,903,938
Trainable params: 6,903,938
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 7 samples, validate on 1 samples
Epoch 1/70

7/7 [==============================] - 3s 372ms/step - loss: 2.3346 - acc: 0.0458 - val_loss: 1.1524 - val_acc: 0.7200
Epoch 2/70

7/7 [==============================] - 0s 36ms/step - loss: 1.1541 - acc: 0.7124 - val_loss: 3.9180 - val_acc: 0.7200
Epoch 3/70

7/7 [==============================] - 0s 37ms/step - loss: 3.6298 - acc: 0.7124 - val_loss: 1.4142 - val_acc: 0.6800
Manual evaluation: (didn't understand why I made this)
True 7013
False 2058
True percentage 0.773123139676
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.85      0.95      0.90      7318
      B-PER       0.57      0.05      0.09       438
      B-LOC       0.00      0.00      0.00       218
      B-ORG       0.00      0.00      0.00       296
      I-PER       0.00      0.00      0.00       214
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.10      0.05      0.07       154
      I-LOC       0.00      0.00      0.00       141
      I-ORG       0.18      0.19      0.18       151

avg / total       0.72      0.77      0.73      9071

F-1 Score:
0.0559646539028
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100021 unique words.
Found 91 unique chars.
Found 8 unique labels.
17 unique words not found in embedding.
7 unique chars not found in embedding.
Number of OOV: 323
OOV word occurences: 543
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5888        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6401408     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 9)        3564        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,903,916
Trainable params: 6,903,916
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 7 samples, validate on 1 samples
Epoch 1/70

7/7 [==============================] - 3s 370ms/step - loss: 2.0360 - acc: 0.2642 - val_loss: 1.5108 - val_acc: 0.6552
Epoch 2/70

7/7 [==============================] - 0s 36ms/step - loss: 0.9043 - acc: 0.8113 - val_loss: 1.9799 - val_acc: 0.6552
Epoch 3/70

7/7 [==============================] - 0s 36ms/step - loss: 0.8117 - acc: 0.8113 - val_loss: 1.8503 - val_acc: 0.3103
Manual evaluation: (didn't understand why I made this)
True 5290
False 3627
True percentage 0.59324885051
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.70      0.81      7318
      B-ORG       0.50      0.00      0.01       296
      I-ORG       0.04      0.82      0.08       151
      B-PER       0.52      0.03      0.06       438
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
      I-PER       0.00      0.00      0.00       214
     B-MISC       0.00      0.00      0.00       141

avg / total       0.83      0.59      0.67      8917

F-1 Score:
0.0578737680856
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100019 unique words.
Found 91 unique chars.
Found 9 unique labels.
15 unique words not found in embedding.
7 unique chars not found in embedding.
Number of OOV: 326
OOV word occurences: 637
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5888        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6401280     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,904,194
Trainable params: 6,904,194
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 7 samples, validate on 1 samples
Epoch 1/70

7/7 [==============================] - 3s 375ms/step - loss: 2.6583 - acc: 0.0123 - val_loss: 1.0640 - val_acc: 0.8333
Epoch 2/70

7/7 [==============================] - 0s 40ms/step - loss: 0.9856 - acc: 0.7914 - val_loss: 1.6957 - val_acc: 0.8333
Epoch 3/70

7/7 [==============================] - 0s 39ms/step - loss: 2.5652 - acc: 0.7975 - val_loss: 1.6517 - val_acc: 0.2778
Manual evaluation: (didn't understand why I made this)
True 4009
False 5062
True percentage 0.441957887774
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.52      0.68      7318
      B-ORG       0.00      0.00      0.00       296
      I-ORG       0.00      0.00      0.00       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-PER       0.00      0.00      0.00       438
      B-LOC       0.04      0.92      0.08       218
      I-LOC       0.05      0.01      0.02       141
      I-PER       0.00      0.00      0.00       214

avg / total       0.80      0.44      0.55      9071

F-1 Score:
0.0639746634996
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100012 unique words.
Found 89 unique chars.
Found 9 unique labels.
8 unique words not found in embedding.
5 unique chars not found in embedding.
Number of OOV: 324
OOV word occurences: 628
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5760        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6400832     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,903,618
Trainable params: 6,903,618
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 7 samples, validate on 1 samples
Epoch 1/70

7/7 [==============================] - 3s 371ms/step - loss: 2.3981 - acc: 0.0312 - val_loss: 1.3311 - val_acc: 0.6667
Epoch 2/70

7/7 [==============================] - 0s 36ms/step - loss: 1.0127 - acc: 0.8047 - val_loss: 4.5830 - val_acc: 0.6667
Epoch 3/70

7/7 [==============================] - 0s 37ms/step - loss: 2.2754 - acc: 0.8047 - val_loss: 1.5104 - val_acc: 0.7222
Manual evaluation: (didn't understand why I made this)
True 7016
False 2055
True percentage 0.773453863962
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.00      0.00      0.00       438
          O       0.86      0.95      0.90      7318
      B-ORG       0.27      0.14      0.18       296
     B-MISC       0.00      0.00      0.00       141
      B-LOC       0.13      0.12      0.13       218
      I-LOC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      I-PER       0.00      0.00      0.00       214
      I-ORG       0.00      0.00      0.00       151

avg / total       0.71      0.77      0.74      9071

F-1 Score:
0.82173811197
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100018 unique words.
Found 88 unique chars.
Found 9 unique labels.
14 unique words not found in embedding.
4 unique chars not found in embedding.
Number of OOV: 327
OOV word occurences: 632
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Padded until 24 chars.
Padded until 58 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 58, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5696        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 58)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 58, 64)       6401216     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 58, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 58, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 58, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 58, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 58, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,903,938
Trainable params: 6,903,938
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 7 samples, validate on 1 samples
Epoch 1/70

7/7 [==============================] - 3s 367ms/step - loss: 2.1623 - acc: 0.3488 - val_loss: 1.3151 - val_acc: 0.6471
Epoch 2/70

7/7 [==============================] - 0s 37ms/step - loss: 1.1093 - acc: 0.6860 - val_loss: 1.3380 - val_acc: 0.6471
Epoch 3/70

7/7 [==============================] - 0s 36ms/step - loss: 1.2516 - acc: 0.5814 - val_loss: 1.2576 - val_acc: 0.6471
Epoch 4/70

7/7 [==============================] - 0s 35ms/step - loss: 0.8888 - acc: 0.6860 - val_loss: 1.1827 - val_acc: 0.6471
Epoch 5/70

7/7 [==============================] - 0s 37ms/step - loss: 0.8086 - acc: 0.8372 - val_loss: 1.0566 - val_acc: 0.7059
Epoch 6/70

7/7 [==============================] - 0s 38ms/step - loss: 0.6498 - acc: 0.7907 - val_loss: 1.4059 - val_acc: 0.6471
Epoch 7/70

7/7 [==============================] - 0s 37ms/step - loss: 0.6085 - acc: 0.8430 - val_loss: 0.9144 - val_acc: 0.7059
Epoch 8/70

7/7 [==============================] - 0s 35ms/step - loss: 0.4845 - acc: 0.8430 - val_loss: 1.0931 - val_acc: 0.6471
Epoch 9/70

7/7 [==============================] - 0s 38ms/step - loss: 0.3872 - acc: 0.8953 - val_loss: 1.1327 - val_acc: 0.6471
Manual evaluation: (didn't understand why I made this)
True 7077
False 1994
True percentage 0.780178591115
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.42      0.16      0.23       438
          O       0.87      0.94      0.91      7318
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
      I-PER       0.40      0.01      0.02       214
      B-ORG       0.28      0.26      0.27       296
      I-ORG       0.21      0.10      0.13       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.75      0.78      0.75      9071

F-1 Score:
0.829025962505
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100015 unique words.
Found 92 unique chars.
Found 7 unique labels.
11 unique words not found in embedding.
8 unique chars not found in embedding.
Number of OOV: 325
OOV word occurences: 632
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6401024     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 8)        3160        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,903,192
Trainable params: 6,903,192
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 7 samples, validate on 1 samples
Epoch 1/70

7/7 [==============================] - 3s 376ms/step - loss: 1.8453 - acc: 0.2593 - val_loss: 0.6497 - val_acc: 0.9583
Epoch 2/70

7/7 [==============================] - 0s 36ms/step - loss: 0.8694 - acc: 0.8000 - val_loss: 0.3114 - val_acc: 0.9583
Epoch 3/70

7/7 [==============================] - 0s 35ms/step - loss: 0.9700 - acc: 0.8000 - val_loss: 1.5649 - val_acc: 0.4583
Epoch 4/70

7/7 [==============================] - 0s 35ms/step - loss: 1.4304 - acc: 0.4593 - val_loss: 0.7919 - val_acc: 0.9583
Manual evaluation: (didn't understand why I made this)
True 7033
False 1683
True percentage 0.806906837999
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.84      0.96      0.89      7318
      B-ORG       0.00      0.00      0.00       296
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-PER       0.30      0.01      0.03       438
      B-LOC       0.00      0.00      0.00       218
      I-ORG       0.00      0.00      0.00       151

avg / total       0.72      0.81      0.75      8716

F-1 Score:
0.00842696629213
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100015 unique words.
Found 88 unique chars.
Found 7 unique labels.
11 unique words not found in embedding.
4 unique chars not found in embedding.
Number of OOV: 326
OOV word occurences: 631
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5696        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6401024     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 8)        3160        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,902,936
Trainable params: 6,902,936
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 7 samples, validate on 1 samples
Epoch 1/70

7/7 [==============================] - 3s 374ms/step - loss: 1.8452 - acc: 0.3716 - val_loss: 0.9244 - val_acc: 0.7692
Epoch 2/70

7/7 [==============================] - 0s 36ms/step - loss: 0.6444 - acc: 0.8581 - val_loss: 2.1447 - val_acc: 0.7692
Epoch 3/70

7/7 [==============================] - 0s 36ms/step - loss: 1.4538 - acc: 0.8581 - val_loss: 1.1471 - val_acc: 0.7692
Manual evaluation: (didn't understand why I made this)
True 6743
False 2036
True percentage 0.768082925162
Sklearn evaluation:
             precision    recall  f1-score   support

     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.09      0.55      0.15       154
          O       0.89      0.91      0.90      7318
      B-PER       0.00      0.00      0.00       438
      I-PER       0.00      0.00      0.00       214
      B-ORG       0.00      0.00      0.00       296
      B-LOC       0.00      0.00      0.00       218

avg / total       0.74      0.77      0.75      8779

F-1 Score:
0.789670921654
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100016 unique words.
Found 91 unique chars.
Found 9 unique labels.
12 unique words not found in embedding.
7 unique chars not found in embedding.
Number of OOV: 326
OOV word occurences: 635
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Padded until 24 chars.
Padded until 67 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 67, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5888        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 67)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 67, 64)       6401088     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 67, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 67, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 67, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 67, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 67, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,904,002
Trainable params: 6,904,002
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 7 samples, validate on 1 samples
Epoch 1/70

7/7 [==============================] - 3s 380ms/step - loss: 2.3486 - acc: 0.0380 - val_loss: 1.3488 - val_acc: 0.6538
Epoch 2/70

7/7 [==============================] - 0s 40ms/step - loss: 0.9838 - acc: 0.7663 - val_loss: 1.4755 - val_acc: 0.6538
Epoch 3/70

7/7 [==============================] - 0s 40ms/step - loss: 0.8869 - acc: 0.7880 - val_loss: 3.2561 - val_acc: 0.6538
Manual evaluation: (didn't understand why I made this)
True 7029
False 2042
True percentage 0.774887002536
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.83      0.96      0.89      7318
      B-PER       0.00      0.00      0.00       438
      B-ORG       0.00      0.00      0.00       296
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      I-ORG       0.00      0.00      0.00       151
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
      I-PER       0.00      0.00      0.00       214

avg / total       0.67      0.77      0.72      9071

F-1 Score:
0.0
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Found 100004 word vectors.
Found 84 char vectors.
Found 100018 unique words.
Found 91 unique chars.
Found 9 unique labels.
14 unique words not found in embedding.
7 unique chars not found in embedding.
Number of OOV: 326
OOV word occurences: 636
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Padded until 24 chars.
Padded until 57 tokens.
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 57, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5888        input_2[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 57)           0                                            
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           dropout_2[0][0]                  
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 57, 64)       6401216     input_1[0][0]                    
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 128)          49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 57, 64)       0           embedding_1[0][0]                
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 57, 128)      0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 57, 192)      0           dropout_1[0][0]                  
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 57, 384)      443520      concatenate_1[0][0]              
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 57, 10)       3970        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,904,130
Trainable params: 6,904,130
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 7 samples, validate on 1 samples
Epoch 1/70

7/7 [==============================] - 3s 373ms/step - loss: 2.3367 - acc: 0.0199 - val_loss: 0.5593 - val_acc: 0.9200
Epoch 2/70

7/7 [==============================] - 0s 38ms/step - loss: 0.9487 - acc: 0.7748 - val_loss: 0.3917 - val_acc: 0.9200
Epoch 3/70

7/7 [==============================] - 0s 37ms/step - loss: 0.9596 - acc: 0.7748 - val_loss: 1.4842 - val_acc: 0.5200
Epoch 4/70

7/7 [==============================] - 0s 36ms/step - loss: 1.5416 - acc: 0.5563 - val_loss: 0.4639 - val_acc: 0.9200
Manual evaluation: (didn't understand why I made this)
True 7029
False 2042
True percentage 0.774887002536
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.83      0.96      0.89      7318
      B-ORG       0.00      0.00      0.00       296
      I-ORG       0.00      0.00      0.00       151
      B-PER       0.29      0.00      0.01       438
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-LOC       0.00      0.00      0.00       218
      I-LOC       0.00      0.00      0.00       141
      I-PER       0.00      0.00      0.00       214

avg / total       0.69      0.77      0.72      9071

F-1 Score:
0.00227014755959
