Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.4512 - acc: 0.8671
Epoch 2/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.2239 - acc: 0.9331
Epoch 3/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.1736 - acc: 0.9497
Epoch 4/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.1409 - acc: 0.9586
Epoch 5/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.1210 - acc: 0.9646
Epoch 6/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.1061 - acc: 0.9689
Epoch 7/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0947 - acc: 0.9725
Epoch 8/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0834 - acc: 0.9759
Epoch 9/30

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0760 - acc: 0.9793
Epoch 10/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0687 - acc: 0.9803
Epoch 11/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0632 - acc: 0.9816
Epoch 12/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0584 - acc: 0.9834
Epoch 13/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0543 - acc: 0.9843
Epoch 14/30

1674/1674 [==============================] - 44s 27ms/step - loss: 0.0497 - acc: 0.9859
Epoch 15/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0465 - acc: 0.9865
Epoch 16/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0451 - acc: 0.9873
Epoch 17/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0398 - acc: 0.9888
Epoch 18/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0391 - acc: 0.9883
Epoch 19/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0359 - acc: 0.9896
Epoch 20/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0350 - acc: 0.9895
Epoch 21/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0333 - acc: 0.9901
Epoch 22/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0307 - acc: 0.9913
Epoch 23/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0296 - acc: 0.9915
Epoch 24/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0284 - acc: 0.9916
Epoch 25/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0281 - acc: 0.9920
Epoch 26/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0273 - acc: 0.9923
Epoch 27/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0264 - acc: 0.9920
Epoch 28/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0246 - acc: 0.9929
Epoch 29/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0222 - acc: 0.9938
Epoch 30/30

1674/1674 [==============================] - 44s 26ms/step - loss: 0.0231 - acc: 0.9935
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8244
False 827
True percentage 0.908830338441
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-LOC       0.76      0.74      0.75       218
      I-LOC       0.74      0.77      0.75       141
      B-PER       0.90      0.83      0.86       438
      B-ORG       0.78      0.77      0.77       296
      I-ORG       0.63      0.66      0.65       151
     B-MISC       0.40      0.28      0.33       141
     I-MISC       0.52      0.38      0.44       154
      I-PER       0.93      0.65      0.76       214

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.720720720721
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 1.0 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 101391 unique words.
Found 94 unique chars.
Found 9 unique labels.
1387 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 237
OOV word occurences: 324
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6489088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,595,650
Trainable params: 6,595,650
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

1674/1674 [==============================] - 46s 28ms/step - loss: 0.4590 - acc: 0.8681
Epoch 2/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.2207 - acc: 0.9337
Epoch 3/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1711 - acc: 0.9490
Epoch 4/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1394 - acc: 0.9589
Epoch 5/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1212 - acc: 0.9653
Epoch 6/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.1077 - acc: 0.9684
Epoch 7/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0954 - acc: 0.9727
Epoch 8/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0844 - acc: 0.9766
Epoch 9/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0752 - acc: 0.9784
Epoch 10/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0696 - acc: 0.9803
Epoch 11/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0661 - acc: 0.9811
Epoch 12/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0600 - acc: 0.9833
Epoch 13/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0549 - acc: 0.9850
Epoch 14/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0519 - acc: 0.9856
Epoch 15/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0481 - acc: 0.9859
Epoch 16/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0440 - acc: 0.9876
Epoch 17/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0415 - acc: 0.9887
Epoch 18/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0389 - acc: 0.9894
Epoch 19/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0380 - acc: 0.9892
Epoch 20/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0357 - acc: 0.9897
Epoch 21/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0328 - acc: 0.9909
Epoch 22/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0326 - acc: 0.9905
Epoch 23/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0314 - acc: 0.9910
Epoch 24/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0296 - acc: 0.9914
Epoch 25/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0288 - acc: 0.9917
Epoch 26/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0268 - acc: 0.9924
Epoch 27/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0261 - acc: 0.9926
Epoch 28/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0255 - acc: 0.9926
Epoch 29/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0238 - acc: 0.9934
Epoch 30/30

1674/1674 [==============================] - 45s 27ms/step - loss: 0.0239 - acc: 0.9928
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8249
False 822
True percentage 0.909381545585
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.90      0.84      0.87       438
      I-PER       0.93      0.67      0.78       214
          O       0.98      0.96      0.97      7318
      B-ORG       0.75      0.75      0.75       296
      I-ORG       0.65      0.64      0.65       151
      B-LOC       0.76      0.72      0.74       218
      I-LOC       0.76      0.79      0.78       141
     B-MISC       0.38      0.30      0.33       141
     I-MISC       0.57      0.45      0.50       154

avg / total       0.94      0.91      0.92      9071

F-1 Score (without O):
0.928870292887
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100819 unique words.
Found 94 unique chars.
Found 9 unique labels.
815 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 256
OOV word occurences: 380
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6452480     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,559,042
Trainable params: 6,559,042
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

837/837 [==============================] - 24s 28ms/step - loss: 0.6107 - acc: 0.8252
Epoch 2/30

837/837 [==============================] - 22s 26ms/step - loss: 0.3050 - acc: 0.9115
Epoch 3/30

837/837 [==============================] - 22s 27ms/step - loss: 0.2264 - acc: 0.9341
Epoch 4/30

837/837 [==============================] - 22s 27ms/step - loss: 0.1874 - acc: 0.9445
Epoch 5/30

837/837 [==============================] - 22s 27ms/step - loss: 0.1608 - acc: 0.9525
Epoch 6/30

837/837 [==============================] - 23s 27ms/step - loss: 0.1398 - acc: 0.9617
Epoch 7/30

837/837 [==============================] - 22s 27ms/step - loss: 0.1239 - acc: 0.9641
Epoch 8/30

837/837 [==============================] - 22s 27ms/step - loss: 0.1093 - acc: 0.9700
Epoch 9/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0959 - acc: 0.9733
Epoch 10/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0894 - acc: 0.9755
Epoch 11/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0830 - acc: 0.9776
Epoch 12/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0764 - acc: 0.9790
Epoch 13/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0686 - acc: 0.9817
Epoch 14/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0637 - acc: 0.9829
Epoch 15/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0589 - acc: 0.9832
Epoch 16/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0546 - acc: 0.9853
Epoch 17/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0522 - acc: 0.9860
Epoch 18/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0472 - acc: 0.9879
Epoch 19/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0464 - acc: 0.9876
Epoch 20/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0428 - acc: 0.9881
Epoch 21/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0391 - acc: 0.9904
Epoch 22/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0382 - acc: 0.9899
Epoch 23/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0357 - acc: 0.9906
Epoch 24/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0335 - acc: 0.9914
Epoch 25/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0308 - acc: 0.9919
Epoch 26/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0305 - acc: 0.9915
Epoch 27/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0291 - acc: 0.9917
Epoch 28/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0272 - acc: 0.9929
Epoch 29/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0267 - acc: 0.9929
Epoch 30/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0246 - acc: 0.9940
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8150
False 921
True percentage 0.898467644141
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.96      0.97      7318
      B-LOC       0.74      0.71      0.72       218
      I-LOC       0.72      0.80      0.76       141
      B-PER       0.88      0.76      0.81       438
      B-ORG       0.73      0.70      0.71       296
      I-ORG       0.66      0.58      0.61       151
     B-MISC       0.41      0.26      0.32       141
     I-MISC       0.54      0.46      0.50       154
      I-PER       0.86      0.60      0.71       214

avg / total       0.93      0.90      0.91      9071

F-1 Score (without O):
0.688224527151
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 100791 unique words.
Found 94 unique chars.
Found 9 unique labels.
787 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 260
OOV word occurences: 406
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6450688     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,557,250
Trainable params: 6,557,250
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

837/837 [==============================] - 25s 30ms/step - loss: 0.6010 - acc: 0.8269
Epoch 2/30

837/837 [==============================] - 23s 27ms/step - loss: 0.3133 - acc: 0.9093
Epoch 3/30

837/837 [==============================] - 23s 27ms/step - loss: 0.2258 - acc: 0.9337
Epoch 4/30

837/837 [==============================] - 23s 27ms/step - loss: 0.1859 - acc: 0.9452
Epoch 5/30

837/837 [==============================] - 23s 27ms/step - loss: 0.1566 - acc: 0.9527
Epoch 6/30

837/837 [==============================] - 23s 28ms/step - loss: 0.1361 - acc: 0.9598
Epoch 7/30

837/837 [==============================] - 23s 27ms/step - loss: 0.1197 - acc: 0.9644
Epoch 8/30

837/837 [==============================] - 23s 27ms/step - loss: 0.1084 - acc: 0.9705
Epoch 9/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0960 - acc: 0.9741
Epoch 10/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0875 - acc: 0.9769
Epoch 11/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0826 - acc: 0.9769
Epoch 12/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0716 - acc: 0.9806
Epoch 13/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0647 - acc: 0.9833
Epoch 14/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0628 - acc: 0.9829
Epoch 15/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0567 - acc: 0.9859
Epoch 16/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0507 - acc: 0.9875
Epoch 17/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0464 - acc: 0.9887
Epoch 18/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0444 - acc: 0.9891
Epoch 19/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0408 - acc: 0.9899
Epoch 20/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0394 - acc: 0.9902
Epoch 21/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0376 - acc: 0.9905
Epoch 22/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0365 - acc: 0.9909
Epoch 23/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0350 - acc: 0.9912
Epoch 24/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0322 - acc: 0.9913
Epoch 25/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0307 - acc: 0.9924
Epoch 26/30

837/837 [==============================] - 23s 28ms/step - loss: 0.0281 - acc: 0.9931
Epoch 27/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0277 - acc: 0.9928
Epoch 28/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0271 - acc: 0.9933
Epoch 29/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0255 - acc: 0.9936
Epoch 30/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0234 - acc: 0.9951
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8116
False 955
True percentage 0.894719435564
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.89      0.73      0.80       438
      I-PER       0.91      0.61      0.73       214
          O       0.98      0.96      0.97      7318
      B-ORG       0.73      0.71      0.72       296
      I-ORG       0.53      0.58      0.55       151
      B-LOC       0.75      0.72      0.73       218
      I-LOC       0.69      0.78      0.73       141
     B-MISC       0.38      0.24      0.29       141
     I-MISC       0.58      0.37      0.45       154

avg / total       0.93      0.89      0.91      9071

F-1 Score (without O):
0.92071550859
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.5 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100794 unique words.
Found 94 unique chars.
Found 9 unique labels.
790 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 260
OOV word occurences: 391
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6450880     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,557,442
Trainable params: 6,557,442
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

837/837 [==============================] - 24s 29ms/step - loss: 0.5989 - acc: 0.8272
Epoch 2/30

837/837 [==============================] - 22s 27ms/step - loss: 0.2975 - acc: 0.9115
Epoch 3/30

837/837 [==============================] - 22s 27ms/step - loss: 0.2186 - acc: 0.9354
Epoch 4/30

837/837 [==============================] - 22s 27ms/step - loss: 0.1778 - acc: 0.9488
Epoch 5/30

837/837 [==============================] - 22s 27ms/step - loss: 0.1517 - acc: 0.9553
Epoch 6/30

837/837 [==============================] - 22s 27ms/step - loss: 0.1324 - acc: 0.9602
Epoch 7/30

837/837 [==============================] - 22s 27ms/step - loss: 0.1179 - acc: 0.9668
Epoch 8/30

837/837 [==============================] - 22s 27ms/step - loss: 0.1061 - acc: 0.9689
Epoch 9/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0929 - acc: 0.9741
Epoch 10/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0842 - acc: 0.9770
Epoch 11/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0785 - acc: 0.9779
Epoch 12/30

837/837 [==============================] - 22s 26ms/step - loss: 0.0739 - acc: 0.9791
Epoch 13/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0646 - acc: 0.9839
Epoch 14/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0617 - acc: 0.9827
Epoch 15/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0546 - acc: 0.9858
Epoch 16/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0532 - acc: 0.9866
Epoch 17/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0476 - acc: 0.9884
Epoch 18/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0449 - acc: 0.9895
Epoch 19/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0418 - acc: 0.9890
Epoch 20/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0412 - acc: 0.9894
Epoch 21/30

837/837 [==============================] - 22s 26ms/step - loss: 0.0360 - acc: 0.9917
Epoch 22/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0351 - acc: 0.9913
Epoch 23/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0332 - acc: 0.9913
Epoch 24/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0316 - acc: 0.9921
Epoch 25/30

837/837 [==============================] - 22s 26ms/step - loss: 0.0292 - acc: 0.9928
Epoch 26/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0279 - acc: 0.9931
Epoch 27/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0274 - acc: 0.9931
Epoch 28/30

837/837 [==============================] - 23s 27ms/step - loss: 0.0240 - acc: 0.9939
Epoch 29/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0240 - acc: 0.9943
Epoch 30/30

837/837 [==============================] - 22s 27ms/step - loss: 0.0229 - acc: 0.9949
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 8086
False 985
True percentage 0.891412192702
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.97      7318
      B-PER       0.90      0.75      0.81       438
      B-LOC       0.72      0.65      0.68       218
     B-MISC       0.34      0.26      0.30       141
     I-MISC       0.43      0.42      0.42       154
      B-ORG       0.69      0.73      0.71       296
      I-ORG       0.56      0.58      0.57       151
      I-LOC       0.79      0.69      0.73       141
      I-PER       0.92      0.61      0.73       214

avg / total       0.93      0.89      0.91      9071

F-1 Score (without O):
0.66525295365
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100357 unique words.
Found 94 unique chars.
Found 9 unique labels.
353 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 289
OOV word occurences: 446
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6422912     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,529,474
Trainable params: 6,529,474
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

334/334 [==============================] - 10s 31ms/step - loss: 0.8166 - acc: 0.7765
Epoch 2/30

334/334 [==============================] - 9s 26ms/step - loss: 0.4465 - acc: 0.8625
Epoch 3/30

334/334 [==============================] - 9s 26ms/step - loss: 0.3373 - acc: 0.8975
Epoch 4/30

334/334 [==============================] - 9s 26ms/step - loss: 0.2752 - acc: 0.9202
Epoch 5/30

334/334 [==============================] - 9s 26ms/step - loss: 0.2249 - acc: 0.9321
Epoch 6/30

334/334 [==============================] - 9s 26ms/step - loss: 0.1947 - acc: 0.9457
Epoch 7/30

334/334 [==============================] - 9s 26ms/step - loss: 0.1730 - acc: 0.9502
Epoch 8/30

334/334 [==============================] - 9s 26ms/step - loss: 0.1517 - acc: 0.9582
Epoch 9/30

334/334 [==============================] - 9s 26ms/step - loss: 0.1361 - acc: 0.9651
Epoch 10/30

334/334 [==============================] - 9s 26ms/step - loss: 0.1226 - acc: 0.9674
Epoch 11/30

334/334 [==============================] - 9s 26ms/step - loss: 0.1119 - acc: 0.9710
Epoch 12/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0994 - acc: 0.9748
Epoch 13/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0901 - acc: 0.9781
Epoch 14/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0866 - acc: 0.9777
Epoch 15/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0758 - acc: 0.9810
Epoch 16/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0707 - acc: 0.9846
Epoch 17/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0658 - acc: 0.9867
Epoch 18/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0597 - acc: 0.9870
Epoch 19/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0548 - acc: 0.9873
Epoch 20/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0509 - acc: 0.9896
Epoch 21/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0468 - acc: 0.9902
Epoch 22/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0431 - acc: 0.9901
Epoch 23/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0408 - acc: 0.9904
Epoch 24/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0381 - acc: 0.9929
Epoch 25/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0371 - acc: 0.9928
Epoch 26/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0331 - acc: 0.9943
Epoch 27/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0336 - acc: 0.9931
Epoch 28/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0297 - acc: 0.9942
Epoch 29/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0294 - acc: 0.9943
Epoch 30/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0255 - acc: 0.9949
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7977
False 1094
True percentage 0.879395876971
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.97      0.95      0.96      7318
      B-LOC       0.63      0.69      0.66       218
      I-LOC       0.75      0.70      0.73       141
      B-PER       0.87      0.68      0.77       438
      B-ORG       0.72      0.69      0.70       296
      I-ORG       0.57      0.51      0.54       151
     B-MISC       0.48      0.20      0.28       141
     I-MISC       0.42      0.35      0.38       154
      I-PER       0.83      0.53      0.65       214

avg / total       0.92      0.88      0.90      9071

F-1 Score (without O):
0.639650872818
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 100385 unique words.
Found 94 unique chars.
Found 9 unique labels.
381 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 282
OOV word occurences: 460
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6424704     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,531,266
Trainable params: 6,531,266
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

334/334 [==============================] - 11s 32ms/step - loss: 0.7941 - acc: 0.7781
Epoch 2/30

334/334 [==============================] - 9s 27ms/step - loss: 0.4445 - acc: 0.8700
Epoch 3/30

334/334 [==============================] - 9s 27ms/step - loss: 0.3369 - acc: 0.9001
Epoch 4/30

334/334 [==============================] - 9s 27ms/step - loss: 0.2707 - acc: 0.9206
Epoch 5/30

334/334 [==============================] - 9s 26ms/step - loss: 0.2254 - acc: 0.9326
Epoch 6/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1926 - acc: 0.9462
Epoch 7/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1731 - acc: 0.9516
Epoch 8/30

334/334 [==============================] - 9s 27ms/step - loss: 0.1456 - acc: 0.9611
Epoch 9/30

334/334 [==============================] - 9s 26ms/step - loss: 0.1340 - acc: 0.9661
Epoch 10/30

334/334 [==============================] - 9s 26ms/step - loss: 0.1167 - acc: 0.9689
Epoch 11/30

334/334 [==============================] - 9s 26ms/step - loss: 0.1052 - acc: 0.9734
Epoch 12/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0934 - acc: 0.9776
Epoch 13/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0864 - acc: 0.9787
Epoch 14/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0757 - acc: 0.9827
Epoch 15/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0701 - acc: 0.9845
Epoch 16/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0637 - acc: 0.9849
Epoch 17/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0601 - acc: 0.9844
Epoch 18/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0532 - acc: 0.9879
Epoch 19/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0496 - acc: 0.9881
Epoch 20/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0454 - acc: 0.9903
Epoch 21/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0448 - acc: 0.9898
Epoch 22/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0400 - acc: 0.9912
Epoch 23/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0368 - acc: 0.9919
Epoch 24/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0340 - acc: 0.9936
Epoch 25/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0343 - acc: 0.9923
Epoch 26/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0321 - acc: 0.9940
Epoch 27/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0300 - acc: 0.9941
Epoch 28/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0277 - acc: 0.9945
Epoch 29/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0258 - acc: 0.9955
Epoch 30/30

334/334 [==============================] - 9s 27ms/step - loss: 0.0246 - acc: 0.9955
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7968
False 1103
True percentage 0.878403704112
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.84      0.67      0.75       438
      I-PER       0.90      0.57      0.70       214
          O       0.97      0.95      0.96      7318
      B-ORG       0.70      0.66      0.68       296
      I-ORG       0.47      0.49      0.48       151
      B-LOC       0.66      0.76      0.70       218
      I-LOC       0.64      0.75      0.69       141
     B-MISC       0.35      0.13      0.19       141
     I-MISC       0.39      0.14      0.21       154

avg / total       0.92      0.88      0.89      9071

F-1 Score (without O):
0.908423607411
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.2 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100372 unique words.
Found 94 unique chars.
Found 9 unique labels.
368 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 283
OOV word occurences: 438
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6423872     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,530,434
Trainable params: 6,530,434
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

334/334 [==============================] - 11s 32ms/step - loss: 0.8007 - acc: 0.7777
Epoch 2/30

334/334 [==============================] - 9s 27ms/step - loss: 0.4433 - acc: 0.8658
Epoch 3/30

334/334 [==============================] - 9s 26ms/step - loss: 0.3224 - acc: 0.9043
Epoch 4/30

334/334 [==============================] - 9s 26ms/step - loss: 0.2533 - acc: 0.9310
Epoch 5/30

334/334 [==============================] - 9s 26ms/step - loss: 0.2082 - acc: 0.9406
Epoch 6/30

334/334 [==============================] - 9s 26ms/step - loss: 0.1795 - acc: 0.9500
Epoch 7/30

334/334 [==============================] - 9s 26ms/step - loss: 0.1546 - acc: 0.9575
Epoch 8/30

334/334 [==============================] - 9s 26ms/step - loss: 0.1385 - acc: 0.9635
Epoch 9/30

334/334 [==============================] - 9s 26ms/step - loss: 0.1190 - acc: 0.9685
Epoch 10/30

334/334 [==============================] - 9s 26ms/step - loss: 0.1085 - acc: 0.9732
Epoch 11/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0983 - acc: 0.9771
Epoch 12/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0919 - acc: 0.9776
Epoch 13/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0822 - acc: 0.9804
Epoch 14/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0731 - acc: 0.9834
Epoch 15/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0715 - acc: 0.9827
Epoch 16/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0622 - acc: 0.9856
Epoch 17/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0635 - acc: 0.9847
Epoch 18/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0554 - acc: 0.9876
Epoch 19/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0538 - acc: 0.9885
Epoch 20/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0436 - acc: 0.9914
Epoch 21/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0433 - acc: 0.9909
Epoch 22/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0414 - acc: 0.9903
Epoch 23/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0372 - acc: 0.9919
Epoch 24/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0369 - acc: 0.9928
Epoch 25/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0341 - acc: 0.9931
Epoch 26/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0327 - acc: 0.9932
Epoch 27/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0302 - acc: 0.9947
Epoch 28/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0273 - acc: 0.9947
Epoch 29/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0282 - acc: 0.9939
Epoch 30/30

334/334 [==============================] - 9s 26ms/step - loss: 0.0238 - acc: 0.9952
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7985
False 1086
True percentage 0.8802778084
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.98      0.95      0.96      7318
      B-PER       0.86      0.69      0.77       438
      B-LOC       0.72      0.64      0.67       218
     B-MISC       0.33      0.31      0.32       141
     I-MISC       0.36      0.51      0.42       154
      B-ORG       0.73      0.65      0.69       296
      I-ORG       0.62      0.44      0.51       151
      I-LOC       0.81      0.62      0.70       141
      I-PER       0.95      0.57      0.72       214

avg / total       0.93      0.88      0.90      9071

F-1 Score (without O):
0.634520884521
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100207 unique words.
Found 94 unique chars.
Found 9 unique labels.
203 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 299
OOV word occurences: 525
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6413312     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,519,874
Trainable params: 6,519,874
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

167/167 [==============================] - 6s 38ms/step - loss: 0.9982 - acc: 0.7346
Epoch 2/30

167/167 [==============================] - 5s 27ms/step - loss: 0.5997 - acc: 0.8084
Epoch 3/30

167/167 [==============================] - 5s 27ms/step - loss: 0.4698 - acc: 0.8526
Epoch 4/30

167/167 [==============================] - 5s 27ms/step - loss: 0.3776 - acc: 0.8830
Epoch 5/30

167/167 [==============================] - 5s 28ms/step - loss: 0.3271 - acc: 0.8999
Epoch 6/30

167/167 [==============================] - 5s 28ms/step - loss: 0.2777 - acc: 0.9188
Epoch 7/30

167/167 [==============================] - 5s 28ms/step - loss: 0.2367 - acc: 0.9325
Epoch 8/30

167/167 [==============================] - 5s 27ms/step - loss: 0.2122 - acc: 0.9398
Epoch 9/30

167/167 [==============================] - 5s 28ms/step - loss: 0.1890 - acc: 0.9487
Epoch 10/30

167/167 [==============================] - 5s 28ms/step - loss: 0.1690 - acc: 0.9527
Epoch 11/30

167/167 [==============================] - 5s 28ms/step - loss: 0.1495 - acc: 0.9652
Epoch 12/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1391 - acc: 0.9640
Epoch 13/30

167/167 [==============================] - 5s 28ms/step - loss: 0.1277 - acc: 0.9672
Epoch 14/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1123 - acc: 0.9757
Epoch 15/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1047 - acc: 0.9763
Epoch 16/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0973 - acc: 0.9806
Epoch 17/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0907 - acc: 0.9820
Epoch 18/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0802 - acc: 0.9838
Epoch 19/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0768 - acc: 0.9841
Epoch 20/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0726 - acc: 0.9864
Epoch 21/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0614 - acc: 0.9914
Epoch 22/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0590 - acc: 0.9919
Epoch 23/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0526 - acc: 0.9927
Epoch 24/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0520 - acc: 0.9920
Epoch 25/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0466 - acc: 0.9928
Epoch 26/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0471 - acc: 0.9929
Epoch 27/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0435 - acc: 0.9940
Epoch 28/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0388 - acc: 0.9942
Epoch 29/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0351 - acc: 0.9968
Epoch 30/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0342 - acc: 0.9950
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7654
False 1417
True percentage 0.843787895491
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.94      0.95      7318
      B-LOC       0.69      0.59      0.64       218
      I-LOC       0.76      0.67      0.71       141
      B-PER       0.79      0.42      0.55       438
      B-ORG       0.67      0.59      0.63       296
      I-ORG       0.45      0.40      0.42       151
     B-MISC       0.18      0.19      0.18       141
     I-MISC       0.31      0.30      0.30       154
      I-PER       0.56      0.36      0.44       214

avg / total       0.89      0.84      0.86      9071

F-1 Score (without O):
0.505607177187
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 100214 unique words.
Found 94 unique chars.
Found 9 unique labels.
210 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 297
OOV word occurences: 499
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6413760     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,520,322
Trainable params: 6,520,322
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

167/167 [==============================] - 6s 38ms/step - loss: 0.9794 - acc: 0.7406
Epoch 2/30

167/167 [==============================] - 5s 28ms/step - loss: 0.5902 - acc: 0.8263
Epoch 3/30

167/167 [==============================] - 5s 29ms/step - loss: 0.4575 - acc: 0.8608
Epoch 4/30

167/167 [==============================] - 5s 29ms/step - loss: 0.3684 - acc: 0.8960
Epoch 5/30

167/167 [==============================] - 5s 29ms/step - loss: 0.3318 - acc: 0.9077
Epoch 6/30

167/167 [==============================] - 5s 28ms/step - loss: 0.2760 - acc: 0.9206
Epoch 7/30

167/167 [==============================] - 5s 28ms/step - loss: 0.2357 - acc: 0.9363
Epoch 8/30

167/167 [==============================] - 5s 28ms/step - loss: 0.2090 - acc: 0.9417
Epoch 9/30

167/167 [==============================] - 5s 28ms/step - loss: 0.1897 - acc: 0.9485
Epoch 10/30

167/167 [==============================] - 5s 28ms/step - loss: 0.1619 - acc: 0.9589
Epoch 11/30

167/167 [==============================] - 5s 29ms/step - loss: 0.1518 - acc: 0.9597
Epoch 12/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1340 - acc: 0.9654
Epoch 13/30

167/167 [==============================] - 5s 28ms/step - loss: 0.1225 - acc: 0.9681
Epoch 14/30

167/167 [==============================] - 5s 28ms/step - loss: 0.1101 - acc: 0.9743
Epoch 15/30

167/167 [==============================] - 5s 28ms/step - loss: 0.1047 - acc: 0.9743
Epoch 16/30

167/167 [==============================] - 5s 29ms/step - loss: 0.0947 - acc: 0.9811
Epoch 17/30

167/167 [==============================] - 5s 29ms/step - loss: 0.0870 - acc: 0.9787
Epoch 18/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0831 - acc: 0.9807
Epoch 19/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0788 - acc: 0.9829
Epoch 20/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0704 - acc: 0.9875
Epoch 21/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0641 - acc: 0.9871
Epoch 22/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0603 - acc: 0.9907
Epoch 23/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0562 - acc: 0.9901
Epoch 24/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0532 - acc: 0.9919
Epoch 25/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0475 - acc: 0.9938
Epoch 26/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0456 - acc: 0.9935
Epoch 27/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0429 - acc: 0.9938
Epoch 28/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0381 - acc: 0.9949
Epoch 29/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0371 - acc: 0.9947
Epoch 30/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0348 - acc: 0.9953
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7801
False 1270
True percentage 0.859993385514
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.78      0.65      0.71       438
      I-PER       0.87      0.52      0.65       214
          O       0.97      0.95      0.96      7318
      B-ORG       0.56      0.52      0.54       296
      I-ORG       0.46      0.38      0.42       151
      B-LOC       0.62      0.70      0.66       218
      I-LOC       0.71      0.48      0.57       141
     B-MISC       0.17      0.07      0.10       141
     I-MISC       0.25      0.22      0.23       154

avg / total       0.90      0.86      0.88      9071

F-1 Score (without O):
0.892517814727
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.1 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100196 unique words.
Found 94 unique chars.
Found 9 unique labels.
192 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 300
OOV word occurences: 485
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6412608     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,519,170
Trainable params: 6,519,170
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

167/167 [==============================] - 6s 38ms/step - loss: 0.9537 - acc: 0.7811
Epoch 2/30

167/167 [==============================] - 5s 27ms/step - loss: 0.5648 - acc: 0.8321
Epoch 3/30

167/167 [==============================] - 5s 27ms/step - loss: 0.4491 - acc: 0.8637
Epoch 4/30

167/167 [==============================] - 5s 28ms/step - loss: 0.3606 - acc: 0.8924
Epoch 5/30

167/167 [==============================] - 4s 27ms/step - loss: 0.3083 - acc: 0.9165
Epoch 6/30

167/167 [==============================] - 5s 27ms/step - loss: 0.2622 - acc: 0.9285
Epoch 7/30

167/167 [==============================] - 5s 28ms/step - loss: 0.2246 - acc: 0.9381
Epoch 8/30

167/167 [==============================] - 5s 28ms/step - loss: 0.2017 - acc: 0.9466
Epoch 9/30

167/167 [==============================] - 5s 28ms/step - loss: 0.1775 - acc: 0.9511
Epoch 10/30

167/167 [==============================] - 5s 28ms/step - loss: 0.1577 - acc: 0.9574
Epoch 11/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1423 - acc: 0.9653
Epoch 12/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1299 - acc: 0.9629
Epoch 13/30

167/167 [==============================] - 5s 28ms/step - loss: 0.1186 - acc: 0.9701
Epoch 14/30

167/167 [==============================] - 5s 27ms/step - loss: 0.1084 - acc: 0.9717
Epoch 15/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0979 - acc: 0.9791
Epoch 16/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0924 - acc: 0.9768
Epoch 17/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0832 - acc: 0.9792
Epoch 18/30

167/167 [==============================] - 4s 27ms/step - loss: 0.0741 - acc: 0.9861
Epoch 19/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0684 - acc: 0.9856
Epoch 20/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0635 - acc: 0.9888
Epoch 21/30

167/167 [==============================] - 4s 27ms/step - loss: 0.0644 - acc: 0.9866
Epoch 22/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0566 - acc: 0.9876
Epoch 23/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0505 - acc: 0.9882
Epoch 24/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0515 - acc: 0.9898
Epoch 25/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0466 - acc: 0.9916
Epoch 26/30

167/167 [==============================] - 4s 27ms/step - loss: 0.0449 - acc: 0.9906
Epoch 27/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0421 - acc: 0.9919
Epoch 28/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0380 - acc: 0.9926
Epoch 29/30

167/167 [==============================] - 5s 28ms/step - loss: 0.0345 - acc: 0.9951
Epoch 30/30

167/167 [==============================] - 5s 27ms/step - loss: 0.0347 - acc: 0.9945
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7750
False 1321
True percentage 0.854371072649
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.94      0.95      7318
      B-PER       0.82      0.63      0.71       438
      B-LOC       0.67      0.62      0.65       218
     B-MISC       0.12      0.09      0.11       141
     I-MISC       0.24      0.25      0.24       154
      B-ORG       0.63      0.64      0.63       296
      I-ORG       0.45      0.30      0.36       151
      I-LOC       0.73      0.59      0.65       141
      I-PER       0.92      0.41      0.56       214

avg / total       0.90      0.85      0.87      9071

F-1 Score (without O):
0.546776232617
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100098 unique words.
Found 94 unique chars.
Found 9 unique labels.
94 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 315
OOV word occurences: 594
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6406336     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,512,898
Trainable params: 6,512,898
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

83/83 [==============================] - 4s 48ms/step - loss: 1.0418 - acc: 0.7938
Epoch 2/30

83/83 [==============================] - 2s 27ms/step - loss: 0.7389 - acc: 0.7991
Epoch 3/30

83/83 [==============================] - 2s 27ms/step - loss: 0.5813 - acc: 0.8130
Epoch 4/30

83/83 [==============================] - 2s 27ms/step - loss: 0.4884 - acc: 0.8398
Epoch 5/30

83/83 [==============================] - 2s 27ms/step - loss: 0.4109 - acc: 0.8615
Epoch 6/30

83/83 [==============================] - 2s 27ms/step - loss: 0.3652 - acc: 0.8883
Epoch 7/30

83/83 [==============================] - 2s 27ms/step - loss: 0.3110 - acc: 0.8999
Epoch 8/30

83/83 [==============================] - 2s 27ms/step - loss: 0.2763 - acc: 0.9219
Epoch 9/30

83/83 [==============================] - 2s 27ms/step - loss: 0.2438 - acc: 0.9444
Epoch 10/30

83/83 [==============================] - 2s 27ms/step - loss: 0.2135 - acc: 0.9448
Epoch 11/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1911 - acc: 0.9557
Epoch 12/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1714 - acc: 0.9548
Epoch 13/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1554 - acc: 0.9638
Epoch 14/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1360 - acc: 0.9666
Epoch 15/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1219 - acc: 0.9747
Epoch 16/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1120 - acc: 0.9818
Epoch 17/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1007 - acc: 0.9828
Epoch 18/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1000 - acc: 0.9863
Epoch 19/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0850 - acc: 0.9859
Epoch 20/30

83/83 [==============================] - 2s 26ms/step - loss: 0.0783 - acc: 0.9874
Epoch 21/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0719 - acc: 0.9890
Epoch 22/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0678 - acc: 0.9907
Epoch 23/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0612 - acc: 0.9916
Epoch 24/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0551 - acc: 0.9933
Epoch 25/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0517 - acc: 0.9926
Epoch 26/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0491 - acc: 0.9926
Epoch 27/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0454 - acc: 0.9975
Epoch 28/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0435 - acc: 0.9922
Epoch 29/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0449 - acc: 0.9932
Epoch 30/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0384 - acc: 0.9977
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7615
False 1456
True percentage 0.839488479771
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.96      0.94      0.95      7318
      B-LOC       0.66      0.58      0.62       218
      I-LOC       0.72      0.61      0.66       141
      B-PER       0.72      0.41      0.52       438
      B-ORG       0.49      0.56      0.53       296
      I-ORG       0.40      0.43      0.41       151
     B-MISC       0.17      0.04      0.06       141
     I-MISC       0.51      0.14      0.22       154
      I-PER       0.61      0.43      0.50       214

avg / total       0.88      0.84      0.86      9071

F-1 Score (without O):
0.488976637052
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 100110 unique words.
Found 94 unique chars.
Found 9 unique labels.
106 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 313
OOV word occurences: 522
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6407104     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,513,666
Trainable params: 6,513,666
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

83/83 [==============================] - 4s 47ms/step - loss: 1.2445 - acc: 0.6576
Epoch 2/30

83/83 [==============================] - 2s 27ms/step - loss: 0.7153 - acc: 0.8057
Epoch 3/30

83/83 [==============================] - 2s 27ms/step - loss: 0.5964 - acc: 0.8121
Epoch 4/30

83/83 [==============================] - 2s 27ms/step - loss: 0.5165 - acc: 0.8466
Epoch 5/30

83/83 [==============================] - 2s 28ms/step - loss: 0.4232 - acc: 0.8649
Epoch 6/30

83/83 [==============================] - 2s 28ms/step - loss: 0.3925 - acc: 0.8846
Epoch 7/30

83/83 [==============================] - 2s 28ms/step - loss: 0.3362 - acc: 0.9053
Epoch 8/30

83/83 [==============================] - 2s 28ms/step - loss: 0.2996 - acc: 0.9170
Epoch 9/30

83/83 [==============================] - 2s 27ms/step - loss: 0.2757 - acc: 0.9256
Epoch 10/30

83/83 [==============================] - 2s 27ms/step - loss: 0.2476 - acc: 0.9369
Epoch 11/30

83/83 [==============================] - 2s 28ms/step - loss: 0.2289 - acc: 0.9536
Epoch 12/30

83/83 [==============================] - 2s 27ms/step - loss: 0.2100 - acc: 0.9479
Epoch 13/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1861 - acc: 0.9548
Epoch 14/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1788 - acc: 0.9555
Epoch 15/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1572 - acc: 0.9617
Epoch 16/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1539 - acc: 0.9588
Epoch 17/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1353 - acc: 0.9656
Epoch 18/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1320 - acc: 0.9693
Epoch 19/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1335 - acc: 0.9702
Epoch 20/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1250 - acc: 0.9668
Epoch 21/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1113 - acc: 0.9729
Epoch 22/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0997 - acc: 0.9802
Epoch 23/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0927 - acc: 0.9778
Epoch 24/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0889 - acc: 0.9810
Epoch 25/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0812 - acc: 0.9799
Epoch 26/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0786 - acc: 0.9829
Epoch 27/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0761 - acc: 0.9861
Epoch 28/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0715 - acc: 0.9852
Epoch 29/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0673 - acc: 0.9861
Epoch 30/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0621 - acc: 0.9897
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7625
False 1446
True percentage 0.840590894058
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.75      0.58      0.65       438
      I-PER       0.83      0.44      0.57       214
          O       0.93      0.96      0.94      7318
      B-ORG       0.62      0.38      0.47       296
      I-ORG       0.35      0.19      0.24       151
      B-LOC       0.61      0.45      0.52       218
      I-LOC       1.00      0.13      0.24       141
     B-MISC       0.04      0.01      0.01       141
     I-MISC       0.29      0.14      0.19       154

avg / total       0.86      0.84      0.84      9071

F-1 Score (without O):
0.875274562185
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100100 unique words.
Found 94 unique chars.
Found 9 unique labels.
96 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 313
OOV word occurences: 541
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6406464     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,513,026
Trainable params: 6,513,026
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

83/83 [==============================] - 4s 47ms/step - loss: 1.2420 - acc: 0.6656
Epoch 2/30

83/83 [==============================] - 2s 26ms/step - loss: 0.7030 - acc: 0.8128
Epoch 3/30

83/83 [==============================] - 2s 27ms/step - loss: 0.5816 - acc: 0.8224
Epoch 4/30

83/83 [==============================] - 2s 27ms/step - loss: 0.5071 - acc: 0.8486
Epoch 5/30

83/83 [==============================] - 2s 27ms/step - loss: 0.4331 - acc: 0.8639
Epoch 6/30

83/83 [==============================] - 2s 27ms/step - loss: 0.3885 - acc: 0.8878
Epoch 7/30

83/83 [==============================] - 2s 27ms/step - loss: 0.3323 - acc: 0.9043
Epoch 8/30

83/83 [==============================] - 2s 27ms/step - loss: 0.2949 - acc: 0.9160
Epoch 9/30

83/83 [==============================] - 2s 27ms/step - loss: 0.2594 - acc: 0.9257
Epoch 10/30

83/83 [==============================] - 2s 27ms/step - loss: 0.2373 - acc: 0.9397
Epoch 11/30

83/83 [==============================] - 2s 26ms/step - loss: 0.2315 - acc: 0.9405
Epoch 12/30

83/83 [==============================] - 2s 26ms/step - loss: 0.1982 - acc: 0.9492
Epoch 13/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1772 - acc: 0.9566
Epoch 14/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1620 - acc: 0.9658
Epoch 15/30

83/83 [==============================] - 2s 26ms/step - loss: 0.1515 - acc: 0.9642
Epoch 16/30

83/83 [==============================] - 2s 26ms/step - loss: 0.1376 - acc: 0.9750
Epoch 17/30

83/83 [==============================] - 2s 26ms/step - loss: 0.1295 - acc: 0.9750
Epoch 18/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1272 - acc: 0.9715
Epoch 19/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1050 - acc: 0.9823
Epoch 20/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1029 - acc: 0.9792
Epoch 21/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0909 - acc: 0.9803
Epoch 22/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0924 - acc: 0.9819
Epoch 23/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0833 - acc: 0.9847
Epoch 24/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0758 - acc: 0.9843
Epoch 25/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0685 - acc: 0.9892
Epoch 26/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0646 - acc: 0.9913
Epoch 27/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0585 - acc: 0.9918
Epoch 28/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0595 - acc: 0.9919
Epoch 29/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0552 - acc: 0.9924
Epoch 30/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0467 - acc: 0.9951
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7598
False 1473
True percentage 0.837614375482
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.94      0.95      0.94      7318
      B-PER       0.73      0.51      0.60       438
      B-LOC       0.64      0.56      0.60       218
     B-MISC       0.10      0.04      0.05       141
     I-MISC       0.29      0.15      0.20       154
      B-ORG       0.49      0.52      0.50       296
      I-ORG       0.32      0.28      0.30       151
      I-LOC       0.94      0.44      0.60       141
      I-PER       0.83      0.23      0.36       214

avg / total       0.87      0.84      0.85      9071

F-1 Score (without O):
0.461642905635
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.05 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 100101 unique words.
Found 94 unique chars.
Found 9 unique labels.
97 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 311
OOV word occurences: 542
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6406528     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,513,090
Trainable params: 6,513,090
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

83/83 [==============================] - 4s 47ms/step - loss: 1.3274 - acc: 0.6306
Epoch 2/30

83/83 [==============================] - 2s 28ms/step - loss: 0.8030 - acc: 0.7858
Epoch 3/30

83/83 [==============================] - 2s 29ms/step - loss: 0.6660 - acc: 0.7915
Epoch 4/30

83/83 [==============================] - 2s 28ms/step - loss: 0.5645 - acc: 0.8330
Epoch 5/30

83/83 [==============================] - 2s 28ms/step - loss: 0.4727 - acc: 0.8509
Epoch 6/30

83/83 [==============================] - 2s 28ms/step - loss: 0.5138 - acc: 0.8591
Epoch 7/30

83/83 [==============================] - 2s 27ms/step - loss: 0.3778 - acc: 0.8982
Epoch 8/30

83/83 [==============================] - 2s 28ms/step - loss: 0.3328 - acc: 0.9043
Epoch 9/30

83/83 [==============================] - 2s 28ms/step - loss: 0.3001 - acc: 0.9290
Epoch 10/30

83/83 [==============================] - 2s 27ms/step - loss: 0.2684 - acc: 0.9350
Epoch 11/30

83/83 [==============================] - 2s 28ms/step - loss: 0.2370 - acc: 0.9472
Epoch 12/30

83/83 [==============================] - 2s 27ms/step - loss: 0.2220 - acc: 0.9501
Epoch 13/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1935 - acc: 0.9598
Epoch 14/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1730 - acc: 0.9587
Epoch 15/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1580 - acc: 0.9666
Epoch 16/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1462 - acc: 0.9651
Epoch 17/30

83/83 [==============================] - 2s 27ms/step - loss: 0.1396 - acc: 0.9692
Epoch 18/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1257 - acc: 0.9713
Epoch 19/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1083 - acc: 0.9764
Epoch 20/30

83/83 [==============================] - 2s 28ms/step - loss: 0.1018 - acc: 0.9837
Epoch 21/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0985 - acc: 0.9823
Epoch 22/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0930 - acc: 0.9806
Epoch 23/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0790 - acc: 0.9875
Epoch 24/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0721 - acc: 0.9887
Epoch 25/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0657 - acc: 0.9908
Epoch 26/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0687 - acc: 0.9917
Epoch 27/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0617 - acc: 0.9909
Epoch 28/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0623 - acc: 0.9920
Epoch 29/30

83/83 [==============================] - 2s 27ms/step - loss: 0.0550 - acc: 0.9908
Epoch 30/30

83/83 [==============================] - 2s 28ms/step - loss: 0.0519 - acc: 0.9922
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7683
False 1388
True percentage 0.846984896924
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.95      0.95      0.95      7318
      B-ORG       0.55      0.42      0.48       296
      I-ORG       0.47      0.30      0.37       151
      B-PER       0.77      0.60      0.67       438
      I-PER       0.78      0.46      0.58       214
      B-LOC       0.66      0.54      0.59       218
      I-LOC       0.73      0.33      0.45       141
     B-MISC       0.25      0.13      0.17       141
     I-MISC       0.35      0.29      0.32       154

avg / total       0.88      0.85      0.86      9071

F-1 Score (without O):
0.507222035606
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100039 unique words.
Found 93 unique chars.
Found 9 unique labels.
35 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 322
OOV word occurences: 617
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6402560     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,509,058
Trainable params: 6,509,058
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

33/33 [==============================] - 3s 84ms/step - loss: 1.6140 - acc: 0.6782
Epoch 2/30

33/33 [==============================] - 1s 30ms/step - loss: 1.0172 - acc: 0.7815
Epoch 3/30

33/33 [==============================] - 1s 31ms/step - loss: 0.8024 - acc: 0.7852
Epoch 4/30

33/33 [==============================] - 1s 31ms/step - loss: 0.7414 - acc: 0.7844
Epoch 5/30

33/33 [==============================] - 1s 30ms/step - loss: 0.6720 - acc: 0.7878
Epoch 6/30

33/33 [==============================] - 1s 30ms/step - loss: 0.6079 - acc: 0.8009
Epoch 7/30

33/33 [==============================] - 1s 30ms/step - loss: 0.5632 - acc: 0.8107
Epoch 8/30

33/33 [==============================] - 1s 31ms/step - loss: 0.5282 - acc: 0.8210
Epoch 9/30

33/33 [==============================] - 1s 30ms/step - loss: 0.4881 - acc: 0.8389
Epoch 10/30

33/33 [==============================] - 1s 30ms/step - loss: 0.4439 - acc: 0.8510
Epoch 11/30

33/33 [==============================] - 1s 30ms/step - loss: 0.4144 - acc: 0.8597
Epoch 12/30

33/33 [==============================] - 1s 30ms/step - loss: 0.4174 - acc: 0.8684
Epoch 13/30

33/33 [==============================] - 1s 31ms/step - loss: 0.3687 - acc: 0.8797
Epoch 14/30

33/33 [==============================] - 1s 31ms/step - loss: 0.3496 - acc: 0.8911
Epoch 15/30

33/33 [==============================] - 1s 31ms/step - loss: 0.3386 - acc: 0.9036
Epoch 16/30

33/33 [==============================] - 1s 32ms/step - loss: 0.2919 - acc: 0.9211
Epoch 17/30

33/33 [==============================] - 1s 31ms/step - loss: 0.2885 - acc: 0.9423
Epoch 18/30

33/33 [==============================] - 1s 32ms/step - loss: 0.2611 - acc: 0.9465
Epoch 19/30

33/33 [==============================] - 1s 31ms/step - loss: 0.2405 - acc: 0.9430
Epoch 20/30

33/33 [==============================] - 1s 32ms/step - loss: 0.2363 - acc: 0.9531
Epoch 21/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2244 - acc: 0.9525
Epoch 22/30

33/33 [==============================] - 1s 31ms/step - loss: 0.2045 - acc: 0.9519
Epoch 23/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1960 - acc: 0.9632
Epoch 24/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1837 - acc: 0.9789
Epoch 25/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1832 - acc: 0.9666
Epoch 26/30

33/33 [==============================] - 1s 29ms/step - loss: 0.1673 - acc: 0.9711
Epoch 27/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1664 - acc: 0.9663
Epoch 28/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1437 - acc: 0.9773
Epoch 29/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1422 - acc: 0.9803
Epoch 30/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1300 - acc: 0.9835
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7306
False 1765
True percentage 0.805423878293
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.89      0.96      0.92      7318
      B-LOC       0.56      0.30      0.39       218
      I-LOC       0.71      0.16      0.26       141
      B-PER       0.74      0.19      0.30       438
      B-ORG       0.52      0.29      0.37       296
      I-ORG       0.32      0.07      0.12       151
     B-MISC       0.12      0.06      0.08       141
     I-MISC       0.25      0.08      0.13       154
      I-PER       0.44      0.11      0.18       214

avg / total       0.82      0.81      0.80      9071

F-1 Score (without O):
0.262144053601
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 100047 unique words.
Found 94 unique chars.
Found 9 unique labels.
43 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 320
OOV word occurences: 539
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6403072     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,509,634
Trainable params: 6,509,634
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

33/33 [==============================] - 3s 80ms/step - loss: 1.7321 - acc: 0.4598
Epoch 2/30

33/33 [==============================] - 1s 29ms/step - loss: 0.9037 - acc: 0.7744
Epoch 3/30

33/33 [==============================] - 1s 29ms/step - loss: 0.7924 - acc: 0.7760
Epoch 4/30

33/33 [==============================] - 1s 29ms/step - loss: 0.7535 - acc: 0.7875
Epoch 5/30

33/33 [==============================] - 1s 29ms/step - loss: 0.6783 - acc: 0.7801
Epoch 6/30

33/33 [==============================] - 1s 30ms/step - loss: 0.6468 - acc: 0.7839
Epoch 7/30

33/33 [==============================] - 1s 29ms/step - loss: 0.5897 - acc: 0.7999
Epoch 8/30

33/33 [==============================] - 1s 29ms/step - loss: 0.5450 - acc: 0.8317
Epoch 9/30

33/33 [==============================] - 1s 29ms/step - loss: 0.5004 - acc: 0.8370
Epoch 10/30

33/33 [==============================] - 1s 30ms/step - loss: 0.4735 - acc: 0.8506
Epoch 11/30

33/33 [==============================] - 1s 29ms/step - loss: 0.4498 - acc: 0.8623
Epoch 12/30

33/33 [==============================] - 1s 29ms/step - loss: 0.4575 - acc: 0.8604
Epoch 13/30

33/33 [==============================] - 1s 29ms/step - loss: 0.3931 - acc: 0.8747
Epoch 14/30

33/33 [==============================] - 1s 30ms/step - loss: 0.3733 - acc: 0.8764
Epoch 15/30

33/33 [==============================] - 1s 30ms/step - loss: 0.3403 - acc: 0.9030
Epoch 16/30

33/33 [==============================] - 1s 30ms/step - loss: 0.3203 - acc: 0.9241
Epoch 17/30

33/33 [==============================] - 1s 29ms/step - loss: 0.3072 - acc: 0.9213
Epoch 18/30

33/33 [==============================] - 1s 29ms/step - loss: 0.2884 - acc: 0.9283
Epoch 19/30

33/33 [==============================] - 1s 29ms/step - loss: 0.2792 - acc: 0.9375
Epoch 20/30

33/33 [==============================] - 1s 29ms/step - loss: 0.2519 - acc: 0.9410
Epoch 21/30

33/33 [==============================] - 1s 29ms/step - loss: 0.2532 - acc: 0.9406
Epoch 22/30

33/33 [==============================] - 1s 29ms/step - loss: 0.2397 - acc: 0.9377
Epoch 23/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2210 - acc: 0.9537
Epoch 24/30

33/33 [==============================] - 1s 29ms/step - loss: 0.2103 - acc: 0.9394
Epoch 25/30

33/33 [==============================] - 1s 29ms/step - loss: 0.2036 - acc: 0.9489
Epoch 26/30

33/33 [==============================] - 1s 29ms/step - loss: 0.1845 - acc: 0.9544
Epoch 27/30

33/33 [==============================] - 1s 29ms/step - loss: 0.1725 - acc: 0.9581
Epoch 28/30

33/33 [==============================] - 1s 29ms/step - loss: 0.1764 - acc: 0.9570
Epoch 29/30

33/33 [==============================] - 1s 29ms/step - loss: 0.1730 - acc: 0.9675
Epoch 30/30

33/33 [==============================] - 1s 28ms/step - loss: 0.1446 - acc: 0.9647
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7463
False 1608
True percentage 0.822731782604
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.73      0.52      0.61       438
      I-PER       0.57      0.42      0.48       214
          O       0.94      0.94      0.94      7318
      B-ORG       0.40      0.57      0.47       296
      I-ORG       0.26      0.35      0.30       151
      B-LOC       0.98      0.20      0.33       218
      I-LOC       1.00      0.04      0.07       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.24      0.09      0.13       154

avg / total       0.86      0.82      0.83      9071

F-1 Score (without O):
0.858668565326
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100037 unique words.
Found 92 unique chars.
Found 9 unique labels.
33 unique words not found in embedding.
8 unique chars not found in embedding.
Number of OOV: 322
OOV word occurences: 564
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6402432     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,508,866
Trainable params: 6,508,866
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

33/33 [==============================] - 3s 80ms/step - loss: 1.5265 - acc: 0.6779
Epoch 2/30

33/33 [==============================] - 1s 29ms/step - loss: 0.8912 - acc: 0.7930
Epoch 3/30

33/33 [==============================] - 1s 29ms/step - loss: 0.7558 - acc: 0.7960
Epoch 4/30

33/33 [==============================] - 1s 29ms/step - loss: 0.7246 - acc: 0.7930
Epoch 5/30

33/33 [==============================] - 1s 29ms/step - loss: 0.6136 - acc: 0.8022
Epoch 6/30

33/33 [==============================] - 1s 30ms/step - loss: 0.5578 - acc: 0.8397
Epoch 7/30

33/33 [==============================] - 1s 30ms/step - loss: 0.4895 - acc: 0.8648
Epoch 8/30

33/33 [==============================] - 1s 29ms/step - loss: 0.4693 - acc: 0.8809
Epoch 9/30

33/33 [==============================] - 1s 29ms/step - loss: 0.4196 - acc: 0.8633
Epoch 10/30

33/33 [==============================] - 1s 29ms/step - loss: 0.3923 - acc: 0.8862
Epoch 11/30

33/33 [==============================] - 1s 29ms/step - loss: 0.3628 - acc: 0.8847
Epoch 12/30

33/33 [==============================] - 1s 30ms/step - loss: 0.3330 - acc: 0.9039
Epoch 13/30

33/33 [==============================] - 1s 29ms/step - loss: 0.3533 - acc: 0.8980
Epoch 14/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2929 - acc: 0.9318
Epoch 15/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2846 - acc: 0.9213
Epoch 16/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2641 - acc: 0.9275
Epoch 17/30

33/33 [==============================] - 1s 29ms/step - loss: 0.2636 - acc: 0.9168
Epoch 18/30

33/33 [==============================] - 1s 29ms/step - loss: 0.2383 - acc: 0.9333
Epoch 19/30

33/33 [==============================] - 1s 29ms/step - loss: 0.2195 - acc: 0.9506
Epoch 20/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1976 - acc: 0.9597
Epoch 21/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1989 - acc: 0.9397
Epoch 22/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1924 - acc: 0.9409
Epoch 23/30

33/33 [==============================] - 1s 29ms/step - loss: 0.1940 - acc: 0.9601
Epoch 24/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1694 - acc: 0.9572
Epoch 25/30

33/33 [==============================] - 1s 29ms/step - loss: 0.1638 - acc: 0.9541
Epoch 26/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1494 - acc: 0.9656
Epoch 27/30

33/33 [==============================] - 1s 29ms/step - loss: 0.1562 - acc: 0.9596
Epoch 28/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1412 - acc: 0.9726
Epoch 29/30

33/33 [==============================] - 1s 29ms/step - loss: 0.1598 - acc: 0.9718
Epoch 30/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1290 - acc: 0.9772
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7323
False 1748
True percentage 0.807297982582
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.92      0.94      0.93      7318
      B-PER       0.50      0.46      0.48       438
      B-LOC       0.72      0.32      0.44       218
     B-MISC       0.22      0.03      0.05       141
     I-MISC       0.00      0.00      0.00       154
      B-ORG       0.40      0.40      0.40       296
      I-ORG       0.27      0.31      0.29       151
      I-LOC       0.00      0.00      0.00       141
      I-PER       0.84      0.10      0.18       214

avg / total       0.82      0.81      0.80      9071

F-1 Score (without O):
0.333092485549
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.02 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 100050 unique words.
Found 94 unique chars.
Found 9 unique labels.
46 unique words not found in embedding.
10 unique chars not found in embedding.
Number of OOV: 319
OOV word occurences: 620
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6080        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6403264     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,509,826
Trainable params: 6,509,826
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

33/33 [==============================] - 3s 81ms/step - loss: 1.8541 - acc: 0.4250
Epoch 2/30

33/33 [==============================] - 1s 30ms/step - loss: 0.8774 - acc: 0.7856
Epoch 3/30

33/33 [==============================] - 1s 29ms/step - loss: 1.0051 - acc: 0.7855
Epoch 4/30

33/33 [==============================] - 1s 29ms/step - loss: 0.7321 - acc: 0.7853
Epoch 5/30

33/33 [==============================] - 1s 29ms/step - loss: 0.6538 - acc: 0.7918
Epoch 6/30

33/33 [==============================] - 1s 29ms/step - loss: 0.6109 - acc: 0.7930
Epoch 7/30

33/33 [==============================] - 1s 29ms/step - loss: 0.5798 - acc: 0.8098
Epoch 8/30

33/33 [==============================] - 1s 29ms/step - loss: 0.5218 - acc: 0.8335
Epoch 9/30

33/33 [==============================] - 1s 30ms/step - loss: 0.5067 - acc: 0.8575
Epoch 10/30

33/33 [==============================] - 1s 29ms/step - loss: 0.4487 - acc: 0.8511
Epoch 11/30

33/33 [==============================] - 1s 30ms/step - loss: 0.4229 - acc: 0.8922
Epoch 12/30

33/33 [==============================] - 1s 30ms/step - loss: 0.4113 - acc: 0.8915
Epoch 13/30

33/33 [==============================] - 1s 28ms/step - loss: 0.3717 - acc: 0.9101
Epoch 14/30

33/33 [==============================] - 1s 29ms/step - loss: 0.3393 - acc: 0.9183
Epoch 15/30

33/33 [==============================] - 1s 29ms/step - loss: 0.3357 - acc: 0.9068
Epoch 16/30

33/33 [==============================] - 1s 29ms/step - loss: 0.3234 - acc: 0.9243
Epoch 17/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2994 - acc: 0.9245
Epoch 18/30

33/33 [==============================] - 1s 29ms/step - loss: 0.2943 - acc: 0.9350
Epoch 19/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2655 - acc: 0.9414
Epoch 20/30

33/33 [==============================] - 1s 28ms/step - loss: 0.2484 - acc: 0.9408
Epoch 21/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2320 - acc: 0.9532
Epoch 22/30

33/33 [==============================] - 1s 29ms/step - loss: 0.2299 - acc: 0.9481
Epoch 23/30

33/33 [==============================] - 1s 29ms/step - loss: 0.2175 - acc: 0.9534
Epoch 24/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2026 - acc: 0.9563
Epoch 25/30

33/33 [==============================] - 1s 30ms/step - loss: 0.2040 - acc: 0.9581
Epoch 26/30

33/33 [==============================] - 1s 29ms/step - loss: 0.1956 - acc: 0.9540
Epoch 27/30

33/33 [==============================] - 1s 30ms/step - loss: 0.1662 - acc: 0.9688
Epoch 28/30

33/33 [==============================] - 1s 29ms/step - loss: 0.1544 - acc: 0.9687
Epoch 29/30

33/33 [==============================] - 1s 29ms/step - loss: 0.1516 - acc: 0.9670
Epoch 30/30

33/33 [==============================] - 1s 29ms/step - loss: 0.1446 - acc: 0.9664
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7361
False 1710
True percentage 0.811487156874
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.93      0.93      0.93      7318
      B-ORG       0.45      0.52      0.48       296
      I-ORG       0.28      0.36      0.32       151
      B-PER       0.67      0.49      0.57       438
      I-PER       0.71      0.32      0.44       214
      B-LOC       0.95      0.19      0.31       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       1.00      0.01      0.01       141
     I-MISC       0.22      0.19      0.20       154

avg / total       0.86      0.81      0.82      9071

F-1 Score (without O):
0.389871661464
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100022 unique words.
Found 92 unique chars.
Found 8 unique labels.
18 unique words not found in embedding.
8 unique chars not found in embedding.
Number of OOV: 324
OOV word occurences: 632
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401472     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,756
Trainable params: 6,507,756
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

16/16 [==============================] - 2s 131ms/step - loss: 2.3311 - acc: 0.0236
Epoch 2/30

16/16 [==============================] - 0s 26ms/step - loss: 1.1275 - acc: 0.8466
Epoch 3/30

16/16 [==============================] - 0s 26ms/step - loss: 0.7020 - acc: 0.8466
Epoch 4/30

16/16 [==============================] - 0s 26ms/step - loss: 0.6591 - acc: 0.8466
Epoch 5/30

16/16 [==============================] - 0s 25ms/step - loss: 0.6075 - acc: 0.8466
Epoch 6/30

16/16 [==============================] - 0s 27ms/step - loss: 0.5831 - acc: 0.8466
Epoch 7/30

16/16 [==============================] - 0s 27ms/step - loss: 0.5525 - acc: 0.8466
Epoch 8/30

16/16 [==============================] - 0s 26ms/step - loss: 0.5184 - acc: 0.8466
Epoch 9/30

16/16 [==============================] - 0s 25ms/step - loss: 0.4878 - acc: 0.8466
Epoch 10/30

16/16 [==============================] - 0s 26ms/step - loss: 0.4696 - acc: 0.8496
Epoch 11/30

16/16 [==============================] - 0s 25ms/step - loss: 0.4283 - acc: 0.8584
Epoch 12/30

16/16 [==============================] - 0s 26ms/step - loss: 0.3891 - acc: 0.8614
Epoch 13/30

16/16 [==============================] - 0s 26ms/step - loss: 0.3852 - acc: 0.8850
Epoch 14/30

16/16 [==============================] - 0s 25ms/step - loss: 0.3984 - acc: 0.8643
Epoch 15/30

16/16 [==============================] - 0s 26ms/step - loss: 0.4062 - acc: 0.9145
Epoch 16/30

16/16 [==============================] - 0s 26ms/step - loss: 0.3113 - acc: 0.8820
Epoch 17/30

16/16 [==============================] - 0s 27ms/step - loss: 0.2891 - acc: 0.8909
Epoch 18/30

16/16 [==============================] - 0s 26ms/step - loss: 0.2756 - acc: 0.8968
Epoch 19/30

16/16 [==============================] - 0s 26ms/step - loss: 0.2533 - acc: 0.9204
Epoch 20/30

16/16 [==============================] - 0s 26ms/step - loss: 0.2398 - acc: 0.9086
Epoch 21/30

16/16 [==============================] - 0s 26ms/step - loss: 0.2213 - acc: 0.9381
Epoch 22/30

16/16 [==============================] - 0s 25ms/step - loss: 0.2050 - acc: 0.9410
Epoch 23/30

16/16 [==============================] - 0s 25ms/step - loss: 0.1903 - acc: 0.9499
Epoch 24/30

16/16 [==============================] - 0s 26ms/step - loss: 0.1848 - acc: 0.9499
Epoch 25/30

16/16 [==============================] - 0s 25ms/step - loss: 0.1594 - acc: 0.9587
Epoch 26/30

16/16 [==============================] - 0s 26ms/step - loss: 0.1539 - acc: 0.9617
Epoch 27/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1506 - acc: 0.9676
Epoch 28/30

16/16 [==============================] - 0s 26ms/step - loss: 0.1386 - acc: 0.9735
Epoch 29/30

16/16 [==============================] - 0s 26ms/step - loss: 0.1317 - acc: 0.9764
Epoch 30/30

16/16 [==============================] - 0s 26ms/step - loss: 0.1211 - acc: 0.9912
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7187
False 1670
True percentage 0.811448571751
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.88      0.95      0.91      7318
      B-LOC       0.47      0.08      0.14       218
      I-LOC       0.81      0.09      0.17       141
      B-PER       0.74      0.15      0.25       438
      B-ORG       0.36      0.41      0.38       296
      I-ORG       0.23      0.05      0.08       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.80      0.81      0.79      8857

F-1 Score (without O):
0.219084712756
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 100025 unique words.
Found 92 unique chars.
Found 9 unique labels.
21 unique words not found in embedding.
8 unique chars not found in embedding.
Number of OOV: 327
OOV word occurences: 640
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401664     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,508,098
Trainable params: 6,508,098
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

16/16 [==============================] - 2s 134ms/step - loss: 2.3914 - acc: 0.0126
Epoch 2/30

16/16 [==============================] - 0s 27ms/step - loss: 1.5468 - acc: 0.7642
Epoch 3/30

16/16 [==============================] - 0s 27ms/step - loss: 1.0084 - acc: 0.7642
Epoch 4/30

16/16 [==============================] - 0s 27ms/step - loss: 0.9190 - acc: 0.7642
Epoch 5/30

16/16 [==============================] - 0s 27ms/step - loss: 1.0136 - acc: 0.7642
Epoch 6/30

16/16 [==============================] - 0s 27ms/step - loss: 1.0495 - acc: 0.7736
Epoch 7/30

16/16 [==============================] - 0s 27ms/step - loss: 0.7740 - acc: 0.7642
Epoch 8/30

16/16 [==============================] - 0s 27ms/step - loss: 0.7308 - acc: 0.7642
Epoch 9/30

16/16 [==============================] - 0s 27ms/step - loss: 0.6858 - acc: 0.7673
Epoch 10/30

16/16 [==============================] - 0s 28ms/step - loss: 0.6445 - acc: 0.7704
Epoch 11/30

16/16 [==============================] - 0s 27ms/step - loss: 0.6143 - acc: 0.7736
Epoch 12/30

16/16 [==============================] - 0s 26ms/step - loss: 0.5760 - acc: 0.7893
Epoch 13/30

16/16 [==============================] - 0s 27ms/step - loss: 0.5454 - acc: 0.7987
Epoch 14/30

16/16 [==============================] - 0s 27ms/step - loss: 0.5204 - acc: 0.8113
Epoch 15/30

16/16 [==============================] - 0s 27ms/step - loss: 0.4820 - acc: 0.8365
Epoch 16/30

16/16 [==============================] - 0s 27ms/step - loss: 0.4435 - acc: 0.8522
Epoch 17/30

16/16 [==============================] - 0s 28ms/step - loss: 0.4285 - acc: 0.8616
Epoch 18/30

16/16 [==============================] - 0s 26ms/step - loss: 0.4016 - acc: 0.8805
Epoch 19/30

16/16 [==============================] - 0s 27ms/step - loss: 0.3740 - acc: 0.8742
Epoch 20/30

16/16 [==============================] - 0s 26ms/step - loss: 0.3666 - acc: 0.8962
Epoch 21/30

16/16 [==============================] - 0s 26ms/step - loss: 0.3393 - acc: 0.8931
Epoch 22/30

16/16 [==============================] - 0s 27ms/step - loss: 0.3051 - acc: 0.9277
Epoch 23/30

16/16 [==============================] - 0s 27ms/step - loss: 0.3138 - acc: 0.9119
Epoch 24/30

16/16 [==============================] - 0s 26ms/step - loss: 0.2868 - acc: 0.9465
Epoch 25/30

16/16 [==============================] - 0s 26ms/step - loss: 0.2646 - acc: 0.9119
Epoch 26/30

16/16 [==============================] - 0s 28ms/step - loss: 0.2617 - acc: 0.9780
Epoch 27/30

16/16 [==============================] - 0s 26ms/step - loss: 0.2444 - acc: 0.9371
Epoch 28/30

16/16 [==============================] - 0s 26ms/step - loss: 0.2304 - acc: 0.9560
Epoch 29/30

16/16 [==============================] - 0s 27ms/step - loss: 0.2198 - acc: 0.9560
Epoch 30/30

16/16 [==============================] - 0s 26ms/step - loss: 0.1957 - acc: 0.9748
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7212
False 1859
True percentage 0.795061183993
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.62      0.23      0.34       438
      I-PER       0.67      0.07      0.13       214
          O       0.89      0.94      0.91      7318
      B-ORG       0.37      0.36      0.37       296
      I-ORG       0.50      0.21      0.29       151
      B-LOC       0.45      0.26      0.33       218
      I-LOC       1.00      0.06      0.11       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.81      0.80      0.78      9071

F-1 Score (without O):
0.841469909462
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100018 unique words.
Found 91 unique chars.
Found 9 unique labels.
14 unique words not found in embedding.
7 unique chars not found in embedding.
Number of OOV: 326
OOV word occurences: 638
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5888        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401216     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,586
Trainable params: 6,507,586
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

16/16 [==============================] - 2s 133ms/step - loss: 2.1814 - acc: 0.3344
Epoch 2/30

16/16 [==============================] - 0s 29ms/step - loss: 1.1895 - acc: 0.7802
Epoch 3/30

16/16 [==============================] - 0s 26ms/step - loss: 1.0034 - acc: 0.7802
Epoch 4/30

16/16 [==============================] - 0s 26ms/step - loss: 0.9678 - acc: 0.7802
Epoch 5/30

16/16 [==============================] - 0s 26ms/step - loss: 0.8274 - acc: 0.7802
Epoch 6/30

16/16 [==============================] - 0s 27ms/step - loss: 0.7688 - acc: 0.7802
Epoch 7/30

16/16 [==============================] - 0s 27ms/step - loss: 0.7160 - acc: 0.7802
Epoch 8/30

16/16 [==============================] - 0s 27ms/step - loss: 0.6883 - acc: 0.7802
Epoch 9/30

16/16 [==============================] - 0s 26ms/step - loss: 0.6405 - acc: 0.7833
Epoch 10/30

16/16 [==============================] - 0s 27ms/step - loss: 0.6011 - acc: 0.7864
Epoch 11/30

16/16 [==============================] - 0s 27ms/step - loss: 0.5570 - acc: 0.7988
Epoch 12/30

16/16 [==============================] - 0s 26ms/step - loss: 0.5229 - acc: 0.8080
Epoch 13/30

16/16 [==============================] - 0s 25ms/step - loss: 0.4906 - acc: 0.8824
Epoch 14/30

16/16 [==============================] - 0s 27ms/step - loss: 0.4693 - acc: 0.8328
Epoch 15/30

16/16 [==============================] - 0s 27ms/step - loss: 0.4482 - acc: 0.9133
Epoch 16/30

16/16 [==============================] - 0s 27ms/step - loss: 0.4227 - acc: 0.8421
Epoch 17/30

16/16 [==============================] - 0s 26ms/step - loss: 0.3689 - acc: 0.9133
Epoch 18/30

16/16 [==============================] - 0s 26ms/step - loss: 0.3506 - acc: 0.9040
Epoch 19/30

16/16 [==============================] - 0s 27ms/step - loss: 0.3312 - acc: 0.9133
Epoch 20/30

16/16 [==============================] - 0s 27ms/step - loss: 0.3016 - acc: 0.9164
Epoch 21/30

16/16 [==============================] - 0s 27ms/step - loss: 0.2764 - acc: 0.9319
Epoch 22/30

16/16 [==============================] - 0s 26ms/step - loss: 0.2649 - acc: 0.9443
Epoch 23/30

16/16 [==============================] - 0s 28ms/step - loss: 0.2475 - acc: 0.9381
Epoch 24/30

16/16 [==============================] - 0s 28ms/step - loss: 0.2332 - acc: 0.9350
Epoch 25/30

16/16 [==============================] - 0s 27ms/step - loss: 0.2195 - acc: 0.9443
Epoch 26/30

16/16 [==============================] - 0s 27ms/step - loss: 0.2204 - acc: 0.9412
Epoch 27/30

16/16 [==============================] - 0s 27ms/step - loss: 0.2309 - acc: 0.9536
Epoch 28/30

16/16 [==============================] - 0s 26ms/step - loss: 0.2148 - acc: 0.9257
Epoch 29/30

16/16 [==============================] - 0s 28ms/step - loss: 0.1867 - acc: 0.9814
Epoch 30/30

16/16 [==============================] - 0s 27ms/step - loss: 0.1605 - acc: 0.9721
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7164
False 1907
True percentage 0.789769595414
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.89      0.94      0.92      7318
      B-PER       0.41      0.18      0.25       438
      B-LOC       0.82      0.23      0.36       218
     B-MISC       0.14      0.01      0.01       141
     I-MISC       0.00      0.00      0.00       154
      B-ORG       0.34      0.32      0.33       296
      I-ORG       0.23      0.16      0.19       151
      I-LOC       0.00      0.00      0.00       141
      I-PER       1.00      0.01      0.02       214

avg / total       0.80      0.79      0.77      9071

F-1 Score (without O):
0.208992506245
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.01 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 100030 unique words.
Found 93 unique chars.
Found 9 unique labels.
26 unique words not found in embedding.
9 unique chars not found in embedding.
Number of OOV: 324
OOV word occurences: 628
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       6016        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401984     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,508,482
Trainable params: 6,508,482
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

16/16 [==============================] - 2s 130ms/step - loss: 2.3763 - acc: 0.0186
Epoch 2/30

16/16 [==============================] - 0s 26ms/step - loss: 1.4394 - acc: 0.7639
Epoch 3/30

16/16 [==============================] - 0s 25ms/step - loss: 0.9582 - acc: 0.7692
Epoch 4/30

16/16 [==============================] - 0s 25ms/step - loss: 0.9045 - acc: 0.7692
Epoch 5/30

16/16 [==============================] - 0s 27ms/step - loss: 0.8878 - acc: 0.7692
Epoch 6/30

16/16 [==============================] - 0s 26ms/step - loss: 0.8719 - acc: 0.7719
Epoch 7/30

16/16 [==============================] - 0s 26ms/step - loss: 0.7787 - acc: 0.7692
Epoch 8/30

16/16 [==============================] - 0s 26ms/step - loss: 0.7483 - acc: 0.7719
Epoch 9/30

16/16 [==============================] - 0s 26ms/step - loss: 0.6778 - acc: 0.7692
Epoch 10/30

16/16 [==============================] - 0s 25ms/step - loss: 0.6473 - acc: 0.7772
Epoch 11/30

16/16 [==============================] - 0s 26ms/step - loss: 0.5979 - acc: 0.7798
Epoch 12/30

16/16 [==============================] - 0s 26ms/step - loss: 0.5756 - acc: 0.7931
Epoch 13/30

16/16 [==============================] - 0s 25ms/step - loss: 0.5232 - acc: 0.8064
Epoch 14/30

16/16 [==============================] - 0s 26ms/step - loss: 0.4959 - acc: 0.8170
Epoch 15/30

16/16 [==============================] - 0s 26ms/step - loss: 0.4501 - acc: 0.8594
Epoch 16/30

16/16 [==============================] - 0s 25ms/step - loss: 0.4024 - acc: 0.8700
Epoch 17/30

16/16 [==============================] - 0s 26ms/step - loss: 0.3815 - acc: 0.9125
Epoch 18/30

16/16 [==============================] - 0s 26ms/step - loss: 0.3622 - acc: 0.8886
Epoch 19/30

16/16 [==============================] - 0s 25ms/step - loss: 0.3704 - acc: 0.9496
Epoch 20/30

16/16 [==============================] - 0s 26ms/step - loss: 0.3633 - acc: 0.8568
Epoch 21/30

16/16 [==============================] - 0s 26ms/step - loss: 0.3094 - acc: 0.9576
Epoch 22/30

16/16 [==============================] - 0s 26ms/step - loss: 0.2655 - acc: 0.9469
Epoch 23/30

16/16 [==============================] - 0s 26ms/step - loss: 0.2373 - acc: 0.9629
Epoch 24/30

16/16 [==============================] - 0s 26ms/step - loss: 0.2235 - acc: 0.9655
Epoch 25/30

16/16 [==============================] - 0s 26ms/step - loss: 0.2104 - acc: 0.9735
Epoch 26/30

16/16 [==============================] - 0s 26ms/step - loss: 0.2015 - acc: 0.9761
Epoch 27/30

16/16 [==============================] - 0s 25ms/step - loss: 0.1807 - acc: 0.9735
Epoch 28/30

16/16 [==============================] - 0s 25ms/step - loss: 0.1523 - acc: 0.9841
Epoch 29/30

16/16 [==============================] - 0s 26ms/step - loss: 0.1502 - acc: 0.9814
Epoch 30/30

16/16 [==============================] - 0s 26ms/step - loss: 0.1504 - acc: 0.9735
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7193
False 1878
True percentage 0.792966596847
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.89      0.94      0.91      7318
      B-ORG       0.43      0.31      0.36       296
      I-ORG       0.17      0.05      0.07       151
      B-PER       0.67      0.17      0.27       438
      I-PER       0.37      0.17      0.24       214
      B-LOC       0.82      0.35      0.49       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.11      0.08      0.10       154

avg / total       0.80      0.79      0.78      9071

F-1 Score (without O):
0.247218788628
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 0
Found 100004 word vectors.
Found 84 char vectors.
Found 100010 unique words.
Found 87 unique chars.
Found 8 unique labels.
6 unique words not found in embedding.
3 unique chars not found in embedding.
Number of OOV: 327
OOV word occurences: 639
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5632        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6400704     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 9)        1260        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,506,668
Trainable params: 6,506,668
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

8/8 [==============================] - 2s 241ms/step - loss: 2.4740 - acc: 0.0397
Epoch 2/30

8/8 [==============================] - 0s 30ms/step - loss: 1.7324 - acc: 0.6424
Epoch 3/30

8/8 [==============================] - 0s 33ms/step - loss: 0.9291 - acc: 0.8013
Epoch 4/30

8/8 [==============================] - 0s 32ms/step - loss: 1.0977 - acc: 0.8013
Epoch 5/30

8/8 [==============================] - 0s 31ms/step - loss: 0.9502 - acc: 0.8212
Epoch 6/30

8/8 [==============================] - 0s 31ms/step - loss: 0.7392 - acc: 0.8013
Epoch 7/30

8/8 [==============================] - 0s 31ms/step - loss: 0.6446 - acc: 0.8146
Epoch 8/30

8/8 [==============================] - 0s 31ms/step - loss: 0.5868 - acc: 0.8013
Epoch 9/30

8/8 [==============================] - 0s 33ms/step - loss: 0.5519 - acc: 0.8079
Epoch 10/30

8/8 [==============================] - 0s 31ms/step - loss: 0.5238 - acc: 0.8079
Epoch 11/30

8/8 [==============================] - 0s 30ms/step - loss: 0.5045 - acc: 0.8278
Epoch 12/30

8/8 [==============================] - 0s 32ms/step - loss: 0.4634 - acc: 0.8411
Epoch 13/30

8/8 [==============================] - 0s 32ms/step - loss: 0.4263 - acc: 0.8543
Epoch 14/30

8/8 [==============================] - 0s 32ms/step - loss: 0.3899 - acc: 0.8675
Epoch 15/30

8/8 [==============================] - 0s 31ms/step - loss: 0.3740 - acc: 0.8609
Epoch 16/30

8/8 [==============================] - 0s 31ms/step - loss: 0.3398 - acc: 0.8874
Epoch 17/30

8/8 [==============================] - 0s 31ms/step - loss: 0.3209 - acc: 0.9073
Epoch 18/30

8/8 [==============================] - 0s 31ms/step - loss: 0.2865 - acc: 0.9139
Epoch 19/30

8/8 [==============================] - 0s 30ms/step - loss: 0.2588 - acc: 0.9470
Epoch 20/30

8/8 [==============================] - 0s 33ms/step - loss: 0.2287 - acc: 0.9338
Epoch 21/30

8/8 [==============================] - 0s 31ms/step - loss: 0.2185 - acc: 0.9404
Epoch 22/30

8/8 [==============================] - 0s 31ms/step - loss: 0.1807 - acc: 0.9669
Epoch 23/30

8/8 [==============================] - 0s 31ms/step - loss: 0.1737 - acc: 0.9603
Epoch 24/30

8/8 [==============================] - 0s 31ms/step - loss: 0.1695 - acc: 0.9868
Epoch 25/30

8/8 [==============================] - 0s 31ms/step - loss: 0.1568 - acc: 0.9669
Epoch 26/30

8/8 [==============================] - 0s 30ms/step - loss: 0.1433 - acc: 0.9735
Epoch 27/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1275 - acc: 0.9801
Epoch 28/30

8/8 [==============================] - 0s 31ms/step - loss: 0.1168 - acc: 0.9801
Epoch 29/30

8/8 [==============================] - 0s 31ms/step - loss: 0.1108 - acc: 0.9868
Epoch 30/30

8/8 [==============================] - 0s 30ms/step - loss: 0.1012 - acc: 0.9801
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7123
False 1734
True percentage 0.804222648752
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.86      0.95      0.91      7318
      B-LOC       1.00      0.04      0.07       218
      I-LOC       0.75      0.09      0.15       141
      B-PER       0.75      0.09      0.16       438
      B-ORG       0.34      0.27      0.30       296
      I-ORG       1.00      0.01      0.01       151
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.04      0.01      0.02       154

avg / total       0.82      0.80      0.77      8857

F-1 Score (without O):
0.149868073879
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 1
Found 100004 word vectors.
Found 84 char vectors.
Found 100016 unique words.
Found 91 unique chars.
Found 9 unique labels.
12 unique words not found in embedding.
7 unique chars not found in embedding.
Number of OOV: 328
OOV word occurences: 641
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5888        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401088     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,458
Trainable params: 6,507,458
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

8/8 [==============================] - 2s 240ms/step - loss: 2.4162 - acc: 0.0272
Epoch 2/30

8/8 [==============================] - 0s 31ms/step - loss: 1.4886 - acc: 0.7687
Epoch 3/30

8/8 [==============================] - 0s 31ms/step - loss: 0.9572 - acc: 0.7687
Epoch 4/30

8/8 [==============================] - 0s 31ms/step - loss: 0.9202 - acc: 0.7687
Epoch 5/30

8/8 [==============================] - 0s 31ms/step - loss: 0.9799 - acc: 0.7687
Epoch 6/30

8/8 [==============================] - 0s 30ms/step - loss: 0.9513 - acc: 0.7687
Epoch 7/30

8/8 [==============================] - 0s 31ms/step - loss: 0.7317 - acc: 0.7687
Epoch 8/30

8/8 [==============================] - 0s 32ms/step - loss: 0.6948 - acc: 0.7687
Epoch 9/30

8/8 [==============================] - 0s 31ms/step - loss: 0.6358 - acc: 0.7687
Epoch 10/30

8/8 [==============================] - 0s 31ms/step - loss: 0.5995 - acc: 0.7755
Epoch 11/30

8/8 [==============================] - 0s 31ms/step - loss: 0.5611 - acc: 0.7755
Epoch 12/30

8/8 [==============================] - 0s 32ms/step - loss: 0.5210 - acc: 0.8027
Epoch 13/30

8/8 [==============================] - 0s 32ms/step - loss: 0.4870 - acc: 0.8231
Epoch 14/30

8/8 [==============================] - 0s 31ms/step - loss: 0.4321 - acc: 0.8707
Epoch 15/30

8/8 [==============================] - 0s 32ms/step - loss: 0.4054 - acc: 0.8776
Epoch 16/30

8/8 [==============================] - 0s 31ms/step - loss: 0.3653 - acc: 0.8844
Epoch 17/30

8/8 [==============================] - 0s 30ms/step - loss: 0.3338 - acc: 0.9116
Epoch 18/30

8/8 [==============================] - 0s 31ms/step - loss: 0.3192 - acc: 0.9320
Epoch 19/30

8/8 [==============================] - 0s 31ms/step - loss: 0.2852 - acc: 0.9252
Epoch 20/30

8/8 [==============================] - 0s 31ms/step - loss: 0.2407 - acc: 0.9864
Epoch 21/30

8/8 [==============================] - 0s 31ms/step - loss: 0.2308 - acc: 0.9660
Epoch 22/30

8/8 [==============================] - 0s 32ms/step - loss: 0.2082 - acc: 0.9660
Epoch 23/30

8/8 [==============================] - 0s 31ms/step - loss: 0.1834 - acc: 0.9660
Epoch 24/30

8/8 [==============================] - 0s 31ms/step - loss: 0.1686 - acc: 0.9864
Epoch 25/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1420 - acc: 0.9864
Epoch 26/30

8/8 [==============================] - 0s 31ms/step - loss: 0.1407 - acc: 0.9728
Epoch 27/30

8/8 [==============================] - 0s 31ms/step - loss: 0.1405 - acc: 0.9932
Epoch 28/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1299 - acc: 0.9864
Epoch 29/30

8/8 [==============================] - 0s 31ms/step - loss: 0.1082 - acc: 0.9932
Epoch 30/30

8/8 [==============================] - 0s 33ms/step - loss: 0.1025 - acc: 0.9864
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7045
False 2026
True percentage 0.776650865395
Sklearn evaluation:
             precision    recall  f1-score   support

      B-PER       0.41      0.27      0.33       438
      I-PER       0.38      0.19      0.25       214
          O       0.93      0.91      0.92      7318
      B-ORG       0.22      0.45      0.30       296
      I-ORG       0.25      0.28      0.26       151
      B-LOC       0.67      0.14      0.23       218
      I-LOC       0.79      0.16      0.27       141
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154

avg / total       0.82      0.78      0.79      9071

F-1 Score (without O):
0.825851070172
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 2
Found 100004 word vectors.
Found 84 char vectors.
Found 100012 unique words.
Found 91 unique chars.
Found 9 unique labels.
8 unique words not found in embedding.
7 unique chars not found in embedding.
Number of OOV: 326
OOV word occurences: 638
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5888        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6400832     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,202
Trainable params: 6,507,202
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

8/8 [==============================] - 2s 239ms/step - loss: 2.2074 - acc: 0.1124
Epoch 2/30

8/8 [==============================] - 0s 31ms/step - loss: 1.2509 - acc: 0.7870
Epoch 3/30

8/8 [==============================] - 0s 32ms/step - loss: 0.9471 - acc: 0.7870
Epoch 4/30

8/8 [==============================] - 0s 32ms/step - loss: 0.9020 - acc: 0.7870
Epoch 5/30

8/8 [==============================] - 0s 31ms/step - loss: 0.8062 - acc: 0.7870
Epoch 6/30

8/8 [==============================] - 0s 31ms/step - loss: 0.7640 - acc: 0.7870
Epoch 7/30

8/8 [==============================] - 0s 31ms/step - loss: 0.7261 - acc: 0.7870
Epoch 8/30

8/8 [==============================] - 0s 32ms/step - loss: 0.6686 - acc: 0.7870
Epoch 9/30

8/8 [==============================] - 0s 31ms/step - loss: 0.6206 - acc: 0.7870
Epoch 10/30

8/8 [==============================] - 0s 31ms/step - loss: 0.5808 - acc: 0.7870
Epoch 11/30

8/8 [==============================] - 0s 31ms/step - loss: 0.5306 - acc: 0.7988
Epoch 12/30

8/8 [==============================] - 0s 31ms/step - loss: 0.5316 - acc: 0.7988
Epoch 13/30

8/8 [==============================] - 0s 30ms/step - loss: 0.6041 - acc: 0.9231
Epoch 14/30

8/8 [==============================] - 0s 31ms/step - loss: 0.4115 - acc: 0.8402
Epoch 15/30

8/8 [==============================] - 0s 31ms/step - loss: 0.3748 - acc: 0.8639
Epoch 16/30

8/8 [==============================] - 0s 32ms/step - loss: 0.3509 - acc: 0.8698
Epoch 17/30

8/8 [==============================] - 0s 32ms/step - loss: 0.2939 - acc: 0.9172
Epoch 18/30

8/8 [==============================] - 0s 31ms/step - loss: 0.2907 - acc: 0.9172
Epoch 19/30

8/8 [==============================] - 0s 31ms/step - loss: 0.2521 - acc: 0.9586
Epoch 20/30

8/8 [==============================] - 0s 32ms/step - loss: 0.2469 - acc: 0.9408
Epoch 21/30

8/8 [==============================] - 0s 32ms/step - loss: 0.2267 - acc: 0.9586
Epoch 22/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1879 - acc: 0.9586
Epoch 23/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1844 - acc: 0.9822
Epoch 24/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1636 - acc: 0.9704
Epoch 25/30

8/8 [==============================] - 0s 31ms/step - loss: 0.1605 - acc: 0.9704
Epoch 26/30

8/8 [==============================] - 0s 31ms/step - loss: 0.1543 - acc: 0.9882
Epoch 27/30

8/8 [==============================] - 0s 31ms/step - loss: 0.1300 - acc: 0.9822
Epoch 28/30

8/8 [==============================] - 0s 31ms/step - loss: 0.1201 - acc: 0.9941
Epoch 29/30

8/8 [==============================] - 0s 31ms/step - loss: 0.1063 - acc: 0.9882
Epoch 30/30

8/8 [==============================] - 0s 31ms/step - loss: 0.0858 - acc: 0.9941
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7188
False 1883
True percentage 0.792415389703
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.89      0.95      0.92      7318
      B-PER       0.37      0.22      0.28       438
      B-LOC       0.47      0.26      0.34       218
     B-MISC       0.00      0.00      0.00       141
     I-MISC       0.00      0.00      0.00       154
      B-ORG       0.45      0.24      0.31       296
      I-ORG       0.22      0.05      0.09       151
      I-LOC       0.36      0.04      0.06       141
      I-PER       0.67      0.05      0.09       214

avg / total       0.78      0.79      0.78      9071

F-1 Score (without O):
0.210080474375
Opening file ner_3_train.ner
Opening file ner_3_test.ner
Cut percentage 0.005 with seed 3
Found 100004 word vectors.
Found 84 char vectors.
Found 100017 unique words.
Found 92 unique chars.
Found 9 unique labels.
13 unique words not found in embedding.
8 unique chars not found in embedding.
Number of OOV: 325
OOV word occurences: 630
Padded until 83 tokens.
Padded until 24 chars.
Padded until 83 tokens.
Model Choice:
Model Choice:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 83, 24)       0                                            
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 24, 64)       5952        input_2[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 24, 64)       0           embedding_2[0][0]                
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 83)           0                                            
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, 64)           49536       lambda_1[0][0]                   
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 83, 64)       6401152     input_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 83, 64)       0           bidirectional_1[0][0]            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 83, 64)       0           embedding_1[0][0]                
                                                                 lambda_2[0][0]                   
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 83, 128)      49536       add_1[0][0]                      
__________________________________________________________________________________________________
crf_1 (CRF)                     (None, 83, 10)       1410        bidirectional_2[0][0]            
==================================================================================================
Total params: 6,507,586
Trainable params: 6,507,586
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/30

8/8 [==============================] - 2s 242ms/step - loss: 2.1362 - acc: 0.3923
Epoch 2/30

8/8 [==============================] - 0s 33ms/step - loss: 1.4662 - acc: 0.6464
Epoch 3/30

8/8 [==============================] - 0s 33ms/step - loss: 1.2377 - acc: 0.6464
Epoch 4/30

8/8 [==============================] - 0s 31ms/step - loss: 1.2091 - acc: 0.6519
Epoch 5/30

8/8 [==============================] - 0s 32ms/step - loss: 1.0179 - acc: 0.6464
Epoch 6/30

8/8 [==============================] - 0s 32ms/step - loss: 0.9608 - acc: 0.6464
Epoch 7/30

8/8 [==============================] - 0s 31ms/step - loss: 0.8689 - acc: 0.6575
Epoch 8/30

8/8 [==============================] - 0s 30ms/step - loss: 0.8089 - acc: 0.7403
Epoch 9/30

8/8 [==============================] - 0s 31ms/step - loss: 0.7098 - acc: 0.7403
Epoch 10/30

8/8 [==============================] - 0s 31ms/step - loss: 0.6603 - acc: 0.8895
Epoch 11/30

8/8 [==============================] - 0s 31ms/step - loss: 0.6271 - acc: 0.7403
Epoch 12/30

8/8 [==============================] - 0s 32ms/step - loss: 0.5904 - acc: 0.9116
Epoch 13/30

8/8 [==============================] - 0s 32ms/step - loss: 0.4816 - acc: 0.8674
Epoch 14/30

8/8 [==============================] - 0s 31ms/step - loss: 0.4048 - acc: 0.9227
Epoch 15/30

8/8 [==============================] - 0s 31ms/step - loss: 0.3482 - acc: 0.9392
Epoch 16/30

8/8 [==============================] - 0s 32ms/step - loss: 0.3188 - acc: 0.9448
Epoch 17/30

8/8 [==============================] - 0s 32ms/step - loss: 0.2688 - acc: 0.9558
Epoch 18/30

8/8 [==============================] - 0s 32ms/step - loss: 0.2526 - acc: 0.9392
Epoch 19/30

8/8 [==============================] - 0s 33ms/step - loss: 0.2219 - acc: 0.9558
Epoch 20/30

8/8 [==============================] - 0s 31ms/step - loss: 0.1858 - acc: 0.9613
Epoch 21/30

8/8 [==============================] - 0s 31ms/step - loss: 0.1939 - acc: 0.9669
Epoch 22/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1534 - acc: 0.9724
Epoch 23/30

8/8 [==============================] - 0s 33ms/step - loss: 0.1464 - acc: 0.9724
Epoch 24/30

8/8 [==============================] - 0s 33ms/step - loss: 0.1543 - acc: 0.9503
Epoch 25/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1924 - acc: 0.9834
Epoch 26/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1210 - acc: 0.9890
Epoch 27/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1187 - acc: 0.9945
Epoch 28/30

8/8 [==============================] - 0s 32ms/step - loss: 0.1039 - acc: 0.9945
Epoch 29/30

8/8 [==============================] - 0s 32ms/step - loss: 0.0974 - acc: 0.9890
Epoch 30/30

8/8 [==============================] - 0s 31ms/step - loss: 0.0805 - acc: 1.0000
Padded until 24 chars.
Padded until 83 tokens.
Manual evaluation: (didn't understand why I made this)
True 7177
False 1894
True percentage 0.791202733987
Sklearn evaluation:
             precision    recall  f1-score   support

          O       0.90      0.94      0.92      7318
      B-ORG       0.53      0.29      0.38       296
      I-ORG       0.19      0.38      0.25       151
      B-PER       0.62      0.15      0.24       438
      I-PER       0.43      0.21      0.28       214
      B-LOC       0.38      0.01      0.03       218
      I-LOC       0.00      0.00      0.00       141
     B-MISC       0.06      0.01      0.01       141
     I-MISC       0.23      0.05      0.08       154

avg / total       0.80      0.79      0.78      9071

F-1 Score (without O):
0.21391234419
